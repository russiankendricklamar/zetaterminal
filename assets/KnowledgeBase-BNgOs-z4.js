import{d as n,r as e,v as a,o as t,b as o,G as i,c as r,e as l,f as s,l as d,k as c,F as u,i as m,n as p,t as v,g as f,w as h,h as y,C as g,T as w,H as S,V as x,A as R,q as k,j as P,B as b,z as C,x as T,y as M,I as V}from"./vendor-DLyKmMu8.js";import{S as E,P as _,W as I,B as D,C as F,b as A,g as B,J as z,K as H,t as N,V as L,R as U}from"./three.module-7SAW-liO.js";import{_ as W}from"./index-Ba4DjugF.js";const K=[{id:"options",name:"ОПЦИОНЫ",description:"Ценообразование опционов, греки, модели волатильности",color:"#22c55e",longDescription:"Раздел посвящён ценообразованию опционов с использованием классических и современных моделей: Black-Scholes, Heston, Merton, SABR. Включает расчёт греков (чувствительностей) и анализ портфеля опционов."},{id:"bonds",name:"ОБЛИГАЦИИ",description:"Оценка облигаций, дюрация, кривые доходности",color:"#3b82f6",longDescription:"Инструменты для оценки облигаций методом дисконтированных денежных потоков, расчёта дюрации, выпуклости, DV01. Поддержка фиксированных и плавающих купонов, интеграция с MOEX."},{id:"swaps",name:"СВОПЫ И ФОРВАРДЫ",description:"IRS, CDS, форварды, базисный анализ",color:"#f59e0b",longDescription:"Оценка процентных свопов (IRS), кредитных дефолтных свопов (CDS), валютных свопов и форвардных контрактов. Анализ базиса и построение форвардных кривых."},{id:"risk",name:"РИСК-МЕНЕДЖМЕНТ",description:"VaR, стресс-тесты, хеджирование",color:"#ef4444",longDescription:"Комплексный анализ рисков портфеля: Value-at-Risk, Expected Shortfall, стресс-тестирование. Инструменты для построения хеджей и атрибуции P&L."},{id:"simulation",name:"СИМУЛЯЦИИ",description:"Monte Carlo, бэктестинг, сценарии",color:"#8b5cf6",longDescription:"Стохастическое моделирование с использованием Monte Carlo симуляций на основе геометрического броуновского движения. Бэктестинг торговых стратегий."},{id:"regimes",name:"РЕЖИМЫ РЫНКА",description:"HMM, спектральный анализ, переходы",color:"#06b6d4",longDescription:"Определение рыночных режимов с помощью скрытых марковских моделей (HMM). Анализ матриц переходов, стационарных распределений и спектральных свойств."},{id:"portfolio",name:"ПОРТФЕЛЬ",description:"Оптимизация, аллокация, метрики",color:"#ec4899",longDescription:"Управление портфелем активов: оптимизация по Марковицу, HJB-оптимизация, расчёт Sharpe Ratio, анализ диверсификации и корреляций."},{id:"terminal",name:"ТЕРМИНАЛ",description:"Потоковые данные, количественный анализ",color:"#f97316",longDescription:"Торговый терминал с потоковыми данными в реальном времени. Продвинутые 3D-визуализации: поверхности волатильности, фазовое пространство, модели ликвидности."}],G=[{id:"bsm",code:"BSM",title:"Модель Блэка-Шоулза",category:"options",path:"/pricing/options",description:"Классическая модель ценообразования европейских опционов, разработанная Фишером Блэком и Майроном Шоулзом в 1973 году. Предполагает логнормальное распределение цены базового актива и постоянную волатильность.",formula:"C = S₀·N(d₁) - K·e^(-rT)·N(d₂)",formulaExplanation:"Где:\n• C — цена колл-опциона\n• S₀ — текущая цена базового актива\n• K — страйк (цена исполнения)\n• r — безрисковая ставка\n• T — время до экспирации (в годах)\n• N(x) — функция стандартного нормального распределения\n• d₁ = [ln(S₀/K) + (r + σ²/2)T] / (σ√T)\n• d₂ = d₁ - σ√T\n• σ — волатильность базового актива\n\nДля пут-опциона: P = K·e^(-rT)·N(-d₂) - S₀·N(-d₁)",features:["Расчёт цены Call и Put опционов","Поддержка дивидендной доходности","Расчёт всех греков (Δ, Γ, ν, Θ, ρ)","Implied Volatility калькулятор","Batch-расчёт из Excel"],howToUse:["Введите параметры: S₀ (цена актива), K (страйк), T (срок), r (ставка), σ (волатильность)","Выберите тип опциона: Call или Put",'Нажмите "Рассчитать" для получения цены и греков',"Используйте IV калькулятор для определения подразумеваемой волатильности по рыночной цене"],relatedItems:["greeks","heston","volsurf"]},{id:"heston",code:"HEST",title:"Модель Хестона",category:"options",path:"/pricing/options/models",description:'Модель стохастической волатильности, где волатильность сама является случайным процессом. Позволяет воспроизводить "улыбку волатильности" и эффект левериджа.',formula:"dSₜ = μSₜdt + √Vₜ·Sₜ·dW₁\ndVₜ = κ(θ - Vₜ)dt + ξ√Vₜ·dW₂",formulaExplanation:"Система стохастических дифференциальных уравнений:\n\n• Sₜ — цена базового актива\n• Vₜ — мгновенная дисперсия (σ² = V)\n• μ — дрифт цены актива\n• κ — скорость возврата волатильности к среднему\n• θ — долгосрочный уровень дисперсии\n• ξ — волатильность волатильности (vol of vol)\n• ρ — корреляция между dW₁ и dW₂ (обычно отрицательная)\n• dW₁, dW₂ — коррелированные винеровские процессы\n\nУсловие Феллера: 2κθ > ξ² гарантирует V > 0",features:["Стохастическая волатильность","Воспроизведение улыбки волатильности","Эффект левериджа (отрицательная корреляция)","Mean-reversion волатильности","Калибровка на рыночные данные"],howToUse:["Задайте базовые параметры опциона (S, K, T, r)","Настройте параметры Хестона: V₀, κ, θ, ξ, ρ","Сравните цену с BSM для оценки влияния стохастической волатильности","Используйте для pricing опционов с длинными сроками"],relatedItems:["bsm","sabr","volsurf"]},{id:"greeks",code:"GREEK",title:"Греки опционов",category:"options",path:"/option-greeks-analyzer",description:"Греки — это частные производные цены опциона по различным параметрам. Они показывают чувствительность цены к изменению входных параметров и используются для управления рисками.",formula:"Δ = ∂C/∂S, Γ = ∂²C/∂S², ν = ∂C/∂σ, Θ = ∂C/∂t, ρ = ∂C/∂r",formulaExplanation:"Основные греки для BSM:\n\n• Delta (Δ) = N(d₁) для Call, N(d₁)-1 для Put\n  Изменение цены опциона при изменении базового актива на $1\n\n• Gamma (Γ) = N'(d₁) / (S·σ·√T)\n  Скорость изменения дельты, \"выпуклость\" опциона\n\n• Vega (ν) = S·√T·N'(d₁)\n  Чувствительность к изменению волатильности на 1%\n\n• Theta (Θ) = -S·N'(d₁)·σ/(2√T) - r·K·e^(-rT)·N(d₂)\n  Временной распад, потеря стоимости за 1 день\n\n• Rho (ρ) = K·T·e^(-rT)·N(d₂) для Call\n  Чувствительность к изменению процентной ставки",features:["Расчёт всех 5 основных греков","P&L сценарный анализ","Матрица чувствительности (ΔS × Δσ)","Декомпозиция P&L по грекам","Визуализация профиля греков"],howToUse:["Введите параметры опциона или выберите из портфеля","Просмотрите значения греков в карточках KPI","Используйте сценарный анализ для оценки P&L при изменении S или σ","Изучите матрицу чувствительности для понимания рисков"],relatedItems:["bsm","portfolio-greeks","hedging"]},{id:"merton",code:"MERT",title:"Модель Мертона (Jump Diffusion)",category:"options",path:"/pricing/options/models",description:'Расширение модели Блэка-Шоулза с добавлением скачков цены (jumps). Позволяет моделировать резкие движения рынка и "толстые хвосты" распределения доходностей.',formula:"dSₜ = (μ - λk)Sₜdt + σSₜdWₜ + Sₜ(e^J - 1)dNₜ",formulaExplanation:"Компоненты модели:\n\n• dWₜ — стандартное броуновское движение\n• dNₜ — пуассоновский процесс с интенсивностью λ\n• J — размер скачка, J ~ N(μⱼ, σⱼ²)\n• k = E[e^J - 1] = e^(μⱼ + σⱼ²/2) - 1\n• λ — среднее количество скачков в год\n\nЦена опциона вычисляется как сумма:\nC = Σₙ (e^(-λT)(λT)ⁿ/n!) · BSM(Sₙ, σₙ)\n\nгде σₙ² = σ² + nσⱼ²/T",features:["Моделирование скачков цены","Толстые хвосты распределения","Калибровка интенсивности скачков","Сравнение с BSM","Распределение размера скачков"],howToUse:["Задайте параметры диффузии (σ) и скачков (λ, μⱼ, σⱼ)","Сравните цену с BSM для оценки премии за скачки","Используйте для опционов на активы с редкими резкими движениями"],relatedItems:["bsm","bates","variance-gamma"]},{id:"sabr",code:"SABR",title:"Модель SABR",category:"options",path:"/volatility-surface",description:"Stochastic Alpha Beta Rho — модель для описания динамики улыбки волатильности. Широко используется на рынках процентных ставок и валют.",formula:"dFₜ = σₜ·Fₜ^β·dW₁\ndσₜ = α·σₜ·dW₂",formulaExplanation:"Параметры модели SABR:\n\n• F — форвардная цена\n• σ — стохастическая волатильность\n• α — vol-of-vol (волатильность волатильности)\n• β — эластичность (0 ≤ β ≤ 1)\n  - β = 0: нормальная модель\n  - β = 1: логнормальная модель\n• ρ — корреляция между F и σ\n\nФормула Хагана для implied volatility:\nσᵢₘₚ(K) ≈ α·[...] · [1 + (ε₁ + ε₂)T]\n\nгде коэффициенты зависят от α, β, ρ и F/K",features:["Калибровка на рыночную улыбку","Интерполяция между страйками","Динамика улыбки во времени","Применение для swaptions и caps","Параметр β для контроля скошенности"],howToUse:["Загрузите рыночные котировки опционов","Запустите калибровку для нахождения α, β, ρ","Используйте для интерполяции IV между страйками","Экстраполируйте улыбку на нестандартные страйки"],relatedItems:["volsurf","heston","swaptions"]},{id:"volsurf",code:"VOLSURF",title:"Поверхность волатильности",category:"options",path:"/volatility-surface",description:"3D-визуализация подразумеваемой волатильности как функции страйка и времени до экспирации. Отражает рыночные ожидания будущей волатильности.",formula:"IV = f(K/S, T)",formulaExplanation:"Поверхность волатильности описывает:\n\n• Улыбка (Smile): IV выше для OTM опционов\n  - Вызвана толстыми хвостами распределения\n  - Отражает страх рынка перед резкими движениями\n\n• Скос (Skew): асимметрия улыбки\n  - Negative skew: IV(Put OTM) > IV(Call OTM)\n  - Характерен для акций (crash risk)\n\n• Временная структура: изменение IV с T\n  - Обычно убывает с ростом T (term structure)\n  - Инверсия при ожидании событий\n\nМонейность: m = ln(K/F) / (σ√T)\nATM: m = 0, OTM Put: m < 0, OTM Call: m > 0",features:["3D интерактивная визуализация","Построение по разным моделям","Wireframe и solid режимы","Анимация вращения","Экспорт данных"],howToUse:["Выберите модель построения (BSM, Heston, SABR, Local Vol)","Загрузите рыночные котировки из Excel","Изучите форму улыбки и скоса","Вращайте поверхность для анализа структуры"],relatedItems:["sabr","heston","bsm"]},{id:"portfolio-options",code:"OPTPF",title:"Портфель опционов",category:"options",path:"/option-portfolio",description:"Управление портфелем опционных позиций с агрегированием греков, анализом P&L и оценкой рисков.",formula:"Δₚ = Σᵢ nᵢ·Δᵢ, Γₚ = Σᵢ nᵢ·Γᵢ, ...",formulaExplanation:"Агрегирование греков портфеля:\n\n• Портфельная Delta: Δₚ = Σ (количество × Δ каждой позиции)\n• Портфельная Gamma: Γₚ = Σ (количество × Γ)\n• Портфельная Vega: νₚ = Σ (количество × ν)\n• Портфельная Theta: Θₚ = Σ (количество × Θ)\n\nP&L декомпозиция:\nΔP&L ≈ Δ·ΔS + ½Γ·(ΔS)² + ν·Δσ + Θ·Δt\n\nНетто-позиция определяет направленность:\n• Δₚ > 0: лонг по рынку\n• Γₚ > 0: выигрыш от волатильности\n• Θₚ < 0: временной распад (платим)",features:["Агрегированные греки портфеля","P&L по каждой позиции","Анализ монейности","Группировка по экспирациям","Нетто-греки портфеля"],howToUse:["Добавьте опционные позиции в портфель","Просмотрите агрегированные греки","Оцените P&L при сценарных изменениях","Идентифицируйте риски (gamma risk, vega risk)"],relatedItems:["greeks","hedging","pnl-attr"]},{id:"bond-valuation",code:"BOND",title:"Оценка облигаций (DCF)",category:"bonds",path:"/bond-valuation",description:"Оценка облигаций методом дисконтированных денежных потоков. Рассчитывается приведённая стоимость всех будущих купонов и номинала.",formula:"P = Σᵢ CFᵢ/(1+y)^tᵢ + N/(1+y)^T",formulaExplanation:"Формула приведённой стоимости:\n\nP = Σ [C/(1+y)^tᵢ] + N/(1+y)^T\n\nГде:\n• P — грязная цена облигации (Dirty Price)\n• C — купонный платёж\n• N — номинал (обычно 100 или 1000)\n• y — доходность к погашению (YTM)\n• tᵢ — время до i-го купона (в годах)\n• T — время до погашения\n\nЧистая цена = Грязная цена - НКД\nНКД = C × (дней с последнего купона / дней в купонном периоде)\n\nYTM находится итеративно (Newton-Raphson):\nP(y) = Market Price",features:["Расчёт грязной и чистой цены","Накопленный купонный доход (НКД)","Доходность к погашению (YTM)","Интеграция с MOEX ISS API","Batch-расчёт из Excel"],howToUse:["Введите ISIN или выберите облигацию из списка","Система загрузит параметры с MOEX","Укажите дату оценки и кривую доходности","Получите цену, YTM и аналитику"],relatedItems:["duration","zcyc","convexity"]},{id:"duration",code:"DUR",title:"Дюрация и DV01",category:"bonds",path:"/bond-valuation",description:"Дюрация — мера процентного риска облигации, показывающая чувствительность цены к изменению доходности. DV01 — изменение цены при сдвиге ставки на 1 б.п.",formula:"D = -1/P · dP/dy = Σ(tᵢ·PVᵢ)/P",formulaExplanation:"Виды дюрации:\n\n• Дюрация Маколея:\n  Dₘ = Σ[tᵢ · CFᵢ/(1+y)^tᵢ] / P\n  Средневзвешенный срок денежных потоков\n\n• Модифицированная дюрация:\n  Dₘₒₐ = Dₘ / (1 + y/m)\n  где m — частота купонов в год\n\n• Dollar Duration (DV01):\n  DV01 = Dₘₒₐ × P × 0.0001\n  Изменение цены при росте ставки на 1 б.п.\n\nПриближение изменения цены:\nΔP ≈ -Dₘₒₐ × P × Δy\n\nДля большей точности добавляем выпуклость:\nΔP ≈ -Dₘₒₐ × P × Δy + ½ × Convexity × P × (Δy)²",features:["Дюрация Маколея","Модифицированная дюрация","DV01 (PVBP)","Эффективная дюрация","Key Rate Duration"],howToUse:["Загрузите облигацию по ISIN","Просмотрите показатели в карточках метрик","Используйте DV01 для оценки риска позиции","Сравните дюрации для выбора облигаций"],relatedItems:["bond-valuation","convexity","hedging"]},{id:"convexity",code:"CONV",title:"Выпуклость (Convexity)",category:"bonds",path:"/bond-valuation",description:"Выпуклость — вторая производная цены по доходности. Улучшает оценку изменения цены при больших движениях ставок.",formula:"Convexity = 1/P · d²P/dy² = Σ[tᵢ(tᵢ+1)·PVᵢ] / [P·(1+y)²]",formulaExplanation:"Выпуклость описывает кривизну зависимости P(y):\n\nConvexity = [Σ tᵢ(tᵢ+1)·CFᵢ/(1+y)^tᵢ] / [P·(1+y)²]\n\nСвойства:\n• Convexity > 0 для обычных облигаций\n• Чем больше Convexity, тем лучше для инвестора\n• При росте ставок — меньше потери\n• При падении ставок — больше прибыль\n\nПолная формула изменения цены:\nΔP/P ≈ -Dₘₒₐ·Δy + ½·Convexity·(Δy)²\n\nПример: D = 5, C = 30, Δy = +1%\nΔP/P ≈ -5×0.01 + 0.5×30×0.0001 = -4.85%\n(без convexity было бы -5%)",features:["Расчёт выпуклости","Dollar Convexity","Сравнение облигаций","Сценарный анализ","Визуализация P(y)"],howToUse:["Выберите облигацию для анализа","Сравните Convexity разных бумаг","Используйте для оценки риска при больших движениях ставок"],relatedItems:["duration","bond-valuation"]},{id:"zcyc",code:"ZCYC",title:"Кривая бескупонной доходности",category:"bonds",path:"/zcyc-viewer",description:"Zero-Coupon Yield Curve — кривая доходности, построенная по бескупонным инструментам. Отражает временную структуру процентных ставок.",formula:"P(T) = e^(-r(T)·T) или P(T) = 1/(1+r(T))^T",formulaExplanation:"Построение ZCYC:\n\n1. Bootstrapping из рыночных инструментов:\n   - Короткие сроки: денежный рынок (RUONIA, депозиты)\n   - Средние: свопы (IRS)\n   - Длинные: гос. облигации\n\n2. Discount Factor:\n   DF(T) = e^(-r(T)·T) для непрерывного начисления\n   DF(T) = 1/(1+r(T))^T для дискретного\n\n3. Forward Rate:\n   f(t₁,t₂) = [r(t₂)·t₂ - r(t₁)·t₁] / (t₂-t₁)\n\n4. Интерполяция:\n   - Linear (простая)\n   - Cubic Spline (гладкая)\n   - Nelson-Siegel (параметрическая)\n\nMOEX публикует G-Curve (ОФЗ) ежедневно",features:["Загрузка с MOEX ISS API","Историческое сравнение","Статистика кривой","3D визуализация","Forward rates"],howToUse:["Выберите дату для загрузки кривой","Сравните с историческими данными","Изучите форму кривой (нормальная/инвертированная)","Используйте для дисконтирования денежных потоков"],relatedItems:["bond-valuation","swap-val","forward-curve"]},{id:"floater",code:"FRN",title:"Облигации с плавающим купоном",category:"bonds",path:"/floater-bond-report",description:"Floating Rate Notes — облигации с купоном, привязанным к референсной ставке (RUONIA, SOFR). Имеют низкую процентную чувствительность.",formula:"Coupon = Reference Rate + Spread",formulaExplanation:"Механика FRN:\n\nКупон = Референсная ставка + Спред\n\n• Референсные ставки:\n  - RUONIA (Россия)\n  - SOFR (США)\n  - EURIBOR (Еврозона)\n  - SONIA (Великобритания)\n\n• Спред фиксирован на весь срок\n• Купон пересчитывается каждый период\n\nОсобенности оценки:\n• Дюрация ≈ время до следующего reset\n• Цена близка к номиналу в дату reset\n• Основной риск — кредитный (spread risk)\n\nDirty Price = PV(будущих купонов) + PV(номинала)\nгде купоны прогнозируются через forward rates",features:["Прогноз купонов через forwards","Spread analysis","Reset mechanics","Сравнение с fixed-rate","RUONIA интеграция"],howToUse:["Введите ISIN флоатера","Просмотрите текущий и прогнозные купоны","Оцените spread risk","Сравните с фиксированными облигациями"],relatedItems:["bond-valuation","zcyc","swap-val"]},{id:"irs",code:"IRS",title:"Процентные свопы (IRS)",category:"swaps",path:"/valuation/swaps",description:"Interest Rate Swap — контракт обмена фиксированных платежей на плавающие. Используется для хеджирования процентного риска.",formula:"NPV = PV(Fixed Leg) - PV(Floating Leg)",formulaExplanation:"Структура IRS:\n\n• Fixed Leg: платим/получаем фиксированную ставку K\n  PV_fixed = K × Σ[Δtᵢ × DF(tᵢ)] × Notional\n\n• Floating Leg: получаем/платим плавающую ставку\n  PV_float = Σ[Fᵢ × Δtᵢ × DF(tᵢ)] × Notional\n  где Fᵢ — forward rate\n\nPar Swap Rate (справедливая фикс. ставка):\nK* = [1 - DF(T)] / Σ[Δtᵢ × DF(tᵢ)]\n\nDV01 свопа:\nDV01 ≈ Σ[Δtᵢ × DF(tᵢ)] × Notional × 0.0001\n\nPayer Swap: платим fixed, получаем float\nReceiver Swap: получаем fixed, платим float",features:["Расчёт NPV и DV01","Par rate калькулятор","Payer / Receiver свопы","Multi-currency support","Batch valuation"],howToUse:["Задайте notional, maturity, fixed rate","Выберите floating leg (RUONIA, MOSPRIME)","Рассчитайте NPV и risk metrics","Используйте для хеджирования bond portfolio"],relatedItems:["cds","forward-val","duration"]},{id:"cds",code:"CDS",title:"Кредитные дефолтные свопы",category:"swaps",path:"/valuation/swaps",description:"Credit Default Swap — страховка от дефолта. Покупатель платит премию, продавец компенсирует потери при дефолте.",formula:"Spread × RPV01 = (1-R) × Σ[q(tᵢ)·DF(tᵢ)]",formulaExplanation:"Компоненты CDS:\n\n• Premium Leg (платежи покупателя):\n  PV_premium = Spread × RPV01\n  RPV01 = Σ[Δtᵢ × DF(tᵢ) × Q(tᵢ)]\n  Q(tᵢ) — вероятность выживания до tᵢ\n\n• Protection Leg (выплата при дефолте):\n  PV_protection = (1-R) × Σ[q(tᵢ) × DF(tᵢ)]\n  q(tᵢ) = Q(tᵢ₋₁) - Q(tᵢ) — вероятность дефолта\n  R — Recovery Rate (обычно 40%)\n\nPar Spread (справедливый spread):\nS* = (1-R) × Σ[q(tᵢ)·DF(tᵢ)] / RPV01\n\nHazard Rate (интенсивность дефолта):\nλ ≈ Spread / (1-R)",features:["Расчёт NPV","Par spread calculator","Implied default probability","Recovery rate sensitivity","Hazard rate curve"],howToUse:["Введите reference entity и notional","Укажите spread и recovery rate","Рассчитайте справедливую стоимость","Оцените вероятность дефолта"],relatedItems:["irs","credit-risk","bond-valuation"]},{id:"forward-val",code:"FWD",title:"Форвардные контракты",category:"swaps",path:"/valuation/forwards",description:"Форвард — соглашение о покупке/продаже актива в будущем по фиксированной цене. Применяется для хеджирования и спекуляций.",formula:"F = S × e^((r-q)T) или F = S × (1+r)^T / (1+q)^T",formulaExplanation:"Форвардная цена по типам активов:\n\n• Акции без дивидендов:\n  F = S × e^(rT)\n\n• Акции с дивидендной доходностью q:\n  F = S × e^((r-q)T)\n\n• Валюта (Covered Interest Parity):\n  F = S × (1+r_domestic)^T / (1+r_foreign)^T\n\n• Товары (cost-of-carry):\n  F = S × e^((r+c-y)T)\n  c — storage cost, y — convenience yield\n\n• Облигации:\n  F = (S - PV(coupons)) × e^(rT)\n\nСтоимость существующего форварда:\nV = (F_new - K) × e^(-rT) × Notional",features:["Pricing всех типов форвардов","Валютные форварды","Commodity forwards","Bond forwards","Mark-to-market"],howToUse:["Выберите тип базового актива","Введите spot price, rates, maturity","Получите forward price","Оцените стоимость существующей позиции"],relatedItems:["basis","forward-curve","irs"]},{id:"basis",code:"BASIS",title:"Базисный анализ",category:"swaps",path:"/basis-analysis",description:"Базис — разница между форвардной и спотовой ценой. Анализ базиса важен для понимания стоимости хеджирования и арбитражных возможностей.",formula:"Basis = F - S = S × (e^((r-q)T) - 1)",formulaExplanation:"Компоненты базиса:\n\nBasis = Forward Price - Spot Price\n\nДля финансовых активов:\nBasis ≈ S × (r - q) × T\n• r — безрисковая ставка\n• q — дивидендная доходность\n\nДля товаров:\nBasis = S × (r + c - y) × T\n• c — storage costs\n• y — convenience yield\n\nТипы базиса:\n• Contango: F > S (basis > 0) — норма для финансов\n• Backwardation: F < S (basis < 0) — commodity markets\n\nAnnualized Basis:\nBasis% = (F/S - 1) × (365/T)\n\nИспользуется для:\n• Оценки стоимости хеджа\n• Cash-and-carry арбитража\n• Rollover analysis",features:["Basis calculation","Annualized carry cost","Contango/Backwardation","Historical basis tracking","Roll analysis"],howToUse:["Выберите актив и форвардный срок","Сравните basis для разных экспираций","Оцените стоимость roll-over","Идентифицируйте арбитражные возможности"],relatedItems:["forward-val","forward-curve","hedging"]},{id:"var",code:"VAR",title:"Value at Risk (VaR)",category:"risk",path:"/greeks",description:"VaR — максимальные потери портфеля за период с заданной вероятностью. Ключевая метрика рыночного риска.",formula:"VaR_α = -μ + σ × Φ⁻¹(α)",formulaExplanation:'Методы расчёта VaR:\n\n1. Параметрический (Variance-Covariance):\n   VaR = Portfolio × σ × z_α × √T\n   • z_α — квантиль нормального распределения\n   • z_95% = 1.645, z_99% = 2.326\n   • Предполагает нормальность returns\n\n2. Исторический:\n   VaR = -Percentile(returns, 1-α)\n   • Берём α-квантиль реальных returns\n   • Не требует допущений о распределении\n\n3. Monte Carlo:\n   • Генерируем N сценариев\n   • VaR = -Percentile(simulated P&L, 1-α)\n\nПример: VaR 95% = $1M означает:\n"С вероятностью 95% потери за день не превысят $1M"\nили "5% дней потери будут больше $1M"',features:["Параметрический VaR","Historical VaR","Monte Carlo VaR","Marginal VaR","Component VaR"],howToUse:["Выберите уровень доверия (95%, 99%)","Укажите временной горизонт (1d, 10d)","Сравните методы расчёта","Используйте Marginal VaR для оценки вклада позиций"],relatedItems:["cvar","stress","backtest"]},{id:"cvar",code:"CVAR",title:"Expected Shortfall (CVaR)",category:"risk",path:"/greeks",description:"Conditional VaR — ожидаемые потери при условии, что VaR превышен. Более консервативная метрика, учитывающая хвостовые риски.",formula:"ES_α = E[Loss | Loss > VaR_α]",formulaExplanation:'Expected Shortfall (ES / CVaR):\n\nОпределение:\nES_α = -E[X | X < -VaR_α]\n     = среднее потерь в худших (1-α)% случаев\n\nДля нормального распределения:\nES_α = μ + σ × φ(z_α)/(1-α)\nгде φ — плотность N(0,1)\n\nСвойства ES vs VaR:\n• ES всегда ≥ VaR\n• ES — когерентная мера риска\n• ES учитывает форму хвоста\n• Basel III требует ES 97.5% (≈ VaR 99%)\n\nПример:\nVaR 95% = $1M, ES 95% = $1.4M означает:\n"В худшие 5% дней средние потери = $1.4M"\n\nИсторическая формула:\nES = -Среднее(worst 5% returns)',features:["Параметрический ES","Historical ES","Сравнение с VaR","Tail risk analysis","Basel III compliance"],howToUse:["Рассчитайте VaR для выбранного уровня",'ES покажет "цену" превышения VaR',"Используйте для stress capital requirements"],relatedItems:["var","stress","extreme-value"]},{id:"stress",code:"STRESS",title:"Стресс-тестирование",category:"risk",path:"/stress",description:"Оценка поведения портфеля в экстремальных, но правдоподобных сценариях. Выявляет уязвимости, не видимые в VaR.",formula:"ΔPortfolio = Σᵢ Sensitivityᵢ × Shockᵢ",formulaExplanation:'Типы стресс-тестов:\n\n1. Исторические сценарии:\n   • Кризис 2008 (Lehman)\n   • COVID-19 (март 2020)\n   • Рубль 2014\n\n2. Гипотетические сценарии:\n   • Параллельный сдвиг ставок +200bp\n   • Падение акций -30%\n   • Рост волатильности ×2\n\n3. Sensitivity-based:\n   ΔP ≈ Σ(∂P/∂xᵢ × Δxᵢ)\n\n   Для портфеля облигаций:\n   ΔP ≈ -Duration × ΔY + ½×Convexity×(ΔY)²\n\n   Для опционов:\n   ΔP ≈ Δ×ΔS + ½Γ×(ΔS)² + ν×Δσ\n\n4. Reverse Stress Test:\n   "Какой шок нужен для потери X?"',features:["Исторические сценарии","Кастомные сценарии","Shock multiplier","P&L impact по активам","Severity levels"],howToUse:["Выберите тип стресс-теста","Настройте параметры шока","Оцените impact на портфель","Идентифицируйте уязвимые позиции"],relatedItems:["var","cvar","scenario"]},{id:"hedging",code:"HEDGE",title:"Хеджирование",category:"risk",path:"/hedging-assistant",description:"Построение хеджирующих позиций для снижения рисков портфеля. Включает delta-hedging, duration matching и regression-based hedging.",formula:"Hedge Ratio = -Cov(Portfolio, Hedge) / Var(Hedge)",formulaExplanation:"Стратегии хеджирования:\n\n1. Delta Hedging (опционы):\n   Hedge = -Δ × Notional\n   • Нейтрализует направленный риск\n   • Требует частой ребалансировки\n\n2. Duration Matching (облигации):\n   Hedge_notional = -(DV01_portfolio / DV01_hedge)\n   • Иммунизация от параллельного сдвига\n\n3. Regression Hedging:\n   Hedge Ratio = β = Cov(P,H)/Var(H)\n   • Минимизирует дисперсию хеджированной позиции\n\n4. Optimal Hedge (многофакторный):\n   h* = argmin Var(Portfolio - h×Hedge)\n\nHedge Effectiveness:\nR² = 1 - Var(hedged)/Var(unhedged)\n\nBasis Risk:\nРиск неполного хеджирования из-за\nнесовпадения hedge и underlying",features:["Delta hedging","Duration matching","Regression hedging","Hedge ratio calculator","Basis risk analysis"],howToUse:["Выберите позицию для хеджирования","Определите тип риска (direction, duration, vol)","Выберите hedge instrument","Рассчитайте оптимальный hedge ratio"],relatedItems:["greeks","duration","basis"]},{id:"pnl-attr",code:"PNLA",title:"P&L Атрибуция",category:"risk",path:"/analytics/pnl",description:"Декомпозиция прибыли и убытков по источникам: рыночные движения, временной распад, волатильность, и другие факторы.",formula:"ΔP&L = ΔS×Δ + ½(ΔS)²×Γ + Δσ×ν + Δt×Θ + residual",formulaExplanation:"Компоненты P&L Attribution:\n\n1. Greeks-based (для опционов):\n   • Market P&L = Δ × ΔS (направленное движение)\n   • Gamma P&L = ½ × Γ × (ΔS)² (кривизна)\n   • Vega P&L = ν × Δσ (волатильность)\n   • Theta P&L = Θ × Δt (временной распад)\n   • Residual = неучтённые эффекты\n\n2. Factor-based (для акций):\n   P&L = β_mkt × R_mkt + β_size × R_size + ...\n   • Market factor\n   • Size, Value, Momentum factors\n\n3. Position-based:\n   • P&L по каждой позиции\n   • Contribution to total\n\nФормула для облигаций:\nΔP ≈ -Dur×Δy + ½Conv×(Δy)² + Carry + Roll",features:["Greeks decomposition","Factor attribution","Position-level P&L","Daily/Weekly/Monthly","Contribution analysis"],howToUse:["Выберите период анализа","Выберите метод атрибуции","Изучите вклад каждого фактора","Идентифицируйте источники прибыли/убытков"],relatedItems:["greeks","portfolio-options","var"]},{id:"monte-carlo",code:"MC",title:"Monte Carlo симуляция",category:"simulation",path:"/monte-carlo",description:"Стохастическое моделирование цен активов с использованием геометрического броуновского движения. Генерация тысяч сценариев для оценки рисков.",formula:"S(t+Δt) = S(t) × exp[(μ - σ²/2)Δt + σ√Δt × Z]",formulaExplanation:"Geometric Brownian Motion (GBM):\n\nНепрерывная форма:\ndS = μSdt + σSdW\n\nДискретизация (Euler):\nS(t+Δt) = S(t) × exp[(μ - σ²/2)Δt + σ√Δt × Z]\nгде Z ~ N(0,1)\n\nПараметры:\n• S₀ — начальная цена\n• μ — дрифт (ожидаемая доходность)\n• σ — волатильность\n• T — горизонт симуляции\n• N — количество путей\n• dt — шаг по времени\n\nОценки из симуляции:\n• E[S_T] ≈ (1/N) × Σ S_T^(i)\n• VaR = Percentile(S_T, α)\n• Prob(S_T > K) ≈ #{S_T > K} / N\n\nДля опционов:\nC ≈ e^(-rT) × (1/N) × Σ max(S_T^(i) - K, 0)",features:["GBM path generation","Настраиваемые параметры","VaR из симуляции","Probability analysis","Path visualization"],howToUse:["Введите S₀, μ, σ, T, N","Запустите симуляцию","Изучите распределение терминальных цен","Оцените VaR и вероятности"],relatedItems:["var","bsm","heston"]},{id:"backtest",code:"BACK",title:"Бэктестинг стратегий",category:"simulation",path:"/backtest",description:"Тестирование торговых стратегий на исторических данных. Оценка CAGR, Sharpe Ratio, Maximum Drawdown и других метрик.",formula:"Sharpe = (R_p - R_f) / σ_p",formulaExplanation:"Ключевые метрики бэктеста:\n\n1. Total Return:\n   R_total = (V_end - V_start) / V_start\n\n2. CAGR (Compound Annual Growth Rate):\n   CAGR = (V_end/V_start)^(1/years) - 1\n\n3. Sharpe Ratio:\n   Sharpe = (R_p - R_f) / σ_p\n   • R_p — средняя доходность портфеля\n   • R_f — безрисковая ставка\n   • σ_p — волатильность портфеля\n   • Sharpe > 1 — хорошо, > 2 — отлично\n\n4. Maximum Drawdown:\n   MDD = max[(Peak - Trough) / Peak]\n   • Максимальная просадка от пика\n\n5. Win Rate:\n   Win Rate = # profitable trades / # total trades\n\n6. Sortino Ratio (downside risk):\n   Sortino = (R_p - R_f) / σ_downside",features:["Long/Short стратегии","Equity curve","Benchmark comparison","Monthly returns table","Risk-adjusted metrics"],howToUse:["Выберите стратегию","Задайте исторический период","Запустите бэктест","Сравните с бенчмарком (S&P 500)","Анализируйте метрики"],relatedItems:["sharpe","monte-carlo","portfolio"]},{id:"gbm",code:"GBM",title:"Геометрическое броуновское движение",category:"simulation",description:"Фундаментальная стохастическая модель для цен активов. Предполагает логнормальное распределение цен и постоянную волатильность.",formula:"dS = μSdt + σSdW",formulaExplanation:"Геометрическое Броуновское Движение:\n\nСтохастическое дифференциальное уравнение:\ndS = μSdt + σSdW\n\nРешение (Itô):\nS(T) = S(0) × exp[(μ - σ²/2)T + σW(T)]\n\nСвойства:\n• S(T) > 0 всегда (цены неотрицательны)\n• ln(S) ~ Normal (логнормальное распределение)\n• E[S(T)] = S(0) × e^(μT)\n• Var[S(T)] = S(0)² × e^(2μT) × (e^(σ²T) - 1)\n\nДоходности:\nR = ln(S(t+1)/S(t)) ~ N((μ-σ²/2)Δt, σ²Δt)\n\nОграничения модели:\n• Постоянная волатильность (не реалистично)\n• Непрерывные пути (нет скачков)\n• Тонкие хвосты (недооценивает extreme events)",features:["Базовая модель цен","Аналитические формулы","Основа для BSM","Простая калибровка"],howToUse:["Оцените μ и σ из исторических данных","Используйте для симуляции цен","Помните об ограничениях модели"],relatedItems:["monte-carlo","bsm","merton"]},{id:"hmm",code:"HMM",title:"Скрытые Марковские модели",category:"regimes",path:"/regimes",description:"Hidden Markov Model — статистическая модель для определения скрытых рыночных режимов (бычий/медвежий/боковой) по наблюдаемым доходностям.",formula:"P(Xₜ|Sₜ) × P(Sₜ|Sₜ₋₁)",formulaExplanation:"Компоненты HMM:\n\n1. Скрытые состояния (S):\n   • Обычно 2-4 режима\n   • Режим 1: низкая vol, позитивный дрифт (Bull)\n   • Режим 2: высокая vol, негативный дрифт (Bear)\n\n2. Матрица переходов (A):\n   A[i,j] = P(Sₜ = j | Sₜ₋₁ = i)\n   • Сумма строк = 1\n   • Диагональ — persistence\n\n3. Эмиссии (B):\n   P(Xₜ | Sₜ = i) ~ N(μᵢ, σᵢ²)\n   • Каждый режим имеет свои μ и σ\n\n4. Алгоритмы:\n   • Forward-Backward: P(S|X)\n   • Viterbi: наиболее вероятный путь\n   • Baum-Welch: оценка параметров (EM)\n\nСтационарное распределение π:\nπ = π × A (собственный вектор)\nπ[i] — долгосрочная вероятность режима i",features:["2-5 режимов (auto-select)","Матрица переходов","Regime probability timeline","Статистика по режимам","2D/3D visualization"],howToUse:["Загрузите исторические данные","Выберите количество режимов (или auto)","Обучите модель","Изучите характеристики режимов","Прогнозируйте текущий режим"],relatedItems:["spectral","regime-stats","portfolio"]},{id:"spectral",code:"SPEC",title:"Спектральный анализ режимов",category:"regimes",path:"/spectral-regime-analysis",description:"Продвинутый анализ динамики режимов через спектральное разложение. Выявление полюсов, оценка стабильности и периодичности.",formula:"G(z) = (zI - A)⁻¹",formulaExplanation:"Спектральный анализ матрицы переходов:\n\n1. Собственные значения A:\n   det(A - λI) = 0\n   • λ₁ = 1 (Perron-Frobenius)\n   • |λᵢ| < 1 для i > 1 (эргодичность)\n\n2. Mixing Time:\n   τ_mix ≈ 1 / (1 - |λ₂|)\n   Время сходимости к стационарному распределению\n\n3. Persistence:\n   P_stay[i] = A[i,i]\n   Expected duration = 1 / (1 - P_stay)\n\n4. Передаточная функция:\n   G(z) = (zI - A)⁻¹\n   Полюса = 1/собственные значения\n\n5. Stability Analysis:\n   • Все |λ| < 1 → стабильная система\n   • |λ| близко к 1 → медленное mixing\n\nМероморфное расширение для анализа\nскрытой структуры переходов",features:["Eigenvalue analysis","Pole detection","Stability metrics","Mixing time","Complex plane visualization"],howToUse:["Обучите HMM на данных","Запустите спектральный анализ","Изучите собственные значения","Оцените стабильность режимов"],relatedItems:["hmm","regime-stats"]},{id:"portfolio",code:"PORT",title:"Управление портфелем",category:"portfolio",path:"/portfolio",description:"Комплексный анализ инвестиционного портфеля: P&L, VaR, Sharpe Ratio, диверсификация, корреляции между активами.",formula:"R_p = Σ wᵢ×Rᵢ, σ_p² = w'Σw",formulaExplanation:"Метрики портфеля:\n\n1. Доходность портфеля:\n   R_p = Σ wᵢ × Rᵢ\n   где wᵢ — вес актива i\n\n2. Риск портфеля:\n   σ_p² = Σᵢ Σⱼ wᵢwⱼσᵢσⱼρᵢⱼ = w'Σw\n   Σ — ковариационная матрица\n\n3. Sharpe Ratio:\n   SR = (R_p - R_f) / σ_p\n\n4. Diversification Ratio:\n   DR = (Σ wᵢσᵢ) / σ_p\n   DR > 1 означает выигрыш от диверсификации\n\n5. Concentration (Herfindahl):\n   HHI = Σ wᵢ²\n   • HHI → 1: концентрация\n   • HHI → 1/N: равномерное распределение\n\n6. Correlation Contribution:\n   Вклад корреляций в общий риск",features:["KPI dashboard","Asset allocation chart","Top-5 positions","Correlation matrix","PDF export"],howToUse:["Выберите портфель из списка","Изучите KPI карточки","Просмотрите аллокацию по активам","Анализируйте корреляции","Экспортируйте отчёт в PDF"],relatedItems:["optimization","var","sharpe"]},{id:"optimization",code:"OPT",title:"Оптимизация портфеля",category:"portfolio",path:"/CCMVoptimization",description:"Поиск оптимальных весов активов для максимизации доходности при заданном уровне риска (Markowitz Mean-Variance) или с использованием HJB-оптимизации.",formula:"max w'μ - (γ/2)×w'Σw s.t. Σwᵢ=1",formulaExplanation:"Методы оптимизации:\n\n1. Mean-Variance (Markowitz):\n   min w'Σw (risk)\n   s.t. w'μ ≥ R_target\n        Σwᵢ = 1\n        wᵢ ≥ 0 (no short)\n\n   Или: max w'μ - (γ/2)×w'Σw\n   γ — параметр риск-аверсии\n\n2. Efficient Frontier:\n   Множество портфелей с минимальным\n   риском для каждого уровня доходности\n\n3. HJB (Hamilton-Jacobi-Bellman):\n   Динамическая оптимизация:\n   max E[∫ U(c_t)dt + U(W_T)]\n\n   w*(t) = (1/γ) × Σ⁻¹(μ - r)\n   Оптимальные веса зависят от\n   risk aversion и horizon\n\n4. CCMV (Cluster-Constrained):\n   Mean-Variance с ограничениями\n   на группы активов",features:["Markowitz optimization","HJB stochastic control","Efficient Frontier","Risk aversion tuning","Constraint handling"],howToUse:["Выберите активы для оптимизации","Задайте constraints (min/max weights)","Выберите метод (MV или HJB)","Найдите оптимальные веса","Сравните с текущим портфелем"],relatedItems:["portfolio","sharpe","var"]},{id:"sharpe",code:"SR",title:"Sharpe Ratio",category:"portfolio",description:"Коэффициент Шарпа — отношение избыточной доходности к волатильности. Стандартная мера risk-adjusted performance.",formula:"SR = (R_p - R_f) / σ_p",formulaExplanation:"Sharpe Ratio:\n\nSR = (R_p - R_f) / σ_p\n\nГде:\n• R_p — средняя доходность портфеля\n• R_f — безрисковая ставка\n• σ_p — стандартное отклонение доходности\n\nИнтерпретация:\n• SR < 0: портфель хуже безрисковой ставки\n• SR = 0-1: умеренная risk-adjusted доходность\n• SR = 1-2: хорошая performance\n• SR > 2: отличная performance\n\nAnnualized Sharpe:\nSR_annual = SR_daily × √252\n\nСвязанные метрики:\n• Sortino Ratio = (R_p - R_f) / σ_downside\n  (только downside volatility)\n\n• Information Ratio = (R_p - R_b) / σ_tracking\n  (относительно бенчмарка)\n\n• Calmar Ratio = CAGR / Max Drawdown",features:["Расчёт Sharpe","Annualization","Rolling Sharpe","Сравнение с бенчмарком","Связанные метрики"],howToUse:["Загрузите returns портфеля","Укажите безрисковую ставку","Получите Sharpe Ratio","Сравните с альтернативами"],relatedItems:["portfolio","backtest","optimization"]},{id:"terminal",code:"TERM",title:"Дзета-Терминал",category:"terminal",path:"/terminal",description:"Продвинутый торговый терминал с потоковыми данными в реальном времени. Акции, криптовалюты, фьючерсы, опционы.",features:["Real-time price updates","Order book depth","Multi-window layout","Custom widgets","Keyboard shortcuts (⌘K)"],howToUse:["Откройте терминал","Используйте ⌘K для command palette","Добавьте виджеты через Settings","Создавайте multiple windows"],relatedItems:["czf","wave-sigma","liquidity"]},{id:"czf",code:"CZF",title:"Citadel Zeta Field",category:"terminal",path:"/terminal",description:"3D визуализация гравитационного поля ликвидности. Частицы притягиваются к зонам высокой ликвидности.",features:["3D particle system","Gravity simulation","Liquidity zones","Real-time updates","Interactive controls"],relatedItems:["terminal","liquidity","wave-sigma"]},{id:"wave-sigma",code:"WSIG",title:"WAVE_σ.9 Surface",category:"terminal",path:"/terminal",description:"Momentum-Volatility топологическая поверхность. 3D визуализация динамики momentum и волатильности рынка.",features:["3D surface mesh","Momentum dynamics","Volatility mapping","Regime coloring","Trading simulation"],relatedItems:["terminal","volsurf","hmm"]},{id:"variance-gamma",code:"VG",title:"Variance Gamma процесс",category:"options",description:"Lévy-процесс с конечной вариацией и бесконечной активностью. Лучше описывает распределение доходностей с толстыми хвостами.",formula:"X(t) = θG(t) + σW(G(t))",formulaExplanation:"Variance Gamma Process:\n\nX(t) = θG(t) + σW(G(t))\n\nГде:\n• G(t) — Gamma process с параметром ν\n• W(t) — Brownian motion\n• θ — дрифт (skewness control)\n• σ — волатильность\n• ν — variance rate (kurtosis control)\n\nХарактеристическая функция:\nφ(u) = (1 - iuθν + σ²u²ν/2)^(-t/ν)\n\nСвойства:\n• Конечные моменты всех порядков\n• Толстые хвосты (kurtosis > 3)\n• Асимметрия (skewness ≠ 0)\n• Нет непрерывных путей (pure jump)\n\nPricing через FFT более эффективен",features:["Lévy process","Fat tails","Skewness control","FFT pricing","Calibration"],relatedItems:["merton","bsm","fft"]},{id:"bates",code:"BATES",title:"Модель Бейтса",category:"options",description:"Комбинация Heston (stochastic volatility) и Merton (jumps). Наиболее гибкая модель для ценообразования опционов.",formula:"dS = (μ-λk)Sdt + √V·S·dW₁ + S(e^J-1)dN",formulaExplanation:"Модель Бейтса (SVJ):\n\ndSₜ = (μ - λk)Sₜdt + √Vₜ·Sₜ·dW₁ + Sₜ(e^J - 1)dNₜ\ndVₜ = κ(θ - Vₜ)dt + ξ√Vₜ·dW₂\n\nКомпоненты:\n• Stochastic Volatility (от Heston):\n  - κ: mean reversion speed\n  - θ: long-run variance\n  - ξ: vol of vol\n  - ρ: correlation\n\n• Jumps (от Merton):\n  - λ: jump intensity\n  - μⱼ: mean jump size\n  - σⱼ: jump size volatility\n\nПреимущества:\n• Улыбка волатильности\n• Толстые хвосты\n• Asymmetry (leverage + jumps)\n• Flexible calibration",features:["Stochastic volatility","Jump diffusion","8 parameters","Most flexible model","Calibration intensive"],relatedItems:["heston","merton","volsurf"]}],O=["onClick"],j={class:"label-text font-oswald"},q={class:"label-count font-mono"},$={class:"kb-header"},J={class:"header-actions"},X={key:0,class:"kb-hero"},Y={class:"hero-subtitle font-mono"},Z={class:"panel-content custom-scrollbar"},Q={class:"panel-meta"},nn={class:"panel-title font-anton"},en={class:"panel-desc font-mono"},an={class:"panel-items"},tn=["onClick"],on={class:"item-header"},rn={class:"item-title font-oswald"},ln={class:"item-desc font-mono"},sn={class:"item-tags"},dn={key:0,class:"item-tag formula font-mono"},cn={key:1,class:"item-tag path font-mono"},un={class:"search-modal"},mn={class:"search-box"},pn={key:0,class:"search-results custom-scrollbar"},vn=["onClick"],fn={class:"result-info"},hn={class:"result-title font-oswald"},yn={class:"result-category font-mono"},gn={key:1,class:"search-empty font-mono"},wn={class:"modal-content custom-scrollbar"},Sn={class:"modal-header"},xn={class:"modal-title font-anton"},Rn={class:"modal-code font-mono"},kn={class:"modal-body"},Pn={key:0,class:"modal-section"},bn={class:"section-text font-mono"},Cn={key:1,class:"modal-section"},Tn={class:"formula-code font-mono"},Mn={key:2,class:"modal-section formula-explanation"},Vn={class:"explanation-text font-mono"},En={key:3,class:"modal-section"},_n={class:"feature-list"},In={key:4,class:"modal-section"},Dn={class:"howto-list"},Fn={key:0,class:"modal-footer"},An={key:1,class:"kb-nav-bar"},Bn=["onClick"],zn={class:"nav-name font-oswald"},Hn={class:"nav-count font-mono"},Nn={key:2,class:"kb-footer"},Ln={class:"footer-stats"},Un={class:"stat-value font-anton"},Wn={class:"stat-label font-mono"},Kn=300,Gn=1500,On=W(n({__name:"KnowledgeBase",setup(W){const On=e(null),jn=e(null),qn=e(null),$n=e({x:0,y:0}),Jn=e(!1),Xn=e(""),Yn=e(!1),Zn=e(null),Qn=e(null),ne=e(null),ee=e([]),ae=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),x("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),x("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})])}),te=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),x("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),x("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})])}),oe=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),x("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})])}),ie=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("polyline",{points:"4 17 10 11 4 5"}),x("line",{x1:"12",y1:"19",x2:"20",y2:"19"})])}),re=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),x("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),x("line",{x1:"6",y1:"20",x2:"6",y2:"14"})])}),le=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("circle",{cx:"12",cy:"12",r:"10"}),x("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})])}),se=n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("path",{d:"M2 20h.01"}),x("path",{d:"M7 20v-4"}),x("path",{d:"M12 20v-8"}),x("path",{d:"M17 20V8"}),x("path",{d:"M22 4v16"})])}),de={options:oe,bonds:re,swaps:n({render:()=>x("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[x("polyline",{points:"17 1 21 5 17 9"}),x("path",{d:"M3 5h18"}),x("polyline",{points:"7 23 3 19 7 15"}),x("path",{d:"M21 19H3"})])}),risk:te,simulation:se,regimes:le,portfolio:ae,terminal:ie},ce=a(()=>K.map(n=>({...n,icon:de[n.id]||ae}))),ue=a(()=>ce.value.find(n=>n.id===Zn.value)),me=a(()=>G),pe=a(()=>[{value:me.value.length+"+",label:"Документов"},{value:ce.value.length,label:"Созвездий"},{value:me.value.filter(n=>n.formula).length+"+",label:"Формул"},{value:"37+",label:"Страниц"}]),ve=a(()=>me.value.length),fe=a(()=>Xn.value?(n=>{const e=n.toLowerCase();return G.filter(n=>n.title.toLowerCase().includes(e)||n.code.toLowerCase().includes(e)||n.description.toLowerCase().includes(e)||n.formula?.toLowerCase().includes(e))})(Xn.value):[]),he=n=>{return e=n,G.filter(n=>n.category===e);var e},ye=n=>ce.value.find(e=>e.id===n)?.color||"#666",ge=n=>ce.value.find(e=>e.id===n)?.name||"",we=n=>{Zn.value=n},Se=()=>{Zn.value=null},xe=n=>{Qn.value=n};let Re,ke,Pe,be,Ce=new A,Te=new U,Me=new L,Ve=[];const Ee=(n,e,a,t)=>{const o=new D,i=new Float32Array(900),r=new Float32Array(Kn),l=new Float32Array(900),s=new Float32Array(Kn),d=new F(n.color),c=new A(e,a,20*(Math.random()-.5));for(let p=0;p<Kn;p++){const n=3*p,e=p/Kn*Math.PI*6+.5*t,a=3+p/Kn*12+3*Math.random(),o=2*Math.sin(2*e);i[n]=c.x+Math.cos(e)*a+o+4*(Math.random()-.5),i[n+1]=c.y+Math.sin(e)*a*.6+3*(Math.random()-.5),i[n+2]=c.z+8*(Math.random()-.5);const u=Math.sqrt(Math.pow(i[n]-c.x,2)+Math.pow(i[n+1]-c.y,2));r[p]=Math.max(.5,3-.15*u)*(.5+.5*Math.random());const m=.7+.3*Math.random();l[n]=d.r*m,l[n+1]=d.g*m,l[n+2]=d.b*m,s[p]=Math.random()}o.setAttribute("position",new B(i,3)),o.setAttribute("size",new B(r,1)),o.setAttribute("color",new B(l,3)),o.setAttribute("aRandom",new B(s,1));const u=new z({uniforms:{uTime:{value:0},uMouse:{value:new A},uHovered:{value:0}},vertexShader:`\n      attribute float size;\n      attribute vec3 color;\n      attribute float aRandom;\n      varying vec3 vColor;\n      varying float vAlpha;\n      uniform float uTime;\n      uniform vec3 uMouse;\n      uniform float uHovered;\n\n      void main() {\n        vColor = color;\n        vec3 pos = position;\n\n        // Orbital motion\n        float angle = uTime * (0.1 + aRandom * 0.1);\n        float dist = length(pos.xy - vec2(${c.x.toFixed(1)}, ${c.y.toFixed(1)}));\n        pos.x += sin(angle + dist * 0.1) * 0.5;\n        pos.y += cos(angle + dist * 0.1) * 0.3;\n\n        // Breathing effect\n        float breathe = sin(uTime * 0.5 + aRandom * 6.28) * 0.3;\n        pos.xy += normalize(pos.xy - vec2(${c.x.toFixed(1)}, ${c.y.toFixed(1)})) * breathe;\n\n        // Mouse repulsion\n        float mouseDist = distance(pos.xy, uMouse.xy);\n        float influence = smoothstep(25.0, 0.0, mouseDist);\n        vec2 dir = normalize(pos.xy - uMouse.xy + 0.001);\n        pos.xy += dir * influence * 5.0;\n\n        // Hover expansion\n        pos.xy += normalize(pos.xy - vec2(${c.x.toFixed(1)}, ${c.y.toFixed(1)})) * uHovered * 3.0;\n\n        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n        gl_PointSize = size * (250.0 / -mvPosition.z) * (1.0 + uHovered * 0.5);\n        gl_Position = projectionMatrix * mvPosition;\n\n        vAlpha = 0.8 + uHovered * 0.2;\n      }\n    `,fragmentShader:"\n      varying vec3 vColor;\n      varying float vAlpha;\n\n      void main() {\n        float dist = length(gl_PointCoord - vec2(0.5));\n        if (dist > 0.5) discard;\n\n        float glow = 1.0 - smoothstep(0.0, 0.5, dist);\n        float core = 1.0 - smoothstep(0.0, 0.2, dist);\n\n        vec3 finalColor = vColor * glow + vec3(1.0) * core * 0.3;\n        float alpha = glow * vAlpha;\n\n        gl_FragColor = vec4(finalColor, alpha);\n      }\n    ",transparent:!0,depthWrite:!1,blending:H}),m=new N(o,u);return m.userData={clusterId:n.id,center:c},{id:n.id,name:n.name,color:d,center:c,particles:m,count:he(n.id).length}},_e=()=>{const n=new D,e=new Float32Array(4500),a=new Float32Array(Gn),t=new Float32Array(4500);for(let r=0;r<Gn;r++){const n=3*r;e[n]=300*(Math.random()-.5),e[n+1]=200*(Math.random()-.5),e[n+2]=-50-100*Math.random(),a[r]=1.5*Math.random();const o=.3+.4*Math.random();t[n]=o,t[n+1]=o,t[n+2]=o}n.setAttribute("position",new B(e,3)),n.setAttribute("size",new B(a,1)),n.setAttribute("color",new B(t,3));const o=new z({uniforms:{uTime:{value:0}},vertexShader:"\n      attribute float size;\n      attribute vec3 color;\n      varying vec3 vColor;\n      varying float vAlpha;\n      uniform float uTime;\n\n      void main() {\n        vColor = color;\n\n        vec3 pos = position;\n        pos.z += sin(uTime * 0.1 + position.x * 0.01) * 2.0;\n\n        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n        gl_PointSize = size * (150.0 / -mvPosition.z);\n        gl_Position = projectionMatrix * mvPosition;\n\n        float twinkle = sin(uTime * 2.0 + position.x + position.y) * 0.3 + 0.7;\n        vAlpha = twinkle;\n      }\n    ",fragmentShader:"\n      varying vec3 vColor;\n      varying float vAlpha;\n\n      void main() {\n        float dist = length(gl_PointCoord - vec2(0.5));\n        if (dist > 0.5) discard;\n\n        float alpha = smoothstep(0.5, 0.0, dist) * vAlpha * 0.6;\n        gl_FragColor = vec4(vColor, alpha);\n      }\n    ",transparent:!0,depthWrite:!1,blending:H}),i=new N(n,o);i.userData={isBackground:!0},Re.add(i)},Ie=()=>{if(!ke||!Pe)return;const n=[];Ve.forEach(e=>{const a=e.center.clone().project(ke),t=(.5*a.x+.5)*window.innerWidth,o=(.5*-a.y+.5)*window.innerHeight,i=ce.value.find(n=>n.id===e.id);n.push({id:e.id,name:i?.name||e.id,count:e.count,color:i?.color||"#ffffff",x:t,y:o,visible:a.z<1&&t>0&&t<window.innerWidth&&o>0&&o<window.innerHeight})}),ee.value=n},De=()=>{be=requestAnimationFrame(De);const n=.001*performance.now();Re.children.forEach(e=>{if(e instanceof N&&e.material instanceof z&&(e.material.uniforms.uTime.value=n,e.material.uniforms.uMouse.value=Ce,e.userData.clusterId)){const n=ne.value?.id===e.userData.clusterId;e.material.uniforms.uHovered.value+=.1*(n?1:0-e.material.uniforms.uHovered.value)}}),ke.position.x=3*Math.sin(.1*n),ke.position.y=2*Math.cos(.08*n),ke.lookAt(0,0,0),Ie(),Pe.render(Re,ke)},Fe=n=>{if($n.value={x:n.clientX,y:n.clientY},Me.x=n.clientX/window.innerWidth*2-1,Me.y=-n.clientY/window.innerHeight*2+1,Ce.set(60*Me.x,40*Me.y,0),ke&&Re){Te.setFromCamera(Me,ke);let n=null;for(const e of Ve){if(Te.ray.distanceToPoint(e.center)<15){const a=ce.value.find(n=>n.id===e.id);n={id:e.id,color:a?.color||"#ffffff"};break}}ne.value=n,jn.value&&(jn.value.style.cursor=n?"pointer":"default")}},Ae=n=>{ne.value&&(Zn.value=ne.value.id)},Be=()=>{Jn.value=!0},ze=()=>{Jn.value=!1,ne.value=null},He=()=>{Pe&&ke&&(ke.aspect=window.innerWidth/window.innerHeight,ke.updateProjectionMatrix(),Pe.setSize(window.innerWidth,window.innerHeight),Ie())},Ne=n=>{(n.metaKey||n.ctrlKey)&&"k"===n.key&&(n.preventDefault(),Yn.value=!0,R(()=>qn.value?.focus())),"Escape"===n.key&&(Yn.value?Yn.value=!1:Qn.value?Qn.value=null:Zn.value&&(Zn.value=null))};return t(()=>{(()=>{if(!jn.value)return;Re=new E,ke=new _(60,window.innerWidth/window.innerHeight,.1,1e3),ke.position.z=100,Pe=new I({canvas:jn.value,alpha:!0,antialias:!0}),Pe.setSize(window.innerWidth,window.innerHeight),Pe.setPixelRatio(Math.min(window.devicePixelRatio,2));const n=[{x:-50,y:30},{x:0,y:40},{x:50,y:30},{x:-40,y:-5},{x:40,y:-5},{x:-50,y:-35},{x:0,y:-40},{x:50,y:-35}];ce.value.forEach((e,a)=>{const t=n[a%n.length],o=Ee(e,t.x,t.y,a);Ve.push(o),Re.add(o.particles)}),_e(),Ie(),De()})(),window.addEventListener("mousemove",Fe),window.addEventListener("click",Ae),window.addEventListener("resize",He),window.addEventListener("keydown",Ne),On.value&&(On.value.addEventListener("mouseenter",Be),On.value.addEventListener("mouseleave",ze))}),o(()=>{be&&cancelAnimationFrame(be),Pe&&Pe.dispose(),Ve=[],window.removeEventListener("mousemove",Fe),window.removeEventListener("click",Ae),window.removeEventListener("resize",He),window.removeEventListener("keydown",Ne)}),i(Yn,n=>{n?R(()=>qn.value?.focus()):Xn.value=""}),(n,e)=>{const a=y("router-link");return k(),r("div",{class:"kb-root",ref_key:"rootRef",ref:On},[l("canvas",{ref_key:"canvasRef",ref:jn,class:"kb-canvas"},null,512),e[22]||(e[22]=l("div",{class:"bg-noise"},null,-1)),l("div",{class:"cursor-glow",style:c({left:`${$n.value.x}px`,top:`${$n.value.y}px`,opacity:Jn.value?1:0,background:ne.value?`radial-gradient(circle, ${ne.value.color}30 0%, transparent 70%)`:void 0})},null,4),(k(!0),r(u,null,m(ee.value,n=>(k(),r("div",{key:n.id,class:p(["cluster-label",{active:Zn.value===n.id,hovered:ne.value?.id===n.id}]),style:c({left:`${n.x}px`,top:`${n.y}px`,"--accent":n.color,opacity:n.visible?1:0,pointerEvents:n.visible?"auto":"none"}),onClick:e=>we(n.id)},[l("div",{class:"label-dot",style:c({background:n.color})},null,4),l("span",j,v(n.name),1),l("span",q,v(n.count),1)],14,O))),128)),l("header",$,[l("div",{class:"kb-logo",onClick:e[0]||(e[0]=e=>n.$router.push("/"))},[...e[7]||(e[7]=[l("span",{class:"logo-symbol font-anton"},"ζ",-1),l("span",{class:"logo-text font-oswald"},"STOCHASTIC",-1)])]),e[10]||(e[10]=l("div",{class:"header-center"},[l("span",{class:"header-title font-mono"},"KNOWLEDGE BASE"),l("span",{class:"header-version font-mono"},"v3.0")],-1)),l("div",J,[l("button",{class:"search-trigger",onClick:e[1]||(e[1]=n=>Yn.value=!0)},[...e[8]||(e[8]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("circle",{cx:"11",cy:"11",r:"8"}),l("path",{d:"m21 21-4.35-4.35"})],-1),l("span",{class:"font-mono"},"⌘K",-1)])]),f(a,{to:"/terminal",class:"terminal-btn font-oswald"},{default:h(()=>[...e[9]||(e[9]=[P(" ТЕРМИНАЛ → ",-1)])]),_:1})])]),Zn.value?s("",!0):(k(),r("section",X,[e[11]||(e[11]=g('<div class="hero-badge font-mono" data-v-a7544f4f><span class="badge-dot" data-v-a7544f4f></span> INTERACTIVE GALAXY </div><h1 class="hero-title font-anton" data-v-a7544f4f><span class="title-line" data-v-a7544f4f>БАЗА</span><span class="title-line accent" data-v-a7544f4f>ЗНАНИЙ</span></h1>',2)),l("p",Y,v(ve.value)+" документов · "+v(ce.value.length)+" созвездий · Кликните на скопление для навигации ",1),e[12]||(e[12]=l("div",{class:"hero-hint font-mono"}," Выберите категорию ниже или используйте ⌘K для поиска ",-1))])),(k(),d(S,{to:"body"},[f(w,{name:"panel"},{default:h(()=>[Zn.value?(k(),r("div",{key:0,class:"category-panel",onClick:b(Se,["self"])},[l("div",Z,[l("button",{class:"panel-close",onClick:Se},[...e[13]||(e[13]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),l("div",{class:"panel-header",style:c({"--accent":ue.value?.color})},[l("div",{class:"panel-icon",style:c({background:ue.value?.color})},[(k(),d(C(ue.value?.icon)))],4),l("div",Q,[l("h2",nn,v(ue.value?.name),1),l("p",en,v(ue.value?.longDescription),1)])],4),l("div",an,[(k(!0),r(u,null,m(he(Zn.value),n=>(k(),r("div",{key:n.id,class:"panel-item",onClick:e=>xe(n)},[l("div",on,[l("span",{class:"item-code font-mono",style:c({color:ue.value?.color})},v(n.code),5),l("span",rn,v(n.title),1)]),l("p",ln,v(n.description?.slice(0,100))+"...",1),l("div",sn,[n.formula?(k(),r("span",dn,"Формула")):s("",!0),n.path?(k(),r("span",cn,"Страница")):s("",!0)])],8,tn))),128))])])])):s("",!0)]),_:1})])),(k(),d(S,{to:"body"},[f(w,{name:"modal"},{default:h(()=>[Yn.value?(k(),r("div",{key:0,class:"search-overlay",onClick:e[4]||(e[4]=b(n=>Yn.value=!1,["self"]))},[l("div",un,[l("div",mn,[e[14]||(e[14]=l("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("circle",{cx:"11",cy:"11",r:"8"}),l("path",{d:"m21 21-4.35-4.35"})],-1)),T(l("input",{ref_key:"searchInputRef",ref:qn,"onUpdate:modelValue":e[2]||(e[2]=n=>Xn.value=n),type:"text",placeholder:"Поиск по базе знаний...",class:"search-input font-mono",onKeydown:e[3]||(e[3]=V(n=>Yn.value=!1,["escape"]))},null,544),[[M,Xn.value]])]),fe.value.length?(k(),r("div",pn,[(k(!0),r(u,null,m(fe.value.slice(0,10),n=>(k(),r("div",{key:n.id,class:"search-result",onClick:e=>{xe(n),Yn.value=!1}},[l("div",{class:"result-icon",style:c({background:ye(n.category)})},v(n.code.slice(0,2)),5),l("div",fn,[l("span",hn,v(n.title),1),l("span",yn,v(ge(n.category)),1)])],8,vn))),128))])):Xn.value?(k(),r("div",gn," Ничего не найдено ")):s("",!0)])])):s("",!0)]),_:1})])),(k(),d(S,{to:"body"},[f(w,{name:"modal"},{default:h(()=>[Qn.value?(k(),r("div",{key:0,class:"modal-overlay",onClick:e[6]||(e[6]=b(n=>Qn.value=null,["self"]))},[l("div",wn,[l("button",{class:"modal-close",onClick:e[5]||(e[5]=n=>Qn.value=null)},[...e[15]||(e[15]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),l("div",Sn,[l("span",{class:"modal-badge font-mono",style:c({background:ye(Qn.value.category)})},v(ge(Qn.value.category)),5),l("h2",xn,v(Qn.value.title),1),l("p",Rn,v(Qn.value.code),1)]),l("div",kn,[Qn.value.description?(k(),r("div",Pn,[e[16]||(e[16]=l("h4",{class:"section-title font-oswald"},"Описание",-1)),l("p",bn,v(Qn.value.description),1)])):s("",!0),Qn.value.formula?(k(),r("div",Cn,[e[17]||(e[17]=l("h4",{class:"section-title font-oswald"},"Формула",-1)),l("code",Tn,v(Qn.value.formula),1)])):s("",!0),Qn.value.formulaExplanation?(k(),r("div",Mn,[e[18]||(e[18]=l("h4",{class:"section-title font-oswald"},"Объяснение",-1)),l("pre",Vn,v(Qn.value.formulaExplanation),1)])):s("",!0),Qn.value.features?.length?(k(),r("div",En,[e[19]||(e[19]=l("h4",{class:"section-title font-oswald"},"Функции",-1)),l("ul",_n,[(k(!0),r(u,null,m(Qn.value.features,(n,e)=>(k(),r("li",{key:e,class:"font-mono"},v(n),1))),128))])])):s("",!0),Qn.value.howToUse?.length?(k(),r("div",In,[e[20]||(e[20]=l("h4",{class:"section-title font-oswald"},"Как использовать",-1)),l("ol",Dn,[(k(!0),r(u,null,m(Qn.value.howToUse,(n,e)=>(k(),r("li",{key:e,class:"font-mono"},v(n),1))),128))])])):s("",!0)]),Qn.value.path?(k(),r("div",Fn,[f(a,{to:Qn.value.path,class:"modal-btn primary font-oswald"},{default:h(()=>[...e[21]||(e[21]=[P(" Открыть страницу → ",-1)])]),_:1},8,["to"])])):s("",!0)])])):s("",!0)]),_:1})])),Zn.value?s("",!0):(k(),r("nav",An,[(k(!0),r(u,null,m(ce.value,n=>(k(),r("button",{key:n.id,class:"nav-category",style:c({"--accent":n.color}),onClick:e=>we(n.id)},[l("span",{class:"nav-dot",style:c({background:n.color})},null,4),l("span",zn,v(n.name),1),l("span",Hn,v(he(n.id).length),1)],12,Bn))),128))])),Zn.value?s("",!0):(k(),r("footer",Nn,[l("div",Ln,[(k(!0),r(u,null,m(pe.value,n=>(k(),r("div",{class:"stat-item",key:n.label},[l("span",Un,v(n.value),1),l("span",Wn,v(n.label),1)]))),128))])]))],512)}}}),[["__scopeId","data-v-a7544f4f"]]);export{On as default};
