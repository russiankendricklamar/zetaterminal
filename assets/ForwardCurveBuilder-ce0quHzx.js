import{d as a,r as e,v as l,o as t,R as s,c as d,e as r,x as o,L as i,C as n,F as c,i as u,t as v,y as p,n as b,S as m,k as f,q as h}from"./vendor-DLyKmMu8.js";import{C as y}from"./auto-DlDBEVoY.js";import{_ as g}from"./index-AoYxWDki.js";const R={class:"forward-curve-page"},w={class:"page-header"},C={class:"header-right"},x={class:"control-group"},F={class:"control-group"},k={class:"card full-width"},Y={class:"market-data-container"},S={class:"data-table-wrapper"},U={class:"market-data-table"},M={class:"col-tenor"},V={class:"col-price"},q=["onUpdate:modelValue"],D={class:"col-yield"},E=["onUpdate:modelValue"],_={class:"col-forward mono"},W={class:"col-action"},j=["onClick"],A={class:"grid-2"},B={class:"card"},T={class:"chart-container"},L={class:"card"},I={class:"chart-container"},P={class:"grid-3"},O={class:"metric-card"},$={class:"metric-detail"},z={class:"detail-value"},G={class:"metric-card"},N={class:"metric-value accent"},Z={class:"metric-detail"},H={class:"detail-value"},J={class:"metric-card"},K={class:"metric-value blue"},Q={class:"metric-detail"},X={class:"detail-value"},aa={class:"card full-width"},ea={class:"forward-rates-table-container"},la={class:"forward-rates-table"},ta={class:"period-name"},sa={class:"rate-value mono"},da={class:"rate-value mono"},ra={class:"rate-value cyan mono"},oa={class:"rate-value blue mono"},ia={class:"grid-2"},na={class:"card"},ca={class:"interpolation-options"},ua=["id","value"],va=["for"],pa={class:"method-name"},ba={class:"method-desc"},ma={class:"card"},fa={class:"parameters-list"},ha={class:"param-item"},ya={class:"param-item"},ga={class:"param-item"},Ra={class:"param-item"},wa={class:"grid-2"},Ca={class:"card"},xa={class:"butterfly-metrics"},Fa={class:"butterfly-item"},ka={class:"value accent"},Ya={class:"butterfly-item"},Sa={class:"value accent"},Ua={class:"butterfly-item"},Ma={class:"value blue"},Va={class:"butterfly-item"},qa={class:"card full-width"},Da={class:"fitting-stats"},Ea={class:"stat-item"},_a={class:"stat-value"},Wa={class:"quality-bar"},ja={class:"stat-item"},Aa={class:"stat-value"},Ba={class:"stat-item"},Ta={class:"stat-value"},La={class:"stat-item"},Ia={class:"stat-value"},Pa={class:"card full-width"},Oa={class:"chart-container tall"},$a={class:"card full-width"},za={class:"detailed-stats-container"},Ga={class:"detailed-stats-table"},Na={class:"tenor"},Za={class:"rate mono"},Ha={class:"rate mono"},Ja={class:"rate mono"},Ka={class:"rate mono"},Qa={class:"rate mono"},Xa={class:"rate mono"},ae={class:"page-footer"},ee=g(a({__name:"ForwardCurveBuilder",setup(a){const g=e("bonds"),ee=e("forward"),le=e("cubic-spline"),te=e([{tenor:"3M",price:98.5,yield:4.2,forwardRate:4.25},{tenor:"6M",price:97.8,yield:4.35,forwardRate:4.45},{tenor:"1Y",price:96.2,yield:4.4,forwardRate:4.5},{tenor:"2Y",price:93.5,yield:4.5,forwardRate:4.6},{tenor:"3Y",price:90.2,yield:4.55,forwardRate:4.65},{tenor:"5Y",price:84.5,yield:4.65,forwardRate:4.75},{tenor:"10Y",price:72.3,yield:4.75,forwardRate:4.85}]),se=e({baseRate:4.2,longTermRate:4.8,volatility:12.5,meanReversionSpeed:.15}),de=e([{id:"linear",name:"Linear Interpolation",description:"Простая линейная интерполяция"},{id:"cubic-spline",name:"Cubic Spline",description:"Кубические сплайны (гладкая кривая)"},{id:"nelson-siegel",name:"Nelson-Siegel",description:"Параметрическая модель"},{id:"vasicek",name:"Vasicek Model",description:"Стохастическая модель"}]),re=l(()=>{const a=te.value.map(a=>a.forwardRate),e=Math.min(...a),l=Math.max(...a),t=a.reduce((a,e)=>a+e)/a.length,s=(a[a.length-1]-a[0])/(a.length-1),d=te.value.find(a=>"2Y"===a.tenor)?.forwardRate||0,r=100*((te.value.find(a=>"10Y"===a.tenor)?.forwardRate||0)-d);let o=0;for(let i=1;i<a.length-1;i++)o+=a[i+1]-2*a[i]+a[i-1];return o/=a.length-2,{slope:s,avgForwardRate:t,minRate:e,maxRate:l,spread2y10y:r,convexity:o}}),oe=l(()=>{const a=[];for(let e=0;e<te.value.length-1;e++){const l=te.value[e],t=te.value[e+1],s=l.yield,d=(l.yield+t.yield)/2,r=t.yield+.5*(t.yield-l.yield),o=t.yield,i=100*(o-r);a.push({period:`${l.tenor} - ${t.tenor}`,spotRate:s,zcYield:d,forwardRate:r,impliedRate:o,spread:i,outlier:Math.abs(i)>5})}return a}),ie=l(()=>{const a=te.value.find(a=>"2Y"===a.tenor)?.forwardRate||0,e=te.value.find(a=>"5Y"===a.tenor)?.forwardRate||0,l=te.value.find(a=>"10Y"===a.tenor)?.forwardRate||0;return{fly25:(a+e)/2-a,fly510:(e+l)/2-e,butterfly:e-(a+l)/2,convexity:100*(a-2*e+l)}}),ne=e({rSquared:.9876,rmse:.0032,mae:.0024,maxError:.0085}),ce=l(()=>te.value.map((a,e)=>{const l=a.yield/100,t=e,s=Math.exp(-l*t),d=t*s,r=t*t*s;return{tenor:a.tenor,spotRate:a.yield,forwardRate:a.forwardRate,yieldCurve:(a.yield+a.forwardRate)/2,discountFactor:s,duration:d,convexity:r}})),ue=e(null),ve=e(null),pe=e(null);let be=null,me=null,fe=null;const he=()=>{const a=re.value.slope;return a>.5?"Крутая":a>.1?"Умеренно крутая":a>-.1?"Плоская":"Инвертированная"},ye=()=>{te.value.push({tenor:1.5*te.value.length+"M",price:95,yield:4.5,forwardRate:4.55}),ge()},ge=()=>{we()},Re=()=>{const a=[["Forward Curve Export",(new Date).toISOString()],[""],["Tenor","Spot Rate","Forward Rate","Yield"],...te.value.map(a=>[a.tenor,a.price,a.forwardRate,a.yield])].map(a=>a.join(",")).join("\n"),e=new Blob([a],{type:"text/csv"}),l=window.URL.createObjectURL(e),t=document.createElement("a");t.href=l,t.download=`forward-curve-${(new Date).toISOString()}.csv`,t.click()},we=()=>{be&&be.destroy(),me&&me.destroy(),fe&&fe.destroy();const a=te.value.map(a=>a.tenor),e=te.value.map(a=>a.forwardRate),l=te.value.map(a=>a.yield);if(ue.value?.getContext("2d")&&(be=new y(ue.value.getContext("2d"),{type:"line",data:{labels:a,datasets:[{label:"Forward Curve",data:e,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:5,pointBackgroundColor:"#60a5fa",pointBorderColor:"#fff",borderWidth:2},{label:"Spot Curve",data:l,borderColor:"#38bdf8",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:4,borderDash:[5,5],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),ve.value?.getContext("2d")){const t=e.map((a,e)=>100*(a-l[e]));me=new y(ve.value.getContext("2d"),{type:"bar",data:{labels:a,datasets:[{label:"Forward - Spot (bp)",data:t,backgroundColor:t.map(a=>a>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)"),borderColor:t.map(a=>a>=0?"#4ade80":"#f87171"),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(pe.value?.getContext("2d")){const l=e.map(a=>a+1),t=e.map((a,e)=>a+.15*e),s=e.map((a,e)=>a-.08*e);fe=new y(pe.value.getContext("2d"),{type:"line",data:{labels:a,datasets:[{label:"Current Curve",data:e,borderColor:"#60a5fa",backgroundColor:"transparent",tension:.4,pointRadius:3,borderWidth:2},{label:"Bulk +100bp",data:l,borderColor:"#4ade80",backgroundColor:"transparent",tension:.4,pointRadius:0,borderDash:[5,5],borderWidth:1.5},{label:"Steepening",data:t,borderColor:"#f59e0b",backgroundColor:"transparent",tension:.4,pointRadius:0,borderDash:[5,5],borderWidth:1.5},{label:"Flattening",data:s,borderColor:"#f87171",backgroundColor:"transparent",tension:.4,pointRadius:0,borderDash:[5,5],borderWidth:1.5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}};return t(()=>{we()}),s(()=>{be&&be.destroy(),me&&me.destroy(),fe&&fe.destroy()}),(a,e)=>(h(),d("div",R,[r("div",w,[e[11]||(e[11]=r("div",{class:"header-left"},[r("h1",{class:"page-title"},"Построение форвардной кривой"),r("p",{class:"page-subtitle"},"Построение форвардной кривой и анализ структуры сроков")],-1)),r("div",C,[r("div",x,[e[8]||(e[8]=r("label",{class:"control-label"},"Инструмент:",-1)),o(r("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),class:"instrument-select",onChange:ge},[...e[7]||(e[7]=[n('<option value="bonds" data-v-f1815dae>Кривая по форварду на облигацию</option><option value="fx" data-v-f1815dae>Валютная форвардная кривая</option><option value="rates" data-v-f1815dae>Кривая форварда на процентную ставку</option><option value="commodities" data-v-f1815dae>Форвардная кривая на товар</option><option value="equity" data-v-f1815dae>Кривая форварда на акцию</option>',5)])],544),[[i,g.value]])]),r("div",F,[e[10]||(e[10]=r("label",{class:"control-label"},"Тип кривой:",-1)),o(r("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>ee.value=a),class:"curve-type-select",onChange:ge},[...e[9]||(e[9]=[r("option",{value:"spot"},"Спот-кривая",-1),r("option",{value:"forward"},"Форвардная кривая",-1),r("option",{value:"implicit"},"Неявная форвардная кривая",-1)])],544),[[i,ee.value]])]),r("button",{onClick:Re,class:"btn-secondary"}," Экспортировать ")])]),r("div",k,[e[13]||(e[13]=r("div",{class:"card-header"},[r("h3",null,"Рыночные данные для кривой"),r("span",{class:"card-subtitle"},"Введите спот и форвардные цены или ставки")],-1)),r("div",Y,[r("div",S,[r("table",U,[e[12]||(e[12]=r("thead",null,[r("tr",null,[r("th",{class:"col-tenor"},"Tenor"),r("th",{class:"col-price"},"Спот / Цена"),r("th",{class:"col-yield"},"Доходность (%)"),r("th",{class:"col-forward"},"Форвардная ставка")])],-1)),r("tbody",null,[(h(!0),d(c,null,u(te.value,(a,e)=>(h(),d("tr",{key:e},[r("td",M,v(a.tenor),1),r("td",V,[o(r("input",{"onUpdate:modelValue":e=>a.price=e,type:"number",class:"input-small",step:"0.01",onChange:ge},null,40,q),[[p,a.price,void 0,{number:!0}]])]),r("td",D,[o(r("input",{"onUpdate:modelValue":e=>a.yield=e,type:"number",class:"input-small",step:"0.01",onChange:ge},null,40,E),[[p,a.yield,void 0,{number:!0}]])]),r("td",_,v(a.forwardRate.toFixed(3))+"%",1),r("td",W,[r("button",{onClick:a=>(a=>{te.value.splice(a,1),ge()})(e),class:"btn-remove"},"×",8,j)])]))),128))])])]),r("button",{onClick:ye,class:"btn-add-point"},"+ Добавить точку")])]),r("div",A,[r("div",B,[e[14]||(e[14]=r("div",{class:"chart-header"},[r("h3",null,"Форвардная кривая"),r("span",{class:"chart-subtitle"},"Структура сроков")],-1)),r("div",T,[r("canvas",{ref_key:"forwardCurveRef",ref:ue},null,512)])]),r("div",L,[e[15]||(e[15]=r("div",{class:"chart-header"},[r("h3",null,"Форвардные ставки vs спот")],-1)),r("div",I,[r("canvas",{ref_key:"spreadChartRef",ref:ve},null,512)])])]),r("div",P,[r("div",O,[e[17]||(e[17]=r("div",{class:"metric-header"},[r("h3",null,"Наклон кривой"),r("span",{class:"metric-unit"},"Наклон кривой")],-1)),r("div",{class:b(["metric-value",re.value.slope>=0?"positive":"negative"])},v(re.value.slope>=0?"+":"")+v(re.value.slope.toFixed(3))+"% ",3),r("div",$,[e[16]||(e[16]=r("span",{class:"detail-label"},"2Y-10Y спред:",-1)),r("span",z,v(re.value.spread2y10y.toFixed(2))+"bp",1)])]),r("div",G,[e[19]||(e[19]=r("div",{class:"metric-header"},[r("h3",null,"Средняя форвардная ставка"),r("span",{class:"metric-unit"},"Средняя ставка")],-1)),r("div",N,v(re.value.avgForwardRate.toFixed(3))+"% ",1),r("div",Z,[e[18]||(e[18]=r("span",{class:"detail-label"},"Диапазон:",-1)),r("span",H,v(re.value.minRate.toFixed(3))+"% - "+v(re.value.maxRate.toFixed(3))+"%",1)])]),r("div",J,[e[21]||(e[21]=r("div",{class:"metric-header"},[r("h3",null,"Выпуклость кривой"),r("span",{class:"metric-unit"},"Выпуклость")],-1)),r("div",K,v(re.value.convexity.toFixed(4)),1),r("div",Q,[e[20]||(e[20]=r("span",{class:"detail-label"},"Форма:",-1)),r("span",X,v(he()),1)])])]),r("div",aa,[e[23]||(e[23]=r("div",{class:"card-header"},[r("h3",null,"Форвардные ставки по срокам"),r("span",{class:"card-subtitle"},"Расчётные форвардные ставки между периодами")],-1)),r("div",ea,[r("table",la,[e[22]||(e[22]=r("thead",null,[r("tr",null,[r("th",null,"Период"),r("th",null,"Спот ставка"),r("th",null,"Yield (ZC)"),r("th",null,"Forward Rate (t, t+1)"),r("th",null,"Подразумеваемая ставка"),r("th",null,"Спред (bp)")])],-1)),r("tbody",null,[(h(!0),d(c,null,u(oe.value,(a,e)=>(h(),d("tr",{key:e,class:b(a.outlier?"outlier":"")},[r("td",ta,v(a.period),1),r("td",sa,v(a.spotRate.toFixed(3))+"%",1),r("td",da,v(a.zcYield.toFixed(3))+"%",1),r("td",ra,v(a.forwardRate.toFixed(3))+"%",1),r("td",oa,v(a.impliedRate.toFixed(3))+"%",1),r("td",{class:b(["rate-value",a.spread>=0?"positive":"negative"])},v(a.spread>=0?"+":"")+v(a.spread.toFixed(1))+"bp ",3)],2))),128))])])])]),r("div",ia,[r("div",na,[e[24]||(e[24]=r("div",{class:"card-header"},[r("h3",null,"Методы интерполяции")],-1)),r("div",ca,[(h(!0),d(c,null,u(de.value,a=>(h(),d("div",{key:a.id,class:"option-item"},[o(r("input",{type:"radio",id:"method-"+a.id,"onUpdate:modelValue":e[2]||(e[2]=a=>le.value=a),value:a.id,onChange:ge,class:"radio-input"},null,40,ua),[[m,le.value]]),r("label",{for:"method-"+a.id,class:"option-label"},[r("span",pa,v(a.name),1),r("span",ba,v(a.description),1)],8,va)]))),128))])]),r("div",ma,[e[29]||(e[29]=r("div",{class:"card-header"},[r("h3",null,"Параметры кривой")],-1)),r("div",fa,[r("div",ha,[e[25]||(e[25]=r("span",{class:"label"},"Базовая ставка",-1)),o(r("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>se.value.baseRate=a),type:"number",class:"param-input",step:"0.01",onChange:ge},null,544),[[p,se.value.baseRate,void 0,{number:!0}]])]),r("div",ya,[e[26]||(e[26]=r("span",{class:"label"},"Долгосрочная ставка",-1)),o(r("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>se.value.longTermRate=a),type:"number",class:"param-input",step:"0.01",onChange:ge},null,544),[[p,se.value.longTermRate,void 0,{number:!0}]])]),r("div",ga,[e[27]||(e[27]=r("span",{class:"label"},"Волатильность",-1)),o(r("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>se.value.volatility=a),type:"number",class:"param-input",step:"0.1",onChange:ge},null,544),[[p,se.value.volatility,void 0,{number:!0}]])]),r("div",Ra,[e[28]||(e[28]=r("span",{class:"label"},"Скорость возврата к среднему",-1)),o(r("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>se.value.meanReversionSpeed=a),type:"number",class:"param-input",step:"0.01",onChange:ge},null,544),[[p,se.value.meanReversionSpeed,void 0,{number:!0}]])])])])]),r("div",wa,[e[35]||(e[35]=n('<div class="card" data-v-f1815dae><div class="chart-header" data-v-f1815dae><h3 data-v-f1815dae>PCA разложение</h3><span class="chart-subtitle" data-v-f1815dae>Анализ главных компонент</span></div><div class="pca-analysis" data-v-f1815dae><div class="pca-component" data-v-f1815dae><span class="component-label" data-v-f1815dae>Level (PC1)</span><div class="contribution-bar" data-v-f1815dae><div class="bar" style="width:78%;" data-v-f1815dae></div></div><span class="contribution-value" data-v-f1815dae>78%</span></div><div class="pca-component" data-v-f1815dae><span class="component-label" data-v-f1815dae>Slope (PC2)</span><div class="contribution-bar" data-v-f1815dae><div class="bar" style="width:18%;" data-v-f1815dae></div></div><span class="contribution-value" data-v-f1815dae>18%</span></div><div class="pca-component" data-v-f1815dae><span class="component-label" data-v-f1815dae>Curve (PC3)</span><div class="contribution-bar" data-v-f1815dae><div class="bar" style="width:4%;" data-v-f1815dae></div></div><span class="contribution-value" data-v-f1815dae>4%</span></div></div></div>',1)),r("div",Ca,[e[34]||(e[34]=r("div",{class:"chart-header"},[r("h3",null,"Анализ Butterfly"),r("span",{class:"chart-subtitle"},"2Y-5Y-10Y структура")],-1)),r("div",xa,[r("div",Fa,[e[30]||(e[30]=r("span",{class:"label"},"Fly (2Y-5Y)",-1)),r("span",ka,v(ie.value.fly25.toFixed(1))+"bp",1)]),r("div",Ya,[e[31]||(e[31]=r("span",{class:"label"},"Fly (5Y-10Y)",-1)),r("span",Sa,v(ie.value.fly510.toFixed(1))+"bp",1)]),r("div",Ua,[e[32]||(e[32]=r("span",{class:"label"},"Steep (2Y-10Y)",-1)),r("span",Ma,v(ie.value.butterfly.toFixed(1))+"bp",1)]),r("div",Va,[e[33]||(e[33]=r("span",{class:"label"},"Кривизна",-1)),r("span",{class:b(["value",ie.value.convexity>=0?"positive":"negative"])},v(ie.value.convexity>=0?"+":"")+v(ie.value.convexity.toFixed(1))+"bp ",3)])])])]),r("div",qa,[e[40]||(e[40]=r("div",{class:"card-header"},[r("h3",null,"Качество подгонки кривой"),r("span",{class:"card-subtitle"},"Ошибки интерполяции и статистика")],-1)),r("div",Da,[r("div",Ea,[e[36]||(e[36]=r("span",{class:"stat-label"},"R² (Goodness of Fit)",-1)),r("span",_a,v((100*ne.value.rSquared).toFixed(2))+"%",1),r("div",Wa,[r("div",{class:"quality-fill",style:f({width:100*ne.value.rSquared+"%"})},null,4)])]),r("div",ja,[e[37]||(e[37]=r("span",{class:"stat-label"},"RMSE (Root Mean Sq Error)",-1)),r("span",Aa,v(ne.value.rmse.toFixed(4)),1)]),r("div",Ba,[e[38]||(e[38]=r("span",{class:"stat-label"},"MAE (Mean Absolute Error)",-1)),r("span",Ta,v(ne.value.mae.toFixed(4)),1)]),r("div",La,[e[39]||(e[39]=r("span",{class:"stat-label"},"Макс. ошибка",-1)),r("span",Ia,v(ne.value.maxError.toFixed(4)),1)])])]),r("div",Pa,[e[41]||(e[41]=r("div",{class:"chart-header"},[r("h3",null,"Сценарии кривой"),r("span",{class:"chart-subtitle"},"Кривые форварда при различных сценариях")],-1)),r("div",Oa,[r("canvas",{ref_key:"scenarioCurvesRef",ref:pe},null,512)])]),r("div",$a,[e[43]||(e[43]=r("div",{class:"card-header"},[r("h3",null,"Детальная статистика по срокам")],-1)),r("div",za,[r("table",Ga,[e[42]||(e[42]=r("thead",null,[r("tr",null,[r("th",null,"Tenor"),r("th",null,"Spot Rate"),r("th",null,"Forward Rate"),r("th",null,"Yield Curve"),r("th",null,"Discount Factor"),r("th",null,"Duration"),r("th",null,"Convexity")])],-1)),r("tbody",null,[(h(!0),d(c,null,u(ce.value,(a,e)=>(h(),d("tr",{key:e},[r("td",Na,v(a.tenor),1),r("td",Za,v(a.spotRate.toFixed(4)),1),r("td",Ha,v(a.forwardRate.toFixed(4)),1),r("td",Ja,v(a.yieldCurve.toFixed(4)),1),r("td",Ka,v(a.discountFactor.toFixed(6)),1),r("td",Qa,v(a.duration.toFixed(4)),1),r("td",Xa,v(a.convexity.toFixed(6)),1)]))),128))])])])]),r("div",ae,[r("span",null,"• Интерполяция: "+v(de.value.find(a=>a.id===le.value)?.name),1),e[44]||(e[44]=r("span",null,"• Данные: Рыночные данные в реальном времени",-1)),e[45]||(e[45]=r("span",null,"• Обновление: Каждую минуту",-1))])]))}}),[["__scopeId","data-v-f1815dae"]]);export{ee as default};
