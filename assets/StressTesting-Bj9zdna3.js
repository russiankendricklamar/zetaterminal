import{d as e,v as l,r as a,c as t,e as s,g as i,t as n,x as r,y as o,j as u,F as c,i as p,n as v,B as d,f as m,w as h,T as y,q as b,k,L as g}from"./vendor-DLyKmMu8.js";import{g as _,_ as f}from"./index-Ba4DjugF.js";import{usePortfolioStore as x}from"./portfolio-t34lcnLk.js";const C={class:"page-container custom-scroll"},w={class:"section-header"},I={class:"header-right"},V={class:"glass-pill control-pill"},j={class:"text-white font-bold"},U={class:"glass-pill control-pill"},M={class:"scrub-wrapper"},O={class:"scrub-val text-accent"},F=["disabled"],S={key:0,class:"flex items-center gap-2"},B={key:1,class:"flex items-center gap-2"},L={class:"scenarios-grid"},H=["onClick"],R={class:"sc-header"},$={class:"sc-name"},T={class:"sc-header-actions"},A=["onClick"],P=["onClick"],q={class:"sc-desc"},z={class:"sc-footer"},N={class:"sc-prob"},X={key:0,class:"dashboard-grid"},D={class:"col-left"},E={class:"glass-card panel"},J={class:"panel-header"},K={class:"text-white"},Y={class:"impact-metrics-grid"},G={class:"metric-box"},Q={class:"val text-red"},W={class:"metric-box"},Z={class:"metric-box"},ee={class:"val text-white"},le={class:"metric-box"},ae={class:"val text-orange"},te={class:"impact-bars-list"},se={class:"bar-label"},ie={class:"bar-track"},ne={class:"stats-grid-row"},re={class:"stat-box"},oe={class:"val-sm text-red"},ue={class:"stat-box"},ce={class:"val-sm text-red"},pe={class:"stat-box"},ve={class:"val-sm text-orange"},de={class:"col-right"},me={class:"glass-card panel sticky-panel"},he={class:"market-changes-list"},ye={class:"m-key"},be={class:"info-block"},ke={class:"text-xs text-muted"},ge={class:"text-white"},_e={class:"glass-card panel"},fe={class:"table-wrapper"},xe={class:"glass-table"},Ce=["onClick"],we={class:"col-left pl-4"},Ie={class:"sc-name-sm"},Ve={class:"text-muted"},je={class:"text-orange"},Ue={class:"modal-header"},Me={class:"modal-body"},Oe={class:"form-section"},Fe={class:"form-grid"},Se={class:"form-group"},Be={class:"form-group"},Le={class:"form-group"},He={class:"form-group"},Re={class:"form-group"},$e={class:"form-section"},Te={class:"form-group"},Ae={key:0,class:"form-grid"},Pe={class:"form-group"},qe={key:1,class:"form-grid"},ze={class:"form-group"},Ne={key:2,class:"form-grid"},Xe={class:"form-group"},De={class:"form-section"},Ee={class:"market-changes-editor"},Je=["onUpdate:modelValue","onInput"],Ke=["onUpdate:modelValue","onInput"],Ye=["onClick"],Ge={class:"form-section"},Qe={class:"asset-impact-editor"},We=["onUpdate:modelValue","onInput"],Ze=["onUpdate:modelValue","onInput"],el=["onClick"],ll=f(e({__name:"StressTesting",setup(e){const f=x(),ll=l(()=>f.selectedBank),al=a(!1),tl=a(1),sl=a(null),il=(e,l="success")=>{console.log(`[${l.toUpperCase()}] ${e}`)},nl=a([{id:1,name:"«Чёрный лебедь»",description:"Глобальный рыночный крах (как COVID-19)",pnlImpact:-185e3,varChange:-45.5,duration:"1–3 дня",probability:.01,severity:"critical",marketChanges:{"Волатильность":"+25%","Bonds Yield":"+150 bps",Correlation:"+0.50",Spreads:"+100 bps"},assetImpact:{"Акции":-35,"Облигации":-12,"Товары":-25,"Валюта":-8},key:"black_swan",type:"return_shock",return_multiplier:.5,custom:!1},{id:2,name:"Скачок волатильности",description:"Резкий рост индекса VIX > 40",pnlImpact:-67500,varChange:-18.2,duration:"1–5 дней",probability:.05,severity:"high",marketChanges:{VIX:"+20 pts",Range:"+15%",Liquidity:"-10%"},assetImpact:{"Акции":-18,"Облигации":-5,"Опционы":-40,"Валюта":-3},key:"volatility_spike",type:"volatility_shock",volatility_multiplier:1.5,custom:!1},{id:3,name:"Рост ставок ЦБ",description:"Неожиданное повышение ставки на 100 б.п.",pnlImpact:-45200,varChange:-12.5,duration:"1–10 дней",probability:.15,severity:"high",marketChanges:{"Key Rate":"+100 bps",Spreads:"+50 bps","FX Rate":"-5%"},assetImpact:{"Акции":-12,"Облигации":-22,"Недвижимость":-15,"Валюта":-6},key:"rate_hike",type:"return_shock",return_multiplier:.7,custom:!1},{id:4,name:"Техническая коррекция",description:"Умеренное снижение S&P 500 на 10%",pnlImpact:-12400,varChange:-5.2,duration:"5–20 дней",probability:.35,severity:"medium",marketChanges:{Index:"-8%",Volatility:"+10%",Spreads:"+20 bps"},assetImpact:{"Акции":-8,"Облигации":2,"Товары":-5,"Валюта":-2},key:"correction",type:"correlation_shock",correlation_multiplier:1.3,custom:!1}]),rl=a(!1),ol=a(null),ul=a(5),cl=a({name:"",description:"",duration:"",probability:1,severity:"medium",type:"return_shock",return_multiplier:.5,volatility_multiplier:1.5,correlation_multiplier:1.3,marketChanges:{},assetImpact:{}}),pl=a([]),vl=a([]),dl=a([]),ml=a([]),hl=()=>{try{const e=nl.value.filter(e=>e.custom);localStorage.setItem("custom_stress_scenarios",JSON.stringify(e))}catch(e){console.error("Failed to save custom scenarios:",e)}},yl=e=>{e?(ol.value=e,cl.value={name:e.name,description:e.description||"",duration:e.duration||"",probability:100*(e.probability||.01),severity:e.severity||"medium",type:e.type||"return_shock",return_multiplier:e.return_multiplier||.5,volatility_multiplier:e.volatility_multiplier||1.5,correlation_multiplier:e.correlation_multiplier||1.3,marketChanges:e.marketChanges?{...e.marketChanges}:{},assetImpact:e.assetImpact?{...e.assetImpact}:{}}):(ol.value=null,cl.value={name:"",description:"",duration:"",probability:1,severity:"medium",type:"return_shock",return_multiplier:.5,volatility_multiplier:1.5,correlation_multiplier:1.3,marketChanges:{},assetImpact:{}}),pl.value=Object.keys(cl.value.marketChanges),vl.value=Object.values(cl.value.marketChanges),dl.value=Object.keys(cl.value.assetImpact),ml.value=Object.values(cl.value.assetImpact),rl.value=!0},bl=()=>{rl.value=!1,ol.value=null},kl=()=>{"return_shock"===cl.value.type?(cl.value.volatility_multiplier=void 0,cl.value.correlation_multiplier=void 0):"volatility_shock"===cl.value.type?(cl.value.return_multiplier=void 0,cl.value.correlation_multiplier=void 0):"correlation_shock"===cl.value.type&&(cl.value.return_multiplier=void 0,cl.value.volatility_multiplier=void 0)},gl=(e,l,a)=>{const t=pl.value.indexOf(e);t>-1&&(e!==l&&delete cl.value.marketChanges[e],l&&(cl.value.marketChanges[l]=a,pl.value[t]=l,vl.value[t]=a))},_l=()=>{const e=`Параметр${Object.keys(cl.value.marketChanges).length+1}`;cl.value.marketChanges[e]="",pl.value.push(e),vl.value.push("")},fl=(e,l,a)=>{const t=dl.value.indexOf(e);t>-1&&(e!==l&&delete cl.value.assetImpact[e],l&&(cl.value.assetImpact[l]=a,dl.value[t]=l,ml.value[t]=a))},xl=()=>{const e=`Актив${Object.keys(cl.value.assetImpact).length+1}`;cl.value.assetImpact[e]=0,dl.value.push(e),ml.value.push(0)},Cl=()=>{const e=cl.value.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),l={id:ol?.value?.id||ul.value++,name:cl.value.name,description:cl.value.description,duration:cl.value.duration,probability:cl.value.probability/100,severity:cl.value.severity,key:ol?.value?.key||`custom_${e}`,type:cl.value.type,marketChanges:{...cl.value.marketChanges},assetImpact:{...cl.value.assetImpact},custom:!0};if("return_shock"===cl.value.type&&cl.value.return_multiplier?l.return_multiplier=cl.value.return_multiplier:"volatility_shock"===cl.value.type&&cl.value.volatility_multiplier?l.volatility_multiplier=cl.value.volatility_multiplier:"correlation_shock"===cl.value.type&&cl.value.correlation_multiplier&&(l.correlation_multiplier=cl.value.correlation_multiplier),l.pnlImpact=0,l.varChange=0,ol.value){const e=nl.value.findIndex(e=>e.id===ol.value.id);e>-1&&(nl.value[e]={...nl.value[e],...l})}else nl.value.push(l);hl(),bl(),il(ol.value?"Сценарий обновлен":"Сценарий создан","success")};(()=>{try{const e=localStorage.getItem("custom_stress_scenarios");if(e){const l=JSON.parse(e);nl.value=[...nl.value.filter(e=>!e.custom),...l];const a=Math.max(...nl.value.map(e=>e.id));ul.value=a+1}}catch(e){console.error("Failed to load custom scenarios:",e)}})();const wl=a(nl.value[0]),Il=e=>wl.value=e,Vl=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(e),jl=e=>"₽"+(e/1e3).toFixed(0)+"k",Ul=e=>e.charAt(0).toUpperCase()+e.slice(1),Ml=e=>sl.value&&sl.value.results[e]?sl.value.results[e].metrics:null,Ol=e=>{const l=Ml(e.key);if(l){return-((sl.value?.baseline.initial_capital||1e6)-l.mean_final)*tl.value}return e.pnlImpact*tl.value},Fl=e=>{const l=Ml(e.key);if(l){const e=sl.value?.baseline.initial_capital||1e6;return(e-l.var_95)/e*100*tl.value}return e.varChange*tl.value},Sl=l(()=>{if(sl.value){const e=Object.values(sl.value.results).map(e=>-(sl.value.baseline.initial_capital-e.metrics.mean_final));return e.reduce((e,l)=>e+l,0)/e.length*tl.value}return nl.value.reduce((e,l)=>e+l.pnlImpact,0)/nl.value.length*tl.value}),Bl=l(()=>{if(sl.value){const e=Object.values(sl.value.results).map(e=>-(sl.value.baseline.initial_capital-e.metrics.mean_final));return Math.min(...e)*tl.value}return Math.min(...nl.value.map(e=>e.pnlImpact))*tl.value}),Ll=l(()=>sl.value?Object.values(sl.value.results).reduce((e,l,a)=>{const t=nl.value[a];return e+-(sl.value.baseline.initial_capital-l.metrics.mean_final)*(t?.probability||0)},0)*tl.value:nl.value.reduce((e,l)=>e+l.pnlImpact*l.probability,0)*tl.value),Hl=async()=>{if(!al.value){al.value=!0;try{const e=f.positions.length||23,l=f.positions.map(e=>e.symbol),a=Array.from({length:e},()=>.05+.1*Math.random()),t=f.correlationMatrix,s=Array.from({length:e},()=>.15+.15*Math.random()),i=[];for(let o=0;o<e;o++){const l=[];for(let a=0;a<e;a++){let e=.3;t.length>o&&void 0!==t[o]?.values?.[a]?e=t[o].values[a]:o===a&&(e=1),l.push(e*s[o]*s[a])}i.push(l)}const n=nl.value.map(e=>({name:e.name,key:e.key,type:e.type,return_multiplier:e.return_multiplier,volatility_multiplier:e.volatility_multiplier,correlation_multiplier:e.correlation_multiplier,seed:42})),r=await(async e=>{try{const l=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/stress/test",{method:"POST",headers:_(),body:JSON.stringify(e)});if(!l.ok){const e=await l.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${l.status}`)}return await l.json()}catch(l){throw console.error("Stress Test Failed:",l),l}})({mu:a,cov_matrix:i,initial_capital:1e6,risk_free_rate:.1394,gamma:3,scenarios:n,asset_names:l,n_paths:1e3,seed:42});sl.value=r,nl.value.forEach(e=>{const l=r.results[e.key];if(l){const a=r.baseline.initial_capital;e.pnlImpact=-(a-l.metrics.mean_final),e.varChange=(a-l.metrics.var_95)/a*100}}),il("Стресс-тестирование завершено","success")}catch(e){console.error("Ошибка стресс-тестирования:",e),il("Ошибка при выполнении стресс-тестирования","error")}finally{al.value=!1}}};return(e,l)=>(b(),t("div",C,[s("div",w,[l[17]||(l[17]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Стресс-тестирование"),s("p",{class:"section-subtitle"},"Симуляция экстремальных рыночных шоков")],-1)),s("div",I,[s("div",V,[l[13]||(l[13]=s("span",{class:"lbl-mini"},"Банк:",-1)),s("span",j,n(ll.value.name),1)]),s("div",U,[l[14]||(l[14]=s("span",{class:"lbl-mini"},"Множитель шока:",-1)),s("div",M,[r(s("input",{type:"range","onUpdate:modelValue":l[0]||(l[0]=e=>tl.value=e),step:.1,min:.5,max:3,class:"range-slider"},null,512),[[o,tl.value,void 0,{number:!0}]]),s("span",O,n(tl.value.toFixed(1))+"x",1)])]),s("button",{onClick:Hl,class:"btn-glass primary",disabled:al.value},[al.value?(b(),t("span",B,[...l[16]||(l[16]=[s("span",{class:"spinner-mini"},null,-1),u(" Тестирую... ",-1)])])):(b(),t("span",S,[...l[15]||(l[15]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),s("span",null,"Запустить все",-1)])]))],8,F)])]),s("div",L,[(b(!0),t(c,null,p(nl.value,e=>(b(),t("div",{key:e.id,onClick:l=>Il(e),class:v(["glass-card scenario-card",{active:wl.value?.id===e.id}])},[s("div",R,[s("span",$,n(e.name),1),s("div",T,[s("span",{class:v(["badge",e.severity])},n(e.severity),3),s("div",{class:"sc-actions",onClick:l[1]||(l[1]=d(()=>{},["stop"]))},[s("button",{onClick:l=>(e=>{yl(e)})(e),class:"btn-icon-sm",title:"Редактировать"},[...l[18]||(l[18]=[s("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,A),e.custom?(b(),t("button",{key:0,onClick:l=>{return a=e.id,void(confirm("Удалить этот сценарий?")&&(nl.value=nl.value.filter(e=>e.id!==a),hl(),wl.value?.id===a&&(wl.value=nl.value[0]||null),il("Сценарий удален","success")));var a},class:"btn-icon-sm",title:"Удалить"},[...l[19]||(l[19]=[s("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,P)):m("",!0)])])]),s("p",q,n(e.description),1),s("div",z,[s("span",{class:v(["sc-impact",Ol(e)<0?"text-red":"text-green"])},n(jl(Ol(e))),3),s("span",N,"Вероятность: "+n((100*e.probability).toFixed(0))+"%",1)])],10,H))),128)),s("div",{onClick:l[2]||(l[2]=e=>yl()),class:"glass-card scenario-card add-scenario-card"},[...l[20]||(l[20]=[s("div",{class:"add-scenario-content"},[s("svg",{width:"32",height:"32",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),s("span",{class:"add-scenario-text"},"Создать сценарий")],-1)])])]),i(y,{name:"fade",mode:"out-in"},{default:h(()=>[wl.value?(b(),t("div",X,[s("div",D,[s("div",E,[s("div",J,[s("h3",null,[l[21]||(l[21]=u("Влияние сценария: ",-1)),s("span",K,n(wl.value.name),1)])]),s("div",Y,[s("div",G,[l[22]||(l[22]=s("span",{class:"lbl"},"Влияние на P&L",-1)),s("span",Q,n(Vl(Ol(wl.value))),1)]),s("div",W,[l[23]||(l[23]=s("span",{class:"lbl"},"Изменение VaR",-1)),s("span",{class:v(["val",Fl(wl.value)<0?"text-red":"text-green"])},n(Fl(wl.value).toFixed(1))+"% ",3)]),s("div",Z,[l[24]||(l[24]=s("span",{class:"lbl"},"Длительность",-1)),s("span",ee,n(wl.value.duration),1)]),s("div",le,[l[25]||(l[25]=s("span",{class:"lbl"},"Вероятность",-1)),s("span",ae,n((100*wl.value.probability).toFixed(1))+"%",1)])]),l[29]||(l[29]=s("div",{class:"divider"},null,-1)),l[30]||(l[30]=s("div",{class:"panel-header"},[s("h3",null,"Влияние на классы активов")],-1)),s("div",te,[(b(!0),t(c,null,p(wl.value.assetImpact,(e,l)=>(b(),t("div",{key:l,class:"bar-row"},[s("span",se,n(l),1),s("div",ie,[s("div",{class:v(["bar-fill",e<0?"bg-red":"bg-green"]),style:k({width:Math.min(100,Math.abs(e*tl.value*1.5))+"%"})},null,6)]),s("span",{class:v(["bar-val",e<0?"text-red":"text-green"])},n(e>0?"+":"")+n((e*tl.value).toFixed(1))+"% ",3)]))),128))]),l[31]||(l[31]=s("div",{class:"divider"},null,-1)),l[32]||(l[32]=s("div",{class:"panel-header"},[s("h3",null,"Статистика риска")],-1)),s("div",ne,[s("div",re,[l[26]||(l[26]=s("span",{class:"lbl-sm"},"Средний убыток",-1)),s("span",oe,n(jl(Sl.value*tl.value)),1)]),s("div",ue,[l[27]||(l[27]=s("span",{class:"lbl-sm"},"Max Drawdown",-1)),s("span",ce,n(jl(Bl.value*tl.value)),1)]),s("div",pe,[l[28]||(l[28]=s("span",{class:"lbl-sm"},"Expected Shortfall",-1)),s("span",ve,n(jl(Ll.value*tl.value)),1)])])])]),s("aside",de,[s("div",me,[l[35]||(l[35]=s("div",{class:"panel-header"},[s("h3",null,"Рыночные условия")],-1)),s("div",he,[(b(!0),t(c,null,p(wl.value.marketChanges,(e,l)=>(b(),t("div",{key:l,class:"market-row"},[s("span",ye,n(Ul(l)),1),s("span",{class:v(["m-val",e.includes("-")?"text-red":"text-green"])},n(e),3)]))),128))]),l[36]||(l[36]=s("div",{class:"divider"},null,-1)),s("div",be,[s("p",ke,[l[33]||(l[33]=u(" Метрики пересчитаны с учетом коэффициента шока: ",-1)),s("b",ge,n(tl.value.toFixed(1))+"x",1),l[34]||(l[34]=u(". ",-1))])])])])])):m("",!0)]),_:1}),s("div",_e,[l[38]||(l[38]=s("div",{class:"panel-header"},[s("h3",null,"Сравнение сценариев")],-1)),s("div",fe,[s("table",xe,[l[37]||(l[37]=s("thead",null,[s("tr",null,[s("th",{class:"col-left pl-4"},"Сценарий"),s("th",null,"Влияние на P&L"),s("th",null,"Изменение VaR"),s("th",null,"Длительность"),s("th",null,"Вер.")])],-1)),s("tbody",null,[(b(!0),t(c,null,p(nl.value,e=>(b(),t("tr",{key:e.id,class:v(["hover-row",{"row-active":wl.value?.id===e.id}]),onClick:l=>Il(e)},[s("td",we,[s("span",Ie,n(e.name),1)]),s("td",{class:v(Ol(e)<0?"text-red":"text-green")},n(Vl(Ol(e))),3),s("td",{class:v(Fl(e)<0?"text-red":"text-green")},n(Fl(e).toFixed(1))+"% ",3),s("td",Ve,n(e.duration),1),s("td",je,n((100*e.probability).toFixed(1))+"%",1)],10,Ce))),128))])])])]),l[63]||(l[63]=s("div",{class:"footer-notes"},[s("span",{class:"note-item"},"Данные основаны на исторических корреляциях"),s("span",{class:"note-item"},"•"),s("span",{class:"note-item"},"Рекомендуется ежеквартальный пересмотр")],-1)),i(y,{name:"modal-fade"},{default:h(()=>[rl.value?(b(),t("div",{key:0,class:"modal-overlay",onClick:bl},[s("div",{class:"modal-container scenario-editor-modal",onClick:l[12]||(l[12]=d(()=>{},["stop"]))},[s("div",Ue,[s("h2",null,n(ol.value?"Редактировать сценарий":"Создать сценарий"),1),s("button",{class:"modal-close",onClick:bl},[...l[39]||(l[39]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",Me,[s("form",{onSubmit:d(Cl,["prevent"]),class:"scenario-form"},[s("div",Oe,[l[46]||(l[46]=s("h3",{class:"section-title"},"Основная информация",-1)),s("div",Fe,[s("div",Se,[l[40]||(l[40]=s("label",null,"Название сценария",-1)),r(s("input",{type:"text","onUpdate:modelValue":l[3]||(l[3]=e=>cl.value.name=e),class:"glass-input",placeholder:"Например: Кризис ликвидности",required:""},null,512),[[o,cl.value.name]])]),s("div",Be,[l[41]||(l[41]=s("label",null,"Описание",-1)),r(s("textarea",{"onUpdate:modelValue":l[4]||(l[4]=e=>cl.value.description=e),class:"glass-input",rows:"2",placeholder:"Краткое описание сценария"},null,512),[[o,cl.value.description]])]),s("div",Le,[l[42]||(l[42]=s("label",null,"Длительность",-1)),r(s("input",{type:"text","onUpdate:modelValue":l[5]||(l[5]=e=>cl.value.duration=e),class:"glass-input",placeholder:"Например: 1–3 дня"},null,512),[[o,cl.value.duration]])]),s("div",He,[l[43]||(l[43]=s("label",null,"Вероятность (%)",-1)),r(s("input",{type:"number","onUpdate:modelValue":l[6]||(l[6]=e=>cl.value.probability=e),class:"glass-input",min:"0",max:"100",step:"0.1",required:""},null,512),[[o,cl.value.probability,void 0,{number:!0}]])]),s("div",Re,[l[45]||(l[45]=s("label",null,"Уровень серьезности",-1)),r(s("select",{"onUpdate:modelValue":l[7]||(l[7]=e=>cl.value.severity=e),class:"glass-input"},[...l[44]||(l[44]=[s("option",{value:"critical"},"Критический",-1),s("option",{value:"high"},"Высокий",-1),s("option",{value:"medium"},"Средний",-1),s("option",{value:"low"},"Низкий",-1)])],512),[[g,cl.value.severity]])])])]),s("div",$e,[l[55]||(l[55]=s("h3",{class:"section-title"},"Тип шока",-1)),s("div",Te,[l[48]||(l[48]=s("label",null,"Тип стресс-теста",-1)),r(s("select",{"onUpdate:modelValue":l[8]||(l[8]=e=>cl.value.type=e),class:"glass-input",onChange:kl},[...l[47]||(l[47]=[s("option",{value:"return_shock"},"Шок доходности",-1),s("option",{value:"volatility_shock"},"Шок волатильности",-1),s("option",{value:"correlation_shock"},"Шок корреляции",-1)])],544),[[g,cl.value.type]])]),"return_shock"===cl.value.type?(b(),t("div",Ae,[s("div",Pe,[l[49]||(l[49]=s("label",null,"Множитель доходности",-1)),r(s("input",{type:"number","onUpdate:modelValue":l[9]||(l[9]=e=>cl.value.return_multiplier=e),class:"glass-input",min:"0",max:"2",step:"0.1",placeholder:"0.5"},null,512),[[o,cl.value.return_multiplier,void 0,{number:!0}]]),l[50]||(l[50]=s("span",{class:"form-hint"},"Множитель для ожидаемой доходности (0.5 = снижение на 50%)",-1))])])):m("",!0),"volatility_shock"===cl.value.type?(b(),t("div",qe,[s("div",ze,[l[51]||(l[51]=s("label",null,"Множитель волатильности",-1)),r(s("input",{type:"number","onUpdate:modelValue":l[10]||(l[10]=e=>cl.value.volatility_multiplier=e),class:"glass-input",min:"0.5",max:"5",step:"0.1",placeholder:"1.5"},null,512),[[o,cl.value.volatility_multiplier,void 0,{number:!0}]]),l[52]||(l[52]=s("span",{class:"form-hint"},"Множитель для волатильности (1.5 = увеличение на 50%)",-1))])])):m("",!0),"correlation_shock"===cl.value.type?(b(),t("div",Ne,[s("div",Xe,[l[53]||(l[53]=s("label",null,"Множитель корреляции",-1)),r(s("input",{type:"number","onUpdate:modelValue":l[11]||(l[11]=e=>cl.value.correlation_multiplier=e),class:"glass-input",min:"0.5",max:"2",step:"0.1",placeholder:"1.3"},null,512),[[o,cl.value.correlation_multiplier,void 0,{number:!0}]]),l[54]||(l[54]=s("span",{class:"form-hint"},"Множитель для корреляций (1.3 = увеличение на 30%)",-1))])])):m("",!0)]),s("div",De,[l[58]||(l[58]=s("h3",{class:"section-title"},"Рыночные изменения",-1)),s("div",Ee,[(b(!0),t(c,null,p(cl.value.marketChanges,(e,a,i)=>(b(),t("div",{key:i,class:"market-change-row"},[r(s("input",{type:"text","onUpdate:modelValue":e=>pl.value[i]=e,class:"glass-input",placeholder:"Параметр (например: VIX)",onInput:l=>gl(a,pl.value[i],e)},null,40,Je),[[o,pl.value[i]]]),r(s("input",{type:"text","onUpdate:modelValue":e=>vl.value[i]=e,class:"glass-input",placeholder:"Изменение (например: +20 pts)",onInput:e=>gl(a,pl.value[i],vl.value[i])},null,40,Ke),[[o,vl.value[i]]]),s("button",{type:"button",onClick:e=>(e=>{delete cl.value.marketChanges[e];const l=pl.value.indexOf(e);l>-1&&(pl.value.splice(l,1),vl.value.splice(l,1))})(a),class:"btn-icon-sm btn-danger"},[...l[56]||(l[56]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ye)]))),128)),s("button",{type:"button",onClick:_l,class:"btn-glass outline btn-add"},[...l[57]||(l[57]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Добавить параметр ",-1)])])])]),s("div",Ge,[l[61]||(l[61]=s("h3",{class:"section-title"},"Влияние на классы активов (%)",-1)),s("div",Qe,[(b(!0),t(c,null,p(cl.value.assetImpact,(e,a,i)=>(b(),t("div",{key:i,class:"asset-impact-row"},[r(s("input",{type:"text","onUpdate:modelValue":e=>dl.value[i]=e,class:"glass-input",placeholder:"Класс актива (например: Акции)",onInput:l=>fl(a,dl.value[i],e)},null,40,We),[[o,dl.value[i]]]),r(s("input",{type:"number","onUpdate:modelValue":e=>ml.value[i]=e,class:"glass-input",placeholder:"Влияние (%)",step:"0.1",onInput:e=>fl(a,dl.value[i],ml.value[i])},null,40,Ze),[[o,ml.value[i],void 0,{number:!0}]]),s("button",{type:"button",onClick:e=>(e=>{delete cl.value.assetImpact[e];const l=dl.value.indexOf(e);l>-1&&(dl.value.splice(l,1),ml.value.splice(l,1))})(a),class:"btn-icon-sm btn-danger"},[...l[59]||(l[59]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,el)]))),128)),s("button",{type:"button",onClick:xl,class:"btn-glass outline btn-add"},[...l[60]||(l[60]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Добавить класс актива ",-1)])])])]),s("div",{class:"form-actions"},[s("button",{type:"button",onClick:bl,class:"btn-glass outline"},"Отмена"),l[62]||(l[62]=s("button",{type:"submit",class:"btn-glass primary"},"Сохранить сценарий",-1))])],32)])])])):m("",!0)]),_:1})]))}}),[["__scopeId","data-v-39cd3d9b"]]);export{ll as default};
