import{d as e,r as t,a,o as n,b as r,c as i,m as o,e as s,f as l,n as c,g as u,h as d,w as h,F as p,i as f,j as m,t as v,u as g,k as y,l as b,p as x,q as w,s as _,v as S,T as M,x as T,y as k,z as C,A,B as E,C as I,D as R,E as D,G as P,H as L,I as N,J as O,K as F,L as B,M as U,N as z,O as V,P as H,Q as G,R as W,S as q,U as Y,V as j,W as X,X as K,Y as Z,Z as J,_ as Q,$ as ee,a0 as te}from"./vendor-CvUAgQ8W.js";import{c as ae,_ as ne}from"./pdf-3nw1PNim.js";import{C as re,r as ie}from"./charts-dOL2HBx2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const oe={class:"sidebar-tools custom-scrollbar"},se=["onClick"],le={class:"tool-index font-mono"},ce={class:"tool-info"},ue={class:"tool-title font-oswald"},de={class:"tool-subtitle font-mono"},he={class:"tool-content"},pe={class:"nav-label font-mono"},fe={key:0,class:"nav-soon font-mono"},me={key:1,class:"item-arrow font-mono"},ve={class:"sidebar-footer"},ge={class:"status-row"},ye={class:"val font-mono"},be=e({__name:"Sidebar",setup(e){const _=g();x();const S=t("--:--"),M=t(!1),T=t(0),k=t(0),C=t(null),A=a({portfolio:!1,risk:!1,quant:!1,bonds:!1,bondReports:!1,options:!1,swaps:!1,forwards:!1,marketData:!1,tools:!1}),E={portfolio:{title:"ПОРТФЕЛЬНЫЙ АНАЛИЗ",subtitle:"Анализ и оптимизация",items:[{path:"/portfolio",label:"Состав портфеля"},{path:"/CCMVoptimization",label:"Оптимизация портфеля"},{path:"/greeks",label:"Риск-метрики"},{path:"/reports",label:"Отчёты"}]},risk:{title:"РИСК-МЕНЕДЖМЕНТ",subtitle:"Бэктестинг, стресс-тестирование",items:[{path:"/backtest",label:"Бэктестинг"},{path:"/stress",label:"Стресс-тестирование облигаций"},{path:"/stress/swaps",label:"Стресс-тестирование СВОПов"}]},quant:{title:"АНАЛИЗ РЫНОЧНЫХ РЕЖИМОВ",subtitle:"Модели и режимы",items:[{path:"/regimes",label:"Рыночные режимы"},{path:"/regime-details",label:"Детальный анализ режимов"},{path:"/spectral-regimes",label:"Комплексный анализ режимов"},{path:"/fixed-income",label:"Доходности облигаций"}]},bonds:{title:"СПРАВЕДЛИВАЯ СТОИМОСТЬ",subtitle:"Оценка облигаций",items:[{path:"/bond-valuation",label:"Оценка облигаций"},{path:"/zcyc-viewer",label:"Кривая бескупонной доходности"},{path:"/bond-report",label:"Отчет об оценке"}]},options:{title:"ОПЦИОНЫ",subtitle:"Ценообразование и Greeks",items:[{path:"/pricing/options",label:"Справедливая стоимость"},{path:"/pricing/options/models",label:"Сравнение моделей"},{path:"/pricing/options/greeks",label:"Анализ Greeks"},{path:"/pricing/options/portfolio",label:"Портфель опционов"},{path:"/analytics/volatility",label:"Поверхность волатильности"}]},swaps:{title:"СВОПЫ",subtitle:"Greeks, Pricing & Risk",items:[{path:"/valuation/swaps",label:"Справедливая стоимость"},{path:"/swap-greeks",label:"Греки СВОПов"},{path:"/analytics/pnl",label:"Факторная декомпозиция P&L"},{path:"/hedging",label:"Регрессионное хеджирование"},{path:"/reports/swaps",label:"Отчеты по СВОПам",soon:!0}]},forwards:{title:"ФОРВАРДЫ",subtitle:"Оценка и анализ",items:[{path:"/valuation/forwards",label:"Оценка форвардов"},{path:"/forwards/curve",label:"Форвардная кривая"},{path:"/forwards/greeks",label:"Греки форвардов"},{path:"/forwards/basis",label:"Спот-форвард базис"}]},bondReports:{title:"ОТЧЁТЫ ПО ОБЛИГАЦИЯМ",subtitle:"Шаблонные отчеты",items:[{path:"/vanila-bond-report",label:"Vanila Bond Report"},{path:"/floater-bond-report",label:"Floater Bond Report"}]},marketData:{title:"РЫНОЧНЫЕ ДАННЫЕ",subtitle:"Внешние источники данных",items:[{path:"/macro",label:"Макроэкономика"},{path:"/crypto",label:"Крипто рынки"},{path:"/news",label:"Новостной хаб"}]},tools:{title:"ИНСТРУМЕНТЫ",subtitle:"Безопасность и утилиты",items:[{path:"/security",label:"Безопасность"}]}},I=e=>_.path===e,R=()=>{M.value=!M.value},D=()=>{M.value=!1},P=e=>{setTimeout(()=>{D()},50)},L=e=>{T.value=e.changedTouches[0].screenX},N=e=>{k.value=e.changedTouches[0].screenX},O=()=>{T.value-k.value>50&&M.value&&D()},F=()=>{S.value=(new Date).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",second:"2-digit"})};let B;return n(()=>{F(),B=setInterval(F,1e3)}),r(()=>clearInterval(B)),(e,t)=>{const a=d("router-link");return w(),i("div",o(e.$attrs,{class:"sidebar-wrapper"}),[s("div",{class:c(["sidebar-tab",{hidden:M.value}]),onClick:R,title:"Open Menu"},[...t[0]||(t[0]=[s("div",{class:"burger-icon"},[s("span"),s("span"),s("span")],-1)])],2),M.value?(w(),i("div",{key:0,class:"sidebar-backdrop",onClick:D})):l("",!0),s("aside",{ref_key:"sidebarRef",ref:C,class:c(["sidebar",{"sidebar--open":M.value}]),onTouchstart:L,onTouchmove:N,onTouchend:O},[s("div",{class:"sidebar-header"},[t[1]||(t[1]=s("div",{class:"logo-marquee"},[s("div",{class:"marquee-track"},[s("span",{class:"font-anton"},"STOCHASTIC — QUANT — RISK — SIGMA — "),s("span",{class:"font-anton"},"STOCHASTIC — QUANT — RISK — SIGMA — ")])],-1)),s("button",{class:"close-btn",onClick:D},"×")]),s("nav",oe,[u(a,{to:"/",class:c(["nav-entry",{active:I("/")}]),onClick:P},{default:h(()=>[...t[2]||(t[2]=[s("span",{class:"nav-index font-mono"},"01",-1),s("div",{class:"nav-info"},[s("div",{class:"nav-title font-oswald"},"ГЛАВНАЯ"),s("div",{class:"nav-subtitle font-mono"},"Обзор инструментов")],-1),s("span",{class:"nav-arrow font-mono"},"→",-1)])]),_:1},8,["class"]),u(a,{to:"/docs",class:c(["nav-entry",{active:I("/docs")}]),onClick:P},{default:h(()=>[...t[3]||(t[3]=[s("span",{class:"nav-index font-mono"},"02",-1),s("div",{class:"nav-info"},[s("div",{class:"nav-title font-oswald"},"ДОКУМЕНТАЦИЯ"),s("div",{class:"nav-subtitle font-mono"},"Как работать с приложением")],-1),s("span",{class:"nav-arrow font-mono"},"→",-1)])]),_:1},8,["class"]),u(a,{to:"/terminal",class:c(["nav-entry terminal-entry",{active:I("/terminal")}]),onClick:P},{default:h(()=>[...t[4]||(t[4]=[s("div",{class:"zeta-icon font-anton"},"ζ",-1),s("div",{class:"nav-info"},[s("div",{class:"nav-title font-oswald"},"ДЗЕТА-ТЕРМИНАЛ"),s("div",{class:"nav-subtitle font-mono"},"Потоковые данные в реальном времени")],-1),s("span",{class:"nav-arrow font-mono"},"→",-1)])]),_:1},8,["class"]),t[7]||(t[7]=s("div",{class:"sidebar-divider"},null,-1)),(w(),i(p,null,f(E,(e,n,r)=>s("div",{key:n,class:"tool-group",style:y({"--group-index":r})},[s("button",{class:c(["tool-header",{expanded:A[n]}]),onClick:e=>((e,t)=>{if(A[e]=!A[e],A[e]&&t){const e=t.currentTarget.closest(".tool-group");e&&setTimeout(()=>{e.scrollIntoView({behavior:"smooth",block:"start"})},100)}})(n,e)},[s("span",le,v(String(r+3).padStart(2,"0")),1),s("div",ce,[s("span",ue,v(e.title),1),s("span",de,v(e.subtitle),1)]),t[5]||(t[5]=s("div",{class:"chevron"},[s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"6 9 12 15 18 9"})])],-1))],10,se),s("div",{class:c(["tool-content-wrapper",{expanded:A[n]}])},[s("div",he,[(w(!0),i(p,null,f(e.items,(e,n)=>(w(),b(a,{key:e.path,to:e.path,class:c(["nav-item",{active:I(e.path),"coming-soon":e.soon}]),style:y({"--item-index":n}),onClick:t=>!e.soon&&P()},{default:h(()=>[t[6]||(t[6]=s("span",{class:"item-dot"},null,-1)),s("span",pe,v(e.label),1),e.soon?(w(),i("span",fe,"SOON")):(w(),i("span",me,"→"))]),_:2},1032,["to","class","style","onClick"]))),128))])],2)],4)),64))]),t[12]||(t[12]=s("div",{class:"sidebar-divider"},null,-1)),u(a,{to:"/settings",class:c(["settings-link",{active:I("/settings")}]),onClick:P},{default:h(()=>[...t[8]||(t[8]=[s("span",{class:"nav-index font-mono"},"⚙",-1),s("div",{class:"nav-info"},[s("span",{class:"nav-title font-oswald"},"ПАРАМЕТРЫ"),s("span",{class:"nav-subtitle font-mono"},"Конфигурация")],-1),s("span",{class:"nav-arrow font-mono"},"→",-1)])]),_:1},8,["class"]),s("div",ve,[t[10]||(t[10]=s("div",{class:"status-row"},[s("span",{class:"lbl font-mono"},"API"),s("span",{class:"val online font-mono"},[s("span",{class:"pulse-dot"}),m(" ONLINE ")])],-1)),s("div",ge,[t[9]||(t[9]=s("span",{class:"lbl font-mono"},"TIME",-1)),s("span",ye,v(S.value),1)]),t[11]||(t[11]=s("div",{class:"version-tag font-mono"},"v2.0 BRUTALIST",-1))])],34)],16)}}}),xe=(e,t)=>{const a=e.__vccOpts||e;for(const[n,r]of t)a[n]=r;return a},we=xe(be,[["__scopeId","data-v-22a7091d"]]),_e=_("tasks",()=>{const e=t([]),a=t=>{e.value=e.value.filter(e=>e.id!==t)};return{tasks:e,addTask:(t,a="calculation")=>{const n=Date.now().toString();return e.value.push({id:n,title:t,progress:0,status:"running",type:a}),n},updateProgress:(t,n)=>{const r=e.value.find(e=>e.id===t);r&&(r.progress=n,n>=100&&(r.status="completed",setTimeout(()=>a(t),3e3)))},failTask:t=>{const n=e.value.find(e=>e.id===t);n&&(n.status="error",setTimeout(()=>a(t),5e3))}}}),Se={class:"island-content"},Me={class:"island-title"},Te={class:"island-right"},ke={class:"island-pct"},Ce=e({__name:"TaskWidget",setup(e){const a=_e(),n=t(!1),r=S(()=>{const e=a.tasks.filter(e=>"running"===e.status||"pending"===e.status);return e.length>0?e[e.length-1]:null}),o=()=>{a.tasks.length>1&&(n.value=!n.value)};return(e,t)=>(w(),b(M,{name:"island-pop"},{default:h(()=>[r.value?(w(),i("div",{key:0,class:"dynamic-island",onClick:o},[t[0]||(t[0]=s("div",{class:"island-left"},[s("div",{class:"spinner-island"})],-1)),s("div",Se,[s("span",Me,v(r.value.title),1)]),s("div",Te,[s("span",ke,v(Math.round(r.value.progress))+"%",1)]),s("div",{class:"island-progress-bg",style:y({width:r.value.progress+"%"})},null,4)])):l("",!0)]),_:1}))}}),Ae=xe(Ce,[["__scopeId","data-v-9e67dfea"]]),Ee={class:"app-root"},Ie={class:"app-container"},Re={class:"main-window"},De={class:"island-position"},Pe={class:"window-header"},Le={class:"header-content"},Ne={class:"header-top"},Oe={class:"breadcrumbs font-mono"},Fe={class:"crumb-active"},Be={class:"system-status"},Ue={class:"status-text font-mono"},ze={class:"header-bottom"},Ve={class:"search-wrapper"},He={class:"actions-group"},Ge={key:0,class:"notification-badge"},We={key:0,class:"notifications-panel"},qe={class:"panel-header"},Ye={class:"window-content custom-scrollbar"},je=e({__name:"MainLayout",setup(e){const a=g(),r=t(""),o=t(!1),p=t(2),f=t(14),m=S(()=>a.name?String(a.name).toUpperCase():"OVERVIEW"),y=()=>o.value=!o.value;return n(()=>{setInterval(()=>{f.value=12+Math.floor(8*Math.random())},2e3)}),(e,t)=>{const a=d("RouterView");return w(),i("div",Ee,[t[12]||(t[12]=s("div",{class:"bg-noise"},null,-1)),s("div",Ie,[u(we,{class:"sidebar-layer"}),s("div",Re,[s("div",De,[u(Ae)]),s("header",Pe,[s("div",Le,[s("div",Ne,[s("nav",Oe,[t[2]||(t[2]=s("span",{class:"crumb-root"},"STOCHASTIC",-1)),t[3]||(t[3]=s("span",{class:"crumb-sep"},"/",-1)),s("span",Fe,v(m.value),1)]),s("div",Be,[t[4]||(t[4]=s("div",{class:"status-pill"},[s("span",{class:"status-dot online"}),s("span",{class:"status-label font-mono"},"API LIVE")],-1)),t[5]||(t[5]=s("div",{class:"divider-v"},null,-1)),s("div",Ue,v(f.value)+"ms ",1)])]),s("div",ze,[s("div",Ve,[t[6]||(t[6]=s("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),T(s("input",{type:"text",placeholder:"Поиск по тикеру, ISIN...",class:"search-input font-mono","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e)},null,512),[[k,r.value]]),t[7]||(t[7]=s("div",{class:"hk-badge font-mono"},"⌘K",-1))]),s("div",He,[s("button",{class:c(["icon-btn",{active:o.value}]),onClick:y,"aria-label":"Notifications"},[t[8]||(t[8]=s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),s("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})],-1)),p.value?(w(),i("span",Ge,v(p.value),1)):l("",!0)],2),t[9]||(t[9]=s("div",{class:"user-avatar font-oswald"},[s("span",null,"RK")],-1))])])]),u(M,{name:"slide"},{default:h(()=>[o.value?(w(),i("div",We,[s("div",qe,[t[10]||(t[10]=s("h3",{class:"font-oswald"},"УВЕДОМЛЕНИЯ",-1)),s("button",{onClick:t[1]||(t[1]=e=>p.value=0),class:"clear-btn font-mono"},"ОЧИСТИТЬ")]),t[11]||(t[11]=s("div",{class:"notifications-list"},[s("div",{class:"notif-item"},[s("div",{class:"notif-indicator warning"}),s("div",{class:"notif-content"},[s("div",{class:"notif-title font-oswald"},"HIGH VOLATILITY"),s("div",{class:"notif-desc font-mono"},"VIX spike > 25.0 detected")]),s("div",{class:"notif-time font-mono"},"2m")]),s("div",{class:"notif-item"},[s("div",{class:"notif-indicator success"}),s("div",{class:"notif-content"},[s("div",{class:"notif-title font-oswald"},"REBALANCED"),s("div",{class:"notif-desc font-mono"},"Target weights achieved")]),s("div",{class:"notif-time font-mono"},"1h")])],-1))])):l("",!0)]),_:1})]),s("main",Ye,[u(a,null,{default:h(({Component:e})=>[u(M,{name:"fade",mode:"out-in"},{default:h(()=>[(w(),b(C(e)))]),_:2},1024)]),_:1})])])])])}}}),Xe=xe(je,[["__scopeId","data-v-fd35162f"]]);function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}
/*!
 * GSAP 3.14.2
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Ze,Je,Qe,et,tt,at,nt,rt,it,ot,st,lt,ct,ut,dt,ht,pt,ft={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},mt={duration:.5,overwrite:!1,delay:0},vt=1e8,gt=1e-8,yt=2*Math.PI,bt=yt/4,xt=0,wt=Math.sqrt,_t=Math.cos,St=Math.sin,Mt=function(e){return"string"==typeof e},Tt=function(e){return"function"==typeof e},kt=function(e){return"number"==typeof e},Ct=function(e){return void 0===e},At=function(e){return"object"==typeof e},Et=function(e){return!1!==e},It=function(){return"undefined"!=typeof window},Rt=function(e){return Tt(e)||Mt(e)},Dt="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Pt=Array.isArray,Lt=/random\([^)]+\)/g,Nt=/,\s*/g,Ot=/(?:-?\.?\d|\.)+/gi,Ft=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Bt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ut=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,zt=/[+-]=-?[.\d]+/,Vt=/[^,'"\[\]\s]+/gi,Ht=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Gt={},Wt={},qt=function(e){return(Wt=wa(e,Gt))&&Sr},Yt=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},jt=function(e,t){return!t&&console.warn(e)},Xt=function(e,t){return e&&(Gt[e]=t)&&Wt&&(Wt[e]=t)||Gt},$t=function(){return 0},Kt={suppressEvents:!0,isStart:!0,kill:!1},Zt={suppressEvents:!0,kill:!1},Jt={suppressEvents:!0},Qt={},ea=[],ta={},aa={},na={},ra=30,ia=[],oa="",sa=function(e){var t,a,n=e[0];if(At(n)||Tt(n)||(e=[e]),!(t=(n._gsap||{}).harness)){for(a=ia.length;a--&&!ia[a].targetTest(n););t=ia[a]}for(a=e.length;a--;)e[a]&&(e[a]._gsap||(e[a]._gsap=new Fn(e[a],t)))||e.splice(a,1);return e},la=function(e){return e._gsap||sa(Qa(e))[0]._gsap},ca=function(e,t,a){return(a=e[t])&&Tt(a)?e[t]():Ct(a)&&e.getAttribute&&e.getAttribute(t)||a},ua=function(e,t){return(e=e.split(",")).forEach(t)||e},da=function(e){return Math.round(1e5*e)/1e5||0},ha=function(e){return Math.round(1e7*e)/1e7||0},pa=function(e,t){var a=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),"+"===a?e+n:"-"===a?e-n:"*"===a?e*n:e/n},fa=function(e,t){for(var a=t.length,n=0;e.indexOf(t[n])<0&&++n<a;);return n<a},ma=function(){var e,t,a=ea.length,n=ea.slice(0);for(ta={},ea.length=0,e=0;e<a;e++)(t=n[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},va=function(e){return!!(e._initted||e._startAt||e.add)},ga=function(e,t,a,n){ea.length&&!Je&&ma(),e.render(t,a,!!(Je&&t<0&&va(e))),ea.length&&!Je&&ma()},ya=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(Vt).length<2?t:Mt(e)?e.trim():e},ba=function(e){return e},xa=function(e,t){for(var a in t)a in e||(e[a]=t[a]);return e},wa=function(e,t){for(var a in t)e[a]=t[a];return e},_a=function e(t,a){for(var n in a)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(t[n]=At(a[n])?e(t[n]||(t[n]={}),a[n]):a[n]);return t},Sa=function(e,t){var a,n={};for(a in e)a in t||(n[a]=e[a]);return n},Ma=function(e){var t,a=e.parent||et,n=e.keyframes?(t=Pt(e.keyframes),function(e,a){for(var n in a)n in e||"duration"===n&&t||"ease"===n||(e[n]=a[n])}):xa;if(Et(e.inherit))for(;a;)n(e,a.vars.defaults),a=a.parent||a._dp;return e},Ta=function(e,t,a,n,r){var i,o=e[n];if(r)for(i=t[r];o&&o[r]>i;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[a],e[a]=t),t._next?t._next._prev=t:e[n]=t,t._prev=o,t.parent=t._dp=e,t},ka=function(e,t,a,n){void 0===a&&(a="_first"),void 0===n&&(n="_last");var r=t._prev,i=t._next;r?r._next=i:e[a]===t&&(e[a]=i),i?i._prev=r:e[n]===t&&(e[n]=r),t._next=t._prev=t.parent=null},Ca=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Aa=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var a=e;a;)a._dirty=1,a=a.parent;return e},Ea=function(e,t,a,n){return e._startAt&&(Je?e._startAt.revert(Zt):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},Ia=function e(t){return!t||t._ts&&e(t.parent)},Ra=function(e){return e._repeat?Da(e._tTime,e=e.duration()+e._rDelay)*e:0},Da=function(e,t){var a=Math.floor(e=ha(e/t));return e&&a===e?a-1:a},Pa=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},La=function(e){return e._end=ha(e._start+(e._tDur/Math.abs(e._ts||e._rts||gt)||0))},Na=function(e,t){var a=e._dp;return a&&a.smoothChildTiming&&e._ts&&(e._start=ha(a._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),La(e),a._dirty||Aa(a,e)),e},Oa=function(e,t){var a;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(a=Pa(e.rawTime(),t),(!t._dur||Xa(0,t.totalDuration(),a)-t._tTime>gt)&&t.render(a,!0)),Aa(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(a=e;a._dp;)a.rawTime()>=0&&a.totalTime(a._tTime),a=a._dp;e._zTime=-1e-8}},Fa=function(e,t,a,n){return t.parent&&Ca(t),t._start=ha((kt(a)?a:a||e!==et?qa(e,a,t):e._time)+t._delay),t._end=ha(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Ta(e,t,"_first","_last",e._sort?"_start":0),Va(t)||(e._recent=t),n||Oa(e,t),e._ts<0&&Na(e,e._tTime),e},Ba=function(e,t){return(Gt.ScrollTrigger||Yt("scrollTrigger",t))&&Gt.ScrollTrigger.create(t,e)},Ua=function(e,t,a,n,r){return qn(e,t,r),e._initted?!a&&e._pt&&!Je&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&it!==Mn.frame?(ea.push(e),e._lazy=[r,n],1):void 0:1},za=function e(t){var a=t.parent;return a&&a._ts&&a._initted&&!a._lock&&(a.rawTime()<0||e(a))},Va=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},Ha=function(e,t,a,n){var r=e._repeat,i=ha(t)||0,o=e._tTime/e._tDur;return o&&!n&&(e._time*=i/e._dur),e._dur=i,e._tDur=r?r<0?1e10:ha(i*(r+1)+e._rDelay*r):i,o>0&&!n&&Na(e,e._tTime=e._tDur*o),e.parent&&La(e),a||Aa(e.parent,e),e},Ga=function(e){return e instanceof Un?Aa(e):Ha(e,e._dur)},Wa={_start:0,endTime:$t,totalDuration:$t},qa=function e(t,a,n){var r,i,o,s=t.labels,l=t._recent||Wa,c=t.duration()>=vt?l.endTime(!1):t._dur;return Mt(a)&&(isNaN(a)||a in s)?(i=a.charAt(0),o="%"===a.substr(-1),r=a.indexOf("="),"<"===i||">"===i?(r>=0&&(a=a.replace(/=/,"")),("<"===i?l._start:l.endTime(l._repeat>=0))+(parseFloat(a.substr(1))||0)*(o?(r<0?l:n).totalDuration()/100:1)):r<0?(a in s||(s[a]=c),s[a]):(i=parseFloat(a.charAt(r-1)+a.substr(r+1)),o&&n&&(i=i/100*(Pt(n)?n[0]:n).totalDuration()),r>1?e(t,a.substr(0,r-1),n)+i:c+i)):null==a?c:+a},Ya=function(e,t,a){var n,r,i=kt(t[1]),o=(i?2:1)+(e<2?0:1),s=t[o];if(i&&(s.duration=t[1]),s.parent=a,e){for(n=s,r=a;r&&!("immediateRender"in n);)n=r.vars.defaults||{},r=Et(r.vars.inherit)&&r.parent;s.immediateRender=Et(n.immediateRender),e<2?s.runBackwards=1:s.startAt=t[o-1]}return new Kn(t[0],s,t[o+1])},ja=function(e,t){return e||0===e?t(e):t},Xa=function(e,t,a){return a<e?e:a>t?t:a},$a=function(e,t){return Mt(e)&&(t=Ht.exec(e))?t[1]:""},Ka=[].slice,Za=function(e,t){return e&&At(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&At(e[0]))&&!e.nodeType&&e!==tt},Ja=function(e,t,a){return void 0===a&&(a=[]),e.forEach(function(e){var n;return Mt(e)&&!t||Za(e,1)?(n=a).push.apply(n,Qa(e)):a.push(e)})||a},Qa=function(e,t,a){return Qe&&!t&&Qe.selector?Qe.selector(e):!Mt(e)||a||!at&&Tn()?Pt(e)?Ja(e,a):Za(e)?Ka.call(e,0):e?[e]:[]:Ka.call((t||nt).querySelectorAll(e),0)},en=function(e){return e=Qa(e)[0]||jt("Invalid scope")||{},function(t){var a=e.current||e.nativeElement||e;return Qa(t,a.querySelectorAll?a:a===e?jt("Invalid scope")||nt.createElement("div"):e)}},tn=function(e){return e.sort(function(){return.5-Math.random()})},an=function(e){if(Tt(e))return e;var t=At(e)?e:{each:e},a=Dn(t.ease),n=t.from||0,r=parseFloat(t.base)||0,i={},o=n>0&&n<1,s=isNaN(n)||o,l=t.axis,c=n,u=n;return Mt(n)?c=u={center:.5,edges:.5,end:1}[n]||0:!o&&s&&(c=n[0],u=n[1]),function(e,o,d){var h,p,f,m,v,g,y,b,x,w=(d||t).length,_=i[w];if(!_){if(!(x="auto"===t.grid?0:(t.grid||[1,vt])[1])){for(y=-1e8;y<(y=d[x++].getBoundingClientRect().left)&&x<w;);x<w&&x--}for(_=i[w]=[],h=s?Math.min(x,w)*c-.5:n%x,p=x===vt?0:s?w*u/x-.5:n/x|0,y=0,b=vt,g=0;g<w;g++)f=g%x-h,m=p-(g/x|0),_[g]=v=l?Math.abs("y"===l?m:f):wt(f*f+m*m),v>y&&(y=v),v<b&&(b=v);"random"===n&&tn(_),_.max=y-b,_.min=b,_.v=w=(parseFloat(t.amount)||parseFloat(t.each)*(x>w?w-1:l?"y"===l?w/x:x:Math.max(x,w/x))||0)*("edges"===n?-1:1),_.b=w<0?r-w:r,_.u=$a(t.amount||t.each)||0,a=a&&w<0?In(a):a}return w=(_[e]-_.min)/_.max||0,ha(_.b+(a?a(w):w)*_.v)+_.u}},nn=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(a){var n=ha(Math.round(parseFloat(a)/e)*e*t);return(n-n%1)/t+(kt(a)?0:$a(a))}},rn=function(e,t){var a,n,r=Pt(e);return!r&&At(e)&&(a=r=e.radius||vt,e.values?(e=Qa(e.values),(n=!kt(e[0]))&&(a*=a)):e=nn(e.increment)),ja(t,r?Tt(e)?function(t){return n=e(t),Math.abs(n-t)<=a?n:t}:function(t){for(var r,i,o=parseFloat(n?t.x:t),s=parseFloat(n?t.y:0),l=vt,c=0,u=e.length;u--;)(r=n?(r=e[u].x-o)*r+(i=e[u].y-s)*i:Math.abs(e[u]-o))<l&&(l=r,c=u);return c=!a||l<=a?e[c]:t,n||c===t||kt(t)?c:c+$a(t)}:nn(e))},on=function(e,t,a,n){return ja(Pt(e)?!t:!0===a?!!(a=0):!n,function(){return Pt(e)?e[~~(Math.random()*e.length)]:(a=a||1e-5)&&(n=a<1?Math.pow(10,(a+"").length-2):1)&&Math.floor(Math.round((e-a/2+Math.random()*(t-e+.99*a))/a)*a*n)/n})},sn=function(e,t,a){return ja(a,function(a){return e[~~t(a)]})},ln=function(e){return e.replace(Lt,function(e){var t=e.indexOf("[")+1,a=e.substring(t||7,t?e.indexOf("]"):e.length-1).split(Nt);return on(t?a:+a[0],t?0:+a[1],+a[2]||1e-5)})},cn=function(e,t,a,n,r){var i=t-e,o=n-a;return ja(r,function(t){return a+((t-e)/i*o||0)})},un=function(e,t,a){var n,r,i,o=e.labels,s=vt;for(n in o)(r=o[n]-t)<0==!!a&&r&&s>(r=Math.abs(r))&&(i=n,s=r);return i},dn=function(e,t,a){var n,r,i,o=e.vars,s=o[t],l=Qe,c=e._ctx;if(s)return n=o[t+"Params"],r=o.callbackScope||e,a&&ea.length&&ma(),c&&(Qe=c),i=n?s.apply(r,n):s.call(r),Qe=l,i},hn=function(e){return Ca(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Je),e.progress()<1&&dn(e,"onInterrupt"),e},pn=[],fn=function(e){if(e)if(e=!e.name&&e.default||e,It()||e.headless){var t=e.name,a=Tt(e),n=t&&!a&&e.init?function(){this._props=[]}:e,r={init:$t,render:ir,add:Gn,kill:sr,modifier:or,rawVars:0},i={targetTest:0,get:0,getSetter:tr,aliases:{},register:0};if(Tn(),e!==n){if(aa[t])return;xa(n,xa(Sa(e,r),i)),wa(n.prototype,wa(r,Sa(e,i))),aa[n.prop=t]=n,e.targetTest&&(ia.push(n),Qt[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Xt(t,n),e.register&&e.register(Sr,n,ur)}else pn.push(e)},mn=255,vn={aqua:[0,mn,mn],lime:[0,mn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,mn],navy:[0,0,128],white:[mn,mn,mn],olive:[128,128,0],yellow:[mn,mn,0],orange:[mn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[mn,0,0],pink:[mn,192,203],cyan:[0,mn,mn],transparent:[mn,mn,mn,0]},gn=function(e,t,a){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(a-t)*e*6:e<.5?a:3*e<2?t+(a-t)*(2/3-e)*6:t)*mn+.5|0},yn=function(e,t,a){var n,r,i,o,s,l,c,u,d,h,p=e?kt(e)?[e>>16,e>>8&mn,e&mn]:0:vn.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),vn[e])p=vn[e];else if("#"===e.charAt(0)){if(e.length<6&&(n=e.charAt(1),r=e.charAt(2),i=e.charAt(3),e="#"+n+n+r+r+i+i+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&mn,p&mn,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&mn,e&mn]}else if("hsl"===e.substr(0,3))if(p=h=e.match(Ot),t){if(~e.indexOf("="))return p=e.match(Ft),a&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,s=+p[1]/100,n=2*(l=+p[2]/100)-(r=l<=.5?l*(s+1):l+s-l*s),p.length>3&&(p[3]*=1),p[0]=gn(o+1/3,n,r),p[1]=gn(o,n,r),p[2]=gn(o-1/3,n,r);else p=e.match(Ot)||vn.transparent;p=p.map(Number)}return t&&!h&&(n=p[0]/mn,r=p[1]/mn,i=p[2]/mn,l=((c=Math.max(n,r,i))+(u=Math.min(n,r,i)))/2,c===u?o=s=0:(d=c-u,s=l>.5?d/(2-c-u):d/(c+u),o=c===n?(r-i)/d+(r<i?6:0):c===r?(i-n)/d+2:(n-r)/d+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*s+.5),p[2]=~~(100*l+.5)),a&&p.length<4&&(p[3]=1),p},bn=function(e){var t=[],a=[],n=-1;return e.split(wn).forEach(function(e){var r=e.match(Bt)||[];t.push.apply(t,r),a.push(n+=r.length+1)}),t.c=a,t},xn=function(e,t,a){var n,r,i,o,s="",l=(e+s).match(wn),c=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map(function(e){return(e=yn(e,t,1))&&c+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"}),a&&(i=bn(e),(n=a.c).join(s)!==i.c.join(s)))for(o=(r=e.replace(wn,"1").split(Bt)).length-1;u<o;u++)s+=r[u]+(~n.indexOf(u)?l.shift()||c+"0,0,0,0)":(i.length?i:l.length?l:a).shift());if(!r)for(o=(r=e.split(wn)).length-1;u<o;u++)s+=r[u]+l[u];return s+r[o]},wn=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in vn)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),_n=/hsl[a]?\(/,Sn=function(e){var t,a=e.join(" ");if(wn.lastIndex=0,wn.test(a))return t=_n.test(a),e[1]=xn(e[1],t),e[0]=xn(e[0],t,bn(e[1])),!0},Mn=function(){var e,t,a,n,r,i,o=Date.now,s=500,l=33,c=o(),u=c,d=1e3/240,h=d,p=[],f=function a(f){var m,v,g,y,b=o()-u,x=!0===f;if((b>s||b<0)&&(c+=b-l),((m=(g=(u+=b)-c)-h)>0||x)&&(y=++n.frame,r=g-1e3*n.time,n.time=g/=1e3,h+=m+(m>=d?4:d-m),v=1),x||(e=t(a)),v)for(i=0;i<p.length;i++)p[i](g,r,y,f)};return n={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(e){return r/(1e3/(e||60))},wake:function(){rt&&(!at&&It()&&(tt=at=window,nt=tt.document||{},Gt.gsap=Sr,(tt.gsapVersions||(tt.gsapVersions=[])).push(Sr.version),qt(Wt||tt.GreenSockGlobals||!tt.gsap&&tt||{}),pn.forEach(fn)),a="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,e&&n.sleep(),t=a||function(e){return setTimeout(e,h-1e3*n.time+1|0)},st=1,f(2))},sleep:function(){(a?cancelAnimationFrame:clearTimeout)(e),st=0,t=$t},lagSmoothing:function(e,t){s=e||1/0,l=Math.min(t||33,s)},fps:function(e){d=1e3/(e||240),h=1e3*n.time+d},add:function(e,t,a){var r=t?function(t,a,i,o){e(t,a,i,o),n.remove(r)}:e;return n.remove(e),p[a?"unshift":"push"](r),Tn(),r},remove:function(e,t){~(t=p.indexOf(e))&&p.splice(t,1)&&i>=t&&i--},_listeners:p},n}(),Tn=function(){return!st&&Mn.wake()},kn={},Cn=/^[\d.\-M][\d.\-,\s]/,An=/["']/g,En=function(e){for(var t,a,n,r={},i=e.substr(1,e.length-3).split(":"),o=i[0],s=1,l=i.length;s<l;s++)a=i[s],t=s!==l-1?a.lastIndexOf(","):a.length,n=a.substr(0,t),r[o]=isNaN(n)?n.replace(An,"").trim():+n,o=a.substr(t+1).trim();return r},In=function(e){return function(t){return 1-e(1-t)}},Rn=function e(t,a){for(var n,r=t._first;r;)r instanceof Un?e(r,a):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===a||(r.timeline?e(r.timeline,a):(n=r._ease,r._ease=r._yEase,r._yEase=n,r._yoyo=a)),r=r._next},Dn=function(e,t){return e&&(Tt(e)?e:kn[e]||function(e){var t=(e+"").split("("),a=kn[t[0]];return a&&t.length>1&&a.config?a.config.apply(null,~e.indexOf("{")?[En(t[1])]:function(e){var t=e.indexOf("(")+1,a=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<a?e.indexOf(")",a+1):a)}(e).split(",").map(ya)):kn._CE&&Cn.test(e)?kn._CE("",e):a}(e))||t},Pn=function(e,t,a,n){void 0===a&&(a=function(e){return 1-t(1-e)}),void 0===n&&(n=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var r,i={easeIn:t,easeOut:a,easeInOut:n};return ua(e,function(e){for(var t in kn[e]=Gt[e]=i,kn[r=e.toLowerCase()]=a,i)kn[r+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=kn[e+"."+t]=i[t]}),i},Ln=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Nn=function e(t,a,n){var r=a>=1?a:1,i=(n||(t?.3:.45))/(a<1?a:1),o=i/yt*(Math.asin(1/r)||0),s=function(e){return 1===e?1:r*Math.pow(2,-10*e)*St((e-o)*i)+1},l="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:Ln(s);return i=yt/i,l.config=function(a,n){return e(t,a,n)},l},On=function e(t,a){void 0===a&&(a=1.70158);var n=function(e){return e?--e*e*((a+1)*e+a)+1:0},r="out"===t?n:"in"===t?function(e){return 1-n(1-e)}:Ln(n);return r.config=function(a){return e(t,a)},r};ua("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var a=t<5?t+1:t;Pn(e+",Power"+(a-1),t?function(e){return Math.pow(e,a)}:function(e){return e},function(e){return 1-Math.pow(1-e,a)},function(e){return e<.5?Math.pow(2*e,a)/2:1-Math.pow(2*(1-e),a)/2})}),kn.Linear.easeNone=kn.none=kn.Linear.easeIn,Pn("Elastic",Nn("in"),Nn("out"),Nn()),lt=7.5625,dt=2*(ut=1/(ct=2.75)),ht=2.5*ut,Pn("Bounce",function(e){return 1-pt(1-e)},pt=function(e){return e<ut?lt*e*e:e<dt?lt*Math.pow(e-1.5/ct,2)+.75:e<ht?lt*(e-=2.25/ct)*e+.9375:lt*Math.pow(e-2.625/ct,2)+.984375}),Pn("Expo",function(e){return Math.pow(2,10*(e-1))*e+e*e*e*e*e*e*(1-e)}),Pn("Circ",function(e){return-(wt(1-e*e)-1)}),Pn("Sine",function(e){return 1===e?1:1-_t(e*bt)}),Pn("Back",On("in"),On("out"),On()),kn.SteppedEase=kn.steps=Gt.SteppedEase={config:function(e,t){void 0===e&&(e=1);var a=1/e,n=e+(t?0:1),r=t?1:0;return function(e){return((n*Xa(0,.99999999,e)|0)+r)*a}}},mt.ease=kn["quad.out"],ua("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return oa+=e+","+e+"Params,"});var Fn=function(e,t){this.id=xt++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:ca,this.set=t?t.getSetter:tr},Bn=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Ha(this,+e.duration,1,1),this.data=e.data,Qe&&(this._ctx=Qe,Qe.data.push(this)),st||Mn.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,Ha(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(Tn(),!arguments.length)return this._tTime;var a=this._dp;if(a&&a.smoothChildTiming&&this._ts){for(Na(this,e),!a._dp||a.parent||Oa(a,this);a&&a.parent;)a.parent._time!==a._start+(a._ts>=0?a._tTime/a._ts:(a.totalDuration()-a._tTime)/-a._ts)&&a.totalTime(a._tTime,!0),a=a.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Fa(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===gt||!this._initted&&this._dur&&e||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),ga(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+Ra(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+Ra(this),t):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,t){var a=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*a,t):this._repeat?Da(this._tTime,a)+1:1},t.timeScale=function(e,t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var a=this.parent&&this._ts?Pa(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(Xa(-Math.abs(this._delay),this.totalDuration(),a),!1!==t),La(this),function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e}(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Tn(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==gt&&(this._tTime-=gt)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=ha(e);var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&Fa(t,this,this._start-this._delay),this}return this._start},t.endTime=function(e){return this._start+(Et(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Pa(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=Jt);var t=Je;return Je=e,va(this)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),Je=t,this},t.globalTime=function(e){for(var t=this,a=arguments.length?e:t.rawTime();t;)a=t._start+a/(Math.abs(t._ts)||1),t=t._dp;return!this.parent&&this._sat?this._sat.globalTime(e):a},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Ga(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,Ga(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(qa(this,e),Et(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,Et(t)),this._dur||(this._zTime=-1e-8),this},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,a=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=a&&e<this.endTime(!0)-gt))},t.eventCallback=function(e,t,a){var n=this.vars;return arguments.length>1?(t?(n[e]=t,a&&(n[e+"Params"]=a),"onUpdate"===e&&(this._onUpdate=t)):delete n[e],this):n[e]},t.then=function(e){var t=this,a=t._prom;return new Promise(function(n){var r=Tt(e)?e:ba,i=function(){var e=t.then;t.then=null,a&&a(),Tt(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i})},t.kill=function(){hn(this)},e}();xa(Bn.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Un=function(e){function t(t,a){var n;return void 0===t&&(t={}),(n=e.call(this,t)||this).labels={},n.smoothChildTiming=!!t.smoothChildTiming,n.autoRemoveChildren=!!t.autoRemoveChildren,n._sort=Et(t.sortChildren),et&&Fa(t.parent||et,$e(n),a),t.reversed&&n.reverse(),t.paused&&n.paused(!0),t.scrollTrigger&&Ba($e(n),t.scrollTrigger),n}Ke(t,e);var a=t.prototype;return a.to=function(e,t,a){return Ya(0,arguments,this),this},a.from=function(e,t,a){return Ya(1,arguments,this),this},a.fromTo=function(e,t,a,n){return Ya(2,arguments,this),this},a.set=function(e,t,a){return t.duration=0,t.parent=this,Ma(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new Kn(e,t,qa(this,a),1),this},a.call=function(e,t,a){return Fa(this,Kn.delayedCall(0,e,t),a)},a.staggerTo=function(e,t,a,n,r,i,o){return a.duration=t,a.stagger=a.stagger||n,a.onComplete=i,a.onCompleteParams=o,a.parent=this,new Kn(e,a,qa(this,r)),this},a.staggerFrom=function(e,t,a,n,r,i,o){return a.runBackwards=1,Ma(a).immediateRender=Et(a.immediateRender),this.staggerTo(e,t,a,n,r,i,o)},a.staggerFromTo=function(e,t,a,n,r,i,o,s){return n.startAt=a,Ma(n).immediateRender=Et(n.immediateRender),this.staggerTo(e,t,n,r,i,o,s)},a.render=function(e,t,a){var n,r,i,o,s,l,c,u,d,h,p,f,m=this._time,v=this._dirty?this.totalDuration():this._tDur,g=this._dur,y=e<=0?0:ha(e),b=this._zTime<0!=e<0&&(this._initted||!g);if(this!==et&&y>v&&e>=0&&(y=v),y!==this._tTime||a||b){if(m!==this._time&&g&&(y+=this._time-m,e+=this._time-m),n=y,d=this._start,l=!(u=this._ts),b&&(g||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(p=this._yoyo,s=g+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*s+e,t,a);if(n=ha(y%s),y===v?(o=this._repeat,n=g):((o=~~(h=ha(y/s)))&&o===h&&(n=g,o--),n>g&&(n=g)),h=Da(this._tTime,s),!m&&this._tTime&&h!==o&&this._tTime-h*s-this._dur<=0&&(h=o),p&&1&o&&(n=g-n,f=1),o!==h&&!this._lock){var x=p&&1&h,w=x===(p&&1&o);if(o<h&&(x=!x),m=x?0:y%g?g:y,this._lock=1,this.render(m||(f?0:ha(o*s)),t,!g)._lock=0,this._tTime=y,!t&&this.parent&&dn(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1,h=o),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(g=this._dur,v=this._tDur,w&&(this._lock=2,m=x?g:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;Rn(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(e,t,a){var n;if(a>t)for(n=e._first;n&&n._start<=a;){if("isPause"===n.data&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=a;){if("isPause"===n.data&&n._start<t)return n;n=n._prev}}(this,ha(m),ha(n)),c&&(y-=n-(n=c._start))),this._tTime=y,this._time=n,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&y&&g&&!t&&!h&&(dn(this,"onStart"),this._tTime!==y))return this;if(n>=m&&e>=0)for(r=this._first;r;){if(i=r._next,(r._act||n>=r._start)&&r._ts&&c!==r){if(r.parent!==this)return this.render(e,t,a);if(r.render(r._ts>0?(n-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(n-r._start)*r._ts,t,a),n!==this._time||!this._ts&&!l){c=0,i&&(y+=this._zTime=-1e-8);break}}r=i}else{r=this._last;for(var _=e<0?e:n;r;){if(i=r._prev,(r._act||_<=r._end)&&r._ts&&c!==r){if(r.parent!==this)return this.render(e,t,a);if(r.render(r._ts>0?(_-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(_-r._start)*r._ts,t,a||Je&&va(r)),n!==this._time||!this._ts&&!l){c=0,i&&(y+=this._zTime=_?-1e-8:gt);break}}r=i}}if(c&&!t&&(this.pause(),c.render(n>=m?0:-1e-8)._zTime=n>=m?1:-1,this._ts))return this._start=d,La(this),this.render(e,t,a);this._onUpdate&&!t&&dn(this,"onUpdate",!0),(y===v&&this._tTime>=this.totalDuration()||!y&&m)&&(d!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((e||!g)&&(y===v&&this._ts>0||!y&&this._ts<0)&&Ca(this,1),t||e<0&&!m||!y&&!m&&v||(dn(this,y===v&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<v&&this.timeScale()>0)&&this._prom())))}return this},a.add=function(e,t){var a=this;if(kt(t)||(t=qa(this,t,e)),!(e instanceof Bn)){if(Pt(e))return e.forEach(function(e){return a.add(e,t)}),this;if(Mt(e))return this.addLabel(e,t);if(!Tt(e))return this;e=Kn.delayedCall(0,e)}return this!==e?Fa(this,e,t):this},a.getChildren=function(e,t,a,n){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===a&&(a=!0),void 0===n&&(n=-1e8);for(var r=[],i=this._first;i;)i._start>=n&&(i instanceof Kn?t&&r.push(i):(a&&r.push(i),e&&r.push.apply(r,i.getChildren(!0,t,a)))),i=i._next;return r},a.getById=function(e){for(var t=this.getChildren(1,1,1),a=t.length;a--;)if(t[a].vars.id===e)return t[a]},a.remove=function(e){return Mt(e)?this.removeLabel(e):Tt(e)?this.killTweensOf(e):(e.parent===this&&ka(this,e),e===this._recent&&(this._recent=this._last),Aa(this))},a.totalTime=function(t,a){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ha(Mn.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,a),this._forcing=0,this):this._tTime},a.addLabel=function(e,t){return this.labels[e]=qa(this,t),this},a.removeLabel=function(e){return delete this.labels[e],this},a.addPause=function(e,t,a){var n=Kn.delayedCall(0,t||$t,a);return n.data="isPause",this._hasPause=1,Fa(this,n,qa(this,e))},a.removePause=function(e){var t=this._first;for(e=qa(this,e);t;)t._start===e&&"isPause"===t.data&&Ca(t),t=t._next},a.killTweensOf=function(e,t,a){for(var n=this.getTweensOf(e,a),r=n.length;r--;)zn!==n[r]&&n[r].kill(e,t);return this},a.getTweensOf=function(e,t){for(var a,n=[],r=Qa(e),i=this._first,o=kt(t);i;)i instanceof Kn?fa(i._targets,r)&&(o?(!zn||i._initted&&i._ts)&&i.globalTime(0)<=t&&i.globalTime(i.totalDuration())>t:!t||i.isActive())&&n.push(i):(a=i.getTweensOf(r,t)).length&&n.push.apply(n,a),i=i._next;return n},a.tweenTo=function(e,t){t=t||{};var a,n=this,r=qa(n,e),i=t,o=i.startAt,s=i.onStart,l=i.onStartParams,c=i.immediateRender,u=Kn.to(n,xa({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:t.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale())||gt,onStart:function(){if(n.pause(),!a){var e=t.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale());u._dur!==e&&Ha(u,e,0,1).render(u._time,!0,!0),a=1}s&&s.apply(u,l||[])}},t));return c?u.render(0):u},a.tweenFromTo=function(e,t,a){return this.tweenTo(t,xa({startAt:{time:qa(this,e)}},a))},a.recent=function(){return this._recent},a.nextLabel=function(e){return void 0===e&&(e=this._time),un(this,qa(this,e))},a.previousLabel=function(e){return void 0===e&&(e=this._time),un(this,qa(this,e),1)},a.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+gt)},a.shiftChildren=function(e,t,a){void 0===a&&(a=0);var n,r=this._first,i=this.labels;for(e=ha(e);r;)r._start>=a&&(r._start+=e,r._end+=e),r=r._next;if(t)for(n in i)i[n]>=a&&(i[n]+=e);return Aa(this)},a.invalidate=function(t){var a=this._first;for(this._lock=0;a;)a.invalidate(t),a=a._next;return e.prototype.invalidate.call(this,t)},a.clear=function(e){void 0===e&&(e=!0);for(var t,a=this._first;a;)t=a._next,this.remove(a),a=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Aa(this)},a.totalDuration=function(e){var t,a,n,r=0,i=this,o=i._last,s=vt;if(arguments.length)return i.timeScale((i._repeat<0?i.duration():i.totalDuration())/(i.reversed()?-e:e));if(i._dirty){for(n=i.parent;o;)t=o._prev,o._dirty&&o.totalDuration(),(a=o._start)>s&&i._sort&&o._ts&&!i._lock?(i._lock=1,Fa(i,o,a-o._delay,1)._lock=0):s=a,a<0&&o._ts&&(r-=a,(!n&&!i._dp||n&&n.smoothChildTiming)&&(i._start+=ha(a/i._ts),i._time-=a,i._tTime-=a),i.shiftChildren(-a,!1,-1/0),s=0),o._end>r&&o._ts&&(r=o._end),o=t;Ha(i,i===et&&i._time>r?i._time:r,1,1),i._dirty=0}return i._tDur},t.updateRoot=function(e){if(et._ts&&(ga(et,Pa(e,et)),it=Mn.frame),Mn.frame>=ra){ra+=ft.autoSleep||120;var t=et._first;if((!t||!t._ts)&&ft.autoSleep&&Mn._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Mn.sleep()}}},t}(Bn);xa(Un.prototype,{_lock:0,_hasPause:0,_forcing:0});var zn,Vn,Hn=function(e,t,a,n,r,i,o){var s,l,c,u,d,h,p,f,m=new ur(this._pt,e,t,0,1,rr,null,r),v=0,g=0;for(m.b=a,m.e=n,a+="",(p=~(n+="").indexOf("random("))&&(n=ln(n)),i&&(i(f=[a,n],e,t),a=f[0],n=f[1]),l=a.match(Ut)||[];s=Ut.exec(n);)u=s[0],d=n.substring(v,s.index),c?c=(c+1)%5:"rgba("===d.substr(-5)&&(c=1),u!==l[g++]&&(h=parseFloat(l[g-1])||0,m._pt={_next:m._pt,p:d||1===g?d:",",s:h,c:"="===u.charAt(1)?pa(h,u)-h:parseFloat(u)-h,m:c&&c<4?Math.round:0},v=Ut.lastIndex);return m.c=v<n.length?n.substring(v,n.length):"",m.fp=o,(zt.test(n)||p)&&(m.e=0),this._pt=m,m},Gn=function(e,t,a,n,r,i,o,s,l,c){Tt(n)&&(n=n(r||0,e,i));var u,d=e[t],h="get"!==a?a:Tt(d)?l?e[t.indexOf("set")||!Tt(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():d,p=Tt(d)?l?Qn:Jn:Zn;if(Mt(n)&&(~n.indexOf("random(")&&(n=ln(n)),"="===n.charAt(1)&&((u=pa(h,n)+($a(h)||0))||0===u)&&(n=u)),!c||h!==n||Vn)return isNaN(h*n)||""===n?(!d&&!(t in e)&&Yt(t,n),Hn.call(this,e,t,h,n,p,s||ft.stringFilter,l)):(u=new ur(this._pt,e,t,+h||0,n-(h||0),"boolean"==typeof d?nr:ar,0,p),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},Wn=function(e,t,a,n,r,i){var o,s,l,c;if(aa[e]&&!1!==(o=new aa[e]).init(r,o.rawVars?t[e]:function(e,t,a,n,r){if(Tt(e)&&(e=jn(e,r,t,a,n)),!At(e)||e.style&&e.nodeType||Pt(e)||Dt(e))return Mt(e)?jn(e,r,t,a,n):e;var i,o={};for(i in e)o[i]=jn(e[i],r,t,a,n);return o}(t[e],n,r,i,a),a,n,i)&&(a._pt=s=new ur(a._pt,r,e,0,1,o.render,o,0,o.priority),a!==ot))for(l=a._ptLookup[a._targets.indexOf(r)],c=o._props.length;c--;)l[o._props[c]]=s;return o},qn=function e(t,a,n){var r,i,o,s,l,c,u,d,h,p,f,m,v,g=t.vars,y=g.ease,b=g.startAt,x=g.immediateRender,w=g.lazy,_=g.onUpdate,S=g.runBackwards,M=g.yoyoEase,T=g.keyframes,k=g.autoRevert,C=t._dur,A=t._startAt,E=t._targets,I=t.parent,R=I&&"nested"===I.data?I.vars.targets:E,D="auto"===t._overwrite&&!Ze,P=t.timeline;if(P&&(!T||!y)&&(y="none"),t._ease=Dn(y,mt.ease),t._yEase=M?In(Dn(!0===M?y:M,mt.ease)):0,M&&t._yoyo&&!t._repeat&&(M=t._yEase,t._yEase=t._ease,t._ease=M),t._from=!P&&!!g.runBackwards,!P||T&&!g.stagger){if(m=(d=E[0]?la(E[0]).harness:0)&&g[d.prop],r=Sa(g,Qt),A&&(A._zTime<0&&A.progress(1),a<0&&S&&x&&!k?A.render(-1,!0):A.revert(S&&C?Zt:Kt),A._lazy=0),b){if(Ca(t._startAt=Kn.set(E,xa({data:"isStart",overwrite:!1,parent:I,immediateRender:!0,lazy:!A&&Et(w),startAt:null,delay:0,onUpdate:_&&function(){return dn(t,"onUpdate")},stagger:0},b))),t._startAt._dp=0,t._startAt._sat=t,a<0&&(Je||!x&&!k)&&t._startAt.revert(Zt),x&&C&&a<=0&&n<=0)return void(a&&(t._zTime=a))}else if(S&&C&&!A)if(a&&(x=!1),o=xa({overwrite:!1,data:"isFromStart",lazy:x&&!A&&Et(w),immediateRender:x,stagger:0,parent:I},r),m&&(o[d.prop]=m),Ca(t._startAt=Kn.set(E,o)),t._startAt._dp=0,t._startAt._sat=t,a<0&&(Je?t._startAt.revert(Zt):t._startAt.render(-1,!0)),t._zTime=a,x){if(!a)return}else e(t._startAt,gt,gt);for(t._pt=t._ptCache=0,w=C&&Et(w)||w&&!C,i=0;i<E.length;i++){if(u=(l=E[i])._gsap||sa(E)[i]._gsap,t._ptLookup[i]=p={},ta[u.id]&&ea.length&&ma(),f=R===E?i:R.indexOf(l),d&&!1!==(h=new d).init(l,m||r,t,f,R)&&(t._pt=s=new ur(t._pt,l,h.name,0,1,h.render,h,0,h.priority),h._props.forEach(function(e){p[e]=s}),h.priority&&(c=1)),!d||m)for(o in r)aa[o]&&(h=Wn(o,r,t,f,l,R))?h.priority&&(c=1):p[o]=s=Gn.call(t,l,o,"get",r[o],f,R,0,g.stringFilter);t._op&&t._op[i]&&t.kill(l,t._op[i]),D&&t._pt&&(zn=t,et.killTweensOf(l,p,t.globalTime(a)),v=!t.parent,zn=0),t._pt&&w&&(ta[u.id]=1)}c&&cr(t),t._onInit&&t._onInit(t)}t._onUpdate=_,t._initted=(!t._op||t._pt)&&!v,T&&a<=0&&P.render(vt,!0,!0)},Yn=function(e,t,a,n){var r,i,o=t.ease||n||"power1.inOut";if(Pt(t))i=a[e]||(a[e]=[]),t.forEach(function(e,a){return i.push({t:a/(t.length-1)*100,v:e,e:o})});else for(r in t)i=a[r]||(a[r]=[]),"ease"===r||i.push({t:parseFloat(e),v:t[r],e:o})},jn=function(e,t,a,n,r){return Tt(e)?e.call(t,a,n,r):Mt(e)&&~e.indexOf("random(")?ln(e):e},Xn=oa+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",$n={};ua(Xn+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return $n[e]=1});var Kn=function(e){function t(t,a,n,r){var i;"number"==typeof a&&(n.duration=a,a=n,n=null);var o,s,l,c,u,d,h,p,f=(i=e.call(this,r?a:Ma(a))||this).vars,m=f.duration,v=f.delay,g=f.immediateRender,y=f.stagger,b=f.overwrite,x=f.keyframes,w=f.defaults,_=f.scrollTrigger,S=f.yoyoEase,M=a.parent||et,T=(Pt(t)||Dt(t)?kt(t[0]):"length"in a)?[t]:Qa(t);if(i._targets=T.length?sa(T):jt("GSAP target "+t+" not found. https://gsap.com",!ft.nullTargetWarn)||[],i._ptLookup=[],i._overwrite=b,x||y||Rt(m)||Rt(v)){if(a=i.vars,(o=i.timeline=new Un({data:"nested",defaults:w||{},targets:M&&"nested"===M.data?M.vars.targets:T})).kill(),o.parent=o._dp=$e(i),o._start=0,y||Rt(m)||Rt(v)){if(c=T.length,h=y&&an(y),At(y))for(u in y)~Xn.indexOf(u)&&(p||(p={}),p[u]=y[u]);for(s=0;s<c;s++)(l=Sa(a,$n)).stagger=0,S&&(l.yoyoEase=S),p&&wa(l,p),d=T[s],l.duration=+jn(m,$e(i),s,d,T),l.delay=(+jn(v,$e(i),s,d,T)||0)-i._delay,!y&&1===c&&l.delay&&(i._delay=v=l.delay,i._start+=v,l.delay=0),o.to(d,l,h?h(s,d,T):0),o._ease=kn.none;o.duration()?m=v=0:i.timeline=0}else if(x){Ma(xa(o.vars.defaults,{ease:"none"})),o._ease=Dn(x.ease||a.ease||"none");var k,C,A,E=0;if(Pt(x))x.forEach(function(e){return o.to(T,e,">")}),o.duration();else{for(u in l={},x)"ease"===u||"easeEach"===u||Yn(u,x[u],l,x.easeEach);for(u in l)for(k=l[u].sort(function(e,t){return e.t-t.t}),E=0,s=0;s<k.length;s++)(A={ease:(C=k[s]).e,duration:(C.t-(s?k[s-1].t:0))/100*m})[u]=C.v,o.to(T,A,E),E+=A.duration;o.duration()<m&&o.to({},{duration:m-o.duration()})}}m||i.duration(m=o.duration())}else i.timeline=0;return!0!==b||Ze||(zn=$e(i),et.killTweensOf(T),zn=0),Fa(M,$e(i),n),a.reversed&&i.reverse(),a.paused&&i.paused(!0),(g||!m&&!x&&i._start===ha(M._time)&&Et(g)&&Ia($e(i))&&"nested"!==M.data)&&(i._tTime=-1e-8,i.render(Math.max(0,-v)||0)),_&&Ba($e(i),_),i}Ke(t,e);var a=t.prototype;return a.render=function(e,t,a){var n,r,i,o,s,l,c,u,d,h=this._time,p=this._tDur,f=this._dur,m=e<0,v=e>p-gt&&!m?p:e<gt?0:e;if(f){if(v!==this._tTime||!e||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(n=v,u=this.timeline,this._repeat){if(o=f+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*o+e,t,a);if(n=ha(v%o),v===p?(i=this._repeat,n=f):(i=~~(s=ha(v/o)))&&i===s?(n=f,i--):n>f&&(n=f),(l=this._yoyo&&1&i)&&(d=this._yEase,n=f-n),s=Da(this._tTime,o),n===h&&!a&&this._initted&&i===s)return this._tTime=v,this;i!==s&&(u&&this._yEase&&Rn(u,l),this.vars.repeatRefresh&&!l&&!this._lock&&n!==o&&this._initted&&(this._lock=a=1,this.render(ha(o*i),!0).invalidate()._lock=0))}if(!this._initted){if(Ua(this,m?e:n,a,t,v))return this._tTime=0,this;if(!(h===this._time||a&&this.vars.repeatRefresh&&i!==s))return this;if(f!==this._dur)return this.render(e,t,a)}if(this._tTime=v,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(d||this._ease)(n/f),this._from&&(this.ratio=c=1-c),!h&&v&&!t&&!s&&(dn(this,"onStart"),this._tTime!==v))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;u&&u.render(e<0?e:u._dur*u._ease(n/this._dur),t,a)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(m&&Ea(this,e,0,a),dn(this,"onUpdate")),this._repeat&&i!==s&&this.vars.onRepeat&&!t&&this.parent&&dn(this,"onRepeat"),v!==this._tDur&&v||this._tTime!==v||(m&&!this._onUpdate&&Ea(this,e,0,!0),(e||!f)&&(v===this._tDur&&this._ts>0||!v&&this._ts<0)&&Ca(this,1),t||m&&!h||!(v||h||l)||(dn(this,v===p?"onComplete":"onReverseComplete",!0),this._prom&&!(v<p&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,a,n){var r,i,o,s=e.ratio,l=t<0||!t&&(!e._start&&za(e)&&(e._initted||!Va(e))||(e._ts<0||e._dp._ts<0)&&!Va(e))?0:1,c=e._rDelay,u=0;if(c&&e._repeat&&(u=Xa(0,e._tDur,t),i=Da(u,c),e._yoyo&&1&i&&(l=1-l),i!==Da(e._tTime,c)&&(s=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==s||Je||n||e._zTime===gt||!t&&e._zTime){if(!e._initted&&Ua(e,t,n,a,u))return;for(o=e._zTime,e._zTime=t||(a?gt:0),a||(a=t&&!o),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=u,r=e._pt;r;)r.r(l,r.d),r=r._next;t<0&&Ea(e,t,0,!0),e._onUpdate&&!a&&dn(e,"onUpdate"),u&&e._repeat&&!a&&e.parent&&dn(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&Ca(e,1),a||Je||(dn(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,a);return this},a.targets=function(){return this._targets},a.invalidate=function(t){return(!t||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},a.resetTo=function(e,t,a,n,r){st||Mn.wake(),this._ts||this.play();var i=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||qn(this,i),function(e,t,a,n,r,i,o,s){var l,c,u,d,h=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!h)for(h=e._ptCache[t]=[],u=e._ptLookup,d=e._targets.length;d--;){if((l=u[d][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return Vn=1,e.vars[t]="+=0",qn(e,o),Vn=0,s?jt(t+" not eligible for reset"):1;h.push(l)}for(d=h.length;d--;)(l=(c=h[d])._pt||c).s=!n&&0!==n||r?l.s+(n||0)+i*l.c:n,l.c=a-l.s,c.e&&(c.e=da(a)+$a(c.e)),c.b&&(c.b=l.s+$a(c.b))}(this,e,t,a,n,this._ease(i/this._dur),i,r)?this.resetTo(e,t,a,n,1):(Na(this,0),this.parent||Ta(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},a.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?hn(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Je),this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,zn&&!0!==zn.vars.overwrite)._first||hn(this),this.parent&&a!==this.timeline.totalDuration()&&Ha(this,this._dur*this.timeline._tDur/a,0,1),this}var n,r,i,o,s,l,c,u=this._targets,d=e?Qa(e):u,h=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var a=e.length,n=a===t.length;n&&a--&&e[a]===t[a];);return a<0}(u,d))return"all"===t&&(this._pt=0),hn(this);for(n=this._op=this._op||[],"all"!==t&&(Mt(t)&&(s={},ua(t,function(e){return s[e]=1}),t=s),t=function(e,t){var a,n,r,i,o=e[0]?la(e[0]).harness:0,s=o&&o.aliases;if(!s)return t;for(n in a=wa({},t),s)if(n in a)for(r=(i=s[n].split(",")).length;r--;)a[i[r]]=a[n];return a}(u,t)),c=u.length;c--;)if(~d.indexOf(u[c]))for(s in r=h[c],"all"===t?(n[c]=t,o=r,i={}):(i=n[c]=n[c]||{},o=t),o)(l=r&&r[s])&&("kill"in l.d&&!0!==l.d.kill(s)||ka(this,l,"_pt"),delete r[s]),"all"!==i&&(i[s]=1);return this._initted&&!this._pt&&p&&hn(this),this},t.to=function(e,a){return new t(e,a,arguments[2])},t.from=function(e,t){return Ya(1,arguments)},t.delayedCall=function(e,a,n,r){return new t(a,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:a,onReverseComplete:a,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},t.fromTo=function(e,t,a){return Ya(2,arguments)},t.set=function(e,a){return a.duration=0,a.repeatDelay||(a.repeat=0),new t(e,a)},t.killTweensOf=function(e,t,a){return et.killTweensOf(e,t,a)},t}(Bn);xa(Kn.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),ua("staggerTo,staggerFrom,staggerFromTo",function(e){Kn[e]=function(){var t=new Un,a=Ka.call(arguments,0);return a.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,a)}});var Zn=function(e,t,a){return e[t]=a},Jn=function(e,t,a){return e[t](a)},Qn=function(e,t,a,n){return e[t](n.fp,a)},er=function(e,t,a){return e.setAttribute(t,a)},tr=function(e,t){return Tt(e[t])?Jn:Ct(e[t])&&e.setAttribute?er:Zn},ar=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},nr=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},rr=function(e,t){var a=t._pt,n="";if(!e&&t.b)n=t.b;else if(1===e&&t.e)n=t.e;else{for(;a;)n=a.p+(a.m?a.m(a.s+a.c*e):Math.round(1e4*(a.s+a.c*e))/1e4)+n,a=a._next;n+=t.c}t.set(t.t,t.p,n,t)},ir=function(e,t){for(var a=t._pt;a;)a.r(e,a.d),a=a._next},or=function(e,t,a,n){for(var r,i=this._pt;i;)r=i._next,i.p===n&&i.modifier(e,t,a),i=r},sr=function(e){for(var t,a,n=this._pt;n;)a=n._next,n.p===e&&!n.op||n.op===e?ka(this,n,"_pt"):n.dep||(t=1),n=a;return!t},lr=function(e,t,a,n){n.mSet(e,t,n.m.call(n.tween,a,n.mt),n)},cr=function(e){for(var t,a,n,r,i=e._pt;i;){for(t=i._next,a=n;a&&a.pr>i.pr;)a=a._next;(i._prev=a?a._prev:r)?i._prev._next=i:n=i,(i._next=a)?a._prev=i:r=i,i=t}e._pt=n},ur=function(){function e(e,t,a,n,r,i,o,s,l){this.t=t,this.s=n,this.c=r,this.p=a,this.r=i||ar,this.d=o||this,this.set=s||Zn,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,a){this.mSet=this.mSet||this.set,this.set=lr,this.m=e,this.mt=a,this.tween=t},e}();ua(oa+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return Qt[e]=1}),Gt.TweenMax=Gt.TweenLite=Kn,Gt.TimelineLite=Gt.TimelineMax=Un,et=new Un({sortChildren:!1,defaults:mt,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),ft.stringFilter=Sn;var dr=[],hr={},pr=[],fr=0,mr=0,vr=function(e){return(hr[e]||pr).map(function(e){return e()})},gr=function(){var e=Date.now(),t=[];e-fr>2&&(vr("matchMediaInit"),dr.forEach(function(e){var a,n,r,i,o=e.queries,s=e.conditions;for(n in o)(a=tt.matchMedia(o[n]).matches)&&(r=1),a!==s[n]&&(s[n]=a,i=1);i&&(e.revert(),r&&t.push(e))}),vr("matchMediaRevert"),t.forEach(function(e){return e.onMatch(e,function(t){return e.add(null,t)})}),fr=e,vr("matchMedia"))},yr=function(){function e(e,t){this.selector=t&&en(t),this.data=[],this._r=[],this.isReverted=!1,this.id=mr++,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,a){Tt(e)&&(a=t,t=e,e=Tt);var n=this,r=function(){var e,r=Qe,i=n.selector;return r&&r!==n&&r.data.push(n),a&&(n.selector=en(a)),Qe=n,e=t.apply(n,arguments),Tt(e)&&n._r.push(e),Qe=r,n.selector=i,n.isReverted=!1,e};return n.last=r,e===Tt?r(n,function(e){return n.add(null,e)}):e?n[e]=r:r},t.ignore=function(e){var t=Qe;Qe=null,e(this),Qe=t},t.getTweens=function(){var t=[];return this.data.forEach(function(a){return a instanceof e?t.push.apply(t,a.getTweens()):a instanceof Kn&&!(a.parent&&"nested"===a.parent.data)&&t.push(a)}),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var a=this;if(e?function(){for(var t,n=a.getTweens(),r=a.data.length;r--;)"isFlip"===(t=a.data[r]).data&&(t.revert(),t.getChildren(!0,!0,!1).forEach(function(e){return n.splice(n.indexOf(e),1)}));for(n.map(function(e){return{g:e._dur||e._delay||e._sat&&!e._sat.vars.immediateRender?e.globalTime(0):-1/0,t:e}}).sort(function(e,t){return t.g-e.g||-1/0}).forEach(function(t){return t.t.revert(e)}),r=a.data.length;r--;)(t=a.data[r])instanceof Un?"nested"!==t.data&&(t.scrollTrigger&&t.scrollTrigger.revert(),t.kill()):!(t instanceof Kn)&&t.revert&&t.revert(e);a._r.forEach(function(t){return t(e,a)}),a.isReverted=!0}():this.data.forEach(function(e){return e.kill&&e.kill()}),this.clear(),t)for(var n=dr.length;n--;)dr[n].id===this.id&&dr.splice(n,1)},t.revert=function(e){this.kill(e||{})},e}(),br=function(){function e(e){this.contexts=[],this.scope=e,Qe&&Qe.data.push(this)}var t=e.prototype;return t.add=function(e,t,a){At(e)||(e={matches:e});var n,r,i,o=new yr(0,a||this.scope),s=o.conditions={};for(r in Qe&&!o.selector&&(o.selector=Qe.selector),this.contexts.push(o),t=o.add("onMatch",t),o.queries=e,e)"all"===r?i=1:(n=tt.matchMedia(e[r]))&&(dr.indexOf(o)<0&&dr.push(o),(s[r]=n.matches)&&(i=1),n.addListener?n.addListener(gr):n.addEventListener("change",gr));return i&&t(o,function(e){return o.add(null,e)}),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach(function(t){return t.kill(e,!0)})},e}(),xr={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t.forEach(function(e){return fn(e)})},timeline:function(e){return new Un(e)},getTweensOf:function(e,t){return et.getTweensOf(e,t)},getProperty:function(e,t,a,n){Mt(e)&&(e=Qa(e)[0]);var r=la(e||{}).get,i=a?ba:ya;return"native"===a&&(a=""),e?t?i((aa[t]&&aa[t].get||r)(e,t,a,n)):function(t,a,n){return i((aa[t]&&aa[t].get||r)(e,t,a,n))}:e},quickSetter:function(e,t,a){if((e=Qa(e)).length>1){var n=e.map(function(e){return Sr.quickSetter(e,t,a)}),r=n.length;return function(e){for(var t=r;t--;)n[t](e)}}e=e[0]||{};var i=aa[t],o=la(e),s=o.harness&&(o.harness.aliases||{})[t]||t,l=i?function(t){var n=new i;ot._pt=0,n.init(e,a?t+a:t,ot,0,[e]),n.render(1,n),ot._pt&&ir(1,ot)}:o.set(e,s);return i?l:function(t){return l(e,s,a?t+a:t,o,1)}},quickTo:function(e,t,a){var n,r=Sr.to(e,xa(((n={})[t]="+=0.1",n.paused=!0,n.stagger=0,n),a||{})),i=function(e,a,n){return r.resetTo(t,e,a,n)};return i.tween=r,i},isTweening:function(e){return et.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Dn(e.ease,mt.ease)),_a(mt,e||{})},config:function(e){return _a(ft,e||{})},registerEffect:function(e){var t=e.name,a=e.effect,n=e.plugins,r=e.defaults,i=e.extendTimeline;(n||"").split(",").forEach(function(e){return e&&!aa[e]&&!Gt[e]&&jt(t+" effect requires "+e+" plugin.")}),na[t]=function(e,t,n){return a(Qa(e),xa(t||{},r),n)},i&&(Un.prototype[t]=function(e,a,n){return this.add(na[t](e,At(a)?a:(n=a)&&{},this),n)})},registerEase:function(e,t){kn[e]=Dn(t)},parseEase:function(e,t){return arguments.length?Dn(e,t):kn},getById:function(e){return et.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var a,n,r=new Un(e);for(r.smoothChildTiming=Et(e.smoothChildTiming),et.remove(r),r._dp=0,r._time=r._tTime=et._time,a=et._first;a;)n=a._next,!t&&!a._dur&&a instanceof Kn&&a.vars.onComplete===a._targets[0]||Fa(r,a,a._start-a._delay),a=n;return Fa(et,r,0),r},context:function(e,t){return e?new yr(e,t):Qe},matchMedia:function(e){return new br(e)},matchMediaRefresh:function(){return dr.forEach(function(e){var t,a,n=e.conditions;for(a in n)n[a]&&(n[a]=!1,t=1);t&&e.revert()})||gr()},addEventListener:function(e,t){var a=hr[e]||(hr[e]=[]);~a.indexOf(t)||a.push(t)},removeEventListener:function(e,t){var a=hr[e],n=a&&a.indexOf(t);n>=0&&a.splice(n,1)},utils:{wrap:function e(t,a,n){var r=a-t;return Pt(t)?sn(t,e(0,t.length),a):ja(n,function(e){return(r+(e-t)%r)%r+t})},wrapYoyo:function e(t,a,n){var r=a-t,i=2*r;return Pt(t)?sn(t,e(0,t.length-1),a):ja(n,function(e){return t+((e=(i+(e-t)%i)%i||0)>r?i-e:e)})},distribute:an,random:on,snap:rn,normalize:function(e,t,a){return cn(e,t,0,1,a)},getUnit:$a,clamp:function(e,t,a){return ja(a,function(a){return Xa(e,t,a)})},splitColor:yn,toArray:Qa,selector:en,mapRange:cn,pipe:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.reduce(function(e,t){return t(e)},e)}},unitize:function(e,t){return function(a){return e(parseFloat(a))+(t||$a(a))}},interpolate:function e(t,a,n,r){var i=isNaN(t+a)?0:function(e){return(1-e)*t+e*a};if(!i){var o,s,l,c,u,d=Mt(t),h={};if(!0===n&&(r=1)&&(n=null),d)t={p:t},a={p:a};else if(Pt(t)&&!Pt(a)){for(l=[],c=t.length,u=c-2,s=1;s<c;s++)l.push(e(t[s-1],t[s]));c--,i=function(e){e*=c;var t=Math.min(u,~~e);return l[t](e-t)},n=a}else r||(t=wa(Pt(t)?[]:{},t));if(!l){for(o in a)Gn.call(h,t,o,"get",a[o]);i=function(e){return ir(e,h)||(d?t.p:t)}}}return ja(n,i)},shuffle:tn},install:qt,effects:na,ticker:Mn,updateRoot:Un.updateRoot,plugins:aa,globalTimeline:et,core:{PropTween:ur,globals:Xt,Tween:Kn,Timeline:Un,Animation:Bn,getCache:la,_removeLinkedListItem:ka,reverting:function(){return Je},context:function(e){return e&&Qe&&(Qe.data.push(e),e._ctx=Qe),Qe},suppressOverwrites:function(e){return Ze=e}}};ua("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return xr[e]=Kn[e]}),Mn.add(Un.updateRoot),ot=xr.to({},{duration:0});var wr=function(e,t){for(var a=e._pt;a&&a.p!==t&&a.op!==t&&a.fp!==t;)a=a._next;return a},_r=function(e,t){return{name:e,headless:1,rawVars:1,init:function(e,a,n){n._onInit=function(e){var n,r;if(Mt(a)&&(n={},ua(a,function(e){return n[e]=1}),a=n),t){for(r in n={},a)n[r]=t(a[r]);a=n}!function(e,t){var a,n,r,i=e._targets;for(a in t)for(n=i.length;n--;)(r=e._ptLookup[n][a])&&(r=r.d)&&(r._pt&&(r=wr(r,a)),r&&r.modifier&&r.modifier(t[a],e,i[n],a))}(e,a)}}}},Sr=xr.registerPlugin({name:"attr",init:function(e,t,a,n,r){var i,o,s;for(i in this.tween=a,t)s=e.getAttribute(i)||"",(o=this.add(e,"setAttribute",(s||0)+"",t[i],n,r,0,0,i)).op=i,o.b=s,this._props.push(i)},render:function(e,t){for(var a=t._pt;a;)Je?a.set(a.t,a.p,a.b,a):a.r(e,a.d),a=a._next}},{name:"endArray",headless:1,init:function(e,t){for(var a=t.length;a--;)this.add(e,a,e[a]||0,t[a],0,0,0,0,0,1)}},_r("roundProps",nn),_r("modifiers"),_r("snap",rn))||xr;Kn.version=Un.version=Sr.version="3.14.2",rt=1,It()&&Tn();var Mr,Tr,kr,Cr,Ar,Er,Ir,Rr,Dr=kn.Power0,Pr=kn.Power1,Lr=kn.Power2,Nr=kn.Power3,Or=kn.Power4,Fr=kn.Linear,Br=kn.Quad,Ur=kn.Cubic,zr=kn.Quart,Vr=kn.Quint,Hr=kn.Strong,Gr=kn.Elastic,Wr=kn.Back,qr=kn.SteppedEase,Yr=kn.Bounce,jr=kn.Sine,Xr=kn.Expo,$r=kn.Circ,Kr={},Zr=180/Math.PI,Jr=Math.PI/180,Qr=Math.atan2,ei=/([A-Z])/g,ti=/(left|right|width|margin|padding|x)/i,ai=/[\s,\(]\S/,ni={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ri=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},ii=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},oi=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},si=function(e,t){return t.set(t.t,t.p,1===e?t.e:e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},li=function(e,t){var a=t.s+t.c*e;t.set(t.t,t.p,~~(a+(a<0?-.5:.5))+t.u,t)},ci=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},ui=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},di=function(e,t,a){return e.style[t]=a},hi=function(e,t,a){return e.style.setProperty(t,a)},pi=function(e,t,a){return e._gsap[t]=a},fi=function(e,t,a){return e._gsap.scaleX=e._gsap.scaleY=a},mi=function(e,t,a,n,r){var i=e._gsap;i.scaleX=i.scaleY=a,i.renderTransform(r,i)},vi=function(e,t,a,n,r){var i=e._gsap;i[t]=a,i.renderTransform(r,i)},gi="transform",yi=gi+"Origin",bi=function e(t,a){var n=this,r=this.target,i=r.style,o=r._gsap;if(t in Kr&&i){if(this.tfm=this.tfm||{},"transform"===t)return ni.transform.split(",").forEach(function(t){return e.call(n,t,a)});if(~(t=ni[t]||t).indexOf(",")?t.split(",").forEach(function(e){return n.tfm[e]=Fi(r,e)}):this.tfm[t]=o.x?o[t]:Fi(r,t),t===yi&&(this.tfm.zOrigin=o.zOrigin),this.props.indexOf(gi)>=0)return;o.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(yi,a,"")),t=gi}(i||a)&&this.props.push(t,a,i[t])},xi=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},wi=function(){var e,t,a=this.props,n=this.target,r=n.style,i=n._gsap;for(e=0;e<a.length;e+=3)a[e+1]?2===a[e+1]?n[a[e]](a[e+2]):n[a[e]]=a[e+2]:a[e+2]?r[a[e]]=a[e+2]:r.removeProperty("--"===a[e].substr(0,2)?a[e]:a[e].replace(ei,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)i[t]=this.tfm[t];i.svg&&(i.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(e=Ir())&&e.isStart||r[gi]||(xi(r),i.zOrigin&&r[yi]&&(r[yi]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},_i=function(e,t){var a={target:e,props:[],revert:wi,save:bi};return e._gsap||Sr.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(e){return a.save(e)}),a},Si=function(e,t){var a=Tr.createElementNS?Tr.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Tr.createElement(e);return a&&a.style?a:Tr.createElement(e)},Mi=function e(t,a,n){var r=getComputedStyle(t);return r[a]||r.getPropertyValue(a.replace(ei,"-$1").toLowerCase())||r.getPropertyValue(a)||!n&&e(t,ki(a)||a,1)||""},Ti="O,Moz,ms,Ms,Webkit".split(","),ki=function(e,t,a){var n=(t||Ar).style,r=5;if(e in n&&!a)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);r--&&!(Ti[r]+e in n););return r<0?null:(3===r?"ms":r>=0?Ti[r]:"")+e},Ci=function(){"undefined"!=typeof window&&window.document&&(Mr=window,Tr=Mr.document,kr=Tr.documentElement,Ar=Si("div")||{style:{}},Si("div"),gi=ki(gi),yi=gi+"Origin",Ar.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Rr=!!ki("perspective"),Ir=Sr.core.reverting,Cr=1)},Ai=function(e){var t,a=e.ownerSVGElement,n=Si("svg",a&&a.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=e.cloneNode(!0);r.style.display="block",n.appendChild(r),kr.appendChild(n);try{t=r.getBBox()}catch(TQe){}return n.removeChild(r),kr.removeChild(n),t},Ei=function(e,t){for(var a=t.length;a--;)if(e.hasAttribute(t[a]))return e.getAttribute(t[a])},Ii=function(e){var t,a;try{t=e.getBBox()}catch(QXe){t=Ai(e),a=1}return t&&(t.width||t.height)||a||(t=Ai(e)),!t||t.width||t.x||t.y?t:{x:+Ei(e,["x","cx","x1"])||0,y:+Ei(e,["y","cy","y1"])||0,width:0,height:0}},Ri=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!Ii(e))},Di=function(e,t){if(t){var a,n=e.style;t in Kr&&t!==yi&&(t=gi),n.removeProperty?("ms"!==(a=t.substr(0,2))&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty("--"===a?t:t.replace(ei,"-$1").toLowerCase())):n.removeAttribute(t)}},Pi=function(e,t,a,n,r,i){var o=new ur(e._pt,t,a,0,1,i?ui:ci);return e._pt=o,o.b=n,o.e=r,e._props.push(a),o},Li={deg:1,rad:1,turn:1},Ni={grid:1,flex:1},Oi=function e(t,a,n,r){var i,o,s,l,c=parseFloat(n)||0,u=(n+"").trim().substr((c+"").length)||"px",d=Ar.style,h=ti.test(a),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(h?"Width":"Height"),m=100,v="px"===r,g="%"===r;if(r===u||!c||Li[r]||Li[u])return c;if("px"!==u&&!v&&(c=e(t,a,n,"px")),l=t.getCTM&&Ri(t),(g||"%"===u)&&(Kr[a]||~a.indexOf("adius")))return i=l?t.getBBox()[h?"width":"height"]:t[f],da(g?c/i*m:c/100*i);if(d[h?"width":"height"]=m+(v?u:r),o="rem"!==r&&~a.indexOf("adius")||"em"===r&&t.appendChild&&!p?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==Tr&&o.appendChild||(o=Tr.body),(s=o._gsap)&&g&&s.width&&h&&s.time===Mn.time&&!s.uncache)return da(c/s.width*m);if(!g||"height"!==a&&"width"!==a)(g||"%"===u)&&!Ni[Mi(o,"display")]&&(d.position=Mi(t,"position")),o===t&&(d.position="static"),o.appendChild(Ar),i=Ar[f],o.removeChild(Ar),d.position="absolute";else{var y=t.style[a];t.style[a]=m+r,i=t[f],y?t.style[a]=y:Di(t,a)}return h&&g&&((s=la(o)).time=Mn.time,s.width=o[f]),da(v?i*c/m:i&&c?m/i*c:0)},Fi=function(e,t,a,n){var r;return Cr||Ci(),t in ni&&"transform"!==t&&~(t=ni[t]).indexOf(",")&&(t=t.split(",")[0]),Kr[t]&&"transform"!==t?(r=$i(e,n),r="transformOrigin"!==t?r[t]:r.svg?r.origin:Ki(Mi(e,yi))+" "+r.zOrigin+"px"):(!(r=e.style[t])||"auto"===r||n||~(r+"").indexOf("calc("))&&(r=Hi[t]&&Hi[t](e,t,a)||Mi(e,t)||ca(e,t)||("opacity"===t?1:0)),a&&!~(r+"").trim().indexOf(" ")?Oi(e,t,r,a)+a:r},Bi=function(e,t,a,n){if(!a||"none"===a){var r=ki(t,e,1),i=r&&Mi(e,r,1);i&&i!==a?(t=r,a=i):"borderColor"===t&&(a=Mi(e,"borderTopColor"))}var o,s,l,c,u,d,h,p,f,m,v,g=new ur(this._pt,e.style,t,0,1,rr),y=0,b=0;if(g.b=a,g.e=n,a+="","var(--"===(n+="").substring(0,6)&&(n=Mi(e,n.substring(4,n.indexOf(")")))),"auto"===n&&(d=e.style[t],e.style[t]=n,n=Mi(e,t)||n,d?e.style[t]=d:Di(e,t)),Sn(o=[a,n]),n=o[1],l=(a=o[0]).match(Bt)||[],(n.match(Bt)||[]).length){for(;s=Bt.exec(n);)h=s[0],f=n.substring(y,s.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),h!==(d=l[b++]||"")&&(c=parseFloat(d)||0,v=d.substr((c+"").length),"="===h.charAt(1)&&(h=pa(c,h)+v),p=parseFloat(h),m=h.substr((p+"").length),y=Bt.lastIndex-m.length,m||(m=m||ft.units[t]||v,y===n.length&&(n+=m,g.e+=m)),v!==m&&(c=Oi(e,t,d,m)||0),g._pt={_next:g._pt,p:f||1===b?f:",",s:c,c:p-c,m:u&&u<4||"zIndex"===t?Math.round:0});g.c=y<n.length?n.substring(y,n.length):""}else g.r="display"===t&&"none"===n?ui:ci;return zt.test(n)&&(g.e=0),this._pt=g,g},Ui={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},zi=function(e){var t=e.split(" "),a=t[0],n=t[1]||"50%";return"top"!==a&&"bottom"!==a&&"left"!==n&&"right"!==n||(e=a,a=n,n=e),t[0]=Ui[a]||a,t[1]=Ui[n]||n,t.join(" ")},Vi=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var a,n,r,i=t.t,o=i.style,s=t.u,l=i._gsap;if("all"===s||!0===s)o.cssText="",n=1;else for(r=(s=s.split(",")).length;--r>-1;)a=s[r],Kr[a]&&(n=1,a="transformOrigin"===a?yi:gi),Di(i,a);n&&(Di(i,gi),l&&(l.svg&&i.removeAttribute("transform"),o.scale=o.rotate=o.translate="none",$i(i,1),l.uncache=1,xi(o)))}},Hi={clearProps:function(e,t,a,n,r){if("isFromStart"!==r.data){var i=e._pt=new ur(e._pt,t,a,0,0,Vi);return i.u=n,i.pr=-10,i.tween=r,e._props.push(a),1}}},Gi=[1,0,0,1,0,0],Wi={},qi=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Yi=function(e){var t=Mi(e,gi);return qi(t)?Gi:t.substr(7).match(Ft).map(da)},ji=function(e,t){var a,n,r,i,o=e._gsap||la(e),s=e.style,l=Yi(e);return o.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=e.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Gi:l:(l!==Gi||e.offsetParent||e===kr||o.svg||(r=s.display,s.display="block",(a=e.parentNode)&&(e.offsetParent||e.getBoundingClientRect().width)||(i=1,n=e.nextElementSibling,kr.appendChild(e)),l=Yi(e),r?s.display=r:Di(e,"display"),i&&(n?a.insertBefore(e,n):a?a.appendChild(e):kr.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Xi=function(e,t,a,n,r,i){var o,s,l,c=e._gsap,u=r||ji(e,!0),d=c.xOrigin||0,h=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=u[0],v=u[1],g=u[2],y=u[3],b=u[4],x=u[5],w=t.split(" "),_=parseFloat(w[0])||0,S=parseFloat(w[1])||0;a?u!==Gi&&(s=m*y-v*g)&&(l=_*(-v/s)+S*(m/s)-(m*x-v*b)/s,_=_*(y/s)+S*(-g/s)+(g*x-y*b)/s,S=l):(_=(o=Ii(e)).x+(~w[0].indexOf("%")?_/100*o.width:_),S=o.y+(~(w[1]||w[0]).indexOf("%")?S/100*o.height:S)),n||!1!==n&&c.smooth?(b=_-d,x=S-h,c.xOffset=p+(b*m+x*g)-b,c.yOffset=f+(b*v+x*y)-x):c.xOffset=c.yOffset=0,c.xOrigin=_,c.yOrigin=S,c.smooth=!!n,c.origin=t,c.originIsAbsolute=!!a,e.style[yi]="0px 0px",i&&(Pi(i,c,"xOrigin",d,_),Pi(i,c,"yOrigin",h,S),Pi(i,c,"xOffset",p,c.xOffset),Pi(i,c,"yOffset",f,c.yOffset)),e.setAttribute("data-svg-origin",_+" "+S)},$i=function(e,t){var a=e._gsap||new Fn(e);if("x"in a&&!t&&!a.uncache)return a;var n,r,i,o,s,l,c,u,d,h,p,f,m,v,g,y,b,x,w,_,S,M,T,k,C,A,E,I,R,D,P,L,N=e.style,O=a.scaleX<0,F="px",B="deg",U=getComputedStyle(e),z=Mi(e,yi)||"0";return n=r=i=l=c=u=d=h=p=0,o=s=1,a.svg=!(!e.getCTM||!Ri(e)),U.translate&&("none"===U.translate&&"none"===U.scale&&"none"===U.rotate||(N[gi]=("none"!==U.translate?"translate3d("+(U.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==U.rotate?"rotate("+U.rotate+") ":"")+("none"!==U.scale?"scale("+U.scale.split(" ").join(",")+") ":"")+("none"!==U[gi]?U[gi]:"")),N.scale=N.rotate=N.translate="none"),v=ji(e,a.svg),a.svg&&(a.uncache?(C=e.getBBox(),z=a.xOrigin-C.x+"px "+(a.yOrigin-C.y)+"px",k=""):k=!t&&e.getAttribute("data-svg-origin"),Xi(e,k||z,!!k||a.originIsAbsolute,!1!==a.smooth,v)),f=a.xOrigin||0,m=a.yOrigin||0,v!==Gi&&(x=v[0],w=v[1],_=v[2],S=v[3],n=M=v[4],r=T=v[5],6===v.length?(o=Math.sqrt(x*x+w*w),s=Math.sqrt(S*S+_*_),l=x||w?Qr(w,x)*Zr:0,(d=_||S?Qr(_,S)*Zr+l:0)&&(s*=Math.abs(Math.cos(d*Jr))),a.svg&&(n-=f-(f*x+m*_),r-=m-(f*w+m*S))):(L=v[6],D=v[7],E=v[8],I=v[9],R=v[10],P=v[11],n=v[12],r=v[13],i=v[14],c=(g=Qr(L,R))*Zr,g&&(k=M*(y=Math.cos(-g))+E*(b=Math.sin(-g)),C=T*y+I*b,A=L*y+R*b,E=M*-b+E*y,I=T*-b+I*y,R=L*-b+R*y,P=D*-b+P*y,M=k,T=C,L=A),u=(g=Qr(-_,R))*Zr,g&&(y=Math.cos(-g),P=S*(b=Math.sin(-g))+P*y,x=k=x*y-E*b,w=C=w*y-I*b,_=A=_*y-R*b),l=(g=Qr(w,x))*Zr,g&&(k=x*(y=Math.cos(g))+w*(b=Math.sin(g)),C=M*y+T*b,w=w*y-x*b,T=T*y-M*b,x=k,M=C),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),o=da(Math.sqrt(x*x+w*w+_*_)),s=da(Math.sqrt(T*T+L*L)),g=Qr(M,T),d=Math.abs(g)>2e-4?g*Zr:0,p=P?1/(P<0?-P:P):0),a.svg&&(k=e.getAttribute("transform"),a.forceCSS=e.setAttribute("transform","")||!qi(Mi(e,gi)),k&&e.setAttribute("transform",k))),Math.abs(d)>90&&Math.abs(d)<270&&(O?(o*=-1,d+=l<=0?180:-180,l+=l<=0?180:-180):(s*=-1,d+=d<=0?180:-180)),t=t||a.uncache,a.x=n-((a.xPercent=n&&(!t&&a.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-n)?-50:0)))?e.offsetWidth*a.xPercent/100:0)+F,a.y=r-((a.yPercent=r&&(!t&&a.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-r)?-50:0)))?e.offsetHeight*a.yPercent/100:0)+F,a.z=i+F,a.scaleX=da(o),a.scaleY=da(s),a.rotation=da(l)+B,a.rotationX=da(c)+B,a.rotationY=da(u)+B,a.skewX=d+B,a.skewY=h+B,a.transformPerspective=p+F,(a.zOrigin=parseFloat(z.split(" ")[2])||!t&&a.zOrigin||0)&&(N[yi]=Ki(z)),a.xOffset=a.yOffset=0,a.force3D=ft.force3D,a.renderTransform=a.svg?no:Rr?ao:Ji,a.uncache=0,a},Ki=function(e){return(e=e.split(" "))[0]+" "+e[1]},Zi=function(e,t,a){var n=$a(t);return da(parseFloat(t)+parseFloat(Oi(e,"x",a+"px",n)))+n},Ji=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,ao(e,t)},Qi="0deg",eo="0px",to=") ",ao=function(e,t){var a=t||this,n=a.xPercent,r=a.yPercent,i=a.x,o=a.y,s=a.z,l=a.rotation,c=a.rotationY,u=a.rotationX,d=a.skewX,h=a.skewY,p=a.scaleX,f=a.scaleY,m=a.transformPerspective,v=a.force3D,g=a.target,y=a.zOrigin,b="",x="auto"===v&&e&&1!==e||!0===v;if(y&&(u!==Qi||c!==Qi)){var w,_=parseFloat(c)*Jr,S=Math.sin(_),M=Math.cos(_);_=parseFloat(u)*Jr,w=Math.cos(_),i=Zi(g,i,S*w*-y),o=Zi(g,o,-Math.sin(_)*-y),s=Zi(g,s,M*w*-y+y)}m!==eo&&(b+="perspective("+m+to),(n||r)&&(b+="translate("+n+"%, "+r+"%) "),(x||i!==eo||o!==eo||s!==eo)&&(b+=s!==eo||x?"translate3d("+i+", "+o+", "+s+") ":"translate("+i+", "+o+to),l!==Qi&&(b+="rotate("+l+to),c!==Qi&&(b+="rotateY("+c+to),u!==Qi&&(b+="rotateX("+u+to),d===Qi&&h===Qi||(b+="skew("+d+", "+h+to),1===p&&1===f||(b+="scale("+p+", "+f+to),g.style[gi]=b||"translate(0, 0)"},no=function(e,t){var a,n,r,i,o,s=t||this,l=s.xPercent,c=s.yPercent,u=s.x,d=s.y,h=s.rotation,p=s.skewX,f=s.skewY,m=s.scaleX,v=s.scaleY,g=s.target,y=s.xOrigin,b=s.yOrigin,x=s.xOffset,w=s.yOffset,_=s.forceCSS,S=parseFloat(u),M=parseFloat(d);h=parseFloat(h),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),h+=f),h||p?(h*=Jr,p*=Jr,a=Math.cos(h)*m,n=Math.sin(h)*m,r=Math.sin(h-p)*-v,i=Math.cos(h-p)*v,p&&(f*=Jr,o=Math.tan(p-f),r*=o=Math.sqrt(1+o*o),i*=o,f&&(o=Math.tan(f),a*=o=Math.sqrt(1+o*o),n*=o)),a=da(a),n=da(n),r=da(r),i=da(i)):(a=m,i=v,n=r=0),(S&&!~(u+"").indexOf("px")||M&&!~(d+"").indexOf("px"))&&(S=Oi(g,"x",u,"px"),M=Oi(g,"y",d,"px")),(y||b||x||w)&&(S=da(S+y-(y*a+b*r)+x),M=da(M+b-(y*n+b*i)+w)),(l||c)&&(o=g.getBBox(),S=da(S+l/100*o.width),M=da(M+c/100*o.height)),o="matrix("+a+","+n+","+r+","+i+","+S+","+M+")",g.setAttribute("transform",o),_&&(g.style[gi]=o)},ro=function(e,t,a,n,r){var i,o,s=360,l=Mt(r),c=parseFloat(r)*(l&&~r.indexOf("rad")?Zr:1)-n,u=n+c+"deg";return l&&("short"===(i=r.split("_")[1])&&(c%=s)!==c%180&&(c+=c<0?s:-360),"cw"===i&&c<0?c=(c+36e9)%s-~~(c/s)*s:"ccw"===i&&c>0&&(c=(c-36e9)%s-~~(c/s)*s)),e._pt=o=new ur(e._pt,t,a,n,c,ii),o.e=u,o.u="deg",e._props.push(a),o},io=function(e,t){for(var a in t)e[a]=t[a];return e},oo=function(e,t,a){var n,r,i,o,s,l,c,u=io({},a._gsap),d=a.style;for(r in u.svg?(i=a.getAttribute("transform"),a.setAttribute("transform",""),d[gi]=t,n=$i(a,1),Di(a,gi),a.setAttribute("transform",i)):(i=getComputedStyle(a)[gi],d[gi]=t,n=$i(a,1),d[gi]=i),Kr)(i=u[r])!==(o=n[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(s=$a(i)!==(c=$a(o))?Oi(a,r,i,c):parseFloat(i),l=parseFloat(o),e._pt=new ur(e._pt,n,r,s,l-s,ri),e._pt.u=c||0,e._props.push(r));io(n,u)};
/*!
 * CSSPlugin 3.14.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/ua("padding,margin,Width,Radius",function(e,t){var a="Top",n="Right",r="Bottom",i="Left",o=(t<3?[a,n,r,i]:[a+i,a+n,r+n,r+i]).map(function(a){return t<2?e+a:"border"+a+e});Hi[t>1?"border"+e:e]=function(e,t,a,n,r){var i,s;if(arguments.length<4)return i=o.map(function(t){return Fi(e,t,a)}),5===(s=i.join(" ")).split(i[0]).length?i[0]:s;i=(n+"").split(" "),s={},o.forEach(function(e,t){return s[e]=i[t]=i[t]||i[(t-1)/2|0]}),e.init(t,s,r)}});var so,lo,co,uo={name:"css",register:Ci,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,a,n,r){var i,o,s,l,c,u,d,h,p,f,m,v,g,y,b,x,w,_=this._props,S=e.style,M=a.vars.startAt;for(d in Cr||Ci(),this.styles=this.styles||_i(e),x=this.styles.props,this.tween=a,t)if("autoRound"!==d&&(o=t[d],!aa[d]||!Wn(d,t,a,n,e,r)))if(c=typeof o,u=Hi[d],"function"===c&&(c=typeof(o=o.call(a,n,e,r))),"string"===c&&~o.indexOf("random(")&&(o=ln(o)),u)u(this,e,d,o,a)&&(b=1);else if("--"===d.substr(0,2))i=(getComputedStyle(e).getPropertyValue(d)+"").trim(),o+="",wn.lastIndex=0,wn.test(i)||(h=$a(i),(p=$a(o))?h!==p&&(i=Oi(e,d,i,p)+p):h&&(o+=h)),this.add(S,"setProperty",i,o,n,r,0,0,d),_.push(d),x.push(d,0,S[d]);else if("undefined"!==c){if(M&&d in M?(i="function"==typeof M[d]?M[d].call(a,n,e,r):M[d],Mt(i)&&~i.indexOf("random(")&&(i=ln(i)),$a(i+"")||"auto"===i||(i+=ft.units[d]||$a(Fi(e,d))||""),"="===(i+"").charAt(1)&&(i=Fi(e,d))):i=Fi(e,d),l=parseFloat(i),(f="string"===c&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),s=parseFloat(o),d in ni&&("autoAlpha"===d&&(1===l&&"hidden"===Fi(e,"visibility")&&s&&(l=0),x.push("visibility",0,S.visibility),Pi(this,S,"visibility",l?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==d&&"transform"!==d&&~(d=ni[d]).indexOf(",")&&(d=d.split(",")[0])),m=d in Kr){if(this.styles.save(d),w=o,"string"===c&&"var(--"===o.substring(0,6)){if("calc("===(o=Mi(e,o.substring(4,o.indexOf(")")))).substring(0,5)){var T=e.style.perspective;e.style.perspective=o,o=Mi(e,"perspective"),T?e.style.perspective=T:Di(e,"perspective")}s=parseFloat(o)}if(v||((g=e._gsap).renderTransform&&!t.parseTransform||$i(e,t.parseTransform),y=!1!==t.smoothOrigin&&g.smooth,(v=this._pt=new ur(this._pt,S,gi,0,1,g.renderTransform,g,0,-1)).dep=1),"scale"===d)this._pt=new ur(this._pt,g,"scaleY",g.scaleY,(f?pa(g.scaleY,f+s):s)-g.scaleY||0,ri),this._pt.u=0,_.push("scaleY",d),d+="X";else{if("transformOrigin"===d){x.push(yi,0,S[yi]),o=zi(o),g.svg?Xi(e,o,0,y,0,this):((p=parseFloat(o.split(" ")[2])||0)!==g.zOrigin&&Pi(this,g,"zOrigin",g.zOrigin,p),Pi(this,S,d,Ki(i),Ki(o)));continue}if("svgOrigin"===d){Xi(e,o,1,y,0,this);continue}if(d in Wi){ro(this,g,d,l,f?pa(l,f+o):o);continue}if("smoothOrigin"===d){Pi(this,g,"smooth",g.smooth,o);continue}if("force3D"===d){g[d]=o;continue}if("transform"===d){oo(this,o,e);continue}}}else d in S||(d=ki(d)||d);if(m||(s||0===s)&&(l||0===l)&&!ai.test(o)&&d in S)s||(s=0),(h=(i+"").substr((l+"").length))!==(p=$a(o)||(d in ft.units?ft.units[d]:h))&&(l=Oi(e,d,i,p)),this._pt=new ur(this._pt,m?g:S,d,l,(f?pa(l,f+s):s)-l,m||"px"!==p&&"zIndex"!==d||!1===t.autoRound?ri:li),this._pt.u=p||0,m&&w!==o?(this._pt.b=i,this._pt.e=w,this._pt.r=si):h!==p&&"%"!==p&&(this._pt.b=i,this._pt.r=oi);else if(d in S)Bi.call(this,e,d,i,f?f+o:o);else if(d in e)this.add(e,d,i||e[d],f?f+o:o,n,r);else if("parseTransform"!==d){Yt(d,o);continue}m||(d in S?x.push(d,0,S[d]):"function"==typeof e[d]?x.push(d,2,e[d]()):x.push(d,1,i||e[d])),_.push(d)}b&&cr(this)},render:function(e,t){if(t.tween._time||!Ir())for(var a=t._pt;a;)a.r(e,a.d),a=a._next;else t.styles.revert()},get:Fi,aliases:ni,getSetter:function(e,t,a){var n=ni[t];return n&&n.indexOf(",")<0&&(t=n),t in Kr&&t!==yi&&(e._gsap.x||Fi(e,"x"))?a&&Er===a?"scale"===t?fi:pi:(Er=a||{})&&("scale"===t?mi:vi):e.style&&!Ct(e.style[t])?di:~t.indexOf("-")?hi:tr(e,t)},core:{_removeProperty:Di,_getMatrix:ji}};Sr.utils.checkPrefix=ki,Sr.core.getStyleSaver=_i,co=ua((so="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(lo="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(e){Kr[e]=1}),ua(lo,function(e){ft.units[e]="deg",Wi[e]=1}),ni[co[13]]=so+","+lo,ua("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(e){var t=e.split(":");ni[t[1]]=co[t[0]]}),ua("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){ft.units[e]="px"}),Sr.registerPlugin(uo);var ho=Sr.registerPlugin(uo)||Sr,po=ho.core.Tween;const fo=Object.freeze(Object.defineProperty({__proto__:null,Back:Wr,Bounce:Yr,CSSPlugin:uo,Circ:$r,Cubic:Ur,Elastic:Gr,Expo:Xr,Linear:Fr,Power0:Dr,Power1:Pr,Power2:Lr,Power3:Nr,Power4:Or,Quad:Br,Quart:zr,Quint:Vr,Sine:jr,SteppedEase:qr,Strong:Hr,TimelineLite:Un,TimelineMax:Un,TweenLite:Kn,TweenMax:po,default:ho,gsap:ho},Symbol.toStringTag,{value:"Module"}));var mo={exports:{}};!function(e){function t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,a,n){return a&&t(e.prototype,a),e}
/*!
	   * Observer 3.14.2
	   * https://gsap.com
	   *
	   * @license Copyright 2008-2025, GreenSock. All rights reserved.
	   * Subject to the terms at https://gsap.com/standard-license
	   * @author: Jack Doyle, jack@greensock.com
	  */var n,r,i,o,s,l,c,u,d,h,p,f,m,v=function(){return n||"undefined"!=typeof window&&(n=window.gsap)&&n.registerPlugin&&n},g=1,y=[],b=[],x=[],w=Date.now,_=function(e,t){return t},S=function(){var e=d.core,t=e.bridge||{},a=e._scrollers,n=e._proxies;a.push.apply(a,b),n.push.apply(n,x),b=a,x=n,_=function(e,a){return t[e](a)}},M=function(e,t){return~x.indexOf(e)&&x[x.indexOf(e)+1][t]},T=function(e){return!!~h.indexOf(e)},k=function(e,t,a,n,r){return e.addEventListener(t,a,{passive:!1!==n,capture:!!r})},C=function(e,t,a,n){return e.removeEventListener(t,a,!!n)},A="scrollLeft",E="scrollTop",I=function(){return p&&p.isPressed||b.cache++},R=function(e,t){var a=function a(n){if(n||0===n){g&&(i.history.scrollRestoration="manual");var r=p&&p.isPressed;n=a.v=Math.round(n)||(p&&p.iOS?1:0),e(n),a.cacheID=b.cache,r&&_("ss",n)}else(t||b.cache!==a.cacheID||_("ref"))&&(a.cacheID=b.cache,a.v=e());return a.v+a.offset};return a.offset=0,e&&a},D={s:A,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:R(function(e){return arguments.length?i.scrollTo(e,P.sc()):i.pageXOffset||o[A]||s[A]||l[A]||0})},P={s:E,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:D,sc:R(function(e){return arguments.length?i.scrollTo(D.sc(),e):i.pageYOffset||o[E]||s[E]||l[E]||0})},L=function(e,t){return(t&&t._ctx&&t._ctx.selector||n.utils.toArray)(e)[0]||("string"==typeof e&&!1!==n.config().nullTargetWarn?console.warn("Element not found:",e):null)},N=function(e,t){for(var a=t.length;a--;)if(t[a]===e||t[a].contains(e))return!0;return!1},O=function(e,t){var a=t.s,r=t.sc;T(e)&&(e=o.scrollingElement||s);var i=b.indexOf(e),l=r===P.sc?1:2;!~i&&(i=b.push(e)-1),b[i+l]||k(e,"scroll",I);var c=b[i+l],u=c||(b[i+l]=R(M(e,a),!0)||(T(e)?r:R(function(t){return arguments.length?e[a]=t:e[a]})));return u.target=e,c||(u.smooth="smooth"===n.getProperty(e,"scrollBehavior")),u},F=function(e,t,a){var n=e,r=e,i=w(),o=i,s=t||50,l=Math.max(500,3*s),c=function(e,t){var l=w();t||l-i>s?(r=n,n=e,o=i,i=l):a?n+=e:n=r+(e-r)/(l-o)*(i-o)},u=function(e){var t=o,s=r,u=w();return(e||0===e)&&e!==n&&c(e),i===o||u-o>l?0:(n+(a?s:-s))/((a?u:i)-t)*1e3};return{update:c,reset:function(){r=n=a?0:n,o=i=0},getVelocity:u}},B=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},U=function(e){var t=Math.max.apply(Math,e),a=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(a)?t:a},z=function(){(d=n.core.globals().ScrollTrigger)&&d.core&&S()},V=function(e){return n=e||v(),!r&&n&&"undefined"!=typeof document&&document.body&&(i=window,o=document,s=o.documentElement,l=o.body,h=[i,o,s,l],n.utils.clamp,m=n.core.context||function(){},u="onpointerenter"in l?"pointer":"mouse",c=H.isTouch=i.matchMedia&&i.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in i||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,f=H.eventTypes=("ontouchstart"in s?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in s?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return g=0},500),z(),r=1),r};D.op=P,b.cache=0;var H=function(){function e(e){this.init(e)}return e.prototype.init=function(e){r||V(n)||console.warn("Please gsap.registerPlugin(Observer)"),d||z();var t=e.tolerance,a=e.dragMinimum,h=e.type,v=e.target,g=e.lineHeight,b=e.debounce,x=e.preventDefault,_=e.onStop,S=e.onStopDelay,M=e.ignore,A=e.wheelSpeed,E=e.event,R=e.onDragStart,H=e.onDragEnd,G=e.onDrag,W=e.onPress,q=e.onRelease,Y=e.onRight,j=e.onLeft,X=e.onUp,$=e.onDown,K=e.onChangeX,Z=e.onChangeY,J=e.onChange,Q=e.onToggleX,ee=e.onToggleY,te=e.onHover,ae=e.onHoverEnd,ne=e.onMove,re=e.ignoreCheck,ie=e.isNormalizer,oe=e.onGestureStart,se=e.onGestureEnd,le=e.onWheel,ce=e.onEnable,ue=e.onDisable,de=e.onClick,he=e.scrollSpeed,pe=e.capture,fe=e.allowClicks,me=e.lockAxis,ve=e.onLockAxis;this.target=v=L(v)||s,this.vars=e,M&&(M=n.utils.toArray(M)),t=t||1e-9,a=a||0,A=A||1,he=he||1,h=h||"wheel,touch,pointer",b=!1!==b,g||(g=parseFloat(i.getComputedStyle(l).lineHeight)||22);var ge,ye,be,xe,we,_e,Se,Me=this,Te=0,ke=0,Ce=e.passive||!x&&!1!==e.passive,Ae=O(v,D),Ee=O(v,P),Ie=Ae(),Re=Ee(),De=~h.indexOf("touch")&&!~h.indexOf("pointer")&&"pointerdown"===f[0],Pe=T(v),Le=v.ownerDocument||o,Ne=[0,0,0],Oe=[0,0,0],Fe=0,Be=function(){return Fe=w()},Ue=function(e,t){return(Me.event=e)&&M&&N(e.target,M)||t&&De&&"touch"!==e.pointerType||re&&re(e,t)},ze=function(){Me._vx.reset(),Me._vy.reset(),ye.pause(),_&&_(Me)},Ve=function(){var e=Me.deltaX=U(Ne),a=Me.deltaY=U(Oe),n=Math.abs(e)>=t,r=Math.abs(a)>=t;J&&(n||r)&&J(Me,e,a,Ne,Oe),n&&(Y&&Me.deltaX>0&&Y(Me),j&&Me.deltaX<0&&j(Me),K&&K(Me),Q&&Me.deltaX<0!=Te<0&&Q(Me),Te=Me.deltaX,Ne[0]=Ne[1]=Ne[2]=0),r&&($&&Me.deltaY>0&&$(Me),X&&Me.deltaY<0&&X(Me),Z&&Z(Me),ee&&Me.deltaY<0!=ke<0&&ee(Me),ke=Me.deltaY,Oe[0]=Oe[1]=Oe[2]=0),(xe||be)&&(ne&&ne(Me),be&&(R&&1===be&&R(Me),G&&G(Me),be=0),xe=!1),_e&&!(_e=!1)&&ve&&ve(Me),we&&(le(Me),we=!1),ge=0},He=function(e,t,a){Ne[a]+=e,Oe[a]+=t,Me._vx.update(e),Me._vy.update(t),b?ge||(ge=requestAnimationFrame(Ve)):Ve()},Ge=function(e,t){me&&!Se&&(Me.axis=Se=Math.abs(e)>Math.abs(t)?"x":"y",_e=!0),"y"!==Se&&(Ne[2]+=e,Me._vx.update(e,!0)),"x"!==Se&&(Oe[2]+=t,Me._vy.update(t,!0)),b?ge||(ge=requestAnimationFrame(Ve)):Ve()},We=function(e){if(!Ue(e,1)){var t=(e=B(e,x)).clientX,n=e.clientY,r=t-Me.x,i=n-Me.y,o=Me.isDragging;Me.x=t,Me.y=n,(o||(r||i)&&(Math.abs(Me.startX-t)>=a||Math.abs(Me.startY-n)>=a))&&(be||(be=o?2:1),o||(Me.isDragging=!0),Ge(r,i))}},qe=Me.onPress=function(e){Ue(e,1)||e&&e.button||(Me.axis=Se=null,ye.pause(),Me.isPressed=!0,e=B(e),Te=ke=0,Me.startX=Me.x=e.clientX,Me.startY=Me.y=e.clientY,Me._vx.reset(),Me._vy.reset(),k(ie?v:Le,f[1],We,Ce,!0),Me.deltaX=Me.deltaY=0,W&&W(Me))},Ye=Me.onRelease=function(e){if(!Ue(e,1)){C(ie?v:Le,f[1],We,!0);var t=!isNaN(Me.y-Me.startY),a=Me.isDragging,r=a&&(Math.abs(Me.x-Me.startX)>3||Math.abs(Me.y-Me.startY)>3),o=B(e);!r&&t&&(Me._vx.reset(),Me._vy.reset(),x&&fe&&n.delayedCall(.08,function(){if(w()-Fe>300&&!e.defaultPrevented)if(e.target.click)e.target.click();else if(Le.createEvent){var t=Le.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,i,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(t)}})),Me.isDragging=Me.isGesturing=Me.isPressed=!1,_&&a&&!ie&&ye.restart(!0),be&&Ve(),H&&a&&H(Me),q&&q(Me,r)}},je=function(e){return e.touches&&e.touches.length>1&&(Me.isGesturing=!0)&&oe(e,Me.isDragging)},Xe=function(){return(Me.isGesturing=!1)||se(Me)},$e=function(e){if(!Ue(e)){var t=Ae(),a=Ee();He((t-Ie)*he,(a-Re)*he,1),Ie=t,Re=a,_&&ye.restart(!0)}},Ke=function(e){if(!Ue(e)){e=B(e,x),le&&(we=!0);var t=(1===e.deltaMode?g:2===e.deltaMode?i.innerHeight:1)*A;He(e.deltaX*t,e.deltaY*t,0),_&&!ie&&ye.restart(!0)}},Ze=function(e){if(!Ue(e)){var t=e.clientX,a=e.clientY,n=t-Me.x,r=a-Me.y;Me.x=t,Me.y=a,xe=!0,_&&ye.restart(!0),(n||r)&&Ge(n,r)}},Je=function(e){Me.event=e,te(Me)},Qe=function(e){Me.event=e,ae(Me)},et=function(e){return Ue(e)||B(e,x)&&de(Me)};ye=Me._dc=n.delayedCall(S||.25,ze).pause(),Me.deltaX=Me.deltaY=0,Me._vx=F(0,50,!0),Me._vy=F(0,50,!0),Me.scrollX=Ae,Me.scrollY=Ee,Me.isDragging=Me.isGesturing=Me.isPressed=!1,m(this),Me.enable=function(e){return Me.isEnabled||(k(Pe?Le:v,"scroll",I),h.indexOf("scroll")>=0&&k(Pe?Le:v,"scroll",$e,Ce,pe),h.indexOf("wheel")>=0&&k(v,"wheel",Ke,Ce,pe),(h.indexOf("touch")>=0&&c||h.indexOf("pointer")>=0)&&(k(v,f[0],qe,Ce,pe),k(Le,f[2],Ye),k(Le,f[3],Ye),fe&&k(v,"click",Be,!0,!0),de&&k(v,"click",et),oe&&k(Le,"gesturestart",je),se&&k(Le,"gestureend",Xe),te&&k(v,u+"enter",Je),ae&&k(v,u+"leave",Qe),ne&&k(v,u+"move",Ze)),Me.isEnabled=!0,Me.isDragging=Me.isGesturing=Me.isPressed=xe=be=!1,Me._vx.reset(),Me._vy.reset(),Ie=Ae(),Re=Ee(),e&&e.type&&qe(e),ce&&ce(Me)),Me},Me.disable=function(){Me.isEnabled&&(y.filter(function(e){return e!==Me&&T(e.target)}).length||C(Pe?Le:v,"scroll",I),Me.isPressed&&(Me._vx.reset(),Me._vy.reset(),C(ie?v:Le,f[1],We,!0)),C(Pe?Le:v,"scroll",$e,pe),C(v,"wheel",Ke,pe),C(v,f[0],qe,pe),C(Le,f[2],Ye),C(Le,f[3],Ye),C(v,"click",Be,!0),C(v,"click",et),C(Le,"gesturestart",je),C(Le,"gestureend",Xe),C(v,u+"enter",Je),C(v,u+"leave",Qe),C(v,u+"move",Ze),Me.isEnabled=Me.isPressed=Me.isDragging=!1,ue&&ue(Me))},Me.kill=Me.revert=function(){Me.disable();var e=y.indexOf(Me);e>=0&&y.splice(e,1),p===Me&&(p=0)},y.push(Me),ie&&T(v)&&(p=Me),Me.enable(E)},a(e,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),e}();H.version="3.14.2",H.create=function(e){return new H(e)},H.register=V,H.getAll=function(){return y.slice()},H.getById=function(e){return y.filter(function(t){return t.vars.id===e})[0]},v()&&n.registerPlugin(H);
/*!
	   * ScrollTrigger 3.14.2
	   * https://gsap.com
	   *
	   * @license Copyright 2008-2025, GreenSock. All rights reserved.
	   * Subject to the terms at https://gsap.com/standard-license
	   * @author: Jack Doyle, jack@greensock.com
	  */
var G,W,q,Y,j,X,$,K,Z,J,Q,ee,te,ae,ne,re,ie,oe,se,le,ce,ue,de,he,pe,fe,me,ve,ge,ye,be,xe,we,_e,Se,Me,Te,ke,Ce=1,Ae=Date.now,Ee=Ae(),Ie=0,Re=0,De=function(e,t,a){var n=Xe(e)&&("clamp("===e.substr(0,6)||e.indexOf("max")>-1);return a["_"+t+"Clamp"]=n,n?e.substr(6,e.length-7):e},Pe=function(e,t){return!t||Xe(e)&&"clamp("===e.substr(0,6)?e:"clamp("+e+")"},Le=function e(){return Re&&requestAnimationFrame(e)},Ne=function(){return ae=1},Oe=function(){return ae=0},Fe=function(e){return e},Be=function(e){return Math.round(1e5*e)/1e5||0},Ue=function(){return"undefined"!=typeof window},ze=function(){return G||Ue()&&(G=window.gsap)&&G.registerPlugin&&G},Ve=function(e){return!!~$.indexOf(e)},He=function(e){return("Height"===e?be:q["inner"+e])||j["client"+e]||X["client"+e]},Ge=function(e){return M(e,"getBoundingClientRect")||(Ve(e)?function(){return ha.width=q.innerWidth,ha.height=be,ha}:function(){return bt(e)})},We=function(e,t,a){var n=a.d,r=a.d2,i=a.a;return(i=M(e,"getBoundingClientRect"))?function(){return i()[n]}:function(){return(t?He(r):e["client"+r])||0}},qe=function(e,t){return!t||~x.indexOf(e)?Ge(e):function(){return ha}},Ye=function(e,t){var a=t.s,n=t.d2,r=t.d,i=t.a;return Math.max(0,(a="scroll"+n)&&(i=M(e,a))?i()-Ge(e)()[r]:Ve(e)?(j[a]||X[a])-He(n):e[a]-e["offset"+n])},je=function(e,t){for(var a=0;a<se.length;a+=3)(!t||~t.indexOf(se[a+1]))&&e(se[a],se[a+1],se[a+2])},Xe=function(e){return"string"==typeof e},$e=function(e){return"function"==typeof e},Ke=function(e){return"number"==typeof e},Ze=function(e){return"object"==typeof e},Je=function(e,t,a){return e&&e.progress(t?0:1)&&a&&e.pause()},Qe=function(e,t){if(e.enabled){var a=e._ctx?e._ctx.add(function(){return t(e)}):t(e);a&&a.totalTime&&(e.callbackAnimation=a)}},et=Math.abs,tt="left",at="top",nt="right",rt="bottom",it="width",ot="height",st="Right",lt="Left",ct="Top",ut="Bottom",dt="padding",ht="margin",pt="Width",ft="Height",mt="px",vt=function(e){return q.getComputedStyle(e)},gt=function(e){var t=vt(e).position;e.style.position="absolute"===t||"fixed"===t?t:"relative"},yt=function(e,t){for(var a in t)a in e||(e[a]=t[a]);return e},bt=function(e,t){var a=t&&"matrix(1, 0, 0, 1, 0, 0)"!==vt(e)[ne]&&G.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),n=e.getBoundingClientRect();return a&&a.progress(0).kill(),n},xt=function(e,t){var a=t.d2;return e["offset"+a]||e["client"+a]||0},wt=function(e){var t,a=[],n=e.labels,r=e.duration();for(t in n)a.push(n[t]/r);return a},_t=function(e){return function(t){return G.utils.snap(wt(e),t)}},St=function(e){var t=G.utils.snap(e),a=Array.isArray(e)&&e.slice(0).sort(function(e,t){return e-t});return a?function(e,n,r){var i;if(void 0===r&&(r=.001),!n)return t(e);if(n>0){for(e-=r,i=0;i<a.length;i++)if(a[i]>=e)return a[i];return a[i-1]}for(i=a.length,e+=r;i--;)if(a[i]<=e)return a[i];return a[0]}:function(a,n,r){void 0===r&&(r=.001);var i=t(a);return!n||Math.abs(i-a)<r||i-a<0==n<0?i:t(n<0?a-e:a+e)}},Mt=function(e){return function(t,a){return St(wt(e))(t,a.direction)}},Tt=function(e,t,a,n){return a.split(",").forEach(function(a){return e(t,a,n)})},kt=function(e,t,a,n,r){return e.addEventListener(t,a,{passive:!n,capture:!!r})},Ct=function(e,t,a,n){return e.removeEventListener(t,a,!!n)},At=function(e,t,a){(a=a&&a.wheelHandler)&&(e(t,"wheel",a),e(t,"touchmove",a))},Et={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},It={toggleActions:"play",anticipatePin:0},Rt={top:0,left:0,center:.5,bottom:1,right:1},Dt=function(e,t){if(Xe(e)){var a=e.indexOf("="),n=~a?+(e.charAt(a-1)+1)*parseFloat(e.substr(a+1)):0;~a&&(e.indexOf("%")>a&&(n*=t/100),e=e.substr(0,a-1)),e=n+(e in Rt?Rt[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},Pt=function(e,t,a,n,r,i,o,s){var l=r.startColor,c=r.endColor,u=r.fontSize,d=r.indent,h=r.fontWeight,p=Y.createElement("div"),f=Ve(a)||"fixed"===M(a,"pinType"),m=-1!==e.indexOf("scroller"),v=f?X:a,g=-1!==e.indexOf("start"),y=g?l:c,b="border-color:"+y+";font-size:"+u+";color:"+y+";font-weight:"+h+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return b+="position:"+((m||s)&&f?"fixed;":"absolute;"),(m||s||!f)&&(b+=(n===P?nt:rt)+":"+(i+parseFloat(d))+"px;"),o&&(b+="box-sizing:border-box;text-align:left;width:"+o.offsetWidth+"px;"),p._isStart=g,p.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),p.style.cssText=b,p.innerText=t||0===t?e+"-"+t:e,v.children[0]?v.insertBefore(p,v.children[0]):v.appendChild(p),p._offset=p["offset"+n.op.d2],Lt(p,0,n,g),p},Lt=function(e,t,a,n){var r={display:"block"},i=a[n?"os2":"p2"],o=a[n?"p2":"os2"];e._isFlipped=n,r[a.a+"Percent"]=n?-100:0,r[a.a]=n?"1px":0,r["border"+i+pt]=1,r["border"+o+pt]=0,r[a.p]=t+"px",G.set(e,r)},Nt=[],Ot={},Ft=function(){return Ae()-Ie>34&&(Se||(Se=requestAnimationFrame(na)))},Bt=function(){(!de||!de.isPressed||de.startX>X.clientWidth)&&(b.cache++,de?Se||(Se=requestAnimationFrame(na)):na(),Ie||Wt("scrollStart"),Ie=Ae())},Ut=function(){fe=q.innerWidth,pe=q.innerHeight},zt=function(e){b.cache++,(!0===e||!te&&!ue&&!Y.fullscreenElement&&!Y.webkitFullscreenElement&&(!he||fe!==q.innerWidth||Math.abs(q.innerHeight-pe)>.25*q.innerHeight))&&K.restart(!0)},Vt={},Ht=[],Gt=function e(){return Ct(ba,"scrollEnd",e)||ea(!0)},Wt=function(e){return Vt[e]&&Vt[e].map(function(e){return e()})||Ht},qt=[],Yt=function(e){for(var t=0;t<qt.length;t+=5)(!e||qt[t+4]&&qt[t+4].query===e)&&(qt[t].style.cssText=qt[t+1],qt[t].getBBox&&qt[t].setAttribute("transform",qt[t+2]||""),qt[t+3].uncache=1)},jt=function(){return b.forEach(function(e){return $e(e)&&++e.cacheID&&(e.rec=e())})},Xt=function(e,t){var a;for(re=0;re<Nt.length;re++)!(a=Nt[re])||t&&a._ctx!==t||(e?a.kill(1):a.revert(!0,!0));xe=!0,t&&Yt(t),t||Wt("revert")},$t=function(e,t){b.cache++,(t||!Me)&&b.forEach(function(e){return $e(e)&&e.cacheID++&&(e.rec=0)}),Xe(e)&&(q.history.scrollRestoration=ge=e)},Kt=0,Zt=function(){if(Te!==Kt){var e=Te=Kt;requestAnimationFrame(function(){return e===Kt&&ea(!0)})}},Jt=function(){X.appendChild(ye),be=!de&&ye.offsetHeight||q.innerHeight,X.removeChild(ye)},Qt=function(e){return Z(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},ea=function(e,t){if(j=Y.documentElement,X=Y.body,$=[q,Y,j,X],!Ie||e||xe){Jt(),Me=ba.isRefreshing=!0,xe||jt();var a=Wt("refreshInit");le&&ba.sort(),t||Xt(),b.forEach(function(e){$e(e)&&(e.smooth&&(e.target.style.scrollBehavior="auto"),e(0))}),Nt.slice(0).forEach(function(e){return e.refresh()}),xe=!1,Nt.forEach(function(e){if(e._subPinOffset&&e.pin){var t=e.vars.horizontal?"offsetWidth":"offsetHeight",a=e.pin[t];e.revert(!0,1),e.adjustPinSpacing(e.pin[t]-a),e.refresh()}}),we=1,Qt(!0),Nt.forEach(function(e){var t=Ye(e.scroller,e._dir),a="max"===e.vars.end||e._endClamp&&e.end>t,n=e._startClamp&&e.start>=t;(a||n)&&e.setPositions(n?t-1:e.start,a?Math.max(n?t:e.start+1,t):e.end,!0)}),Qt(!1),we=0,a.forEach(function(e){return e&&e.render&&e.render(-1)}),b.forEach(function(e){$e(e)&&(e.smooth&&requestAnimationFrame(function(){return e.target.style.scrollBehavior="smooth"}),e.rec&&e(e.rec))}),$t(ge,1),K.pause(),Kt++,Me=2,na(2),Nt.forEach(function(e){return $e(e.vars.onRefresh)&&e.vars.onRefresh(e)}),Me=ba.isRefreshing=!1,Wt("refresh")}else kt(ba,"scrollEnd",Gt)},ta=0,aa=1,na=function(e){if(2===e||!Me&&!xe){ba.isUpdating=!0,ke&&ke.update(0);var t=Nt.length,a=Ae(),n=a-Ee>=50,r=t&&Nt[0].scroll();if(aa=ta>r?-1:1,Me||(ta=r),n&&(Ie&&!ae&&a-Ie>200&&(Ie=0,Wt("scrollEnd")),Q=Ee,Ee=a),aa<0){for(re=t;re-- >0;)Nt[re]&&Nt[re].update(0,n);aa=1}else for(re=0;re<t;re++)Nt[re]&&Nt[re].update(0,n);ba.isUpdating=!1}Se=0},ra=[tt,at,rt,nt,ht+ut,ht+st,ht+ct,ht+lt,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],ia=ra.concat([it,ot,"boxSizing","max"+pt,"max"+ft,"position",ht,dt,dt+ct,dt+st,dt+ut,dt+lt]),oa=function(e,t,a){ca(a);var n=e._gsap;if(n.spacerIsNative)ca(n.spacerState);else if(e._gsap.swappedIn){var r=t.parentNode;r&&(r.insertBefore(e,t),r.removeChild(t))}e._gsap.swappedIn=!1},sa=function(e,t,a,n){if(!e._gsap.swappedIn){for(var r,i=ra.length,o=t.style,s=e.style;i--;)o[r=ra[i]]=a[r];o.position="absolute"===a.position?"absolute":"relative","inline"===a.display&&(o.display="inline-block"),s[rt]=s[nt]="auto",o.flexBasis=a.flexBasis||"auto",o.overflow="visible",o.boxSizing="border-box",o[it]=xt(e,D)+mt,o[ot]=xt(e,P)+mt,o[dt]=s[ht]=s[at]=s[tt]="0",ca(n),s[it]=s["max"+pt]=a[it],s[ot]=s["max"+ft]=a[ot],s[dt]=a[dt],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},la=/([A-Z])/g,ca=function(e){if(e){var t,a,n=e.t.style,r=e.length,i=0;for((e.t._gsap||G.core.getCache(e.t)).uncache=1;i<r;i+=2)a=e[i+1],t=e[i],a?n[t]=a:n[t]&&n.removeProperty(t.replace(la,"-$1").toLowerCase())}},ua=function(e){for(var t=ia.length,a=e.style,n=[],r=0;r<t;r++)n.push(ia[r],a[ia[r]]);return n.t=e,n},da=function(e,t,a){for(var n,r=[],i=e.length,o=a?8:0;o<i;o+=2)n=e[o],r.push(n,n in t?t[n]:e[o+1]);return r.t=e.t,r},ha={left:0,top:0},pa=function(e,t,a,n,r,i,o,s,l,c,u,d,h,p){$e(e)&&(e=e(s)),Xe(e)&&"max"===e.substr(0,3)&&(e=d+("="===e.charAt(4)?Dt("0"+e.substr(3),a):0));var f,m,v,g=h?h.time():0;if(h&&h.seek(0),isNaN(e)||(e=+e),Ke(e))h&&(e=G.utils.mapRange(h.scrollTrigger.start,h.scrollTrigger.end,0,d,e)),o&&Lt(o,a,n,!0);else{$e(t)&&(t=t(s));var y,b,x,w,_=(e||"0").split(" ");v=L(t,s)||X,(y=bt(v)||{})&&(y.left||y.top)||"none"!==vt(v).display||(w=v.style.display,v.style.display="block",y=bt(v),w?v.style.display=w:v.style.removeProperty("display")),b=Dt(_[0],y[n.d]),x=Dt(_[1]||"0",a),e=y[n.p]-l[n.p]-c+b+r-x,o&&Lt(o,x,n,a-x<20||o._isStart&&x>20),a-=a-x}if(p&&(s[p]=e||-.001,e<0&&(e=0)),i){var S=e+a,M=i._isStart;f="scroll"+n.d2,Lt(i,S,n,M&&S>20||!M&&(u?Math.max(X[f],j[f]):i.parentNode[f])<=S+1),u&&(l=bt(o),u&&(i.style[n.op.p]=l[n.op.p]-n.op.m-i._offset+mt))}return h&&v&&(f=bt(v),h.seek(d),m=bt(v),h._caScrollDist=f[n.p]-m[n.p],e=e/h._caScrollDist*d),h&&h.seek(g),h?e:Math.round(e)},fa=/(webkit|moz|length|cssText|inset)/i,ma=function(e,t,a,n){if(e.parentNode!==t){var r,i,o=e.style;if(t===X){for(r in e._stOrig=o.cssText,i=vt(e))+r||fa.test(r)||!i[r]||"string"!=typeof o[r]||"0"===r||(o[r]=i[r]);o.top=a,o.left=n}else o.cssText=e._stOrig;G.core.getCache(e).uncache=1,t.appendChild(e)}},va=function(e,t,a){var n=t,r=n;return function(t){var i=Math.round(e());return i!==n&&i!==r&&Math.abs(i-n)>3&&Math.abs(i-r)>3&&(t=i,a&&a()),r=n,n=Math.round(t)}},ga=function(e,t,a){var n={};n[t.p]="+="+a,G.set(e,n)},ya=function(e,t){var a=O(e,t),n="_scroll"+t.p2,r=function t(r,i,o,s,l){var c=t.tween,u=i.onComplete,d={};o=o||a();var h=va(a,o,function(){c.kill(),t.tween=0});return l=s&&l||0,s=s||r-o,c&&c.kill(),i[n]=r,i.inherit=!1,i.modifiers=d,d[n]=function(){return h(o+s*c.ratio+l*c.ratio*c.ratio)},i.onUpdate=function(){b.cache++,t.tween&&na()},i.onComplete=function(){t.tween=0,u&&u.call(c)},c=t.tween=G.to(e,i)};return e[n]=a,a.wheelHandler=function(){return r.tween&&r.tween.kill()&&(r.tween=0)},kt(e,"wheel",a.wheelHandler),ba.isTouch&&kt(e,"touchmove",a.wheelHandler),r},ba=function(){function e(t,a){W||e.register(G)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),ve(this),this.init(t,a)}return e.prototype.init=function(t,a){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),Re){var n,r,i,o,s,l,c,u,d,h,p,f,m,v,g,y,w,_,S,T,k,C,A,E,I,R,N,F,B,U,z,V,H,W,$,K,ee,ne,ie,oe=t=yt(Xe(t)||Ke(t)||t.nodeType?{trigger:t}:t,It),se=oe.onUpdate,ue=oe.toggleClass,de=oe.id,he=oe.onToggle,pe=oe.onRefresh,fe=oe.scrub,me=oe.trigger,ve=oe.pin,ge=oe.pinSpacing,ye=oe.invalidateOnRefresh,be=oe.anticipatePin,xe=oe.onScrubComplete,Se=oe.onSnapComplete,Te=oe.once,Ee=oe.snap,Le=oe.pinReparent,Ne=oe.pinSpacer,Oe=oe.containerAnimation,Ue=oe.fastScrollEnd,ze=oe.preventOverlaps,He=t.horizontal||t.containerAnimation&&!1!==t.horizontal?D:P,Ge=!fe&&0!==fe,je=L(t.scroller||q),tt=G.core.getCache(je),at=Ve(je),nt="fixed"===("pinType"in t?t.pinType:M(je,"pinType")||at&&"fixed"),rt=[t.onEnter,t.onLeave,t.onEnterBack,t.onLeaveBack],wt=Ge&&t.toggleActions.split(" "),Tt="markers"in t?t.markers:It.markers,At=at?0:parseFloat(vt(je)["border"+He.p2+pt])||0,Rt=this,Lt=t.onRefreshInit&&function(){return t.onRefreshInit(Rt)},Ft=We(je,at,He),Ut=qe(je,at),Vt=0,Ht=0,Wt=0,qt=O(je,He);if(Rt._startClamp=Rt._endClamp=!1,Rt._dir=He,be*=45,Rt.scroller=je,Rt.scroll=Oe?Oe.time.bind(Oe):qt,o=qt(),Rt.vars=t,a=a||t.animation,"refreshPriority"in t&&(le=1,-9999===t.refreshPriority&&(ke=Rt)),tt.tweenScroll=tt.tweenScroll||{top:ya(je,P),left:ya(je,D)},Rt.tweenTo=n=tt.tweenScroll[He.p],Rt.scrubDuration=function(e){(H=Ke(e)&&e)?V?V.duration(e):V=G.to(a,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:H,paused:!0,onComplete:function(){return xe&&xe(Rt)}}):(V&&V.progress(1).kill(),V=0)},a&&(a.vars.lazy=!1,a._initted&&!Rt.isReverted||!1!==a.vars.immediateRender&&!1!==t.immediateRender&&a.duration()&&a.render(0,!0,!0),Rt.animation=a.pause(),a.scrollTrigger=Rt,Rt.scrubDuration(fe),U=0,de||(de=a.vars.id)),Ee&&(Ze(Ee)&&!Ee.push||(Ee={snapTo:Ee}),"scrollBehavior"in X.style&&G.set(at?[X,j]:je,{scrollBehavior:"auto"}),b.forEach(function(e){return $e(e)&&e.target===(at?Y.scrollingElement||j:je)&&(e.smooth=!1)}),i=$e(Ee.snapTo)?Ee.snapTo:"labels"===Ee.snapTo?_t(a):"labelsDirectional"===Ee.snapTo?Mt(a):!1!==Ee.directional?function(e,t){return St(Ee.snapTo)(e,Ae()-Ht<500?0:t.direction)}:G.utils.snap(Ee.snapTo),W=Ee.duration||{min:.1,max:2},W=Ze(W)?J(W.min,W.max):J(W,W),$=G.delayedCall(Ee.delay||H/2||.1,function(){var e=qt(),t=Ae()-Ht<500,r=n.tween;if(!(t||Math.abs(Rt.getVelocity())<10)||r||ae||Vt===e)Rt.isActive&&Vt!==e&&$.restart(!0);else{var o,s,u=(e-l)/v,d=a&&!Ge?a.totalProgress():u,h=t?0:(d-z)/(Ae()-Q)*1e3||0,p=G.utils.clamp(-u,1-u,et(h/2)*h/.185),f=u+(!1===Ee.inertia?0:p),m=Ee,g=m.onStart,y=m.onInterrupt,b=m.onComplete;if(o=i(f,Rt),Ke(o)||(o=f),s=Math.max(0,Math.round(l+o*v)),e<=c&&e>=l&&s!==e){if(r&&!r._initted&&r.data<=et(s-e))return;!1===Ee.inertia&&(p=o-u),n(s,{duration:W(et(.185*Math.max(et(f-d),et(o-d))/h/.05||0)),ease:Ee.ease||"power3",data:et(s-e),onInterrupt:function(){return $.restart(!0)&&y&&y(Rt)},onComplete:function(){Rt.update(),Vt=qt(),a&&!Ge&&(V?V.resetTo("totalProgress",o,a._tTime/a._tDur):a.progress(o)),U=z=a&&!Ge?a.totalProgress():Rt.progress,Se&&Se(Rt),b&&b(Rt)}},e,p*v,s-e-p*v),g&&g(Rt,n.tween)}}}).pause()),de&&(Ot[de]=Rt),(ie=(me=Rt.trigger=L(me||!0!==ve&&ve))&&me._gsap&&me._gsap.stRevert)&&(ie=ie(Rt)),ve=!0===ve?me:L(ve),Xe(ue)&&(ue={targets:me,className:ue}),ve&&(!1===ge||ge===ht||(ge=!(!ge&&ve.parentNode&&ve.parentNode.style&&"flex"===vt(ve.parentNode).display)&&dt),Rt.pin=ve,(r=G.core.getCache(ve)).spacer?g=r.pinState:(Ne&&((Ne=L(Ne))&&!Ne.nodeType&&(Ne=Ne.current||Ne.nativeElement),r.spacerIsNative=!!Ne,Ne&&(r.spacerState=ua(Ne))),r.spacer=_=Ne||Y.createElement("div"),_.classList.add("pin-spacer"),de&&_.classList.add("pin-spacer-"+de),r.pinState=g=ua(ve)),!1!==t.force3D&&G.set(ve,{force3D:!0}),Rt.spacer=_=r.spacer,B=vt(ve),E=B[ge+He.os2],T=G.getProperty(ve),k=G.quickSetter(ve,He.a,mt),sa(ve,_,B),w=ua(ve)),Tt){f=Ze(Tt)?yt(Tt,Et):Et,h=Pt("scroller-start",de,je,He,f,0),p=Pt("scroller-end",de,je,He,f,0,h),S=h["offset"+He.op.d2];var Yt=L(M(je,"content")||je);u=this.markerStart=Pt("start",de,Yt,He,f,S,0,Oe),d=this.markerEnd=Pt("end",de,Yt,He,f,S,0,Oe),Oe&&(ne=G.quickSetter([u,d],He.a,mt)),nt||x.length&&!0===M(je,"fixedMarkers")||(gt(at?X:je),G.set([h,p],{force3D:!0}),R=G.quickSetter(h,He.a,mt),F=G.quickSetter(p,He.a,mt))}if(Oe){var jt=Oe.vars.onUpdate,Xt=Oe.vars.onUpdateParams;Oe.eventCallback("onUpdate",function(){Rt.update(0,0,1),jt&&jt.apply(Oe,Xt||[])})}if(Rt.previous=function(){return Nt[Nt.indexOf(Rt)-1]},Rt.next=function(){return Nt[Nt.indexOf(Rt)+1]},Rt.revert=function(e,t){if(!t)return Rt.kill(!0);var n=!1!==e||!Rt.enabled,r=te;n!==Rt.isReverted&&(n&&(K=Math.max(qt(),Rt.scroll.rec||0),Wt=Rt.progress,ee=a&&a.progress()),u&&[u,d,h,p].forEach(function(e){return e.style.display=n?"none":"block"}),n&&(te=Rt,Rt.update(n)),!ve||Le&&Rt.isActive||(n?oa(ve,_,g):sa(ve,_,vt(ve),I)),n||Rt.update(n),te=r,Rt.isReverted=n)},Rt.refresh=function(r,i,f,b){if(!te&&Rt.enabled||i)if(ve&&r&&Ie)kt(e,"scrollEnd",Gt);else{!Me&&Lt&&Lt(Rt),te=Rt,n.tween&&!f&&(n.tween.kill(),n.tween=0),V&&V.pause(),ye&&a&&(a.revert({kill:!1}).invalidate(),a.getChildren?a.getChildren(!0,!0,!1).forEach(function(e){return e.vars.immediateRender&&e.render(0,!0,!0)}):a.vars.immediateRender&&a.render(0,!0,!0)),Rt.isReverted||Rt.revert(!0,!0),Rt._subPinOffset=!1;var x,S,M,k,E,R,F,B,U,z,H,W,q,Z=Ft(),J=Ut(),Q=Oe?Oe.duration():Ye(je,He),ae=v<=.01||!v,ne=0,re=b||0,ie=Ze(f)?f.end:t.end,oe=t.endTrigger||me,se=Ze(f)?f.start:t.start||(0!==t.start&&me?ve?"0 0":"0 100%":0),le=Rt.pinnedContainer=t.pinnedContainer&&L(t.pinnedContainer,Rt),ue=me&&Math.max(0,Nt.indexOf(Rt))||0,de=ue;for(Tt&&Ze(f)&&(W=G.getProperty(h,He.p),q=G.getProperty(p,He.p));de-- >0;)(R=Nt[de]).end||R.refresh(0,1)||(te=Rt),!(F=R.pin)||F!==me&&F!==ve&&F!==le||R.isReverted||(z||(z=[]),z.unshift(R),R.revert(!0,!0)),R!==Nt[de]&&(ue--,de--);for($e(se)&&(se=se(Rt)),se=De(se,"start",Rt),l=pa(se,me,Z,He,qt(),u,h,Rt,J,At,nt,Q,Oe,Rt._startClamp&&"_startClamp")||(ve?-.001:0),$e(ie)&&(ie=ie(Rt)),Xe(ie)&&!ie.indexOf("+=")&&(~ie.indexOf(" ")?ie=(Xe(se)?se.split(" ")[0]:"")+ie:(ne=Dt(ie.substr(2),Z),ie=Xe(se)?se:(Oe?G.utils.mapRange(0,Oe.duration(),Oe.scrollTrigger.start,Oe.scrollTrigger.end,l):l)+ne,oe=me)),ie=De(ie,"end",Rt),c=Math.max(l,pa(ie||(oe?"100% 0":Q),oe,Z,He,qt()+ne,d,p,Rt,J,At,nt,Q,Oe,Rt._endClamp&&"_endClamp"))||-.001,ne=0,de=ue;de--;)(F=(R=Nt[de]||{}).pin)&&R.start-R._pinPush<=l&&!Oe&&R.end>0&&(x=R.end-(Rt._startClamp?Math.max(0,R.start):R.start),(F===me&&R.start-R._pinPush<l||F===le)&&isNaN(se)&&(ne+=x*(1-R.progress)),F===ve&&(re+=x));if(l+=ne,c+=ne,Rt._startClamp&&(Rt._startClamp+=ne),Rt._endClamp&&!Me&&(Rt._endClamp=c||-.001,c=Math.min(c,Ye(je,He))),v=c-l||(l-=.01)&&.001,ae&&(Wt=G.utils.clamp(0,1,G.utils.normalize(l,c,K))),Rt._pinPush=re,u&&ne&&((x={})[He.a]="+="+ne,le&&(x[He.p]="-="+qt()),G.set([u,d],x)),!ve||we&&Rt.end>=Ye(je,He)){if(me&&qt()&&!Oe)for(S=me.parentNode;S&&S!==X;)S._pinOffset&&(l-=S._pinOffset,c-=S._pinOffset),S=S.parentNode}else x=vt(ve),k=He===P,M=qt(),C=parseFloat(T(He.a))+re,!Q&&c>1&&(H={style:H=(at?Y.scrollingElement||j:je).style,value:H["overflow"+He.a.toUpperCase()]},at&&"scroll"!==vt(X)["overflow"+He.a.toUpperCase()]&&(H.style["overflow"+He.a.toUpperCase()]="scroll")),sa(ve,_,x),w=ua(ve),S=bt(ve,!0),B=nt&&O(je,k?D:P)(),ge?((I=[ge+He.os2,v+re+mt]).t=_,(de=ge===dt?xt(ve,He)+v+re:0)&&(I.push(He.d,de+mt),"auto"!==_.style.flexBasis&&(_.style.flexBasis=de+mt)),ca(I),le&&Nt.forEach(function(e){e.pin===le&&!1!==e.vars.pinSpacing&&(e._subPinOffset=!0)}),nt&&qt(K)):(de=xt(ve,He))&&"auto"!==_.style.flexBasis&&(_.style.flexBasis=de+mt),nt&&((E={top:S.top+(k?M-l:B)+mt,left:S.left+(k?B:M-l)+mt,boxSizing:"border-box",position:"fixed"})[it]=E["max"+pt]=Math.ceil(S.width)+mt,E[ot]=E["max"+ft]=Math.ceil(S.height)+mt,E[ht]=E[ht+ct]=E[ht+st]=E[ht+ut]=E[ht+lt]="0",E[dt]=x[dt],E[dt+ct]=x[dt+ct],E[dt+st]=x[dt+st],E[dt+ut]=x[dt+ut],E[dt+lt]=x[dt+lt],y=da(g,E,Le),Me&&qt(0)),a?(U=a._initted,ce(1),a.render(a.duration(),!0,!0),A=T(He.a)-C+v+re,N=Math.abs(v-A)>1,nt&&N&&y.splice(y.length-2,2),a.render(0,!0,!0),U||a.invalidate(!0),a.parent||a.totalTime(a.totalTime()),ce(0)):A=v,H&&(H.value?H.style["overflow"+He.a.toUpperCase()]=H.value:H.style.removeProperty("overflow-"+He.a));z&&z.forEach(function(e){return e.revert(!1,!0)}),Rt.start=l,Rt.end=c,o=s=Me?K:qt(),Oe||Me||(o<K&&qt(K),Rt.scroll.rec=0),Rt.revert(!1,!0),Ht=Ae(),$&&(Vt=-1,$.restart(!0)),te=0,a&&Ge&&(a._initted||ee)&&a.progress()!==ee&&a.progress(ee||0,!0).render(a.time(),!0,!0),(ae||Wt!==Rt.progress||Oe||ye||a&&!a._initted)&&(a&&!Ge&&(a._initted||Wt||!1!==a.vars.immediateRender)&&a.totalProgress(Oe&&l<-.001&&!Wt?G.utils.normalize(l,c,0):Wt,!0),Rt.progress=ae||(o-l)/v===Wt?0:Wt),ve&&ge&&(_._pinOffset=Math.round(Rt.progress*A)),V&&V.invalidate(),isNaN(W)||(W-=G.getProperty(h,He.p),q-=G.getProperty(p,He.p),ga(h,He,W),ga(u,He,W-(b||0)),ga(p,He,q),ga(d,He,q-(b||0))),ae&&!Me&&Rt.update(),!pe||Me||m||(m=!0,pe(Rt),m=!1)}},Rt.getVelocity=function(){return(qt()-s)/(Ae()-Q)*1e3||0},Rt.endAnimation=function(){Je(Rt.callbackAnimation),a&&(V?V.progress(1):a.paused()?Ge||Je(a,Rt.direction<0,1):Je(a,a.reversed()))},Rt.labelToScroll=function(e){return a&&a.labels&&(l||Rt.refresh()||l)+a.labels[e]/a.duration()*v||0},Rt.getTrailing=function(e){var t=Nt.indexOf(Rt),a=Rt.direction>0?Nt.slice(0,t).reverse():Nt.slice(t+1);return(Xe(e)?a.filter(function(t){return t.vars.preventOverlaps===e}):a).filter(function(e){return Rt.direction>0?e.end<=l:e.start>=c})},Rt.update=function(e,t,r){if(!Oe||r||e){var i,u,d,p,f,m,g,b=!0===Me?K:Rt.scroll(),x=e?0:(b-l)/v,S=x<0?0:x>1?1:x||0,M=Rt.progress;if(t&&(s=o,o=Oe?qt():b,Ee&&(z=U,U=a&&!Ge?a.totalProgress():S)),be&&ve&&!te&&!Ce&&Ie&&(!S&&l<b+(b-s)/(Ae()-Q)*be?S=1e-4:1===S&&c>b+(b-s)/(Ae()-Q)*be&&(S=.9999)),S!==M&&Rt.enabled){if(p=(f=(i=Rt.isActive=!!S&&S<1)!=(!!M&&M<1))||!!S!=!!M,Rt.direction=S>M?1:-1,Rt.progress=S,p&&!te&&(u=S&&!M?0:1===S?1:1===M?2:3,Ge&&(d=!f&&"none"!==wt[u+1]&&wt[u+1]||wt[u],g=a&&("complete"===d||"reset"===d||d in a))),ze&&(f||g)&&(g||fe||!a)&&($e(ze)?ze(Rt):Rt.getTrailing(ze).forEach(function(e){return e.endAnimation()})),Ge||(!V||te||Ce?a&&a.totalProgress(S,!(!te||!Ht&&!e)):(V._dp._time-V._start!==V._time&&V.render(V._dp._time-V._start),V.resetTo?V.resetTo("totalProgress",S,a._tTime/a._tDur):(V.vars.totalProgress=S,V.invalidate().restart()))),ve)if(e&&ge&&(_.style[ge+He.os2]=E),nt){if(p){if(m=!e&&S>M&&c+1>b&&b+1>=Ye(je,He),Le)if(e||!i&&!m)ma(ve,_);else{var T=bt(ve,!0),I=b-l;ma(ve,X,T.top+(He===P?I:0)+mt,T.left+(He===P?0:I)+mt)}ca(i||m?y:w),N&&S<1&&i||k(C+(1!==S||m?0:A))}}else k(Be(C+A*S));Ee&&!n.tween&&!te&&!Ce&&$.restart(!0),ue&&(f||Te&&S&&(S<1||!_e))&&Z(ue.targets).forEach(function(e){return e.classList[i||Te?"add":"remove"](ue.className)}),se&&!Ge&&!e&&se(Rt),p&&!te?(Ge&&(g&&("complete"===d?a.pause().totalProgress(1):"reset"===d?a.restart(!0).pause():"restart"===d?a.restart(!0):a[d]()),se&&se(Rt)),!f&&_e||(he&&f&&Qe(Rt,he),rt[u]&&Qe(Rt,rt[u]),Te&&(1===S?Rt.kill(!1,1):rt[u]=0),f||rt[u=1===S?1:3]&&Qe(Rt,rt[u])),Ue&&!i&&Math.abs(Rt.getVelocity())>(Ke(Ue)?Ue:2500)&&(Je(Rt.callbackAnimation),V?V.progress(1):Je(a,"reverse"===d?1:!S,1))):Ge&&se&&!te&&se(Rt)}if(F){var D=Oe?b/Oe.duration()*(Oe._caScrollDist||0):b;R(D+(h._isFlipped?1:0)),F(D)}ne&&ne(-b/Oe.duration()*(Oe._caScrollDist||0))}},Rt.enable=function(t,a){Rt.enabled||(Rt.enabled=!0,kt(je,"resize",zt),at||kt(je,"scroll",Bt),Lt&&kt(e,"refreshInit",Lt),!1!==t&&(Rt.progress=Wt=0,o=s=Vt=qt()),!1!==a&&Rt.refresh())},Rt.getTween=function(e){return e&&n?n.tween:V},Rt.setPositions=function(e,t,a,n){if(Oe){var r=Oe.scrollTrigger,i=Oe.duration(),o=r.end-r.start;e=r.start+o*e/i,t=r.start+o*t/i}Rt.refresh(!1,!1,{start:Pe(e,a&&!!Rt._startClamp),end:Pe(t,a&&!!Rt._endClamp)},n),Rt.update()},Rt.adjustPinSpacing=function(e){if(I&&e){var t=I.indexOf(He.d)+1;I[t]=parseFloat(I[t])+e+mt,I[1]=parseFloat(I[1])+e+mt,ca(I)}},Rt.disable=function(t,a){if(!1!==t&&Rt.revert(!0,!0),Rt.enabled&&(Rt.enabled=Rt.isActive=!1,a||V&&V.pause(),K=0,r&&(r.uncache=1),Lt&&Ct(e,"refreshInit",Lt),$&&($.pause(),n.tween&&n.tween.kill()&&(n.tween=0)),!at)){for(var i=Nt.length;i--;)if(Nt[i].scroller===je&&Nt[i]!==Rt)return;Ct(je,"resize",zt),at||Ct(je,"scroll",Bt)}},Rt.kill=function(e,n){Rt.disable(e,n),V&&!n&&V.kill(),de&&delete Ot[de];var i=Nt.indexOf(Rt);i>=0&&Nt.splice(i,1),i===re&&aa>0&&re--,i=0,Nt.forEach(function(e){return e.scroller===Rt.scroller&&(i=1)}),i||Me||(Rt.scroll.rec=0),a&&(a.scrollTrigger=null,e&&a.revert({kill:!1}),n||a.kill()),u&&[u,d,h,p].forEach(function(e){return e.parentNode&&e.parentNode.removeChild(e)}),ke===Rt&&(ke=0),ve&&(r&&(r.uncache=1),i=0,Nt.forEach(function(e){return e.pin===ve&&i++}),i||(r.spacer=0)),t.onKill&&t.onKill(Rt)},Nt.push(Rt),Rt.enable(!1,!1),ie&&ie(Rt),a&&a.add&&!v){var $t=Rt.update;Rt.update=function(){Rt.update=$t,b.cache++,l||c||Rt.refresh()},G.delayedCall(.01,Rt.update),v=.01,l=c=0}else Rt.refresh();ve&&Zt()}else this.update=this.refresh=this.kill=Fe},e.register=function(t){return W||(G=t||ze(),Ue()&&window.document&&e.enable(),W=Re),W},e.defaults=function(e){if(e)for(var t in e)It[t]=e[t];return It},e.disable=function(e,t){Re=0,Nt.forEach(function(a){return a[t?"kill":"disable"](e)}),Ct(q,"wheel",Bt),Ct(Y,"scroll",Bt),clearInterval(ee),Ct(Y,"touchcancel",Fe),Ct(X,"touchstart",Fe),Tt(Ct,Y,"pointerdown,touchstart,mousedown",Ne),Tt(Ct,Y,"pointerup,touchend,mouseup",Oe),K.kill(),je(Ct);for(var a=0;a<b.length;a+=3)At(Ct,b[a],b[a+1]),At(Ct,b[a],b[a+2])},e.enable=function(){if(q=window,Y=document,j=Y.documentElement,X=Y.body,G&&(Z=G.utils.toArray,J=G.utils.clamp,ve=G.core.context||Fe,ce=G.core.suppressOverwrites||Fe,ge=q.history.scrollRestoration||"auto",ta=q.pageYOffset||0,G.core.globals("ScrollTrigger",e),X)){Re=1,(ye=document.createElement("div")).style.height="100vh",ye.style.position="absolute",Jt(),Le(),H.register(G),e.isTouch=H.isTouch,me=H.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),he=1===H.isTouch,kt(q,"wheel",Bt),$=[q,Y,j,X],G.matchMedia?(e.matchMedia=function(e){var t,a=G.matchMedia();for(t in e)a.add(t,e[t]);return a},G.addEventListener("matchMediaInit",function(){jt(),Xt()}),G.addEventListener("matchMediaRevert",function(){return Yt()}),G.addEventListener("matchMedia",function(){ea(0,1),Wt("matchMedia")}),G.matchMedia().add("(orientation: portrait)",function(){return Ut(),Ut})):console.warn("Requires GSAP 3.11.0 or later"),Ut(),kt(Y,"scroll",Bt);var t,a,n=X.hasAttribute("style"),r=X.style,i=r.borderTopStyle,o=G.core.Animation.prototype;for(o.revert||Object.defineProperty(o,"revert",{value:function(){return this.time(-.01,!0)}}),r.borderTopStyle="solid",t=bt(X),P.m=Math.round(t.top+P.sc())||0,D.m=Math.round(t.left+D.sc())||0,i?r.borderTopStyle=i:r.removeProperty("border-top-style"),n||(X.setAttribute("style",""),X.removeAttribute("style")),ee=setInterval(Ft,250),G.delayedCall(.5,function(){return Ce=0}),kt(Y,"touchcancel",Fe),kt(X,"touchstart",Fe),Tt(kt,Y,"pointerdown,touchstart,mousedown",Ne),Tt(kt,Y,"pointerup,touchend,mouseup",Oe),ne=G.utils.checkPrefix("transform"),ia.push(ne),W=Ae(),K=G.delayedCall(.2,ea).pause(),se=[Y,"visibilitychange",function(){var e=q.innerWidth,t=q.innerHeight;Y.hidden?(ie=e,oe=t):ie===e&&oe===t||zt()},Y,"DOMContentLoaded",ea,q,"load",ea,q,"resize",zt],je(kt),Nt.forEach(function(e){return e.enable(0,1)}),a=0;a<b.length;a+=3)At(Ct,b[a],b[a+1]),At(Ct,b[a],b[a+2])}},e.config=function(t){"limitCallbacks"in t&&(_e=!!t.limitCallbacks);var a=t.syncInterval;a&&clearInterval(ee)||(ee=a)&&setInterval(Ft,a),"ignoreMobileResize"in t&&(he=1===e.isTouch&&t.ignoreMobileResize),"autoRefreshEvents"in t&&(je(Ct)||je(kt,t.autoRefreshEvents||"none"),ue=-1===(t.autoRefreshEvents+"").indexOf("resize"))},e.scrollerProxy=function(e,t){var a=L(e),n=b.indexOf(a),r=Ve(a);~n&&b.splice(n,r?6:2),t&&(r?x.unshift(q,t,X,t,j,t):x.unshift(a,t))},e.clearMatchMedia=function(e){Nt.forEach(function(t){return t._ctx&&t._ctx.query===e&&t._ctx.kill(!0,!0)})},e.isInViewport=function(e,t,a){var n=(Xe(e)?L(e):e).getBoundingClientRect(),r=n[a?it:ot]*t||0;return a?n.right-r>0&&n.left+r<q.innerWidth:n.bottom-r>0&&n.top+r<q.innerHeight},e.positionInViewport=function(e,t,a){Xe(e)&&(e=L(e));var n=e.getBoundingClientRect(),r=n[a?it:ot],i=null==t?r/2:t in Rt?Rt[t]*r:~t.indexOf("%")?parseFloat(t)*r/100:parseFloat(t)||0;return a?(n.left+i)/q.innerWidth:(n.top+i)/q.innerHeight},e.killAll=function(e){if(Nt.slice(0).forEach(function(e){return"ScrollSmoother"!==e.vars.id&&e.kill()}),!0!==e){var t=Vt.killAll||[];Vt={},t.forEach(function(e){return e()})}},e}();ba.version="3.14.2",ba.saveStyles=function(e){return e?Z(e).forEach(function(e){if(e&&e.style){var t=qt.indexOf(e);t>=0&&qt.splice(t,5),qt.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),G.core.getCache(e),ve())}}):qt},ba.revert=function(e,t){return Xt(!e,t)},ba.create=function(e,t){return new ba(e,t)},ba.refresh=function(e){return e?zt(!0):(W||ba.register())&&ea(!0)},ba.update=function(e){return++b.cache&&na(!0===e?2:0)},ba.clearScrollMemory=$t,ba.maxScroll=function(e,t){return Ye(e,t?D:P)},ba.getScrollFunc=function(e,t){return O(L(e),t?D:P)},ba.getById=function(e){return Ot[e]},ba.getAll=function(){return Nt.filter(function(e){return"ScrollSmoother"!==e.vars.id})},ba.isScrolling=function(){return!!Ie},ba.snapDirectional=St,ba.addEventListener=function(e,t){var a=Vt[e]||(Vt[e]=[]);~a.indexOf(t)||a.push(t)},ba.removeEventListener=function(e,t){var a=Vt[e],n=a&&a.indexOf(t);n>=0&&a.splice(n,1)},ba.batch=function(e,t){var a,n=[],r={},i=t.interval||.016,o=t.batchMax||1e9,s=function(e,t){var a=[],n=[],r=G.delayedCall(i,function(){t(a,n),a=[],n=[]}).pause();return function(e){a.length||r.restart(!0),a.push(e.trigger),n.push(e),o<=a.length&&r.progress(1)}};for(a in t)r[a]="on"===a.substr(0,2)&&$e(t[a])&&"onRefreshInit"!==a?s(a,t[a]):t[a];return $e(o)&&(o=o(),kt(ba,"refresh",function(){return o=t.batchMax()})),Z(e).forEach(function(e){var t={};for(a in r)t[a]=r[a];t.trigger=e,n.push(ba.create(t))}),n};var xa,wa=function(e,t,a,n){return t>n?e(n):t<0&&e(0),a>n?(n-t)/(a-t):a<0?t/(t-a):1},_a=function e(t,a){!0===a?t.style.removeProperty("touch-action"):t.style.touchAction=!0===a?"auto":a?"pan-"+a+(H.isTouch?" pinch-zoom":""):"none",t===j&&e(X,a)},Sa={auto:1,scroll:1},Ma=function(e){var t,a=e.event,n=e.target,r=e.axis,i=(a.changedTouches?a.changedTouches[0]:a).target,o=i._gsap||G.core.getCache(i),s=Ae();if(!o._isScrollT||s-o._isScrollT>2e3){for(;i&&i!==X&&(i.scrollHeight<=i.clientHeight&&i.scrollWidth<=i.clientWidth||!Sa[(t=vt(i)).overflowY]&&!Sa[t.overflowX]);)i=i.parentNode;o._isScroll=i&&i!==n&&!Ve(i)&&(Sa[(t=vt(i)).overflowY]||Sa[t.overflowX]),o._isScrollT=s}(o._isScroll||"x"===r)&&(a.stopPropagation(),a._gsapAllow=!0)},Ta=function(e,t,a,n){return H.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:n=n&&Ma,onPress:n,onDrag:n,onScroll:n,onEnable:function(){return a&&kt(Y,H.eventTypes[0],Ca,!1,!0)},onDisable:function(){return Ct(Y,H.eventTypes[0],Ca,!0)}})},ka=/(input|label|select|textarea)/i,Ca=function(e){var t=ka.test(e.target.tagName);(t||xa)&&(e._gsapAllow=!0,xa=t)},Aa=function(e){Ze(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t,a,n,r,i,o,s,l,c=e,u=c.normalizeScrollX,d=c.momentum,h=c.allowNestedScroll,p=c.onRelease,f=L(e.target)||j,m=G.core.globals().ScrollSmoother,v=m&&m.get(),g=me&&(e.content&&L(e.content)||v&&!1!==e.content&&!v.smooth()&&v.content()),y=O(f,P),x=O(f,D),w=1,_=(H.isTouch&&q.visualViewport?q.visualViewport.scale*q.visualViewport.width:q.outerWidth)/q.innerWidth,S=0,M=$e(d)?function(){return d(t)}:function(){return d||2.8},T=Ta(f,e.type,!0,h),k=function(){return r=!1},C=Fe,A=Fe,E=function(){a=Ye(f,P),A=J(me?1:0,a),u&&(C=J(0,Ye(f,D))),n=Kt},I=function(){g._gsap.y=Be(parseFloat(g._gsap.y)+y.offset)+"px",g.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(g._gsap.y)+", 0, 1)",y.offset=y.cacheID=0},R=function(){if(r){requestAnimationFrame(k);var e=Be(t.deltaY/2),a=A(y.v-e);if(g&&a!==y.v+y.offset){y.offset=a-y.v;var n=Be((parseFloat(g&&g._gsap.y)||0)-y.offset);g.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+n+", 0, 1)",g._gsap.y=n+"px",y.cacheID=b.cache,na()}return!0}y.offset&&I(),r=!0},N=function(){E(),i.isActive()&&i.vars.scrollY>a&&(y()>a?i.progress(1)&&y(a):i.resetTo("scrollY",a))};return g&&G.set(g,{y:"+=0"}),e.ignoreCheck=function(e){return me&&"touchmove"===e.type&&R()||w>1.05&&"touchstart"!==e.type||t.isGesturing||e.touches&&e.touches.length>1},e.onPress=function(){r=!1;var e=w;w=Be((q.visualViewport&&q.visualViewport.scale||1)/_),i.pause(),e!==w&&_a(f,w>1.01||!u&&"x"),o=x(),s=y(),E(),n=Kt},e.onRelease=e.onGestureStart=function(e,t){if(y.offset&&I(),t){b.cache++;var n,r,o=M();u&&(r=(n=x())+.05*o*-e.velocityX/.227,o*=wa(x,n,r,Ye(f,D)),i.vars.scrollX=C(r)),r=(n=y())+.05*o*-e.velocityY/.227,o*=wa(y,n,r,Ye(f,P)),i.vars.scrollY=A(r),i.invalidate().duration(o).play(.01),(me&&i.vars.scrollY>=a||n>=a-1)&&G.to({},{onUpdate:N,duration:o})}else l.restart(!0);p&&p(e)},e.onWheel=function(){i._ts&&i.pause(),Ae()-S>1e3&&(n=0,S=Ae())},e.onChange=function(e,t,a,r,i){if(Kt!==n&&E(),t&&u&&x(C(r[2]===t?o+(e.startX-e.x):x()+t-r[1])),a){y.offset&&I();var l=i[2]===a,c=l?s+e.startY-e.y:y()+a-i[1],d=A(c);l&&c!==d&&(s+=d-c),y(d)}(a||t)&&na()},e.onEnable=function(){_a(f,!u&&"x"),ba.addEventListener("refresh",N),kt(q,"resize",N),y.smooth&&(y.target.style.scrollBehavior="auto",y.smooth=x.smooth=!1),T.enable()},e.onDisable=function(){_a(f,!0),Ct(q,"resize",N),ba.removeEventListener("refresh",N),T.kill()},e.lockAxis=!1!==e.lockAxis,(t=new H(e)).iOS=me,me&&!y()&&y(1),me&&G.ticker.add(Fe),l=t._dc,i=G.to(t,{ease:"power4",paused:!0,inherit:!1,scrollX:u?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:va(y,y(),function(){return i.pause()})},onUpdate:na,onComplete:l.vars.onComplete}),t};ba.sort=function(e){if($e(e))return Nt.sort(e);var t=q.pageYOffset||0;return ba.getAll().forEach(function(e){return e._sortY=e.trigger?t+e.trigger.getBoundingClientRect().top:e.start+q.innerHeight}),Nt.sort(e||function(e,t){return-1e6*(e.vars.refreshPriority||0)+(e.vars.containerAnimation?1e6:e._sortY)-((t.vars.containerAnimation?1e6:t._sortY)+-1e6*(t.vars.refreshPriority||0))})},ba.observe=function(e){return new H(e)},ba.normalizeScroll=function(e){if(void 0===e)return de;if(!0===e&&de)return de.enable();if(!1===e)return de&&de.kill(),void(de=e);var t=e instanceof H?e:Aa(e);return de&&de.target===t.target&&de.kill(),Ve(t.target)&&(de=t),t},ba.core={_getVelocityProp:F,_inputObserver:Ta,_scrollers:b,_proxies:x,bridge:{ss:function(){Ie||Wt("scrollStart"),Ie=Ae()},ref:function(){return te}}},ze()&&G.registerPlugin(ba),e.ScrollTrigger=ba,e.default=ba,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default}(mo.exports);var vo=mo.exports;const go={class:"home-root"},yo={class:"nav"},bo={class:"nav-links"},xo={class:"main-content"},wo={class:"hero-titles"},_o={class:"marquee-strip marquee-red"},So={class:"marquee-track"},Mo={class:"about"},To={class:"about-grid"},ko={class:"about-right"},Co={class:"marquee-strip marquee-dark"},Ao={class:"marquee-track marquee-reverse"},Eo={id:"tools",class:"tools"},Io={class:"tools-inner"},Ro={class:"tools-list"},Do=["onClick"],Po={class:"tool-left"},Lo={class:"tool-index font-mono"},No={class:"tool-info"},Oo={class:"tool-name font-oswald"},Fo={key:0,class:"tool-desc font-mono"},Bo={id:"terminal",class:"terminal-section"},Uo="cubic-bezier(0.76, 0, 0.24, 1)",zo=e({__name:"Home",setup(e){ho.registerPlugin(vo.ScrollTrigger);const a=x(),o=t(null),c=t(null),u=t(null),d=t(null),h=t(null),g=t(null),y=t(null),b=t(null),_=t(null),S=t(null),M=t([]),T=t(!0),k=[{name:"Портфельный анализ",desc:"Доходность, VaR/ES, мониторинг позиций",path:"/portfolio"},{name:"Риск-менеджмент",desc:"Стресс-тесты, бэктестинг VaR, сценарии",path:"/stress"},{name:"Рыночные режимы",desc:"HMM, стационарное распределение",path:"/regimes"},{name:"Стоимость облигаций",desc:"DCF, дюрация, convexity, спреды",path:"/bond-valuation"},{name:"Стоимость опционов",desc:"БШМ, Хестон, Леви, FFT",path:"/pricing/options"},{name:"Волатильность",desc:"SABR/SVI калибровка, smile",path:"/analytics/volatility"},{name:"Стоимость СВОПов",desc:"IRS & FX свопы, NPV, DV01",path:"/valuation/swaps"},{name:"Стоимость форвардов",desc:"Справедливая стоимость, кривая",path:"/valuation/forwards"},{name:"Отчёты по облигациям",desc:"Шаблонные отчёты",path:"/vanila-bond-report"},{name:"Кривая бескупонной доходности",desc:"ZCYC",path:"/zcyc-viewer"},{name:"P&L Attribution",desc:"Факторная декомпозиция P&L",path:"/analytics/pnl"}];function C(e){document.getElementById(e)?.scrollIntoView({behavior:"smooth"})}function R(e){a.push(e)}return n(async()=>{await A();const e=function(){const e=document.getElementById("app");if(!e)return;const t=getComputedStyle(e);return"auto"!==t.height&&e.scrollHeight>e.clientHeight&&("auto"===t.overflowY||"scroll"===t.overflowY)?e:void 0}();setTimeout(()=>{o.value&&ho.to(o.value,{opacity:0,y:-50,duration:.8,ease:"power4.out",onComplete:()=>{T.value=!1,function(){d.value&&ho.set(d.value,{y:100,opacity:0});h.value&&ho.set(h.value,{scaleY:0});g.value&&ho.set(g.value,{scaleY:0});y.value&&ho.set(y.value,{y:20,opacity:0});d.value&&ho.fromTo(d.value,{y:100,opacity:0},{y:0,opacity:1,duration:1,delay:0,ease:"EASE_CSS"});h.value&&ho.fromTo(h.value,{scaleY:0},{scaleY:1,duration:1,delay:.2,ease:Uo,transformOrigin:"bottom center"});g.value&&ho.fromTo(g.value,{scaleY:0},{scaleY:1,duration:1,delay:.4,ease:Uo,transformOrigin:"top center"});y.value&&ho.fromTo(y.value,{y:20,opacity:0},{y:0,opacity:1,duration:.8,delay:.6,ease:"power4.out"})}()}})},1500),c.value&&u.value&&ho.to(u.value,{yPercent:50,opacity:0,ease:"none",scrollTrigger:{trigger:c.value,scroller:e,start:"top top",end:"bottom top",scrub:!0}}),c.value&&y.value&&ho.to(y.value,{yPercent:-50,ease:"none",scrollTrigger:{trigger:c.value,scroller:e,start:"top top",end:"bottom top",scrub:!0}}),[b.value,_.value,S.value].forEach(t=>{t&&ho.fromTo(t,{opacity:0,y:50},{opacity:1,y:0,duration:.8,ease:"power2.out",scrollTrigger:{trigger:t,scroller:e,start:"top 85%",once:!0}})}),await A(),M.value.forEach((t,a)=>{ho.fromTo(t,{opacity:0,x:-20},{opacity:1,x:0,ease:"power2.out",scrollTrigger:{trigger:t,scroller:e,start:"top 90%",once:!0},delay:.05*a})})}),r(()=>{vo.ScrollTrigger.getAll().forEach(e=>e.kill())}),(e,t)=>(w(),i("div",go,[t[19]||(t[19]=s("div",{class:"bg-noise"},null,-1)),T.value?(w(),i("div",{key:0,ref_key:"loaderRef",ref:o,class:"loader"},[...t[3]||(t[3]=[s("h1",{class:"loader-text"},"LOADING...",-1)])],512)):l("",!0),s("nav",yo,[t[4]||(t[4]=s("div",{class:"nav-left"},[s("span",{class:"nav-brand font-mono"},"◆ Quantitative / Dashboard")],-1)),s("div",bo,[s("a",{href:"#tools",class:"nav-link font-oswald",onClick:t[0]||(t[0]=E(e=>C("tools"),["prevent"]))},"Инструменты"),s("a",{href:"#terminal",class:"nav-link font-oswald",onClick:t[1]||(t[1]=E(e=>C("terminal"),["prevent"]))},"Терминал")])]),s("main",xo,[s("section",{ref_key:"heroRef",ref:c,class:"hero"},[t[6]||(t[6]=s("div",{class:"hero-grid-overlay"},null,-1)),s("div",{ref_key:"heroContentRef",ref:u,class:"hero-content"},[s("h2",{ref_key:"heroSubtitleRef",ref:d,class:"hero-subtitle font-mono"},"Quantitative Dashboard",512),s("div",wo,[s("h1",{ref_key:"heroTitle1Ref",ref:h,class:"hero-title hero-title-top font-anton"},"ZETA",512),s("h1",{ref_key:"heroTitle2Ref",ref:g,class:"hero-title hero-title-bottom font-anton"},"TERMINAL",512)])],512),s("div",{ref_key:"heroBottomRef",ref:y,class:"hero-bottom font-oswald"},[...t[5]||(t[5]=[s("span",null,"◆ Finance",-1),s("span",null,"2026",-1),s("span",{class:"hide-mobile"},"Quantitative Analytics",-1)])],512),t[7]||(t[7]=s("div",{class:"hero-line hero-line-left"},null,-1)),t[8]||(t[8]=s("div",{class:"hero-line hero-line-right"},null,-1))],512),s("div",_o,[s("div",So,[(w(),i(p,null,f(5,e=>s("span",{key:"r"+e,class:"font-anton"},"STOCHASTIC ANALYSIS — QUANTITATIVE ANALYTICS — DERIVATIVES — BONDS — SWAPS — FORWARDS — OPTIONS — MARKET REGIMES — P&L CALCULATIONS — RISK-MANAGEMENT — ")),64))])]),s("section",Mo,[s("div",To,[t[12]||(t[12]=I('<div class="about-left" data-v-3c1182d1><div class="about-sticky" data-v-3c1182d1><h2 class="about-title font-anton" data-v-3c1182d1>QUANTITATIVE<br data-v-3c1182d1>RISK<br data-v-3c1182d1>MANAGEMENT</h2><div class="about-divider" data-v-3c1182d1></div><div class="about-meta font-mono" data-v-3c1182d1><p data-v-3c1182d1>ИНСТРУМЕНТОВ: 27</p><p data-v-3c1182d1>МОДЕЛЕЙ: 8+</p></div></div></div>',1)),s("div",ko,[s("div",{ref_key:"aboutBlock1",ref:b,class:"about-block"},[...t[9]||(t[9]=[s("p",{class:"about-intro font-oswald"},"Платформа стохастического моделирования для количественного анализа финансовых рынков, ценообразования деривативов и управления рисками.",-1),s("p",{class:"about-body font-mono"},"Дзета Терминал объединяет классические модели ценообразования с современными вычислительными методами. Модели Блэка-Шоулза-Мертона и Хестона, Случайные процессы Леви, 2D и 3D симуляции Монте-Карло, тепловые карты активов — все инструменты доступны в едином интерфейсе.",-1)])],512),s("div",{ref_key:"aboutBlock2",ref:_,class:"about-block about-quote"},[...t[10]||(t[10]=[s("p",{class:"about-quote-text font-anton"},"КОЛИЧЕСТВЕННАЯ АНАЛИТИКА И СТОХАСТИЧЕСКОЕ МОДЕЛИРОВАНИЕ НА УРОВНЕ ИНСТИТУЦИОНАЛЬНЫХ ПЛАТФОРМ",-1)])],512),s("div",{ref_key:"aboutBlock3",ref:S,class:"about-block about-cols"},[...t[11]||(t[11]=[s("div",null,[s("h3",{class:"about-col-title font-oswald"},"Ценообразование"),s("p",{class:"about-col-body font-mono"},"Модели Black-Scholes-Merton и Heston, SABR, FFT-методы, Поверхность волатильности. Полный стек для опционов, свопов, форвардов и структурных продуктов.")],-1),s("div",null,[s("h3",{class:"about-col-title font-oswald"},"Риск-менеджмент"),s("p",{class:"about-col-body font-mono"},"VaR, Expected Shortfall, стресс-тестирование, бэктестинг, греки, режимы рынка через Скрытые Марковские цепи и Комплексный анализ. Портфельная оптимизация по модели Хэмилтона-Якоби-Беллмана и CCMV оптимизация")],-1)])],512)])])]),s("div",Co,[s("div",Ao,[(w(),i(p,null,f(5,e=>s("span",{key:"d"+e,class:"font-anton"},"BLACK-SCHOLES-MERTON MODEL — HESTON MODEL — MONTE CARLO SIMULATION — FAST FOURIER TRANSFORM — DCF — ZCYC — LÉVY RANDOM PROCESSES — ")),64))])]),s("section",Eo,[t[16]||(t[16]=s("div",{class:"tools-bg-text font-anton"},[m(" QQQQQQQ"),s("br"),m("UUUUUUU"),s("br"),m("AAAAAAA"),s("br"),m("NNNNNNN"),s("br"),m("TTTTTTT ")],-1)),s("div",Io,[t[15]||(t[15]=s("div",{class:"tools-header"},[s("h2",{class:"tools-title font-anton"},"Инструменты"),s("div",{class:"tools-underline"})],-1)),s("div",Ro,[(w(),i(p,null,f(k,(e,a)=>s("div",{key:e.path+a,ref_for:!0,ref_key:"toolRowRefs",ref:M,class:"tool-row",onClick:t=>R(e.path)},[s("div",Po,[s("span",Lo,v(String(a+1).padStart(2,"0")),1),t[13]||(t[13]=s("button",{class:"tool-play"},[s("span",null,"→")],-1)),s("div",No,[s("span",Oo,v(e.name),1),e.desc?(w(),i("span",Fo,v(e.desc),1)):l("",!0)])]),t[14]||(t[14]=s("span",{class:"tool-arrow font-mono"},"→",-1))],8,Do)),64))])])]),s("section",Bo,[s("div",{class:"terminal-card",onClick:t[2]||(t[2]=e=>R("/terminal"))},[...t[17]||(t[17]=[I('<div class="terminal-zeta font-anton" data-v-3c1182d1>ζ</div><div class="terminal-info" data-v-3c1182d1><div class="terminal-title font-oswald" data-v-3c1182d1>Терминал</div><div class="terminal-sub font-mono" data-v-3c1182d1>Данные с бирж · Акции · Крипто · Фьючерсы · Опционы</div></div><div class="terminal-cta font-oswald" data-v-3c1182d1>Открыть →</div>',3)])])]),t[18]||(t[18]=I('<footer class="footer" data-v-3c1182d1><div class="footer-inner" data-v-3c1182d1><div class="footer-main" data-v-3c1182d1><h2 class="footer-title font-anton" data-v-3c1182d1>ZETA-TERMINAL</h2><p class="footer-subtitle font-oswald" data-v-3c1182d1>Quantitative Analytics Platform</p></div><div class="footer-credits" data-v-3c1182d1><div class="footer-col" data-v-3c1182d1><h4 class="footer-col-head" data-v-3c1182d1>Platform</h4><p class="font-mono" data-v-3c1182d1>Vue 3 / TypeScript</p><p class="font-mono" data-v-3c1182d1>GSAP / ECharts</p><p class="font-mono" data-v-3c1182d1>Three.js</p></div></div></div><div class="footer-bottom font-mono" data-v-3c1182d1><span data-v-3c1182d1>© 2026 Zeta Terminal</span><span data-v-3c1182d1>Quantitative Analytics</span></div></footer>',1))])]))}}),Vo=xe(zo,[["__scopeId","data-v-3c1182d1"]]);function Ho(){const e=t("undefined"!=typeof window?window.innerWidth:1024),a=S(()=>e.value<768),i=S(()=>e.value>=768&&e.value<1024),o=S(()=>e.value<480),s=S(()=>e.value<375),l=S(()=>e.value>=1024),c=()=>{e.value=window.innerWidth};return n(()=>{window.addEventListener("resize",c,{passive:!0})}),r(()=>{window.removeEventListener("resize",c)}),{windowWidth:e,isMobile:a,isTablet:i,isSmallMobile:o,isTinyMobile:s,isDesktop:l}}const Go={class:"correlation-scatter-3d"},Wo={class:"main-layout"},qo={class:"controls-column"},Yo={class:"control-panel"},jo={class:"controls-two-column"},Xo={class:"controls-col-1"},$o={class:"control-group"},Ko=["value"],Zo={class:"control-group"},Jo=["value"],Qo={class:"control-group"},es=["value"],ts={class:"control-group full-width"},as=["max"],ns={class:"controls-col-2"},rs={class:"control-group"},is={class:"toggle-buttons"},os={class:"control-group"},ss={class:"toggle-buttons"},ls={class:"controls-row regime-row"},cs=["value"],us={class:"control-group"},ds={class:"dropdown-controls"},hs={width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ps=["d"],fs={class:"dropdown-content"},ms={class:"checkbox-item"},vs={class:"checkbox-item"},gs={class:"checkbox-item"},ys={class:"checkbox-item"},bs={class:"checkbox-item"},xs={class:"checkbox-item"},ws={key:0,class:"controls-row playback-controls"},_s={class:"speed-label"},Ss={class:"stats-panel"},Ms={class:"stats-section"},Ts={class:"correlation-stats"},ks={class:"stat-item"},Cs={class:"stat-label-large"},As={class:"stat-value-large"},Es={class:"stat-item"},Is={class:"stat-label-large"},Rs={class:"stat-value-large"},Ds={class:"stat-item"},Ps={class:"stat-label-large"},Ls={class:"stat-value-large"},Ns={class:"stats-section"},Os={class:"stats-grid-compact"},Fs={class:"stat-label-large"},Bs={class:"stat-details-large"},Us={class:"plot-column"},zs={key:0,class:"loading-overlay"},Vs=e({__name:"CorrelationScatter3D",props:{availableAssets:{}},setup(e){const a=e,o=t(null),u=t(!0),d=t(null),{isMobile:h}=Ho(),g=t(a.availableAssets||["SPY","TLT","GLD","QQQ","BTC"]),b=t([g.value[0],g.value[1],g.value[2]]),x=t(h.value?"2d":"3d"),_=t("correlation"),M=t(0),C=t(["",""]),A=t(["low","medium","high"]),E=t(!1),I=t(!1),N=t(!1),O=t(!1),F=t(!1),B=t(!0),U=t(!1),z=t(!1),V=t(0),H=t(1);let G=null;const W=t([]),q=S(()=>W.value.filter((e,t)=>!(t<M.value)&&A.value.includes(e.regime))),Y=[{id:"low",name:"Low",color:"#10b981"},{id:"medium",name:"Medium",color:"#fbbf24"},{id:"high",name:"High",color:"#ef4444"}],j=t([{mean:0,std:0,min:0,max:0},{mean:0,std:0,min:0,max:0},{mean:0,std:0,min:0,max:0}]),X=t([[1,0,0],[0,1,0],[0,0,1]]),$=t([]),K=t([]),Z=async()=>{if(console.log("CorrelationScatter3D: updatePlot called",{hasPlotly:!!d.value,hasContainer:!!o.value,dataLength:q.value.length}),!d.value)return void console.error("CorrelationScatter3D: Plotly not loaded");if(!o.value)return void console.error("CorrelationScatter3D: Container not found");const e=q.value;if(0===e.length)return void console.warn("CorrelationScatter3D: No data to plot");console.log("CorrelationScatter3D: Plotting",e.length,"data points"),"pca"===_.value&&(e=>{if(0===e.length)return;const t=b.value[0],a=b.value[1],n=b.value[2],r=e.map(e=>e.returns[t]||0),i=e.map(e=>e.returns[a]||0),o=e.map(e=>e.returns[n]||0),s=e.length,l=r.reduce((e,t)=>e+t,0)/s,c=i.reduce((e,t)=>e+t,0)/s,u=o.reduce((e,t)=>e+t,0)/s,d=r.reduce((e,t)=>e+(t-l)**2,0)/s,h=i.reduce((e,t)=>e+(t-c)**2,0)/s;o.reduce((e,t)=>e+(t-u)**2,0);const p=r.reduce((e,t,a)=>e+(t-l)*(i[a]-c),0)/s;r.reduce((e,t,a)=>e+(t-l)*(o[a]-u),0),i.reduce((e,t,a)=>e+(t-c)*(o[a]-u),0);const f=[[d,p],[p,h]],m=f[0][0]+f[1][1],v=m**2-4*(f[0][0]*f[1][1]-f[0][1]**2);if(v<0)return;const g=(m+Math.sqrt(v))/2,y=(m-Math.sqrt(v))/2,x=[f[0][1],g-f[0][0]],w=Math.sqrt(x[0]**2+x[1]**2);w>0&&(x[0]/=w,x[1]/=w);const _=[f[0][1],y-f[0][0]],S=Math.sqrt(_[0]**2+_[1]**2);S>0&&(_[0]/=S,_[1]/=S),$.value=e.map((e,t)=>{const a=r[t]-l,n=i[t]-c,s=o[t]-u;return[a*x[0]+n*x[1],a*_[0]+n*_[1],s]})})(e),O.value&&((e,t=3)=>{const a=b.value[0],n=b.value[1],r=b.value[2],i=e.map(e=>[e.returns[a]||0,e.returns[n]||0,e.returns[r]||0]);if(0===i.length)return;let o=[];for(let c=0;c<t;c++){const e=Math.floor(Math.random()*i.length);o.push([...i[e]])}let s=[],l=0;for(;l<100;){s=i.map(e=>{let t=1/0,a=0;return o.forEach((n,r)=>{const i=Math.sqrt((e[0]-n[0])**2+(e[1]-n[1])**2+(e[2]-n[2])**2);i<t&&(t=i,a=r)}),a});const e=Array(t).fill(null).map(()=>[0,0,0]),a=Array(t).fill(0);i.forEach((t,n)=>{const r=s[n];e[r][0]+=t[0],e[r][1]+=t[1],e[r][2]+=t[2],a[r]++});let n=!0;if(e.forEach((e,t)=>{if(a[t]>0){e[0]/=a[t],e[1]/=a[t],e[2]/=a[t];const r=o[t];Math.sqrt((e[0]-r[0])**2+(e[1]-r[1])**2+(e[2]-r[2])**2)>.001&&(n=!1)}}),n)break;o=e,l++}K.value=s})(e,3),(()=>{const e=b.value[0],t=b.value[1],a=b.value[2],n=q.value.map(t=>100*(t.returns[e]||0)),r=q.value.map(e=>100*(e.returns[t]||0)),i=q.value.map(e=>100*(e.returns[a]||0)),o=e=>{if(0===e.length)return{mean:0,std:0,min:0,max:0};const t=e.reduce((e,t)=>e+t,0)/e.length,a=e.reduce((e,a)=>e+(a-t)**2,0)/e.length,n=Math.sqrt(a);return{mean:t,std:n,min:Math.min(...e),max:Math.max(...e)}};j.value=[o(n),o(r),o(i)];const s=q.value.length;if(s>1){const n=j.value[0].mean/100,r=j.value[1].mean/100,i=j.value[2].mean/100,o=j.value[0].std/100,l=j.value[1].std/100,c=j.value[2].std/100,u=q.value.reduce((a,i)=>a+((i.returns[e]||0)-n)*((i.returns[t]||0)-r),0)/(s*o*l),d=q.value.reduce((t,r)=>t+((r.returns[e]||0)-n)*((r.returns[a]||0)-i),0)/(s*o*c),h=q.value.reduce((e,n)=>e+((n.returns[t]||0)-r)*((n.returns[a]||0)-i),0)/(s*l*c);X.value=[[1,u,d],[u,1,h],[d,h,1]]}})();const t=b.value[0],a=b.value[1],n=b.value[2];let r,i,s;"pca"===_.value&&$.value.length>0?(r=$.value.map(e=>100*e[0]),i=$.value.map(e=>100*e[1]),s=$.value.map(e=>100*e[2])):(r=e.map(e=>100*(e.returns[t]||0)),i=e.map(e=>100*(e.returns[a]||0)),s=e.map(e=>100*(e.returns[n]||0)));const l=e.map(e=>{const t=Y.find(t=>t.id===e.regime);return t?t.color:"#888"}),c=e.map(e=>Math.sqrt(e.volume/1e4)),u=e.map((e,o)=>`${e.date}<br>${t}: ${r[o].toFixed(2)}%<br>${a}: ${i[o].toFixed(2)}%<br>${n}: ${s[o].toFixed(2)}%<br>Режим: ${Y.find(t=>t.id===e.regime)?.name||e.regime}`),h=[],p=j.value[0],f=j.value[1],m=j.value[2];e.forEach((e,t)=>{const a=Math.abs(r[t]-p.mean)>3*p.std||Math.abs(i[t]-f.mean)>3*f.std||Math.abs(s[t]-m.mean)>3*m.std;h.push(a)});const v=[];if(Y.forEach(t=>{if(!A.value.includes(t.id))return;const a=e.map((e,t)=>({d:e,i:t})).filter(({d:e})=>e.regime===t.id).map(({i:e})=>e);if(0===a.length)return;a.map(e=>r[e]),a.map(e=>i[e]),a.map(e=>s[e]),a.map(e=>l[e]),a.map(e=>c[e]),a.map(e=>u[e]);const n=a.map(e=>h[e]),o=a.filter((e,t)=>!n[t]||!B.value);if(o.length>0&&v.push({x:o.map(e=>r[e]),y:o.map(e=>i[e]),z:"3d"===x.value?o.map(e=>s[e]):void 0,mode:E.value?"lines+markers":"markers",type:"3d"===x.value?"scatter3d":"scatter",name:t.name,marker:{color:t.color,size:o.map(e=>c[e]),sizeref:.1,sizemode:"diameter",opacity:.7,line:{color:"rgba(0,0,0,0.2)",width:1}},line:E.value?{color:t.color,width:1,opacity:.3}:void 0,text:o.map(e=>u[e]),hovertemplate:"<b>%{text}</b><extra></extra>",showlegend:!1}),B.value){const e=a.filter((e,t)=>n[t]);e.length>0&&v.push({x:e.map(e=>r[e]),y:e.map(e=>i[e]),z:"3d"===x.value?e.map(e=>s[e]):void 0,mode:"markers",type:"3d"===x.value?"scatter3d":"scatter",name:`${t.name} (Outliers)`,marker:{color:"#ff00ff",size:12,symbol:"x",opacity:.9,line:{color:"#fff",width:2}},text:e.map(e=>u[e]),hovertemplate:"<b>%{text}</b><br><b>OUTLIER</b><extra></extra>",showlegend:!1})}}),E.value&&e.length>1&&v.push({x:r,y:i,z:"3d"===x.value?s:void 0,mode:"lines",type:"3d"===x.value?"scatter3d":"scatter",name:"Траектория",line:{color:"rgba(255,255,255,0.2)",width:2},showlegend:!1,hoverinfo:"skip"}),I.value&&Y.forEach(r=>{if(!A.value.includes(r.id))return;const i=e.filter(e=>e.regime===r.id);if(i.length<3)return;const o=i.map(e=>100*(e.returns[t]||0)),s=i.map(e=>100*(e.returns[a]||0)),l=i.map(e=>100*(e.returns[n]||0)),c=o.reduce((e,t)=>e+t,0)/o.length,u=s.reduce((e,t)=>e+t,0)/s.length,d=l.reduce((e,t)=>e+t,0)/l.length,h=Math.sqrt(o.reduce((e,t)=>e+(t-c)**2,0)/o.length),p=Math.sqrt(s.reduce((e,t)=>e+(t-u)**2,0)/s.length);if(Math.sqrt(l.reduce((e,t)=>e+(t-d)**2,0)/l.length),"2d"===x.value){const e=Array.from({length:50},(e,t)=>t/50*2*Math.PI),t=e.map(e=>c+2*h*Math.cos(e)),a=e.map(e=>u+2*p*Math.sin(e));v.push({x:t,y:a,mode:"lines",type:"scatter",name:`${r.name} Ellipse`,line:{color:r.color,width:1,dash:"dash"},showlegend:!1,hoverinfo:"skip"})}}),N.value&&"2d"===x.value){const e=r.length,t=r.reduce((e,t)=>e+t,0),a=i.reduce((e,t)=>e+t,0),n=r.reduce((e,t,a)=>e+t*i[a],0),o=r.reduce((e,t)=>e+t*t,0),s=(e*n-t*a)/(e*o-t*t),l=(a-s*t)/e,c=[Math.min(...r),Math.max(...r)],u=c.map(e=>s*e+l);v.push({x:c,y:u,mode:"lines",type:"scatter",name:"Регрессия",line:{color:"rgba(96, 165, 250, 0.5)",width:2,dash:"dot"},showlegend:!1,hoverinfo:"skip"})}F.value&&Y.forEach(r=>{if(!A.value.includes(r.id))return;const i=e.filter(e=>e.regime===r.id);if(0===i.length)return;const o=i.reduce((e,a)=>e+100*(a.returns[t]||0),0)/i.length,s=i.reduce((e,t)=>e+100*(t.returns[a]||0),0)/i.length,l=i.reduce((e,t)=>e+100*(t.returns[n]||0),0)/i.length;v.push({x:[o],y:[s],z:"3d"===x.value?[l]:void 0,mode:"markers",type:"3d"===x.value?"scatter3d":"scatter",name:`${r.name} Центроид`,marker:{color:r.color,size:20,symbol:"diamond",line:{color:"#fff",width:2}},showlegend:!1,hoverinfo:"skip"})});const g={paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{color:"#fff",family:"system-ui"},margin:{l:50,r:20,t:20,b:40},showlegend:!1,autosize:!0,height:void 0};"3d"===x.value?g.scene={xaxis:{title:`${t} Доходность (%)`,backgroundcolor:"rgba(0,0,0,0)",gridcolor:"rgba(255,255,255,0.15)",showbackground:!0,titlefont:{color:"rgba(255,255,255,0.9)",size:12},tickfont:{size:10,color:"rgba(255,255,255,0.6)"}},yaxis:{title:`${a} Доходность (%)`,backgroundcolor:"rgba(0,0,0,0)",gridcolor:"rgba(255,255,255,0.15)",showbackground:!0,titlefont:{color:"rgba(255,255,255,0.9)",size:12},tickfont:{size:10,color:"rgba(255,255,255,0.6)"}},zaxis:{title:`${n} Доходность (%)`,backgroundcolor:"rgba(0,0,0,0)",gridcolor:"rgba(255,255,255,0.15)",showbackground:!0,titlefont:{color:"rgba(255,255,255,0.9)",size:12},tickfont:{size:10,color:"rgba(255,255,255,0.6)"}},bgcolor:"rgba(0,0,0,0)",camera:{eye:{x:1.6,y:1.6,z:1.2},center:{x:0,y:0,z:0},up:{x:0,y:0,z:1}},aspectratio:{x:1,y:1,z:1},aspectmode:"cube"}:(g.xaxis={title:`${t} Доходность (%)`,gridcolor:"rgba(255,255,255,0.1)",titlefont:{color:"rgba(255,255,255,0.9)",size:12},tickfont:{size:10,color:"rgba(255,255,255,0.6)"}},g.yaxis={title:`${a} Доходность (%)`,gridcolor:"rgba(255,255,255,0.1)",titlefont:{color:"rgba(255,255,255,0.9)",size:12},tickfont:{size:10,color:"rgba(255,255,255,0.6)"}});const y={responsive:!0,displayModeBar:!0,displaylogo:!1,modeBarButtonsToRemove:["lasso2d","select2d"],modeBarButtonsToAdd:[],toImageButtonOptions:{format:"png",filename:"correlation_scatter",height:800,width:1200,scale:2}};if(d.value&&o.value){if(console.log("CorrelationScatter3D: Creating plot with",v.length,"traces"),console.log("CorrelationScatter3D: Container dimensions:",o.value.clientWidth,o.value.clientHeight),0===o.value.clientWidth||0===o.value.clientHeight){if(console.warn("CorrelationScatter3D: Container has zero dimensions, waiting for layout..."),await new Promise(e=>requestAnimationFrame(e)),0===o.value.clientWidth||0===o.value.clientHeight)return void console.error("CorrelationScatter3D: Container still has zero dimensions after wait");console.log("CorrelationScatter3D: Container dimensions after wait:",o.value.clientWidth,o.value.clientHeight)}try{await d.value.newPlot(o.value,v,g,y),console.log("CorrelationScatter3D: Plot created successfully"),d.value.Plots&&o.value&&d.value.Plots.resize(o.value)}catch(QXe){console.error("CorrelationScatter3D: Error creating plot:",QXe)}}else console.error("CorrelationScatter3D: Cannot create plot - missing Plotly or container")},J=()=>{const e=W.value;if(0===e.length)return;const t=M.value;C.value=[e[t]?.date||"",e[e.length-1]?.date||""],Z()},Q=()=>{if(z.value=!z.value,z.value){const e=()=>{if(z.value){if(V.value+=H.value,V.value>=100)return V.value=100,void(z.value=!1);M.value=Math.floor(V.value/100*(W.value.length-1)),J(),z.value&&(G=window.setTimeout(e,100))}};e()}else G&&(clearTimeout(G),G=null)},ee=()=>{M.value=Math.floor(V.value/100*(W.value.length-1)),J()},te=()=>{d.value&&o.value&&(M.value=0,V.value=0,z.value=!1,G&&(clearTimeout(G),G=null),J(),d.value.relayout(o.value,{"scene.camera.eye":{x:1.6,y:1.6,z:1.2},"scene.camera.center":{x:0,y:0,z:0}}))};return n(async()=>{u.value=!0,console.log("CorrelationScatter3D: Initializing...");try{const e=await(async()=>{if("undefined"==typeof window)return console.error("Window is undefined"),null;if(window.Plotly)return d.value=window.Plotly,console.log("Plotly already loaded in CorrelationScatter3D"),d.value;if(document.querySelector('script[src*="plotly"]'))return new Promise(e=>{const t=setInterval(()=>{window.Plotly&&(clearInterval(t),d.value=window.Plotly,console.log("Plotly loaded from existing script in CorrelationScatter3D"),e(d.value))},100);setTimeout(()=>{clearInterval(t),console.error("Plotly script timeout in CorrelationScatter3D"),e(null)},1e4)});const e=document.createElement("script");return e.src="https://cdn.plot.ly/plotly-latest.min.js",e.async=!0,e.crossOrigin="anonymous",new Promise((t,a)=>{e.onload=()=>{window.Plotly?(d.value=window.Plotly,console.log("Plotly loaded successfully in CorrelationScatter3D"),t(d.value)):(console.error("Plotly not found after script load in CorrelationScatter3D"),a(new Error("Plotly not found")))},e.onerror=e=>{console.error("Failed to load Plotly script in CorrelationScatter3D:",e),a(e)},document.head.appendChild(e)})})();if(!e)return console.error("CorrelationScatter3D: Plotly not loaded"),void(u.value=!1);d.value=e,console.log("CorrelationScatter3D: Plotly loaded successfully"),W.value=(()=>{const e=[],t=new Date("2024-01-01"),a={SPY:{TLT:-.35,GLD:.15,QQQ:.92,BTC:.45},TLT:{SPY:-.35,GLD:.25,QQQ:-.42,BTC:-.15},GLD:{SPY:.15,TLT:.25,QQQ:.1,BTC:.2},QQQ:{SPY:.92,TLT:-.42,GLD:.1,BTC:.55},BTC:{SPY:.45,TLT:-.15,GLD:.2,QQQ:.55}},n={low:{vol:.008,trend:.001},medium:{vol:.015,trend:5e-4},high:{vol:.03,trend:-.001}};let r="low",i=0,o=30+60*Math.random();const s={};g.value.forEach(e=>{s[e]=[]});for(let l=0;l<252;l++){if(i++,i>o){const e=Math.random();r="low"===r?e>.7?"high":"medium":"medium"===r?e>.6?"high":"low":e>.7?"low":"medium",i=0,o=30+60*Math.random()}const c=n[r],u={},d=g.value[0],h=(Math.random()-.5)*c.vol*2+c.trend;s[d].push(h),u[d]=h;for(let e=1;e<g.value.length;e++){const t=g.value[e],n=g.value[e-1],r=a[n]?.[t]||0,i=(Math.random()-.5)*c.vol*2,o=r*s[n][l]+Math.sqrt(1-r*r)*i+c.trend;s[t].push(o),u[t]=o}const p=new Date(t);p.setDate(p.getDate()+l),e.push({date:p.toISOString().split("T")[0],returns:u,regime:r,volume:1e6*Math.random()+1e5,index:l})}return e})(),console.log("CorrelationScatter3D: Generated",W.value.length,"data points"),W.value.length>0&&(M.value=0,C.value=[W.value[0].date,W.value[W.value.length-1].date]),await new Promise(e=>setTimeout(e,100)),await Z(),console.log("CorrelationScatter3D: Initial plot created"),u.value=!1}catch(QXe){console.error("CorrelationScatter3D: Error during initialization:",QXe),u.value=!1}let e=null;const t=()=>{e&&clearTimeout(e),e=window.setTimeout(()=>{d.value&&o.value&&d.value.Plots.resize(o.value)},250)};window.addEventListener("resize",t),setTimeout(()=>{d.value&&o.value&&d.value.Plots.resize(o.value)},500),r(()=>{window.removeEventListener("resize",t),e&&clearTimeout(e),G&&clearTimeout(G)})}),R(()=>b.value,()=>{Z()},{deep:!0}),(e,t)=>(w(),i("div",Go,[s("div",Wo,[s("div",qo,[s("div",Yo,[s("div",jo,[s("div",Xo,[s("div",$o,[t[18]||(t[18]=s("label",null,"Актив 1 (X):",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value[0]=e),onChange:Z},[(w(!0),i(p,null,f(g.value,e=>(w(),i("option",{key:e,value:e},v(e),9,Ko))),128))],544),[[D,b.value[0]]])]),s("div",Zo,[t[19]||(t[19]=s("label",null,"Актив 2 (Y):",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>b.value[1]=e),onChange:Z},[(w(!0),i(p,null,f(g.value,e=>(w(),i("option",{key:e,value:e},v(e),9,Jo))),128))],544),[[D,b.value[1]]])]),s("div",Qo,[t[20]||(t[20]=s("label",null,"Актив 3 (Z):",-1)),T(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>b.value[2]=e),onChange:Z},[(w(!0),i(p,null,f(g.value,e=>(w(),i("option",{key:e,value:e},v(e),9,es))),128))],544),[[D,b.value[2]]])]),s("div",ts,[s("label",null,"Период: "+v(C.value[0])+" - "+v(C.value[1]),1),T(s("input",{type:"range",min:0,max:q.value.length-1,"onUpdate:modelValue":t[3]||(t[3]=e=>M.value=e),onInput:J,class:"time-slider full-width-slider"},null,40,as),[[k,M.value]])]),s("button",{class:"btn-reset full-width",onClick:te},[...t[21]||(t[21]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),m(" Сброс ",-1)])])]),s("div",ns,[s("div",rs,[t[22]||(t[22]=s("label",null,"Режим:",-1)),s("div",is,[s("button",{class:c(["toggle-btn",{active:"3d"===x.value}]),onClick:t[4]||(t[4]=e=>{x.value="3d",Z()})}," 3D ",2),s("button",{class:c(["toggle-btn",{active:"2d"===x.value}]),onClick:t[5]||(t[5]=e=>{x.value="2d",Z()})}," 2D ",2)])]),s("div",os,[t[23]||(t[23]=s("label",null,"Пространство:",-1)),s("div",ss,[s("button",{class:c(["toggle-btn",{active:"correlation"===_.value}]),onClick:t[6]||(t[6]=e=>{_.value="correlation",Z()})}," Correlation ",2),s("button",{class:c(["toggle-btn",{active:"pca"===_.value}]),onClick:t[7]||(t[7]=e=>{_.value="pca",Z()})}," PCA ",2)])])])]),s("div",ls,[t[24]||(t[24]=s("label",{class:"regime-filter-label"},"Режимы:",-1)),(w(),i(p,null,f(Y,e=>s("label",{class:"regime-checkbox",key:e.id},[T(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[8]||(t[8]=e=>A.value=e),onChange:Z},null,40,cs),[[L,A.value]]),s("span",{class:"regime-dot",style:y({backgroundColor:e.color})},null,4),m(" "+v(e.name),1)])),64))]),s("div",us,[s("div",ds,[s("button",{class:"dropdown-toggle",onClick:t[9]||(t[9]=e=>U.value=!U.value)},[t[25]||(t[25]=s("span",null,"Дополнительные настройки",-1)),(w(),i("svg",hs,[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:U.value?"M5 15l7-7 7 7":"M19 9l-7 7-7-7"},null,8,ps)]))]),T(s("div",fs,[s("label",ms,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>E.value=e),onChange:Z},null,544),[[L,E.value]]),t[26]||(t[26]=s("span",null,"Траектория",-1))]),s("label",vs,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>N.value=e),onChange:Z},null,544),[[L,N.value]]),t[27]||(t[27]=s("span",null,"Регрессии",-1))]),s("label",gs,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>B.value=e),onChange:Z},null,544),[[L,B.value]]),t[28]||(t[28]=s("span",null,"Outliers",-1))]),s("label",ys,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=e=>I.value=e),onChange:Z},null,544),[[L,I.value]]),t[29]||(t[29]=s("span",null,"Эллипсоиды",-1))]),s("label",bs,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=e=>O.value=e),onChange:Z},null,544),[[L,O.value]]),t[30]||(t[30]=s("span",null,"Кластеры",-1))]),s("label",xs,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=e=>F.value=e),onChange:Z},null,544),[[L,F.value]]),t[31]||(t[31]=s("span",null,"Центроиды",-1))])],512),[[P,U.value]])])]),E.value?(w(),i("div",ws,[s("button",{class:c(["btn-playback",{active:z.value}]),onClick:Q},v(z.value?"⏸":"▶"),3),T(s("input",{type:"range",min:0,max:100,"onUpdate:modelValue":t[16]||(t[16]=e=>V.value=e),onInput:ee,class:"playback-slider"},null,544),[[k,V.value]]),T(s("input",{type:"range",min:1,max:10,"onUpdate:modelValue":t[17]||(t[17]=e=>H.value=e),class:"speed-slider",title:"Speed"},null,512),[[k,H.value]]),s("span",_s,v(H.value)+"x",1)])):l("",!0)]),s("div",Ss,[s("div",Ms,[t[32]||(t[32]=s("h4",null,"Корреляции",-1)),s("div",Ts,[s("div",ks,[s("span",Cs,v(b.value[0])+" ↔ "+v(b.value[1]),1),s("span",As,v(X.value[0][1].toFixed(3)),1)]),s("div",Es,[s("span",Is,v(b.value[0])+" ↔ "+v(b.value[2]),1),s("span",Rs,v(X.value[0][2].toFixed(3)),1)]),s("div",Ds,[s("span",Ps,v(b.value[1])+" ↔ "+v(b.value[2]),1),s("span",Ls,v(X.value[1][2].toFixed(3)),1)])])]),s("div",Ns,[t[33]||(t[33]=s("h4",null,"Статистика",-1)),s("div",Os,[(w(!0),i(p,null,f(j.value,(e,t)=>(w(),i("div",{class:"stat-item-compact",key:t},[s("span",Fs,v(b.value[t]),1),s("div",Bs,[s("span",null,"μ: "+v(e.mean.toFixed(2))+"%",1),s("span",null,"σ: "+v(e.std.toFixed(2))+"%",1)])]))),128))])])])]),s("div",Us,[u.value?(w(),i("div",zs,[...t[34]||(t[34]=[s("div",{class:"spinner-large"},null,-1),s("p",null,"Загрузка данных...",-1)])])):l("",!0),s("div",{ref_key:"plotContainer",ref:o,class:"plot-container"},null,512)])])]))}}),Hs=xe(Vs,[["__scopeId","data-v-ef488a4f"]]),Gs={portfolio1:[{symbol:"SBER",name:"Сбербанк",price:"285.50",dayChange:1.24,notional:85e4,allocation:12,targetAllocation:10,color:"#3b82f6"},{symbol:"GAZP",name:"Газпром",price:"187.30",dayChange:-.48,notional:72e4,allocation:10,targetAllocation:12,color:"#10b981"},{symbol:"LKOH",name:"Лукойл",price:"7456.75",dayChange:.92,notional:65e4,allocation:9,targetAllocation:8,color:"#fbbf24"},{symbol:"GMKN",name:"Норникель",price:"18420.20",dayChange:-.15,notional:58e4,allocation:8,targetAllocation:9,color:"#8b5cf6"},{symbol:"YNDX",name:"Яндекс",price:"3254.48",dayChange:2.15,notional:51e4,allocation:7,targetAllocation:6,color:"#ec4899"},{symbol:"ROSN",name:"Роснефть",price:"456.80",dayChange:1.05,notional:48e4,allocation:6,targetAllocation:7,color:"#ef4444"},{symbol:"NVTK",name:"Новатэк",price:"1234.50",dayChange:-.32,notional:45e4,allocation:6,targetAllocation:5,color:"#06b6d4"},{symbol:"TATN",name:"Татнефть",price:"567.90",dayChange:.78,notional:42e4,allocation:5,targetAllocation:6,color:"#84cc16"},{symbol:"ALRS",name:"Алроса",price:"89.45",dayChange:-.12,notional:38e4,allocation:5,targetAllocation:4,color:"#f97316"},{symbol:"MGNT",name:"Магнит",price:"6789.00",dayChange:1.45,notional:35e4,allocation:4,targetAllocation:5,color:"#a855f7"},{symbol:"MOEX",name:"Московская биржа",price:"234.56",dayChange:.67,notional:32e4,allocation:4,targetAllocation:4,color:"#14b8a6"},{symbol:"POLY",name:"Полиметалл",price:"456.78",dayChange:-.89,notional:3e5,allocation:4,targetAllocation:3,color:"#eab308"},{symbol:"CHMF",name:"Северсталь",price:"1234.56",dayChange:1.23,notional:28e4,allocation:3,targetAllocation:4,color:"#22c55e"},{symbol:"PLZL",name:"Полюс",price:"9876.54",dayChange:-.45,notional:26e4,allocation:3,targetAllocation:3,color:"#3b82f6"},{symbol:"VTBR",name:"ВТБ",price:"0.0234",dayChange:.12,notional:24e4,allocation:3,targetAllocation:2,color:"#10b981"},{symbol:"SU26238",name:"ОФЗ 26238",price:"98.50",dayChange:.15,notional:22e4,allocation:3,targetAllocation:3,color:"#6366f1"},{symbol:"SU26239",name:"ОФЗ 26239",price:"99.20",dayChange:.08,notional:2e5,allocation:2,targetAllocation:3,color:"#8b5cf6"},{symbol:"SU26240",name:"ОФЗ 26240",price:"97.80",dayChange:-.05,notional:18e4,allocation:2,targetAllocation:2,color:"#a78bfa"},{symbol:"RU000A0ZZZN2",name:"Газпром обл",price:"101.50",dayChange:.22,notional:16e4,allocation:2,targetAllocation:2,color:"#c084fc"},{symbol:"RU000A0JX0J6",name:"Роснефть обл",price:"100.30",dayChange:.18,notional:14e4,allocation:2,targetAllocation:2,color:"#d946ef"},{symbol:"RU000A0JX0K4",name:"Лукойл обл",price:"99.90",dayChange:.12,notional:12e4,allocation:1,targetAllocation:2,color:"#ec4899"},{symbol:"RU000A0JX0L2",name:"Сбер обл",price:"102.10",dayChange:.25,notional:1e5,allocation:1,targetAllocation:1,color:"#f472b6"},{symbol:"RU000A0JX0M0",name:"ВТБ обл",price:"98.70",dayChange:.1,notional:9e4,allocation:1,targetAllocation:1,color:"#fb7185"},{symbol:"RU000A0JX0N8",name:"Альфа обл",price:"100.50",dayChange:.2,notional:8e4,allocation:1,targetAllocation:1,color:"#fda4af"},{symbol:"RU000A0JX0P3",name:"Россельхоз обл",price:"99.40",dayChange:.15,notional:7e4,allocation:1,targetAllocation:1,color:"#fecdd3"}],portfolio2:[{symbol:"SBER",name:"Сбербанк",price:"285.50",dayChange:1.24,notional:92e4,allocation:13,targetAllocation:11,color:"#3b82f6"},{symbol:"NLMK",name:"НЛМК",price:"145.30",dayChange:-.28,notional:68e4,allocation:9,targetAllocation:10,color:"#10b981"},{symbol:"RTKM",name:"Ростелеком",price:"89.45",dayChange:.65,notional:56e4,allocation:8,targetAllocation:8,color:"#fbbf24"},{symbol:"AFKS",name:"АФК Система",price:"12.34",dayChange:-.45,notional:48e4,allocation:7,targetAllocation:7,color:"#8b5cf6"},{symbol:"FIVE",name:"X5 Retail",price:"2345.67",dayChange:1.85,notional:42e4,allocation:6,targetAllocation:6,color:"#ec4899"},{symbol:"PHOR",name:"ФосАгро",price:"5678.90",dayChange:-.12,notional:38e4,allocation:5,targetAllocation:6,color:"#ef4444"},{symbol:"HYDR",name:"РусГидро",price:"0.678",dayChange:.34,notional:34e4,allocation:5,targetAllocation:5,color:"#06b6d4"},{symbol:"IRAO",name:"Интер РАО",price:"3.456",dayChange:-.23,notional:3e5,allocation:4,targetAllocation:4,color:"#84cc16"},{symbol:"FEES",name:"ФСК ЕЭС",price:"0.189",dayChange:.12,notional:28e4,allocation:4,targetAllocation:4,color:"#f97316"},{symbol:"SNGS",name:"Сургутнефтегаз",price:"45.67",dayChange:.89,notional:26e4,allocation:4,targetAllocation:3,color:"#a855f7"},{symbol:"SNGSP",name:"Сургутнефтегаз-п",price:"34.56",dayChange:.67,notional:24e4,allocation:3,targetAllocation:3,color:"#14b8a6"},{symbol:"AFLT",name:"Аэрофлот",price:"56.78",dayChange:-1.23,notional:22e4,allocation:3,targetAllocation:3,color:"#eab308"},{symbol:"PIKK",name:"ПИК",price:"890.12",dayChange:.45,notional:2e5,allocation:3,targetAllocation:2,color:"#22c55e"},{symbol:"LSRG",name:"ЛСР",price:"456.78",dayChange:-.34,notional:18e4,allocation:2,targetAllocation:2,color:"#3b82f6"},{symbol:"UPRO",name:"Юнипро",price:"12.34",dayChange:.56,notional:16e4,allocation:2,targetAllocation:2,color:"#10b981"},{symbol:"SU26241",name:"ОФЗ 26241",price:"98.90",dayChange:.18,notional:14e4,allocation:2,targetAllocation:2,color:"#6366f1"},{symbol:"SU26242",name:"ОФЗ 26242",price:"99.60",dayChange:.12,notional:12e4,allocation:2,targetAllocation:2,color:"#8b5cf6"},{symbol:"SU26243",name:"ОФЗ 26243",price:"97.50",dayChange:-.08,notional:1e5,allocation:1,targetAllocation:2,color:"#a78bfa"},{symbol:"RU000A0ZZZN3",name:"Газпром обл",price:"101.80",dayChange:.28,notional:9e4,allocation:1,targetAllocation:1,color:"#c084fc"},{symbol:"RU000A0JX0J7",name:"Роснефть обл",price:"100.60",dayChange:.22,notional:8e4,allocation:1,targetAllocation:1,color:"#d946ef"},{symbol:"RU000A0JX0K5",name:"Лукойл обл",price:"100.20",dayChange:.15,notional:7e4,allocation:1,targetAllocation:1,color:"#ec4899"},{symbol:"RU000A0JX0L3",name:"Сбер обл",price:"102.40",dayChange:.3,notional:6e4,allocation:1,targetAllocation:1,color:"#f472b6"},{symbol:"RU000A0JX0M1",name:"ВТБ обл",price:"99.00",dayChange:.12,notional:5e4,allocation:1,targetAllocation:1,color:"#fb7185"},{symbol:"RU000A0JX0N9",name:"Альфа обл",price:"100.80",dayChange:.25,notional:45e3,allocation:1,targetAllocation:1,color:"#fda4af"},{symbol:"RU000A0JX0P4",name:"Россельхоз обл",price:"99.70",dayChange:.18,notional:4e4,allocation:1,targetAllocation:1,color:"#fecdd3"}],portfolio3:[{symbol:"GAZP",name:"Газпром",price:"187.30",dayChange:-.48,notional:98e4,allocation:14,targetAllocation:12,color:"#10b981"},{symbol:"LKOH",name:"Лукойл",price:"7456.75",dayChange:.92,notional:78e4,allocation:11,targetAllocation:11,color:"#fbbf24"},{symbol:"GMKN",name:"Норникель",price:"18420.20",dayChange:-.15,notional:64e4,allocation:9,targetAllocation:9,color:"#8b5cf6"},{symbol:"YNDX",name:"Яндекс",price:"3254.48",dayChange:2.15,notional:52e4,allocation:7,targetAllocation:7,color:"#ec4899"},{symbol:"ROSN",name:"Роснефть",price:"456.80",dayChange:1.05,notional:46e4,allocation:6,targetAllocation:6,color:"#ef4444"},{symbol:"NVTK",name:"Новатэк",price:"1234.50",dayChange:-.32,notional:4e5,allocation:6,targetAllocation:5,color:"#06b6d4"},{symbol:"TATN",name:"Татнефть",price:"567.90",dayChange:.78,notional:36e4,allocation:5,targetAllocation:5,color:"#84cc16"},{symbol:"ALRS",name:"Алроса",price:"89.45",dayChange:-.12,notional:32e4,allocation:4,targetAllocation:4,color:"#f97316"},{symbol:"MGNT",name:"Магнит",price:"6789.00",dayChange:1.45,notional:3e5,allocation:4,targetAllocation:4,color:"#a855f7"},{symbol:"MOEX",name:"Московская биржа",price:"234.56",dayChange:.67,notional:28e4,allocation:4,targetAllocation:3,color:"#14b8a6"},{symbol:"POLY",name:"Полиметалл",price:"456.78",dayChange:-.89,notional:26e4,allocation:4,targetAllocation:3,color:"#eab308"},{symbol:"CHMF",name:"Северсталь",price:"1234.56",dayChange:1.23,notional:24e4,allocation:3,targetAllocation:3,color:"#22c55e"},{symbol:"PLZL",name:"Полюс",price:"9876.54",dayChange:-.45,notional:22e4,allocation:3,targetAllocation:3,color:"#3b82f6"},{symbol:"VTBR",name:"ВТБ",price:"0.0234",dayChange:.12,notional:2e5,allocation:3,targetAllocation:2,color:"#10b981"},{symbol:"NLMK",name:"НЛМК",price:"145.30",dayChange:-.28,notional:18e4,allocation:2,targetAllocation:2,color:"#6366f1"},{symbol:"SU26244",name:"ОФЗ 26244",price:"98.30",dayChange:.2,notional:16e4,allocation:2,targetAllocation:2,color:"#8b5cf6"},{symbol:"SU26245",name:"ОФЗ 26245",price:"99.10",dayChange:.14,notional:14e4,allocation:2,targetAllocation:2,color:"#a78bfa"},{symbol:"SU26246",name:"ОФЗ 26246",price:"97.20",dayChange:-.1,notional:12e4,allocation:2,targetAllocation:2,color:"#c084fc"},{symbol:"RU000A0ZZZN4",name:"Газпром обл",price:"102.10",dayChange:.32,notional:1e5,allocation:1,targetAllocation:2,color:"#d946ef"},{symbol:"RU000A0JX0J8",name:"Роснефть обл",price:"100.90",dayChange:.26,notional:9e4,allocation:1,targetAllocation:1,color:"#ec4899"},{symbol:"RU000A0JX0K6",name:"Лукойл обл",price:"100.50",dayChange:.18,notional:8e4,allocation:1,targetAllocation:1,color:"#f472b6"},{symbol:"RU000A0JX0L4",name:"Сбер обл",price:"102.70",dayChange:.35,notional:7e4,allocation:1,targetAllocation:1,color:"#fb7185"},{symbol:"RU000A0JX0M2",name:"ВТБ обл",price:"99.30",dayChange:.14,notional:6e4,allocation:1,targetAllocation:1,color:"#fda4af"},{symbol:"RU000A0JX0N0",name:"Альфа обл",price:"101.10",dayChange:.28,notional:5e4,allocation:1,targetAllocation:1,color:"#fecdd3"},{symbol:"RU000A0JX0P5",name:"Россельхоз обл",price:"100.00",dayChange:.2,notional:45e3,allocation:1,targetAllocation:1,color:"#fbbf24"}],portfolio4:[{symbol:"SBER",name:"Сбербанк",price:"285.50",dayChange:1.24,notional:11e5,allocation:15,targetAllocation:13,color:"#3b82f6"},{symbol:"RTKM",name:"Ростелеком",price:"89.45",dayChange:.65,notional:72e4,allocation:10,targetAllocation:10,color:"#fbbf24"},{symbol:"AFKS",name:"АФК Система",price:"12.34",dayChange:-.45,notional:58e4,allocation:8,targetAllocation:8,color:"#8b5cf6"},{symbol:"FIVE",name:"X5 Retail",price:"2345.67",dayChange:1.85,notional:5e5,allocation:7,targetAllocation:7,color:"#ec4899"},{symbol:"PHOR",name:"ФосАгро",price:"5678.90",dayChange:-.12,notional:44e4,allocation:6,targetAllocation:6,color:"#ef4444"},{symbol:"HYDR",name:"РусГидро",price:"0.678",dayChange:.34,notional:4e5,allocation:6,targetAllocation:5,color:"#06b6d4"},{symbol:"IRAO",name:"Интер РАО",price:"3.456",dayChange:-.23,notional:36e4,allocation:5,targetAllocation:5,color:"#84cc16"},{symbol:"FEES",name:"ФСК ЕЭС",price:"0.189",dayChange:.12,notional:32e4,allocation:4,targetAllocation:4,color:"#f97316"},{symbol:"SNGS",name:"Сургутнефтегаз",price:"45.67",dayChange:.89,notional:3e5,allocation:4,targetAllocation:4,color:"#a855f7"},{symbol:"SNGSP",name:"Сургутнефтегаз-п",price:"34.56",dayChange:.67,notional:28e4,allocation:4,targetAllocation:3,color:"#14b8a6"},{symbol:"AFLT",name:"Аэрофлот",price:"56.78",dayChange:-1.23,notional:26e4,allocation:4,targetAllocation:3,color:"#eab308"},{symbol:"PIKK",name:"ПИК",price:"890.12",dayChange:.45,notional:24e4,allocation:3,targetAllocation:3,color:"#22c55e"},{symbol:"LSRG",name:"ЛСР",price:"456.78",dayChange:-.34,notional:22e4,allocation:3,targetAllocation:2,color:"#3b82f6"},{symbol:"UPRO",name:"Юнипро",price:"12.34",dayChange:.56,notional:2e5,allocation:3,targetAllocation:2,color:"#10b981"},{symbol:"MAGN",name:"ММК",price:"45.67",dayChange:.23,notional:18e4,allocation:2,targetAllocation:2,color:"#6366f1"},{symbol:"SU26247",name:"ОФЗ 26247",price:"98.70",dayChange:.22,notional:16e4,allocation:2,targetAllocation:2,color:"#8b5cf6"},{symbol:"SU26248",name:"ОФЗ 26248",price:"99.50",dayChange:.16,notional:14e4,allocation:2,targetAllocation:2,color:"#a78bfa"},{symbol:"SU26249",name:"ОФЗ 26249",price:"97.00",dayChange:-.12,notional:12e4,allocation:2,targetAllocation:2,color:"#c084fc"},{symbol:"RU000A0ZZZN5",name:"Газпром обл",price:"102.40",dayChange:.36,notional:1e5,allocation:1,targetAllocation:2,color:"#d946ef"},{symbol:"RU000A0JX0J9",name:"Роснефть обл",price:"101.20",dayChange:.3,notional:9e4,allocation:1,targetAllocation:1,color:"#ec4899"},{symbol:"RU000A0JX0K7",name:"Лукойл обл",price:"100.80",dayChange:.22,notional:8e4,allocation:1,targetAllocation:1,color:"#f472b6"},{symbol:"RU000A0JX0L5",name:"Сбер обл",price:"103.00",dayChange:.4,notional:7e4,allocation:1,targetAllocation:1,color:"#fb7185"},{symbol:"RU000A0JX0M3",name:"ВТБ обл",price:"99.60",dayChange:.16,notional:6e4,allocation:1,targetAllocation:1,color:"#fda4af"},{symbol:"RU000A0JX0N1",name:"Альфа обл",price:"101.40",dayChange:.3,notional:5e4,allocation:1,targetAllocation:1,color:"#fecdd3"},{symbol:"RU000A0JX0P6",name:"Россельхоз обл",price:"100.30",dayChange:.22,notional:45e3,allocation:1,targetAllocation:1,color:"#fbbf24"}],portfolio5:[{symbol:"LKOH",name:"Лукойл",price:"7456.75",dayChange:.92,notional:12e5,allocation:16,targetAllocation:14,color:"#fbbf24"},{symbol:"GMKN",name:"Норникель",price:"18420.20",dayChange:-.15,notional:84e4,allocation:12,targetAllocation:12,color:"#8b5cf6"},{symbol:"YNDX",name:"Яндекс",price:"3254.48",dayChange:2.15,notional:64e4,allocation:9,targetAllocation:9,color:"#ec4899"},{symbol:"ROSN",name:"Роснефть",price:"456.80",dayChange:1.05,notional:56e4,allocation:8,targetAllocation:8,color:"#ef4444"},{symbol:"NVTK",name:"Новатэк",price:"1234.50",dayChange:-.32,notional:48e4,allocation:7,targetAllocation:6,color:"#06b6d4"},{symbol:"TATN",name:"Татнефть",price:"567.90",dayChange:.78,notional:42e4,allocation:6,targetAllocation:6,color:"#84cc16"},{symbol:"ALRS",name:"Алроса",price:"89.45",dayChange:-.12,notional:38e4,allocation:5,targetAllocation:5,color:"#f97316"},{symbol:"MGNT",name:"Магнит",price:"6789.00",dayChange:1.45,notional:34e4,allocation:5,targetAllocation:4,color:"#a855f7"},{symbol:"MOEX",name:"Московская биржа",price:"234.56",dayChange:.67,notional:3e5,allocation:4,targetAllocation:4,color:"#14b8a6"},{symbol:"POLY",name:"Полиметалл",price:"456.78",dayChange:-.89,notional:28e4,allocation:4,targetAllocation:4,color:"#eab308"},{symbol:"CHMF",name:"Северсталь",price:"1234.56",dayChange:1.23,notional:26e4,allocation:4,targetAllocation:3,color:"#22c55e"},{symbol:"PLZL",name:"Полюс",price:"9876.54",dayChange:-.45,notional:24e4,allocation:3,targetAllocation:3,color:"#3b82f6"},{symbol:"VTBR",name:"ВТБ",price:"0.0234",dayChange:.12,notional:22e4,allocation:3,targetAllocation:3,color:"#10b981"},{symbol:"NLMK",name:"НЛМК",price:"145.30",dayChange:-.28,notional:2e5,allocation:3,targetAllocation:2,color:"#6366f1"},{symbol:"RTKM",name:"Ростелеком",price:"89.45",dayChange:.65,notional:18e4,allocation:2,targetAllocation:2,color:"#fbbf24"},{symbol:"SU26250",name:"ОФЗ 26250",price:"98.10",dayChange:.24,notional:16e4,allocation:2,targetAllocation:2,color:"#8b5cf6"},{symbol:"SU26251",name:"ОФЗ 26251",price:"99.00",dayChange:.18,notional:14e4,allocation:2,targetAllocation:2,color:"#a78bfa"},{symbol:"SU26252",name:"ОФЗ 26252",price:"96.80",dayChange:-.14,notional:12e4,allocation:2,targetAllocation:2,color:"#c084fc"},{symbol:"RU000A0ZZZN6",name:"Газпром обл",price:"102.70",dayChange:.4,notional:1e5,allocation:1,targetAllocation:2,color:"#d946ef"},{symbol:"RU000A0JX0J0",name:"Роснефть обл",price:"101.50",dayChange:.34,notional:9e4,allocation:1,targetAllocation:1,color:"#ec4899"},{symbol:"RU000A0JX0K8",name:"Лукойл обл",price:"101.10",dayChange:.25,notional:8e4,allocation:1,targetAllocation:1,color:"#f472b6"},{symbol:"RU000A0JX0L6",name:"Сбер обл",price:"103.30",dayChange:.45,notional:7e4,allocation:1,targetAllocation:1,color:"#fb7185"},{symbol:"RU000A0JX0M4",name:"ВТБ обл",price:"99.90",dayChange:.18,notional:6e4,allocation:1,targetAllocation:1,color:"#fda4af"},{symbol:"RU000A0JX0N2",name:"Альфа обл",price:"101.70",dayChange:.35,notional:5e4,allocation:1,targetAllocation:1,color:"#fecdd3"},{symbol:"RU000A0JX0P7",name:"Россельхоз обл",price:"100.60",dayChange:.25,notional:45e3,allocation:1,targetAllocation:1,color:"#fbbf24"}]},Ws={name:"АО ЮниКредит Банк",regNumber:"1"},qs=[{name:"АО ЮниКредит Банк",regNumber:"1"},{name:'АО "КАБ "Викинг"',regNumber:"2"},{name:'ООО "Примтеркомбанк"',regNumber:"21"},{name:'ПАО Банк "АЛЕКСАНДРОВСКИЙ"',regNumber:"53"},{name:'АКБ "Энергобанк" (АО)',regNumber:"67"},{name:"МОРСКОЙ БАНК (АО)",regNumber:"77"},{name:'АО КБ "САММИТ БАНК"',regNumber:"85"},{name:'АО "БКС Банк"',regNumber:"101"},{name:'ПАО КБ "Сельмашбанк"',regNumber:"106"},{name:'АО АКБ "ЦентроКредит"',regNumber:"121"},{name:'АО "Авто Финанс Банк"',regNumber:"170"},{name:"Прио-Внешторгбанк (ПАО)",regNumber:"212"},{name:'ООО "СПЕЦСТРОЙБАНК"',regNumber:"236"},{name:'АО КБ "Урал ФД"',regNumber:"249"},{name:'АО КБ "Хлынов"',regNumber:"254"},{name:'АО "ГУТА-БАНК"',regNumber:"256"},{name:'АО "АБ "РОССИЯ"',regNumber:"328"},{name:'ООО Банк "Саратов"',regNumber:"330"},{name:"Банк ГПБ (АО)",regNumber:"354"},{name:'АО "Витабанк"',regNumber:"356"},{name:'АО Банк "Аверс"',regNumber:"415"},{name:'ПАО КБ "УБРиР"',regNumber:"429"},{name:'ПАО "СПБ Банк"',regNumber:"435"},{name:'ПАО "Банк "Санкт-Петербург"',regNumber:"436"},{name:'ООО "Камкомбанк"',regNumber:"438"},{name:'АО "БАЛАКОВО-БАНК"',regNumber:"444"},{name:'АО "Кубаньторгбанк"',regNumber:"478"},{name:'АО "ТАТСОЦБАНК"',regNumber:"480"},{name:'ООО КБ "РостФинанс"',regNumber:"481"},{name:'ПАО "ЧЕЛИНДБАНК"',regNumber:"485"},{name:'ПАО "Донкомбанк"',regNumber:"492"},{name:'ПАО "ЧЕЛЯБИНВЕСТБАНК"',regNumber:"493"},{name:'АО Банк "Венец"',regNumber:"524"},{name:'АО КБ "Приобье"',regNumber:"537"},{name:'ООО "Промсельхозбанк"',regNumber:"538"},{name:'АО КБ "Солидарность"',regNumber:"554"},{name:'АО "Банк Акцепт"',regNumber:"567"},{name:'ООО "ЗЕМКОМБАНК"',regNumber:"574"},{name:'АО АБ "Капитал"',regNumber:"575"},{name:'АО БАНК "СНГБ"',regNumber:"588"},{name:'АО "Великие Луки банк"',regNumber:"598"},{name:"Банк ИПБ (АО)",regNumber:"600"},{name:'АО "Первый Инвестиционный Банк"',regNumber:"604"},{name:'ПАО Банк "Кузнецкий"',regNumber:"609"},{name:'АО "Датабанк"',regNumber:"646"},{name:'АО "Почта Банк"',regNumber:"650"},{name:'ООО КБ "ГТ банк"',regNumber:"665"},{name:'ПАО КБ "РусьРегионБанк"',regNumber:"685"},{name:'Банк "Нальчик" ООО',regNumber:"695"},{name:'ПАО "НИКО-БАНК"',regNumber:"702"},{name:"АО Банк Синара",regNumber:"705"},{name:'ООО КБЭР "Банк Казани"',regNumber:"708"},{name:'АО УКБ "Белгородсоцбанк"',regNumber:"760"},{name:'ООО "РУСБС"',regNumber:"779"},{name:'АО "Роял Кредит Банк"',regNumber:"783"},{name:'АО НКБ "СЛАВЯНБАНК"',regNumber:"804"},{name:'"Банк Заречье" (АО)',regNumber:"817"},{name:'ООО "Вайлдберриз Банк"',regNumber:"841"},{name:'ООО КБ "Кетовский"',regNumber:"842"},{name:'АО "Дальневосточный банк"',regNumber:"843"},{name:'КБ "Долинск" (АО)',regNumber:"857"},{name:"Банк Пермь (АО)",regNumber:"875"},{name:'ПАО "Норвик Банк"',regNumber:"902"},{name:'АО "ВЛАДБИЗНЕСБАНК"',regNumber:"903"},{name:'АО "Банк "Торжок"',regNumber:"933"},{name:'ПАО "Совкомбанк"',regNumber:"963"},{name:'АО "ПЕРВОУРАЛЬСКБАНК"',regNumber:"965"},{name:'ООО КБ "Дружба"',regNumber:"990"},{name:"Банк ВТБ (ПАО)",regNumber:"1000"},{name:'ООО "Хакасский муниципальный банк"',regNumber:"1049"},{name:"АО «ТелеПорт Банк»",regNumber:"1052"},{name:'АО "РЕАЛИСТ БАНК"',regNumber:"1067"},{name:'ПАО Комбанк "Химик"',regNumber:"1114"},{name:'ООО "Костромаселькомбанк"',regNumber:"1115"},{name:'ООО "Цифра банк"',regNumber:"1143"},{name:'"Братский АНКБ" АО',regNumber:"1144"},{name:'ООО КБ "Калуга"',regNumber:"1151"},{name:'АО "Кузнецкбизнесбанк"',regNumber:"1158"},{name:'АО комбанк "Арзамас"',regNumber:"1281"},{name:'ПАО "Банк Ставр"',regNumber:"1288"},{name:'АО КБ "ВАКОБАНК"',regNumber:"1291"},{name:'КБ "ЭНЕРГОТРАНСБАНК" (АО)',regNumber:"1307"},{name:'АО Банк "ТКПБ"',regNumber:"1312"},{name:'АО "Экономбанк"',regNumber:"1319"},{name:'АО "АЛЬФА-БАНК"',regNumber:"1326"},{name:'АО "Солид Банк"',regNumber:"1329"},{name:'Банк "Левобережный" (ПАО)',regNumber:"1343"},{name:'ПАО УКБ "Новобанк"',regNumber:"1352"},{name:'ООО КБ "Уралфинанс"',regNumber:"1370"},{name:'Банк "Снежинский" АО',regNumber:"1376"},{name:'ООО банк "Элита"',regNumber:"1399"},{name:"ПАО Сбербанк",regNumber:"1481"},{name:'ПАО "РосДорБанк"',regNumber:"1573"},{name:'АО "Тимер Банк"',regNumber:"1581"},{name:'"СДМ-Банк" (ПАО)',regNumber:"1637"},{name:"ООО Банк Оранжевый",regNumber:"1659"},{name:"Креди Агриколь КИБ АО",regNumber:"1680"},{name:'ПАО "Томскпромстройбанк"',regNumber:"1720"},{name:'АО "ИК Банк"',regNumber:"1732"},{name:'ПАО "БыстроБанк"',regNumber:"1745"},{name:'ООО "НОВОКИБ"',regNumber:"1747"},{name:"АО МОСОБЛБАНК",regNumber:"1751"},{name:"АО ЕАТПБанк",regNumber:"1765"},{name:'АО КИБ "ЕВРОАЛЬЯНС"',regNumber:"1781"},{name:'АО АКИБ "Почтобанк"',regNumber:"1788"},{name:'АО БАНК "Ермак"',regNumber:"1809"},{name:'"Азиатско-Тихоокеанский Банк" (АО)',regNumber:"1810"},{name:'МКБ "Дон-Тексбанк" ООО',regNumber:"1818"},{name:'ООО "Инбанк"',regNumber:"1829"},{name:'АКБ "ФОРА-БАНК" (АО)',regNumber:"1885"},{name:'АО "Банк "Вологжанин"',regNumber:"1896"},{name:'АКБ "Ланта-Банк" (АО)',regNumber:"1920"},{name:'АО КБ "Модульбанк"',regNumber:"1927"},{name:'АО "Банк ДАЛЕНА"',regNumber:"1948"},{name:"АО БАНК НБС",regNumber:"1949"},{name:'ПАО "НБД-Банк"',regNumber:"1966"},{name:'ООО "АвтоКредитБанк"',regNumber:"1973"},{name:'ПАО "МОСКОВСКИЙ КРЕДИТНЫЙ БАНК"',regNumber:"1978"},{name:'"СИБСОЦБАНК" ООО',regNumber:"2015"},{name:'Банк "СЕРВИС РЕЗЕРВ" (АО)',regNumber:"2034"},{name:'ООО "ЖИВАГО БАНК"',regNumber:"2065"},{name:'ООО "АЛТЫНБАНК"',regNumber:"2070"},{name:'КМ "Профильный Банк" (АО)',regNumber:"2103"},{name:'АКБ "ПЕРЕСВЕТ" (ПАО)',regNumber:"2110"},{name:'АО АКБ "Алеф-Банк"',regNumber:"2119"},{name:'АКБ "НРБанк" (АО)',regNumber:"2170"},{name:'АКБ "Форштадт" (АО)',regNumber:"2208"},{name:"ТКБ БАНК ПАО",regNumber:"2210"},{name:'АО "Банк Интеза"',regNumber:"2216"},{name:'ПАО КБ "Центр-инвест"',regNumber:"2225"},{name:'АО КБ "КОСМОС"',regNumber:"2245"},{name:'АКБ "ТЕНДЕР-БАНК" (АО)',regNumber:"2252"},{name:'ПАО "МТС-Банк"',regNumber:"2268"},{name:'ПАО "БАНК УРАЛСИБ"',regNumber:"2275"},{name:'АО "Банк Русский Стандарт"',regNumber:"2289"},{name:'АКБ "Абсолют Банк" (ПАО)',regNumber:"2306"},{name:"АО Банк Инго",regNumber:"2307"},{name:'АКБ "БЭНК ОФ ЧАЙНА" (АО)',regNumber:"2309"},{name:'АО "Банк ДОМ.РФ"',regNumber:"2312"},{name:'ООО "Бланк банк"',regNumber:"2368"},{name:'АО "НДБанк"',regNumber:"2374"},{name:'Банк "ИТУРУП" (ООО)',regNumber:"2390"},{name:'АО АКБ "ЕВРОФИНАНС МОСНАРБАНК"',regNumber:"2402"},{name:'ООО КБ "МВС Банк"',regNumber:"2407"},{name:"Банк Глобус (АО)",regNumber:"2438"},{name:'ПАО АКБ "Металлинвестбанк"',regNumber:"2440"},{name:'ПАО "МЕТКОМБАНК"',regNumber:"2443"},{name:'АО "ГЕНБАНК"',regNumber:"2490"},{name:'АО "Банк Кредит Свисс (Москва)"',regNumber:"2494"},{name:"ИНГ БАНК (ЕВРАЗИЯ) АО",regNumber:"2495"},{name:'ООО "Крона-Банк"',regNumber:"2499"},{name:'ООО "банк Раунд"',regNumber:"2506"},{name:'АО "Тольяттихимбанк"',regNumber:"2507"},{name:'КБ "Кубань Кредит" ООО',regNumber:"2518"},{name:"ЭКСИ-Банк (АО)",regNumber:"2530"},{name:'АО КБ "Пойдём!"',regNumber:"2534"},{name:'АО АКБ "НОВИКОМБАНК"',regNumber:"2546"},{name:'АО Банк "ПСКБ"',regNumber:"2551"},{name:'АО КБ "Ситибанк"',regNumber:"2557"},{name:'"ЗИРААТ БАНК (МОСКВА)" (АО)',regNumber:"2559"},{name:'ИКБР "ЯРИНТЕРБАНК" (ООО)',regNumber:"2564"},{name:'ООО БАНК "КУРГАН"',regNumber:"2568"},{name:"Банк РМП (АО)",regNumber:"2574"},{name:'Банк "КУБ" (АО)',regNumber:"2584"},{name:'ПАО "АКИБАНК"',regNumber:"2587"},{name:'ПАО "АК БАРС" БАНК',regNumber:"2590"},{name:'АКБ "Алмазэргиэнбанк" АО',regNumber:"2602"},{name:'АО "ИТ Банк"',regNumber:"2609"},{name:'АО Банк "Объединенный капитал"',regNumber:"2611"},{name:'АО АКБ "МЕЖДУНАРОДНЫЙ ФИНАНСОВЫЙ КЛУБ"',regNumber:"2618"},{name:'КБ "Дж.П. Морган Банк Интернешнл" (ООО)',regNumber:"2629"},{name:'АО АИКБ "Енисейский объединенный банк"',regNumber:"2645"},{name:'АКБ "НООСФЕРА" (АО)',regNumber:"2650"},{name:'ООО КБ "Алтайкапиталбанк"',regNumber:"2659"},{name:'АКБ "СЛАВИЯ" (АО)',regNumber:"2664"},{name:'АО "ТБанк"',regNumber:"2673"},{name:'КБ "Крокус-Банк" (ООО)',regNumber:"2682"},{name:'КБ "ЛОКО-Банк" (АО)',regNumber:"2707"},{name:'"Северный Народный Банк" (АО)',regNumber:"2721"},{name:'БАНК "МСКБ" (АО)',regNumber:"2722"},{name:'ПАО СКБ Приморья "Примсоцбанк"',regNumber:"2733"},{name:'АКБ "Держава" ПАО',regNumber:"2738"},{name:'АО "БМ-Банк"',regNumber:"2748"},{name:'АО "НК Банк"',regNumber:"2755"},{name:"ИНВЕСТТОРГБАНК АО",regNumber:"2763"},{name:'АО "ОТП Банк"',regNumber:"2766"},{name:"ЮГ-Инвестбанк (ПАО)",regNumber:"2772"},{name:'ООО "АТБ" Банк',regNumber:"2776"},{name:"АО МС Банк Рус",regNumber:"2789"},{name:"АО РОСЭКСИМБАНК",regNumber:"2790"},{name:'Банк "Вятич" (АО)',regNumber:"2796"},{name:'АО "Банк ФИНАМ"',regNumber:"2799"},{name:'Банк "Йошкар-Ола" (ПАО)',regNumber:"2802"},{name:'АКБ "Трансстройбанк" (АО)',regNumber:"2807"},{name:'АО "БАНК СГБ"',regNumber:"2816"},{name:'АО КБ "Соколовский"',regNumber:"2830"},{name:'ООО КБ "СИНКО-БАНК"',regNumber:"2838"},{name:'ООО "СМЛТ Банк"',regNumber:"2846"},{name:'ООО КБ "Столичный Кредит"',regNumber:"2853"},{name:'(АО "Банк "Агророс")',regNumber:"2860"},{name:'АО "ИШБАНК"',regNumber:"2867"},{name:'АКБ "Кузбассхимбанк" (ПАО)',regNumber:"2868"},{name:'АО КБ "НИБ"',regNumber:"2876"},{name:'ПАО АКБ "АВАНГАРД"',regNumber:"2879"},{name:'АО КБ "АГРОПРОМКРЕДИТ"',regNumber:"2880"},{name:'"СОЦИУМ-БАНК" (ООО)',regNumber:"2881"},{name:'"БСТ-БАНК" АО',regNumber:"2883"},{name:'ООО "Земский банк"',regNumber:"2900"},{name:'"Банк Кремлевский" ООО',regNumber:"2905"},{name:'ООО КБ "АРЕСБАНК"',regNumber:"2914"},{name:"ББР Банк (АО)",regNumber:"2929"},{name:'КБ "НМБ" ООО',regNumber:"2932"},{name:'АО "УРАЛПРОМБАНК"',regNumber:"2964"},{name:'АО "ГОРБАНК"',regNumber:"2982"},{name:'КБ "Байкалкредобанк" (АО)',regNumber:"2990"},{name:'КБ "СТРОЙЛЕСБАНК" (ООО)',regNumber:"2995"},{name:'ООО "ПроКоммерцБанк"',regNumber:"2996"},{name:'АО "Углеметбанк"',regNumber:"2997"},{name:'АО "Экспобанк"',regNumber:"2998"},{name:'ПАО АКБ "Приморье"',regNumber:"3001"},{name:'АО Банк "Развитие-Столица"',regNumber:"3013"},{name:'"Республиканский Кредитный Альянс" ООО',regNumber:"3017"},{name:'АО "Яндекс Банк"',regNumber:"3027"},{name:'"Нацинвестпромбанк" (АО)',regNumber:"3077"},{name:'"Вэйбанк" АО',regNumber:"3095"},{name:'АО "РФК-банк"',regNumber:"3099"},{name:'ООО КБ "ЭКО-ИНВЕСТ"',regNumber:"3116"},{name:'АО "НС Банк"',regNumber:"3124"},{name:'АО "Таганрогбанк"',regNumber:"3136"},{name:'АО "Банк БЖФ"',regNumber:"3138"},{name:'ПАО "Контур.Банк"',regNumber:"3161"},{name:'АО "МОСКОМБАНК"',regNumber:"3172"},{name:'ООО КБ "ВНЕШФИНБАНК"',regNumber:"3173"},{name:'ПАО "БАЛТИНВЕСТБАНК"',regNumber:"3176"},{name:'КБ "Континенталь" ООО',regNumber:"3184"},{name:"Эс-Би-Ай Банк ООО",regNumber:"3185"},{name:'АО "Сити Инвест Банк"',regNumber:"3194"},{name:"АО НОКССБАНК",regNumber:"3202"},{name:'АО "Свой Банк"',regNumber:"3223"},{name:"МП Банк (ООО)",regNumber:"3224"},{name:'БАНК "АГОРА" ООО',regNumber:"3231"},{name:'АО "СЭБ Банк"',regNumber:"3235"},{name:"ПАО ФИНСТАР БАНК",regNumber:"3245"},{name:'АО БАНК "МОСКВА-СИТИ"',regNumber:"3247"},{name:'ПАО "Банк ПСБ"',regNumber:"3251"},{name:'АО "Газэнергобанк"',regNumber:"3252"},{name:"ПАО Банк ЗЕНИТ",regNumber:"3255"},{name:'МКИБ "РОССИТА-БАНК" ООО',regNumber:"3257"},{name:'АО "БАНК ОРЕНБУРГ"',regNumber:"3269"},{name:'АО "Первый Дортрансбанк"',regNumber:"3271"},{name:'Банк "ТРАСТ" (ПАО)',regNumber:"3279"},{name:'Банк "ВБРР" (АО)',regNumber:"3287"},{name:'АО "Райффайзенбанк"',regNumber:"3292"},{name:'"Русьуниверсалбанк" (ООО)',regNumber:"3293"},{name:'АО "ПроБанк"',regNumber:"3296"},{name:'АО "Классик Эконом Банк"',regNumber:"3298"},{name:'АО "КОШЕЛЕВ-БАНК"',regNumber:"3300"},{name:"Азия-Инвест Банк (АО)",regNumber:"3303"},{name:'АО "Кредит Европа Банк (Россия)"',regNumber:"3311"},{name:'ООО "Дойче Банк"',regNumber:"3328"},{name:'АО "Денизбанк Москва"',regNumber:"3330"},{name:'АО "КОММЕРЦБАНК (ЕВРАЗИЯ)"',regNumber:"3333"},{name:'АО "Мидзухо Банк (Москва)"',regNumber:"3337"},{name:'АО "МСП Банк"',regNumber:"3340"},{name:'ООО "Мурманский расчетный Банк"',regNumber:"3341"},{name:'АО "Россельхозбанк"',regNumber:"3349"},{name:'КБ "Ренессанс Кредит" (ООО)',regNumber:"3354"},{name:'КБ "Москоммерцбанк" (АО)',regNumber:"3365"},{name:'КБ "Максима" (ООО)',regNumber:"3379"},{name:'АО "Банк Финсервис"',regNumber:"3388"},{name:'"НТХ БАНК АО"',regNumber:"3390"},{name:'"Банк "МБА-МОСКВА" ООО',regNumber:"3395"},{name:'АО "МБ Банк"',regNumber:"3396"},{name:'АО КБ "РУСНАРБАНК"',regNumber:"3403"},{name:'"БНП ПАРИБА БАНК" АО',regNumber:"3407"},{name:'КБ "РБА" (ООО)',regNumber:"3413"},{name:'ООО "Банк РСИ"',regNumber:"3415"},{name:'ООО "Унифондбанк"',regNumber:"3416"},{name:'КБ "Новый век" (ООО)',regNumber:"3417"},{name:'АО Банк "Национальный стандарт"',regNumber:"3421"},{name:'ООО "Первый Клиентский Банк"',regNumber:"3436"},{name:'"Коммерческий Индо Банк" ООО',regNumber:"3446"},{name:'Банк "РЕСО Кредит" (АО)',regNumber:"3450"},{name:'ООО "Ю Би Эс Банк"',regNumber:"3463"},{name:'АО "Эм-Ю-Эф-Джи Банк (Евразия)"',regNumber:"3465"},{name:'АО КБ "ЮНИСТРИМ"',regNumber:"3467"},{name:"Санкт-Петербургский банк инвестиций (АО)",regNumber:"3468"},{name:'АО "Тойота Банк"',regNumber:"3470"},{name:'ООО "МБ РУС Банк"',regNumber:"3473"},{name:"АйСиБиСи Банк (АО)",regNumber:"3475"},{name:'АО "Ури Банк"',regNumber:"3479"},{name:'ООО "БМВ Банк"',regNumber:"3482"},{name:'ООО "Ориджин Банк"',regNumber:"3490"},{name:'АО "СМБСР Банк"',regNumber:"3494"},{name:'ООО "Пихта Банк"',regNumber:"3500"},{name:'АО "БАНК БЕРЕЙТ"',regNumber:"3505"},{name:'"СеверСтройБанк" АО',regNumber:"3507"},{name:'ООО "Чайна Констракшн Банк"',regNumber:"3515"},{name:'ООО "КЭБ ЭйчЭнБи Банк"',regNumber:"3525"},{name:'АО "Банк ЧБРР"',regNumber:"3527"},{name:'ООО "Чайнасельхозбанк"',regNumber:"3529"},{name:"ЦМРБанк (ООО)",regNumber:"3531"},{name:'АО "Банк 131"',regNumber:"3538"},{name:'ООО "ОЗОН Банк"',regNumber:"3542"},{name:'ООО Банк "Пэйджин"',regNumber:"3543"},{name:'ООО "Банк Точка"',regNumber:"3545"}];const Ys=_("portfolio",()=>{const e=t((()=>{if("undefined"!=typeof window){const e=localStorage.getItem("selectedBank");if(e)try{return JSON.parse(e)}catch(TQe){console.error("Failed to parse selectedBank from localStorage:",TQe)}}return Ws})()),a=S(()=>{if(!e.value)return Gs.portfolio1;const t=(a=e.value.regNumber,["portfolio1","portfolio2","portfolio3","portfolio4","portfolio5"][parseInt(a)%5]||"portfolio1");var a;return Gs[t]||Gs.portfolio1}),n=S(()=>{const e=[...a.value];return e.map(t=>{const a=e.map(e=>((e,t)=>{if(e===t)return 1;const a=e.includes("SU")||e.includes("RU000"),n=t.includes("SU")||t.includes("RU000"),r=e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return Math.abs(t)};if(a&&n)return.7+r(e+t)%100/100*.2;if(!a&&!n)return e.includes("SBER")&&t.includes("VTBR")||e.includes("VTBR")&&t.includes("SBER")||e.includes("GAZP")&&t.includes("ROSN")||e.includes("ROSN")&&t.includes("GAZP")||e.includes("LKOH")&&t.includes("TATN")||e.includes("TATN")&&t.includes("LKOH")||e.includes("NVTK")&&t.includes("GAZP")||e.includes("GAZP")&&t.includes("NVTK")?.6+r(e+t)%100/100*.3:.3+r(e+t)%100/100*.4;return r(e+t)%100/100*.3-.1})(t.symbol,e.symbol));return{label:t.symbol,values:a}})});const r=t(qs);return{selectedBank:e,positions:a,correlationMatrix:n,banks:r,setSelectedBank:function(t){e.value=t,localStorage.setItem("selectedBank",JSON.stringify(t))}}}),js=Object.freeze(Object.defineProperty({__proto__:null,defaultBank:Ws,usePortfolioStore:Ys},Symbol.toStringTag,{value:"Module"})),Xs={class:"portfolio-page"},$s={class:"hero-section"},Ks={class:"hero-left"},Zs={class:"hero-title-row"},Js={class:"bank-selector-inline-wrapper"},Qs={class:"bank-selector-wrapper"},el={class:"bank-selector-content"},tl={class:"bank-selector-name"},al={class:"bank-selector-reg"},nl={key:0,class:"bank-dropdown"},rl={class:"bank-dropdown-search"},il={class:"bank-dropdown-list"},ol=["onClick"],sl={class:"bank-item-content"},ll={class:"bank-item-name"},cl={class:"bank-item-reg"},ul={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},dl={class:"hero-actions"},hl={class:"last-update"},pl={class:"mono"},fl={class:"kpi-grid"},ml={class:"glass-card kpi-card glow-green"},vl={class:"kpi-header"},gl={width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"4"},yl={key:0,d:"M18 15l-6-6-6 6"},bl={key:1,d:"M6 9l6 6 6-6"},xl={class:"kpi-content"},wl={class:"kpi-value text-gradient-green"},_l={class:"kpi-sub"},Sl={class:"glass-card kpi-card"},Ml={class:"kpi-header"},Tl={class:"trend-badge negative"},kl={class:"kpi-content"},Cl={class:"kpi-value text-white"},Al={class:"glass-card kpi-card glow-blue"},El={class:"kpi-content"},Il={class:"kpi-value text-gradient-blue"},Rl={class:"kpi-sub"},Dl={class:"glass-card kpi-card"},Pl={class:"kpi-content"},Ll={class:"kpi-value text-white"},Nl={class:"kpi-sub"},Ol={class:"dashboard-grid"},Fl={class:"col-main"},Bl={class:"glass-panel"},Ul={class:"panel-body p-0"},zl={class:"table-container"},Vl={class:"glass-table"},Hl=["onClick"],Gl={class:"asset-cell"},Wl={class:"asset-info"},ql={class:"symbol"},Yl={class:"name"},jl={class:"text-right mono"},Xl={class:"text-right mono"},$l={class:"text-right mono opacity-80"},Kl={class:"text-right mono font-bold"},Zl={class:"text-right mono opacity-50"},Jl={class:"text-right"},Ql={class:"glass-panel"},ec={class:"panel-body heatmap-body"},tc={class:"heatmap-wrapper"},ac={class:"heatmap-header-row"},nc={class:"heatmap-rh"},rc={class:"glass-panel heatmap-panel",style:{"margin-bottom":"0"}},ic={class:"panel-body",style:{padding:"8px 10px 0 10px",position:"relative","margin-bottom":"0"}},oc={key:0,class:"asset-tooltip-3d"},sc={class:"tooltip-header"},lc={class:"tooltip-symbol"},cc={class:"tooltip-name"},uc={class:"tooltip-details"},dc={class:"tooltip-row"},hc={key:0,class:"tooltip-row"},pc={key:1,class:"tooltip-row"},fc={class:"tooltip-row"},mc={class:"tooltip-row"},vc={class:"tooltip-row"},gc={key:2,class:"tooltip-row"},yc={class:"col-side-flex"},bc={key:0,class:"glass-panel inspector-card"},xc={class:"panel-header"},wc={class:"inspector-header-top"},_c={class:"inspector-title"},Sc={class:"badge-glass"},Mc={class:"panel-body"},Tc={class:"mini-chart-container"},kc={class:"chart-bars"},Cc={class:"glass-panel optimizer-link-card"},Ac={class:"optimizer-link-content"},Ec={class:"glass-panel combined-metrics metrics-panel"},Ic={class:"metrics-section"},Rc={class:"metric-row"},Dc={class:"metric-value text-red"},Pc={class:"metric-row"},Lc={class:"metric-value text-green"},Nc={class:"metric-row"},Oc={class:"metric-value text-green"},Fc={class:"metric-row"},Bc={class:"metric-value text-white"},Uc={class:"metric-row"},zc={class:"metric-row"},Vc={class:"metric-value text-red"},Hc={class:"glass-panel scatter-3d-panel"},Gc={class:"panel-body scatter-3d-body"},Wc={class:"modal-body"},qc={class:"modal-search"},Yc={class:"modal-table-container"},jc={class:"glass-table modal-table"},Xc=["onClick"],$c={class:"asset-cell"},Kc={class:"asset-info"},Zc={class:"symbol"},Jc={class:"name"},Qc={class:"text-right mono"},eu={class:"text-right mono"},tu={class:"text-right mono opacity-80"},au={class:"text-right mono font-bold"},nu={class:"text-right mono opacity-50"},ru={class:"text-right"},iu={class:"modal-footer"},ou={class:"modal-stats"},su=e({__name:"Portfolio",setup(e){let a=null;t({currentRegime:"TRENDING",positionSize:100,lambda:5,jaggedness:.42,pctChoppy:32,volRatio:1.5,history:["TRENDING","TRENDING","CHOPPY","TRENDING","TRENDING","TRENDING","CHOPPY","CHOPPY","CHOPPY","TRENDING","TRENDING","TRENDING","TRENDING","TRENDING","CHOPPY","CHOPPY","TRENDING","TRENDING","TRENDING","TRENDING"]}),t({isActive:!1,severity:"normal",title:"Предварительный сигнал тревоги",message:"Пик волатильности сдвинулся. Рекомендуется снизить long-позиции на 50%"}),t({currentZscore:.12,precision:42,recall:35,recentAlerts:3,truePositives:2,alertHistory:[{date:"2026-01-06",zscore:.12,outcome:!1},{date:"2026-01-05",zscore:-.45,outcome:!1},{date:"2026-01-04",zscore:2.12,outcome:!0},{date:"2026-01-03",zscore:1.85,outcome:!0},{date:"2026-01-02",zscore:-.32,outcome:!1}]});const o=Ys(),g=t((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}));t(!1);const b=t(""),x=t({show:!1,message:"",type:"success"}),_=t(null),C=t(!1),{selectedBank:A,positions:D,banks:P}=N(o),L=t(!1),F=t(""),B=t(null),U=t(null),z=async()=>{if(D.value&&0!==D.value.length){C.value=!0;try{const e=D.value.map(e=>({symbol:e.symbol,name:e.name,price:parseFloat(e.price)||0,dayChange:e.dayChange||0,notional:e.notional||0,allocation:e.allocation||0,targetAllocation:e.targetAllocation||0,color:e.color||""})),t=await(async e=>{try{const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/portfolio/metrics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Portfolio Metrics Calculation Failed:",QXe),QXe}})({positions:e,risk_free_rate:.042,market_return:.1,market_volatility:.15});_.value=t}catch(QXe){console.error("Failed to load portfolio metrics:",QXe),_.value=null}finally{C.value=!1}}else _.value=null};R(D,e=>{!(e.length>0)||B.value&&e.find(e=>e.symbol===B.value?.symbol)||(B.value=e[0]),z()},{immediate:!0,deep:!0});const V=S(()=>{if(!F.value.trim())return P.value;const e=F.value.toLowerCase().trim();return P.value.filter(t=>t.name.toLowerCase().includes(e)||t.regNumber.includes(e))}),H=()=>{L.value=!L.value,L.value&&(F.value="")},G=e=>{e.target.closest(".bank-selector-wrapper")||(L.value=!1)},W=S(()=>[...D.value].sort((e,t)=>t.allocation-e.allocation).slice(0,5));S(()=>{if(!b.value)return D.value;const e=b.value.toLowerCase();return D.value.filter(t=>t.symbol.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))});const q=t(!1),Y=t(""),j=S(()=>{if(!Y.value)return D.value;const e=Y.value.toLowerCase();return D.value.filter(t=>t.symbol.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}),X=()=>{q.value=!0,Y.value="","undefined"!=typeof document&&(document.body.style.overflow="hidden")},$=()=>{q.value=!1,"undefined"!=typeof document&&(document.body.style.overflow="")},K=S(()=>{const e=[...D.value];return e.map(t=>{const a=e.map(e=>((e,t)=>{if(e===t)return 1;const a=e.includes("SU")||e.includes("RU000"),n=t.includes("SU")||t.includes("RU000"),r=e=>{let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return Math.abs(t)};if(a&&n)return.7+r(e+t)%100/100*.2;if(!a&&!n)return e.includes("SBER")&&t.includes("VTBR")||e.includes("VTBR")&&t.includes("SBER")||e.includes("GAZP")&&t.includes("ROSN")||e.includes("ROSN")&&t.includes("GAZP")||e.includes("LKOH")&&t.includes("TATN")||e.includes("TATN")&&t.includes("LKOH")||e.includes("NVTK")&&t.includes("GAZP")||e.includes("GAZP")&&t.includes("NVTK")?.6+r(e+t)%100/100*.3:.3+r(e+t)%100/100*.4;return r(e+t)%100/100*.3-.1})(t.symbol,e.symbol));return{label:t.symbol,values:a}})}),Z=S(()=>[...D.value].sort((e,t)=>t.allocation-e.allocation).slice(0,10).map(e=>e.symbol)),J=async()=>{try{console.log("Initializing 3D Correlation Heatmap...");const e=await(async()=>{if("undefined"==typeof window)return console.error("Window is undefined"),null;if(window.Plotly)return a=window.Plotly,console.log("Plotly already loaded"),a;if(document.querySelector('script[src*="plotly"]'))return new Promise(e=>{const t=setInterval(()=>{window.Plotly&&(clearInterval(t),a=window.Plotly,console.log("Plotly loaded from existing script"),e(a))},100);setTimeout(()=>{clearInterval(t),console.error("Plotly script timeout"),e(null)},1e4)});const e=document.createElement("script");return e.src="https://cdn.plot.ly/plotly-latest.min.js",e.async=!0,e.crossOrigin="anonymous",new Promise((t,n)=>{e.onload=()=>{window.Plotly?(a=window.Plotly,console.log("Plotly loaded successfully"),t(a)):(console.error("Plotly not found after script load"),n(new Error("Plotly not found")))},e.onerror=e=>{console.error("Failed to load Plotly script:",e),n(e)},document.head.appendChild(e)})})();if(!e)return void console.error("Plotly not loaded");a=e;const t=document.getElementById("correlation-3d-heatmap");if(!t)return void console.error("Container correlation-3d-heatmap not found");if(console.log("Container found, dimensions:",t.clientWidth,t.clientHeight),0===t.clientWidth||0===t.clientHeight){if(console.warn("Container has zero dimensions, waiting for layout..."),await new Promise(e=>requestAnimationFrame(e)),0===t.clientWidth||0===t.clientHeight)return void console.error("Container still has zero dimensions after wait");console.log("Container dimensions after wait:",t.clientWidth,t.clientHeight)}const n=[...D.value];if(0===n.length)return;const r=K.value,i=((e,t)=>e.map(e=>{const a=e.symbol.includes("SU")||e.symbol.includes("RU000"),n=a?"#3b82f6":"#10b981",r=a?3+4*Math.random():15+20*Math.random(),i=t.findIndex(t=>t.label===e.symbol);let o=0;if(-1!==i){const e=t[i].values;o=e.reduce((e,t)=>e+t,0)/e.length}return{x:r,y:o,z:e.allocation,asset:{...e,color:n}}}))(n,r);if(0===i.length)return void console.error("No 3D positions calculated");const o=i.map(e=>e.x),s=i.map(e=>e.y),l=i.map(e=>e.z),c=Math.min(...o),u=Math.max(...o),d=Math.min(...s),h=Math.max(...s),p=Math.min(...l),f=Math.max(...l),m=(e,t,a)=>a===t?5:(e-t)/(a-t)*10,v=i.map(e=>({...e,nx:m(e.x,c,u),ny:m(e.y,d,h),nz:m(e.z,p,f)})),g=(e,t,a,n,r,i)=>{const o=[],s=[],l=[];for(let c=0;c<16;c++){const r=c/15*Math.PI;for(let i=0;i<16;i++){const c=i/15*2*Math.PI;o.push(e+n*Math.sin(r)*Math.cos(c)),s.push(t+n*Math.sin(r)*Math.sin(c)),l.push(a+n*Math.cos(r))}}return{type:"mesh3d",x:o,y:s,z:l,color:r,alphahull:0,opacity:1,flatshading:!1,lighting:{ambient:.6,diffuse:.9,specular:1,roughness:.1,fresnel:.8},lightposition:{x:10,y:10,z:20},hoverinfo:"none",customdata:i,name:i.symbol}},y=[];v.forEach(e=>{const t=e.asset,a=.3+t.allocation/25;y.push(g(e.nx,e.ny,e.nz,a,t.color,t))}),y.push({x:v.map(e=>e.nx),y:v.map(e=>e.ny),z:v.map(e=>e.nz),mode:"markers",type:"scatter3d",marker:{size:v.map(e=>Math.max(40,40*(.3+e.asset.allocation/25))),color:"rgba(255,255,255,0)",opacity:0,line:{width:0}},hoverinfo:"skip",customdata:v.map(e=>e.asset)});const b={showlegend:!1,hovermode:"closest",scene:{xaxis:{title:"РИСК (Волатильность %)",backgroundcolor:"rgba(20, 22, 28, 0.8)",gridcolor:"rgba(255,255,255,0.08)",zeroline:!1,showbackground:!0,titlefont:{color:"#ffffff",size:12,weight:"bold"},tickfont:{size:9,color:"rgba(255,255,255,0.6)"},tickvals:[0,2.5,5,7.5,10],ticktext:[c.toFixed(0)+"%",((c+u)/4*1+3*c/4).toFixed(0)+"%",((c+u)/2).toFixed(0)+"%",((c+u)/4*3+1*u/4).toFixed(0)+"%",u.toFixed(0)+"%"],showspikes:!1},yaxis:{title:"СВЯЗЬ (Корреляция)",backgroundcolor:"rgba(30, 32, 38, 0.6)",gridcolor:"rgba(255,255,255,0.08)",zeroline:!1,showbackground:!0,titlefont:{color:"#ffffff",size:12,weight:"bold"},tickfont:{size:9,color:"rgba(255,255,255,0.6)"},tickvals:[0,2.5,5,7.5,10],ticktext:[d.toFixed(2),((d+h)/4*1+3*d/4).toFixed(2),((d+h)/2).toFixed(2),((d+h)/4*3+1*h/4).toFixed(2),h.toFixed(2)],showspikes:!1},zaxis:{title:"ДОЛЯ (Вес %)",backgroundcolor:"rgba(20, 22, 28, 0.8)",gridcolor:"rgba(255,255,255,0.08)",zeroline:!1,showbackground:!0,titlefont:{color:"#ffffff",size:12,weight:"bold"},tickfont:{size:9,color:"rgba(255,255,255,0.6)"},tickvals:[0,2.5,5,7.5,10],ticktext:[p.toFixed(1)+"%",((p+f)/4*1+3*p/4).toFixed(1)+"%",((p+f)/2).toFixed(1)+"%",((p+f)/4*3+1*f/4).toFixed(1)+"%",f.toFixed(1)+"%"],showspikes:!1},bgcolor:"rgba(0,0,0,0)",camera:{eye:{x:1.8,y:1.8,z:1.2},center:{x:0,y:0,z:0},up:{x:0,y:0,z:1}},aspectmode:"cube"},paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{color:"#fff",family:"system-ui"},margin:{l:0,r:0,b:0,t:0},autosize:!0},x={responsive:!0,displayModeBar:!1,staticPlot:!1,displaylogo:!1};console.log("Portfolio: Creating 3D plot with",y.length,"traces"),console.log("Portfolio: Container dimensions:",t.clientWidth,t.clientHeight);try{a.newPlot(t,y,b,x),console.log("Portfolio: 3D plot created successfully")}catch(QXe){return void console.error("Portfolio: Error creating 3D plot:",QXe)}const w=t;w.on("plotly_hover",e=>{if(e&&e.points&&e.points.length>0)for(const t of e.points){if(t.customdata){const e=Array.isArray(t.customdata)?t.customdata[0]:t.customdata;if(e)return void(U.value=e)}const e=y.length-1;if(t.curveNumber===e&&void 0!==t.pointNumber){const e=t.pointNumber;if(e>=0&&e<v.length&&v[e])return void(U.value=v[e].asset)}if(t.curveNumber<e&&t.curveNumber<v.length){const e=t.curveNumber;if(v[e])return void(U.value=v[e].asset)}}}),w.on("plotly_unhover",()=>{U.value=null})}catch(e){console.error("Error initializing 3D Correlation Heatmap:",e)}};R([D,A],()=>{D.length>0&&setTimeout(()=>{J()},200)},{deep:!1});const Q=()=>{"undefined"!=typeof window&&setTimeout(()=>{document.querySelector(".metrics-panel")},100)};n(async()=>{A.value||o.setSelectedBank(Ws),D?.value?.length>0&&!B.value&&(B.value=D.value[0]),Q(),setTimeout(async()=>{try{await J(),console.log("3D Correlation Heatmap initialized")}catch(e){console.error("Failed to initialize 3D Correlation Heatmap:",e)}},500),window.addEventListener("resize",Q),document.addEventListener("click",G)}),r(()=>{window.removeEventListener("resize",Q),document.removeEventListener("click",G)});const ee=e=>B.value=e,te=()=>{ae("PDF экспорт инициирован...","info"),setTimeout(()=>{ae("Файл portfolio_2026-01-06.pdf загружен","success")},1200)},ae=(e,t="success")=>{x.value={show:!0,message:e,type:t},setTimeout(()=>{x.value.show=!1},3e3)},ne=e=>{const t=Math.abs(e);return 1===e?"rgba(255,255,255,0.05)":e>0?`rgba(59, 130, 246, ${t})`:`rgba(239, 68, 68, ${t})`},re=e=>Math.abs(e.allocation-e.targetAllocation)<.5?"text-muted":e.allocation-e.targetAllocation>0?"text-green":"text-red";return(e,t)=>{const a=d("router-link");return w(),i("div",Xs,[s("div",$s,[s("div",Ks,[s("div",Zs,[s("h1",null,[t[7]||(t[7]=m("Управление портфелем ценных бумаг банка: ",-1)),s("span",Js,[s("div",Qs,[s("div",{class:c(["bank-selector",{"is-open":L.value}]),onClick:H},[s("div",el,[s("span",tl,v(O(A)?.name||"Выберите банк"),1),s("span",al,"№ "+v(O(A)?.regNumber||""),1)]),t[4]||(t[4]=s("svg",{class:"bank-selector-chevron",width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M1 1L6 6L11 1"})],-1))],2),u(M,{name:"dropdown-fade"},{default:h(()=>[L.value?(w(),i("div",nl,[s("div",rl,[t[5]||(t[5]=s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),T(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>F.value=e),placeholder:"Поиск банка...",class:"bank-search-input",onClick:t[1]||(t[1]=E(()=>{},["stop"]))},null,512),[[k,F.value]])]),s("div",il,[(w(!0),i(p,null,f(V.value,e=>(w(),i("div",{key:e.regNumber,class:c(["bank-dropdown-item",{"is-selected":e.regNumber===O(A).regNumber}]),onClick:t=>(e=>{o.setSelectedBank(e),L.value=!1,F.value="",ae(`Выбран банк: ${e.name} (№ ${e.regNumber})`,"info")})(e)},[s("div",sl,[s("span",ll,v(e.name),1),s("span",cl,"№ "+v(e.regNumber),1)]),e.regNumber===O(A).regNumber?(w(),i("svg",ul,[...t[6]||(t[6]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):l("",!0)],10,ol))),128))])])):l("",!0)]),_:1})])])])]),t[8]||(t[8]=I('<div class="hero-meta" data-v-0d01e5b8><span class="glass-pill" data-v-0d01e5b8>Стратегия: <strong data-v-0d01e5b8>Мультиактив</strong></span><span class="glass-pill" data-v-0d01e5b8>Ребалансировка: <strong data-v-0d01e5b8>Ежемесячно</strong></span><span class="glass-pill risk-aggressive" data-v-0d01e5b8><span class="status-dot" data-v-0d01e5b8></span> Риск: Агрессивный </span></div>',1))]),s("div",dl,[s("div",hl,[t[9]||(t[9]=m("Обновлено: ",-1)),s("span",pl,v(g.value),1)]),s("button",{class:"btn-glass outline",onClick:te},[...t[10]||(t[10]=[s("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),m(" Экспорт PDF ",-1)])])])]),s("div",fl,[s("div",ml,[s("div",vl,[t[11]||(t[11]=s("span",{class:"kpi-label"},"Общий P&L",-1)),s("div",{class:c(["trend-badge",_.value?.annual_return&&_.value.annual_return>=0?"positive":"negative"])},[(w(),i("svg",gl,[_.value?.annual_return&&_.value.annual_return>=0?(w(),i("path",yl)):(w(),i("path",bl))])),m(" "+v(_.value?(100*_.value.annual_return).toFixed(1)+"%":"12.4%"),1)],2)]),s("div",xl,[s("div",wl,[m(v(_.value?_.value.total_pnl.toLocaleString("ru-RU",{maximumFractionDigits:0}):"452,109")+" ",1),t[12]||(t[12]=s("small",null,"RUB",-1))]),s("div",_l,"ЧСА: "+v(_.value?(_.value.nav/1e6).toFixed(2)+"M":"3.64M"),1)])]),s("div",Sl,[s("div",Ml,[t[14]||(t[14]=s("span",{class:"kpi-label"},"VaR 95%",-1)),s("div",Tl,[t[13]||(t[13]=s("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"4"},[s("path",{d:"M6 9l6 6 6-6"})],-1)),m(" "+v(_.value?_.value.var_95_percent.toFixed(1)+"%":"1.2%"),1)])]),s("div",kl,[s("div",Cl,v(_.value?_.value.var_95_percent.toFixed(2)+"%":"2.45%"),1),t[15]||(t[15]=s("div",{class:"kpi-sub"},"Дневной риск",-1))])]),s("div",Al,[t[16]||(t[16]=s("div",{class:"kpi-header"},[s("span",{class:"kpi-label"},"Sharpe Ratio")],-1)),s("div",El,[s("div",Il,v(_.value?_.value.sharpe_ratio.toFixed(2):"1.85"),1),s("div",Rl,"Безрисковая ставка: "+v(_.value?(100*_.value.risk_free_rate).toFixed(1)+"%":"4.2%"),1)])]),s("div",Dl,[t[17]||(t[17]=s("div",{class:"kpi-header"},[s("span",{class:"kpi-label"},"Диверсификация")],-1)),s("div",Pl,[s("div",Ll,v(_.value?_.value.diversification.toFixed(2):"0.34"),1),s("div",Nl,"Коэфф. корреляции: "+v(_.value?_.value.avg_correlation.toFixed(2):"0.34"),1)])])]),s("div",Ol,[s("div",Fl,[s("div",Bl,[s("div",{class:"panel-header"},[t[19]||(t[19]=s("div",null,[s("h3",null,"Открытые позиции"),s("span",{class:"panel-subtitle"},"Топ-5 по весу в портфеле")],-1)),s("div",{class:"panel-header-actions"},[s("button",{class:"btn-glass outline compact",onClick:X},[...t[18]||(t[18]=[I('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-0d01e5b8><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-0d01e5b8></path><polyline points="14 2 14 8 20 8" data-v-0d01e5b8></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-0d01e5b8></line><line x1="16" y1="17" x2="8" y2="17" data-v-0d01e5b8></line><polyline points="10 9 9 9 8 9" data-v-0d01e5b8></polyline></svg> Детализация ',2)])])])]),s("div",Ul,[s("div",zl,[s("table",Vl,[t[20]||(t[20]=s("thead",null,[s("tr",null,[s("th",null,"Инструмент"),s("th",{class:"text-right"},"Цена"),s("th",{class:"text-right"},"День %"),s("th",{class:"text-right"},"Позиция"),s("th",{class:"text-right"},"Вес"),s("th",{class:"text-right"},"Таргет"),s("th",{class:"text-right"},"Дрифт")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(W.value,e=>(w(),i("tr",{key:e.symbol,onClick:t=>ee(e),class:c({active:B.value?.symbol===e.symbol})},[s("td",null,[s("div",Gl,[s("div",{class:"asset-icon",style:y({background:e.color})},v(e.symbol[0]),5),s("div",Wl,[s("span",ql,v(e.symbol),1),s("span",Yl,v(e.name),1)])])]),s("td",jl,"$"+v(e.price),1),s("td",Xl,[s("span",{class:c(["change-pill",e.dayChange>0?"text-green":"text-red"])},v(e.dayChange>0?"+":"")+v(e.dayChange)+"%",3)]),s("td",$l,"$"+v((e.notional/1e3).toFixed(1))+"k",1),s("td",Kl,v(e.allocation)+"%",1),s("td",Zl,v(e.targetAllocation)+"%",1),s("td",Jl,[s("div",{class:c(["drift-val",re(e)])},v((e.allocation-e.targetAllocation).toFixed(1))+"%",3)])],10,Hl))),128))])])])])]),s("div",Ql,[t[22]||(t[22]=s("div",{class:"panel-header"},[s("h3",null,"Матрица Корреляций")],-1)),s("div",ec,[s("div",tc,[s("div",ac,[t[21]||(t[21]=s("div",{class:"heatmap-empty"},null,-1)),(w(!0),i(p,null,f(K.value.slice(0,10),e=>(w(),i("div",{key:e.label,class:"heatmap-th"},v(e.label),1))),128))]),(w(!0),i(p,null,f(K.value.slice(0,10),(e,t)=>(w(),i("div",{class:"heatmap-row",key:t},[s("div",nc,v(e.label),1),(w(!0),i(p,null,f(e.values.slice(0,10),(e,t)=>(w(),i("div",{class:"heatmap-cell",key:t,style:y({backgroundColor:ne(e)})},v(1===e?"1.0":e.toFixed(2)),5))),128))]))),128))])])]),s("div",rc,[t[32]||(t[32]=s("div",{class:"panel-header"},[s("h3",null,"3D Тепловая карта активов"),s("span",{class:"panel-badge"},"Интерактивная визуализация")],-1)),s("div",ic,[t[30]||(t[30]=s("p",{class:"section-description",style:{"margin-bottom":"8px",padding:"6px 10px",border:"1px solid rgba(255,255,255,0.1)","border-radius":"6px",background:"rgba(0,0,0,0.2)","font-size":"11px","line-height":"1.4"}},[m(" Каждый актив представлен шариком. Размер = вес в портфеле, цвет = цвет актива. Позиция в 3D пространстве основана на корреляциях между активами. "),s("br"),s("strong",null,"Наведите на шарик"),m(" для детализации позиции. ")],-1)),t[31]||(t[31]=s("div",{id:"correlation-3d-heatmap",style:{width:"100%",height:"500px",position:"relative","min-height":"500px",background:"rgba(0,0,0,0.1)","border-radius":"8px","margin-bottom":"0",display:"block",visibility:"visible",opacity:"1"}},null,-1)),U.value?(w(),i("div",oc,[s("div",sc,[s("div",{class:"asset-icon",style:y({background:U.value.color})},v(U.value.symbol[0]),5),s("div",null,[s("div",lc,v(U.value.symbol),1),s("div",cc,v(U.value.name),1)])]),s("div",uc,[s("div",dc,[t[23]||(t[23]=s("span",null,"Тип:",-1)),s("strong",null,v(U.value.symbol.includes("ОФЗ")||U.value.symbol.includes("Облигац")?"Облигация":"Акция"),1)]),void 0!==U.value.volatility?(w(),i("div",hc,[t[24]||(t[24]=s("span",null,"Волатильность:",-1)),s("strong",null,v(U.value.volatility?.toFixed(1)||"Н/Д")+"%",1)])):l("",!0),void 0!==U.value.avgCorrelation?(w(),i("div",pc,[t[25]||(t[25]=s("span",null,"Ср. корреляция:",-1)),s("strong",null,v(U.value.avgCorrelation?.toFixed(2)||"Н/Д"),1)])):l("",!0),s("div",fc,[t[26]||(t[26]=s("span",null,"Вес в портфеле:",-1)),s("strong",null,v(U.value.allocation?.toFixed(2)||U.value.allocation)+"%",1)]),s("div",mc,[t[27]||(t[27]=s("span",null,"Цена:",-1)),s("strong",null,v(U.value.price?.toLocaleString("ru-RU")||U.value.price)+" ₽",1)]),s("div",vc,[t[28]||(t[28]=s("span",null,"Дневное изм.:",-1)),s("strong",{class:c(U.value.dayChange>=0?"text-green":"text-red")},v(U.value.dayChange>=0?"+":"")+v(U.value.dayChange?.toFixed(2)||U.value.dayChange)+"% ",3)]),U.value.notional?(w(),i("div",gc,[t[29]||(t[29]=s("span",null,"Позиция:",-1)),s("strong",null,"$"+v((U.value.notional/1e3).toFixed(1))+"k",1)])):l("",!0)])])):l("",!0)])])]),s("aside",yc,[u(M,{name:"fade"},{default:h(()=>[B.value?(w(),i("div",bc,[s("div",xc,[s("div",wc,[s("div",{class:"asset-lg-icon",style:y({background:B.value.color})},v(B.value.symbol[0]),5),s("div",_c,[s("h2",null,v(B.value.symbol),1),s("span",null,v(B.value.name),1)])]),s("div",Sc,v(B.value.symbol.includes("ОФЗ")||B.value.symbol.includes("Облигац")||B.value.symbol.includes("обл")?"Облигация":"Акция"),1)]),s("div",Mc,[s("div",Tc,[s("div",kc,[(w(!0),i(p,null,f((B.value.symbol,Array.from({length:20},()=>80*Math.random()+20)),(e,t)=>(w(),i("div",{key:t,class:"chart-bar",style:y({height:e+"%",backgroundColor:t>15?"#4ade80":"rgba(255,255,255,0.2)"})},null,4))),128))]),t[33]||(t[33]=s("div",{class:"chart-meta"},[s("span",{class:"active"},"1Д"),s("span",null,"1Н"),s("span",null,"1М"),s("span",null,"3М"),s("span",null,"1Г")],-1))]),t[34]||(t[34]=s("div",{class:"inspector-grid"},[s("div",{class:"metric-cell"},[s("label",null,"Доходность"),s("span",{class:"text-green"},"+14.2%")]),s("div",{class:"metric-cell"},[s("label",null,"Волатильность"),s("span",null,"18.5%")]),s("div",{class:"metric-cell"},[s("label",null,"Beta"),s("span",null,"1.12")]),s("div",{class:"metric-cell"},[s("label",null,"Max DD"),s("span",{class:"text-red"},"-12.4%")])],-1)),t[35]||(t[35]=s("div",{class:"micro-metrics"},[s("div",{class:"micro-metric"},[s("span",{class:"label"},"Sharpe"),s("span",{class:"value"},"0.92")]),s("div",{class:"micro-metric"},[s("span",{class:"label"},"Sortino"),s("span",{class:"value"},"1.38")]),s("div",{class:"micro-metric"},[s("span",{class:"label"},"Skew"),s("span",{class:"value"},"-0.24")])],-1))])])):l("",!0)]),_:1}),s("div",Cc,[s("div",Ac,[t[37]||(t[37]=I('<div class="optimizer-link-icon" data-v-0d01e5b8><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-0d01e5b8><path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" data-v-0d01e5b8></path></svg></div><h3 class="optimizer-link-title" data-v-0d01e5b8>Оптимизация портфеля</h3><p class="optimizer-link-description" data-v-0d01e5b8> Стохастическое оптимизирование с HJB-стратегией и CCMV модель оптимизации </p><div class="optimizer-link-features" data-v-0d01e5b8><span class="feature-tag" data-v-0d01e5b8>HJB-стратегия</span><span class="feature-tag" data-v-0d01e5b8>CCMV</span></div>',4)),u(a,{to:"/CCMVoptimization",class:"btn-glass primary w-full optimizer-link-btn"},{default:h(()=>[...t[36]||(t[36]=[s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M9 5l7 7-7 7"})],-1),m(" Перейти к оптимизации ",-1)])]),_:1})])]),s("div",Ec,[t[47]||(t[47]=s("div",{class:"panel-header-mini"},[s("span",{class:"panel-title-mini"},"Риск и Статистика")],-1)),s("div",Ic,[t[44]||(t[44]=s("div",{class:"metric-row"},[s("div",{class:"metric-label"},[s("span",null,"Expected Shortfall"),s("span",{class:"meta-hint"},"CVaR 95%")]),s("div",{class:"metric-value text-red"},"-3.78%")],-1)),s("div",Rc,[t[38]||(t[38]=s("div",{class:"metric-label"},[s("span",null,"Max Drawdown"),s("span",{class:"meta-hint"},"От пика до минимума")],-1)),s("div",Dc,v(_.value?(100*_.value.max_drawdown).toFixed(2)+"%":"-18.24%"),1)]),t[45]||(t[45]=I('<div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Calmar Ratio</span><span class="meta-hint" data-v-0d01e5b8>Доходность / Max DD</span></div><div class="metric-value text-white" data-v-0d01e5b8>1.41</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Скользящая волатильность (30Д)</span><span class="meta-hint" data-v-0d01e5b8>Годовая</span></div><div class="metric-value text-white" data-v-0d01e5b8>12.8%</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Доходность с начала года</span><span class="meta-hint" data-v-0d01e5b8>YTD</span></div><div class="metric-value text-green" data-v-0d01e5b8>+8.42%</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Процент выигрышей</span><span class="meta-hint" data-v-0d01e5b8>% прибыльных</span></div><div class="metric-value text-green" data-v-0d01e5b8>58.3%</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Фактор прибыли</span><span class="meta-hint" data-v-0d01e5b8>Валовая П / Валовая У</span></div><div class="metric-value text-white" data-v-0d01e5b8>1.87x</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Средняя сделка</span><span class="meta-hint" data-v-0d01e5b8>Средняя доходность</span></div><div class="metric-value text-white" data-v-0d01e5b8>+0.34%</div></div>',6)),s("div",Pc,[t[39]||(t[39]=s("div",{class:"metric-label"},[s("span",null,"Sharpe Ratio"),s("span",{class:"meta-hint"},"Скорректированный на риск")],-1)),s("div",Lc,v(_.value?_.value.sharpe_ratio.toFixed(2):"1.52"),1)]),s("div",Nc,[t[40]||(t[40]=s("div",{class:"metric-label"},[s("span",null,"Sortino Ratio"),s("span",{class:"meta-hint"},"Риск снижения")],-1)),s("div",Oc,v(_.value?_.value.sortino_ratio.toFixed(2):"2.14"),1)]),s("div",Fc,[t[41]||(t[41]=s("div",{class:"metric-label"},[s("span",null,"Beta"),s("span",{class:"meta-hint"},"относительно бенчмарка")],-1)),s("div",Bc,v(_.value?_.value.beta.toFixed(2):"0.87"),1)]),s("div",Uc,[t[42]||(t[42]=s("div",{class:"metric-label"},[s("span",null,"Alpha"),s("span",{class:"meta-hint"},"Избыточная доходность")],-1)),s("div",{class:c(["metric-value",_.value?.alpha&&_.value.alpha>=0?"text-green":"text-red"])},v(_.value?(_.value.alpha>=0?"+":"")+(100*_.value.alpha).toFixed(2)+"%":"+2.31%"),3)]),s("div",zc,[t[43]||(t[43]=s("div",{class:"metric-label"},[s("span",null,"VaR (95%)"),s("span",{class:"meta-hint"},"Дневной")],-1)),s("div",Vc,v(_.value?(-1*_.value.var_95_percent).toFixed(2)+"%":"-2.15%"),1)]),t[46]||(t[46]=I('<div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Information Ratio</span><span class="meta-hint" data-v-0d01e5b8>Активная доходность / Ошибка отслеживания</span></div><div class="metric-value text-green" data-v-0d01e5b8>0.94</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Treynor Ratio</span><span class="meta-hint" data-v-0d01e5b8>Доходность / Beta</span></div><div class="metric-value text-white" data-v-0d01e5b8>9.67%</div></div><div class="metric-row" data-v-0d01e5b8><div class="metric-label" data-v-0d01e5b8><span data-v-0d01e5b8>Tracking Error</span><span class="meta-hint" data-v-0d01e5b8>относительно индекса</span></div><div class="metric-value text-white" data-v-0d01e5b8>3.42%</div></div>',3))])])])]),s("div",Hc,[t[48]||(t[48]=s("div",{class:"panel-header"},[s("h3",null,"3D Визуализация Корреляций"),s("span",{class:"panel-badge"},"Интерактивный анализ")],-1)),s("div",Gc,[u(Hs,{"available-assets":Z.value},null,8,["available-assets"])])]),u(M,{name:"modal-fade"},{default:h(()=>[q.value?(w(),i("div",{key:0,class:"modal-overlay",onClick:$},[s("div",{class:c(["modal-container",{"modal-compact":j.value.length<=20}]),onClick:t[3]||(t[3]=E(()=>{},["stop"]))},[s("div",{class:"modal-header"},[t[50]||(t[50]=s("h2",null,"Детализация портфеля ценных бумаг",-1)),s("button",{class:"modal-close",onClick:$},[...t[49]||(t[49]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",Wc,[s("div",qc,[t[51]||(t[51]=s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),T(s("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>Y.value=e),placeholder:"Поиск по инструменту или названию...",class:"modal-search-input"},null,512),[[k,Y.value]])]),s("div",Yc,[s("table",jc,[t[52]||(t[52]=s("thead",null,[s("tr",null,[s("th",null,"Инструмент"),s("th",{class:"text-right"},"Цена"),s("th",{class:"text-right"},"День %"),s("th",{class:"text-right"},"Позиция"),s("th",{class:"text-right"},"Вес"),s("th",{class:"text-right"},"Таргет"),s("th",{class:"text-right"},"Дрифт")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(j.value,e=>(w(),i("tr",{key:e.symbol,onClick:t=>{ee(e),$()},class:c({active:B.value?.symbol===e.symbol})},[s("td",null,[s("div",$c,[s("div",{class:"asset-icon",style:y({background:e.color})},v(e.symbol[0]),5),s("div",Kc,[s("span",Zc,v(e.symbol),1),s("span",Jc,v(e.name),1)])])]),s("td",Qc,"$"+v(e.price),1),s("td",eu,[s("span",{class:c(["change-pill",e.dayChange>0?"text-green":"text-red"])},v(e.dayChange>0?"+":"")+v(e.dayChange)+"%",3)]),s("td",tu,"$"+v((e.notional/1e3).toFixed(1))+"k",1),s("td",au,v(e.allocation)+"%",1),s("td",nu,v(e.targetAllocation)+"%",1),s("td",ru,[s("div",{class:c(["drift-val",re(e)])},v((e.allocation-e.targetAllocation).toFixed(1))+"%",3)])],10,Xc))),128))])])]),s("div",iu,[s("div",ou,[s("span",null,[t[53]||(t[53]=m("Всего позиций: ",-1)),s("strong",null,v(O(D).length),1)]),s("span",null,[t[54]||(t[54]=m("Отображается: ",-1)),s("strong",null,v(j.value.length),1)])])])])],2)])):l("",!0)]),_:1}),u(M,{name:"slide-up"},{default:h(()=>[x.value.show?(w(),i("div",{key:0,class:c(["toast-notification","toast-"+x.value.type])},v(x.value.message),3)):l("",!0)]),_:1})])}}}),lu=xe(su,[["__scopeId","data-v-0d01e5b8"]]),cu={class:"page-header"},uu={class:"header-content"},du={class:"header-left"},hu={class:"header-title font-anton"},pu={key:0,class:"header-subtitle font-mono"},fu={key:0,class:"header-actions"},mu=e({__name:"PageHeader",props:{title:{},subtitle:{}},setup:e=>(t,a)=>(w(),i("div",cu,[s("div",uu,[s("div",du,[s("h1",hu,v(e.title),1),e.subtitle?(w(),i("p",pu,v(e.subtitle),1)):l("",!0)]),t.$slots.actions?(w(),i("div",fu,[F(t.$slots,"actions",{},void 0)])):l("",!0)]),a[0]||(a[0]=s("div",{class:"header-divider"},null,-1))]))}),vu=xe(mu,[["__scopeId","data-v-ece41ea2"]]),gu={key:0,class:"card-header"},yu={class:"card-title font-oswald"},bu={key:0,class:"card-badge font-mono"},xu={class:"card-body"},wu=e({__name:"BrutalistCard",props:{variant:{default:"default"},title:{},badge:{},hoverable:{type:Boolean,default:!1}},setup:e=>(t,a)=>(w(),i("div",{class:c(["brutalist-card",[`brutalist-card--${e.variant}`,{"brutalist-card--hoverable":e.hoverable}]])},[e.title||t.$slots.header?(w(),i("div",gu,[F(t.$slots,"header",{},()=>[s("h3",yu,v(e.title),1),e.badge?(w(),i("span",bu,v(e.badge),1)):l("",!0)])])):l("",!0),s("div",xu,[F(t.$slots,"default",{},void 0)])],2))}),_u=xe(wu,[["__scopeId","data-v-9c46667c"]]),Su={class:"stat-header"},Mu={class:"stat-label font-mono"},Tu={key:0,width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},ku={key:1,width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},Cu={class:"font-mono"},Au={class:"stat-content"},Eu={key:0,class:"stat-unit"},Iu={key:0,class:"stat-subtext font-mono"},Ru=e({__name:"StatCard",props:{label:{},value:{},unit:{},trend:{},subtext:{},variant:{default:"default"},glow:{type:Boolean,default:!1},format:{default:"number"}},setup(e){const t=e,a=S(()=>{if("string"==typeof t.value)return t.value;switch(t.format){case"currency":return t.value.toLocaleString("ru-RU",{maximumFractionDigits:0});case"percent":return`${(100*t.value).toFixed(2)}%`;default:return t.value.toLocaleString("ru-RU",{maximumFractionDigits:2})}}),n=S(()=>({"trend-positive":void 0!==t.trend&&t.trend>=0,"trend-negative":void 0!==t.trend&&t.trend<0})),r=S(()=>({"value-positive":"positive"===t.variant,"value-negative":"negative"===t.variant,"value-warning":"warning"===t.variant}));return(t,o)=>{return w(),i("div",{class:c(["stat-card",[`stat-card--${e.variant}`,{"stat-card--glow":e.glow}]])},[s("div",Su,[s("span",Mu,v(e.label),1),void 0!==e.trend?(w(),i("div",{key:0,class:c(["stat-trend",n.value])},[e.trend>=0?(w(),i("svg",Tu,[...o[0]||(o[0]=[s("path",{d:"M18 15l-6-6-6 6"},null,-1)])])):(w(),i("svg",ku,[...o[1]||(o[1]=[s("path",{d:"M6 9l6 6 6-6"},null,-1)])])),s("span",Cu,v((u=e.trend,`${u>=0?"+":""}${(100*u).toFixed(1)}%`)),1)],2)):l("",!0)]),s("div",Au,[s("div",{class:c(["stat-value font-oswald",r.value])},[m(v(a.value)+" ",1),e.unit?(w(),i("small",Eu,v(e.unit),1)):l("",!0)],2),e.subtext?(w(),i("div",Iu,v(e.subtext),1)):l("",!0)])],2);var u}}}),Du=xe(Ru,[["__scopeId","data-v-e889528d"]]),Pu={class:"page-container"},Lu={class:"action-pill action-pill--status"},Nu={class:"font-mono"},Ou={class:"dashboard-layout dashboard-layout--sidebar-left"},Fu={class:"controls-column"},Bu={class:"form-section"},Uu={class:"form-group"},zu={class:"input-wrapper"},Vu={class:"form-group"},Hu={class:"input-wrapper"},Gu={class:"form-group"},Wu={class:"input-wrapper"},qu={class:"form-row"},Yu={class:"form-group"},ju={class:"form-group"},Xu=["disabled"],$u={key:0},Ku={key:1},Zu={class:"metrics-row"},Ju={class:"metric-item"},Qu={class:"metric-value metric-value--negative font-mono"},ed={class:"metric-item"},td={class:"metric-value metric-value--positive font-mono"},ad={class:"metric-item"},nd={class:"metric-value font-mono"},rd={class:"viz-column"},id={class:"kpi-grid"},od={class:"chart-header-content"},sd={class:"chart-title-group"},ld={key:0,class:"live-badge font-mono"},cd={key:0,class:"playback-controls"},ud={key:0},dd={key:1},hd={class:"timeline-wrapper"},pd=["max"],fd={class:"chart-container"},md={key:0,viewBox:"0 0 1000 400",preserveAspectRatio:"none",class:"main-svg"},vd=["y1","y2"],gd=["d"],yd=["d"],bd=["d"],xd=["d"],wd=["d"],_d=["x1","x2"],Sd={key:1,class:"empty-state"},Md={key:0,class:"spinner"},Td={key:1,class:"font-mono"},kd=e({__name:"MonteCarlo",setup(e){const n=_e(),o=t(!1),d=a({startPrice:100,volatility:15.5,drift:8,days:252,paths:1e3,model:"gbm"}),m=t(0),g=t(!1);let x=null;const _=t(null),S=a({paths:[],displayPaths:[],medianPath:[],q05:[],q95:[],minY:0,maxY:200}),C=async()=>{if(o.value)return;o.value=!0,_.value=null,E();const e=n.addTask(`Monte Carlo (${d.paths} paths)`,"simulation");try{let t=0;const a=setInterval(()=>{t+=10,n.updateProgress(e,t),t>=100&&(clearInterval(a),D(),P(),o.value=!1,m.value=0,A())},100)}catch(TQe){n.failTask(e),o.value=!1}},A=()=>{g.value?E():(m.value>=d.days&&(m.value=0),g.value=!0,R())},E=()=>{g.value=!1,x&&cancelAnimationFrame(x)},I=()=>{E(),m.value=0},R=()=>{if(!g.value)return;const e=m.value+Math.max(1,Math.floor(d.days/100));e>=d.days?(m.value=d.days,E()):(m.value=e,x=requestAnimationFrame(R))},D=()=>{const{startPrice:e,volatility:t,drift:a,days:n,paths:r}=d,i=1/252,o=a/100,s=t/100,l=[];for(let d=0;d<r;d++){const t=[e];let a=e;for(let e=1;e<=n;e++){const e=L(),n=(o-.5*s*s)*i,r=s*Math.sqrt(i)*e;a*=Math.exp(n+r),t.push(a)}l.push(t)}const c=n+1,u=[],h=[],p=[];let f=e,v=e;for(let d=0;d<c;d++){const e=l.map(e=>e[d]).sort((e,t)=>e-t),t=e[Math.floor(.5*r)],a=e[Math.floor(.05*r)],n=e[Math.floor(.95*r)];u.push(t),h.push(a),p.push(n),a<f&&(f=a),n>v&&(v=n)}S.paths=l,S.displayPaths=l.slice(0,50),S.medianPath=u,S.q05=h,S.q95=p,S.minY=.9*f,S.maxY=1.1*v,g.value||(m.value=n)},P=()=>{const e=S.paths.map(e=>e[e.length-1]);e.sort((e,t)=>e-t);const t=e.length,a=e.reduce((e,t)=>e+t,0)/t,n=e[Math.floor(.05*t)],r=e.filter(e=>e>d.startPrice).length;_.value={mean:a,min:e[0],max:e[t-1],median:e[Math.floor(.5*t)],var95:n,meanChange:((a-d.startPrice)/d.startPrice*100).toFixed(2),realizedVol:d.volatility,winProb:(r/t*100).toFixed(1)}},L=()=>{let e=0,t=0;for(;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)},N=e=>e/d.days*1e3,O=e=>{const t=S.maxY-S.minY;return 400-400*((e-S.minY)/t)},F=(e,t)=>{if(!e.length)return"";return"M "+e.slice(0,t+1).map((e,t)=>`${N(t).toFixed(1)},${O(e).toFixed(1)}`).join(" L ")},B=(e,t,a)=>{if(!e.length)return"";const n=e.slice(0,a+1),r=t.slice(0,a+1);let i="M "+n.map((e,t)=>`${N(t).toFixed(1)},${O(e).toFixed(1)}`).join(" L ");for(let o=r.length-1;o>=0;o--)i+=` L ${N(o).toFixed(1)},${O(r[o]).toFixed(1)}`;return i+=" Z",i},U=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(e);return r(()=>{x&&cancelAnimationFrame(x)}),(e,t)=>(w(),i("div",Pu,[u(vu,{title:"Симуляция Монте-Карло",subtitle:"Генерация стохастических сценариев (GBM Model)"},{actions:h(()=>[s("div",Lu,[s("span",{class:c(["dot",o.value?"":"dot--green"])},null,2),s("span",Nu,v(o.value?"Вычисление...":"Готов к запуску"),1)])]),_:1}),s("div",Ou,[s("aside",Fu,[u(_u,{title:"Параметры модели"},{default:h(()=>[s("div",Bu,[s("div",Uu,[t[7]||(t[7]=s("label",{class:"form-label"},"Начальная цена (S₀)",-1)),s("div",zu,[T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>d.startPrice=e),type:"number",class:"form-control"},null,512),[[k,d.startPrice,void 0,{number:!0}]]),t[6]||(t[6]=s("span",{class:"input-suffix font-mono"},"$",-1))])]),s("div",Vu,[t[9]||(t[9]=s("label",{class:"form-label"},"Волатильность (σ)",-1)),s("div",Hu,[T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>d.volatility=e),type:"number",step:"0.1",class:"form-control"},null,512),[[k,d.volatility,void 0,{number:!0}]]),t[8]||(t[8]=s("span",{class:"input-suffix font-mono"},"%",-1))])]),s("div",Gu,[t[11]||(t[11]=s("label",{class:"form-label"},"Доходность (μ)",-1)),s("div",Wu,[T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>d.drift=e),type:"number",step:"0.1",class:"form-control"},null,512),[[k,d.drift,void 0,{number:!0}]]),t[10]||(t[10]=s("span",{class:"input-suffix font-mono"},"%",-1))])]),t[14]||(t[14]=s("div",{class:"divider"},null,-1)),s("div",qu,[s("div",Yu,[t[12]||(t[12]=s("label",{class:"form-label"},"Дней (T)",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>d.days=e),type:"number",class:"form-control"},null,512),[[k,d.days,void 0,{number:!0}]])]),s("div",ju,[t[13]||(t[13]=s("label",{class:"form-label"},"Путей (N)",-1)),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>d.paths=e),type:"number",step:"1000",class:"form-control"},null,512),[[k,d.paths,void 0,{number:!0}]])])]),s("button",{onClick:C,disabled:o.value,class:"btn btn-primary btn-full"},[o.value?(w(),i("span",Ku,"Расчет...")):(w(),i("span",$u,"Запустить симуляцию"))],8,Xu)])]),_:1}),u(M,{name:"fade"},{default:h(()=>[_.value?(w(),b(_u,{key:0,title:`Результаты (T=${d.days})`},{default:h(()=>[s("div",Zu,[s("div",Ju,[t[15]||(t[15]=s("span",{class:"metric-label"},"Мин. цена",-1)),s("span",Qu,v(U(_.value.min)),1)]),s("div",ed,[t[16]||(t[16]=s("span",{class:"metric-label"},"Макс. цена",-1)),s("span",td,v(U(_.value.max)),1)]),s("div",ad,[t[17]||(t[17]=s("span",{class:"metric-label"},"Медиана",-1)),s("span",nd,v(U(_.value.median)),1)])])]),_:1},8,["title"])):l("",!0)]),_:1})]),s("main",rd,[s("div",id,[u(Du,{label:"Среднее (Mean)",value:_.value?U(_.value.mean):"—",variant:_.value?.meanChange>0?"positive":"negative"},null,8,["value","variant"]),u(Du,{label:"VaR (95%)",value:_.value?U(_.value.var95):"—",variant:"negative"},null,8,["value"]),u(Du,{label:"Вероятность роста",value:_.value?_.value.winProb+"%":"—",variant:"positive"},null,8,["value"]),u(Du,{label:"День симуляции",value:`${m.value} / ${d.days}`},null,8,["value"])]),u(_u,{variant:"dark"},{header:h(()=>[s("div",od,[s("div",sd,[t[18]||(t[18]=s("h3",{class:"panel-title font-oswald"},"Траектории",-1)),g.value?(w(),i("span",ld,"● LIVE")):l("",!0)]),S.paths.length?(w(),i("div",cd,[s("button",{class:"control-btn",onClick:A,title:"Play/Pause"},[g.value?(w(),i("span",ud,"⏸")):(w(),i("span",dd,"▶"))]),s("div",hd,[T(s("input",{type:"range",min:"0",max:d.days,"onUpdate:modelValue":t[5]||(t[5]=e=>m.value=e),onInput:E,class:"timeline-slider"},null,40,pd),[[k,m.value,void 0,{number:!0}]]),s("div",{class:"timeline-track",style:y({width:m.value/d.days*100+"%"})},null,4)]),s("button",{class:"control-btn",onClick:I,title:"Reset"},"↺")])):l("",!0)])]),default:h(()=>[s("div",fd,[S.paths.length>0?(w(),i("svg",md,[t[19]||(t[19]=s("line",{x1:"0",y1:"350",x2:"1000",y2:"350",stroke:"rgba(255,255,255,0.05)"},null,-1)),t[20]||(t[20]=s("line",{x1:"0",y1:"200",x2:"1000",y2:"200",stroke:"rgba(255,255,255,0.05)"},null,-1)),t[21]||(t[21]=s("line",{x1:"0",y1:"50",x2:"1000",y2:"50",stroke:"rgba(255,255,255,0.05)"},null,-1)),s("line",{x1:"0",y1:O(d.startPrice),x2:"1000",y2:O(d.startPrice),stroke:"rgba(255,255,255,0.2)","stroke-dasharray":"4"},null,8,vd),(w(!0),i(p,null,f(S.displayPaths,(e,t)=>(w(),i("path",{key:`path-${t}`,d:F(e,m.value),fill:"none",stroke:"rgba(220, 38, 38, 0.15)","stroke-width":"1"},null,8,gd))),128)),s("path",{d:B(S.q05,S.q95,m.value),fill:"rgba(220, 38, 38, 0.08)",stroke:"none"},null,8,yd),s("path",{d:F(S.medianPath,m.value),fill:"none",stroke:"#DC2626","stroke-width":"2.5"},null,8,bd),s("path",{d:F(S.q05,m.value),fill:"none",stroke:"#f87171","stroke-width":"1.5","stroke-dasharray":"4"},null,8,xd),s("path",{d:F(S.q95,m.value),fill:"none",stroke:"#22c55e","stroke-width":"1.5","stroke-dasharray":"4"},null,8,wd),m.value>0?(w(),i("line",{key:0,x1:N(m.value),y1:"0",x2:N(m.value),y2:"400",stroke:"rgba(255,255,255,0.4)","stroke-dasharray":"2"},null,8,_d)):l("",!0)])):(w(),i("div",Sd,[o.value?(w(),i("div",Md)):(w(),i("span",Td,"Нажмите «Запустить» для генерации"))]))])]),_:1})])])]))}}),Cd=xe(kd,[["__scopeId","data-v-9a0f2b79"]]),Ad=_("riskMetrics",()=>{const e=t(null),a=t([]),n=t(24e5),r=S(()=>e.value?.var95||0),i=S(()=>e.value?.var99||0),o=S(()=>e.value?.cvar95||0),s=S(()=>e.value?.cvar99||0),l=S(()=>e.value?.expectedReturn||0),c=S(()=>e.value?.volatility||0),u=S(()=>e.value?.sharpeRatio||0),d=S(()=>e.value?.portfolioBeta||.85),h=S(()=>e.value?.riskContributions||[]),p=S(()=>e.value?.maxDrawdown||0);return{metrics:e,stressScenarios:a,totalEquity:n,updateMetrics:t=>{e.value||(e.value={var95:0,var99:0,cvar95:0,cvar99:0,expectedReturn:0,volatility:0,sharpeRatio:0,portfolioBeta:.85,riskContributions:[],maxDrawdown:0,timestamp:new Date}),e.value={...e.value,...t,timestamp:new Date}},calculateRiskContributions:(e,t,a,r=n.value)=>{if(!e.length||0===t)return[];const i=e.reduce((e,t)=>e+t.notional,0);if(0===i)return[];const o=[];e.forEach((n,s)=>{const l=n.notional/i,c=a.find(e=>e.label===n.symbol);if(!c)return;let u=0;e.forEach((e,t)=>{t<c.values.length&&(u+=c.values[t]*(e.notional/i))});const d=t*l*u*r;o.push({symbol:n.symbol,weight:100*l,contribution:Math.abs(d),percentRisk:0,color:n.color})});const s=o.reduce((e,t)=>e+t.contribution,0);return s>0&&o.forEach(e=>{e.percentRisk=e.contribution/s*100}),o.sort((e,t)=>t.contribution-e.contribution)},calculateVaR:(e,t,a=.95,n=1)=>{const r=e*({.9:1.282,.95:1.645,.99:2.326,.999:3.09}[a]||1.645)*(t*Math.sqrt(n/252));return{var:-r,cvar:-(1.25*r)}},updateStressScenarios:e=>{a.value=e},calculateSortinoRatio:(e,t)=>1.5*(t>0?e/t:0),var95:r,var99:i,cvar95:o,cvar99:s,expectedReturn:l,volatility:c,sharpeRatio:u,portfolioBeta:d,riskContributions:h,maxDrawdown:p}}),Ed={class:"page-container"},Id={class:"section-header"},Rd={class:"header-actions"},Dd={class:"glass-pill control-pill"},Pd={class:"text-white font-bold"},Ld={class:"glass-pill control-pill"},Nd={class:"scrub-wrapper"},Od={class:"glass-pill control-pill"},Fd=["disabled"],Bd={key:0,width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ud={key:1,class:"spinner-mini"},zd={key:2},Vd={class:"kpi-cards-grid"},Hd={class:"glass-card kpi-card"},Gd={class:"kpi-label"},Wd={class:"kpi-value text-red"},qd={class:"kpi-sub"},Yd={class:"text-white font-bold"},jd={class:"glass-card kpi-card"},Xd={class:"kpi-value text-orange"},$d={class:"glass-card kpi-card"},Kd={class:"kpi-value text-gradient-blue"},Zd={class:"glass-card kpi-card"},Jd={class:"kpi-value text-gradient-green"},Qd={class:"kpi-sub"},eh={class:"text-white"},th={class:"dashboard-grid"},ah={class:"col-left"},nh={class:"glass-card panel"},rh={class:"risk-table-wrapper"},ih={class:"glass-table risk-decomposition-table"},oh={class:"text-left"},sh={class:"asset-row"},lh={class:"sym"},ch={class:"text-right mono"},uh={class:"text-right mono text-red"},dh={class:"text-right"},hh={class:"bar-cell"},ph={class:"progress-bar"},fh={class:"mono bar-val"},mh={class:"glass-card panel"},vh={class:"panel-header"},gh=["disabled"],yh={class:"stress-list"},bh={class:"stress-info"},xh={class:"stress-name"},wh={class:"stress-desc"},_h={class:"stress-result"},Sh={class:"glass-card panel"},Mh={class:"correlation-matrix-wrapper"},Th={class:"correlation-matrix-grid"},kh=["title"],Ch=["title"],Ah=["title"],Eh={class:"col-right"},Ih={class:"glass-card panel"},Rh={class:"factor-list"},Dh={class:"lbl-group"},Ph={class:"lbl"},Lh={class:"sub-lbl"},Nh={class:"val-group"},Oh={class:"glass-card panel"},Fh={class:"metrics-kv-list"},Bh={class:"kv-row"},Uh={class:"v text-red font-bold"},zh=e({__name:"GreekParameters",setup(e){_e();const a=Ad(),n=Ys(),r=S(()=>n.selectedBank),o=t("1d"),u=t(!1),d=t(!1),h=t((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),g=t(99),b=S(()=>{const e=a.var99,t=a.var95;if(0===e&&0===t){return-67500*((1.645+(g.value-95)/4*.685)/2.33)}if(g.value<=95)return t;if(g.value>=99)return e;return t+(e-t)*((g.value-95)/4)}),x=S(()=>{const e=a.riskContributions;return e.length>0?e:[{symbol:"SPY",weight:40,contribution:27e3,percentRisk:45,color:"#3b82f6"},{symbol:"QQQ",weight:30,contribution:21e3,percentRisk:35,color:"#8b5cf6"},{symbol:"GLD",weight:15,contribution:4500,percentRisk:7.5,color:"#fbbf24"},{symbol:"TLT",weight:15,contribution:7500,percentRisk:12.5,color:"#ef4444"}]}),_=t([{id:1,name:"Финансовый Кризис 2008",description:"Рыночный крах (повтор)",impact:-452e3,impactPct:-.25},{id:2,name:"Скачок Инфляции",description:"Рост ставок +200 б.п.",impact:-125e3,impactPct:-.07},{id:3,name:"Падение Нефти",description:"Нефть Brent < ₽40",impact:-35e3,impactPct:-.02},{id:4,name:"Рост Волатильности",description:"VIX > 40",impact:-85e3,impactPct:-.045}]),M=S(()=>[{name:"Рыночный риск",index:"IMOEX",beta:a.portfolioBeta},{name:"Процентные ставки",index:"RU 10Y",beta:-.42},{name:"Momentum",index:"MTUM ETF",beta:.25},{name:"Волатильность",index:"RTSVIX",beta:-.65},{name:"Сырье",index:"BCOM Index",beta:.12}]),C=e=>{const t=[];for(let a=0;a<e;a++){const n=[];for(let t=0;t<e;t++)if(a===t)n.push(1);else{const r=(a*e+t)%100/100*2-1,i=Math.max(-.8,Math.min(.95,r));n.push(parseFloat(i.toFixed(2)))}t.push(n)}for(let a=0;a<e;a++)for(let n=a+1;n<e;n++)t[n][a]=t[a][n];return t},A=S(()=>{const e=n.positions.map(e=>e.symbol).slice(0,10);for(;e.length<10;)e.push(`Asset${e.length+1}`);return e}),E=S(()=>{const e=n.correlationMatrix;if(!e||0===e.length)return C(10);const t=e.slice(0,10).map(e=>e.values.slice(0,10));if(t.length<10){const e=C(10);for(let a=t.length;a<10;a++)t.push(e[a])}return t.map(e=>{const t=[...e];for(;t.length<10;)t.push(0);return t.slice(0,10)})}),R=e=>"₽"+Math.abs(e).toLocaleString("ru-RU",{maximumFractionDigits:0}),P=e=>{let t="rgba(255,255,255,0.02)",a="rgba(255,255,255,0.6)";if(1===e)t="rgba(255,255,255,0.1)",a="#fff";else if(e>0){t=`rgba(59, 130, 246, ${.6*e})`,a="#fff"}else if(e<0){t=`rgba(239, 68, 68, ${.6*Math.abs(e)})`,a="#fff"}return{background:t,color:a}},L=async()=>{if(!u.value){u.value=!0;try{await new Promise(e=>setTimeout(e,800)),h.value=(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}finally{u.value=!1}}},N=async()=>{if(!d.value){d.value=!0;try{await new Promise(e=>setTimeout(e,1200))}finally{d.value=!1}}};return(e,t)=>(w(),i("div",Ed,[s("div",Id,[t[8]||(t[8]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Риск-метрики"),s("p",{class:"section-subtitle"},"VaR, Стресс-тесты и Факторный анализ")],-1)),s("div",Rd,[s("div",Dd,[t[2]||(t[2]=s("span",{class:"lbl-mini"},"Банк:",-1)),s("span",Pd,v(r.value.name),1)]),s("div",Ld,[t[4]||(t[4]=s("span",{class:"lbl-mini"},"Доверие:",-1)),s("div",Nd,[T(s("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),class:"scrub-input text-accent",step:"0.1",min:"90",max:"99.9"},null,512),[[k,g.value,void 0,{number:!0}]]),t[3]||(t[3]=s("span",{class:"text-accent"},"%",-1))])]),s("div",Od,[t[6]||(t[6]=s("span",{class:"lbl-mini"},"Горизонт:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),class:"glass-select-clean"},[...t[5]||(t[5]=[s("option",{value:"1d"},"1 день",-1),s("option",{value:"10d"},"10 дней",-1),s("option",{value:"1m"},"1 месяц",-1)])],512),[[D,o.value]])]),s("button",{class:"btn-glass primary",onClick:L,disabled:u.value},[u.value?(w(),i("span",Ud)):(w(),i("svg",Bd,[...t[7]||(t[7]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),u.value?l("",!0):(w(),i("span",zd,"Обновить"))],8,Fd)])]),s("div",Vd,[s("div",Hd,[s("div",Gd,"VaR "+v(g.value)+"% (Value at Risk)",1),s("div",Wd,v(R(b.value)),1),s("div",qd,[t[9]||(t[9]=s("span",{class:"text-muted"},"Риск/Капитал:",-1)),t[10]||(t[10]=m()),s("span",Yd,v((Math.abs(b.value)/O(a).totalEquity*100).toFixed(2))+"%",1)])]),s("div",jd,[t[11]||(t[11]=s("div",{class:"kpi-label"},"Expected Shortfall (CVaR)",-1)),s("div",Xd,v(R(g.value>=99?O(a).cvar99:O(a).cvar95)),1),t[12]||(t[12]=s("div",{class:"kpi-sub"},[s("span",{class:"text-muted"},"Средний убыток в хвосте")],-1))]),s("div",$d,[t[13]||(t[13]=s("div",{class:"kpi-label"},"Бэта портфеля (β)",-1)),s("div",Kd,v(O(a).portfolioBeta.toFixed(2)),1),t[14]||(t[14]=s("div",{class:"kpi-sub"},[s("span",{class:"text-muted"},"vs IMOEX")],-1))]),s("div",Zd,[t[17]||(t[17]=s("div",{class:"kpi-label"},"Коэффициент Шарпа",-1)),s("div",Jd,v(O(a).sharpeRatio.toFixed(2)),1),s("div",Qd,[t[15]||(t[15]=s("span",{class:"text-muted"},"Sortino:",-1)),t[16]||(t[16]=m()),s("span",eh,v(O(a).calculateSortinoRatio(O(a).expectedReturn,O(a).volatility).toFixed(2)),1)])])]),s("div",th,[s("div",ah,[s("div",nh,[t[19]||(t[19]=s("div",{class:"panel-header"},[s("h3",null,"Декомпозиция рисков"),s("div",{class:"badge-glass"},"Marginal VaR")],-1)),s("div",rh,[s("table",ih,[t[18]||(t[18]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Актив"),s("th",{class:"text-right"},"Вес"),s("th",{class:"text-right"},"Вклад в риск"),s("th",{class:"text-right"},"% Риска")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(x.value,e=>(w(),i("tr",{key:e.symbol},[s("td",oh,[s("div",sh,[s("span",{class:"dot",style:y({background:e.color})},null,4),s("span",lh,v(e.symbol),1)])]),s("td",ch,v(e.weight)+"%",1),s("td",uh,"₽"+v((e.contribution/1e3).toFixed(1))+"k",1),s("td",dh,[s("div",hh,[s("div",ph,[s("div",{class:"progress-fill",style:y({width:e.percentRisk+"%"})},null,4)]),s("span",fh,v(e.percentRisk)+"%",1)])])]))),128))])])])]),s("div",mh,[s("div",vh,[t[20]||(t[20]=s("h3",null,"Стресс-тестирование",-1)),s("button",{onClick:N,class:"btn-xs-glass",disabled:d.value},v(d.value?"Выполняется...":"Запустить"),9,gh)]),s("div",yh,[(w(!0),i(p,null,f(_.value,e=>(w(),i("div",{key:e.id,class:"stress-item"},[s("div",bh,[s("span",xh,v(e.name),1),s("span",wh,v(e.description),1)]),s("div",_h,[s("span",{class:c(["stress-val",e.impact>0?"text-green":"text-red"])},v(e.impact>0?"+":"")+v(R(e.impact)),3),s("span",{class:c(["stress-pct",e.impactPct>0?"text-green":"text-red"])},v(e.impactPct>0?"+":"")+v((100*e.impactPct).toFixed(2))+"% ",3)])]))),128))])]),s("div",Sh,[t[22]||(t[22]=s("div",{class:"panel-header"},[s("h3",null,"Матрица корреляций"),s("div",{class:"legend"},[s("span",{class:"dot-legend bg-blue"}),m(" Поз "),s("span",{class:"dot-legend bg-red"}),m(" Нег ")])],-1)),s("div",Mh,[s("div",Th,[t[21]||(t[21]=s("div",{class:"matrix-cell empty"},null,-1)),(w(!0),i(p,null,f(A.value.slice(0,10),e=>(w(),i("div",{key:e,class:"matrix-cell header",title:e},v(e.length>6?e.substring(0,6)+"...":e),9,kh))),128)),(w(!0),i(p,null,f(E.value.slice(0,10),(e,t)=>(w(),i(p,{key:"row-"+t},[s("div",{class:"matrix-cell header",title:A.value[t]},v(A.value[t]&&A.value[t].length>6?A.value[t].substring(0,6)+"...":A.value[t]||""),9,Ch),(w(!0),i(p,null,f(e.slice(0,10),(e,a)=>(w(),i("div",{key:t+"-"+a,class:"matrix-cell value",style:y(P(e)),title:`${A.value[t]} vs ${A.value[a]}: ${e.toFixed(3)}`},v(e.toFixed(2)),13,Ah))),128))],64))),128))])])])]),s("div",Eh,[s("div",Ih,[t[23]||(t[23]=s("div",{class:"panel-header"},[s("h3",null,"Факторный Анализ (Beta)")],-1)),s("div",Rh,[(w(!0),i(p,null,f(M.value,e=>{return w(),i("div",{class:"list-row",key:e.name},[s("div",Dh,[s("span",Ph,v(e.name),1),s("span",Lh,v(e.index),1)]),s("div",Nh,[s("span",{class:c(["val",(t=e.beta,Math.abs(t)>.5?"font-bold text-white":"text-muted")])},v(e.beta>0?"+":"")+v(e.beta.toFixed(2)),3)])]);var t}),128))])]),s("div",Oh,[t[27]||(t[27]=s("div",{class:"panel-header"},[s("h3",null,"Анализ Просадок")],-1)),s("div",Fh,[t[25]||(t[25]=s("div",{class:"kv-row"},[s("span",{class:"k"},"Текущая просадка"),s("span",{class:"v text-red"},"-3.45%")],-1)),s("div",Bh,[t[24]||(t[24]=s("span",{class:"k"},"Макс. просадка",-1)),s("span",Uh,v((100*O(a).maxDrawdown).toFixed(2))+"%",1)]),t[26]||(t[26]=I('<div class="kv-row" data-v-a5cb61d3><span class="k" data-v-a5cb61d3>Дней в просадке</span><span class="v" data-v-a5cb61d3>14 дней</span></div><div class="kv-row" data-v-a5cb61d3><span class="k" data-v-a5cb61d3>Фактор восстановления</span><span class="v text-green" data-v-a5cb61d3>3.2x</span></div>',2))])]),t[28]||(t[28]=I('<div class="glass-card panel" data-v-a5cb61d3><div class="panel-header" data-v-a5cb61d3><h3 data-v-a5cb61d3>Ликвидность</h3></div><div class="metrics-kv-list" data-v-a5cb61d3><div class="kv-row" data-v-a5cb61d3><span class="k" data-v-a5cb61d3>Дней до ликвидации (95%)</span><span class="v" data-v-a5cb61d3>1.2 дня</span></div><div class="kv-row" data-v-a5cb61d3><span class="k" data-v-a5cb61d3>Стоимость спреда Bid-Ask</span><span class="v text-orange" data-v-a5cb61d3>0.08%</span></div></div></div>',1))])])]))}}),Vh=xe(zh,[["__scopeId","data-v-a5cb61d3"]]),Hh={class:"page-container custom-scroll"},Gh={class:"section-header"},Wh={class:"header-right"},qh={class:"glass-pill control-pill"},Yh={class:"text-white font-bold"},jh={class:"glass-pill control-pill"},Xh={class:"scrub-wrapper"},$h={class:"scrub-val text-accent"},Kh=["disabled"],Zh={key:0,class:"flex items-center gap-2"},Jh={key:1,class:"flex items-center gap-2"},Qh={class:"scenarios-grid"},ep=["onClick"],tp={class:"sc-header"},ap={class:"sc-name"},np={class:"sc-header-actions"},rp=["onClick"],ip=["onClick"],op={class:"sc-desc"},sp={class:"sc-footer"},lp={class:"sc-prob"},cp={key:0,class:"dashboard-grid"},up={class:"col-left"},dp={class:"glass-card panel"},hp={class:"panel-header"},pp={class:"text-white"},fp={class:"impact-metrics-grid"},mp={class:"metric-box"},vp={class:"val text-red"},gp={class:"metric-box"},yp={class:"metric-box"},bp={class:"val text-white"},xp={class:"metric-box"},wp={class:"val text-orange"},_p={class:"impact-bars-list"},Sp={class:"bar-label"},Mp={class:"bar-track"},Tp={class:"stats-grid-row"},kp={class:"stat-box"},Cp={class:"val-sm text-red"},Ap={class:"stat-box"},Ep={class:"val-sm text-red"},Ip={class:"stat-box"},Rp={class:"val-sm text-orange"},Dp={class:"col-right"},Pp={class:"glass-card panel sticky-panel"},Lp={class:"market-changes-list"},Np={class:"m-key"},Op={class:"info-block"},Fp={class:"text-xs text-muted"},Bp={class:"text-white"},Up={class:"glass-card panel"},zp={class:"table-wrapper"},Vp={class:"glass-table"},Hp=["onClick"],Gp={class:"col-left pl-4"},Wp={class:"sc-name-sm"},qp={class:"text-muted"},Yp={class:"text-orange"},jp={class:"modal-header"},Xp={class:"modal-body"},$p={class:"form-section"},Kp={class:"form-grid"},Zp={class:"form-group"},Jp={class:"form-group"},Qp={class:"form-group"},ef={class:"form-group"},tf={class:"form-group"},af={class:"form-section"},nf={class:"form-group"},rf={key:0,class:"form-grid"},of={class:"form-group"},sf={key:1,class:"form-grid"},lf={class:"form-group"},cf={key:2,class:"form-grid"},uf={class:"form-group"},df={class:"form-section"},hf={class:"market-changes-editor"},pf=["onUpdate:modelValue","onInput"],ff=["onUpdate:modelValue","onInput"],mf=["onClick"],vf={class:"form-section"},gf={class:"asset-impact-editor"},yf=["onUpdate:modelValue","onInput"],bf=["onUpdate:modelValue","onInput"],xf=["onClick"],wf=e({__name:"StressTesting",setup(e){const a=Ys(),n=S(()=>a.selectedBank),r=t(!1),o=t(1),d=t(null),g=(e,t="success")=>{console.log(`[${t.toUpperCase()}] ${e}`)},b=t([{id:1,name:"«Чёрный лебедь»",description:"Глобальный рыночный крах (как COVID-19)",pnlImpact:-185e3,varChange:-45.5,duration:"1–3 дня",probability:.01,severity:"critical",marketChanges:{"Волатильность":"+25%","Bonds Yield":"+150 bps",Correlation:"+0.50",Spreads:"+100 bps"},assetImpact:{"Акции":-35,"Облигации":-12,"Товары":-25,"Валюта":-8},key:"black_swan",type:"return_shock",return_multiplier:.5,custom:!1},{id:2,name:"Скачок волатильности",description:"Резкий рост индекса VIX > 40",pnlImpact:-67500,varChange:-18.2,duration:"1–5 дней",probability:.05,severity:"high",marketChanges:{VIX:"+20 pts",Range:"+15%",Liquidity:"-10%"},assetImpact:{"Акции":-18,"Облигации":-5,"Опционы":-40,"Валюта":-3},key:"volatility_spike",type:"volatility_shock",volatility_multiplier:1.5,custom:!1},{id:3,name:"Рост ставок ЦБ",description:"Неожиданное повышение ставки на 100 б.п.",pnlImpact:-45200,varChange:-12.5,duration:"1–10 дней",probability:.15,severity:"high",marketChanges:{"Key Rate":"+100 bps",Spreads:"+50 bps","FX Rate":"-5%"},assetImpact:{"Акции":-12,"Облигации":-22,"Недвижимость":-15,"Валюта":-6},key:"rate_hike",type:"return_shock",return_multiplier:.7,custom:!1},{id:4,name:"Техническая коррекция",description:"Умеренное снижение S&P 500 на 10%",pnlImpact:-12400,varChange:-5.2,duration:"5–20 дней",probability:.35,severity:"medium",marketChanges:{Index:"-8%",Volatility:"+10%",Spreads:"+20 bps"},assetImpact:{"Акции":-8,"Облигации":2,"Товары":-5,"Валюта":-2},key:"correction",type:"correlation_shock",correlation_multiplier:1.3,custom:!1}]),x=t(!1),_=t(null),C=t(5),A=t({name:"",description:"",duration:"",probability:1,severity:"medium",type:"return_shock",return_multiplier:.5,volatility_multiplier:1.5,correlation_multiplier:1.3,marketChanges:{},assetImpact:{}}),I=t([]),R=t([]),P=t([]),L=t([]),N=()=>{try{const e=b.value.filter(e=>e.custom);localStorage.setItem("custom_stress_scenarios",JSON.stringify(e))}catch(TQe){console.error("Failed to save custom scenarios:",TQe)}},O=e=>{e?(_.value=e,A.value={name:e.name,description:e.description||"",duration:e.duration||"",probability:100*(e.probability||.01),severity:e.severity||"medium",type:e.type||"return_shock",return_multiplier:e.return_multiplier||.5,volatility_multiplier:e.volatility_multiplier||1.5,correlation_multiplier:e.correlation_multiplier||1.3,marketChanges:e.marketChanges?{...e.marketChanges}:{},assetImpact:e.assetImpact?{...e.assetImpact}:{}}):(_.value=null,A.value={name:"",description:"",duration:"",probability:1,severity:"medium",type:"return_shock",return_multiplier:.5,volatility_multiplier:1.5,correlation_multiplier:1.3,marketChanges:{},assetImpact:{}}),I.value=Object.keys(A.value.marketChanges),R.value=Object.values(A.value.marketChanges),P.value=Object.keys(A.value.assetImpact),L.value=Object.values(A.value.assetImpact),x.value=!0},F=()=>{x.value=!1,_.value=null},B=()=>{"return_shock"===A.value.type?(A.value.volatility_multiplier=void 0,A.value.correlation_multiplier=void 0):"volatility_shock"===A.value.type?(A.value.return_multiplier=void 0,A.value.correlation_multiplier=void 0):"correlation_shock"===A.value.type&&(A.value.return_multiplier=void 0,A.value.volatility_multiplier=void 0)},U=(e,t,a)=>{const n=I.value.indexOf(e);n>-1&&(e!==t&&delete A.value.marketChanges[e],t&&(A.value.marketChanges[t]=a,I.value[n]=t,R.value[n]=a))},z=()=>{const e=`Параметр${Object.keys(A.value.marketChanges).length+1}`;A.value.marketChanges[e]="",I.value.push(e),R.value.push("")},V=(e,t,a)=>{const n=P.value.indexOf(e);n>-1&&(e!==t&&delete A.value.assetImpact[e],t&&(A.value.assetImpact[t]=a,P.value[n]=t,L.value[n]=a))},H=()=>{const e=`Актив${Object.keys(A.value.assetImpact).length+1}`;A.value.assetImpact[e]=0,P.value.push(e),L.value.push(0)},G=()=>{const e=A.value.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),t={id:_?.value?.id||C.value++,name:A.value.name,description:A.value.description,duration:A.value.duration,probability:A.value.probability/100,severity:A.value.severity,key:_?.value?.key||`custom_${e}`,type:A.value.type,marketChanges:{...A.value.marketChanges},assetImpact:{...A.value.assetImpact},custom:!0};if("return_shock"===A.value.type&&A.value.return_multiplier?t.return_multiplier=A.value.return_multiplier:"volatility_shock"===A.value.type&&A.value.volatility_multiplier?t.volatility_multiplier=A.value.volatility_multiplier:"correlation_shock"===A.value.type&&A.value.correlation_multiplier&&(t.correlation_multiplier=A.value.correlation_multiplier),t.pnlImpact=0,t.varChange=0,_.value){const e=b.value.findIndex(e=>e.id===_.value.id);e>-1&&(b.value[e]={...b.value[e],...t})}else b.value.push(t);N(),F(),g(_.value?"Сценарий обновлен":"Сценарий создан","success")};(()=>{try{const e=localStorage.getItem("custom_stress_scenarios");if(e){const t=JSON.parse(e);b.value=[...b.value.filter(e=>!e.custom),...t];const a=Math.max(...b.value.map(e=>e.id));C.value=a+1}}catch(TQe){console.error("Failed to load custom scenarios:",TQe)}})();const W=t(b.value[0]),q=e=>W.value=e,Y=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(e),j=e=>"₽"+(e/1e3).toFixed(0)+"k",X=e=>e.charAt(0).toUpperCase()+e.slice(1),$=e=>d.value&&d.value.results[e]?d.value.results[e].metrics:null,K=e=>{const t=$(e.key);if(t){return-((d.value?.baseline.initial_capital||1e6)-t.mean_final)*o.value}return e.pnlImpact*o.value},Z=e=>{const t=$(e.key);if(t){const e=d.value?.baseline.initial_capital||1e6;return(e-t.var_95)/e*100*o.value}return e.varChange*o.value},J=S(()=>{if(d.value){const e=Object.values(d.value.results).map(e=>-(d.value.baseline.initial_capital-e.metrics.mean_final));return e.reduce((e,t)=>e+t,0)/e.length*o.value}return b.value.reduce((e,t)=>e+t.pnlImpact,0)/b.value.length*o.value}),Q=S(()=>{if(d.value){const e=Object.values(d.value.results).map(e=>-(d.value.baseline.initial_capital-e.metrics.mean_final));return Math.min(...e)*o.value}return Math.min(...b.value.map(e=>e.pnlImpact))*o.value}),ee=S(()=>d.value?Object.values(d.value.results).reduce((e,t,a)=>{const n=b.value[a];return e+-(d.value.baseline.initial_capital-t.metrics.mean_final)*(n?.probability||0)},0)*o.value:b.value.reduce((e,t)=>e+t.pnlImpact*t.probability,0)*o.value),te=async()=>{if(!r.value){r.value=!0;try{const e=a.positions.length||23,t=a.positions.map(e=>e.symbol),n=Array.from({length:e},()=>.05+.1*Math.random()),r=a.correlationMatrix,i=Array.from({length:e},()=>.15+.15*Math.random()),o=[];for(let a=0;a<e;a++){const t=[];for(let n=0;n<e;n++){let e=.3;r.length>a&&void 0!==r[a]?.values?.[n]?e=r[a].values[n]:a===n&&(e=1),t.push(e*i[a]*i[n])}o.push(t)}const s=b.value.map(e=>({name:e.name,key:e.key,type:e.type,return_multiplier:e.return_multiplier,volatility_multiplier:e.volatility_multiplier,correlation_multiplier:e.correlation_multiplier,seed:42})),l=await(async e=>{try{const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/stress/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Stress Test Failed:",QXe),QXe}})({mu:n,cov_matrix:o,initial_capital:1e6,risk_free_rate:.1394,gamma:3,scenarios:s,asset_names:t,n_paths:1e3,seed:42});d.value=l,b.value.forEach(e=>{const t=l.results[e.key];if(t){const a=l.baseline.initial_capital;e.pnlImpact=-(a-t.metrics.mean_final),e.varChange=(a-t.metrics.var_95)/a*100}}),g("Стресс-тестирование завершено","success")}catch(TQe){console.error("Ошибка стресс-тестирования:",TQe),g("Ошибка при выполнении стресс-тестирования","error")}finally{r.value=!1}}};return(e,t)=>(w(),i("div",Hh,[s("div",Gh,[t[17]||(t[17]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Стресс-тестирование"),s("p",{class:"section-subtitle"},"Симуляция экстремальных рыночных шоков")],-1)),s("div",Wh,[s("div",qh,[t[13]||(t[13]=s("span",{class:"lbl-mini"},"Банк:",-1)),s("span",Yh,v(n.value.name),1)]),s("div",jh,[t[14]||(t[14]=s("span",{class:"lbl-mini"},"Множитель шока:",-1)),s("div",Xh,[T(s("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),step:.1,min:.5,max:3,class:"range-slider"},null,512),[[k,o.value,void 0,{number:!0}]]),s("span",$h,v(o.value.toFixed(1))+"x",1)])]),s("button",{onClick:te,class:"btn-glass primary",disabled:r.value},[r.value?(w(),i("span",Jh,[...t[16]||(t[16]=[s("span",{class:"spinner-mini"},null,-1),m(" Тестирую... ",-1)])])):(w(),i("span",Zh,[...t[15]||(t[15]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),s("span",null,"Запустить все",-1)])]))],8,Kh)])]),s("div",Qh,[(w(!0),i(p,null,f(b.value,e=>(w(),i("div",{key:e.id,onClick:t=>q(e),class:c(["glass-card scenario-card",{active:W.value?.id===e.id}])},[s("div",tp,[s("span",ap,v(e.name),1),s("div",np,[s("span",{class:c(["badge",e.severity])},v(e.severity),3),s("div",{class:"sc-actions",onClick:t[1]||(t[1]=E(()=>{},["stop"]))},[s("button",{onClick:t=>(e=>{O(e)})(e),class:"btn-icon-sm",title:"Редактировать"},[...t[18]||(t[18]=[s("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,rp),e.custom?(w(),i("button",{key:0,onClick:t=>{return a=e.id,void(confirm("Удалить этот сценарий?")&&(b.value=b.value.filter(e=>e.id!==a),N(),W.value?.id===a&&(W.value=b.value[0]||null),g("Сценарий удален","success")));var a},class:"btn-icon-sm",title:"Удалить"},[...t[19]||(t[19]=[s("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ip)):l("",!0)])])]),s("p",op,v(e.description),1),s("div",sp,[s("span",{class:c(["sc-impact",K(e)<0?"text-red":"text-green"])},v(j(K(e))),3),s("span",lp,"Вероятность: "+v((100*e.probability).toFixed(0))+"%",1)])],10,ep))),128)),s("div",{onClick:t[2]||(t[2]=e=>O()),class:"glass-card scenario-card add-scenario-card"},[...t[20]||(t[20]=[s("div",{class:"add-scenario-content"},[s("svg",{width:"32",height:"32",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),s("span",{class:"add-scenario-text"},"Создать сценарий")],-1)])])]),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[W.value?(w(),i("div",cp,[s("div",up,[s("div",dp,[s("div",hp,[s("h3",null,[t[21]||(t[21]=m("Влияние сценария: ",-1)),s("span",pp,v(W.value.name),1)])]),s("div",fp,[s("div",mp,[t[22]||(t[22]=s("span",{class:"lbl"},"Влияние на P&L",-1)),s("span",vp,v(Y(K(W.value))),1)]),s("div",gp,[t[23]||(t[23]=s("span",{class:"lbl"},"Изменение VaR",-1)),s("span",{class:c(["val",Z(W.value)<0?"text-red":"text-green"])},v(Z(W.value).toFixed(1))+"% ",3)]),s("div",yp,[t[24]||(t[24]=s("span",{class:"lbl"},"Длительность",-1)),s("span",bp,v(W.value.duration),1)]),s("div",xp,[t[25]||(t[25]=s("span",{class:"lbl"},"Вероятность",-1)),s("span",wp,v((100*W.value.probability).toFixed(1))+"%",1)])]),t[29]||(t[29]=s("div",{class:"divider"},null,-1)),t[30]||(t[30]=s("div",{class:"panel-header"},[s("h3",null,"Влияние на классы активов")],-1)),s("div",_p,[(w(!0),i(p,null,f(W.value.assetImpact,(e,t)=>(w(),i("div",{key:t,class:"bar-row"},[s("span",Sp,v(t),1),s("div",Mp,[s("div",{class:c(["bar-fill",e<0?"bg-red":"bg-green"]),style:y({width:Math.min(100,Math.abs(e*o.value*1.5))+"%"})},null,6)]),s("span",{class:c(["bar-val",e<0?"text-red":"text-green"])},v(e>0?"+":"")+v((e*o.value).toFixed(1))+"% ",3)]))),128))]),t[31]||(t[31]=s("div",{class:"divider"},null,-1)),t[32]||(t[32]=s("div",{class:"panel-header"},[s("h3",null,"Статистика риска")],-1)),s("div",Tp,[s("div",kp,[t[26]||(t[26]=s("span",{class:"lbl-sm"},"Средний убыток",-1)),s("span",Cp,v(j(J.value*o.value)),1)]),s("div",Ap,[t[27]||(t[27]=s("span",{class:"lbl-sm"},"Max Drawdown",-1)),s("span",Ep,v(j(Q.value*o.value)),1)]),s("div",Ip,[t[28]||(t[28]=s("span",{class:"lbl-sm"},"Expected Shortfall",-1)),s("span",Rp,v(j(ee.value*o.value)),1)])])])]),s("aside",Dp,[s("div",Pp,[t[35]||(t[35]=s("div",{class:"panel-header"},[s("h3",null,"Рыночные условия")],-1)),s("div",Lp,[(w(!0),i(p,null,f(W.value.marketChanges,(e,t)=>(w(),i("div",{key:t,class:"market-row"},[s("span",Np,v(X(t)),1),s("span",{class:c(["m-val",e.includes("-")?"text-red":"text-green"])},v(e),3)]))),128))]),t[36]||(t[36]=s("div",{class:"divider"},null,-1)),s("div",Op,[s("p",Fp,[t[33]||(t[33]=m(" Метрики пересчитаны с учетом коэффициента шока: ",-1)),s("b",Bp,v(o.value.toFixed(1))+"x",1),t[34]||(t[34]=m(". ",-1))])])])])])):l("",!0)]),_:1}),s("div",Up,[t[38]||(t[38]=s("div",{class:"panel-header"},[s("h3",null,"Сравнение сценариев")],-1)),s("div",zp,[s("table",Vp,[t[37]||(t[37]=s("thead",null,[s("tr",null,[s("th",{class:"col-left pl-4"},"Сценарий"),s("th",null,"Влияние на P&L"),s("th",null,"Изменение VaR"),s("th",null,"Длительность"),s("th",null,"Вер.")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(b.value,e=>(w(),i("tr",{key:e.id,class:c(["hover-row",{"row-active":W.value?.id===e.id}]),onClick:t=>q(e)},[s("td",Gp,[s("span",Wp,v(e.name),1)]),s("td",{class:c(K(e)<0?"text-red":"text-green")},v(Y(K(e))),3),s("td",{class:c(Z(e)<0?"text-red":"text-green")},v(Z(e).toFixed(1))+"% ",3),s("td",qp,v(e.duration),1),s("td",Yp,v((100*e.probability).toFixed(1))+"%",1)],10,Hp))),128))])])])]),t[63]||(t[63]=s("div",{class:"footer-notes"},[s("span",{class:"note-item"},"Данные основаны на исторических корреляциях"),s("span",{class:"note-item"},"•"),s("span",{class:"note-item"},"Рекомендуется ежеквартальный пересмотр")],-1)),u(M,{name:"modal-fade"},{default:h(()=>[x.value?(w(),i("div",{key:0,class:"modal-overlay",onClick:F},[s("div",{class:"modal-container scenario-editor-modal",onClick:t[12]||(t[12]=E(()=>{},["stop"]))},[s("div",jp,[s("h2",null,v(_.value?"Редактировать сценарий":"Создать сценарий"),1),s("button",{class:"modal-close",onClick:F},[...t[39]||(t[39]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",Xp,[s("form",{onSubmit:E(G,["prevent"]),class:"scenario-form"},[s("div",$p,[t[46]||(t[46]=s("h3",{class:"section-title"},"Основная информация",-1)),s("div",Kp,[s("div",Zp,[t[40]||(t[40]=s("label",null,"Название сценария",-1)),T(s("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>A.value.name=e),class:"glass-input",placeholder:"Например: Кризис ликвидности",required:""},null,512),[[k,A.value.name]])]),s("div",Jp,[t[41]||(t[41]=s("label",null,"Описание",-1)),T(s("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>A.value.description=e),class:"glass-input",rows:"2",placeholder:"Краткое описание сценария"},null,512),[[k,A.value.description]])]),s("div",Qp,[t[42]||(t[42]=s("label",null,"Длительность",-1)),T(s("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>A.value.duration=e),class:"glass-input",placeholder:"Например: 1–3 дня"},null,512),[[k,A.value.duration]])]),s("div",ef,[t[43]||(t[43]=s("label",null,"Вероятность (%)",-1)),T(s("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=e=>A.value.probability=e),class:"glass-input",min:"0",max:"100",step:"0.1",required:""},null,512),[[k,A.value.probability,void 0,{number:!0}]])]),s("div",tf,[t[45]||(t[45]=s("label",null,"Уровень серьезности",-1)),T(s("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>A.value.severity=e),class:"glass-input"},[...t[44]||(t[44]=[s("option",{value:"critical"},"Критический",-1),s("option",{value:"high"},"Высокий",-1),s("option",{value:"medium"},"Средний",-1),s("option",{value:"low"},"Низкий",-1)])],512),[[D,A.value.severity]])])])]),s("div",af,[t[55]||(t[55]=s("h3",{class:"section-title"},"Тип шока",-1)),s("div",nf,[t[48]||(t[48]=s("label",null,"Тип стресс-теста",-1)),T(s("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>A.value.type=e),class:"glass-input",onChange:B},[...t[47]||(t[47]=[s("option",{value:"return_shock"},"Шок доходности",-1),s("option",{value:"volatility_shock"},"Шок волатильности",-1),s("option",{value:"correlation_shock"},"Шок корреляции",-1)])],544),[[D,A.value.type]])]),"return_shock"===A.value.type?(w(),i("div",rf,[s("div",of,[t[49]||(t[49]=s("label",null,"Множитель доходности",-1)),T(s("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=e=>A.value.return_multiplier=e),class:"glass-input",min:"0",max:"2",step:"0.1",placeholder:"0.5"},null,512),[[k,A.value.return_multiplier,void 0,{number:!0}]]),t[50]||(t[50]=s("span",{class:"form-hint"},"Множитель для ожидаемой доходности (0.5 = снижение на 50%)",-1))])])):l("",!0),"volatility_shock"===A.value.type?(w(),i("div",sf,[s("div",lf,[t[51]||(t[51]=s("label",null,"Множитель волатильности",-1)),T(s("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=e=>A.value.volatility_multiplier=e),class:"glass-input",min:"0.5",max:"5",step:"0.1",placeholder:"1.5"},null,512),[[k,A.value.volatility_multiplier,void 0,{number:!0}]]),t[52]||(t[52]=s("span",{class:"form-hint"},"Множитель для волатильности (1.5 = увеличение на 50%)",-1))])])):l("",!0),"correlation_shock"===A.value.type?(w(),i("div",cf,[s("div",uf,[t[53]||(t[53]=s("label",null,"Множитель корреляции",-1)),T(s("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=e=>A.value.correlation_multiplier=e),class:"glass-input",min:"0.5",max:"2",step:"0.1",placeholder:"1.3"},null,512),[[k,A.value.correlation_multiplier,void 0,{number:!0}]]),t[54]||(t[54]=s("span",{class:"form-hint"},"Множитель для корреляций (1.3 = увеличение на 30%)",-1))])])):l("",!0)]),s("div",df,[t[58]||(t[58]=s("h3",{class:"section-title"},"Рыночные изменения",-1)),s("div",hf,[(w(!0),i(p,null,f(A.value.marketChanges,(e,a,n)=>(w(),i("div",{key:n,class:"market-change-row"},[T(s("input",{type:"text","onUpdate:modelValue":e=>I.value[n]=e,class:"glass-input",placeholder:"Параметр (например: VIX)",onInput:t=>U(a,I.value[n],e)},null,40,pf),[[k,I.value[n]]]),T(s("input",{type:"text","onUpdate:modelValue":e=>R.value[n]=e,class:"glass-input",placeholder:"Изменение (например: +20 pts)",onInput:e=>U(a,I.value[n],R.value[n])},null,40,ff),[[k,R.value[n]]]),s("button",{type:"button",onClick:e=>(e=>{delete A.value.marketChanges[e];const t=I.value.indexOf(e);t>-1&&(I.value.splice(t,1),R.value.splice(t,1))})(a),class:"btn-icon-sm btn-danger"},[...t[56]||(t[56]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,mf)]))),128)),s("button",{type:"button",onClick:z,class:"btn-glass outline btn-add"},[...t[57]||(t[57]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" Добавить параметр ",-1)])])])]),s("div",vf,[t[61]||(t[61]=s("h3",{class:"section-title"},"Влияние на классы активов (%)",-1)),s("div",gf,[(w(!0),i(p,null,f(A.value.assetImpact,(e,a,n)=>(w(),i("div",{key:n,class:"asset-impact-row"},[T(s("input",{type:"text","onUpdate:modelValue":e=>P.value[n]=e,class:"glass-input",placeholder:"Класс актива (например: Акции)",onInput:t=>V(a,P.value[n],e)},null,40,yf),[[k,P.value[n]]]),T(s("input",{type:"number","onUpdate:modelValue":e=>L.value[n]=e,class:"glass-input",placeholder:"Влияние (%)",step:"0.1",onInput:e=>V(a,P.value[n],L.value[n])},null,40,bf),[[k,L.value[n],void 0,{number:!0}]]),s("button",{type:"button",onClick:e=>(e=>{delete A.value.assetImpact[e];const t=P.value.indexOf(e);t>-1&&(P.value.splice(t,1),L.value.splice(t,1))})(a),class:"btn-icon-sm btn-danger"},[...t[59]||(t[59]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,xf)]))),128)),s("button",{type:"button",onClick:H,class:"btn-glass outline btn-add"},[...t[60]||(t[60]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),m(" Добавить класс актива ",-1)])])])]),s("div",{class:"form-actions"},[s("button",{type:"button",onClick:F,class:"btn-glass outline"},"Отмена"),t[62]||(t[62]=s("button",{type:"submit",class:"btn-glass primary"},"Сохранить сценарий",-1))])],32)])])])):l("",!0)]),_:1})]))}}),_f=xe(wf,[["__scopeId","data-v-39cd3d9b"]]),Sf={class:"page-container custom-scroll"},Mf={class:"section-header"},Tf={class:"header-right"},kf={class:"glass-pill control-pill"},Cf={class:"text-white font-bold"},Af={class:"glass-segmented-control"},Ef=["onClick"],If={class:"kpi-cards-grid"},Rf={class:"glass-card kpi-card"},Df={class:"kpi-value text-gradient-green"},Pf={class:"glass-card kpi-card"},Lf={class:"kpi-value text-white"},Nf={class:"glass-card kpi-card"},Of={class:"kpi-value text-gradient-blue"},Ff={class:"glass-card kpi-card"},Bf={class:"kpi-value text-red"},Uf={class:"glass-card chart-panel"},zf={class:"chart-container"},Vf={viewBox:"0 0 1000 250",preserveAspectRatio:"none",class:"main-svg"},Hf=["d"],Gf=["d"],Wf=["d"],qf=["cx","cy"],Yf={class:"dashboard-grid"},jf={class:"col-left"},Xf={class:"glass-card panel-full"},$f={class:"table-wrapper custom-scroll"},Kf={class:"heatmap-table"},Zf={class:"col-month"},Jf={class:"col-right"},Qf={class:"glass-card panel-full"},em={class:"stats-grid-mini"},tm={class:"stat-box"},am={class:"val"},nm={class:"stat-box"},rm={class:"val text-green"},im={class:"stat-box"},om={class:"val text-green"},sm={class:"stat-box"},lm={class:"val text-green"},cm={class:"stat-box"},um={class:"val text-red"},dm={class:"stat-box"},hm={class:"val"},pm={class:"glass-card panel-full"},fm={class:"drawdown-list"},mm={class:"dd-info"},vm={class:"dd-period"},gm={class:"dd-rec"},ym={class:"dd-right"},bm={class:"dd-val text-red"},xm={class:"dd-bar-bg"},wm=e({__name:"Backtesting",setup(e){const a=Ys(),r=S(()=>a.selectedBank),o=t(["1M","3M","6M","YTD","1Y","All"]),u=t("YTD"),d=t(!1),h=t(null),g=t(["2024","2025"]),b=t(["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]),x=t([{2024:"+2.1",2025:"+1.8"},{2024:"+3.4",2025:"-1.2"},{2024:"-0.5",2025:"+2.9"},{2024:"+1.7",2025:"+0.8"},{2024:"+2.3",2025:"-0.3"},{2024:"+1.9",2025:"+1.5"},{2024:"+2.8",2025:"+2.1"},{2024:"-1.1",2025:"+0.9"},{2024:"+3.2",2025:"+1.4"},{2024:"+2.5",2025:"+3.1"},{2024:"+1.8",2025:"+2.2"},{2024:"+4.1",2025:"+2.8"}]),_=[{period:"Mar 23 — May 23",amount:-14.2,recovery:"6 mo"},{period:"Sep 23 — Oct 23",amount:-8.5,recovery:"3 mo"},{period:"Feb 24 — Mar 24",amount:-5.3,recovery:"2 mo"}],M=e=>{const t="string"==typeof e?parseFloat(e):e;return t>=3?"bg-green-strong":t>0?"bg-green-soft":0===t?"bg-neutral":t>-2?"bg-red-soft":"bg-red-strong"},T=S(()=>{if(!h.value?.metrics?.monthly_returns)return x.value;const e=h.value.metrics.monthly_returns,t=[],a=Object.keys(e).sort();for(let n=0;n<12;n++){const r={};for(const t of a){const a=e[t]?.[n+1];r[t]=void 0!==a?a>0?"+"+a.toFixed(1):a.toFixed(1):"0.0"}t.push(r)}return t}),k=S(()=>h.value?.metrics?.monthly_returns?Object.keys(h.value.metrics.monthly_returns).sort():g.value),C=async()=>{if(!d.value){d.value=!0;try{const e=a.positions.length||23,t=a.positions.map(e=>e.symbol),n=Array.from({length:e},()=>.05+.1*Math.random()),r=a.correlationMatrix,i=Array.from({length:e},()=>.15+.15*Math.random()),o=[];for(let a=0;a<e;a++){const t=[];for(let n=0;n<e;n++){let e=.3;r.length>a&&void 0!==r[a]?.values?.[n]?e=r[a].values[n]:a===n&&(e=1),t.push(e*i[a]*i[n])}o.push(t)}const s=await(async e=>{try{const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/backtest/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Backtest Failed:",QXe),QXe}})({mu:n,cov_matrix:o,initial_capital:1e6,risk_free_rate:.1394,gamma:3,horizon_years:1,n_steps:252,asset_names:t,n_paths:1e3,seed:42});h.value=s}catch(TQe){console.error("Ошибка бэктестинга:",TQe)}finally{d.value=!1}}},A=()=>{if(!h.value?.equity_curve||0===h.value.equity_curve.length)return"M0,220 Q150,200 300,150 T600,100 T1000,40";const e=h.value.equity_curve,t=Math.min(...e),a=Math.max(...e)-t||1,n=e.length;let r="";for(let i=0;i<n;i++){const o=i/(n-1)*1e3,s=250-(e[i]-t)/a*200-25;r+=0===i?`M${o},${s}`:` L${o},${s}`}return r},E=()=>{if(!h.value?.benchmark_curve||0===h.value.benchmark_curve.length)return"M0,220 Q150,210 300,190 T600,160 T1000,120";const e=h.value.benchmark_curve,t=Math.min(...h.value.equity_curve||[0],...e),a=Math.max(...h.value.equity_curve||[0],...e)-t||1,n=e.length;let r="";for(let i=0;i<n;i++){const o=i/(n-1)*1e3,s=250-(e[i]-t)/a*200-25;r+=0===i?`M${o},${s}`:` L${o},${s}`}return r},R=()=>{const e=A();if(!e||"M0,220 Q150,200 300,150 T600,100 T1000,40"===e)return"M0,220 Q150,200 300,150 T600,100 T1000,40 V250 H0 Z";const t=e.match(/L([0-9.]+),([0-9.]+)$/);return t?e+` L${t[1]},250 L0,250 Z`:e+" V250 H0 Z"},D=S(()=>{if(!h.value?.metrics?.drawdowns||0===h.value.metrics.drawdowns.length)return null;h.value.metrics.drawdowns[0];const e=h.value.equity_curve;if(!e||0===e.length)return null;const t=Math.min(...e),a=e.indexOf(t);if(-1===a)return null;const n=Math.min(...e),r=Math.max(...e)-n||1;return{x:a/(e.length-1)*1e3,y:250-(n-n)/r*200-25}});return n(()=>{C()}),(e,t)=>(w(),i("div",Sf,[s("div",Mf,[t[1]||(t[1]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Результаты бэктеста"),s("p",{class:"section-subtitle"},"Историческая симуляция стратегии (Long/Short)")],-1)),s("div",Tf,[s("div",kf,[t[0]||(t[0]=s("span",{class:"lbl-mini"},"Банк:",-1)),s("span",Cf,v(r.value.name),1)]),s("div",Af,[(w(!0),i(p,null,f(o.value,e=>(w(),i("button",{key:e,onClick:t=>u.value=e,class:c(["seg-btn",{active:u.value===e}])},v(e),11,Ef))),128))])])]),s("div",If,[s("div",Rf,[t[2]||(t[2]=s("div",{class:"kpi-label"},"Общая доходность",-1)),s("div",Df,v(h.value?.metrics?(100*h.value.metrics.total_return).toFixed(1)+"%":"+24.5%"),1),t[3]||(t[3]=s("div",{class:"kpi-change text-green"},[s("span",{class:"icon-up"},"↑"),m(" vs SPY: +6.2% ")],-1))]),s("div",Pf,[t[4]||(t[4]=s("div",{class:"kpi-label"},"CAGR (Годовая)",-1)),s("div",Lf,v(h.value?.metrics?(100*h.value.metrics.cagr).toFixed(1)+"%":"18.2%"),1),t[5]||(t[5]=s("div",{class:"kpi-change text-muted"},"Безрисковая ставка: 5.0%",-1))]),s("div",Nf,[t[6]||(t[6]=s("div",{class:"kpi-label"},"Коэф. Шарпа",-1)),s("div",Of,v(h.value?.metrics?h.value.metrics.sharpe_ratio.toFixed(2):"1.58"),1),t[7]||(t[7]=s("div",{class:"kpi-change text-blue"},"Топ 15%",-1))]),s("div",Ff,[t[8]||(t[8]=s("div",{class:"kpi-label"},"Макс. Просадка",-1)),s("div",Bf,v(h.value?.metrics?(100*h.value.metrics.max_drawdown).toFixed(1)+"%":"-14.2%"),1),t[9]||(t[9]=s("div",{class:"kpi-change text-red"},"Высокий риск",-1))])]),s("div",Uf,[t[11]||(t[11]=I('<div class="panel-header" data-v-cbc555e1><div class="ph-left" data-v-cbc555e1><h3 data-v-cbc555e1>Кривая капитала</h3><span class="badge-live" data-v-cbc555e1>Накопительный</span></div><div class="chart-legend" data-v-cbc555e1><div class="legend-item" data-v-cbc555e1><span class="dot strategy" data-v-cbc555e1></span>Портфель</div><div class="legend-item" data-v-cbc555e1><span class="dot benchmark" data-v-cbc555e1></span>S&amp;P 500</div></div></div>',1)),s("div",zf,[(w(),i("svg",Vf,[t[10]||(t[10]=I('<defs data-v-cbc555e1><linearGradient id="grad-green" x1="0" y1="0" x2="0" y2="1" data-v-cbc555e1><stop offset="0%" stop-color="rgba(74, 222, 128, 0.3)" data-v-cbc555e1></stop><stop offset="100%" stop-color="rgba(74, 222, 128, 0)" data-v-cbc555e1></stop></linearGradient></defs><line x1="0" y1="50" x2="1000" y2="50" stroke="rgba(255,255,255,0.05)" data-v-cbc555e1></line><line x1="0" y1="125" x2="1000" y2="125" stroke="rgba(255,255,255,0.05)" data-v-cbc555e1></line><line x1="0" y1="200" x2="1000" y2="200" stroke="rgba(255,255,255,0.05)" data-v-cbc555e1></line>',4)),s("path",{d:E(),fill:"none",stroke:"rgba(255,255,255,0.2)","stroke-width":"2","stroke-dasharray":"6,4"},null,8,Hf),s("path",{d:R(),fill:"url(#grad-green)",stroke:"none"},null,8,Gf),s("path",{d:A(),fill:"none",stroke:"#4ade80","stroke-width":"3","stroke-linecap":"round"},null,8,Wf),D.value?(w(),i("circle",{key:0,cx:D.value.x,cy:D.value.y,r:"4",fill:"#1e293b",stroke:"#f87171","stroke-width":"2"},null,8,qf)):l("",!0)]))])]),s("div",Yf,[s("div",jf,[s("div",Xf,[t[14]||(t[14]=s("div",{class:"panel-header"},[s("h3",null,"Месячная доходность")],-1)),s("div",$f,[s("table",Kf,[s("thead",null,[s("tr",null,[t[12]||(t[12]=s("th",{class:"col-month"},null,-1)),(w(!0),i(p,null,f(k.value,e=>(w(),i("th",{key:e,class:"col-year"},v(e),1))),128))])]),s("tbody",null,[(w(!0),i(p,null,f(b.value,(e,t)=>(w(),i("tr",{key:e},[s("td",Zf,v(e),1),(w(!0),i(p,null,f(k.value,a=>(w(),i("td",{key:`${e}-${a}`,class:"col-val"},[s("div",{class:c(["val-pill",M(T.value[t]?.[a]||"0.0")])},v(T.value[t]?.[a]||"0.0")+"% ",3)]))),128))]))),128)),t[13]||(t[13]=s("tr",{class:"row-total"},[s("td",{class:"col-month"},"YTD"),s("td",{class:"col-val"},[s("span",{class:"text-green font-bold"},"+24.1%")]),s("td",{class:"col-val"},[s("span",{class:"text-green font-bold"},"+18.5%")])],-1))])])])])]),s("div",Jf,[s("div",Qf,[t[21]||(t[21]=s("div",{class:"panel-header"},[s("h3",null,"Статистика сделок")],-1)),s("div",em,[s("div",tm,[t[15]||(t[15]=s("span",{class:"lbl"},"Всего сделок",-1)),s("span",am,v(h.value?.metrics?.total_trades||243),1)]),s("div",nm,[t[16]||(t[16]=s("span",{class:"lbl"},"Win Rate",-1)),s("span",rm,v(h.value?.metrics?(100*h.value.metrics.win_rate).toFixed(1)+"%":"64.2%"),1)]),s("div",im,[t[17]||(t[17]=s("span",{class:"lbl"},"Profit Factor",-1)),s("span",om,v(h.value?.metrics?h.value.metrics.profit_factor.toFixed(2):"2.34"),1)]),s("div",sm,[t[18]||(t[18]=s("span",{class:"lbl"},"Средняя прибыль",-1)),s("span",lm,v(h.value?.metrics?"+"+h.value.metrics.avg_profit.toFixed(0):"+₽245"),1)]),s("div",cm,[t[19]||(t[19]=s("span",{class:"lbl"},"Средний убыток",-1)),s("span",um,v(h.value?.metrics?"-"+h.value.metrics.avg_loss.toFixed(0):"-₽145"),1)]),s("div",dm,[t[20]||(t[20]=s("span",{class:"lbl"},"Время удержания",-1)),s("span",hm,v(h.value?.metrics?h.value.metrics.hold_time.toFixed(1)+"d":"8.4d"),1)])])]),s("div",pm,[t[22]||(t[22]=s("div",{class:"panel-header"},[s("h3",null,"Топ 3 просадки")],-1)),s("div",fm,[(w(!0),i(p,null,f(h.value?.metrics?.drawdowns||_,(e,t)=>(w(),i("div",{key:t,class:"dd-item"},[s("div",mm,[s("span",vm,v(e.period),1),s("span",gm,"Восстановление: "+v(e.recovery),1)]),s("div",ym,[s("span",bm,v(e.amount.toFixed(1))+"%",1),s("div",xm,[s("div",{class:"dd-bar-fill",style:y({width:3*Math.abs(e.amount)+"px"})},null,4)])])]))),128))])])])])]))}}),_m=xe(wm,[["__scopeId","data-v-cbc555e1"]]);const Sm={class:"page-container"},Mm={class:"section-header"},Tm={class:"header-actions"},km=["disabled"],Cm={key:0,class:"flex items-center gap-2"},Am={key:1,class:"flex items-center gap-2"},Em={class:"report-viewport custom-scroll"},Im={id:"report-content",class:"a4-sheet"},Rm={class:"rep-header"},Dm={class:"rep-meta"},Pm={class:"rep-date"},Lm={class:"rep-hero"},Nm={class:"rep-tags"},Om={class:"rep-tag"},Fm={class:"rep-tag"},Bm={class:"rep-section"},Um={class:"sec-text"},zm={class:"rep-meta-info"},Vm={class:"meta-row"},Hm={class:"meta-value"},Gm={class:"meta-row"},Wm={class:"meta-value"},qm={class:"meta-row"},Ym={class:"meta-value"},jm={class:"rep-section"},Xm={class:"metrics-grid"},$m={class:"metric-box"},Km={class:"metric-box"},Zm={class:"m-value"},Jm={class:"metric-box"},Qm={class:"m-value warning"},ev={class:"metric-box"},tv={class:"m-value"},av={class:"metric-box"},nv={class:"m-value"},rv={class:"metric-box"},iv={class:"m-value warning"},ov={class:"metric-box"},sv={class:"metric-box"},lv={class:"rep-section"},cv={class:"chart-container-print"},uv={viewBox:"0 0 600 200",class:"print-chart"},dv=["x","y","height","fill"],hv=["x"],pv=["x","y"],fv={class:"rep-section"},mv={class:"print-table"},vv={class:"text-red"},gv={class:"text-red"},yv={key:0},bv={class:"rep-section"},xv={class:"portfolio-summary"},wv={class:"summary-stats"},_v={class:"stat-item"},Sv={class:"stat-value"},Mv={class:"stat-item"},Tv={class:"stat-value"},kv={class:"stat-item"},Cv={class:"stat-value"},Av={class:"top-positions"},Ev={class:"positions-list"},Iv={class:"pos-symbol"},Rv={class:"pos-weight"},Dv={class:"pos-value"},Pv=e({__name:"Reports",setup(e){const{exportToPdf:a,isExporting:n}=function(){const e=t(!1);return{exportToPdf:async(t,a="report.pdf")=>{e.value=!0;try{const e=await ne(()=>import("./pdf-3nw1PNim.js").then(e=>e.h),[]),n=e.default||e,r=document.getElementById(t);if(!r)throw new Error(`Element #${t} not found`);const i={margin:[10,10,10,10],filename:a,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,backgroundColor:"#0f172a"},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};await n().set(i).from(r).save()}catch(TQe){console.error("PDF Export Error:",TQe),alert("Ошибка экспорта PDF. Убедитесь, что html2pdf.js установлен (npm install html2pdf.js)")}finally{e.value=!1}},isExporting:e}}(),r=Ad(),o=Ys(),u=S(()=>(new Date).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"})),d=S(()=>r.totalEquity),h=S(()=>r.var95),g=S(()=>r.cvar95),y=S(()=>r.sharpeRatio),b=S(()=>r.portfolioBeta),x=S(()=>r.expectedReturn),_=S(()=>r.volatility),M=S(()=>r.maxDrawdown),T=S(()=>r.riskContributions),k=S(()=>o.positions),C=S(()=>o.selectedBank),A=e=>"₽"+Math.abs(e).toLocaleString("ru-RU",{maximumFractionDigits:0}),E=(e,t=2)=>(100*e).toFixed(t)+"%",R=S(()=>0===x.value?.125:.5*x.value),D=S(()=>{const e=T.value;return 0===e.length?[{symbol:"TSLA",name:"Tesla Inc",weight:5.2,volatility:45.2,varContribution:12.4},{symbol:"NVDA",name:"Nvidia Corp",weight:4.8,volatility:38.1,varContribution:10.1},{symbol:"BTC",name:"Bitcoin",weight:2.1,volatility:55,varContribution:8.5}]:e.slice(0,5).map(e=>{const t=k.value.find(t=>t.symbol===e.symbol),a=e.contribution>0&&e.weight>0?e.contribution/(d.value*e.weight/100)*100:20+30*Math.random();return{symbol:e.symbol,name:t?.name||e.symbol,weight:e.weight,volatility:a,varContribution:e.percentRisk}})}),P=S(()=>{const e=T.value.slice(0,5),t=e.length>0?Math.max(...e.map(e=>e.percentRisk)):50;return 0===e.length?[{label:"Tech",value:40,maxValue:50,color:"#3b82f6"},{label:"Fin",value:30,maxValue:50,color:"#8b5cf6"},{label:"Gold",value:15,maxValue:50,color:"#fbbf24"},{label:"Bonds",value:10,maxValue:50,color:"#ef4444"},{label:"Energy",value:5,maxValue:50,color:"#10b981"}]:e.map((e,a)=>{const n=["#3b82f6","#8b5cf6","#fbbf24","#ef4444","#10b981"];return{label:e.symbol,value:e.percentRisk,maxValue:t,color:e.color||n[a%n.length]}})}),L=S(()=>{const e=Math.abs(h.value)/d.value*100,t=100*_.value,a=y.value;let n="умеренную";return t>20&&(n="повышенную"),t>30&&(n="высокую"),t<10&&(n="низкую"),`Портфель демонстрирует ${n} волатильность (${t.toFixed(1)}%) в текущем рыночном режиме. Показатель Value-at-Risk (95%) составляет ${E(Math.abs(h.value)/d.value)}, что ${e<2.5?"остается в пределах установленных лимитов":"превышает рекомендуемые пороги"}. Коэффициент Шарпа ${a.toFixed(2)} ${a>1.5?"указывает на эффективное управление рисками":a>1?"свидетельствует о приемлемом соотношении доходности и риска":"требует внимания к структуре портфеля"}. Максимальная просадка ${E(M.value)} ${M.value<.15?"находится в допустимых пределах":"превышает рекомендуемые значения"}.`}),N=()=>{a("report-content",`PortfolioReport_${C.value.name.replace(/\s+/g,"_")}_${(new Date).toISOString().slice(0,10)}.pdf`)};return(e,t)=>(w(),i("div",Sm,[s("div",Mm,[t[2]||(t[2]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Аналитические отчеты"),s("p",{class:"section-subtitle"},"Генерация PDF-сводки по состоянию портфеля")],-1)),s("div",Tm,[s("button",{class:"btn-glass primary",onClick:N,disabled:O(n)},[O(n)?(w(),i("span",Cm,[...t[0]||(t[0]=[s("span",{class:"spinner-mini"},null,-1),m(" Генерация... ",-1)])])):(w(),i("span",Am,[...t[1]||(t[1]=[s("span",null,"Скачать PDF",-1),s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)])]))],8,km)])]),s("div",Em,[s("div",Im,[s("div",Rm,[t[4]||(t[4]=s("div",{class:"rep-logo"},[s("div",{class:"logo-icon"},"RK"),s("span",null,[m("Quant"),s("span",{class:"text-accent"},"Risk")])],-1)),s("div",Dm,[t[3]||(t[3]=s("div",{class:"rep-label"},"ДАТА ОТЧЕТА",-1)),s("div",Pm,v(u.value),1)])]),t[33]||(t[33]=s("div",{class:"rep-divider"},null,-1)),s("div",Lm,[t[6]||(t[6]=s("h2",{class:"rep-main-title"},"Отчет по оптимизации портфеля",-1)),s("div",Nm,[s("span",Om,v(C.value.name),1),t[5]||(t[5]=s("span",{class:"rep-tag"},"Risk Analysis",-1)),s("span",Fm,v(k.value.length)+" Assets",1)])]),s("section",Bm,[t[10]||(t[10]=s("h3",{class:"sec-title"},"1. Краткое резюме",-1)),s("p",Um,v(L.value),1),s("div",zm,[s("div",Vm,[t[7]||(t[7]=s("span",{class:"meta-label"},"Банк:",-1)),s("span",Hm,v(C.value.name),1)]),s("div",Gm,[t[8]||(t[8]=s("span",{class:"meta-label"},"Активов в портфеле:",-1)),s("span",Wm,v(k.value.length),1)]),s("div",qm,[t[9]||(t[9]=s("span",{class:"meta-label"},"Стоимость портфеля:",-1)),s("span",Ym,v(A(d.value)),1)])])]),s("section",jm,[t[19]||(t[19]=s("h3",{class:"sec-title"},"2. Ключевые метрики",-1)),s("div",Xm,[s("div",$m,[t[11]||(t[11]=s("span",{class:"m-label"},"Ожидаемая доходность (годовая)",-1)),s("span",{class:c(["m-value",x.value>=0?"positive":"negative"])},v(x.value>=0?"+":"")+v(E(x.value)),3)]),s("div",Km,[t[12]||(t[12]=s("span",{class:"m-label"},"Коэффициент Шарпа",-1)),s("span",Zm,v(y.value.toFixed(2)),1)]),s("div",Jm,[t[13]||(t[13]=s("span",{class:"m-label"},"VaR (95%, 1d)",-1)),s("span",Qm,v(d.value>0?E(Math.abs(h.value)/d.value):"0.00%"),1)]),s("div",ev,[t[14]||(t[14]=s("span",{class:"m-label"},"Beta (β)",-1)),s("span",tv,v(b.value.toFixed(2)),1)]),s("div",av,[t[15]||(t[15]=s("span",{class:"m-label"},"Волатильность (годовая)",-1)),s("span",nv,v(E(_.value)),1)]),s("div",rv,[t[16]||(t[16]=s("span",{class:"m-label"},"CVaR (95%, 1d)",-1)),s("span",iv,v(d.value>0?E(Math.abs(g.value)/d.value):"0.00%"),1)]),s("div",ov,[t[17]||(t[17]=s("span",{class:"m-label"},"Макс. просадка",-1)),s("span",{class:c(["m-value",M.value<.15?"positive":"warning"])},v(E(M.value)),3)]),s("div",sv,[t[18]||(t[18]=s("span",{class:"m-label"},"P&L (YTD, оценка)",-1)),s("span",{class:c(["m-value",R.value>=0?"positive":"negative"])},v(R.value>=0?"+":"")+v(E(R.value)),3)])])]),s("section",lv,[t[24]||(t[24]=s("h3",{class:"sec-title"},"3. Структура риска (Risk Contribution)",-1)),s("div",cv,[(w(),i("svg",uv,[t[21]||(t[21]=s("line",{x1:"0",y1:"150",x2:"600",y2:"150",stroke:"rgba(255,255,255,0.1)","stroke-width":"1"},null,-1)),t[22]||(t[22]=s("line",{x1:"0",y1:"100",x2:"600",y2:"100",stroke:"rgba(255,255,255,0.1)","stroke-width":"1"},null,-1)),t[23]||(t[23]=s("line",{x1:"0",y1:"50",x2:"600",y2:"50",stroke:"rgba(255,255,255,0.1)","stroke-width":"1"},null,-1)),(w(!0),i(p,null,f(P.value,(e,t)=>(w(),i(p,{key:t},[s("rect",{x:50+100*t,y:150-e.value/e.maxValue*100,width:"60",height:e.value/e.maxValue*100,fill:e.color,rx:"2"},null,8,dv),s("text",{x:80+100*t,y:"170",fill:"#94a3b8","font-size":"9","text-anchor":"middle"},v(e.label),9,hv),s("text",{x:80+100*t,y:145-e.value/e.maxValue*100,fill:"#fff","font-size":"8","text-anchor":"middle","font-weight":"600"},v(e.value.toFixed(1))+"% ",9,pv)],64))),128)),0===P.value.length?(w(),i(p,{key:0},[t[20]||(t[20]=I('<rect x="50" y="80" width="60" height="70" fill="#3b82f6" rx="2" data-v-9b1fcf34></rect><rect x="150" y="40" width="60" height="110" fill="#8b5cf6" rx="2" data-v-9b1fcf34></rect><rect x="250" y="100" width="60" height="50" fill="#fbbf24" rx="2" data-v-9b1fcf34></rect><rect x="350" y="60" width="60" height="90" fill="#ef4444" rx="2" data-v-9b1fcf34></rect><rect x="450" y="90" width="60" height="60" fill="#10b981" rx="2" data-v-9b1fcf34></rect><text x="80" y="170" fill="#94a3b8" font-size="10" text-anchor="middle" data-v-9b1fcf34>N/A</text>',6))],64)):l("",!0)]))])]),s("section",fv,[t[27]||(t[27]=s("h3",{class:"sec-title"},"4. Топ-5 активов по вкладу в риск (Marginal VaR)",-1)),s("table",mv,[t[26]||(t[26]=s("thead",null,[s("tr",null,[s("th",null,"Актив"),s("th",null,"Вес"),s("th",null,"Вклад в VaR"),s("th",null,"% от общего риска")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(D.value,(e,t)=>(w(),i("tr",{key:t},[s("td",null,v(e.symbol)+" ("+v(e.name)+")",1),s("td",null,v(e.weight.toFixed(1))+"%",1),s("td",vv,v(A(T.value.find(t=>t.symbol===e.symbol)?.contribution||0)),1),s("td",gv,v(e.varContribution.toFixed(1))+"%",1)]))),128)),0===D.value.length?(w(),i("tr",yv,[...t[25]||(t[25]=[s("td",{colspan:"4",style:{"text-align":"center",color:"rgba(255,255,255,0.5)"}}," Данные оптимизации недоступны. Выполните оптимизацию в разделе CCMV Optimization. ",-1)])])):l("",!0)])])]),s("section",bv,[t[32]||(t[32]=s("h3",{class:"sec-title"},"5. Состав портфеля",-1)),s("div",xv,[s("div",wv,[s("div",_v,[t[28]||(t[28]=s("span",{class:"stat-label"},"Всего активов:",-1)),s("span",Sv,v(k.value.length),1)]),s("div",Mv,[t[29]||(t[29]=s("span",{class:"stat-label"},"Стоимость портфеля:",-1)),s("span",Tv,v(A(d.value)),1)]),s("div",kv,[t[30]||(t[30]=s("span",{class:"stat-label"},"Средний вес актива:",-1)),s("span",Cv,v(k.value.length>0?(100/k.value.length).toFixed(1):0)+"%",1)])]),s("div",Av,[t[31]||(t[31]=s("div",{class:"positions-label"},"Топ-5 позиций по весу:",-1)),s("div",Ev,[(w(!0),i(p,null,f(k.value.slice(0,5),(e,t)=>(w(),i("div",{key:e.symbol,class:"position-item"},[s("span",Iv,v(e.symbol),1),s("span",Rv,v(e.allocation)+"%",1),s("span",Dv,v(A(e.notional)),1)]))),128))])])])]),t[34]||(t[34]=s("div",{class:"rep-footer"},[s("div",{class:"footer-line"}),s("div",{class:"footer-info"},[s("span",null,"© 2026 QuantRisk Analytics. Confidential."),s("span",null,"Page 1 of 1")])],-1))])])]))}}),Lv=xe(Pv,[["__scopeId","data-v-9b1fcf34"]]),Nv="rudata_credentials";function Ov(e){const t=btoa(JSON.stringify(e));localStorage.setItem(Nv,t)}const Fv=[{key:"alphaVantageKey",label:"Alpha Vantage",group:"Market Data",required:!1,placeholder:"your_alpha_vantage_key"},{key:"twelveDataKey",label:"Twelve Data",group:"Market Data",required:!1,placeholder:"your_twelve_data_key"},{key:"polygonKey",label:"Polygon.io",group:"Market Data",required:!1,placeholder:"your_polygon_key"},{key:"fredKey",label:"FRED API",group:"Macro",required:!1,placeholder:"your_fred_key"},{key:"openFigiKey",label:"OpenFIGI",group:"Macro",required:!1,placeholder:"optional_openfigi_key"},{key:"coinGeckoKey",label:"CoinGecko",group:"Crypto",required:!1,placeholder:"optional_pro_key"},{key:"coinGapKey",label:"CoinGap",group:"Crypto",required:!1,placeholder:"your_coingap_key"},{key:"newsApiKey",label:"NewsAPI",group:"News & AI",required:!1,placeholder:"your_newsapi_key"},{key:"currentsKey",label:"Currents API",group:"News & AI",required:!1,placeholder:"your_currents_key"},{key:"huggingFaceToken",label:"Hugging Face",group:"News & AI",required:!1,placeholder:"hf_your_token"},{key:"virusTotalKey",label:"VirusTotal",group:"Security",required:!1,placeholder:"your_virustotal_key"},{key:"abuseIpDbKey",label:"AbuseIPDB",group:"Security",required:!1,placeholder:"your_abuseipdb_key"},{key:"urlScanKey",label:"URLScan.io",group:"Security",required:!1,placeholder:"your_urlscan_key"},{key:"ip2WhoisKey",label:"IP2WHOIS",group:"Security",required:!1,placeholder:"your_ip2whois_key"},{key:"ipInfoToken",label:"ipinfo.io",group:"Security",required:!1,placeholder:"your_ipinfo_token"},{key:"ip2LocationKey",label:"IP2Location",group:"Security",required:!1,placeholder:"your_ip2location_key"},{key:"auth0Domain",label:"Auth0 Domain",group:"Auth",required:!1,placeholder:"tenant.auth0.com"},{key:"auth0ClientId",label:"Auth0 Client ID",group:"Auth",required:!1,placeholder:"client_id"},{key:"auth0ClientSecret",label:"Auth0 Secret",group:"Auth",required:!1,placeholder:"client_secret"},{key:"warrantKey",label:"Warrant",group:"Auth",required:!1,placeholder:"your_warrant_key"},{key:"stytchProjectId",label:"Stytch Project ID",group:"Auth",required:!1,placeholder:"project-live-xxx"},{key:"stytchSecret",label:"Stytch Secret",group:"Auth",required:!1,placeholder:"secret-live-xxx"},{key:"mojoAuthKey",label:"MojoAuth",group:"Auth",required:!1,placeholder:"your_mojoauth_key"},{key:"sendgridKey",label:"Sendgrid",group:"Email",required:!1,placeholder:"SG.your_key"},{key:"mailboxValidatorKey",label:"MailboxValidator",group:"Email",required:!1,placeholder:"your_mbv_key"},{key:"jsonBinKey",label:"JSONbin.io",group:"Storage",required:!1,placeholder:"your_jsonbin_key"},{key:"pantryBasketId",label:"Pantry Basket ID",group:"Storage",required:!1,placeholder:"your_pantry_id"},{key:"pastebinKey",label:"Pastebin",group:"Storage",required:!1,placeholder:"your_pastebin_key"},{key:"cloudinaryCloudName",label:"Cloudinary Cloud",group:"Media",required:!1,placeholder:"your_cloud"},{key:"cloudinaryApiKey",label:"Cloudinary Key",group:"Media",required:!1,placeholder:"your_key"},{key:"cloudConvertKey",label:"CloudConvert",group:"Media",required:!1,placeholder:"your_cc_key"},{key:"lobKey",label:"Lob.com",group:"Business",required:!1,placeholder:"your_lob_key"},{key:"vatLayerKey",label:"vatlayer",group:"Business",required:!1,placeholder:"your_vatlayer_key"},{key:"klarnaUser",label:"Klarna Username",group:"Business",required:!1,placeholder:"your_klarna_user"},{key:"githubToken",label:"GitHub Token",group:"Developer",required:!1,placeholder:"ghp_your_token"}],Bv="api_keys_config";const Uv={class:"page-container"},zv={class:"section-header"},Vv=["disabled"],Hv={key:0},Gv={key:1},Wv={class:"tabs-navigation"},qv=["onClick"],Yv={class:"tab-label"},jv={key:0,class:"badge-dot"},Xv={class:"settings-grid"},$v={class:"grid-content"},Kv={class:"glass-panel settings-block"},Zv={class:"control-group"},Jv={class:"control-row"},Qv={class:"segmented-control"},eg={class:"control-row"},tg={class:"control-right"},ag={class:"control-row"},ng={class:"control-right"},rg={class:"grid-content"},ig={class:"glass-panel settings-block"},og={class:"control-group"},sg={class:"control-row"},lg={class:"control-right"},cg={class:"control-row"},ug={class:"control-right"},dg={class:"control-row"},hg={class:"control-right"},pg={class:"glass-panel settings-block"},fg={class:"control-group"},mg={class:"control-row"},vg={class:"switch"},gg={class:"control-row"},yg={class:"switch"},bg={class:"grid-content"},xg={class:"glass-panel settings-block"},wg={class:"control-group risk-limits"},_g={class:"control-row"},Sg={class:"input-wrapper"},Mg={class:"control-row"},Tg={class:"input-wrapper"},kg={class:"control-row"},Cg={class:"input-wrapper"},Ag={class:"glass-panel settings-block"},Eg={class:"control-group"},Ig={class:"control-row"},Rg={class:"switch"},Dg={class:"grid-content"},Pg={class:"glass-panel settings-block"},Lg={class:"control-group"},Ng={class:"control-row vertical"},Og={class:"control-row vertical"},Fg={class:"status-footer"},Bg={class:"glass-panel settings-block"},Ug={class:"control-group"},zg={class:"control-row vertical"},Vg={class:"control-row vertical"},Hg={class:"status-footer"},Gg={class:"glass-panel settings-block"},Wg={class:"services-list"},qg={class:"srv-left"},Yg={class:"srv-name"},jg={class:"block-title"},Xg={class:"control-group"},$g={class:"control-row vertical"},Kg=["type","onUpdate:modelValue","placeholder"],Zg={key:0,class:"divider"},Jg={class:"glass-panel settings-block"},Qg={class:"services-list"},ey={class:"srv-left"},ty={class:"srv-name font-mono",style:{"font-size":"12px"}},ay=e({__name:"Settings",setup(e){const r=t("general"),o=t(!0),d=t(!1),m=[{id:"general",name:"Общие",iconClass:"icon-gen"},{id:"models",name:"Модели",iconClass:"icon-mod"},{id:"risk",name:"Риск",iconClass:"icon-risk"},{id:"api",name:"API",iconClass:"icon-api"}],g=a({cbonds:{status:"idle",message:""},rudata:{status:"idle",message:""}}),y=a({general:{theme:"dark",language:"ru",currency:"RUB"},models:{portfolioModel:"markowitz",varModel:"parametric",varConfidence:"0.95",useRollingWindow:!0,exponentialWeighting:!1},risk:{maxVaR:5,maxConcentration:25,minSharpeRatio:1.2,enableStressTesting:!0},api:{cbondsLogin:"",cbondsPassword:"",rudataLogin:"",rudataPassword:"",bloombergKey:"",webhookUrl:""},connectedServices:[{id:1,name:"Cbonds API",connected:!1},{id:2,name:"RuData Reference",connected:!1},{id:3,name:"Bloomberg Data",connected:!1},{id:4,name:"MOEX ISS",connected:!0},{id:5,name:"Alpha Vantage",connected:!1},{id:6,name:"Twelve Data",connected:!1},{id:7,name:"Polygon.io",connected:!1},{id:8,name:"FRED",connected:!1},{id:9,name:"CoinGecko",connected:!1},{id:10,name:"NewsAPI",connected:!1},{id:11,name:"Hugging Face",connected:!1},{id:12,name:"Frankfurter (ECB)",connected:!0},{id:13,name:"Bank of Russia",connected:!0},{id:14,name:"Nager.Date",connected:!0}]}),b=function(){const e=new Set(Fv.map(e=>e.group));return Array.from(e)}(),x=a({}),_=t({});function S(){const e=function(){const e=localStorage.getItem(Bv);if(!e)return{};try{return JSON.parse(e)}catch{return{}}}();for(const t of Fv)x[t.key]=e[t.key]||""}function C(){const e={};for(const t of Fv)x[t.key]&&(e[t.key]=x[t.key]);!function(e){localStorage.setItem(Bv,JSON.stringify(e))}(e)}async function A(){try{_.value=await async function(){const e={};return await Promise.all(["market-feeds","macro-data","crypto-data","news-ai","calendar","security","platform"].map(async t=>{try{const a=await fetch(`   https://stochastic-dashbord-v1-production.up.railway.app/api/${t}/health`);e[t]=a.ok}catch{e[t]=!1}})),e}()}catch{}}function E(e){return function(e){return Fv.filter(t=>t.group===e)}(e)}n(()=>{const e=function(){const e=localStorage.getItem(Nv);if(!e)return null;try{return JSON.parse(atob(e))}catch{return null}}();e&&(y.api.rudataLogin=e.login,y.api.rudataPassword=e.password,g.rudata.status="saved");const t=localStorage.getItem("app_settings");if(t)try{const e=JSON.parse(t);e.general&&Object.assign(y.general,e.general),e.models&&Object.assign(y.models,e.models),e.risk&&Object.assign(y.risk,e.risk),e.api?.cbondsLogin&&(y.api.cbondsLogin=e.api.cbondsLogin),e.api?.cbondsPassword&&(y.api.cbondsPassword=e.api.cbondsPassword)}catch(TQe){console.error("Failed to load settings:",TQe)}S(),A(),o.value=!1});const I=e=>{const t=g[e].status,a=g[e].message;return"checking"===t?{text:"Проверка...",class:"text-blue"}:"success"===t?{text:"Подключено",class:"text-green"}:"error"===t?{text:a||"Ошибка авторизации",class:"text-red"}:"saved"===t?{text:"Сохранено",class:"text-muted"}:{text:"Не подключено",class:"text-muted"}},N=async e=>{if(g[e].status="checking",g[e].message="","rudata"===e){const t=y.api.rudataLogin,a=y.api.rudataPassword;if(!t||!a)return g[e].status="error",void(g[e].message="Введите логин и пароль");try{const n=await async function(e){const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/rudata/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:`HTTP ${t.status}`}));throw new Error(e.detail||`Ошибка: ${t.status}`)}return t.json()}({login:t,password:a});if(n.success){g[e].status="success",g[e].message=n.message;const r=y.connectedServices.find(e=>e.name.toLowerCase().includes("rudata"));r&&(r.connected=!0),Ov({login:t,password:a})}else{g[e].status="error",g[e].message=n.message;const t=y.connectedServices.find(e=>e.name.toLowerCase().includes("rudata"));t&&(t.connected=!1)}}catch(QXe){g[e].status="error",g[e].message=QXe.message||"Ошибка соединения";const a=y.connectedServices.find(e=>e.name.toLowerCase().includes("rudata"));a&&(a.connected=!1)}}else"cbonds"===e&&setTimeout(()=>{if(y.api.cbondsLogin&&y.api.cbondsPassword){g[e].status="success";const t=y.connectedServices.find(e=>e.name.toLowerCase().includes("cbonds"));t&&(t.connected=!0)}else g[e].status="error",g[e].message="Введите логин и пароль"},1200)},F=()=>{y.api.rudataLogin&&y.api.rudataPassword&&Ov({login:y.api.rudataLogin,password:y.api.rudataPassword});const e={general:y.general,models:y.models,risk:y.risk,api:{cbondsLogin:y.api.cbondsLogin,cbondsPassword:y.api.cbondsPassword,bloombergKey:y.api.bloombergKey,webhookUrl:y.api.webhookUrl}};localStorage.setItem("app_settings",JSON.stringify(e)),C(),o.value=!1,setTimeout(()=>o.value=!0,2e3)};return R(y,()=>{o.value=!0},{deep:!0}),(e,t)=>(w(),i("div",Uv,[s("div",zv,[t[20]||(t[20]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Настройки"),s("p",{class:"section-subtitle"},"Конфигурация моделей и интерфейса")],-1)),s("button",{onClick:F,class:c(["btn-glass primary btn-save",{"has-changes":o.value}]),disabled:!o.value},[o.value?(w(),i("span",Hv,"Сохранить")):(w(),i("span",Gv,"Сохранено"))],10,Vv)]),s("div",Wv,[(w(),i(p,null,f(m,e=>s("button",{key:e.id,onClick:t=>r.value=e.id,class:c(["tab-item",{active:r.value===e.id}])},[s("span",Yv,v(e.name),1),"api"===e.id&&d.value?(w(),i("span",jv)):l("",!0)],10,qv)),64))]),s("div",Xv,[u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",$v,[s("div",Kv,[t[28]||(t[28]=s("h3",{class:"block-title"},"Интерфейс",-1)),s("div",Zv,[s("div",Jv,[t[21]||(t[21]=s("label",null,"Тема оформления",-1)),s("div",Qv,[s("button",{class:c({active:"dark"===y.general.theme}),onClick:t[0]||(t[0]=e=>y.general.theme="dark")},"Тёмная",2),s("button",{class:c({active:"light"===y.general.theme}),onClick:t[1]||(t[1]=e=>y.general.theme="light")},"Светлая",2),s("button",{class:c({active:"auto"===y.general.theme}),onClick:t[2]||(t[2]=e=>y.general.theme="auto")},"Авто",2)])]),t[26]||(t[26]=s("div",{class:"divider"},null,-1)),s("div",eg,[t[23]||(t[23]=s("label",null,"Язык интерфейса",-1)),s("div",tg,[T(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>y.general.language=e),class:"glass-select"},[...t[22]||(t[22]=[s("option",{value:"ru"},"Русский",-1),s("option",{value:"en"},"English",-1),s("option",{value:"de"},"Deutsch",-1)])],512),[[D,y.general.language]])])]),t[27]||(t[27]=s("div",{class:"divider"},null,-1)),s("div",ag,[t[25]||(t[25]=s("label",null,"Валюта портфеля",-1)),s("div",ng,[T(s("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>y.general.currency=e),class:"glass-select"},[...t[24]||(t[24]=[s("option",{value:"RUB"},"RUB (₽)",-1),s("option",{value:"RUB"},"RUB (₽)",-1),s("option",{value:"EUR"},"EUR (€)",-1),s("option",{value:"CNY"},"CNY (¥)",-1)])],512),[[D,y.general.currency]])])])])])],512),[[P,"general"===r.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",rg,[s("div",ig,[t[37]||(t[37]=s("h3",{class:"block-title"},"Модели Оптимизации",-1)),s("div",og,[s("div",sg,[t[30]||(t[30]=s("div",{class:"label-group"},[s("label",null,"Алгоритм весов"),s("span",{class:"sub-label"},"Метод ребалансировки портфеля")],-1)),s("div",lg,[T(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>y.models.portfolioModel=e),class:"glass-select"},[...t[29]||(t[29]=[s("option",{value:"markowitz"},"Markowitz (Mean-Variance)",-1),s("option",{value:"black-litterman"},"Black-Litterman",-1),s("option",{value:"risk-parity"},"Risk Parity (ERC)",-1),s("option",{value:"hrp"},"Hierarchical Risk Parity",-1)])],512),[[D,y.models.portfolioModel]])])]),t[35]||(t[35]=s("div",{class:"divider"},null,-1)),s("div",cg,[t[32]||(t[32]=s("div",{class:"label-group"},[s("label",null,"Модель VaR"),s("span",{class:"sub-label"},"Оценка хвостового риска")],-1)),s("div",ug,[T(s("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>y.models.varModel=e),class:"glass-select"},[...t[31]||(t[31]=[s("option",{value:"historical"},"Историческая (Historical)",-1),s("option",{value:"parametric"},"Параметрическая (Normal)",-1),s("option",{value:"cornish"},"Cornish-Fisher (Modified)",-1),s("option",{value:"gpd"},"Extreme Value Theory (GPD)",-1)])],512),[[D,y.models.varModel]])])]),t[36]||(t[36]=s("div",{class:"divider"},null,-1)),s("div",dg,[t[34]||(t[34]=s("label",null,"Доверительный интервал",-1)),s("div",hg,[T(s("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>y.models.varConfidence=e),class:"glass-select"},[...t[33]||(t[33]=[s("option",{value:"0.90"},"90.0%",-1),s("option",{value:"0.95"},"95.0%",-1),s("option",{value:"0.99"},"99.0%",-1)])],512),[[D,y.models.varConfidence]])])])])]),s("div",pg,[t[43]||(t[43]=s("h3",{class:"block-title"},"Обработка данных",-1)),s("div",fg,[s("div",mg,[t[39]||(t[39]=s("label",null,"Скользящее окно (Rolling Window)",-1)),s("label",vg,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>y.models.useRollingWindow=e)},null,512),[[L,y.models.useRollingWindow]]),t[38]||(t[38]=s("span",{class:"slider"},null,-1))])]),t[42]||(t[42]=s("div",{class:"divider"},null,-1)),s("div",gg,[t[41]||(t[41]=s("label",null,"EWMA (Экспоненциальное взвешивание)",-1)),s("label",yg,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>y.models.exponentialWeighting=e)},null,512),[[L,y.models.exponentialWeighting]]),t[40]||(t[40]=s("span",{class:"slider"},null,-1))])])])])],512),[[P,"models"===r.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",bg,[s("div",xg,[t[51]||(t[51]=s("h3",{class:"block-title"},"Глобальные Лимиты",-1)),s("div",wg,[s("div",_g,[t[45]||(t[45]=s("label",null,"Макс. VaR портфеля",-1)),s("div",Sg,[T(s("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=e=>y.risk.maxVaR=e),class:"glass-input right-align"},null,512),[[k,y.risk.maxVaR,void 0,{number:!0}]]),t[44]||(t[44]=s("span",{class:"unit"},"%",-1))])]),t[49]||(t[49]=s("div",{class:"divider"},null,-1)),s("div",Mg,[t[47]||(t[47]=s("label",null,"Макс. концентрация (на актив)",-1)),s("div",Tg,[T(s("input",{type:"number","onUpdate:modelValue":t[11]||(t[11]=e=>y.risk.maxConcentration=e),class:"glass-input right-align"},null,512),[[k,y.risk.maxConcentration,void 0,{number:!0}]]),t[46]||(t[46]=s("span",{class:"unit"},"%",-1))])]),t[50]||(t[50]=s("div",{class:"divider"},null,-1)),s("div",kg,[t[48]||(t[48]=s("label",null,"Мин. коэффициент Шарпа",-1)),s("div",Cg,[T(s("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=e=>y.risk.minSharpeRatio=e),class:"glass-input right-align",step:"0.1"},null,512),[[k,y.risk.minSharpeRatio,void 0,{number:!0}]])])])])]),s("div",Ag,[t[54]||(t[54]=s("h3",{class:"block-title"},"Автоматизация",-1)),s("div",Eg,[s("div",Ig,[t[53]||(t[53]=s("div",{class:"label-group"},[s("label",null,"Автоматическое стресс-тестирование"),s("span",{class:"sub-label"},"Запускать при каждом обновлении весов")],-1)),s("label",Rg,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=e=>y.risk.enableStressTesting=e)},null,512),[[L,y.risk.enableStressTesting]]),t[52]||(t[52]=s("span",{class:"slider"},null,-1))])])])])],512),[[P,"risk"===r.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",Dg,[s("div",Pg,[t[58]||(t[58]=s("h3",{class:"block-title"},"Cbonds API",-1)),s("div",Lg,[s("div",Ng,[t[55]||(t[55]=s("label",null,"Login",-1)),T(s("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=e=>y.api.cbondsLogin=e),class:"glass-input full",placeholder:"username@company.com"},null,512),[[k,y.api.cbondsLogin]])]),t[57]||(t[57]=s("div",{class:"divider"},null,-1)),s("div",Og,[t[56]||(t[56]=s("label",null,"Password",-1)),T(s("input",{type:"password","onUpdate:modelValue":t[15]||(t[15]=e=>y.api.cbondsPassword=e),class:"glass-input full",placeholder:"••••••••"},null,512),[[k,y.api.cbondsPassword]])])]),s("div",Fg,[s("button",{class:"btn-glass xs",onClick:t[16]||(t[16]=e=>N("cbonds"))},"Проверить"),s("span",{class:c(["status-text",I("cbonds").class])},v(I("cbonds").text),3)])]),s("div",Bg,[t[62]||(t[62]=s("h3",{class:"block-title"},"RuData / Interfax",-1)),s("div",Ug,[s("div",zg,[t[59]||(t[59]=s("label",null,"Login",-1)),T(s("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=e=>y.api.rudataLogin=e),class:"glass-input full",placeholder:"login"},null,512),[[k,y.api.rudataLogin]])]),t[61]||(t[61]=s("div",{class:"divider"},null,-1)),s("div",Vg,[t[60]||(t[60]=s("label",null,"Password",-1)),T(s("input",{type:"password","onUpdate:modelValue":t[18]||(t[18]=e=>y.api.rudataPassword=e),class:"glass-input full",placeholder:"••••••••"},null,512),[[k,y.api.rudataPassword]])])]),s("div",Hg,[s("button",{class:"btn-glass xs",onClick:t[19]||(t[19]=e=>N("rudata"))},"Проверить"),s("span",{class:c(["status-text",I("rudata").class])},v(I("rudata").text),3)])]),s("div",Gg,[t[63]||(t[63]=s("h3",{class:"block-title"},"Активные подключения",-1)),s("div",Wg,[(w(!0),i(p,null,f(y.connectedServices,e=>(w(),i("div",{key:e.id,class:"service-item"},[s("div",qg,[s("span",{class:c(["srv-dot",{connected:e.connected}])},null,2),s("span",Yg,v(e.name),1)]),s("span",{class:c(["status-indicator",{connected:e.connected}])},v(e.connected?"Active":"Offline"),3)]))),128))])]),(w(!0),i(p,null,f(O(b),e=>(w(),i("div",{key:e,class:"glass-panel settings-block"},[s("h3",jg,v(e),1),s("div",Xg,[(w(!0),i(p,null,f(E(e),(t,a)=>(w(),i(p,{key:t.key},[s("div",$g,[s("label",null,v(t.label),1),T(s("input",{type:t.key.toLowerCase().includes("secret")||t.key.toLowerCase().includes("password")?"password":"text","onUpdate:modelValue":e=>x[t.key]=e,class:"glass-input full",placeholder:t.placeholder},null,8,Kg),[[B,x[t.key]]])]),a<E(e).length-1?(w(),i("div",Zg)):l("",!0)],64))),128))])]))),128)),s("div",Jg,[t[64]||(t[64]=s("h3",{class:"block-title"},"Backend API Health",-1)),s("div",Qg,[(w(!0),i(p,null,f(_.value,(e,t)=>(w(),i("div",{key:t,class:"service-item"},[s("div",ey,[s("span",{class:c(["srv-dot",{connected:e}])},null,2),s("span",ty,v(t),1)]),s("span",{class:c(["status-indicator",{connected:e}])},v(e?"OK":"Down"),3)]))),128))]),s("div",{class:"status-footer"},[s("button",{class:"btn-glass xs",onClick:A},"Обновить статус")])])],512),[[P,"api"===r.value]])]),_:1})])]))}}),ny=xe(ay,[["__scopeId","data-v-aec563a1"]]),ry={key:0,class:"scrub-prefix"},iy={class:"scrub-value"},oy={key:1,class:"scrub-suffix"},sy=e({__name:"ScrubInput",props:{modelValue:{type:Number,required:!0},step:{type:Number,default:1},min:{type:Number,default:-1/0},max:{type:Number,default:1/0},decimals:{type:Number,default:0},prefix:{type:String,default:""},suffix:{type:String,default:""},sensitivity:{type:Number,default:1}},emits:["update:modelValue","change"],setup(e,{emit:a}){const n=e,o=a,u=t(!1);let d=0,h=0;const p=S(()=>n.modelValue.toFixed(n.decimals)),f=e=>{u.value=!0,d=e.clientX,h=n.modelValue,document.body.style.cursor="ew-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",m),window.addEventListener("mouseup",g)},m=e=>{if(!u.value)return;const t=e.clientX-d;let a=h+t*n.sensitivity*n.step;a<n.min&&(a=n.min),a>n.max&&(a=n.max),o("update:modelValue",a),o("change",a)},g=()=>{u.value=!1,document.body.style.cursor="",document.body.style.userSelect="",window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",g)};return r(()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",g)}),(t,a)=>(w(),i("div",{class:c(["scrub-container",{dragging:u.value}]),onMousedown:f},[e.prefix?(w(),i("span",ry,v(e.prefix),1)):l("",!0),s("span",iy,v(p.value),1),e.suffix?(w(),i("span",oy,v(e.suffix),1)):l("",!0)],34))}}),ly=xe(sy,[["__scopeId","data-v-53f41e1a"]]);class cy{nStates;transitionMatrix;initialStateDistribution;emissionMeans;emissionCovariances;constructor(e){e?(this.nStates=e.nStates,this.transitionMatrix=e.transitionMatrix,this.initialStateDistribution=e.initialStateDistribution,this.emissionMeans=e.emissionMeans,this.emissionCovariances=e.emissionCovariances):(this.nStates=4,this.initializeDefault())}initializeDefault(){this.transitionMatrix=[[.85,.1,.04,.01],[.15,.7,.12,.03],[.05,.15,.65,.15],[.02,.08,.3,.6]],this.initialStateDistribution=[.4,.4,.15,.05],this.emissionMeans=[[.15,8,.8],[.08,15,.6],[-.05,35,.4],[-.2,60,.2]],this.emissionCovariances=[[[2,.3,.1],[.3,5,.2],[.1,.2,.05]],[[4,.5,.2],[.5,12,.3],[.2,.3,.08]],[[8,1.5,.4],[1.5,40,.5],[.4,.5,.12]],[[15,3,.6],[3,80,.8],[.6,.8,.15]]]}forwardBackward(e){const t=e.length,a=[],n=[],r=[];for(let i=0;i<t;i++){if(a[i]=new Array(this.nStates).fill(0),0===i)for(let n=0;n<this.nStates;n++)a[i][n]=this.initialStateDistribution[n]*this.emissionProbability(e[i],n);else for(let n=0;n<this.nStates;n++){let t=0;for(let e=0;e<this.nStates;e++)t+=a[i-1][e]*this.transitionMatrix[e][n];a[i][n]=t*this.emissionProbability(e[i],n)}const t=a[i].reduce((e,t)=>e+t,0);if(t>0)for(let e=0;e<this.nStates;e++)a[i][e]/=t}for(let i=t-1;i>=0;i--){if(n[i]=new Array(this.nStates).fill(0),i===t-1)for(let e=0;e<this.nStates;e++)n[i][e]=1;else for(let t=0;t<this.nStates;t++){let a=0;for(let r=0;r<this.nStates;r++)a+=this.transitionMatrix[t][r]*this.emissionProbability(e[i+1],r)*n[i+1][r];n[i][t]=a}const a=n[i].reduce((e,t)=>e+t,0);if(a>0)for(let e=0;e<this.nStates;e++)n[i][e]/=a}for(let i=0;i<t;i++){r[i]=new Array(this.nStates).fill(0);let e=0;for(let t=0;t<this.nStates;t++)r[i][t]=a[i][t]*n[i][t],e+=r[i][t];if(e>0)for(let t=0;t<this.nStates;t++)r[i][t]/=e}return r}viterbi(e){const t=e.length,a=[],n=[],r=[];a[0]=new Array(this.nStates).fill(0);for(let s=0;s<this.nStates;s++)a[0][s]=Math.log(this.initialStateDistribution[s]+1e-10)+Math.log(this.emissionProbability(e[0],s)+1e-10);for(let s=1;s<t;s++){a[s]=new Array(this.nStates).fill(-1/0),n[s]=new Array(this.nStates).fill(0);for(let t=0;t<this.nStates;t++){let r=-1/0,i=0;for(let e=0;e<this.nStates;e++){const n=a[s-1][e]+Math.log(this.transitionMatrix[e][t]+1e-10);n>r&&(r=n,i=e)}a[s][t]=r+Math.log(this.emissionProbability(e[s],t)+1e-10),n[s][t]=i}}let i=-1/0,o=0;for(let s=0;s<this.nStates;s++)a[t-1][s]>i&&(i=a[t-1][s],o=s);r[t-1]=o;for(let s=t-2;s>=0;s--)r[s]=n[s+1][r[s+1]];return r}emissionProbability(e,t){const a=this.emissionMeans[t],n=this.emissionCovariances[t],r=[e[0]-a[0],e[1]-a[1],e[2]-a[2]],i=this.matrixDeterminant3x3(n);if(i<=0)return 1e-10;const o=this.matrixInverse3x3(n);if(!o)return 1e-10;let s=0;for(let c=0;c<3;c++){let e=0;for(let t=0;t<3;t++)e+=o[c][t]*r[t];s+=r[c]*e}const l=Math.exp(-.5*s)/Math.sqrt(Math.pow(2*Math.PI,3)*i);return Math.max(l,1e-10)}matrixDeterminant3x3(e){const t=e[0][0],a=e[0][1],n=e[0][2],r=e[1][0],i=e[1][1],o=e[1][2],s=e[2][0],l=e[2][1],c=e[2][2];return t*(i*c-o*l)-a*(r*c-o*s)+n*(r*l-i*s)}matrixInverse3x3(e){const t=this.matrixDeterminant3x3(e);if(Math.abs(t)<1e-10)return null;const a=[],n=e[0][0],r=e[0][1],i=e[0][2],o=e[1][0],s=e[1][1],l=e[1][2],c=e[2][0],u=e[2][1],d=e[2][2];return a[0]=[(s*d-l*u)/t,(i*u-r*d)/t,(r*l-i*s)/t],a[1]=[(l*c-o*d)/t,(n*d-i*c)/t,(i*o-n*l)/t],a[2]=[(o*u-s*c)/t,(r*c-n*u)/t,(n*s-r*o)/t],a}computeStationaryDistribution(){let e=new Array(this.nStates).fill(1/this.nStates);for(let t=0;t<100;t++){const t=new Array(this.nStates).fill(0);for(let n=0;n<this.nStates;n++)for(let a=0;a<this.nStates;a++)t[n]+=e[a]*this.transitionMatrix[a][n];const a=t.reduce((e,t)=>e+t,0);if(a>0)for(let e=0;e<this.nStates;e++)t[e]/=a;e=t}return e}computeExpectedDuration(e){return 1/(1-this.transitionMatrix[e][e])}getTransitionMatrix(){return this.transitionMatrix.map(e=>[...e])}getEmissionMeans(){return this.emissionMeans.map(e=>[...e])}getEmissionCovariances(){return this.emissionCovariances.map(e=>e.map(e=>[...e]))}getNStates(){return this.nStates}setParameters(e){void 0!==e.nStates&&(this.nStates=e.nStates),e.transitionMatrix&&(this.transitionMatrix=e.transitionMatrix),e.initialStateDistribution&&(this.initialStateDistribution=e.initialStateDistribution),e.emissionMeans&&(this.emissionMeans=e.emissionMeans),e.emissionCovariances&&(this.emissionCovariances=e.emissionCovariances)}}
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const uy="182",dy=0,hy=1,py=2,fy=0,my=1,vy=2,gy=3,yy=1,by=3,xy=0,wy=1,_y=2,Sy=100,My=101,Ty=102,ky=200,Cy=201,Ay=202,Ey=203,Iy=204,Ry=205,Dy=206,Py=207,Ly=208,Ny=209,Oy=210,Fy=211,By=212,Uy=213,zy=214,Vy=0,Hy=1,Gy=2,Wy=3,qy=4,Yy=5,jy=6,Xy=7,$y=0,Ky=1,Zy=2,Jy=1,Qy=2,eb=3,tb=4,ab=5,nb=6,rb=7,ib=301,ob=302,sb=306,lb=1e3,cb=1001,ub=1002,db=1003,hb=1004,pb=1005,fb=1006,mb=1007,vb=1008,gb=1009,yb=1010,bb=1011,xb=1012,wb=1013,_b=1014,Sb=1015,Mb=1016,Tb=1017,kb=1018,Cb=1020,Ab=35902,Eb=35899,Ib=1023,Rb=1026,Db=1027,Pb=1029,Lb=1030,Nb=1031,Ob=1033,Fb=33776,Bb=33777,Ub=33778,zb=33779,Vb=35840,Hb=35841,Gb=35842,Wb=35843,qb=36196,Yb=37492,jb=37496,Xb=37488,$b=37489,Kb=37490,Zb=37491,Jb=37808,Qb=37809,ex=37810,tx=37811,ax=37812,nx=37813,rx=37814,ix=37815,ox=37816,sx=37817,lx=37818,cx=37819,ux=37820,dx=37821,hx=36492,px=36494,fx=36495,mx=36283,vx=36284,gx=36285,yx=36286,bx="",xx="srgb",_x="srgb-linear",Sx="linear",Mx="srgb",Tx=7680,kx=512,Cx=513,Ax=514,Ex=515,Ix=516,Rx=517,Dx=518,Px=519,Lx=35044,Nx="300 es",Ox=2e3,Fx=2001;function Bx(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function Ux(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function zx(){const e=Ux("canvas");return e.style.display="block",e}const Vx={};function Hx(...e){const t="THREE."+e.shift();console.log(t,...e)}function Gx(...e){const t="THREE."+e.shift();console.warn(t,...e)}function Wx(...e){const t="THREE."+e.shift();console.error(t,...e)}function qx(...e){const t=e.join(" ");t in Vx||(Vx[t]=!0,Gx(...e))}class Yx{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const a=this._listeners;void 0===a[e]&&(a[e]=[]),-1===a[e].indexOf(t)&&a[e].push(t)}hasEventListener(e,t){const a=this._listeners;return void 0!==a&&(void 0!==a[e]&&-1!==a[e].indexOf(t))}removeEventListener(e,t){const a=this._listeners;if(void 0===a)return;const n=a[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const a=t[e.type];if(void 0!==a){e.target=this;const t=a.slice(0);for(let a=0,n=t.length;a<n;a++)t[a].call(this,e);e.target=null}}}const jx=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Xx=Math.PI/180,$x=180/Math.PI;function Kx(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,a=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(jx[255&e]+jx[e>>8&255]+jx[e>>16&255]+jx[e>>24&255]+"-"+jx[255&t]+jx[t>>8&255]+"-"+jx[t>>16&15|64]+jx[t>>24&255]+"-"+jx[63&a|128]+jx[a>>8&255]+"-"+jx[a>>16&255]+jx[a>>24&255]+jx[255&n]+jx[n>>8&255]+jx[n>>16&255]+jx[n>>24&255]).toLowerCase()}function Zx(e,t,a){return Math.max(t,Math.min(a,e))}function Jx(e,t,a){return(1-a)*e+a*t}function Qx(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function ew(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const tw=Xx;class aw{constructor(e=0,t=0){aw.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,a=this.y,n=e.elements;return this.x=n[0]*t+n[3]*a+n[6],this.y=n[1]*t+n[4]*a+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Zx(this.x,e.x,t.x),this.y=Zx(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Zx(this.x,e,t),this.y=Zx(this.y,e,t),this}clampLength(e,t){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Zx(a,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const a=this.dot(e)/t;return Math.acos(Zx(a,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,a=this.y-e.y;return t*t+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,a){return this.x=e.x+(t.x-e.x)*a,this.y=e.y+(t.y-e.y)*a,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const a=Math.cos(t),n=Math.sin(t),r=this.x-e.x,i=this.y-e.y;return this.x=r*a-i*n+e.x,this.y=r*n+i*a+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class nw{constructor(e=0,t=0,a=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=a,this._w=n}static slerpFlat(e,t,a,n,r,i,o){let s=a[n+0],l=a[n+1],c=a[n+2],u=a[n+3],d=r[i+0],h=r[i+1],p=r[i+2],f=r[i+3];if(o<=0)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(o>=1)return e[t+0]=d,e[t+1]=h,e[t+2]=p,void(e[t+3]=f);if(u!==f||s!==d||l!==h||c!==p){let e=s*d+l*h+c*p+u*f;e<0&&(d=-d,h=-h,p=-p,f=-f,e=-e);let t=1-o;if(e<.9995){const a=Math.acos(e),n=Math.sin(a);t=Math.sin(t*a)/n,s=s*t+d*(o=Math.sin(o*a)/n),l=l*t+h*o,c=c*t+p*o,u=u*t+f*o}else{s=s*t+d*o,l=l*t+h*o,c=c*t+p*o,u=u*t+f*o;const e=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=e,l*=e,c*=e,u*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,a,n,r,i){const o=a[n],s=a[n+1],l=a[n+2],c=a[n+3],u=r[i],d=r[i+1],h=r[i+2],p=r[i+3];return e[t]=o*p+c*u+s*h-l*d,e[t+1]=s*p+c*d+l*u-o*h,e[t+2]=l*p+c*h+o*d-s*u,e[t+3]=c*p-o*u-s*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,a,n){return this._x=e,this._y=t,this._z=a,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const a=e._x,n=e._y,r=e._z,i=e._order,o=Math.cos,s=Math.sin,l=o(a/2),c=o(n/2),u=o(r/2),d=s(a/2),h=s(n/2),p=s(r/2);switch(i){case"XYZ":this._x=d*c*u+l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u-d*h*p;break;case"YXZ":this._x=d*c*u+l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u+d*h*p;break;case"ZXY":this._x=d*c*u-l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u-d*h*p;break;case"ZYX":this._x=d*c*u-l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u+d*h*p;break;case"YZX":this._x=d*c*u+l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u-d*h*p;break;case"XZY":this._x=d*c*u-l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u+d*h*p;break;default:Gx("Quaternion: .setFromEuler() encountered an unknown order: "+i)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const a=t/2,n=Math.sin(a);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,a=t[0],n=t[4],r=t[8],i=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],d=a+o+u;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(c-s)*e,this._y=(r-l)*e,this._z=(i-n)*e}else if(a>o&&a>u){const e=2*Math.sqrt(1+a-o-u);this._w=(c-s)/e,this._x=.25*e,this._y=(n+i)/e,this._z=(r+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-a-u);this._w=(r-l)/e,this._x=(n+i)/e,this._y=.25*e,this._z=(s+c)/e}else{const e=2*Math.sqrt(1+u-a-o);this._w=(i-n)/e,this._x=(r+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let a=e.dot(t)+1;return a<1e-8?(a=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=a):(this._x=0,this._y=-e.z,this._z=e.y,this._w=a)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=a),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Zx(this.dot(e),-1,1)))}rotateTowards(e,t){const a=this.angleTo(e);if(0===a)return this;const n=Math.min(1,t/a);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const a=e._x,n=e._y,r=e._z,i=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=a*c+i*o+n*l-r*s,this._y=n*c+i*s+r*o-a*l,this._z=r*c+i*l+a*s-n*o,this._w=i*c-a*o-n*s-r*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let a=e._x,n=e._y,r=e._z,i=e._w,o=this.dot(e);o<0&&(a=-a,n=-n,r=-r,i=-i,o=-o);let s=1-t;if(o<.9995){const e=Math.acos(o),l=Math.sin(e);s=Math.sin(s*e)/l,t=Math.sin(t*e)/l,this._x=this._x*s+a*t,this._y=this._y*s+n*t,this._z=this._z*s+r*t,this._w=this._w*s+i*t,this._onChangeCallback()}else this._x=this._x*s+a*t,this._y=this._y*s+n*t,this._z=this._z*s+r*t,this._w=this._w*s+i*t,this.normalize();return this}slerpQuaternions(e,t,a){return this.copy(e).slerp(t,a)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),a=Math.random(),n=Math.sqrt(1-a),r=Math.sqrt(a);return this.set(n*Math.sin(e),n*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class rw{constructor(e=0,t=0,a=0){rw.prototype.isVector3=!0,this.x=e,this.y=t,this.z=a}set(e,t,a){return void 0===a&&(a=this.z),this.x=e,this.y=t,this.z=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ow.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ow.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,a=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*a+r[6]*n,this.y=r[1]*t+r[4]*a+r[7]*n,this.z=r[2]*t+r[5]*a+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,a=this.y,n=this.z,r=e.elements,i=1/(r[3]*t+r[7]*a+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*a+r[8]*n+r[12])*i,this.y=(r[1]*t+r[5]*a+r[9]*n+r[13])*i,this.z=(r[2]*t+r[6]*a+r[10]*n+r[14])*i,this}applyQuaternion(e){const t=this.x,a=this.y,n=this.z,r=e.x,i=e.y,o=e.z,s=e.w,l=2*(i*n-o*a),c=2*(o*t-r*n),u=2*(r*a-i*t);return this.x=t+s*l+i*u-o*c,this.y=a+s*c+o*l-r*u,this.z=n+s*u+r*c-i*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,a=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*a+r[8]*n,this.y=r[1]*t+r[5]*a+r[9]*n,this.z=r[2]*t+r[6]*a+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Zx(this.x,e.x,t.x),this.y=Zx(this.y,e.y,t.y),this.z=Zx(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Zx(this.x,e,t),this.y=Zx(this.y,e,t),this.z=Zx(this.z,e,t),this}clampLength(e,t){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Zx(a,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,a){return this.x=e.x+(t.x-e.x)*a,this.y=e.y+(t.y-e.y)*a,this.z=e.z+(t.z-e.z)*a,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const a=e.x,n=e.y,r=e.z,i=t.x,o=t.y,s=t.z;return this.x=n*s-r*o,this.y=r*i-a*s,this.z=a*o-n*i,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const a=e.dot(this)/t;return this.copy(e).multiplyScalar(a)}projectOnPlane(e){return iw.copy(this).projectOnVector(e),this.sub(iw)}reflect(e){return this.sub(iw.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const a=this.dot(e)/t;return Math.acos(Zx(a,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,a=this.y-e.y,n=this.z-e.z;return t*t+a*a+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,a){const n=Math.sin(t)*e;return this.x=n*Math.sin(a),this.y=Math.cos(t)*e,this.z=n*Math.cos(a),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,a){return this.x=e*Math.sin(t),this.y=a,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),a=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=a,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,a=Math.sqrt(1-t*t);return this.x=a*Math.cos(e),this.y=t,this.z=a*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const iw=new rw,ow=new nw;class sw{constructor(e,t,a,n,r,i,o,s,l){sw.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,a,n,r,i,o,s,l)}set(e,t,a,n,r,i,o,s,l){const c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=r,c[5]=s,c[6]=a,c[7]=i,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,a=e.elements;return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],this}extractBasis(e,t,a){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const a=e.elements,n=t.elements,r=this.elements,i=a[0],o=a[3],s=a[6],l=a[1],c=a[4],u=a[7],d=a[2],h=a[5],p=a[8],f=n[0],m=n[3],v=n[6],g=n[1],y=n[4],b=n[7],x=n[2],w=n[5],_=n[8];return r[0]=i*f+o*g+s*x,r[3]=i*m+o*y+s*w,r[6]=i*v+o*b+s*_,r[1]=l*f+c*g+u*x,r[4]=l*m+c*y+u*w,r[7]=l*v+c*b+u*_,r[2]=d*f+h*g+p*x,r[5]=d*m+h*y+p*w,r[8]=d*v+h*b+p*_,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],a=e[1],n=e[2],r=e[3],i=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*i*c-t*o*l-a*r*c+a*o*s+n*r*l-n*i*s}invert(){const e=this.elements,t=e[0],a=e[1],n=e[2],r=e[3],i=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*i-o*l,d=o*s-c*r,h=l*r-i*s,p=t*u+a*d+n*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(n*l-c*a)*f,e[2]=(o*a-n*i)*f,e[3]=d*f,e[4]=(c*t-n*s)*f,e[5]=(n*r-o*t)*f,e[6]=h*f,e[7]=(a*s-l*t)*f,e[8]=(i*t-a*r)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,a,n,r,i,o){const s=Math.cos(r),l=Math.sin(r);return this.set(a*s,a*l,-a*(s*i+l*o)+i+e,-n*l,n*s,-n*(-l*i+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(lw.makeScale(e,t)),this}rotate(e){return this.premultiply(lw.makeRotation(-e)),this}translate(e,t){return this.premultiply(lw.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),a=Math.sin(e);return this.set(t,-a,0,a,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,a=e.elements;for(let n=0;n<9;n++)if(t[n]!==a[n])return!1;return!0}fromArray(e,t=0){for(let a=0;a<9;a++)this.elements[a]=e[a+t];return this}toArray(e=[],t=0){const a=this.elements;return e[t]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=a[3],e[t+4]=a[4],e[t+5]=a[5],e[t+6]=a[6],e[t+7]=a[7],e[t+8]=a[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const lw=new sw,cw=(new sw).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),uw=(new sw).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function dw(){const e={enabled:!0,workingColorSpace:_x,spaces:{},convert:function(e,t,a){return!1!==this.enabled&&t!==a&&t&&a?(this.spaces[t].transfer===Mx&&(e.r=pw(e.r),e.g=pw(e.g),e.b=pw(e.b)),this.spaces[t].primaries!==this.spaces[a].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Mx&&(e.r=fw(e.r),e.g=fw(e.g),e.b=fw(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===bx?Sx:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,a){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,a){return qx("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,a)},toWorkingColorSpace:function(t,a){return qx("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,a)}},t=[.64,.33,.3,.6,.15,.06],a=[.2126,.7152,.0722],n=[.3127,.329];return e.define({[_x]:{primaries:t,whitePoint:n,transfer:Sx,toXYZ:cw,fromXYZ:uw,luminanceCoefficients:a,workingColorSpaceConfig:{unpackColorSpace:xx},outputColorSpaceConfig:{drawingBufferColorSpace:xx}},[xx]:{primaries:t,whitePoint:n,transfer:Mx,toXYZ:cw,fromXYZ:uw,luminanceCoefficients:a,outputColorSpaceConfig:{drawingBufferColorSpace:xx}}}),e}const hw=dw();function pw(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function fw(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let mw;class vw{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let a;if(e instanceof HTMLCanvasElement)a=e;else{void 0===mw&&(mw=Ux("canvas")),mw.width=e.width,mw.height=e.height;const t=mw.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),a=mw}return a.toDataURL(t)}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Ux("canvas");t.width=e.width,t.height=e.height;const a=t.getContext("2d");a.drawImage(e,0,0,e.width,e.height);const n=a.getImageData(0,0,e.width,e.height),r=n.data;for(let e=0;e<r.length;e++)r[e]=255*pw(r[e]/255);return a.putImageData(n,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*pw(t[e]/255)):t[e]=pw(t[e]);return{data:t,width:e.width,height:e.height}}return Gx("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let gw=0;class yw{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:gw++}),this.uuid=Kx(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):"undefined"!=typeof VideoFrame&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const a={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,a=n.length;t<a;t++)n[t].isDataTexture?e.push(bw(n[t].image)):e.push(bw(n[t]))}else e=bw(n);a.url=e}return t||(e.images[this.uuid]=a),a}}function bw(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?vw.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(Gx("Texture: Unable to serialize Texture."),{})}let xw=0;const ww=new rw;class _w extends Yx{constructor(e=_w.DEFAULT_IMAGE,t=_w.DEFAULT_MAPPING,a=1001,n=1001,r=1006,i=1008,o=1023,s=gb,l=_w.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:xw++}),this.uuid=Kx(),this.name="",this.source=new yw(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=a,this.wrapT=n,this.magFilter=r,this.minFilter=i,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new aw(0,0),this.repeat=new aw(1,1),this.center=new aw(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sw,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(ww).x}get height(){return this.source.getSize(ww).y}get depth(){return this.source.getSize(ww).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const a=e[t];if(void 0===a){Gx(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const n=this[t];void 0!==n?n&&a&&n.isVector2&&a.isVector2||n&&a&&n.isVector3&&a.isVector3||n&&a&&n.isMatrix3&&a.isMatrix3?n.copy(a):this[t]=a:Gx(`Texture.setValues(): property '${t}' does not exist.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const a={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(a.userData=this.userData),t||(e.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case lb:e.x=e.x-Math.floor(e.x);break;case cb:e.x=e.x<0?0:1;break;case ub:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case lb:e.y=e.y-Math.floor(e.y);break;case cb:e.y=e.y<0?0:1;break;case ub:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}_w.DEFAULT_IMAGE=null,_w.DEFAULT_MAPPING=300,_w.DEFAULT_ANISOTROPY=1;class Sw{constructor(e=0,t=0,a=0,n=1){Sw.prototype.isVector4=!0,this.x=e,this.y=t,this.z=a,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,a,n){return this.x=e,this.y=t,this.z=a,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,a=this.y,n=this.z,r=this.w,i=e.elements;return this.x=i[0]*t+i[4]*a+i[8]*n+i[12]*r,this.y=i[1]*t+i[5]*a+i[9]*n+i[13]*r,this.z=i[2]*t+i[6]*a+i[10]*n+i[14]*r,this.w=i[3]*t+i[7]*a+i[11]*n+i[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,a,n,r;const i=.01,o=.1,s=e.elements,l=s[0],c=s[4],u=s[8],d=s[1],h=s[5],p=s[9],f=s[2],m=s[6],v=s[10];if(Math.abs(c-d)<i&&Math.abs(u-f)<i&&Math.abs(p-m)<i){if(Math.abs(c+d)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+h+v-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,s=(h+1)/2,g=(v+1)/2,y=(c+d)/4,b=(u+f)/4,x=(p+m)/4;return e>s&&e>g?e<i?(a=0,n=.707106781,r=.707106781):(a=Math.sqrt(e),n=y/a,r=b/a):s>g?s<i?(a=.707106781,n=0,r=.707106781):(n=Math.sqrt(s),a=y/n,r=x/n):g<i?(a=.707106781,n=.707106781,r=0):(r=Math.sqrt(g),a=b/r,n=x/r),this.set(a,n,r,t),this}let g=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(d-c)*(d-c));return Math.abs(g)<.001&&(g=1),this.x=(m-p)/g,this.y=(u-f)/g,this.z=(d-c)/g,this.w=Math.acos((l+h+v-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Zx(this.x,e.x,t.x),this.y=Zx(this.y,e.y,t.y),this.z=Zx(this.z,e.z,t.z),this.w=Zx(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Zx(this.x,e,t),this.y=Zx(this.y,e,t),this.z=Zx(this.z,e,t),this.w=Zx(this.w,e,t),this}clampLength(e,t){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Zx(a,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,a){return this.x=e.x+(t.x-e.x)*a,this.y=e.y+(t.y-e.y)*a,this.z=e.z+(t.z-e.z)*a,this.w=e.w+(t.w-e.w)*a,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Mw extends Yx{constructor(e=1,t=1,a={}){super(),a=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:fb,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},a),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=a.depth,this.scissor=new Sw(0,0,e,t),this.scissorTest=!1,this.viewport=new Sw(0,0,e,t);const n={width:e,height:t,depth:a.depth},r=new _w(n);this.textures=[];const i=a.count;for(let o=0;o<i;o++)this.textures[o]=r.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(a),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.resolveDepthBuffer=a.resolveDepthBuffer,this.resolveStencilBuffer=a.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=a.depthTexture,this.samples=a.samples,this.multiview=a.multiview}_setTextureOptions(e={}){const t={minFilter:fb,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let a=0;a<this.textures.length;a++){this.textures[a].setValues(t)}}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,a=1){if(this.width!==e||this.height!==t||this.depth!==a){this.width=e,this.height=t,this.depth=a;for(let n=0,r=this.textures.length;n<r;n++)this.textures[n].image.width=e,this.textures[n].image.height=t,this.textures[n].image.depth=a,!0!==this.textures[n].isData3DTexture&&(this.textures[n].isArrayTexture=this.textures[n].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,a=e.textures.length;t<a;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const a=Object.assign({},e.textures[t].image);this.textures[t].source=new yw(a)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Tw extends Mw{constructor(e=1,t=1,a={}){super(e,t,a),this.isWebGLRenderTarget=!0}}class kw extends _w{constructor(e=null,t=1,a=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:a,depth:n},this.magFilter=db,this.minFilter=db,this.wrapR=cb,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Cw extends _w{constructor(e=null,t=1,a=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:a,depth:n},this.magFilter=db,this.minFilter=db,this.wrapR=cb,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Aw{constructor(e=new rw(1/0,1/0,1/0),t=new rw(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,a=e.length;t<a;t+=3)this.expandByPoint(Iw.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,a=e.count;t<a;t++)this.expandByPoint(Iw.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,a=e.length;t<a;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const a=Iw.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(a),this.max.copy(e).add(a),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const a=e.geometry;if(void 0!==a){const n=a.getAttribute("position");if(!0===t&&void 0!==n&&!0!==e.isInstancedMesh)for(let t=0,a=n.count;t<a;t++)!0===e.isMesh?e.getVertexPosition(t,Iw):Iw.fromBufferAttribute(n,t),Iw.applyMatrix4(e.matrixWorld),this.expandByPoint(Iw);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Rw.copy(e.boundingBox)):(null===a.boundingBox&&a.computeBoundingBox(),Rw.copy(a.boundingBox)),Rw.applyMatrix4(e.matrixWorld),this.union(Rw)}const n=e.children;for(let r=0,i=n.length;r<i;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Iw),Iw.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,a;return e.normal.x>0?(t=e.normal.x*this.min.x,a=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,a=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,a+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,a+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,a+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,a+=e.normal.z*this.min.z),t<=-e.constant&&a>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Bw),Uw.subVectors(this.max,Bw),Dw.subVectors(e.a,Bw),Pw.subVectors(e.b,Bw),Lw.subVectors(e.c,Bw),Nw.subVectors(Pw,Dw),Ow.subVectors(Lw,Pw),Fw.subVectors(Dw,Lw);let t=[0,-Nw.z,Nw.y,0,-Ow.z,Ow.y,0,-Fw.z,Fw.y,Nw.z,0,-Nw.x,Ow.z,0,-Ow.x,Fw.z,0,-Fw.x,-Nw.y,Nw.x,0,-Ow.y,Ow.x,0,-Fw.y,Fw.x,0];return!!Hw(t,Dw,Pw,Lw,Uw)&&(t=[1,0,0,0,1,0,0,0,1],!!Hw(t,Dw,Pw,Lw,Uw)&&(zw.crossVectors(Nw,Ow),t=[zw.x,zw.y,zw.z],Hw(t,Dw,Pw,Lw,Uw)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Iw).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Iw).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ew[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ew[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ew[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ew[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ew[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ew[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ew[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ew[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ew)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Ew=[new rw,new rw,new rw,new rw,new rw,new rw,new rw,new rw],Iw=new rw,Rw=new Aw,Dw=new rw,Pw=new rw,Lw=new rw,Nw=new rw,Ow=new rw,Fw=new rw,Bw=new rw,Uw=new rw,zw=new rw,Vw=new rw;function Hw(e,t,a,n,r){for(let i=0,o=e.length-3;i<=o;i+=3){Vw.fromArray(e,i);const o=r.x*Math.abs(Vw.x)+r.y*Math.abs(Vw.y)+r.z*Math.abs(Vw.z),s=t.dot(Vw),l=a.dot(Vw),c=n.dot(Vw);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}const Gw=new Aw,Ww=new rw,qw=new rw;class Yw{constructor(e=new rw,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const a=this.center;void 0!==t?a.copy(t):Gw.setFromPoints(e).getCenter(a);let n=0;for(let r=0,i=e.length;r<i;r++)n=Math.max(n,a.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const a=this.center.distanceToSquared(e);return t.copy(e),a>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ww.subVectors(e,this.center);const t=Ww.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),a=.5*(e-this.radius);this.center.addScaledVector(Ww,a/e),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(qw.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ww.copy(e.center).add(qw)),this.expandByPoint(Ww.copy(e.center).sub(qw))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const jw=new rw,Xw=new rw,$w=new rw,Kw=new rw,Zw=new rw,Jw=new rw,Qw=new rw;class e_{constructor(e=new rw,t=new rw(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,jw)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const a=t.dot(this.direction);return a<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,a)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=jw.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(jw.copy(this.origin).addScaledVector(this.direction,t),jw.distanceToSquared(e))}distanceSqToSegment(e,t,a,n){Xw.copy(e).add(t).multiplyScalar(.5),$w.copy(t).sub(e).normalize(),Kw.copy(this.origin).sub(Xw);const r=.5*e.distanceTo(t),i=-this.direction.dot($w),o=Kw.dot(this.direction),s=-Kw.dot($w),l=Kw.lengthSq(),c=Math.abs(1-i*i);let u,d,h,p;if(c>0)if(u=i*s-o,d=i*o-s,p=r*c,u>=0)if(d>=-p)if(d<=p){const e=1/c;u*=e,d*=e,h=u*(u+i*d+2*o)+d*(i*u+d+2*s)+l}else d=r,u=Math.max(0,-(i*d+o)),h=-u*u+d*(d+2*s)+l;else d=-r,u=Math.max(0,-(i*d+o)),h=-u*u+d*(d+2*s)+l;else d<=-p?(u=Math.max(0,-(-i*r+o)),d=u>0?-r:Math.min(Math.max(-r,-s),r),h=-u*u+d*(d+2*s)+l):d<=p?(u=0,d=Math.min(Math.max(-r,-s),r),h=d*(d+2*s)+l):(u=Math.max(0,-(i*r+o)),d=u>0?r:Math.min(Math.max(-r,-s),r),h=-u*u+d*(d+2*s)+l);else d=i>0?-r:r,u=Math.max(0,-(i*d+o)),h=-u*u+d*(d+2*s)+l;return a&&a.copy(this.origin).addScaledVector(this.direction,u),n&&n.copy(Xw).addScaledVector($w,d),h}intersectSphere(e,t){jw.subVectors(e.center,this.origin);const a=jw.dot(this.direction),n=jw.dot(jw)-a*a,r=e.radius*e.radius;if(n>r)return null;const i=Math.sqrt(r-n),o=a-i,s=a+i;return s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const a=-(this.origin.dot(e.normal)+e.constant)/t;return a>=0?a:null}intersectPlane(e,t){const a=this.distanceToPlane(e);return null===a?null:this.at(a,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let a,n,r,i,o,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(a=(e.min.x-d.x)*l,n=(e.max.x-d.x)*l):(a=(e.max.x-d.x)*l,n=(e.min.x-d.x)*l),c>=0?(r=(e.min.y-d.y)*c,i=(e.max.y-d.y)*c):(r=(e.max.y-d.y)*c,i=(e.min.y-d.y)*c),a>i||r>n?null:((r>a||isNaN(a))&&(a=r),(i<n||isNaN(n))&&(n=i),u>=0?(o=(e.min.z-d.z)*u,s=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,s=(e.min.z-d.z)*u),a>s||o>n?null:((o>a||a!=a)&&(a=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(a>=0?a:n,t)))}intersectsBox(e){return null!==this.intersectBox(e,jw)}intersectTriangle(e,t,a,n,r){Zw.subVectors(t,e),Jw.subVectors(a,e),Qw.crossVectors(Zw,Jw);let i,o=this.direction.dot(Qw);if(o>0){if(n)return null;i=1}else{if(!(o<0))return null;i=-1,o=-o}Kw.subVectors(this.origin,e);const s=i*this.direction.dot(Jw.crossVectors(Kw,Jw));if(s<0)return null;const l=i*this.direction.dot(Zw.cross(Kw));if(l<0)return null;if(s+l>o)return null;const c=-i*Kw.dot(Qw);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class t_{constructor(e,t,a,n,r,i,o,s,l,c,u,d,h,p,f,m){t_.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,a,n,r,i,o,s,l,c,u,d,h,p,f,m)}set(e,t,a,n,r,i,o,s,l,c,u,d,h,p,f,m){const v=this.elements;return v[0]=e,v[4]=t,v[8]=a,v[12]=n,v[1]=r,v[5]=i,v[9]=o,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=d,v[3]=h,v[7]=p,v[11]=f,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new t_).fromArray(this.elements)}copy(e){const t=this.elements,a=e.elements;return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],this}copyPosition(e){const t=this.elements,a=e.elements;return t[12]=a[12],t[13]=a[13],t[14]=a[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,a){return 0===this.determinant()?(e.set(1,0,0),t.set(0,1,0),a.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this)}makeBasis(e,t,a){return this.set(e.x,t.x,a.x,0,e.y,t.y,a.y,0,e.z,t.z,a.z,0,0,0,0,1),this}extractRotation(e){if(0===e.determinant())return this.identity();const t=this.elements,a=e.elements,n=1/a_.setFromMatrixColumn(e,0).length(),r=1/a_.setFromMatrixColumn(e,1).length(),i=1/a_.setFromMatrixColumn(e,2).length();return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=0,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=0,t[8]=a[8]*i,t[9]=a[9]*i,t[10]=a[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,a=e.x,n=e.y,r=e.z,i=Math.cos(a),o=Math.sin(a),s=Math.cos(n),l=Math.sin(n),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=i*c,a=i*u,n=o*c,r=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=a+n*l,t[5]=e-r*l,t[9]=-o*s,t[2]=r-e*l,t[6]=n+a*l,t[10]=i*s}else if("YXZ"===e.order){const e=s*c,a=s*u,n=l*c,r=l*u;t[0]=e+r*o,t[4]=n*o-a,t[8]=i*l,t[1]=i*u,t[5]=i*c,t[9]=-o,t[2]=a*o-n,t[6]=r+e*o,t[10]=i*s}else if("ZXY"===e.order){const e=s*c,a=s*u,n=l*c,r=l*u;t[0]=e-r*o,t[4]=-i*u,t[8]=n+a*o,t[1]=a+n*o,t[5]=i*c,t[9]=r-e*o,t[2]=-i*l,t[6]=o,t[10]=i*s}else if("ZYX"===e.order){const e=i*c,a=i*u,n=o*c,r=o*u;t[0]=s*c,t[4]=n*l-a,t[8]=e*l+r,t[1]=s*u,t[5]=r*l+e,t[9]=a*l-n,t[2]=-l,t[6]=o*s,t[10]=i*s}else if("YZX"===e.order){const e=i*s,a=i*l,n=o*s,r=o*l;t[0]=s*c,t[4]=r-e*u,t[8]=n*u+a,t[1]=u,t[5]=i*c,t[9]=-o*c,t[2]=-l*c,t[6]=a*u+n,t[10]=e-r*u}else if("XZY"===e.order){const e=i*s,a=i*l,n=o*s,r=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=i*c,t[9]=a*u-n,t[2]=n*u-a,t[6]=o*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(r_,e,i_)}lookAt(e,t,a){const n=this.elements;return l_.subVectors(e,t),0===l_.lengthSq()&&(l_.z=1),l_.normalize(),o_.crossVectors(a,l_),0===o_.lengthSq()&&(1===Math.abs(a.z)?l_.x+=1e-4:l_.z+=1e-4,l_.normalize(),o_.crossVectors(a,l_)),o_.normalize(),s_.crossVectors(l_,o_),n[0]=o_.x,n[4]=s_.x,n[8]=l_.x,n[1]=o_.y,n[5]=s_.y,n[9]=l_.y,n[2]=o_.z,n[6]=s_.z,n[10]=l_.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const a=e.elements,n=t.elements,r=this.elements,i=a[0],o=a[4],s=a[8],l=a[12],c=a[1],u=a[5],d=a[9],h=a[13],p=a[2],f=a[6],m=a[10],v=a[14],g=a[3],y=a[7],b=a[11],x=a[15],w=n[0],_=n[4],S=n[8],M=n[12],T=n[1],k=n[5],C=n[9],A=n[13],E=n[2],I=n[6],R=n[10],D=n[14],P=n[3],L=n[7],N=n[11],O=n[15];return r[0]=i*w+o*T+s*E+l*P,r[4]=i*_+o*k+s*I+l*L,r[8]=i*S+o*C+s*R+l*N,r[12]=i*M+o*A+s*D+l*O,r[1]=c*w+u*T+d*E+h*P,r[5]=c*_+u*k+d*I+h*L,r[9]=c*S+u*C+d*R+h*N,r[13]=c*M+u*A+d*D+h*O,r[2]=p*w+f*T+m*E+v*P,r[6]=p*_+f*k+m*I+v*L,r[10]=p*S+f*C+m*R+v*N,r[14]=p*M+f*A+m*D+v*O,r[3]=g*w+y*T+b*E+x*P,r[7]=g*_+y*k+b*I+x*L,r[11]=g*S+y*C+b*R+x*N,r[15]=g*M+y*A+b*D+x*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],a=e[4],n=e[8],r=e[12],i=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],p=e[3],f=e[7],m=e[11],v=e[15],g=s*h-l*d,y=o*h-l*u,b=o*d-s*u,x=i*h-l*c,w=i*d-s*c,_=i*u-o*c;return t*(f*g-m*y+v*b)-a*(p*g-m*x+v*w)+n*(p*y-f*x+v*_)-r*(p*b-f*w+m*_)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,a){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=a),this}invert(){const e=this.elements,t=e[0],a=e[1],n=e[2],r=e[3],i=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],p=e[12],f=e[13],m=e[14],v=e[15],g=u*m*l-f*d*l+f*s*h-o*m*h-u*s*v+o*d*v,y=p*d*l-c*m*l-p*s*h+i*m*h+c*s*v-i*d*v,b=c*f*l-p*u*l+p*o*h-i*f*h-c*o*v+i*u*v,x=p*u*s-c*f*s-p*o*d+i*f*d+c*o*m-i*u*m,w=t*g+a*y+n*b+r*x;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _=1/w;return e[0]=g*_,e[1]=(f*d*r-u*m*r-f*n*h+a*m*h+u*n*v-a*d*v)*_,e[2]=(o*m*r-f*s*r+f*n*l-a*m*l-o*n*v+a*s*v)*_,e[3]=(u*s*r-o*d*r-u*n*l+a*d*l+o*n*h-a*s*h)*_,e[4]=y*_,e[5]=(c*m*r-p*d*r+p*n*h-t*m*h-c*n*v+t*d*v)*_,e[6]=(p*s*r-i*m*r-p*n*l+t*m*l+i*n*v-t*s*v)*_,e[7]=(i*d*r-c*s*r+c*n*l-t*d*l-i*n*h+t*s*h)*_,e[8]=b*_,e[9]=(p*u*r-c*f*r-p*a*h+t*f*h+c*a*v-t*u*v)*_,e[10]=(i*f*r-p*o*r+p*a*l-t*f*l-i*a*v+t*o*v)*_,e[11]=(c*o*r-i*u*r-c*a*l+t*u*l+i*a*h-t*o*h)*_,e[12]=x*_,e[13]=(c*f*n-p*u*n+p*a*d-t*f*d-c*a*m+t*u*m)*_,e[14]=(p*o*n-i*f*n-p*a*s+t*f*s+i*a*m-t*o*m)*_,e[15]=(i*u*n-c*o*n+c*a*s-t*u*s-i*a*d+t*o*d)*_,this}scale(e){const t=this.elements,a=e.x,n=e.y,r=e.z;return t[0]*=a,t[4]*=n,t[8]*=r,t[1]*=a,t[5]*=n,t[9]*=r,t[2]*=a,t[6]*=n,t[10]*=r,t[3]*=a,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],a=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,a,n))}makeTranslation(e,t,a){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,a,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),a=Math.sin(e);return this.set(1,0,0,0,0,t,-a,0,0,a,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),a=Math.sin(e);return this.set(t,0,a,0,0,1,0,0,-a,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),a=Math.sin(e);return this.set(t,-a,0,0,a,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const a=Math.cos(t),n=Math.sin(t),r=1-a,i=e.x,o=e.y,s=e.z,l=r*i,c=r*o;return this.set(l*i+a,l*o-n*s,l*s+n*o,0,l*o+n*s,c*o+a,c*s-n*i,0,l*s-n*o,c*s+n*i,r*s*s+a,0,0,0,0,1),this}makeScale(e,t,a){return this.set(e,0,0,0,0,t,0,0,0,0,a,0,0,0,0,1),this}makeShear(e,t,a,n,r,i){return this.set(1,a,r,0,e,1,i,0,t,n,1,0,0,0,0,1),this}compose(e,t,a){const n=this.elements,r=t._x,i=t._y,o=t._z,s=t._w,l=r+r,c=i+i,u=o+o,d=r*l,h=r*c,p=r*u,f=i*c,m=i*u,v=o*u,g=s*l,y=s*c,b=s*u,x=a.x,w=a.y,_=a.z;return n[0]=(1-(f+v))*x,n[1]=(h+b)*x,n[2]=(p-y)*x,n[3]=0,n[4]=(h-b)*w,n[5]=(1-(d+v))*w,n[6]=(m+g)*w,n[7]=0,n[8]=(p+y)*_,n[9]=(m-g)*_,n[10]=(1-(d+f))*_,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,a){const n=this.elements;if(e.x=n[12],e.y=n[13],e.z=n[14],0===this.determinant())return a.set(1,1,1),t.identity(),this;let r=a_.set(n[0],n[1],n[2]).length();const i=a_.set(n[4],n[5],n[6]).length(),o=a_.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),n_.copy(this);const s=1/r,l=1/i,c=1/o;return n_.elements[0]*=s,n_.elements[1]*=s,n_.elements[2]*=s,n_.elements[4]*=l,n_.elements[5]*=l,n_.elements[6]*=l,n_.elements[8]*=c,n_.elements[9]*=c,n_.elements[10]*=c,t.setFromRotationMatrix(n_),a.x=r,a.y=i,a.z=o,this}makePerspective(e,t,a,n,r,i,o=2e3,s=!1){const l=this.elements,c=2*r/(t-e),u=2*r/(a-n),d=(t+e)/(t-e),h=(a+n)/(a-n);let p,f;if(s)p=r/(i-r),f=i*r/(i-r);else if(o===Ox)p=-(i+r)/(i-r),f=-2*i*r/(i-r);else{if(o!==Fx)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);p=-i/(i-r),f=-i*r/(i-r)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,a,n,r,i,o=2e3,s=!1){const l=this.elements,c=2/(t-e),u=2/(a-n),d=-(t+e)/(t-e),h=-(a+n)/(a-n);let p,f;if(s)p=1/(i-r),f=i/(i-r);else if(o===Ox)p=-2/(i-r),f=-(i+r)/(i-r);else{if(o!==Fx)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=-1/(i-r),f=-r/(i-r)}return l[0]=c,l[4]=0,l[8]=0,l[12]=d,l[1]=0,l[5]=u,l[9]=0,l[13]=h,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,a=e.elements;for(let n=0;n<16;n++)if(t[n]!==a[n])return!1;return!0}fromArray(e,t=0){for(let a=0;a<16;a++)this.elements[a]=e[a+t];return this}toArray(e=[],t=0){const a=this.elements;return e[t]=a[0],e[t+1]=a[1],e[t+2]=a[2],e[t+3]=a[3],e[t+4]=a[4],e[t+5]=a[5],e[t+6]=a[6],e[t+7]=a[7],e[t+8]=a[8],e[t+9]=a[9],e[t+10]=a[10],e[t+11]=a[11],e[t+12]=a[12],e[t+13]=a[13],e[t+14]=a[14],e[t+15]=a[15],e}}const a_=new rw,n_=new t_,r_=new rw(0,0,0),i_=new rw(1,1,1),o_=new rw,s_=new rw,l_=new rw,c_=new t_,u_=new nw;class d_{constructor(e=0,t=0,a=0,n=d_.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=a,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,a,n=this._order){return this._x=e,this._y=t,this._z=a,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,a=!0){const n=e.elements,r=n[0],i=n[4],o=n[8],s=n[1],l=n[5],c=n[9],u=n[2],d=n[6],h=n[10];switch(t){case"XYZ":this._y=Math.asin(Zx(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-i,r)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Zx(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Zx(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-i,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-Zx(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-i,l));break;case"YZX":this._z=Math.asin(Zx(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-Zx(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,h),this._y=0);break;default:Gx("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===a&&this._onChangeCallback(),this}setFromQuaternion(e,t,a){return c_.makeRotationFromQuaternion(e),this.setFromRotationMatrix(c_,t,a)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return u_.setFromEuler(this),this.setFromQuaternion(u_,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}d_.DEFAULT_ORDER="XYZ";class h_{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let p_=0;const f_=new rw,m_=new nw,v_=new t_,g_=new rw,y_=new rw,b_=new rw,x_=new nw,w_=new rw(1,0,0),__=new rw(0,1,0),S_=new rw(0,0,1),M_={type:"added"},T_={type:"removed"},k_={type:"childadded",child:null},C_={type:"childremoved",child:null};class A_ extends Yx{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:p_++}),this.uuid=Kx(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=A_.DEFAULT_UP.clone();const e=new rw,t=new d_,a=new nw,n=new rw(1,1,1);t._onChange(function(){a.setFromEuler(t,!1)}),a._onChange(function(){t.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new t_},normalMatrix:{value:new sw}}),this.matrix=new t_,this.matrixWorld=new t_,this.matrixAutoUpdate=A_.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=A_.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new h_,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return m_.setFromAxisAngle(e,t),this.quaternion.multiply(m_),this}rotateOnWorldAxis(e,t){return m_.setFromAxisAngle(e,t),this.quaternion.premultiply(m_),this}rotateX(e){return this.rotateOnAxis(w_,e)}rotateY(e){return this.rotateOnAxis(__,e)}rotateZ(e){return this.rotateOnAxis(S_,e)}translateOnAxis(e,t){return f_.copy(e).applyQuaternion(this.quaternion),this.position.add(f_.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(w_,e)}translateY(e){return this.translateOnAxis(__,e)}translateZ(e){return this.translateOnAxis(S_,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(v_.copy(this.matrixWorld).invert())}lookAt(e,t,a){e.isVector3?g_.copy(e):g_.set(e,t,a);const n=this.parent;this.updateWorldMatrix(!0,!1),y_.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?v_.lookAt(y_,g_,this.up):v_.lookAt(g_,y_,this.up),this.quaternion.setFromRotationMatrix(v_),n&&(v_.extractRotation(n.matrixWorld),m_.setFromRotationMatrix(v_),this.quaternion.premultiply(m_.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(Wx("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(M_),k_.child=e,this.dispatchEvent(k_),k_.child=null):Wx("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(T_),C_.child=e,this.dispatchEvent(C_),C_.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),v_.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),v_.multiply(e.parent.matrixWorld)),e.applyMatrix4(v_),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(M_),k_.child=e,this.dispatchEvent(k_),k_.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let a=0,n=this.children.length;a<n;a++){const n=this.children[a].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t,a=[]){this[e]===t&&a.push(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].getObjectsByProperty(e,t,a);return a}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(y_,e,b_),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(y_,x_,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let a=0,n=t.length;a<n;a++)t[a].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let a=0,n=t.length;a<n;a++)t[a].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let a=0,n=t.length;a<n;a++){t[a].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const a=this.parent;if(!0===e&&null!==a&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,a=e.length;t<a;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,a={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},a.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const n={};function r(t,a){return void 0===t[a.uuid]&&(t[a.uuid]=a.toJSON(e)),a.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.geometryInfo=this._geometryInfo.map(e=>({...e,boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),n.instanceInfo=this._instanceInfo.map(e=>({...e})),n.availableInstanceIds=this._availableInstanceIds.slice(),n.availableGeometryIds=this._availableGeometryIds.slice(),n.nextIndexStart=this._nextIndexStart,n.nextVertexStart=this._nextVertexStart,n.geometryCount=this._geometryCount,n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.matricesTexture=this._matricesTexture.toJSON(e),n.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(n.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(n.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(n.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const a=t.shapes;if(Array.isArray(a))for(let t=0,n=a.length;t<n;t++){const n=a[t];r(e.shapes,n)}else r(e.shapes,a)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let a=0,n=this.material.length;a<n;a++)t.push(r(e.materials,this.material[a]));n.material=t}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){const a=this.animations[t];n.animations.push(r(e.animations,a))}}if(t){const t=i(e.geometries),n=i(e.materials),r=i(e.textures),o=i(e.images),s=i(e.shapes),l=i(e.skeletons),c=i(e.animations),u=i(e.nodes);t.length>0&&(a.geometries=t),n.length>0&&(a.materials=n),r.length>0&&(a.textures=r),o.length>0&&(a.images=o),s.length>0&&(a.shapes=s),l.length>0&&(a.skeletons=l),c.length>0&&(a.animations=c),u.length>0&&(a.nodes=u)}return a.object=n,a;function i(e){const t=[];for(const a in e){const n=e[a];delete n.metadata,t.push(n)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let a=0;a<e.children.length;a++){const t=e.children[a];this.add(t.clone())}return this}}A_.DEFAULT_UP=new rw(0,1,0),A_.DEFAULT_MATRIX_AUTO_UPDATE=!0,A_.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const E_=new rw,I_=new rw,R_=new rw,D_=new rw,P_=new rw,L_=new rw,N_=new rw,O_=new rw,F_=new rw,B_=new rw,U_=new Sw,z_=new Sw,V_=new Sw;let H_=class e{constructor(e=new rw,t=new rw,a=new rw){this.a=e,this.b=t,this.c=a}static getNormal(e,t,a,n){n.subVectors(a,t),E_.subVectors(e,t),n.cross(E_);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,a,n,r){E_.subVectors(n,t),I_.subVectors(a,t),R_.subVectors(e,t);const i=E_.dot(E_),o=E_.dot(I_),s=E_.dot(R_),l=I_.dot(I_),c=I_.dot(R_),u=i*l-o*o;if(0===u)return r.set(0,0,0),null;const d=1/u,h=(l*s-o*c)*d,p=(i*c-o*s)*d;return r.set(1-h-p,p,h)}static containsPoint(e,t,a,n){return null!==this.getBarycoord(e,t,a,n,D_)&&(D_.x>=0&&D_.y>=0&&D_.x+D_.y<=1)}static getInterpolation(e,t,a,n,r,i,o,s){return null===this.getBarycoord(e,t,a,n,D_)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(r,D_.x),s.addScaledVector(i,D_.y),s.addScaledVector(o,D_.z),s)}static getInterpolatedAttribute(e,t,a,n,r,i){return U_.setScalar(0),z_.setScalar(0),V_.setScalar(0),U_.fromBufferAttribute(e,t),z_.fromBufferAttribute(e,a),V_.fromBufferAttribute(e,n),i.setScalar(0),i.addScaledVector(U_,r.x),i.addScaledVector(z_,r.y),i.addScaledVector(V_,r.z),i}static isFrontFacing(e,t,a,n){return E_.subVectors(a,t),I_.subVectors(e,t),E_.cross(I_).dot(n)<0}set(e,t,a){return this.a.copy(e),this.b.copy(t),this.c.copy(a),this}setFromPointsAndIndices(e,t,a,n){return this.a.copy(e[t]),this.b.copy(e[a]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,a,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,a),this.c.fromBufferAttribute(e,n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return E_.subVectors(this.c,this.b),I_.subVectors(this.a,this.b),.5*E_.cross(I_).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return e.getNormal(this.a,this.b,this.c,t)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,a){return e.getBarycoord(t,this.a,this.b,this.c,a)}getInterpolation(t,a,n,r,i){return e.getInterpolation(t,this.a,this.b,this.c,a,n,r,i)}containsPoint(t){return e.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return e.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const a=this.a,n=this.b,r=this.c;let i,o;P_.subVectors(n,a),L_.subVectors(r,a),O_.subVectors(e,a);const s=P_.dot(O_),l=L_.dot(O_);if(s<=0&&l<=0)return t.copy(a);F_.subVectors(e,n);const c=P_.dot(F_),u=L_.dot(F_);if(c>=0&&u<=c)return t.copy(n);const d=s*u-c*l;if(d<=0&&s>=0&&c<=0)return i=s/(s-c),t.copy(a).addScaledVector(P_,i);B_.subVectors(e,r);const h=P_.dot(B_),p=L_.dot(B_);if(p>=0&&h<=p)return t.copy(r);const f=h*l-s*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(a).addScaledVector(L_,o);const m=c*p-h*u;if(m<=0&&u-c>=0&&h-p>=0)return N_.subVectors(r,n),o=(u-c)/(u-c+(h-p)),t.copy(n).addScaledVector(N_,o);const v=1/(m+f+d);return i=f*v,o=d*v,t.copy(a).addScaledVector(P_,i).addScaledVector(L_,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const G_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},W_={h:0,s:0,l:0},q_={h:0,s:0,l:0};function Y_(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+6*(t-e)*(2/3-a):e}class j_{constructor(e,t,a){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,a)}set(e,t,a){if(void 0===t&&void 0===a){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,a);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=xx){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,hw.colorSpaceToWorking(this,t),this}setRGB(e,t,a,n=hw.workingColorSpace){return this.r=e,this.g=t,this.b=a,hw.colorSpaceToWorking(this,n),this}setHSL(e,t,a,n=hw.workingColorSpace){if(e=function(e,t){return(e%t+t)%t}(e,1),t=Zx(t,0,1),a=Zx(a,0,1),0===t)this.r=this.g=this.b=a;else{const n=a<=.5?a*(1+t):a+t-a*t,r=2*a-n;this.r=Y_(r,n,e+1/3),this.g=Y_(r,n,e),this.b=Y_(r,n,e-1/3)}return hw.colorSpaceToWorking(this,n),this}setStyle(e,t=xx){function a(t){void 0!==t&&parseFloat(t)<1&&Gx("Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return a(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return a(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return a(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:Gx("Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=n[1],r=a.length;if(3===r)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(6===r)return this.setHex(parseInt(a,16),t);Gx("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=xx){const a=G_[e.toLowerCase()];return void 0!==a?this.setHex(a,t):Gx("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=pw(e.r),this.g=pw(e.g),this.b=pw(e.b),this}copyLinearToSRGB(e){return this.r=fw(e.r),this.g=fw(e.g),this.b=fw(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=xx){return hw.workingToColorSpace(X_.copy(this),e),65536*Math.round(Zx(255*X_.r,0,255))+256*Math.round(Zx(255*X_.g,0,255))+Math.round(Zx(255*X_.b,0,255))}getHexString(e=xx){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hw.workingColorSpace){hw.workingToColorSpace(X_.copy(this),t);const a=X_.r,n=X_.g,r=X_.b,i=Math.max(a,n,r),o=Math.min(a,n,r);let s,l;const c=(o+i)/2;if(o===i)s=0,l=0;else{const e=i-o;switch(l=c<=.5?e/(i+o):e/(2-i-o),i){case a:s=(n-r)/e+(n<r?6:0);break;case n:s=(r-a)/e+2;break;case r:s=(a-n)/e+4}s/=6}return e.h=s,e.s=l,e.l=c,e}getRGB(e,t=hw.workingColorSpace){return hw.workingToColorSpace(X_.copy(this),t),e.r=X_.r,e.g=X_.g,e.b=X_.b,e}getStyle(e=xx){hw.workingToColorSpace(X_.copy(this),e);const t=X_.r,a=X_.g,n=X_.b;return e!==xx?`color(${e} ${t.toFixed(3)} ${a.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*a)},${Math.round(255*n)})`}offsetHSL(e,t,a){return this.getHSL(W_),this.setHSL(W_.h+e,W_.s+t,W_.l+a)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,a){return this.r=e.r+(t.r-e.r)*a,this.g=e.g+(t.g-e.g)*a,this.b=e.b+(t.b-e.b)*a,this}lerpHSL(e,t){this.getHSL(W_),e.getHSL(q_);const a=Jx(W_.h,q_.h,t),n=Jx(W_.s,q_.s,t),r=Jx(W_.l,q_.l,t);return this.setHSL(a,n,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,a=this.g,n=this.b,r=e.elements;return this.r=r[0]*t+r[3]*a+r[6]*n,this.g=r[1]*t+r[4]*a+r[7]*n,this.b=r[2]*t+r[5]*a+r[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const X_=new j_;j_.NAMES=G_;let $_=0;class K_ extends Yx{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:$_++}),this.uuid=Kx(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Sy,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new j_(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Tx,this.stencilZFail=Tx,this.stencilZPass=Tx,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const a=e[t];if(void 0===a){Gx(`Material: parameter '${t}' has value of undefined.`);continue}const n=this[t];void 0!==n?n&&n.isColor?n.set(a):n&&n.isVector3&&a&&a.isVector3?n.copy(a):this[t]=a:Gx(`Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const a={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function n(e){const t=[];for(const a in e){const n=e[a];delete n.metadata,t.push(n)}return t}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),void 0!==this.roughness&&(a.roughness=this.roughness),void 0!==this.metalness&&(a.metalness=this.metalness),void 0!==this.sheen&&(a.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(a.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(a.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(a.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(a.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(a.shininess=this.shininess),void 0!==this.clearcoat&&(a.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(a.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(a.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(a.dispersion=this.dispersion),void 0!==this.iridescence&&(a.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(a.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(a.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(a.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(a.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(a.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(a.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(a.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(e).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(e).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(e).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(e).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(e).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(a.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(a.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(a.combine=this.combine)),void 0!==this.envMapRotation&&(a.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(a.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(a.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(a.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(a.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(a.size=this.size),null!==this.shadowSide&&(a.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(a.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(a.blending=this.blending),0!==this.side&&(a.side=this.side),!0===this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),!0===this.transparent&&(a.transparent=!0),204!==this.blendSrc&&(a.blendSrc=this.blendSrc),205!==this.blendDst&&(a.blendDst=this.blendDst),this.blendEquation!==Sy&&(a.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(a.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(a.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(a.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(a.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(a.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(a.depthFunc=this.depthFunc),!1===this.depthTest&&(a.depthTest=this.depthTest),!1===this.depthWrite&&(a.depthWrite=this.depthWrite),!1===this.colorWrite&&(a.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(a.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(a.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(a.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(a.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Tx&&(a.stencilFail=this.stencilFail),this.stencilZFail!==Tx&&(a.stencilZFail=this.stencilZFail),this.stencilZPass!==Tx&&(a.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(a.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(a.rotation=this.rotation),!0===this.polygonOffset&&(a.polygonOffset=!0),0!==this.polygonOffsetFactor&&(a.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(a.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(a.linewidth=this.linewidth),void 0!==this.dashSize&&(a.dashSize=this.dashSize),void 0!==this.gapSize&&(a.gapSize=this.gapSize),void 0!==this.scale&&(a.scale=this.scale),!0===this.dithering&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),!0===this.alphaHash&&(a.alphaHash=!0),!0===this.alphaToCoverage&&(a.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(a.premultipliedAlpha=!0),!0===this.forceSinglePass&&(a.forceSinglePass=!0),!1===this.allowOverride&&(a.allowOverride=!1),!0===this.wireframe&&(a.wireframe=!0),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(a.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(a.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(a.flatShading=!0),!1===this.visible&&(a.visible=!1),!1===this.toneMapped&&(a.toneMapped=!1),!1===this.fog&&(a.fog=!1),Object.keys(this.userData).length>0&&(a.userData=this.userData),t){const t=n(e.textures),r=n(e.images);t.length>0&&(a.textures=t),r.length>0&&(a.images=r)}return a}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let a=null;if(null!==t){const e=t.length;a=new Array(e);for(let n=0;n!==e;++n)a[n]=t[n].clone()}return this.clippingPlanes=a,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Z_ extends K_{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new j_(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new d_,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const J_=new rw,Q_=new aw;let eS=0;class tS{constructor(e,t,a=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:eS++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=a,this.usage=Lx,this.updateRanges=[],this.gpuType=Sb,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,a){e*=this.itemSize,a*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[a+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,a=this.count;t<a;t++)Q_.fromBufferAttribute(this,t),Q_.applyMatrix3(e),this.setXY(t,Q_.x,Q_.y);else if(3===this.itemSize)for(let t=0,a=this.count;t<a;t++)J_.fromBufferAttribute(this,t),J_.applyMatrix3(e),this.setXYZ(t,J_.x,J_.y,J_.z);return this}applyMatrix4(e){for(let t=0,a=this.count;t<a;t++)J_.fromBufferAttribute(this,t),J_.applyMatrix4(e),this.setXYZ(t,J_.x,J_.y,J_.z);return this}applyNormalMatrix(e){for(let t=0,a=this.count;t<a;t++)J_.fromBufferAttribute(this,t),J_.applyNormalMatrix(e),this.setXYZ(t,J_.x,J_.y,J_.z);return this}transformDirection(e){for(let t=0,a=this.count;t<a;t++)J_.fromBufferAttribute(this,t),J_.transformDirection(e),this.setXYZ(t,J_.x,J_.y,J_.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let a=this.array[e*this.itemSize+t];return this.normalized&&(a=Qx(a,this.array)),a}setComponent(e,t,a){return this.normalized&&(a=ew(a,this.array)),this.array[e*this.itemSize+t]=a,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qx(t,this.array)),t}setX(e,t){return this.normalized&&(t=ew(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qx(t,this.array)),t}setY(e,t){return this.normalized&&(t=ew(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qx(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ew(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qx(t,this.array)),t}setW(e,t){return this.normalized&&(t=ew(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,a){return e*=this.itemSize,this.normalized&&(t=ew(t,this.array),a=ew(a,this.array)),this.array[e+0]=t,this.array[e+1]=a,this}setXYZ(e,t,a,n){return e*=this.itemSize,this.normalized&&(t=ew(t,this.array),a=ew(a,this.array),n=ew(n,this.array)),this.array[e+0]=t,this.array[e+1]=a,this.array[e+2]=n,this}setXYZW(e,t,a,n,r){return e*=this.itemSize,this.normalized&&(t=ew(t,this.array),a=ew(a,this.array),n=ew(n,this.array),r=ew(r,this.array)),this.array[e+0]=t,this.array[e+1]=a,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Lx&&(e.usage=this.usage),e}}class aS extends tS{constructor(e,t,a){super(new Uint16Array(e),t,a)}}class nS extends tS{constructor(e,t,a){super(new Uint32Array(e),t,a)}}class rS extends tS{constructor(e,t,a){super(new Float32Array(e),t,a)}}let iS=0;const oS=new t_,sS=new A_,lS=new rw,cS=new Aw,uS=new Aw,dS=new rw;class hS extends Yx{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:iS++}),this.uuid=Kx(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Bx(e)?nS:aS)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,a=0){this.groups.push({start:e,count:t,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const a=this.attributes.normal;if(void 0!==a){const t=(new sw).getNormalMatrix(e);a.applyNormalMatrix(t),a.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return oS.makeRotationFromQuaternion(e),this.applyMatrix4(oS),this}rotateX(e){return oS.makeRotationX(e),this.applyMatrix4(oS),this}rotateY(e){return oS.makeRotationY(e),this.applyMatrix4(oS),this}rotateZ(e){return oS.makeRotationZ(e),this.applyMatrix4(oS),this}translate(e,t,a){return oS.makeTranslation(e,t,a),this.applyMatrix4(oS),this}scale(e,t,a){return oS.makeScale(e,t,a),this.applyMatrix4(oS),this}lookAt(e){return sS.lookAt(e),sS.updateMatrix(),this.applyMatrix4(sS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lS).negate(),this.translate(lS.x,lS.y,lS.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let a=0,n=e.length;a<n;a++){const n=e[a];t.push(n.x,n.y,n.z||0)}this.setAttribute("position",new rS(t,3))}else{const a=Math.min(e.length,t.count);for(let n=0;n<a;n++){const a=e[n];t.setXYZ(n,a.x,a.y,a.z||0)}e.length>t.count&&Gx("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Aw);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return Wx("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new rw(-1/0,-1/0,-1/0),new rw(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let a=0,n=t.length;a<n;a++){const e=t[a];cS.setFromBufferAttribute(e),this.morphTargetsRelative?(dS.addVectors(this.boundingBox.min,cS.min),this.boundingBox.expandByPoint(dS),dS.addVectors(this.boundingBox.max,cS.max),this.boundingBox.expandByPoint(dS)):(this.boundingBox.expandByPoint(cS.min),this.boundingBox.expandByPoint(cS.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Wx('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Yw);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return Wx("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new rw,1/0);if(e){const a=this.boundingSphere.center;if(cS.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const a=t[e];uS.setFromBufferAttribute(a),this.morphTargetsRelative?(dS.addVectors(cS.min,uS.min),cS.expandByPoint(dS),dS.addVectors(cS.max,uS.max),cS.expandByPoint(dS)):(cS.expandByPoint(uS.min),cS.expandByPoint(uS.max))}cS.getCenter(a);let n=0;for(let t=0,r=e.count;t<r;t++)dS.fromBufferAttribute(e,t),n=Math.max(n,a.distanceToSquared(dS));if(t)for(let r=0,i=t.length;r<i;r++){const i=t[r],o=this.morphTargetsRelative;for(let t=0,r=i.count;t<r;t++)dS.fromBufferAttribute(i,t),o&&(lS.fromBufferAttribute(e,t),dS.add(lS)),n=Math.max(n,a.distanceToSquared(dS))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&Wx('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void Wx("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const a=t.position,n=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new tS(new Float32Array(4*a.count),4));const i=this.getAttribute("tangent"),o=[],s=[];for(let S=0;S<a.count;S++)o[S]=new rw,s[S]=new rw;const l=new rw,c=new rw,u=new rw,d=new aw,h=new aw,p=new aw,f=new rw,m=new rw;function v(e,t,n){l.fromBufferAttribute(a,e),c.fromBufferAttribute(a,t),u.fromBufferAttribute(a,n),d.fromBufferAttribute(r,e),h.fromBufferAttribute(r,t),p.fromBufferAttribute(r,n),c.sub(l),u.sub(l),h.sub(d),p.sub(d);const i=1/(h.x*p.y-p.x*h.y);isFinite(i)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(u,-h.y).multiplyScalar(i),m.copy(u).multiplyScalar(h.x).addScaledVector(c,-p.x).multiplyScalar(i),o[e].add(f),o[t].add(f),o[n].add(f),s[e].add(m),s[t].add(m),s[n].add(m))}let g=this.groups;0===g.length&&(g=[{start:0,count:e.count}]);for(let S=0,M=g.length;S<M;++S){const t=g[S],a=t.start;for(let n=a,r=a+t.count;n<r;n+=3)v(e.getX(n+0),e.getX(n+1),e.getX(n+2))}const y=new rw,b=new rw,x=new rw,w=new rw;function _(e){x.fromBufferAttribute(n,e),w.copy(x);const t=o[e];y.copy(t),y.sub(x.multiplyScalar(x.dot(t))).normalize(),b.crossVectors(w,t);const a=b.dot(s[e])<0?-1:1;i.setXYZW(e,y.x,y.y,y.z,a)}for(let S=0,M=g.length;S<M;++S){const t=g[S],a=t.start;for(let n=a,r=a+t.count;n<r;n+=3)_(e.getX(n+0)),_(e.getX(n+1)),_(e.getX(n+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let a=this.getAttribute("normal");if(void 0===a)a=new tS(new Float32Array(3*t.count),3),this.setAttribute("normal",a);else for(let e=0,t=a.count;e<t;e++)a.setXYZ(e,0,0,0);const n=new rw,r=new rw,i=new rw,o=new rw,s=new rw,l=new rw,c=new rw,u=new rw;if(e)for(let d=0,h=e.count;d<h;d+=3){const h=e.getX(d+0),p=e.getX(d+1),f=e.getX(d+2);n.fromBufferAttribute(t,h),r.fromBufferAttribute(t,p),i.fromBufferAttribute(t,f),c.subVectors(i,r),u.subVectors(n,r),c.cross(u),o.fromBufferAttribute(a,h),s.fromBufferAttribute(a,p),l.fromBufferAttribute(a,f),o.add(c),s.add(c),l.add(c),a.setXYZ(h,o.x,o.y,o.z),a.setXYZ(p,s.x,s.y,s.z),a.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,d=t.count;e<d;e+=3)n.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),i.fromBufferAttribute(t,e+2),c.subVectors(i,r),u.subVectors(n,r),c.cross(u),a.setXYZ(e+0,c.x,c.y,c.z),a.setXYZ(e+1,c.x,c.y,c.z),a.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),a.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,a=e.count;t<a;t++)dS.fromBufferAttribute(e,t),dS.normalize(),e.setXYZ(t,dS.x,dS.y,dS.z)}toNonIndexed(){function e(e,t){const a=e.array,n=e.itemSize,r=e.normalized,i=new a.constructor(t.length*n);let o=0,s=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*n;for(let e=0;e<n;e++)i[s++]=a[o++]}return new tS(i,n,r)}if(null===this.index)return Gx("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new hS,a=this.index.array,n=this.attributes;for(const o in n){const r=e(n[o],a);t.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const n=[],i=r[o];for(let t=0,r=i.length;t<r;t++){const r=e(i[t],a);n.push(r)}t.morphAttributes[o]=n}t.morphTargetsRelative=this.morphTargetsRelative;const i=this.groups;for(let o=0,s=i.length;o<s;o++){const e=i[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const a in t)void 0!==t[a]&&(e[a]=t[a]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const a=this.attributes;for(const s in a){const t=a[s];e.data.attributes[s]=t.toJSON(e.data)}const n={};let r=!1;for(const s in this.morphAttributes){const t=this.morphAttributes[s],a=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];a.push(r.toJSON(e.data))}a.length>0&&(n[s]=a,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const i=this.groups;i.length>0&&(e.data.groups=JSON.parse(JSON.stringify(i)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere=o.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const a=e.index;null!==a&&this.setIndex(a.clone());const n=e.attributes;for(const l in n){const e=n[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],a=r[l];for(let n=0,r=a.length;n<r;n++)e.push(a[n].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const i=e.groups;for(let l=0,c=i.length;l<c;l++){const e=i[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const pS=new t_,fS=new e_,mS=new Yw,vS=new rw,gS=new rw,yS=new rw,bS=new rw,xS=new rw,wS=new rw,_S=new rw,SS=new rw;class MS extends A_{constructor(e=new hS,t=new Z_){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const a=e[t[0]];if(void 0!==a){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=a.length;e<t;e++){const t=a[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const a=this.geometry,n=a.attributes.position,r=a.morphAttributes.position,i=a.morphTargetsRelative;t.fromBufferAttribute(n,e);const o=this.morphTargetInfluences;if(r&&o){wS.set(0,0,0);for(let a=0,n=r.length;a<n;a++){const n=o[a],s=r[a];0!==n&&(xS.fromBufferAttribute(s,e),i?wS.addScaledVector(xS,n):wS.addScaledVector(xS.sub(t),n))}t.add(wS)}return t}raycast(e,t){const a=this.geometry,n=this.material,r=this.matrixWorld;if(void 0!==n){if(null===a.boundingSphere&&a.computeBoundingSphere(),mS.copy(a.boundingSphere),mS.applyMatrix4(r),fS.copy(e.ray).recast(e.near),!1===mS.containsPoint(fS.origin)){if(null===fS.intersectSphere(mS,vS))return;if(fS.origin.distanceToSquared(vS)>(e.far-e.near)**2)return}pS.copy(r).invert(),fS.copy(e.ray).applyMatrix4(pS),null!==a.boundingBox&&!1===fS.intersectsBox(a.boundingBox)||this._computeIntersections(e,t,fS)}}_computeIntersections(e,t,a){let n;const r=this.geometry,i=this.material,o=r.index,s=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,d=r.groups,h=r.drawRange;if(null!==o)if(Array.isArray(i))for(let p=0,f=d.length;p<f;p++){const r=d[p],s=i[r.materialIndex];for(let i=Math.max(r.start,h.start),d=Math.min(o.count,Math.min(r.start+r.count,h.start+h.count));i<d;i+=3){n=TS(this,s,e,a,l,c,u,o.getX(i),o.getX(i+1),o.getX(i+2)),n&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=r.materialIndex,t.push(n))}}else{for(let r=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);r<s;r+=3){n=TS(this,i,e,a,l,c,u,o.getX(r),o.getX(r+1),o.getX(r+2)),n&&(n.faceIndex=Math.floor(r/3),t.push(n))}}else if(void 0!==s)if(Array.isArray(i))for(let p=0,f=d.length;p<f;p++){const r=d[p],o=i[r.materialIndex];for(let i=Math.max(r.start,h.start),d=Math.min(s.count,Math.min(r.start+r.count,h.start+h.count));i<d;i+=3){n=TS(this,o,e,a,l,c,u,i,i+1,i+2),n&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=r.materialIndex,t.push(n))}}else{for(let r=Math.max(0,h.start),o=Math.min(s.count,h.start+h.count);r<o;r+=3){n=TS(this,i,e,a,l,c,u,r,r+1,r+2),n&&(n.faceIndex=Math.floor(r/3),t.push(n))}}}}function TS(e,t,a,n,r,i,o,s,l,c){e.getVertexPosition(s,gS),e.getVertexPosition(l,yS),e.getVertexPosition(c,bS);const u=function(e,t,a,n,r,i,o,s){let l;if(l=1===t.side?n.intersectTriangle(o,i,r,!0,s):n.intersectTriangle(r,i,o,0===t.side,s),null===l)return null;SS.copy(s),SS.applyMatrix4(e.matrixWorld);const c=a.ray.origin.distanceTo(SS);return c<a.near||c>a.far?null:{distance:c,point:SS.clone(),object:e}}(e,t,a,n,gS,yS,bS,_S);if(u){const e=new rw;H_.getBarycoord(_S,gS,yS,bS,e),r&&(u.uv=H_.getInterpolatedAttribute(r,s,l,c,e,new aw)),i&&(u.uv1=H_.getInterpolatedAttribute(i,s,l,c,e,new aw)),o&&(u.normal=H_.getInterpolatedAttribute(o,s,l,c,e,new rw),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));const t={a:s,b:l,c:c,normal:new rw,materialIndex:0};H_.getNormal(gS,yS,bS,t.normal),u.face=t,u.barycoord=e}return u}class kS extends hS{constructor(e=1,t=1,a=1,n=1,r=1,i=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:a,widthSegments:n,heightSegments:r,depthSegments:i};const o=this;n=Math.floor(n),r=Math.floor(r),i=Math.floor(i);const s=[],l=[],c=[],u=[];let d=0,h=0;function p(e,t,a,n,r,i,p,f,m,v,g){const y=i/m,b=p/v,x=i/2,w=p/2,_=f/2,S=m+1,M=v+1;let T=0,k=0;const C=new rw;for(let o=0;o<M;o++){const i=o*b-w;for(let s=0;s<S;s++){const d=s*y-x;C[e]=d*n,C[t]=i*r,C[a]=_,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[a]=f>0?1:-1,c.push(C.x,C.y,C.z),u.push(s/m),u.push(1-o/v),T+=1}}for(let o=0;o<v;o++)for(let e=0;e<m;e++){const t=d+e+S*o,a=d+e+S*(o+1),n=d+(e+1)+S*(o+1),r=d+(e+1)+S*o;s.push(t,a,r),s.push(a,n,r),k+=6}o.addGroup(h,k,g),h+=k,d+=T}p("z","y","x",-1,-1,a,t,e,i,r,0),p("z","y","x",1,-1,a,t,-e,i,r,1),p("x","z","y",1,1,e,a,t,n,i,2),p("x","z","y",1,-1,e,a,-t,n,i,3),p("x","y","z",1,-1,e,t,a,n,r,4),p("x","y","z",-1,-1,e,t,-a,n,r,5),this.setIndex(s),this.setAttribute("position",new rS(l,3)),this.setAttribute("normal",new rS(c,3)),this.setAttribute("uv",new rS(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kS(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function CS(e){const t={};for(const a in e){t[a]={};for(const n in e[a]){const r=e[a][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Gx("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[a][n]=null):t[a][n]=r.clone():Array.isArray(r)?t[a][n]=r.slice():t[a][n]=r}}return t}function AS(e){const t={};for(let a=0;a<e.length;a++){const n=CS(e[a]);for(const e in n)t[e]=n[e]}return t}function ES(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:hw.workingColorSpace}const IS={clone:CS,merge:AS};class RS extends K_{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=CS(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let a=0;a<e.length;a++)t.push(e[a].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const a=this.uniforms[n].value;a&&a.isTexture?t.uniforms[n]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[n]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[n]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[n]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[n]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[n]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[n]={type:"m4",value:a.toArray()}:t.uniforms[n]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const a={};for(const n in this.extensions)!0===this.extensions[n]&&(a[n]=!0);return Object.keys(a).length>0&&(t.extensions=a),t}}class DS extends A_{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new t_,this.projectionMatrix=new t_,this.projectionMatrixInverse=new t_,this.coordinateSystem=Ox,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const PS=new rw,LS=new aw,NS=new aw;class OS extends DS{constructor(e=50,t=1,a=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=a,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*$x*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Xx*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*$x*Math.atan(Math.tan(.5*Xx*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,a){PS.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(PS.x,PS.y).multiplyScalar(-e/PS.z),PS.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),a.set(PS.x,PS.y).multiplyScalar(-e/PS.z)}getViewSize(e,t){return this.getViewBounds(e,LS,NS),t.subVectors(NS,LS)}setViewOffset(e,t,a,n,r,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=a,this.view.offsetY=n,this.view.width=r,this.view.height=i,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Xx*this.fov)/this.zoom,a=2*t,n=this.aspect*a,r=-.5*n;const i=this.view;if(null!==this.view&&this.view.enabled){const e=i.fullWidth,o=i.fullHeight;r+=i.offsetX*n/e,t-=i.offsetY*a/o,n*=i.width/e,a*=i.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-a,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const FS=-90;class BS extends A_{constructor(e,t,a){super(),this.type="CubeCamera",this.renderTarget=a,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new OS(FS,1,e,t);n.layers=this.layers,this.add(n);const r=new OS(FS,1,e,t);r.layers=this.layers,this.add(r);const i=new OS(FS,1,e,t);i.layers=this.layers,this.add(i);const o=new OS(FS,1,e,t);o.layers=this.layers,this.add(o);const s=new OS(FS,1,e,t);s.layers=this.layers,this.add(s);const l=new OS(FS,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[a,n,r,i,o,s]=t;for(const l of t)this.remove(l);if(e===Ox)a.up.set(0,1,0),a.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),i.up.set(0,0,1),i.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else{if(e!==Fx)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);a.up.set(0,-1,0),a.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),i.up.set(0,0,-1),i.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:a,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,i,o,s,l,c]=this.children,u=e.getRenderTarget(),d=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const f=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,e.setRenderTarget(a,0,n),e.render(t,r),e.setRenderTarget(a,1,n),e.render(t,i),e.setRenderTarget(a,2,n),e.render(t,o),e.setRenderTarget(a,3,n),e.render(t,s),e.setRenderTarget(a,4,n),e.render(t,l),a.texture.generateMipmaps=f,e.setRenderTarget(a,5,n),e.render(t,c),e.setRenderTarget(u,d,h),e.xr.enabled=p,a.texture.needsPMREMUpdate=!0}}class US extends _w{constructor(e=[],t=301,a,n,r,i,o,s,l,c){super(e,t,a,n,r,i,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class zS extends Tw{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const a={width:e,height:e,depth:1},n=[a,a,a,a,a,a];this.texture=new US(n),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const a={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new kS(5,5,5),r=new RS({name:"CubemapFromEquirect",uniforms:CS(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=t;const i=new MS(n,r),o=t.minFilter;t.minFilter===vb&&(t.minFilter=fb);return new BS(1,10,this).update(e,i),t.minFilter=o,i.geometry.dispose(),i.material.dispose(),this}clear(e,t=!0,a=!0,n=!0){const r=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,a,n);e.setRenderTarget(r)}}let VS=class extends A_{constructor(){super(),this.isGroup=!0,this.type="Group"}};const HS={type:"move"};class GS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new VS,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new VS,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new rw,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new rw),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new VS,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new rw,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new rw),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const a of e.hand.values())this._getHandJoint(t,a)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,a){let n=null,r=null,i=null;const o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){i=!0;for(const i of e.hand.values()){const e=t.getJointPose(i,a),n=this._getHandJoint(l,i);null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.matrixWorldNeedsUpdate=!0,n.jointRadius=e.radius),n.visible=null!==e}const n=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=n.position.distanceTo(r.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(r=t.getPose(e.gripSpace,a),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1));null!==o&&(n=t.getPose(e.targetRaySpace,a),null===n&&null!==r&&(n=r),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(HS)))}return null!==o&&(o.visible=null!==n),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==i),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const a=new VS;a.matrixAutoUpdate=!1,a.visible=!1,e.joints[t.jointName]=a,e.add(a)}return e.joints[t.jointName]}}class WS{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new j_(e),this.density=t}clone(){return new WS(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class qS extends A_{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new d_,this.environmentIntensity=1,this.environmentRotation=new d_,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class YS{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Lx,this.updateRanges=[],this.version=0,this.uuid=Kx()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,a){e*=this.stride,a*=t.stride;for(let n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[a+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Kx()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(t,this.stride);return a.setUsage(this.usage),a}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Kx()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const jS=new rw;class XS{constructor(e,t,a,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=a,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,a=this.data.count;t<a;t++)jS.fromBufferAttribute(this,t),jS.applyMatrix4(e),this.setXYZ(t,jS.x,jS.y,jS.z);return this}applyNormalMatrix(e){for(let t=0,a=this.count;t<a;t++)jS.fromBufferAttribute(this,t),jS.applyNormalMatrix(e),this.setXYZ(t,jS.x,jS.y,jS.z);return this}transformDirection(e){for(let t=0,a=this.count;t<a;t++)jS.fromBufferAttribute(this,t),jS.transformDirection(e),this.setXYZ(t,jS.x,jS.y,jS.z);return this}getComponent(e,t){let a=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(a=Qx(a,this.array)),a}setComponent(e,t,a){return this.normalized&&(a=ew(a,this.array)),this.data.array[e*this.data.stride+this.offset+t]=a,this}setX(e,t){return this.normalized&&(t=ew(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ew(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ew(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ew(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Qx(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Qx(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Qx(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Qx(t,this.array)),t}setXY(e,t,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=ew(t,this.array),a=ew(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=a,this}setXYZ(e,t,a,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ew(t,this.array),a=ew(a,this.array),n=ew(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=a,this.data.array[e+2]=n,this}setXYZW(e,t,a,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ew(t,this.array),a=ew(a,this.array),n=ew(n,this.array),r=ew(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=a,this.data.array[e+2]=n,this.data.array[e+3]=r,this}clone(e){if(void 0===e){Hx("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const a=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[a+t])}return new tS(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new XS(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){Hx("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const a=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[a+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class $S extends K_{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new j_(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let KS;const ZS=new rw,JS=new rw,QS=new rw,eM=new aw,tM=new aw,aM=new t_,nM=new rw,rM=new rw,iM=new rw,oM=new aw,sM=new aw,lM=new aw;class cM extends A_{constructor(e=new $S){if(super(),this.isSprite=!0,this.type="Sprite",void 0===KS){KS=new hS;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new YS(e,5);KS.setIndex([0,1,2,0,2,3]),KS.setAttribute("position",new XS(t,3,0,!1)),KS.setAttribute("uv",new XS(t,2,3,!1))}this.geometry=KS,this.material=e,this.center=new aw(.5,.5),this.count=1}raycast(e,t){null===e.camera&&Wx('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),JS.setFromMatrixScale(this.matrixWorld),aM.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),QS.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&JS.multiplyScalar(-QS.z);const a=this.material.rotation;let n,r;0!==a&&(r=Math.cos(a),n=Math.sin(a));const i=this.center;uM(nM.set(-.5,-.5,0),QS,i,JS,n,r),uM(rM.set(.5,-.5,0),QS,i,JS,n,r),uM(iM.set(.5,.5,0),QS,i,JS,n,r),oM.set(0,0),sM.set(1,0),lM.set(1,1);let o=e.ray.intersectTriangle(nM,rM,iM,!1,ZS);if(null===o&&(uM(rM.set(-.5,.5,0),QS,i,JS,n,r),sM.set(0,1),o=e.ray.intersectTriangle(nM,iM,rM,!1,ZS),null===o))return;const s=e.ray.origin.distanceTo(ZS);s<e.near||s>e.far||t.push({distance:s,point:ZS.clone(),uv:H_.getInterpolation(ZS,nM,rM,iM,oM,sM,lM,new aw),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function uM(e,t,a,n,r,i){eM.subVectors(e,a).addScalar(.5).multiply(n),void 0!==r?(tM.x=i*eM.x-r*eM.y,tM.y=r*eM.x+i*eM.y):tM.copy(eM),e.copy(t),e.x+=tM.x,e.y+=tM.y,e.applyMatrix4(aM)}class dM extends _w{constructor(e=null,t=1,a=1,n,r,i,o,s,l=1003,c=1003,u,d){super(null,i,o,s,l,c,n,r,u,d),this.isDataTexture=!0,this.image={data:e,width:t,height:a},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const hM=new rw,pM=new rw,fM=new sw;class mM{constructor(e=new rw(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,a,n){return this.normal.set(e,t,a),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,a){const n=hM.subVectors(a,t).cross(pM.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const a=e.delta(hM),n=this.normal.dot(a);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(e.start).addScaledVector(a,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),a=this.distanceToPoint(e.end);return t<0&&a>0||a<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const a=t||fM.getNormalMatrix(e),n=this.coplanarPoint(hM).applyMatrix4(e),r=this.normal.applyMatrix3(a).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const vM=new Yw,gM=new aw(.5,.5),yM=new rw;class bM{constructor(e=new mM,t=new mM,a=new mM,n=new mM,r=new mM,i=new mM){this.planes=[e,t,a,n,r,i]}set(e,t,a,n,r,i){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(a),o[3].copy(n),o[4].copy(r),o[5].copy(i),this}copy(e){const t=this.planes;for(let a=0;a<6;a++)t[a].copy(e.planes[a]);return this}setFromProjectionMatrix(e,t=2e3,a=!1){const n=this.planes,r=e.elements,i=r[0],o=r[1],s=r[2],l=r[3],c=r[4],u=r[5],d=r[6],h=r[7],p=r[8],f=r[9],m=r[10],v=r[11],g=r[12],y=r[13],b=r[14],x=r[15];if(n[0].setComponents(l-i,h-c,v-p,x-g).normalize(),n[1].setComponents(l+i,h+c,v+p,x+g).normalize(),n[2].setComponents(l+o,h+u,v+f,x+y).normalize(),n[3].setComponents(l-o,h-u,v-f,x-y).normalize(),a)n[4].setComponents(s,d,m,b).normalize(),n[5].setComponents(l-s,h-d,v-m,x-b).normalize();else if(n[4].setComponents(l-s,h-d,v-m,x-b).normalize(),t===Ox)n[5].setComponents(l+s,h+d,v+m,x+b).normalize();else{if(t!==Fx)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(s,d,m,b).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),vM.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),vM.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(vM)}intersectsSprite(e){vM.center.set(0,0,0);const t=gM.distanceTo(e.center);return vM.radius=.7071067811865476+t,vM.applyMatrix4(e.matrixWorld),this.intersectsSphere(vM)}intersectsSphere(e){const t=this.planes,a=e.center,n=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(a)<n)return!1}return!0}intersectsBox(e){const t=this.planes;for(let a=0;a<6;a++){const n=t[a];if(yM.x=n.normal.x>0?e.max.x:e.min.x,yM.y=n.normal.y>0?e.max.y:e.min.y,yM.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(yM)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let a=0;a<6;a++)if(t[a].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class xM extends K_{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new j_(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const wM=new rw,_M=new rw,SM=new t_,MM=new e_,TM=new Yw,kM=new rw,CM=new rw;let AM=class extends A_{constructor(e=new hS,t=new xM){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,a=[0];for(let e=1,n=t.count;e<n;e++)wM.fromBufferAttribute(t,e-1),_M.fromBufferAttribute(t,e),a[e]=a[e-1],a[e]+=wM.distanceTo(_M);e.setAttribute("lineDistance",new rS(a,1))}else Gx("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const a=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold,i=a.drawRange;if(null===a.boundingSphere&&a.computeBoundingSphere(),TM.copy(a.boundingSphere),TM.applyMatrix4(n),TM.radius+=r,!1===e.ray.intersectsSphere(TM))return;SM.copy(n).invert(),MM.copy(e.ray).applyMatrix4(SM);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=this.isLineSegments?2:1,c=a.index,u=a.attributes.position;if(null!==c){const a=Math.max(0,i.start),n=Math.min(c.count,i.start+i.count);for(let r=a,i=n-1;r<i;r+=l){const a=c.getX(r),n=c.getX(r+1),i=EM(this,e,MM,s,a,n,r);i&&t.push(i)}if(this.isLineLoop){const r=c.getX(n-1),i=c.getX(a),o=EM(this,e,MM,s,r,i,n-1);o&&t.push(o)}}else{const a=Math.max(0,i.start),n=Math.min(u.count,i.start+i.count);for(let r=a,i=n-1;r<i;r+=l){const a=EM(this,e,MM,s,r,r+1,r);a&&t.push(a)}if(this.isLineLoop){const r=EM(this,e,MM,s,n-1,a,n-1);r&&t.push(r)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const a=e[t[0]];if(void 0!==a){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=a.length;e<t;e++){const t=a[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}};function EM(e,t,a,n,r,i,o){const s=e.geometry.attributes.position;wM.fromBufferAttribute(s,r),_M.fromBufferAttribute(s,i);if(a.distanceSqToSegment(wM,_M,kM,CM)>n)return;kM.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(kM);return l<t.near||l>t.far?void 0:{distance:l,point:CM.clone().applyMatrix4(e.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:e}}const IM=new rw,RM=new rw;class DM extends AM{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,a=[];for(let e=0,n=t.count;e<n;e+=2)IM.fromBufferAttribute(t,e),RM.fromBufferAttribute(t,e+1),a[e]=0===e?0:a[e-1],a[e+1]=a[e]+IM.distanceTo(RM);e.setAttribute("lineDistance",new rS(a,1))}else Gx("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class PM extends K_{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new j_(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const LM=new t_,NM=new e_,OM=new Yw,FM=new rw;class BM extends A_{constructor(e=new hS,t=new PM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const a=this.geometry,n=this.matrixWorld,r=e.params.Points.threshold,i=a.drawRange;if(null===a.boundingSphere&&a.computeBoundingSphere(),OM.copy(a.boundingSphere),OM.applyMatrix4(n),OM.radius+=r,!1===e.ray.intersectsSphere(OM))return;LM.copy(n).invert(),NM.copy(e.ray).applyMatrix4(LM);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=a.index,c=a.attributes.position;if(null!==l){for(let a=Math.max(0,i.start),r=Math.min(l.count,i.start+i.count);a<r;a++){const r=l.getX(a);FM.fromBufferAttribute(c,r),UM(FM,r,s,n,e,t,this)}}else{for(let a=Math.max(0,i.start),r=Math.min(c.count,i.start+i.count);a<r;a++)FM.fromBufferAttribute(c,a),UM(FM,a,s,n,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const a=e[t[0]];if(void 0!==a){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=a.length;e<t;e++){const t=a[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function UM(e,t,a,n,r,i,o){const s=NM.distanceSqToPoint(e);if(s<a){const a=new rw;NM.closestPointToPoint(e,a),a.applyMatrix4(n);const l=r.ray.origin.distanceTo(a);if(l<r.near||l>r.far)return;i.push({distance:l,distanceToRay:Math.sqrt(s),point:a,index:t,face:null,faceIndex:null,barycoord:null,object:o})}}class zM extends _w{constructor(e,t,a,n,r,i,o,s,l){super(e,t,a,n,r,i,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class VM extends _w{constructor(e,t,a=1014,n,r,i,o=1003,s=1003,l,c=1026,u=1){if(c!==Rb&&c!==Db)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},n,r,i,o,s,c,a,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new yw(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class HM extends VM{constructor(e,t=1014,a=301,n,r,i=1003,o=1003,s,l=1026){const c={width:e,height:e,depth:1},u=[c,c,c,c,c,c];super(e,e,t,a,n,r,i,o,s,l),this.image=u,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class GM extends _w{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class WM extends hS{constructor(e=1,t=1,a=1,n=32,r=1,i=!1,o=0,s=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:a,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s};const l=this;n=Math.floor(n),r=Math.floor(r);const c=[],u=[],d=[],h=[];let p=0;const f=[],m=a/2;let v=0;function g(a){const r=p,i=new aw,f=new rw;let g=0;const y=!0===a?e:t,b=!0===a?1:-1;for(let e=1;e<=n;e++)u.push(0,m*b,0),d.push(0,b,0),h.push(.5,.5),p++;const x=p;for(let e=0;e<=n;e++){const t=e/n*s+o,a=Math.cos(t),r=Math.sin(t);f.x=y*r,f.y=m*b,f.z=y*a,u.push(f.x,f.y,f.z),d.push(0,b,0),i.x=.5*a+.5,i.y=.5*r*b+.5,h.push(i.x,i.y),p++}for(let e=0;e<n;e++){const t=r+e,n=x+e;!0===a?c.push(n,n+1,t):c.push(n+1,n,t),g+=3}l.addGroup(v,g,!0===a?1:2),v+=g}!function(){const i=new rw,g=new rw;let y=0;const b=(t-e)/a;for(let l=0;l<=r;l++){const c=[],v=l/r,y=v*(t-e)+e;for(let e=0;e<=n;e++){const t=e/n,r=t*s+o,l=Math.sin(r),f=Math.cos(r);g.x=y*l,g.y=-v*a+m,g.z=y*f,u.push(g.x,g.y,g.z),i.set(l,b,f).normalize(),d.push(i.x,i.y,i.z),h.push(t,1-v),c.push(p++)}f.push(c)}for(let a=0;a<n;a++)for(let n=0;n<r;n++){const i=f[n][a],o=f[n+1][a],s=f[n+1][a+1],l=f[n][a+1];(e>0||0!==n)&&(c.push(i,o,l),y+=3),(t>0||n!==r-1)&&(c.push(o,s,l),y+=3)}l.addGroup(v,y,0),v+=y}(),!1===i&&(e>0&&g(!0),t>0&&g(!1)),this.setIndex(c),this.setAttribute("position",new rS(u,3)),this.setAttribute("normal",new rS(d,3)),this.setAttribute("uv",new rS(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new WM(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class qM extends WM{constructor(e=1,t=1,a=32,n=1,r=!1,i=0,o=2*Math.PI){super(0,e,t,a,n,r,i,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:a,heightSegments:n,openEnded:r,thetaStart:i,thetaLength:o}}static fromJSON(e){return new qM(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}const YM=new rw,jM=new rw,XM=new rw,$M=new H_;class KM extends hS{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const a=4,n=Math.pow(10,a),r=Math.cos(Xx*t),i=e.getIndex(),o=e.getAttribute("position"),s=i?i.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),d={},h=[];for(let e=0;e<s;e+=3){i?(l[0]=i.getX(e),l[1]=i.getX(e+1),l[2]=i.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:a,c:s}=$M;if(t.fromBufferAttribute(o,l[0]),a.fromBufferAttribute(o,l[1]),s.fromBufferAttribute(o,l[2]),$M.getNormal(XM),u[0]=`${Math.round(t.x*n)},${Math.round(t.y*n)},${Math.round(t.z*n)}`,u[1]=`${Math.round(a.x*n)},${Math.round(a.y*n)},${Math.round(a.z*n)}`,u[2]=`${Math.round(s.x*n)},${Math.round(s.y*n)},${Math.round(s.z*n)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,a=u[e],n=u[t],i=$M[c[e]],o=$M[c[t]],s=`${a}_${n}`,p=`${n}_${a}`;p in d&&d[p]?(XM.dot(d[p].normal)<=r&&(h.push(i.x,i.y,i.z),h.push(o.x,o.y,o.z)),d[p]=null):s in d||(d[s]={index0:l[e],index1:l[t],normal:XM.clone()})}}for(const e in d)if(d[e]){const{index0:t,index1:a}=d[e];YM.fromBufferAttribute(o,t),jM.fromBufferAttribute(o,a),h.push(YM.x,YM.y,YM.z),h.push(jM.x,jM.y,jM.z)}this.setAttribute("position",new rS(h,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ZM{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Gx("Curve: .getPoint() not implemented.")}getPointAt(e,t){const a=this.getUtoTmapping(e);return this.getPoint(a,t)}getPoints(e=5){const t=[];for(let a=0;a<=e;a++)t.push(this.getPoint(a/e));return t}getSpacedPoints(e=5){const t=[];for(let a=0;a<=e;a++)t.push(this.getPointAt(a/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let a,n=this.getPoint(0),r=0;t.push(0);for(let i=1;i<=e;i++)a=this.getPoint(i/e),r+=a.distanceTo(n),t.push(r),n=a;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const a=this.getLengths();let n=0;const r=a.length;let i;i=t||e*a[r-1];let o,s=0,l=r-1;for(;s<=l;)if(n=Math.floor(s+(l-s)/2),o=a[n]-i,o<0)s=n+1;else{if(!(o>0)){l=n;break}l=n-1}if(n=l,a[n]===i)return n/(r-1);const c=a[n];return(n+(i-c)/(a[n+1]-c))/(r-1)}getTangent(e,t){const a=1e-4;let n=e-a,r=e+a;n<0&&(n=0),r>1&&(r=1);const i=this.getPoint(n),o=this.getPoint(r),s=t||(i.isVector2?new aw:new rw);return s.copy(o).sub(i).normalize(),s}getTangentAt(e,t){const a=this.getUtoTmapping(e);return this.getTangent(a,t)}computeFrenetFrames(e,t=!1){const a=new rw,n=[],r=[],i=[],o=new rw,s=new t_;for(let h=0;h<=e;h++){const t=h/e;n[h]=this.getTangentAt(t,new rw)}r[0]=new rw,i[0]=new rw;let l=Number.MAX_VALUE;const c=Math.abs(n[0].x),u=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=l&&(l=c,a.set(1,0,0)),u<=l&&(l=u,a.set(0,1,0)),d<=l&&a.set(0,0,1),o.crossVectors(n[0],a).normalize(),r[0].crossVectors(n[0],o),i[0].crossVectors(n[0],r[0]);for(let h=1;h<=e;h++){if(r[h]=r[h-1].clone(),i[h]=i[h-1].clone(),o.crossVectors(n[h-1],n[h]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Zx(n[h-1].dot(n[h]),-1,1));r[h].applyMatrix4(s.makeRotationAxis(o,e))}i[h].crossVectors(n[h],r[h])}if(!0===t){let t=Math.acos(Zx(r[0].dot(r[e]),-1,1));t/=e,n[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let a=1;a<=e;a++)r[a].applyMatrix4(s.makeRotationAxis(n[a],t*a)),i[a].crossVectors(n[a],r[a])}return{tangents:n,normals:r,binormals:i}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function JM(){let e=0,t=0,a=0,n=0;function r(r,i,o,s){e=r,t=o,a=-3*r+3*i-2*o-s,n=2*r-2*i+o+s}return{initCatmullRom:function(e,t,a,n,i){r(t,a,i*(a-e),i*(n-t))},initNonuniformCatmullRom:function(e,t,a,n,i,o,s){let l=(t-e)/i-(a-e)/(i+o)+(a-t)/o,c=(a-t)/o-(n-t)/(o+s)+(n-a)/s;l*=o,c*=o,r(t,a,l,c)},calc:function(r){const i=r*r;return e+t*r+a*i+n*(i*r)}}}const QM=new rw,eT=new JM,tT=new JM,aT=new JM;class nT extends ZM{constructor(e=[],t=!1,a="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=a,this.tension=n}getPoint(e,t=new rw){const a=t,n=this.points,r=n.length,i=(r-(this.closed?0:1))*e;let o,s,l=Math.floor(i),c=i-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?o=n[(l-1)%r]:(QM.subVectors(n[0],n[1]).add(n[0]),o=QM);const u=n[l%r],d=n[(l+1)%r];if(this.closed||l+2<r?s=n[(l+2)%r]:(QM.subVectors(n[r-1],n[r-2]).add(n[r-1]),s=QM),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(u),e),a=Math.pow(u.distanceToSquared(d),e),n=Math.pow(d.distanceToSquared(s),e);a<1e-4&&(a=1),t<1e-4&&(t=a),n<1e-4&&(n=a),eT.initNonuniformCatmullRom(o.x,u.x,d.x,s.x,t,a,n),tT.initNonuniformCatmullRom(o.y,u.y,d.y,s.y,t,a,n),aT.initNonuniformCatmullRom(o.z,u.z,d.z,s.z,t,a,n)}else"catmullrom"===this.curveType&&(eT.initCatmullRom(o.x,u.x,d.x,s.x,this.tension),tT.initCatmullRom(o.y,u.y,d.y,s.y,this.tension),aT.initCatmullRom(o.z,u.z,d.z,s.z,this.tension));return a.set(eT.calc(c),tT.calc(c),aT.calc(c)),a}copy(e){super.copy(e),this.points=[];for(let t=0,a=e.points.length;t<a;t++){const a=e.points[t];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,a=this.points.length;t<a;t++){const a=this.points[t];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,a=e.points.length;t<a;t++){const a=e.points[t];this.points.push((new rw).fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}class rT extends hS{constructor(e=1,t=1,a=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:a,heightSegments:n};const r=e/2,i=t/2,o=Math.floor(a),s=Math.floor(n),l=o+1,c=s+1,u=e/o,d=t/s,h=[],p=[],f=[],m=[];for(let v=0;v<c;v++){const e=v*d-i;for(let t=0;t<l;t++){const a=t*u-r;p.push(a,-e,0),f.push(0,0,1),m.push(t/o),m.push(1-v/s)}}for(let v=0;v<s;v++)for(let e=0;e<o;e++){const t=e+l*v,a=e+l*(v+1),n=e+1+l*(v+1),r=e+1+l*v;h.push(t,a,r),h.push(a,n,r)}this.setIndex(h),this.setAttribute("position",new rS(p,3)),this.setAttribute("normal",new rS(f,3)),this.setAttribute("uv",new rS(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rT(e.width,e.height,e.widthSegments,e.heightSegments)}}class iT extends hS{constructor(e=.5,t=1,a=32,n=1,r=0,i=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:a,phiSegments:n,thetaStart:r,thetaLength:i},a=Math.max(3,a);const o=[],s=[],l=[],c=[];let u=e;const d=(t-e)/(n=Math.max(1,n)),h=new rw,p=new aw;for(let f=0;f<=n;f++){for(let e=0;e<=a;e++){const n=r+e/a*i;h.x=u*Math.cos(n),h.y=u*Math.sin(n),s.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(h.x/t+1)/2,p.y=(h.y/t+1)/2,c.push(p.x,p.y)}u+=d}for(let f=0;f<n;f++){const e=f*(a+1);for(let t=0;t<a;t++){const n=t+e,r=n,i=n+a+1,s=n+a+2,l=n+1;o.push(r,i,l),o.push(i,s,l)}}this.setIndex(o),this.setAttribute("position",new rS(s,3)),this.setAttribute("normal",new rS(l,3)),this.setAttribute("uv",new rS(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iT(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class oT extends hS{constructor(e=1,t=32,a=16,n=0,r=2*Math.PI,i=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:a,phiStart:n,phiLength:r,thetaStart:i,thetaLength:o},t=Math.max(3,Math.floor(t)),a=Math.max(2,Math.floor(a));const s=Math.min(i+o,Math.PI);let l=0;const c=[],u=new rw,d=new rw,h=[],p=[],f=[],m=[];for(let v=0;v<=a;v++){const h=[],g=v/a;let y=0;0===v&&0===i?y=.5/t:v===a&&s===Math.PI&&(y=-.5/t);for(let a=0;a<=t;a++){const s=a/t;u.x=-e*Math.cos(n+s*r)*Math.sin(i+g*o),u.y=e*Math.cos(i+g*o),u.z=e*Math.sin(n+s*r)*Math.sin(i+g*o),p.push(u.x,u.y,u.z),d.copy(u).normalize(),f.push(d.x,d.y,d.z),m.push(s+y,1-g),h.push(l++)}c.push(h)}for(let v=0;v<a;v++)for(let e=0;e<t;e++){const t=c[v][e+1],n=c[v][e],r=c[v+1][e],o=c[v+1][e+1];(0!==v||i>0)&&h.push(t,n,o),(v!==a-1||s<Math.PI)&&h.push(n,r,o)}this.setIndex(h),this.setAttribute("position",new rS(p,3)),this.setAttribute("normal",new rS(f,3)),this.setAttribute("uv",new rS(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oT(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class sT extends RS{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class lT extends K_{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new j_(16777215),this.specular=new j_(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new j_(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new aw(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new d_,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cT extends K_{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class uT extends K_{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class dT extends A_{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new j_(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}const hT=new t_,pT=new rw,fT=new rw;class mT{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new aw(512,512),this.mapType=gb,this.map=null,this.mapPass=null,this.matrix=new t_,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new bM,this._frameExtents=new aw(1,1),this._viewportCount=1,this._viewports=[new Sw(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,a=this.matrix;pT.setFromMatrixPosition(e.matrixWorld),t.position.copy(pT),fT.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(fT),t.updateMatrixWorld(),hT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(hT,t.coordinateSystem,t.reversedDepth),t.reversedDepth?a.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(hT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class vT extends mT{constructor(){super(new OS(90,1,.5,500)),this.isPointLightShadow=!0}}class gT extends dT{constructor(e,t,a=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=a,this.decay=n,this.shadow=new vT}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class yT extends DS{constructor(e=-1,t=1,a=1,n=-1,r=.1,i=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=a,this.bottom=n,this.near=r,this.far=i,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,a,n,r,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=a,this.view.offsetY=n,this.view.width=r,this.view.height=i,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=a-e,i=a+e,o=n+t,s=n-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,i=r+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,i,o,s,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class bT extends mT{constructor(){super(new yT(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class xT extends dT{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(A_.DEFAULT_UP),this.updateMatrix(),this.target=new A_,this.shadow=new bT}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class wT extends dT{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class _T extends OS{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const ST=new t_;class MT{constructor(e,t,a=0,n=1/0){this.ray=new e_(e,t),this.near=a,this.far=n,this.camera=null,this.layers=new h_,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Wx("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return ST.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ST),this}intersectObject(e,t=!0,a=[]){return kT(e,this,a,t),a.sort(TT),a}intersectObjects(e,t=!0,a=[]){for(let n=0,r=e.length;n<r;n++)kT(e[n],this,a,t);return a.sort(TT),a}}function TT(e,t){return e.distance-t.distance}function kT(e,t,a,n){let r=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,a)&&(r=!1)}if(!0===r&&!0===n){const n=e.children;for(let e=0,r=n.length;e<r;e++)kT(n[e],t,a,!0)}}class CT{constructor(e=1,t=0,a=0){this.radius=e,this.phi=t,this.theta=a}set(e,t,a){return this.radius=e,this.phi=t,this.theta=a,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Zx(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,a){return this.radius=Math.sqrt(e*e+t*t+a*a),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,a),this.phi=Math.acos(Zx(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class AT extends DM{constructor(e=10,t=10,a=4473924,n=8947848){a=new j_(a),n=new j_(n);const r=t/2,i=e/t,o=e/2,s=[],l=[];for(let u=0,d=0,h=-o;u<=t;u++,h+=i){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);const e=u===r?a:n;e.toArray(l,d),d+=3,e.toArray(l,d),d+=3,e.toArray(l,d),d+=3,e.toArray(l,d),d+=3}const c=new hS;c.setAttribute("position",new rS(s,3)),c.setAttribute("color",new rS(l,3));super(c,new xM({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const ET=new rw;let IT,RT;class DT extends A_{constructor(e=new rw(0,0,1),t=new rw(0,0,0),a=1,n=16776960,r=.2*a,i=.2*r){super(),this.type="ArrowHelper",void 0===IT&&(IT=new hS,IT.setAttribute("position",new rS([0,0,0,0,1,0],3)),RT=new qM(.5,1,5,1),RT.translate(0,-.5,0)),this.position.copy(t),this.line=new AM(IT,new xM({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new MS(RT,new Z_({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(a,r,i)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{ET.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(ET,t)}}setLength(e,t=.2*e,a=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(a,t,a),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class PT extends Yx{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):Gx("Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function LT(e,t,a,n){const r=function(e){switch(e){case gb:case yb:return{byteLength:1,components:1};case xb:case bb:case Mb:return{byteLength:2,components:1};case Tb:case kb:return{byteLength:2,components:4};case _b:case wb:case Sb:return{byteLength:4,components:1};case Ab:case Eb:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(n);switch(a){case 1021:return e*t;case 1028:case Pb:return e*t/r.components*r.byteLength;case Lb:case Nb:return e*t*2/r.components*r.byteLength;case 1022:return e*t*3/r.components*r.byteLength;case Ib:case Ob:return e*t*4/r.components*r.byteLength;case Fb:case Bb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case Ub:case zb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Hb:case Wb:return Math.max(e,16)*Math.max(t,8)/4;case Vb:case Gb:return Math.max(e,8)*Math.max(t,8)/2;case qb:case Yb:case Xb:case $b:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case jb:case Kb:case Zb:case Jb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Qb:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case ex:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case tx:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case ax:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case nx:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case rx:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case ix:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case ox:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case sx:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case lx:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case cx:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case ux:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case dx:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case hx:case px:case fx:return Math.ceil(e/4)*Math.ceil(t/4)*16;case mx:case vx:return Math.ceil(e/4)*Math.ceil(t/4)*8;case gx:case yx:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${a} format.`)}
/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
function NT(){let e=null,t=!1,a=null,n=null;function r(t,i){a(t,i),n=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==a&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){a=e},setContext:function(t){e=t}}}function OT(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(a){a.isInterleavedBufferAttribute&&(a=a.data);const n=t.get(a);n&&(e.deleteBuffer(n.buffer),t.delete(a))},update:function(a,n){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const e=t.get(a);return void((!e||e.version<a.version)&&t.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version}))}const r=t.get(a);if(void 0===r)t.set(a,function(t,a){const n=t.array,r=t.usage,i=n.byteLength,o=e.createBuffer();let s;if(e.bindBuffer(a,o),e.bufferData(a,n,r),t.onUploadCallback(),n instanceof Float32Array)s=e.FLOAT;else if("undefined"!=typeof Float16Array&&n instanceof Float16Array)s=e.HALF_FLOAT;else if(n instanceof Uint16Array)s=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(n instanceof Int16Array)s=e.SHORT;else if(n instanceof Uint32Array)s=e.UNSIGNED_INT;else if(n instanceof Int32Array)s=e.INT;else if(n instanceof Int8Array)s=e.BYTE;else if(n instanceof Uint8Array)s=e.UNSIGNED_BYTE;else{if(!(n instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+n);s=e.UNSIGNED_BYTE}return{buffer:o,type:s,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version,size:i}}(a,n));else if(r.version<a.version){if(r.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,a,n){const r=a.array,i=a.updateRanges;if(e.bindBuffer(n,t),0===i.length)e.bufferSubData(n,0,r);else{i.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<i.length;e++){const a=i[t],n=i[e];n.start<=a.start+a.count+1?a.count=Math.max(a.count,n.start+n.count-a.start):(++t,i[t]=n)}i.length=t+1;for(let a=0,o=i.length;a<o;a++){const t=i[a];e.bufferSubData(n,t.start*r.BYTES_PER_ELEMENT,r,t.start,t.count)}a.clearUpdateRanges()}a.onUploadCallback()}(r.buffer,a,n),r.version=a.version}}}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:uy}})),"undefined"!=typeof window&&(window.__THREE__?Gx("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=uy);const FT={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.metalness = metalnessFactor;\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = vec3( 0.04 );\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tvec3 diffuseContribution;\n\tvec3 specularColor;\n\tvec3 specularColorBlended;\n\tfloat roughness;\n\tfloat metalness;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t\tvec3 iridescenceFresnelDielectric;\n\t\tvec3 iridescenceFresnelMetallic;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn v;\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColorBlended;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat rInv = 1.0 / ( roughness + 0.1 );\n\tfloat a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;\n\tfloat b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;\n\tfloat DG = exp( a * dotNV + b );\n\treturn saturate( DG );\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;\n\tvec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;\n\tvec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n \n \t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n \n \t\tfloat sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n \t\tfloat sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );\n \n \t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );\n \n \t\tirradiance *= sheenEnergyComp;\n \n \t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tdiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectDiffuse += diffuse;\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;\n \t#endif\n\tvec3 singleScatteringDielectric = vec3( 0.0 );\n\tvec3 multiScatteringDielectric = vec3( 0.0 );\n\tvec3 singleScatteringMetallic = vec3( 0.0 );\n\tvec3 multiScatteringMetallic = vec3( 0.0 );\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#endif\n\tvec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );\n\tvec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );\n\tvec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;\n\tvec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tvec3 indirectSpecular = radiance * singleScattering;\n\tindirectSpecular += multiScattering * cosineWeightedIrradiance;\n\tvec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tindirectSpecular *= sheenEnergyComp;\n\t\tindirectDiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectSpecular += indirectSpecular;\n\treflectedLight.indirectDiffuse += indirectDiffuse;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );\n\t\tmaterial.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\t\t\tuniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat interleavedGradientNoise( vec2 position ) {\n\t\t\treturn fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );\n\t\t}\n\t\tvec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {\n\t\t\tconst float goldenAngle = 2.399963229728653;\n\t\t\tfloat r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );\n\t\t\tfloat theta = float( sampleIndex ) * goldenAngle + phi;\n\t\t\treturn vec2( cos( theta ), sin( theta ) ) * r;\n\t\t}\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\t\tfloat radius = shadowRadius * texelSize.x;\n\t\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )\n\t\t\t\t) * 0.2;\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;\n\t\t\t\tfloat mean = distribution.x;\n\t\t\t\tfloat variance = distribution.y * distribution.y;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tfloat hard_shadow = step( mean, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tfloat hard_shadow = step( shadowCoord.z, mean );\n\t\t\t\t#endif\n\t\t\t\tif ( hard_shadow == 1.0 ) {\n\t\t\t\t\tshadow = 1.0;\n\t\t\t\t} else {\n\t\t\t\t\tvariance = max( variance, 0.0000001 );\n\t\t\t\t\tfloat d = shadowCoord.z - mean;\n\t\t\t\t\tfloat p_max = variance / ( variance + d * d );\n\t\t\t\t\tp_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );\n\t\t\t\t\tshadow = max( hard_shadow, p_max );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#else\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tfloat depth = texture2D( shadowMap, shadowCoord.xy ).r;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tshadow = step( depth, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tshadow = step( shadowCoord.z, depth );\n\t\t\t\t#endif\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\tfloat getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat texelSize = shadowRadius / shadowMapSize.x;\n\t\t\tvec3 absDir = abs( bd3D );\n\t\t\tvec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );\n\t\t\ttangent = normalize( cross( bd3D, tangent ) );\n\t\t\tvec3 bitangent = cross( bd3D, tangent );\n\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\tshadow = (\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )\n\t\t\t) * 0.2;\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\tfloat getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat depth = textureCube( shadowMap, bd3D ).r;\n\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\tshadow = step( depth, dp );\n\t\t\t#else\n\t\t\t\tshadow = step( dp, depth );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#endif\n\t#endif\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distance_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distance_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n \n\t\toutgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;\n \n \t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},BT={common:{diffuse:{value:new j_(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new sw},alphaMap:{value:null},alphaMapTransform:{value:new sw},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new sw}},envmap:{envMap:{value:null},envMapRotation:{value:new sw},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new sw}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new sw}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new sw},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new sw},normalScale:{value:new aw(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new sw},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new sw}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new sw}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new sw}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new j_(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new j_(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new sw},alphaTest:{value:0},uvTransform:{value:new sw}},sprite:{diffuse:{value:new j_(16777215)},opacity:{value:1},center:{value:new aw(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new sw},alphaMap:{value:null},alphaMapTransform:{value:new sw},alphaTest:{value:0}}},UT={basic:{uniforms:AS([BT.common,BT.specularmap,BT.envmap,BT.aomap,BT.lightmap,BT.fog]),vertexShader:FT.meshbasic_vert,fragmentShader:FT.meshbasic_frag},lambert:{uniforms:AS([BT.common,BT.specularmap,BT.envmap,BT.aomap,BT.lightmap,BT.emissivemap,BT.bumpmap,BT.normalmap,BT.displacementmap,BT.fog,BT.lights,{emissive:{value:new j_(0)}}]),vertexShader:FT.meshlambert_vert,fragmentShader:FT.meshlambert_frag},phong:{uniforms:AS([BT.common,BT.specularmap,BT.envmap,BT.aomap,BT.lightmap,BT.emissivemap,BT.bumpmap,BT.normalmap,BT.displacementmap,BT.fog,BT.lights,{emissive:{value:new j_(0)},specular:{value:new j_(1118481)},shininess:{value:30}}]),vertexShader:FT.meshphong_vert,fragmentShader:FT.meshphong_frag},standard:{uniforms:AS([BT.common,BT.envmap,BT.aomap,BT.lightmap,BT.emissivemap,BT.bumpmap,BT.normalmap,BT.displacementmap,BT.roughnessmap,BT.metalnessmap,BT.fog,BT.lights,{emissive:{value:new j_(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:FT.meshphysical_vert,fragmentShader:FT.meshphysical_frag},toon:{uniforms:AS([BT.common,BT.aomap,BT.lightmap,BT.emissivemap,BT.bumpmap,BT.normalmap,BT.displacementmap,BT.gradientmap,BT.fog,BT.lights,{emissive:{value:new j_(0)}}]),vertexShader:FT.meshtoon_vert,fragmentShader:FT.meshtoon_frag},matcap:{uniforms:AS([BT.common,BT.bumpmap,BT.normalmap,BT.displacementmap,BT.fog,{matcap:{value:null}}]),vertexShader:FT.meshmatcap_vert,fragmentShader:FT.meshmatcap_frag},points:{uniforms:AS([BT.points,BT.fog]),vertexShader:FT.points_vert,fragmentShader:FT.points_frag},dashed:{uniforms:AS([BT.common,BT.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:FT.linedashed_vert,fragmentShader:FT.linedashed_frag},depth:{uniforms:AS([BT.common,BT.displacementmap]),vertexShader:FT.depth_vert,fragmentShader:FT.depth_frag},normal:{uniforms:AS([BT.common,BT.bumpmap,BT.normalmap,BT.displacementmap,{opacity:{value:1}}]),vertexShader:FT.meshnormal_vert,fragmentShader:FT.meshnormal_frag},sprite:{uniforms:AS([BT.sprite,BT.fog]),vertexShader:FT.sprite_vert,fragmentShader:FT.sprite_frag},background:{uniforms:{uvTransform:{value:new sw},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:FT.background_vert,fragmentShader:FT.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new sw}},vertexShader:FT.backgroundCube_vert,fragmentShader:FT.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:FT.cube_vert,fragmentShader:FT.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:FT.equirect_vert,fragmentShader:FT.equirect_frag},distance:{uniforms:AS([BT.common,BT.displacementmap,{referencePosition:{value:new rw},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:FT.distance_vert,fragmentShader:FT.distance_frag},shadow:{uniforms:AS([BT.lights,BT.fog,{color:{value:new j_(0)},opacity:{value:1}}]),vertexShader:FT.shadow_vert,fragmentShader:FT.shadow_frag}};UT.physical={uniforms:AS([UT.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new sw},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new sw},clearcoatNormalScale:{value:new aw(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new sw},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new sw},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new sw},sheen:{value:0},sheenColor:{value:new j_(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new sw},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new sw},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new sw},transmissionSamplerSize:{value:new aw},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new sw},attenuationDistance:{value:0},attenuationColor:{value:new j_(0)},specularColor:{value:new j_(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new sw},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new sw},anisotropyVector:{value:new aw},anisotropyMap:{value:null},anisotropyMapTransform:{value:new sw}}]),vertexShader:FT.meshphysical_vert,fragmentShader:FT.meshphysical_frag};const zT={r:0,b:0,g:0},VT=new d_,HT=new t_;function GT(e,t,a,n,r,i,o){const s=new j_(0);let l,c,u=!0===i?0:1,d=null,h=0,p=null;function f(e){let n=!0===e.isScene?e.background:null;if(n&&n.isTexture){n=(e.backgroundBlurriness>0?a:t).get(n)}return n}function m(t,a){t.getRGB(zT,ES(e)),n.buffers.color.setClear(zT.r,zT.g,zT.b,a,o)}return{getClearColor:function(){return s},setClearColor:function(e,t=1){s.set(e),u=t,m(s,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,m(s,u)},render:function(t){let a=!1;const r=f(t);null===r?m(s,u):r&&r.isColor&&(m(r,1),a=!0);const i=e.xr.getEnvironmentBlendMode();"additive"===i?n.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===i&&n.buffers.color.setClear(0,0,0,0,o),(e.autoClear||a)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,a){const n=f(a);n&&(n.isCubeTexture||n.mapping===sb)?(void 0===c&&(c=new MS(new kS(1,1,1),new RS({name:"BackgroundCubeMaterial",uniforms:CS(UT.backgroundCube.uniforms),vertexShader:UT.backgroundCube.vertexShader,fragmentShader:UT.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,a){this.matrixWorld.copyPosition(a.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),VT.copy(a.backgroundRotation),VT.x*=-1,VT.y*=-1,VT.z*=-1,n.isCubeTexture&&!1===n.isRenderTargetTexture&&(VT.y*=-1,VT.z*=-1),c.material.uniforms.envMap.value=n,c.material.uniforms.flipEnvMap.value=n.isCubeTexture&&!1===n.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=a.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=a.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(HT.makeRotationFromEuler(VT)),c.material.toneMapped=hw.getTransfer(n.colorSpace)!==Mx,d===n&&h===n.version&&p===e.toneMapping||(c.material.needsUpdate=!0,d=n,h=n.version,p=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):n&&n.isTexture&&(void 0===l&&(l=new MS(new rT(2,2),new RS({name:"BackgroundMaterial",uniforms:CS(UT.background.uniforms),vertexShader:UT.background.vertexShader,fragmentShader:UT.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=n,l.material.uniforms.backgroundIntensity.value=a.backgroundIntensity,l.material.toneMapped=hw.getTransfer(n.colorSpace)!==Mx,!0===n.matrixAutoUpdate&&n.updateMatrix(),l.material.uniforms.uvTransform.value.copy(n.matrix),d===n&&h===n.version&&p===e.toneMapping||(l.material.needsUpdate=!0,d=n,h=n.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function WT(e,t){const a=e.getParameter(e.MAX_VERTEX_ATTRIBS),n={},r=c(null);let i=r,o=!1;function s(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],n=[],r=[];for(let i=0;i<a;i++)t[i]=0,n[i]=0,r[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function u(){const e=i.newAttributes;for(let t=0,a=e.length;t<a;t++)e[t]=0}function d(e){h(e,0)}function h(t,a){const n=i.newAttributes,r=i.enabledAttributes,o=i.attributeDivisors;n[t]=1,0===r[t]&&(e.enableVertexAttribArray(t),r[t]=1),o[t]!==a&&(e.vertexAttribDivisor(t,a),o[t]=a)}function p(){const t=i.newAttributes,a=i.enabledAttributes;for(let n=0,r=a.length;n<r;n++)a[n]!==t[n]&&(e.disableVertexAttribArray(n),a[n]=0)}function f(t,a,n,r,i,o,s){!0===s?e.vertexAttribIPointer(t,a,n,i,o):e.vertexAttribPointer(t,a,n,r,i,o)}function m(){v(),o=!0,i!==r&&(i=r,s(i.object))}function v(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(a,r,l,m,v){let g=!1;const y=function(t,a,r){const i=!0===r.wireframe;let o=n[t.id];void 0===o&&(o={},n[t.id]=o);let s=o[a.id];void 0===s&&(s={},o[a.id]=s);let l=s[i];void 0===l&&(l=c(e.createVertexArray()),s[i]=l);return l}(m,l,r);i!==y&&(i=y,s(i.object)),g=function(e,t,a,n){const r=i.attributes,o=t.attributes;let s=0;const l=a.getAttributes();for(const i in l){if(l[i].location>=0){const t=r[i];let a=o[i];if(void 0===a&&("instanceMatrix"===i&&e.instanceMatrix&&(a=e.instanceMatrix),"instanceColor"===i&&e.instanceColor&&(a=e.instanceColor)),void 0===t)return!0;if(t.attribute!==a)return!0;if(a&&t.data!==a.data)return!0;s++}}return i.attributesNum!==s||i.index!==n}(a,m,l,v),g&&function(e,t,a,n){const r={},o=t.attributes;let s=0;const l=a.getAttributes();for(const i in l){if(l[i].location>=0){let t=o[i];void 0===t&&("instanceMatrix"===i&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===i&&e.instanceColor&&(t=e.instanceColor));const a={};a.attribute=t,t&&t.data&&(a.data=t.data),r[i]=a,s++}}i.attributes=r,i.attributesNum=s,i.index=n}(a,m,l,v),null!==v&&t.update(v,e.ELEMENT_ARRAY_BUFFER),(g||o)&&(o=!1,function(a,n,r,i){u();const o=i.attributes,s=r.getAttributes(),l=n.defaultAttributeValues;for(const c in s){const n=s[c];if(n.location>=0){let r=o[c];if(void 0===r&&("instanceMatrix"===c&&a.instanceMatrix&&(r=a.instanceMatrix),"instanceColor"===c&&a.instanceColor&&(r=a.instanceColor)),void 0!==r){const o=r.normalized,s=r.itemSize,l=t.get(r);if(void 0===l)continue;const c=l.buffer,u=l.type,p=l.bytesPerElement,m=u===e.INT||u===e.UNSIGNED_INT||r.gpuType===wb;if(r.isInterleavedBufferAttribute){const t=r.data,l=t.stride,v=r.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<n.locationSize;e++)h(n.location+e,t.meshPerAttribute);!0!==a.isInstancedMesh&&void 0===i._maxInstanceCount&&(i._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<n.locationSize;e++)d(n.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<n.locationSize;e++)f(n.location+e,s/n.locationSize,u,o,l*p,(v+s/n.locationSize*e)*p,m)}else{if(r.isInstancedBufferAttribute){for(let e=0;e<n.locationSize;e++)h(n.location+e,r.meshPerAttribute);!0!==a.isInstancedMesh&&void 0===i._maxInstanceCount&&(i._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<n.locationSize;e++)d(n.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<n.locationSize;e++)f(n.location+e,s/n.locationSize,u,o,s*p,s/n.locationSize*e*p,m)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(n.location,t);break;case 3:e.vertexAttrib3fv(n.location,t);break;case 4:e.vertexAttrib4fv(n.location,t);break;default:e.vertexAttrib1fv(n.location,t)}}}}p()}(a,r,l,m),null!==v&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(v).buffer))},reset:m,resetDefaultState:v,dispose:function(){m();for(const e in n){const t=n[e];for(const e in t){const a=t[e];for(const e in a)l(a[e].object),delete a[e];delete t[e]}delete n[e]}},releaseStatesOfGeometry:function(e){if(void 0===n[e.id])return;const t=n[e.id];for(const a in t){const e=t[a];for(const t in e)l(e[t].object),delete e[t];delete t[a]}delete n[e.id]},releaseStatesOfProgram:function(e){for(const t in n){const a=n[t];if(void 0===a[e.id])continue;const r=a[e.id];for(const e in r)l(r[e].object),delete r[e];delete a[e.id]}},initAttributes:u,enableAttribute:d,disableUnusedAttributes:p}}function qT(e,t,a){let n;function r(t,r,i){0!==i&&(e.drawArraysInstanced(n,t,r,i),a.update(r,n,i))}this.setMode=function(e){n=e},this.render=function(t,r){e.drawArrays(n,t,r),a.update(r,n,1)},this.renderInstances=r,this.renderMultiDraw=function(e,r,i){if(0===i)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,e,0,r,0,i);let o=0;for(let t=0;t<i;t++)o+=r[t];a.update(o,n,1)},this.renderMultiDrawInstances=function(e,i,o,s){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)r(e[t],i[t],s[t]);else{l.multiDrawArraysInstancedWEBGL(n,e,0,i,0,s,0,o);let t=0;for(let e=0;e<o;e++)t+=i[e]*s[e];a.update(t,n,1)}}}function YT(e,t,a,n){let r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=void 0!==a.precision?a.precision:"highp";const s=i(o);s!==o&&(Gx("WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const a=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(a.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:i,textureFormatReadable:function(t){return t===Ib||n.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(a){const r=a===Mb&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(a!==gb&&n.convert(a)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&a!==Sb&&!r)},precision:o,logarithmicDepthBuffer:!0===a.logarithmicDepthBuffer,reversedDepthBuffer:!0===a.reversedDepthBuffer&&t.has("EXT_clip_control"),maxTextures:e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),maxVertexTextures:e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),maxSamples:e.getParameter(e.MAX_SAMPLES),samples:e.getParameter(e.SAMPLES)}}function jT(e){const t=this;let a=null,n=0,r=!1,i=!1;const o=new mM,s=new sw,l={value:null,needsUpdate:!1};function c(e,a,n,r){const i=null!==e?e.length:0;let c=null;if(0!==i){if(c=l.value,!0!==r||null===c){const t=n+4*i,r=a.matrixWorldInverse;s.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let a=0,l=n;a!==i;++a,l+=4)o.copy(e[a]).applyMatrix4(r,s),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=i,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const a=0!==e.length||t||0!==n||r;return r=t,n=e.length,a},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(e,t){a=c(e,t,0)},this.setState=function(o,s,u){const d=o.clippingPlanes,h=o.clipIntersection,p=o.clipShadows,f=e.get(o);if(!r||null===d||0===d.length||i&&!p)i?c(null):function(){l.value!==a&&(l.value=a,l.needsUpdate=n>0);t.numPlanes=n,t.numIntersection=0}();else{const e=i?0:n,t=4*e;let r=f.clippingState||null;l.value=r,r=c(d,s,t,u);for(let n=0;n!==t;++n)r[n]=a[n];f.clippingState=r,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function XT(e){let t=new WeakMap;function a(e,t){return 303===t?e.mapping=ib:304===t&&(e.mapping=ob),e}function n(e){const a=e.target;a.removeEventListener("dispose",n);const r=t.get(a);void 0!==r&&(t.delete(a),r.dispose())}return{get:function(r){if(r&&r.isTexture){const i=r.mapping;if(303===i||304===i){if(t.has(r)){return a(t.get(r).texture,r.mapping)}{const i=r.image;if(i&&i.height>0){const o=new zS(i.height);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener("dispose",n),a(o.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}const $T=[.125,.215,.35,.446,.526,.582],KT=20,ZT=new yT,JT=new j_;let QT=null,ek=0,tk=0,ak=!1;const nk=new rw;class rk{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,a=.1,n=100,r={}){const{size:i=256,position:o=nk}=r;QT=this._renderer.getRenderTarget(),ek=this._renderer.getActiveCubeFace(),tk=this._renderer.getActiveMipmapLevel(),ak=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(i);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,a,n,s,o),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=lk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=sk(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(QT,ek,tk),this._renderer.xr.enabled=ak,e.scissorTest=!1,ok(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ib||e.mapping===ob?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),QT=this._renderer.getRenderTarget(),ek=this._renderer.getActiveCubeFace(),tk=this._renderer.getActiveMipmapLevel(),ak=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const a=t||this._allocateTargets();return this._textureToCubeUV(e,a),this._applyPMREM(a),this._cleanup(a),a}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,a={magFilter:fb,minFilter:fb,generateMipmaps:!1,type:Mb,format:Ib,colorSpace:_x,depthBuffer:!1},n=ik(e,t,a);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ik(e,t,a);const{_lodMax:n}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function(e){const t=[],a=[],n=[];let r=e;const i=e-4+1+$T.length;for(let o=0;o<i;o++){const i=Math.pow(2,r);t.push(i);let s=1/i;o>e-4?s=$T[o-e+4-1]:0===o&&(s=0),a.push(s);const l=1/(i-2),c=-l,u=1+l,d=[c,c,u,c,u,u,c,c,u,u,c,u],h=6,p=6,f=3,m=2,v=1,g=new Float32Array(f*p*h),y=new Float32Array(m*p*h),b=new Float32Array(v*p*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,a=e>2?0:-1,n=[t,a,0,t+2/3,a,0,t+2/3,a+1,0,t,a,0,t+2/3,a+1,0,t,a+1,0];g.set(n,f*p*e),y.set(d,m*p*e);const r=[e,e,e,e,e,e];b.set(r,v*p*e)}const x=new hS;x.setAttribute("position",new tS(g,f)),x.setAttribute("uv",new tS(y,m)),x.setAttribute("faceIndex",new tS(b,v)),n.push(new MS(x,null)),r>4&&r--}return{lodMeshes:n,sizeLods:t,sigmas:a}}(n)),this._blurMaterial=function(e,t,a){const n=new Float32Array(KT),r=new rw(0,1,0),i=new RS({name:"SphericalGaussianBlur",defines:{n:KT,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/a,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:ck(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return i}(n,e,t),this._ggxMaterial=function(e,t,a){const n=new RS({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/a,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:ck(),fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:0,depthTest:!1,depthWrite:!1});return n}(n,e,t)}return n}_compileMaterial(e){const t=new MS(new hS,e);this._renderer.compile(t,ZT)}_sceneToCubeUV(e,t,a,n,r){const i=new OS(90,1,t,a),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(JT),l.toneMapping=0,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(n),l.clearDepth(),l.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new MS(new kS,new Z_({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1})));const d=this._backgroundBox,h=d.material;let p=!1;const f=e.background;f?f.isColor&&(h.color.copy(f),e.background=null,p=!0):(h.color.copy(JT),p=!0);for(let m=0;m<6;m++){const t=m%3;0===t?(i.up.set(0,o[m],0),i.position.set(r.x,r.y,r.z),i.lookAt(r.x+s[m],r.y,r.z)):1===t?(i.up.set(0,0,o[m]),i.position.set(r.x,r.y,r.z),i.lookAt(r.x,r.y+s[m],r.z)):(i.up.set(0,o[m],0),i.position.set(r.x,r.y,r.z),i.lookAt(r.x,r.y,r.z+s[m]));const a=this._cubeSize;ok(n,t*a,m>2?a:0,a,a),l.setRenderTarget(n),p&&l.render(d,i),l.render(e,i)}l.toneMapping=u,l.autoClear=c,e.background=f}_textureToCubeUV(e,t){const a=this._renderer,n=e.mapping===ib||e.mapping===ob;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=lk()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=sk());const r=n?this._cubemapMaterial:this._equirectMaterial,i=this._lodMeshes[0];i.material=r;r.uniforms.envMap.value=e;const o=this._cubeSize;ok(t,0,0,3*o,2*o),a.setRenderTarget(t),a.render(i,ZT)}_applyPMREM(e){const t=this._renderer,a=t.autoClear;t.autoClear=!1;const n=this._lodMeshes.length;for(let r=1;r<n;r++)this._applyGGXFilter(e,r-1,r);t.autoClear=a}_applyGGXFilter(e,t,a){const n=this._renderer,r=this._pingPongRenderTarget,i=this._ggxMaterial,o=this._lodMeshes[a];o.material=i;const s=i.uniforms,l=a/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),u=Math.sqrt(l*l-c*c)*(0+1.25*l),{_lodMax:d}=this,h=this._sizeLods[a],p=3*h*(a>d-4?a-d+4:0),f=4*(this._cubeSize-h);s.envMap.value=e.texture,s.roughness.value=u,s.mipInt.value=d-t,ok(r,p,f,3*h,2*h),n.setRenderTarget(r),n.render(o,ZT),s.envMap.value=r.texture,s.roughness.value=0,s.mipInt.value=d-a,ok(e,p,f,3*h,2*h),n.setRenderTarget(e),n.render(o,ZT)}_blur(e,t,a,n,r){const i=this._pingPongRenderTarget;this._halfBlur(e,i,t,a,n,"latitudinal",r),this._halfBlur(i,e,a,a,n,"longitudinal",r)}_halfBlur(e,t,a,n,r,i,o){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&Wx("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[n];c.material=l;const u=l.uniforms,d=this._sizeLods[a]-1,h=isFinite(r)?Math.PI/(2*d):2*Math.PI/39,p=r/h,f=isFinite(r)?1+Math.floor(3*p):KT;f>KT&&Gx(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let v=0;for(let b=0;b<KT;++b){const e=b/p,t=Math.exp(-e*e/2);m.push(t),0===b?v+=t:b<f&&(v+=2*t)}for(let b=0;b<m.length;b++)m[b]=m[b]/v;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===i,o&&(u.poleAxis.value=o);const{_lodMax:g}=this;u.dTheta.value=h,u.mipInt.value=g-a;const y=this._sizeLods[n];ok(t,3*y*(n>g-4?n-g+4:0),4*(this._cubeSize-y),3*y,2*y),s.setRenderTarget(t),s.render(c,ZT)}}function ik(e,t,a){const n=new Tw(e,t,a);return n.texture.mapping=sb,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function ok(e,t,a,n,r){e.viewport.set(t,a,n,r),e.scissor.set(t,a,n,r)}function sk(){return new RS({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ck(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function lk(){return new RS({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ck(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function ck(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function uk(e){let t=new WeakMap,a=null;function n(e){const a=e.target;a.removeEventListener("dispose",n);const r=t.get(a);void 0!==r&&(t.delete(a),r.dispose())}return{get:function(r){if(r&&r.isTexture){const i=r.mapping,o=303===i||304===i,s=i===ib||i===ob;if(o||s){let i=t.get(r);const l=void 0!==i?i.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===a&&(a=new rk(e)),i=o?a.fromEquirectangular(r,i):a.fromCubemap(r,i),i.texture.pmremVersion=r.pmremVersion,t.set(r,i),i.texture;if(void 0!==i)return i.texture;{const l=r.image;return o&&l&&l.height>0||s&&l&&function(e){let t=0;const a=6;for(let n=0;n<a;n++)void 0!==e[n]&&t++;return t===a}(l)?(null===a&&(a=new rk(e)),i=o?a.fromEquirectangular(r):a.fromCubemap(r),i.texture.pmremVersion=r.pmremVersion,t.set(r,i),r.addEventListener("dispose",n),i.texture):null}}}return r},dispose:function(){t=new WeakMap,null!==a&&(a.dispose(),a=null)}}}function dk(e){const t={};function a(a){if(void 0!==t[a])return t[a];const n=e.getExtension(a);return t[a]=n,n}return{has:function(e){return null!==a(e)},init:function(){a("EXT_color_buffer_float"),a("WEBGL_clip_cull_distance"),a("OES_texture_float_linear"),a("EXT_color_buffer_half_float"),a("WEBGL_multisampled_render_to_texture"),a("WEBGL_render_shared_exponent")},get:function(e){const t=a(e);return null===t&&qx("WebGLRenderer: "+e+" extension not supported."),t}}}function hk(e,t,a,n){const r={},i=new WeakMap;function o(e){const s=e.target;null!==s.index&&t.remove(s.index);for(const a in s.attributes)t.remove(s.attributes[a]);s.removeEventListener("dispose",o),delete r[s.id];const l=i.get(s);l&&(t.remove(l),i.delete(s)),n.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,a.memory.geometries--}function s(e){const a=[],n=e.index,r=e.attributes.position;let o=0;if(null!==n){const e=n.array;o=n.version;for(let t=0,n=e.length;t<n;t+=3){const n=e[t+0],r=e[t+1],i=e[t+2];a.push(n,r,r,i,i,n)}}else{if(void 0===r)return;{const e=r.array;o=r.version;for(let t=0,n=e.length/3-1;t<n;t+=3){const e=t+0,n=t+1,r=t+2;a.push(e,n,n,r,r,e)}}}const s=new(Bx(a)?nS:aS)(a,1);s.version=o;const l=i.get(e);l&&t.remove(l),i.set(e,s)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",o),r[t.id]=!0,a.memory.geometries++),t},update:function(a){const n=a.attributes;for(const r in n)t.update(n[r],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=i.get(e);if(t){const a=e.index;null!==a&&t.version<a.version&&s(e)}else s(e);return i.get(e)}}}function pk(e,t,a){let n,r,i;function o(t,o,s){0!==s&&(e.drawElementsInstanced(n,o,r,t*i,s),a.update(o,n,s))}this.setMode=function(e){n=e},this.setIndex=function(e){r=e.type,i=e.bytesPerElement},this.render=function(t,o){e.drawElements(n,o,r,t*i),a.update(o,n,1)},this.renderInstances=o,this.renderMultiDraw=function(e,i,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,i,0,r,e,0,o);let s=0;for(let t=0;t<o;t++)s+=i[t];a.update(s,n,1)},this.renderMultiDrawInstances=function(e,s,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)o(e[t]/i,s[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(n,s,0,r,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=s[e]*c[e];a.update(t,n,1)}}}function fk(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(a,n,r){switch(t.calls++,n){case e.TRIANGLES:t.triangles+=r*(a/3);break;case e.LINES:t.lines+=r*(a/2);break;case e.LINE_STRIP:t.lines+=r*(a-1);break;case e.LINE_LOOP:t.lines+=r*a;break;case e.POINTS:t.points+=r*a;break;default:Wx("WebGLInfo: Unknown draw mode:",n)}}}}function mk(e,t,a){const n=new WeakMap,r=new Sw;return{update:function(i,o,s){const l=i.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,u=void 0!==c?c.length:0;let d=n.get(o);if(void 0===d||d.count!==u){void 0!==d&&d.texture.dispose();const h=void 0!==o.morphAttributes.position,p=void 0!==o.morphAttributes.normal,f=void 0!==o.morphAttributes.color,m=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],g=o.morphAttributes.color||[];let y=0;!0===h&&(y=1),!0===p&&(y=2),!0===f&&(y=3);let b=o.attributes.position.count*y,x=1;b>t.maxTextureSize&&(x=Math.ceil(b/t.maxTextureSize),b=t.maxTextureSize);const w=new Float32Array(b*x*4*u),_=new kw(w,b,x,u);_.type=Sb,_.needsUpdate=!0;const S=4*y;for(let T=0;T<u;T++){const k=m[T],C=v[T],A=g[T],E=b*x*4*T;for(let I=0;I<k.count;I++){const R=I*S;!0===h&&(r.fromBufferAttribute(k,I),w[E+R+0]=r.x,w[E+R+1]=r.y,w[E+R+2]=r.z,w[E+R+3]=0),!0===p&&(r.fromBufferAttribute(C,I),w[E+R+4]=r.x,w[E+R+5]=r.y,w[E+R+6]=r.z,w[E+R+7]=0),!0===f&&(r.fromBufferAttribute(A,I),w[E+R+8]=r.x,w[E+R+9]=r.y,w[E+R+10]=r.z,w[E+R+11]=4===A.itemSize?r.w:1)}}function M(){_.dispose(),n.delete(o),o.removeEventListener("dispose",M)}d={count:u,texture:_,size:new aw(b,x)},n.set(o,d),o.addEventListener("dispose",M)}if(!0===i.isInstancedMesh&&null!==i.morphTexture)s.getUniforms().setValue(e,"morphTexture",i.morphTexture,a);else{let D=0;for(let L=0;L<l.length;L++)D+=l[L];const P=o.morphTargetsRelative?1:1-D;s.getUniforms().setValue(e,"morphTargetBaseInfluence",P),s.getUniforms().setValue(e,"morphTargetInfluences",l)}s.getUniforms().setValue(e,"morphTargetsTexture",d.texture,a),s.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function vk(e,t,a,n){let r=new WeakMap;function i(e){const t=e.target;t.removeEventListener("dispose",i),a.remove(t.instanceMatrix),null!==t.instanceColor&&a.remove(t.instanceColor)}return{update:function(o){const s=n.render.frame,l=o.geometry,c=t.get(o,l);if(r.get(c)!==s&&(t.update(c),r.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",i)&&o.addEventListener("dispose",i),r.get(o)!==s&&(a.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&a.update(o.instanceColor,e.ARRAY_BUFFER),r.set(o,s))),o.isSkinnedMesh){const e=o.skeleton;r.get(e)!==s&&(e.update(),r.set(e,s))}return c},dispose:function(){r=new WeakMap}}}const gk={[Jy]:"LINEAR_TONE_MAPPING",[Qy]:"REINHARD_TONE_MAPPING",[eb]:"CINEON_TONE_MAPPING",[tb]:"ACES_FILMIC_TONE_MAPPING",[nb]:"AGX_TONE_MAPPING",[rb]:"NEUTRAL_TONE_MAPPING",[ab]:"CUSTOM_TONE_MAPPING"};function yk(e,t,a,n,r){const i=new Tw(t,a,{type:e,depthBuffer:n,stencilBuffer:r}),o=new Tw(t,a,{type:Mb,depthBuffer:!1,stencilBuffer:!1}),s=new hS;s.setAttribute("position",new rS([-1,3,0,-1,-1,0,3,-1,0],3)),s.setAttribute("uv",new rS([0,2,0,0,2,0],2));const l=new sT({uniforms:{tDiffuse:{value:null}},vertexShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main() {\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t}",fragmentShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform sampler2D tDiffuse;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\t#include <tonemapping_pars_fragment>\n\t\t\t#include <colorspace_pars_fragment>\n\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t\t#ifdef LINEAR_TONE_MAPPING\n\t\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( AGX_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef SRGB_TRANSFER\n\t\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\t\t\t\t#endif\n\t\t\t}",depthTest:!1,depthWrite:!1}),c=new MS(s,l),u=new yT(-1,1,1,-1,0,1);let d,h=null,p=null,f=!1,m=null,v=[],g=!1;this.setSize=function(e,t){i.setSize(e,t),o.setSize(e,t);for(let a=0;a<v.length;a++){const n=v[a];n.setSize&&n.setSize(e,t)}},this.setEffects=function(e){v=e,g=v.length>0&&!0===v[0].isRenderPass;const t=i.width,a=i.height;for(let n=0;n<v.length;n++){const e=v[n];e.setSize&&e.setSize(t,a)}},this.begin=function(e,t){if(f)return!1;if(0===e.toneMapping&&0===v.length)return!1;if(m=t,null!==t){const e=t.width,a=t.height;i.width===e&&i.height===a||this.setSize(e,a)}return!1===g&&e.setRenderTarget(i),d=e.toneMapping,e.toneMapping=0,!0},this.hasRenderPass=function(){return g},this.end=function(e,t){e.toneMapping=d,f=!0;let a=i,n=o;for(let r=0;r<v.length;r++){const i=v[r];if(!1!==i.enabled&&(i.render(e,n,a,t),!1!==i.needsSwap)){const e=a;a=n,n=e}}if(h!==e.outputColorSpace||p!==e.toneMapping){h=e.outputColorSpace,p=e.toneMapping,l.defines={},hw.getTransfer(h)===Mx&&(l.defines.SRGB_TRANSFER="");const t=gk[p];t&&(l.defines[t]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=a.texture,e.setRenderTarget(m),e.render(c,u),m=null,f=!1},this.isCompositing=function(){return f},this.dispose=function(){i.dispose(),o.dispose(),s.dispose(),l.dispose()}}const bk=new _w,xk=new VM(1,1),wk=new kw,_k=new Cw,Sk=new US,Mk=[],Tk=[],kk=new Float32Array(16),Ck=new Float32Array(9),Ak=new Float32Array(4);function Ek(e,t,a){const n=e[0];if(n<=0||n>0)return e;const r=t*a;let i=Mk[r];if(void 0===i&&(i=new Float32Array(r),Mk[r]=i),0!==t){n.toArray(i,0);for(let n=1,r=0;n!==t;++n)r+=a,e[n].toArray(i,r)}return i}function Ik(e,t){if(e.length!==t.length)return!1;for(let a=0,n=e.length;a<n;a++)if(e[a]!==t[a])return!1;return!0}function Rk(e,t){for(let a=0,n=t.length;a<n;a++)e[a]=t[a]}function Dk(e,t){let a=Tk[t];void 0===a&&(a=new Int32Array(t),Tk[t]=a);for(let n=0;n!==t;++n)a[n]=e.allocateTextureUnit();return a}function Pk(e,t){const a=this.cache;a[0]!==t&&(e.uniform1f(this.addr,t),a[0]=t)}function Lk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),a[0]=t.x,a[1]=t.y);else{if(Ik(a,t))return;e.uniform2fv(this.addr,t),Rk(a,t)}}function Nk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y&&a[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),a[0]=t.x,a[1]=t.y,a[2]=t.z);else if(void 0!==t.r)a[0]===t.r&&a[1]===t.g&&a[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),a[0]=t.r,a[1]=t.g,a[2]=t.b);else{if(Ik(a,t))return;e.uniform3fv(this.addr,t),Rk(a,t)}}function Ok(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y&&a[2]===t.z&&a[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=t.w);else{if(Ik(a,t))return;e.uniform4fv(this.addr,t),Rk(a,t)}}function Fk(e,t){const a=this.cache,n=t.elements;if(void 0===n){if(Ik(a,t))return;e.uniformMatrix2fv(this.addr,!1,t),Rk(a,t)}else{if(Ik(a,n))return;Ak.set(n),e.uniformMatrix2fv(this.addr,!1,Ak),Rk(a,n)}}function Bk(e,t){const a=this.cache,n=t.elements;if(void 0===n){if(Ik(a,t))return;e.uniformMatrix3fv(this.addr,!1,t),Rk(a,t)}else{if(Ik(a,n))return;Ck.set(n),e.uniformMatrix3fv(this.addr,!1,Ck),Rk(a,n)}}function Uk(e,t){const a=this.cache,n=t.elements;if(void 0===n){if(Ik(a,t))return;e.uniformMatrix4fv(this.addr,!1,t),Rk(a,t)}else{if(Ik(a,n))return;kk.set(n),e.uniformMatrix4fv(this.addr,!1,kk),Rk(a,n)}}function zk(e,t){const a=this.cache;a[0]!==t&&(e.uniform1i(this.addr,t),a[0]=t)}function Vk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),a[0]=t.x,a[1]=t.y);else{if(Ik(a,t))return;e.uniform2iv(this.addr,t),Rk(a,t)}}function Hk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y&&a[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),a[0]=t.x,a[1]=t.y,a[2]=t.z);else{if(Ik(a,t))return;e.uniform3iv(this.addr,t),Rk(a,t)}}function Gk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y&&a[2]===t.z&&a[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=t.w);else{if(Ik(a,t))return;e.uniform4iv(this.addr,t),Rk(a,t)}}function Wk(e,t){const a=this.cache;a[0]!==t&&(e.uniform1ui(this.addr,t),a[0]=t)}function qk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),a[0]=t.x,a[1]=t.y);else{if(Ik(a,t))return;e.uniform2uiv(this.addr,t),Rk(a,t)}}function Yk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y&&a[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),a[0]=t.x,a[1]=t.y,a[2]=t.z);else{if(Ik(a,t))return;e.uniform3uiv(this.addr,t),Rk(a,t)}}function jk(e,t){const a=this.cache;if(void 0!==t.x)a[0]===t.x&&a[1]===t.y&&a[2]===t.z&&a[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=t.w);else{if(Ik(a,t))return;e.uniform4uiv(this.addr,t),Rk(a,t)}}function Xk(e,t,a){const n=this.cache,r=a.allocateTextureUnit();let i;n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),this.type===e.SAMPLER_2D_SHADOW?(xk.compareFunction=a.isReversedDepthBuffer()?518:515,i=xk):i=bk,a.setTexture2D(t||i,r)}function $k(e,t,a){const n=this.cache,r=a.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),a.setTexture3D(t||_k,r)}function Kk(e,t,a){const n=this.cache,r=a.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),a.setTextureCube(t||Sk,r)}function Zk(e,t,a){const n=this.cache,r=a.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),a.setTexture2DArray(t||wk,r)}function Jk(e,t){e.uniform1fv(this.addr,t)}function Qk(e,t){const a=Ek(t,this.size,2);e.uniform2fv(this.addr,a)}function eC(e,t){const a=Ek(t,this.size,3);e.uniform3fv(this.addr,a)}function tC(e,t){const a=Ek(t,this.size,4);e.uniform4fv(this.addr,a)}function aC(e,t){const a=Ek(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,a)}function nC(e,t){const a=Ek(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,a)}function rC(e,t){const a=Ek(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,a)}function iC(e,t){e.uniform1iv(this.addr,t)}function oC(e,t){e.uniform2iv(this.addr,t)}function sC(e,t){e.uniform3iv(this.addr,t)}function lC(e,t){e.uniform4iv(this.addr,t)}function cC(e,t){e.uniform1uiv(this.addr,t)}function uC(e,t){e.uniform2uiv(this.addr,t)}function dC(e,t){e.uniform3uiv(this.addr,t)}function hC(e,t){e.uniform4uiv(this.addr,t)}function pC(e,t,a){const n=this.cache,r=t.length,i=Dk(a,r);let o;Ik(n,i)||(e.uniform1iv(this.addr,i),Rk(n,i)),o=this.type===e.SAMPLER_2D_SHADOW?xk:bk;for(let s=0;s!==r;++s)a.setTexture2D(t[s]||o,i[s])}function fC(e,t,a){const n=this.cache,r=t.length,i=Dk(a,r);Ik(n,i)||(e.uniform1iv(this.addr,i),Rk(n,i));for(let o=0;o!==r;++o)a.setTexture3D(t[o]||_k,i[o])}function mC(e,t,a){const n=this.cache,r=t.length,i=Dk(a,r);Ik(n,i)||(e.uniform1iv(this.addr,i),Rk(n,i));for(let o=0;o!==r;++o)a.setTextureCube(t[o]||Sk,i[o])}function vC(e,t,a){const n=this.cache,r=t.length,i=Dk(a,r);Ik(n,i)||(e.uniform1iv(this.addr,i),Rk(n,i));for(let o=0;o!==r;++o)a.setTexture2DArray(t[o]||wk,i[o])}class gC{constructor(e,t,a){this.id=e,this.addr=a,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return Pk;case 35664:return Lk;case 35665:return Nk;case 35666:return Ok;case 35674:return Fk;case 35675:return Bk;case 35676:return Uk;case 5124:case 35670:return zk;case 35667:case 35671:return Vk;case 35668:case 35672:return Hk;case 35669:case 35673:return Gk;case 5125:return Wk;case 36294:return qk;case 36295:return Yk;case 36296:return jk;case 35678:case 36198:case 36298:case 36306:case 35682:return Xk;case 35679:case 36299:case 36307:return $k;case 35680:case 36300:case 36308:case 36293:return Kk;case 36289:case 36303:case 36311:case 36292:return Zk}}(t.type)}}class yC{constructor(e,t,a){this.id=e,this.addr=a,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Jk;case 35664:return Qk;case 35665:return eC;case 35666:return tC;case 35674:return aC;case 35675:return nC;case 35676:return rC;case 5124:case 35670:return iC;case 35667:case 35671:return oC;case 35668:case 35672:return sC;case 35669:case 35673:return lC;case 5125:return cC;case 36294:return uC;case 36295:return dC;case 36296:return hC;case 35678:case 36198:case 36298:case 36306:case 35682:return pC;case 35679:case 36299:case 36307:return fC;case 35680:case 36300:case 36308:case 36293:return mC;case 36289:case 36303:case 36311:case 36292:return vC}}(t.type)}}class bC{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,a){const n=this.seq;for(let r=0,i=n.length;r!==i;++r){const i=n[r];i.setValue(e,t[i.id],a)}}}const xC=/(\w+)(\])?(\[|\.)?/g;function wC(e,t){e.seq.push(t),e.map[t.id]=t}function _C(e,t,a){const n=e.name,r=n.length;for(xC.lastIndex=0;;){const i=xC.exec(n),o=xC.lastIndex;let s=i[1];const l="]"===i[2],c=i[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===r){wC(a,void 0===c?new gC(s,e,t):new yC(s,e,t));break}{let e=a.map[s];void 0===e&&(e=new bC(s),wC(a,e)),a=e}}}class SC{constructor(e,t){this.seq=[],this.map={};const a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<a;++i){const a=e.getActiveUniform(t,i);_C(a,e.getUniformLocation(t,a.name),this)}const n=[],r=[];for(const i of this.seq)i.type===e.SAMPLER_2D_SHADOW||i.type===e.SAMPLER_CUBE_SHADOW||i.type===e.SAMPLER_2D_ARRAY_SHADOW?n.push(i):r.push(i);n.length>0&&(this.seq=n.concat(r))}setValue(e,t,a,n){const r=this.map[t];void 0!==r&&r.setValue(e,a,n)}setOptional(e,t,a){const n=t[a];void 0!==n&&this.setValue(e,a,n)}static upload(e,t,a,n){for(let r=0,i=t.length;r!==i;++r){const i=t[r],o=a[i.id];!1!==o.needsUpdate&&i.setValue(e,o.value,n)}}static seqWithValue(e,t){const a=[];for(let n=0,r=e.length;n!==r;++n){const r=e[n];r.id in t&&a.push(r)}return a}}function MC(e,t,a){const n=e.createShader(t);return e.shaderSource(n,a),e.compileShader(n),n}let TC=0;const kC=new sw;function CC(e,t,a){const n=e.getShaderParameter(t,e.COMPILE_STATUS),r=(e.getShaderInfoLog(t)||"").trim();if(n&&""===r)return"";const i=/ERROR: 0:(\d+)/.exec(r);if(i){const n=parseInt(i[1]);return a.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const a=e.split("\n"),n=[],r=Math.max(t-6,0),i=Math.min(t+6,a.length);for(let o=r;o<i;o++){const e=o+1;n.push(`${e===t?">":" "} ${e}: ${a[o]}`)}return n.join("\n")}(e.getShaderSource(t),n)}return r}function AC(e,t){const a=function(e){hw._getMatrix(kC,hw.workingColorSpace,e);const t=`mat3( ${kC.elements.map(e=>e.toFixed(4))} )`;switch(hw.getTransfer(e)){case Sx:return[t,"LinearTransferOETF"];case Mx:return[t,"sRGBTransferOETF"];default:return Gx("WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${a[1]}( vec4( value.rgb * ${a[0]}, value.a ) );`,"}"].join("\n")}const EC={[Jy]:"Linear",[Qy]:"Reinhard",[eb]:"Cineon",[tb]:"ACESFilmic",[nb]:"AgX",[rb]:"Neutral",[ab]:"Custom"};function IC(e,t){const a=EC[t];return void 0===a?(Gx("WebGLProgram: Unsupported toneMapping:",t),"vec3 "+e+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+e+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}const RC=new rw;function DC(){hw.getLuminanceCoefficients(RC);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${RC.x.toFixed(4)}, ${RC.y.toFixed(4)}, ${RC.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function PC(e){return""!==e}function LC(e,t){const a=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,a).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function NC(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const OC=/^[ \t]*#include +<([\w\d./]+)>/gm;function FC(e){return e.replace(OC,UC)}const BC=new Map;function UC(e,t){let a=FT[t];if(void 0===a){const e=BC.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");a=FT[e],Gx('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return FC(a)}const zC=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function VC(e){return e.replace(zC,HC)}function HC(e,t,a,n){let r="";for(let i=parseInt(t);i<parseInt(a);i++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return r}function GC(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}const WC={[yy]:"SHADOWMAP_TYPE_PCF",[by]:"SHADOWMAP_TYPE_VSM"};const qC={[ib]:"ENVMAP_TYPE_CUBE",[ob]:"ENVMAP_TYPE_CUBE",[sb]:"ENVMAP_TYPE_CUBE_UV"};const YC={[ob]:"ENVMAP_MODE_REFRACTION"};const jC={[$y]:"ENVMAP_BLENDING_MULTIPLY",[Ky]:"ENVMAP_BLENDING_MIX",[Zy]:"ENVMAP_BLENDING_ADD"};function XC(e,t,a,n){const r=e.getContext(),i=a.defines;let o=a.vertexShader,s=a.fragmentShader;const l=function(e){return WC[e.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}(a),c=function(e){return!1===e.envMap?"ENVMAP_TYPE_CUBE":qC[e.envMapMode]||"ENVMAP_TYPE_CUBE"}(a),u=function(e){return!1===e.envMap?"ENVMAP_MODE_REFLECTION":YC[e.envMapMode]||"ENVMAP_MODE_REFLECTION"}(a),d=function(e){return!1===e.envMap?"ENVMAP_BLENDING_NONE":jC[e.combine]||"ENVMAP_BLENDING_NONE"}(a),h=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const a=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,a),112)),texelHeight:n,maxMip:a}}(a),p=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(PC).join("\n")}(a),f=function(e){const t=[];for(const a in e){const n=e[a];!1!==n&&t.push("#define "+a+" "+n)}return t.join("\n")}(i),m=r.createProgram();let v,g,y=a.glslVersion?"#version "+a.glslVersion+"\n":"";a.isRawShaderMaterial?(v=["#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,f].filter(PC).join("\n"),v.length>0&&(v+="\n"),g=["#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,f].filter(PC).join("\n"),g.length>0&&(g+="\n")):(v=[GC(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,f,a.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",a.batching?"#define USE_BATCHING":"",a.batchingColor?"#define USE_BATCHING_COLOR":"",a.instancing?"#define USE_INSTANCING":"",a.instancingColor?"#define USE_INSTANCING_COLOR":"",a.instancingMorph?"#define USE_INSTANCING_MORPH":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+u:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.displacementMap?"#define USE_DISPLACEMENTMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.mapUv?"#define MAP_UV "+a.mapUv:"",a.alphaMapUv?"#define ALPHAMAP_UV "+a.alphaMapUv:"",a.lightMapUv?"#define LIGHTMAP_UV "+a.lightMapUv:"",a.aoMapUv?"#define AOMAP_UV "+a.aoMapUv:"",a.emissiveMapUv?"#define EMISSIVEMAP_UV "+a.emissiveMapUv:"",a.bumpMapUv?"#define BUMPMAP_UV "+a.bumpMapUv:"",a.normalMapUv?"#define NORMALMAP_UV "+a.normalMapUv:"",a.displacementMapUv?"#define DISPLACEMENTMAP_UV "+a.displacementMapUv:"",a.metalnessMapUv?"#define METALNESSMAP_UV "+a.metalnessMapUv:"",a.roughnessMapUv?"#define ROUGHNESSMAP_UV "+a.roughnessMapUv:"",a.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+a.anisotropyMapUv:"",a.clearcoatMapUv?"#define CLEARCOATMAP_UV "+a.clearcoatMapUv:"",a.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+a.clearcoatNormalMapUv:"",a.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+a.clearcoatRoughnessMapUv:"",a.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+a.iridescenceMapUv:"",a.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+a.iridescenceThicknessMapUv:"",a.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+a.sheenColorMapUv:"",a.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+a.sheenRoughnessMapUv:"",a.specularMapUv?"#define SPECULARMAP_UV "+a.specularMapUv:"",a.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+a.specularColorMapUv:"",a.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+a.specularIntensityMapUv:"",a.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+a.transmissionMapUv:"",a.thicknessMapUv?"#define THICKNESSMAP_UV "+a.thicknessMapUv:"",a.vertexTangents&&!1===a.flatShading?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.morphColors?"#define USE_MORPHCOLORS":"",a.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+a.morphTextureStride:"",a.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+a.morphTargetsCount:"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",a.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(PC).join("\n"),g=[GC(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,f,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+c:"",a.envMap?"#define "+u:"",a.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoat?"#define USE_CLEARCOAT":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.dispersion?"#define USE_DISPERSION":"",a.iridescence?"#define USE_IRIDESCENCE":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaTest?"#define USE_ALPHATEST":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.sheen?"#define USE_SHEEN":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.vertexTangents&&!1===a.flatShading?"#define USE_TANGENT":"",a.vertexColors||a.instancingColor||a.batchingColor?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",a.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",a.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",a.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==a.toneMapping?"#define TONE_MAPPING":"",0!==a.toneMapping?FT.tonemapping_pars_fragment:"",0!==a.toneMapping?IC("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.opaque?"#define OPAQUE":"",FT.colorspace_pars_fragment,AC("linearToOutputTexel",a.outputColorSpace),DC(),a.useDepthPacking?"#define DEPTH_PACKING "+a.depthPacking:"","\n"].filter(PC).join("\n")),o=FC(o),o=LC(o,a),o=NC(o,a),s=FC(s),s=LC(s,a),s=NC(s,a),o=VC(o),s=VC(s),!0!==a.isRawShaderMaterial&&(y="#version 300 es\n",v=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,g=["#define varying in",a.glslVersion===Nx?"":"layout(location = 0) out highp vec4 pc_fragColor;",a.glslVersion===Nx?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const b=y+v+o,x=y+g+s,w=MC(r,r.VERTEX_SHADER,b),_=MC(r,r.FRAGMENT_SHADER,x);function S(t){if(e.debug.checkShaderErrors){const a=r.getProgramInfoLog(m)||"",n=r.getShaderInfoLog(w)||"",i=r.getShaderInfoLog(_)||"",o=a.trim(),s=n.trim(),l=i.trim();let c=!0,u=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS))if(c=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(r,m,w,_);else{const e=CC(r,w,"vertex"),a=CC(r,_,"fragment");Wx("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+o+"\n"+e+"\n"+a)}else""!==o?Gx("WebGLProgram: Program Info Log:",o):""!==s&&""!==l||(u=!1);u&&(t.diagnostics={runnable:c,programLog:o,vertexShader:{log:s,prefix:v},fragmentShader:{log:l,prefix:g}})}r.deleteShader(w),r.deleteShader(_),M=new SC(r,m),T=function(e,t){const a={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const n=e.getActiveAttrib(t,r),i=n.name;let o=1;n.type===e.FLOAT_MAT2&&(o=2),n.type===e.FLOAT_MAT3&&(o=3),n.type===e.FLOAT_MAT4&&(o=4),a[i]={type:n.type,location:e.getAttribLocation(t,i),locationSize:o}}return a}(r,m)}let M,T;r.attachShader(m,w),r.attachShader(m,_),void 0!==a.index0AttributeName?r.bindAttribLocation(m,0,a.index0AttributeName):!0===a.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),this.getUniforms=function(){return void 0===M&&S(this),M},this.getAttributes=function(){return void 0===T&&S(this),T};let k=!1===a.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===k&&(k=r.getProgramParameter(m,37297)),k},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.type=a.shaderType,this.name=a.shaderName,this.id=TC++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=_,this}let $C=0;class KC{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,a=e.fragmentShader,n=this._getShaderStage(t),r=this._getShaderStage(a),i=this._getShaderCacheForMaterial(e);return!1===i.has(n)&&(i.add(n),n.usedTimes++),!1===i.has(r)&&(i.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const a of t)a.usedTimes--,0===a.usedTimes&&this.shaderCache.delete(a.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let a=t.get(e);return void 0===a&&(a=new Set,t.set(e,a)),a}_getShaderStage(e){const t=this.shaderCache;let a=t.get(e);return void 0===a&&(a=new ZC(e),t.set(e,a)),a}}class ZC{constructor(e){this.id=$C++,this.code=e,this.usedTimes=0}}function JC(e,t,a,n,r,i,o){const s=new h_,l=new KC,c=new Set,u=[],d=new Map,h=r.logarithmicDepthBuffer;let p=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return c.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(i,s,u,d,v){const g=d.fog,y=v.geometry,b=i.isMeshStandardMaterial?d.environment:null,x=(i.isMeshStandardMaterial?a:t).get(i.envMap||b),w=x&&x.mapping===sb?x.image.height:null,_=f[i.type];null!==i.precision&&(p=r.getMaxPrecision(i.precision),p!==i.precision&&Gx("WebGLProgram.getParameters:",i.precision,"not supported, using",p,"instead."));const S=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,M=void 0!==S?S.length:0;let T,k,C,A,E=0;if(void 0!==y.morphAttributes.position&&(E=1),void 0!==y.morphAttributes.normal&&(E=2),void 0!==y.morphAttributes.color&&(E=3),_){const e=UT[_];T=e.vertexShader,k=e.fragmentShader}else T=i.vertexShader,k=i.fragmentShader,l.update(i),C=l.getVertexShaderID(i),A=l.getFragmentShaderID(i);const I=e.getRenderTarget(),R=e.state.buffers.depth.getReversed(),D=!0===v.isInstancedMesh,P=!0===v.isBatchedMesh,L=!!i.map,N=!!i.matcap,O=!!x,F=!!i.aoMap,B=!!i.lightMap,U=!!i.bumpMap,z=!!i.normalMap,V=!!i.displacementMap,H=!!i.emissiveMap,G=!!i.metalnessMap,W=!!i.roughnessMap,q=i.anisotropy>0,Y=i.clearcoat>0,j=i.dispersion>0,X=i.iridescence>0,$=i.sheen>0,K=i.transmission>0,Z=q&&!!i.anisotropyMap,J=Y&&!!i.clearcoatMap,Q=Y&&!!i.clearcoatNormalMap,ee=Y&&!!i.clearcoatRoughnessMap,te=X&&!!i.iridescenceMap,ae=X&&!!i.iridescenceThicknessMap,ne=$&&!!i.sheenColorMap,re=$&&!!i.sheenRoughnessMap,ie=!!i.specularMap,oe=!!i.specularColorMap,se=!!i.specularIntensityMap,le=K&&!!i.transmissionMap,ce=K&&!!i.thicknessMap,ue=!!i.gradientMap,de=!!i.alphaMap,he=i.alphaTest>0,pe=!!i.alphaHash,fe=!!i.extensions;let me=0;i.toneMapped&&(null!==I&&!0!==I.isXRRenderTarget||(me=e.toneMapping));const ve={shaderID:_,shaderType:i.type,shaderName:i.name,vertexShader:T,fragmentShader:k,defines:i.defines,customVertexShaderID:C,customFragmentShaderID:A,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:p,batching:P,batchingColor:P&&null!==v._colorsTexture,instancing:D,instancingColor:D&&null!==v.instanceColor,instancingMorph:D&&null!==v.morphTexture,outputColorSpace:null===I?e.outputColorSpace:!0===I.isXRRenderTarget?I.texture.colorSpace:_x,alphaToCoverage:!!i.alphaToCoverage,map:L,matcap:N,envMap:O,envMapMode:O&&x.mapping,envMapCubeUVHeight:w,aoMap:F,lightMap:B,bumpMap:U,normalMap:z,displacementMap:V,emissiveMap:H,normalMapObjectSpace:z&&1===i.normalMapType,normalMapTangentSpace:z&&0===i.normalMapType,metalnessMap:G,roughnessMap:W,anisotropy:q,anisotropyMap:Z,clearcoat:Y,clearcoatMap:J,clearcoatNormalMap:Q,clearcoatRoughnessMap:ee,dispersion:j,iridescence:X,iridescenceMap:te,iridescenceThicknessMap:ae,sheen:$,sheenColorMap:ne,sheenRoughnessMap:re,specularMap:ie,specularColorMap:oe,specularIntensityMap:se,transmission:K,transmissionMap:le,thicknessMap:ce,gradientMap:ue,opaque:!1===i.transparent&&1===i.blending&&!1===i.alphaToCoverage,alphaMap:de,alphaTest:he,alphaHash:pe,combine:i.combine,mapUv:L&&m(i.map.channel),aoMapUv:F&&m(i.aoMap.channel),lightMapUv:B&&m(i.lightMap.channel),bumpMapUv:U&&m(i.bumpMap.channel),normalMapUv:z&&m(i.normalMap.channel),displacementMapUv:V&&m(i.displacementMap.channel),emissiveMapUv:H&&m(i.emissiveMap.channel),metalnessMapUv:G&&m(i.metalnessMap.channel),roughnessMapUv:W&&m(i.roughnessMap.channel),anisotropyMapUv:Z&&m(i.anisotropyMap.channel),clearcoatMapUv:J&&m(i.clearcoatMap.channel),clearcoatNormalMapUv:Q&&m(i.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&m(i.clearcoatRoughnessMap.channel),iridescenceMapUv:te&&m(i.iridescenceMap.channel),iridescenceThicknessMapUv:ae&&m(i.iridescenceThicknessMap.channel),sheenColorMapUv:ne&&m(i.sheenColorMap.channel),sheenRoughnessMapUv:re&&m(i.sheenRoughnessMap.channel),specularMapUv:ie&&m(i.specularMap.channel),specularColorMapUv:oe&&m(i.specularColorMap.channel),specularIntensityMapUv:se&&m(i.specularIntensityMap.channel),transmissionMapUv:le&&m(i.transmissionMap.channel),thicknessMapUv:ce&&m(i.thicknessMap.channel),alphaMapUv:de&&m(i.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(z||q),vertexColors:i.vertexColors,vertexAlphas:!0===i.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!y.attributes.uv&&(L||de),fog:!!g,useFog:!0===i.fog,fogExp2:!!g&&g.isFogExp2,flatShading:!0===i.flatShading&&!1===i.wireframe,sizeAttenuation:!0===i.sizeAttenuation,logarithmicDepthBuffer:h,reversedDepthBuffer:R,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:M,morphTextureStride:E,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:me,decodeVideoTexture:L&&!0===i.map.isVideoTexture&&hw.getTransfer(i.map.colorSpace)===Mx,decodeVideoTextureEmissive:H&&!0===i.emissiveMap.isVideoTexture&&hw.getTransfer(i.emissiveMap.colorSpace)===Mx,premultipliedAlpha:i.premultipliedAlpha,doubleSided:2===i.side,flipSided:1===i.side,useDepthPacking:i.depthPacking>=0,depthPacking:i.depthPacking||0,index0AttributeName:i.index0AttributeName,extensionClipCullDistance:fe&&!0===i.extensions.clipCullDistance&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(fe&&!0===i.extensions.multiDraw||P)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:i.customProgramCacheKey()};return ve.vertexUv1s=c.has(1),ve.vertexUv2s=c.has(2),ve.vertexUv3s=c.has(3),c.clear(),ve},getProgramCacheKey:function(t){const a=[];if(t.shaderID?a.push(t.shaderID):(a.push(t.customVertexShaderID),a.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)a.push(e),a.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(a,t),function(e,t){s.disableAll(),t.instancing&&s.enable(0);t.instancingColor&&s.enable(1);t.instancingMorph&&s.enable(2);t.matcap&&s.enable(3);t.envMap&&s.enable(4);t.normalMapObjectSpace&&s.enable(5);t.normalMapTangentSpace&&s.enable(6);t.clearcoat&&s.enable(7);t.iridescence&&s.enable(8);t.alphaTest&&s.enable(9);t.vertexColors&&s.enable(10);t.vertexAlphas&&s.enable(11);t.vertexUv1s&&s.enable(12);t.vertexUv2s&&s.enable(13);t.vertexUv3s&&s.enable(14);t.vertexTangents&&s.enable(15);t.anisotropy&&s.enable(16);t.alphaHash&&s.enable(17);t.batching&&s.enable(18);t.dispersion&&s.enable(19);t.batchingColor&&s.enable(20);t.gradientMap&&s.enable(21);e.push(s.mask),s.disableAll(),t.fog&&s.enable(0);t.useFog&&s.enable(1);t.flatShading&&s.enable(2);t.logarithmicDepthBuffer&&s.enable(3);t.reversedDepthBuffer&&s.enable(4);t.skinning&&s.enable(5);t.morphTargets&&s.enable(6);t.morphNormals&&s.enable(7);t.morphColors&&s.enable(8);t.premultipliedAlpha&&s.enable(9);t.shadowMapEnabled&&s.enable(10);t.doubleSided&&s.enable(11);t.flipSided&&s.enable(12);t.useDepthPacking&&s.enable(13);t.dithering&&s.enable(14);t.transmission&&s.enable(15);t.sheen&&s.enable(16);t.opaque&&s.enable(17);t.pointsUvs&&s.enable(18);t.decodeVideoTexture&&s.enable(19);t.decodeVideoTextureEmissive&&s.enable(20);t.alphaToCoverage&&s.enable(21);e.push(s.mask)}(a,t),a.push(e.outputColorSpace)),a.push(t.customProgramCacheKey),a.join()},getUniforms:function(e){const t=f[e.type];let a;if(t){const e=UT[t];a=IS.clone(e.uniforms)}else a=e.uniforms;return a},acquireProgram:function(t,a){let n=d.get(a);return void 0!==n?++n.usedTimes:(n=new XC(e,a,t,i),u.push(n),d.set(a,n)),n},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),d.delete(e.cacheKey),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function QC(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let a=e.get(t);return void 0===a&&(a={},e.set(t,a)),a},remove:function(t){e.delete(t)},update:function(t,a,n){e.get(t)[a]=n},dispose:function(){e=new WeakMap}}}function eA(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function tA(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function aA(){const e=[];let t=0;const a=[],n=[],r=[];function i(a,n,r,i,o,s){let l=e[t];return void 0===l?(l={id:a.id,object:a,geometry:n,material:r,groupOrder:i,renderOrder:a.renderOrder,z:o,group:s},e[t]=l):(l.id=a.id,l.object=a,l.geometry=n,l.material=r,l.groupOrder=i,l.renderOrder=a.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:a,transmissive:n,transparent:r,init:function(){t=0,a.length=0,n.length=0,r.length=0},push:function(e,t,o,s,l,c){const u=i(e,t,o,s,l,c);o.transmission>0?n.push(u):!0===o.transparent?r.push(u):a.push(u)},unshift:function(e,t,o,s,l,c){const u=i(e,t,o,s,l,c);o.transmission>0?n.unshift(u):!0===o.transparent?r.unshift(u):a.unshift(u)},finish:function(){for(let a=t,n=e.length;a<n;a++){const t=e[a];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){a.length>1&&a.sort(e||eA),n.length>1&&n.sort(t||tA),r.length>1&&r.sort(t||tA)}}}function nA(){let e=new WeakMap;return{get:function(t,a){const n=e.get(t);let r;return void 0===n?(r=new aA,e.set(t,[r])):a>=n.length?(r=new aA,n.push(r)):r=n[a],r},dispose:function(){e=new WeakMap}}}function rA(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let a;switch(t.type){case"DirectionalLight":a={direction:new rw,color:new j_};break;case"SpotLight":a={position:new rw,direction:new rw,color:new j_,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":a={position:new rw,color:new j_,distance:0,decay:0};break;case"HemisphereLight":a={direction:new rw,skyColor:new j_,groundColor:new j_};break;case"RectAreaLight":a={color:new j_,position:new rw,halfWidth:new rw,halfHeight:new rw}}return e[t.id]=a,a}}}let iA=0;function oA(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function sA(e){const t=new rA,a=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let a;switch(t.type){case"DirectionalLight":case"SpotLight":a={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new aw};break;case"PointLight":a={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new aw,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=a,a}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let s=0;s<9;s++)n.probe.push(new rw);const r=new rw,i=new t_,o=new t_;return{setup:function(r){let i=0,o=0,s=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let l=0,c=0,u=0,d=0,h=0,p=0,f=0,m=0,v=0,g=0,y=0;r.sort(oA);for(let e=0,x=r.length;e<x;e++){const b=r[e],x=b.color,w=b.intensity,_=b.distance;let S=null;if(b.shadow&&b.shadow.map&&(S=b.shadow.map.texture.format===Lb?b.shadow.map.texture:b.shadow.map.depthTexture||b.shadow.map.texture),b.isAmbientLight)i+=x.r*w,o+=x.g*w,s+=x.b*w;else if(b.isLightProbe){for(let e=0;e<9;e++)n.probe[e].addScaledVector(b.sh.coefficients[e],w);y++}else if(b.isDirectionalLight){const e=t.get(b);if(e.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){const e=b.shadow,t=a.get(b);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,n.directionalShadow[l]=t,n.directionalShadowMap[l]=S,n.directionalShadowMatrix[l]=b.shadow.matrix,p++}n.directional[l]=e,l++}else if(b.isSpotLight){const e=t.get(b);e.position.setFromMatrixPosition(b.matrixWorld),e.color.copy(x).multiplyScalar(w),e.distance=_,e.coneCos=Math.cos(b.angle),e.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),e.decay=b.decay,n.spot[u]=e;const r=b.shadow;if(b.map&&(n.spotLightMap[v]=b.map,v++,r.updateMatrices(b),b.castShadow&&g++),n.spotLightMatrix[u]=r.matrix,b.castShadow){const e=a.get(b);e.shadowIntensity=r.intensity,e.shadowBias=r.bias,e.shadowNormalBias=r.normalBias,e.shadowRadius=r.radius,e.shadowMapSize=r.mapSize,n.spotShadow[u]=e,n.spotShadowMap[u]=S,m++}u++}else if(b.isRectAreaLight){const e=t.get(b);e.color.copy(x).multiplyScalar(w),e.halfWidth.set(.5*b.width,0,0),e.halfHeight.set(0,.5*b.height,0),n.rectArea[d]=e,d++}else if(b.isPointLight){const e=t.get(b);if(e.color.copy(b.color).multiplyScalar(b.intensity),e.distance=b.distance,e.decay=b.decay,b.castShadow){const e=b.shadow,t=a.get(b);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,n.pointShadow[c]=t,n.pointShadowMap[c]=S,n.pointShadowMatrix[c]=b.shadow.matrix,f++}n.point[c]=e,c++}else if(b.isHemisphereLight){const e=t.get(b);e.skyColor.copy(b.color).multiplyScalar(w),e.groundColor.copy(b.groundColor).multiplyScalar(w),n.hemi[h]=e,h++}}d>0&&(!0===e.has("OES_texture_float_linear")?(n.rectAreaLTC1=BT.LTC_FLOAT_1,n.rectAreaLTC2=BT.LTC_FLOAT_2):(n.rectAreaLTC1=BT.LTC_HALF_1,n.rectAreaLTC2=BT.LTC_HALF_2)),n.ambient[0]=i,n.ambient[1]=o,n.ambient[2]=s;const b=n.hash;b.directionalLength===l&&b.pointLength===c&&b.spotLength===u&&b.rectAreaLength===d&&b.hemiLength===h&&b.numDirectionalShadows===p&&b.numPointShadows===f&&b.numSpotShadows===m&&b.numSpotMaps===v&&b.numLightProbes===y||(n.directional.length=l,n.spot.length=u,n.rectArea.length=d,n.point.length=c,n.hemi.length=h,n.directionalShadow.length=p,n.directionalShadowMap.length=p,n.pointShadow.length=f,n.pointShadowMap.length=f,n.spotShadow.length=m,n.spotShadowMap.length=m,n.directionalShadowMatrix.length=p,n.pointShadowMatrix.length=f,n.spotLightMatrix.length=m+v-g,n.spotLightMap.length=v,n.numSpotLightShadowsWithMaps=g,n.numLightProbes=y,b.directionalLength=l,b.pointLength=c,b.spotLength=u,b.rectAreaLength=d,b.hemiLength=h,b.numDirectionalShadows=p,b.numPointShadows=f,b.numSpotShadows=m,b.numSpotMaps=v,b.numLightProbes=y,n.version=iA++)},setupView:function(e,t){let a=0,s=0,l=0,c=0,u=0;const d=t.matrixWorldInverse;for(let h=0,p=e.length;h<p;h++){const t=e[h];if(t.isDirectionalLight){const e=n.directional[a];e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(d),a++}else if(t.isSpotLight){const e=n.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(d),l++}else if(t.isRectAreaLight){const e=n.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),o.identity(),i.copy(t.matrixWorld),i.premultiply(d),o.extractRotation(i),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(t.isPointLight){const e=n.point[s];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(d),s++}else if(t.isHemisphereLight){const e=n.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(d),u++}}},state:n}}function lA(e){const t=new sA(e),a=[],n=[];const r={lightsArray:a,shadowsArray:n,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){r.camera=e,a.length=0,n.length=0},state:r,setupLights:function(){t.setup(a)},setupLightsView:function(e){t.setupView(a,e)},pushLight:function(e){a.push(e)},pushShadow:function(e){n.push(e)}}}function cA(e){let t=new WeakMap;return{get:function(a,n=0){const r=t.get(a);let i;return void 0===r?(i=new lA(e),t.set(a,[i])):n>=r.length?(i=new lA(e),r.push(i)):i=r[n],i},dispose:function(){t=new WeakMap}}}const uA=[new rw(1,0,0),new rw(-1,0,0),new rw(0,1,0),new rw(0,-1,0),new rw(0,0,1),new rw(0,0,-1)],dA=[new rw(0,-1,0),new rw(0,-1,0),new rw(0,0,1),new rw(0,0,-1),new rw(0,-1,0),new rw(0,-1,0)],hA=new t_,pA=new rw,fA=new rw;function mA(e,t,a){let n=new bM;const r=new aw,i=new aw,o=new Sw,s=new cT,l=new uT,c={},u=a.maxTextureSize,d={[xy]:1,[wy]:0,[_y]:2},h=new RS({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new aw},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );\n\tgl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const f=new hS;f.setAttribute("position",new tS(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new MS(f,h),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let g=this.type;function y(a,n){const i=t.update(m);h.defines.VSM_SAMPLES!==a.blurSamples&&(h.defines.VSM_SAMPLES=a.blurSamples,p.defines.VSM_SAMPLES=a.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===a.mapPass&&(a.mapPass=new Tw(r.x,r.y,{format:Lb,type:Mb})),h.uniforms.shadow_pass.value=a.map.depthTexture,h.uniforms.resolution.value=a.mapSize,h.uniforms.radius.value=a.radius,e.setRenderTarget(a.mapPass),e.clear(),e.renderBufferDirect(n,null,i,h,m,null),p.uniforms.shadow_pass.value=a.mapPass.texture,p.uniforms.resolution.value=a.mapSize,p.uniforms.radius.value=a.radius,e.setRenderTarget(a.map),e.clear(),e.renderBufferDirect(n,null,i,p,m,null)}function b(t,a,n,r){let i=null;const o=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)i=o;else if(i=!0===n.isPointLight?l:s,e.localClippingEnabled&&!0===a.clipShadows&&Array.isArray(a.clippingPlanes)&&0!==a.clippingPlanes.length||a.displacementMap&&0!==a.displacementScale||a.alphaMap&&a.alphaTest>0||a.map&&a.alphaTest>0||!0===a.alphaToCoverage){const e=i.uuid,t=a.uuid;let n=c[e];void 0===n&&(n={},c[e]=n);let r=n[t];void 0===r&&(r=i.clone(),n[t]=r,a.addEventListener("dispose",w)),i=r}if(i.visible=a.visible,i.wireframe=a.wireframe,i.side=3===r?null!==a.shadowSide?a.shadowSide:a.side:null!==a.shadowSide?a.shadowSide:d[a.side],i.alphaMap=a.alphaMap,i.alphaTest=!0===a.alphaToCoverage?.5:a.alphaTest,i.map=a.map,i.clipShadows=a.clipShadows,i.clippingPlanes=a.clippingPlanes,i.clipIntersection=a.clipIntersection,i.displacementMap=a.displacementMap,i.displacementScale=a.displacementScale,i.displacementBias=a.displacementBias,i.wireframeLinewidth=a.wireframeLinewidth,i.linewidth=a.linewidth,!0===n.isPointLight&&!0===i.isMeshDistanceMaterial){e.properties.get(i).light=n}return i}function x(a,r,i,o,s){if(!1===a.visible)return;if(a.layers.test(r.layers)&&(a.isMesh||a.isLine||a.isPoints)&&(a.castShadow||a.receiveShadow&&3===s)&&(!a.frustumCulled||n.intersectsObject(a))){a.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,a.matrixWorld);const n=t.update(a),l=a.material;if(Array.isArray(l)){const t=n.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],d=l[u.materialIndex];if(d&&d.visible){const t=b(a,d,o,s);a.onBeforeShadow(e,a,r,i,n,t,u),e.renderBufferDirect(i,null,n,t,a,u),a.onAfterShadow(e,a,r,i,n,t,u)}}}else if(l.visible){const t=b(a,l,o,s);a.onBeforeShadow(e,a,r,i,n,t,null),e.renderBufferDirect(i,null,n,t,a,null),a.onAfterShadow(e,a,r,i,n,t,null)}}const l=a.children;for(let e=0,t=l.length;e<t;e++)x(l[e],r,i,o,s)}function w(e){e.target.removeEventListener("dispose",w);for(const t in c){const a=c[t],n=e.target.uuid;if(n in a){a[n].dispose(),delete a[n]}}}this.render=function(t,a,s){if(!1===v.enabled)return;if(!1===v.autoUpdate&&!1===v.needsUpdate)return;if(0===t.length)return;2===t.type&&(Gx("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),t.type=1);const l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),!0===h.buffers.depth.getReversed()?h.buffers.color.setClear(0,0,0,0):h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const p=g!==this.type;p&&a.traverse(function(e){e.material&&(Array.isArray(e.material)?e.material.forEach(e=>e.needsUpdate=!0):e.material.needsUpdate=!0)});for(let f=0,m=t.length;f<m;f++){const l=t[f],c=l.shadow;if(void 0===c){Gx("WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const d=c.getFrameExtents();if(r.multiply(d),i.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(i.x=Math.floor(u/d.x),r.x=i.x*d.x,c.mapSize.x=i.x),r.y>u&&(i.y=Math.floor(u/d.y),r.y=i.y*d.y,c.mapSize.y=i.y)),null===c.map||!0===p){if(null!==c.map&&(null!==c.map.depthTexture&&(c.map.depthTexture.dispose(),c.map.depthTexture=null),c.map.dispose()),3===this.type){if(l.isPointLight){Gx("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}c.map=new Tw(r.x,r.y,{format:Lb,type:Mb,minFilter:fb,magFilter:fb,generateMipmaps:!1}),c.map.texture.name=l.name+".shadowMap",c.map.depthTexture=new VM(r.x,r.y,Sb),c.map.depthTexture.name=l.name+".shadowMapDepth",c.map.depthTexture.format=Rb,c.map.depthTexture.compareFunction=null,c.map.depthTexture.minFilter=db,c.map.depthTexture.magFilter=db}else{l.isPointLight?(c.map=new zS(r.x),c.map.depthTexture=new HM(r.x,_b)):(c.map=new Tw(r.x,r.y),c.map.depthTexture=new VM(r.x,r.y,_b)),c.map.depthTexture.name=l.name+".shadowMap",c.map.depthTexture.format=Rb;const t=e.state.buffers.depth.getReversed();1===this.type?(c.map.depthTexture.compareFunction=t?518:515,c.map.depthTexture.minFilter=fb,c.map.depthTexture.magFilter=fb):(c.map.depthTexture.compareFunction=null,c.map.depthTexture.minFilter=db,c.map.depthTexture.magFilter=db)}c.camera.updateProjectionMatrix()}const m=c.map.isWebGLCubeRenderTarget?6:1;for(let t=0;t<m;t++){if(c.map.isWebGLCubeRenderTarget)e.setRenderTarget(c.map,t),e.clear();else{0===t&&(e.setRenderTarget(c.map),e.clear());const a=c.getViewport(t);o.set(i.x*a.x,i.y*a.y,i.x*a.z,i.y*a.w),h.viewport(o)}if(l.isPointLight){const e=c.camera,a=c.matrix,n=l.distance||e.far;n!==e.far&&(e.far=n,e.updateProjectionMatrix()),pA.setFromMatrixPosition(l.matrixWorld),e.position.copy(pA),fA.copy(e.position),fA.add(uA[t]),e.up.copy(dA[t]),e.lookAt(fA),e.updateMatrixWorld(),a.makeTranslation(-pA.x,-pA.y,-pA.z),hA.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),c._frustum.setFromProjectionMatrix(hA,e.coordinateSystem,e.reversedDepth)}else c.updateMatrices(l);n=c.getFrustum(),x(a,s,c.camera,l,this.type)}!0!==c.isPointLightShadow&&3===this.type&&y(c,s),c.needsUpdate=!1}g=this.type,v.needsUpdate=!1,e.setRenderTarget(l,c,d)}}const vA={[Vy]:1,[Gy]:6,[qy]:7,[Wy]:5,[Hy]:0,[jy]:2,[Xy]:4,[Yy]:3};function gA(e,t){const a=new function(){let t=!1;const a=new Sw;let n=null;const r=new Sw(0,0,0,0);return{setMask:function(a){n===a||t||(e.colorMask(a,a,a,a),n=a)},setLocked:function(e){t=e},setClear:function(t,n,i,o,s){!0===s&&(t*=o,n*=o,i*=o),a.set(t,n,i,o),!1===r.equals(a)&&(e.clearColor(t,n,i,o),r.copy(a))},reset:function(){t=!1,n=null,r.set(-1,0,0,0)}}},n=new function(){let a=!1,n=!1,r=null,i=null,o=null;return{setReversed:function(e){if(n!==e){const a=t.get("EXT_clip_control");e?a.clipControlEXT(a.LOWER_LEFT_EXT,a.ZERO_TO_ONE_EXT):a.clipControlEXT(a.LOWER_LEFT_EXT,a.NEGATIVE_ONE_TO_ONE_EXT),n=e;const r=o;o=null,this.setClear(r)}},getReversed:function(){return n},setTest:function(t){t?z(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(t){r===t||a||(e.depthMask(t),r=t)},setFunc:function(t){if(n&&(t=vA[t]),i!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}i=t}},setLocked:function(e){a=e},setClear:function(t){o!==t&&(n&&(t=1-t),e.clearDepth(t),o=t)},reset:function(){a=!1,r=null,i=null,o=null,n=!1}}},r=new function(){let t=!1,a=null,n=null,r=null,i=null,o=null,s=null,l=null,c=null;return{setTest:function(a){t||(a?z(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(n){a===n||t||(e.stencilMask(n),a=n)},setFunc:function(t,a,o){n===t&&r===a&&i===o||(e.stencilFunc(t,a,o),n=t,r=a,i=o)},setOp:function(t,a,n){o===t&&s===a&&l===n||(e.stencilOp(t,a,n),o=t,s=a,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,a=null,n=null,r=null,i=null,o=null,s=null,l=null,c=null}}},i=new WeakMap,o=new WeakMap;let s={},l={},c=new WeakMap,u=[],d=null,h=!1,p=null,f=null,m=null,v=null,g=null,y=null,b=null,x=new j_(0,0,0),w=0,_=!1,S=null,M=null,T=null,k=null,C=null;const A=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let E=!1,I=0;const R=e.getParameter(e.VERSION);-1!==R.indexOf("WebGL")?(I=parseFloat(/^WebGL (\d)/.exec(R)[1]),E=I>=1):-1!==R.indexOf("OpenGL ES")&&(I=parseFloat(/^OpenGL ES (\d)/.exec(R)[1]),E=I>=2);let D=null,P={};const L=e.getParameter(e.SCISSOR_BOX),N=e.getParameter(e.VIEWPORT),O=(new Sw).fromArray(L),F=(new Sw).fromArray(N);function B(t,a,n,r){const i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let s=0;s<n;s++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(a,0,e.RGBA,1,1,r,0,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(a+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}const U={};function z(t){!0!==s[t]&&(e.enable(t),s[t]=!0)}function V(t){!1!==s[t]&&(e.disable(t),s[t]=!1)}U[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),U[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),U[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),U[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),a.setClear(0,0,0,1),n.setClear(1),r.setClear(0),z(e.DEPTH_TEST),n.setFunc(3),q(!1),Y(1),z(e.CULL_FACE),W(0);const H={[Sy]:e.FUNC_ADD,[My]:e.FUNC_SUBTRACT,[Ty]:e.FUNC_REVERSE_SUBTRACT};H[103]=e.MIN,H[104]=e.MAX;const G={[ky]:e.ZERO,[Cy]:e.ONE,[Ay]:e.SRC_COLOR,[Iy]:e.SRC_ALPHA,[Oy]:e.SRC_ALPHA_SATURATE,[Ly]:e.DST_COLOR,[Dy]:e.DST_ALPHA,[Ey]:e.ONE_MINUS_SRC_COLOR,[Ry]:e.ONE_MINUS_SRC_ALPHA,[Ny]:e.ONE_MINUS_DST_COLOR,[Py]:e.ONE_MINUS_DST_ALPHA,[Fy]:e.CONSTANT_COLOR,[By]:e.ONE_MINUS_CONSTANT_COLOR,[Uy]:e.CONSTANT_ALPHA,[zy]:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,a,n,r,i,o,s,l,c,u){if(0!==t){if(!1===h&&(z(e.BLEND),h=!0),5===t)i=i||a,o=o||n,s=s||r,a===f&&i===g||(e.blendEquationSeparate(H[a],H[i]),f=a,g=i),n===m&&r===v&&o===y&&s===b||(e.blendFuncSeparate(G[n],G[r],G[o],G[s]),m=n,v=r,y=o,b=s),!1!==l.equals(x)&&c===w||(e.blendColor(l.r,l.g,l.b,c),x.copy(l),w=c),p=t,_=!1;else if(t!==p||u!==_){if(f===Sy&&g===Sy||(e.blendEquation(e.FUNC_ADD),f=Sy,g=Sy),u)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:Wx("WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case 3:Wx("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case 4:Wx("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Wx("WebGLState: Invalid blending: ",t)}m=null,v=null,y=null,b=null,x.set(0,0,0),w=0,p=t,_=u}}else!0===h&&(V(e.BLEND),h=!1)}function q(t){S!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),S=t)}function Y(t){0!==t?(z(e.CULL_FACE),t!==M&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),M=t}function j(t,a,n){t?(z(e.POLYGON_OFFSET_FILL),k===a&&C===n||(e.polygonOffset(a,n),k=a,C=n)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:a,depth:n,stencil:r},enable:z,disable:V,bindFramebuffer:function(t,a){return l[t]!==a&&(e.bindFramebuffer(t,a),l[t]=a,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=a),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=a),!0)},drawBuffers:function(t,a){let n=u,r=!1;if(t){n=c.get(a),void 0===n&&(n=[],c.set(a,n));const i=t.textures;if(n.length!==i.length||n[0]!==e.COLOR_ATTACHMENT0){for(let t=0,a=i.length;t<a;t++)n[t]=e.COLOR_ATTACHMENT0+t;n.length=i.length,r=!0}}else n[0]!==e.BACK&&(n[0]=e.BACK,r=!0);r&&e.drawBuffers(n)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,i){2===t.side?V(e.CULL_FACE):z(e.CULL_FACE);let o=1===t.side;i&&(o=!o),q(o),1===t.blending&&!1===t.transparent?W(0):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),n.setFunc(t.depthFunc),n.setTest(t.depthTest),n.setMask(t.depthWrite),a.setMask(t.colorWrite);const s=t.stencilWrite;r.setTest(s),s&&(r.setMask(t.stencilWriteMask),r.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),r.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),j(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?z(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:Y,setLineWidth:function(t){t!==T&&(E&&e.lineWidth(t),T=t)},setPolygonOffset:j,setScissorTest:function(t){t?z(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+A-1),D!==t&&(e.activeTexture(t),D=t)},bindTexture:function(t,a,n){void 0===n&&(n=null===D?e.TEXTURE0+A-1:D);let r=P[n];void 0===r&&(r={type:void 0,texture:void 0},P[n]=r),r.type===t&&r.texture===a||(D!==n&&(e.activeTexture(n),D=n),e.bindTexture(t,a||U[t]),r.type=t,r.texture=a)},unbindTexture:function(){const t=P[D];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},updateUBOMapping:function(t,a){let n=o.get(a);void 0===n&&(n=new WeakMap,o.set(a,n));let r=n.get(t);void 0===r&&(r=e.getUniformBlockIndex(a,t.name),n.set(t,r))},uniformBlockBinding:function(t,a){const n=o.get(a).get(t);i.get(a)!==n&&(e.uniformBlockBinding(a,n,t.__bindingPointIndex),i.set(a,n))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(TQe){Wx("WebGLState:",TQe)}},scissor:function(t){!1===O.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),O.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),n.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),s={},D=null,P={},l={},c=new WeakMap,u=[],d=null,h=!1,p=null,f=null,m=null,v=null,g=null,y=null,b=null,x=new j_(0,0,0),w=0,_=!1,S=null,M=null,T=null,k=null,C=null,O.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),a.reset(),n.reset(),r.reset()}}}function yA(e,t,a,n,r,i,o){const s=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new aw,u=new WeakMap;let d;const h=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(W){}function f(e,t){return p?new OffscreenCanvas(e,t):Ux("canvas")}function m(e,t,a){let n=1;const r=G(e);if((r.width>a||r.height>a)&&(n=a/Math.max(r.width,r.height)),n<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const a=Math.floor(n*r.width),i=Math.floor(n*r.height);void 0===d&&(d=f(a,i));const o=t?f(a,i):d;o.width=a,o.height=i;return o.getContext("2d").drawImage(e,0,0,a,i),Gx("WebGLRenderer: Texture has been resized from ("+r.width+"x"+r.height+") to ("+a+"x"+i+")."),o}return"data"in e&&Gx("WebGLRenderer: Image in DataTexture is too big ("+r.width+"x"+r.height+")."),e}return e}function v(e){return e.generateMipmaps}function g(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function b(a,n,r,i,o=!1){if(null!==a){if(void 0!==e[a])return e[a];Gx("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+a+"'")}let s=n;if(n===e.RED&&(r===e.FLOAT&&(s=e.R32F),r===e.HALF_FLOAT&&(s=e.R16F),r===e.UNSIGNED_BYTE&&(s=e.R8)),n===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(s=e.R8UI),r===e.UNSIGNED_SHORT&&(s=e.R16UI),r===e.UNSIGNED_INT&&(s=e.R32UI),r===e.BYTE&&(s=e.R8I),r===e.SHORT&&(s=e.R16I),r===e.INT&&(s=e.R32I)),n===e.RG&&(r===e.FLOAT&&(s=e.RG32F),r===e.HALF_FLOAT&&(s=e.RG16F),r===e.UNSIGNED_BYTE&&(s=e.RG8)),n===e.RG_INTEGER&&(r===e.UNSIGNED_BYTE&&(s=e.RG8UI),r===e.UNSIGNED_SHORT&&(s=e.RG16UI),r===e.UNSIGNED_INT&&(s=e.RG32UI),r===e.BYTE&&(s=e.RG8I),r===e.SHORT&&(s=e.RG16I),r===e.INT&&(s=e.RG32I)),n===e.RGB_INTEGER&&(r===e.UNSIGNED_BYTE&&(s=e.RGB8UI),r===e.UNSIGNED_SHORT&&(s=e.RGB16UI),r===e.UNSIGNED_INT&&(s=e.RGB32UI),r===e.BYTE&&(s=e.RGB8I),r===e.SHORT&&(s=e.RGB16I),r===e.INT&&(s=e.RGB32I)),n===e.RGBA_INTEGER&&(r===e.UNSIGNED_BYTE&&(s=e.RGBA8UI),r===e.UNSIGNED_SHORT&&(s=e.RGBA16UI),r===e.UNSIGNED_INT&&(s=e.RGBA32UI),r===e.BYTE&&(s=e.RGBA8I),r===e.SHORT&&(s=e.RGBA16I),r===e.INT&&(s=e.RGBA32I)),n===e.RGB&&(r===e.UNSIGNED_INT_5_9_9_9_REV&&(s=e.RGB9_E5),r===e.UNSIGNED_INT_10F_11F_11F_REV&&(s=e.R11F_G11F_B10F)),n===e.RGBA){const t=o?Sx:hw.getTransfer(i);r===e.FLOAT&&(s=e.RGBA32F),r===e.HALF_FLOAT&&(s=e.RGBA16F),r===e.UNSIGNED_BYTE&&(s=t===Mx?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function x(t,a){let n;return t?null===a||a===_b||a===Cb?n=e.DEPTH24_STENCIL8:a===Sb?n=e.DEPTH32F_STENCIL8:a===xb&&(n=e.DEPTH24_STENCIL8,Gx("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===a||a===_b||a===Cb?n=e.DEPTH_COMPONENT24:a===Sb?n=e.DEPTH_COMPONENT32F:a===xb&&(n=e.DEPTH_COMPONENT16),n}function w(e,t){return!0===v(e)||e.isFramebufferTexture&&e.minFilter!==db&&e.minFilter!==fb?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function _(e){const t=e.target;t.removeEventListener("dispose",_),function(e){const t=n.get(e);if(void 0===t.__webglInit)return;const a=e.source,r=h.get(a);if(r){const n=r[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&M(e),0===Object.keys(r).length&&h.delete(a)}n.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function S(t){const a=t.target;a.removeEventListener("dispose",S),function(t){const a=n.get(t);t.depthTexture&&(t.depthTexture.dispose(),n.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let n=0;n<6;n++){if(Array.isArray(a.__webglFramebuffer[n]))for(let t=0;t<a.__webglFramebuffer[n].length;t++)e.deleteFramebuffer(a.__webglFramebuffer[n][t]);else e.deleteFramebuffer(a.__webglFramebuffer[n]);a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer[n])}else{if(Array.isArray(a.__webglFramebuffer))for(let t=0;t<a.__webglFramebuffer.length;t++)e.deleteFramebuffer(a.__webglFramebuffer[t]);else e.deleteFramebuffer(a.__webglFramebuffer);if(a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer),a.__webglMultisampledFramebuffer&&e.deleteFramebuffer(a.__webglMultisampledFramebuffer),a.__webglColorRenderbuffer)for(let t=0;t<a.__webglColorRenderbuffer.length;t++)a.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(a.__webglColorRenderbuffer[t]);a.__webglDepthRenderbuffer&&e.deleteRenderbuffer(a.__webglDepthRenderbuffer)}const r=t.textures;for(let i=0,s=r.length;i<s;i++){const t=n.get(r[i]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),o.memory.textures--),n.remove(r[i])}n.remove(t)}(a)}function M(t){const a=n.get(t);e.deleteTexture(a.__webglTexture);const r=t.source;delete h.get(r)[a.__cacheKey],o.memory.textures--}let T=0;function k(t,r){const i=n.get(t);if(t.isVideoTexture&&function(e){const t=o.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&i.__version!==t.version){const e=t.image;if(null===e)Gx("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void P(i,t,r);Gx("WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(i.__webglTexture=t.sourceTexture?t.sourceTexture:null);a.bindTexture(e.TEXTURE_2D,i.__webglTexture,e.TEXTURE0+r)}const C={[lb]:e.REPEAT,[cb]:e.CLAMP_TO_EDGE,[ub]:e.MIRRORED_REPEAT},A={[db]:e.NEAREST,[hb]:e.NEAREST_MIPMAP_NEAREST,[pb]:e.NEAREST_MIPMAP_LINEAR,[fb]:e.LINEAR,[mb]:e.LINEAR_MIPMAP_NEAREST,[vb]:e.LINEAR_MIPMAP_LINEAR},E={[kx]:e.NEVER,[Px]:e.ALWAYS,[Cx]:e.LESS,[Ex]:e.LEQUAL,[Ax]:e.EQUAL,[Dx]:e.GEQUAL,[Ix]:e.GREATER,[Rx]:e.NOTEQUAL};function I(a,i){if(i.type!==Sb||!1!==t.has("OES_texture_float_linear")||i.magFilter!==fb&&i.magFilter!==mb&&i.magFilter!==pb&&i.magFilter!==vb&&i.minFilter!==fb&&i.minFilter!==mb&&i.minFilter!==pb&&i.minFilter!==vb||Gx("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(a,e.TEXTURE_WRAP_S,C[i.wrapS]),e.texParameteri(a,e.TEXTURE_WRAP_T,C[i.wrapT]),a!==e.TEXTURE_3D&&a!==e.TEXTURE_2D_ARRAY||e.texParameteri(a,e.TEXTURE_WRAP_R,C[i.wrapR]),e.texParameteri(a,e.TEXTURE_MAG_FILTER,A[i.magFilter]),e.texParameteri(a,e.TEXTURE_MIN_FILTER,A[i.minFilter]),i.compareFunction&&(e.texParameteri(a,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(a,e.TEXTURE_COMPARE_FUNC,E[i.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(i.magFilter===db)return;if(i.minFilter!==pb&&i.minFilter!==vb)return;if(i.type===Sb&&!1===t.has("OES_texture_float_linear"))return;if(i.anisotropy>1||n.get(i).__currentAnisotropy){const o=t.get("EXT_texture_filter_anisotropic");e.texParameterf(a,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,r.getMaxAnisotropy())),n.get(i).__currentAnisotropy=i.anisotropy}}}function R(t,a){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,a.addEventListener("dispose",_));const r=a.source;let i=h.get(r);void 0===i&&(i={},h.set(r,i));const s=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(a);if(s!==t.__cacheKey){void 0===i[s]&&(i[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,n=!0),i[s].usedTimes++;const r=i[t.__cacheKey];void 0!==r&&(i[t.__cacheKey].usedTimes--,0===r.usedTimes&&M(a)),t.__cacheKey=s,t.__webglTexture=i[s].texture}return n}function D(e,t,a){return Math.floor(Math.floor(e/a)/t)}function P(t,o,s){let l=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(l=e.TEXTURE_3D);const c=R(t,o),u=o.source;a.bindTexture(l,t.__webglTexture,e.TEXTURE0+s);const d=n.get(u);if(u.version!==d.__version||!0===c){a.activeTexture(e.TEXTURE0+s);const t=hw.getPrimaries(hw.workingColorSpace),n=o.colorSpace===bx?null:hw.getPrimaries(o.colorSpace),h=o.colorSpace===bx||t===n?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let p=m(o.image,!1,r.maxTextureSize);p=H(o,p);const f=i.convert(o.format,o.colorSpace),y=i.convert(o.type);let _,S=b(o.internalFormat,f,y,o.colorSpace,o.isVideoTexture);I(l,o);const M=o.mipmaps,T=!0!==o.isVideoTexture,k=void 0===d.__version||!0===c,C=u.dataReady,A=w(o,p);if(o.isDepthTexture)S=x(o.format===Db,o.type),k&&(T?a.texStorage2D(e.TEXTURE_2D,1,S,p.width,p.height):a.texImage2D(e.TEXTURE_2D,0,S,p.width,p.height,0,f,y,null));else if(o.isDataTexture)if(M.length>0){T&&k&&a.texStorage2D(e.TEXTURE_2D,A,S,M[0].width,M[0].height);for(let t=0,n=M.length;t<n;t++)_=M[t],T?C&&a.texSubImage2D(e.TEXTURE_2D,t,0,0,_.width,_.height,f,y,_.data):a.texImage2D(e.TEXTURE_2D,t,S,_.width,_.height,0,f,y,_.data);o.generateMipmaps=!1}else T?(k&&a.texStorage2D(e.TEXTURE_2D,A,S,p.width,p.height),C&&function(t,n,r,i){const o=t.updateRanges;if(0===o.length)a.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,r,i,n.data);else{o.sort((e,t)=>e.start-t.start);let s=0;for(let e=1;e<o.length;e++){const t=o[s],a=o[e],r=t.start+t.count,i=D(a.start,n.width,4),l=D(t.start,n.width,4);a.start<=r+1&&i===l&&D(a.start+a.count-1,n.width,4)===i?t.count=Math.max(t.count,a.start+a.count-t.start):(++s,o[s]=a)}o.length=s+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),u=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,n.width);for(let t=0,d=o.length;t<d;t++){const s=o[t],l=Math.floor(s.start/4),c=Math.ceil(s.count/4),u=l%n.width,d=Math.floor(l/n.width),h=c,p=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,d),a.texSubImage2D(e.TEXTURE_2D,0,u,d,h,p,r,i,n.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,u)}}(o,p,f,y)):a.texImage2D(e.TEXTURE_2D,0,S,p.width,p.height,0,f,y,p.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){T&&k&&a.texStorage3D(e.TEXTURE_2D_ARRAY,A,S,M[0].width,M[0].height,p.depth);for(let t=0,n=M.length;t<n;t++)if(_=M[t],o.format!==Ib)if(null!==f)if(T){if(C)if(o.layerUpdates.size>0){const n=LT(_.width,_.height,o.format,o.type);for(const r of o.layerUpdates){const i=_.data.subarray(r*n/_.data.BYTES_PER_ELEMENT,(r+1)*n/_.data.BYTES_PER_ELEMENT);a.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,r,_.width,_.height,1,f,i)}o.clearLayerUpdates()}else a.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,_.width,_.height,p.depth,f,_.data)}else a.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,S,_.width,_.height,p.depth,0,_.data,0,0);else Gx("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else T?C&&a.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,_.width,_.height,p.depth,f,y,_.data):a.texImage3D(e.TEXTURE_2D_ARRAY,t,S,_.width,_.height,p.depth,0,f,y,_.data)}else{T&&k&&a.texStorage2D(e.TEXTURE_2D,A,S,M[0].width,M[0].height);for(let t=0,n=M.length;t<n;t++)_=M[t],o.format!==Ib?null!==f?T?C&&a.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,_.width,_.height,f,_.data):a.compressedTexImage2D(e.TEXTURE_2D,t,S,_.width,_.height,0,_.data):Gx("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?C&&a.texSubImage2D(e.TEXTURE_2D,t,0,0,_.width,_.height,f,y,_.data):a.texImage2D(e.TEXTURE_2D,t,S,_.width,_.height,0,f,y,_.data)}else if(o.isDataArrayTexture)if(T){if(k&&a.texStorage3D(e.TEXTURE_2D_ARRAY,A,S,p.width,p.height,p.depth),C)if(o.layerUpdates.size>0){const t=LT(p.width,p.height,o.format,o.type);for(const n of o.layerUpdates){const r=p.data.subarray(n*t/p.data.BYTES_PER_ELEMENT,(n+1)*t/p.data.BYTES_PER_ELEMENT);a.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,n,p.width,p.height,1,f,y,r)}o.clearLayerUpdates()}else a.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,f,y,p.data)}else a.texImage3D(e.TEXTURE_2D_ARRAY,0,S,p.width,p.height,p.depth,0,f,y,p.data);else if(o.isData3DTexture)T?(k&&a.texStorage3D(e.TEXTURE_3D,A,S,p.width,p.height,p.depth),C&&a.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,f,y,p.data)):a.texImage3D(e.TEXTURE_3D,0,S,p.width,p.height,p.depth,0,f,y,p.data);else if(o.isFramebufferTexture){if(k)if(T)a.texStorage2D(e.TEXTURE_2D,A,S,p.width,p.height);else{let t=p.width,n=p.height;for(let r=0;r<A;r++)a.texImage2D(e.TEXTURE_2D,r,S,t,n,0,f,y,null),t>>=1,n>>=1}}else if(M.length>0){if(T&&k){const t=G(M[0]);a.texStorage2D(e.TEXTURE_2D,A,S,t.width,t.height)}for(let t=0,n=M.length;t<n;t++)_=M[t],T?C&&a.texSubImage2D(e.TEXTURE_2D,t,0,0,f,y,_):a.texImage2D(e.TEXTURE_2D,t,S,f,y,_);o.generateMipmaps=!1}else if(T){if(k){const t=G(p);a.texStorage2D(e.TEXTURE_2D,A,S,t.width,t.height)}C&&a.texSubImage2D(e.TEXTURE_2D,0,0,0,f,y,p)}else a.texImage2D(e.TEXTURE_2D,0,S,f,y,p);v(o)&&g(l),d.__version=u.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function L(t,r,o,l,c,u){const d=i.convert(o.format,o.colorSpace),h=i.convert(o.type),p=b(o.internalFormat,d,h,o.colorSpace),f=n.get(r),m=n.get(o);if(m.__renderTarget=r,!f.__hasExternalTextures){const t=Math.max(1,r.width>>u),n=Math.max(1,r.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?a.texImage3D(c,u,p,t,n,r.depth,0,d,h,null):a.texImage2D(c,u,p,t,n,0,d,h,null)}a.bindFramebuffer(e.FRAMEBUFFER,t),V(r)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,m.__webglTexture,0,z(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,m.__webglTexture,u),a.bindFramebuffer(e.FRAMEBUFFER,null)}function N(t,a,n){if(e.bindRenderbuffer(e.RENDERBUFFER,t),a.depthBuffer){const r=a.depthTexture,i=r&&r.isDepthTexture?r.type:null,o=x(a.stencilBuffer,i),l=a.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;V(a)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,z(a),o,a.width,a.height):n?e.renderbufferStorageMultisample(e.RENDERBUFFER,z(a),o,a.width,a.height):e.renderbufferStorage(e.RENDERBUFFER,o,a.width,a.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=a.textures;for(let r=0;r<t.length;r++){const o=t[r],l=i.convert(o.format,o.colorSpace),c=i.convert(o.type),u=b(o.internalFormat,l,c,o.colorSpace);V(a)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,z(a),u,a.width,a.height):n?e.renderbufferStorageMultisample(e.RENDERBUFFER,z(a),u,a.width,a.height):e.renderbufferStorage(e.RENDERBUFFER,u,a.width,a.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function O(t,r,o){const l=!0===r.isWebGLCubeRenderTarget;if(a.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const c=n.get(r.depthTexture);if(c.__renderTarget=r,c.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),l){if(void 0===c.__webglInit&&(c.__webglInit=!0,r.depthTexture.addEventListener("dispose",_)),void 0===c.__webglTexture){c.__webglTexture=e.createTexture(),a.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),I(e.TEXTURE_CUBE_MAP,r.depthTexture);const t=i.convert(r.depthTexture.format),n=i.convert(r.depthTexture.type);let o;r.depthTexture.format===Rb?o=e.DEPTH_COMPONENT24:r.depthTexture.format===Db&&(o=e.DEPTH24_STENCIL8);for(let a=0;a<6;a++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,o,r.width,r.height,0,t,n,null)}}else k(r.depthTexture,0);const u=c.__webglTexture,d=z(r),h=l?e.TEXTURE_CUBE_MAP_POSITIVE_X+o:e.TEXTURE_2D,p=r.depthTexture.format===Db?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;if(r.depthTexture.format===Rb)V(r)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,p,h,u,0,d):e.framebufferTexture2D(e.FRAMEBUFFER,p,h,u,0);else{if(r.depthTexture.format!==Db)throw new Error("Unknown depthTexture format");V(r)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,p,h,u,0,d):e.framebufferTexture2D(e.FRAMEBUFFER,p,h,u,0)}}function F(t){const r=n.get(t),i=!0===t.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),e){const t=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),r.__depthDisposeCallback=t}r.__boundDepthTexture=e}if(t.depthTexture&&!r.__autoAllocateDepthBuffer)if(i)for(let e=0;e<6;e++)O(r.__webglFramebuffer[e],t,e);else{const e=t.texture.mipmaps;e&&e.length>0?O(r.__webglFramebuffer[0],t,0):O(r.__webglFramebuffer,t,0)}else if(i){r.__webglDepthbuffer=[];for(let n=0;n<6;n++)if(a.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[n]),void 0===r.__webglDepthbuffer[n])r.__webglDepthbuffer[n]=e.createRenderbuffer(),N(r.__webglDepthbuffer[n],t,!1);else{const a=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer[n];e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,a,e.RENDERBUFFER,i)}}else{const n=t.texture.mipmaps;if(n&&n.length>0?a.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[0]):a.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=e.createRenderbuffer(),N(r.__webglDepthbuffer,t,!1);else{const a=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,n=r.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,n),e.framebufferRenderbuffer(e.FRAMEBUFFER,a,e.RENDERBUFFER,n)}}a.bindFramebuffer(e.FRAMEBUFFER,null)}const B=[],U=[];function z(e){return Math.min(r.maxSamples,e.samples)}function V(e){const a=n.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==a.__useRenderToTexture}function H(e,t){const a=e.colorSpace,n=e.format,r=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||a!==_x&&a!==bx&&(hw.getTransfer(a)===Mx?n===Ib&&r===gb||Gx("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Wx("WebGLTextures: Unsupported texture color space:",a)),t}function G(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=T;return e>=r.maxTextures&&Gx("WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=k,this.setTexture2DArray=function(t,r){const i=n.get(t);!1===t.isRenderTargetTexture&&t.version>0&&i.__version!==t.version?P(i,t,r):(t.isExternalTexture&&(i.__webglTexture=t.sourceTexture?t.sourceTexture:null),a.bindTexture(e.TEXTURE_2D_ARRAY,i.__webglTexture,e.TEXTURE0+r))},this.setTexture3D=function(t,r){const i=n.get(t);!1===t.isRenderTargetTexture&&t.version>0&&i.__version!==t.version?P(i,t,r):a.bindTexture(e.TEXTURE_3D,i.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,o){const s=n.get(t);!0!==t.isCubeDepthTexture&&t.version>0&&s.__version!==t.version?function(t,o,s){if(6!==o.image.length)return;const l=R(t,o),c=o.source;a.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);const u=n.get(c);if(c.version!==u.__version||!0===l){a.activeTexture(e.TEXTURE0+s);const t=hw.getPrimaries(hw.workingColorSpace),n=o.colorSpace===bx?null:hw.getPrimaries(o.colorSpace),d=o.colorSpace===bx||t===n?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const h=o.isCompressedTexture||o.image[0].isCompressedTexture,p=o.image[0]&&o.image[0].isDataTexture,f=[];for(let e=0;e<6;e++)f[e]=h||p?p?o.image[e].image:o.image[e]:m(o.image[e],!0,r.maxCubemapSize),f[e]=H(o,f[e]);const y=f[0],x=i.convert(o.format,o.colorSpace),_=i.convert(o.type),S=b(o.internalFormat,x,_,o.colorSpace),M=!0!==o.isVideoTexture,T=void 0===u.__version||!0===l,k=c.dataReady;let C,A=w(o,y);if(I(e.TEXTURE_CUBE_MAP,o),h){M&&T&&a.texStorage2D(e.TEXTURE_CUBE_MAP,A,S,y.width,y.height);for(let t=0;t<6;t++){C=f[t].mipmaps;for(let n=0;n<C.length;n++){const r=C[n];o.format!==Ib?null!==x?M?k&&a.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,0,0,r.width,r.height,x,r.data):a.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,S,r.width,r.height,0,r.data):Gx("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):M?k&&a.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,0,0,r.width,r.height,x,_,r.data):a.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n,S,r.width,r.height,0,x,_,r.data)}}}else{if(C=o.mipmaps,M&&T){C.length>0&&A++;const t=G(f[0]);a.texStorage2D(e.TEXTURE_CUBE_MAP,A,S,t.width,t.height)}for(let t=0;t<6;t++)if(p){M?k&&a.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,f[t].width,f[t].height,x,_,f[t].data):a.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,S,f[t].width,f[t].height,0,x,_,f[t].data);for(let n=0;n<C.length;n++){const r=C[n].image[t].image;M?k&&a.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,r.width,r.height,x,_,r.data):a.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,S,r.width,r.height,0,x,_,r.data)}}else{M?k&&a.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,x,_,f[t]):a.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,S,x,_,f[t]);for(let n=0;n<C.length;n++){const r=C[n];M?k&&a.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,0,0,x,_,r.image[t]):a.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,n+1,S,x,_,r.image[t])}}}v(o)&&g(e.TEXTURE_CUBE_MAP),u.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}(s,t,o):a.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,a,r){const i=n.get(t);void 0!==a&&L(i.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&F(t)},this.setupRenderTarget=function(t){const r=t.texture,s=n.get(t),l=n.get(r);t.addEventListener("dispose",S);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,d=c.length>1;if(d||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=r.version,o.memory.textures++),u){s.__webglFramebuffer=[];for(let t=0;t<6;t++)if(r.mipmaps&&r.mipmaps.length>0){s.__webglFramebuffer[t]=[];for(let a=0;a<r.mipmaps.length;a++)s.__webglFramebuffer[t][a]=e.createFramebuffer()}else s.__webglFramebuffer[t]=e.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){s.__webglFramebuffer=[];for(let t=0;t<r.mipmaps.length;t++)s.__webglFramebuffer[t]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer();if(d)for(let t=0,a=c.length;t<a;t++){const a=n.get(c[t]);void 0===a.__webglTexture&&(a.__webglTexture=e.createTexture(),o.memory.textures++)}if(t.samples>0&&!1===V(t)){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=[],a.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(let a=0;a<c.length;a++){const n=c[a];s.__webglColorRenderbuffer[a]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer[a]);const r=i.convert(n.format,n.colorSpace),o=i.convert(n.type),l=b(n.internalFormat,r,o,n.colorSpace,!0===t.isXRRenderTarget),u=z(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+a,e.RENDERBUFFER,s.__webglColorRenderbuffer[a])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),N(s.__webglDepthRenderbuffer,t,!0)),a.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){a.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),I(e.TEXTURE_CUBE_MAP,r);for(let a=0;a<6;a++)if(r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)L(s.__webglFramebuffer[a][n],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+a,n);else L(s.__webglFramebuffer[a],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+a,0);v(r)&&g(e.TEXTURE_CUBE_MAP),a.unbindTexture()}else if(d){for(let r=0,i=c.length;r<i;r++){const i=c[r],o=n.get(i);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),a.bindTexture(l,o.__webglTexture),I(l,i),L(s.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0+r,l,0),v(i)&&g(l)}a.unbindTexture()}else{let n=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(n=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),a.bindTexture(n,l.__webglTexture),I(n,r),r.mipmaps&&r.mipmaps.length>0)for(let a=0;a<r.mipmaps.length;a++)L(s.__webglFramebuffer[a],t,r,e.COLOR_ATTACHMENT0,n,a);else L(s.__webglFramebuffer,t,r,e.COLOR_ATTACHMENT0,n,0);v(r)&&g(n),a.unbindTexture()}t.depthBuffer&&F(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let r=0,i=t.length;r<i;r++){const i=t[r];if(v(i)){const t=y(e),r=n.get(i).__webglTexture;a.bindTexture(t,r),g(t),a.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===V(t)){const r=t.textures,i=t.width,o=t.height;let s=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=n.get(t),d=r.length>1;if(d)for(let t=0;t<r.length;t++)a.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),a.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);a.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const h=t.texture.mipmaps;h&&h.length>0?a.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):a.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let a=0;a<r.length;a++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),d){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[a]);const t=n.get(r[a]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,i,o,0,0,i,o,s,e.NEAREST),!0===l&&(B.length=0,U.length=0,B.push(e.COLOR_ATTACHMENT0+a),t.depthBuffer&&!1===t.resolveDepthBuffer&&(B.push(c),U.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,U)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,B))}if(a.bindFramebuffer(e.READ_FRAMEBUFFER,null),a.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<r.length;t++){a.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const i=n.get(r[t]).__webglTexture;a.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,i,0)}a.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const a=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[a])}},this.setupDepthRenderbuffer=F,this.setupFrameBufferTexture=L,this.useMultisampledRTT=V,this.isReversedDepthBuffer=function(){return a.buffers.depth.getReversed()}}function bA(e,t){return{convert:function(a,n=""){let r;const i=hw.getTransfer(n);if(a===gb)return e.UNSIGNED_BYTE;if(a===Tb)return e.UNSIGNED_SHORT_4_4_4_4;if(a===kb)return e.UNSIGNED_SHORT_5_5_5_1;if(a===Ab)return e.UNSIGNED_INT_5_9_9_9_REV;if(a===Eb)return e.UNSIGNED_INT_10F_11F_11F_REV;if(a===yb)return e.BYTE;if(a===bb)return e.SHORT;if(a===xb)return e.UNSIGNED_SHORT;if(a===wb)return e.INT;if(a===_b)return e.UNSIGNED_INT;if(a===Sb)return e.FLOAT;if(a===Mb)return e.HALF_FLOAT;if(1021===a)return e.ALPHA;if(1022===a)return e.RGB;if(a===Ib)return e.RGBA;if(a===Rb)return e.DEPTH_COMPONENT;if(a===Db)return e.DEPTH_STENCIL;if(1028===a)return e.RED;if(a===Pb)return e.RED_INTEGER;if(a===Lb)return e.RG;if(a===Nb)return e.RG_INTEGER;if(a===Ob)return e.RGBA_INTEGER;if(a===Fb||a===Bb||a===Ub||a===zb)if(i===Mx){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(a===Fb)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===Bb)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===Ub)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===zb)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(a===Fb)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===Bb)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===Ub)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===zb)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(a===Vb||a===Hb||a===Gb||a===Wb){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(a===Vb)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===Hb)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===Gb)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===Wb)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(a===qb||a===Yb||a===jb||a===Xb||a===$b||a===Kb||a===Zb){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(a===qb||a===Yb)return i===Mx?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(a===jb)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC;if(a===Xb)return r.COMPRESSED_R11_EAC;if(a===$b)return r.COMPRESSED_SIGNED_R11_EAC;if(a===Kb)return r.COMPRESSED_RG11_EAC;if(a===Zb)return r.COMPRESSED_SIGNED_RG11_EAC}if(a===Jb||a===Qb||a===ex||a===tx||a===ax||a===nx||a===rx||a===ix||a===ox||a===sx||a===lx||a===cx||a===ux||a===dx){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(a===Jb)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===Qb)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===ex)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===tx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===ax)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===nx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===rx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===ix)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===ox)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===sx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===lx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===cx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===ux)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===dx)return i===Mx?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(a===hx||a===px||a===fx){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(a===hx)return i===Mx?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(a===px)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(a===fx)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(a===mx||a===vx||a===gx||a===yx){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(a===mx)return r.COMPRESSED_RED_RGTC1_EXT;if(a===vx)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===gx)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===yx)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return a===Cb?e.UNSIGNED_INT_24_8:void 0!==e[a]?e[a]:null}}}class xA{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const a=new GM(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=a}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,a=new RS({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new MS(new rT(20,20),a)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class wA extends Yx{constructor(e,t){super();const a=this;let n=null,r=1,i=null,o="local-floor",s=1,l=null,c=null,u=null,d=null,h=null,p=null;const f="undefined"!=typeof XRWebGLBinding,m=new xA,v={},g=t.getContextAttributes();let y=null,b=null;const x=[],w=[],_=new aw;let S=null;const M=new OS;M.viewport=new Sw;const T=new OS;T.viewport=new Sw;const k=[M,T],C=new _T;let A=null,E=null;function I(e){const t=w.indexOf(e.inputSource);if(-1===t)return;const a=x[t];void 0!==a&&(a.update(e.inputSource,e.frame,l||i),a.dispatchEvent({type:e.type,data:e.inputSource}))}function R(){n.removeEventListener("select",I),n.removeEventListener("selectstart",I),n.removeEventListener("selectend",I),n.removeEventListener("squeeze",I),n.removeEventListener("squeezestart",I),n.removeEventListener("squeezeend",I),n.removeEventListener("end",R),n.removeEventListener("inputsourceschange",D);for(let e=0;e<x.length;e++){const t=w[e];null!==t&&(w[e]=null,x[e].disconnect(t))}A=null,E=null,m.reset();for(const e in v)delete v[e];e.setRenderTarget(y),h=null,d=null,u=null,n=null,b=null,F.stop(),a.isPresenting=!1,e.setPixelRatio(S),e.setSize(_.width,_.height,!1),a.dispatchEvent({type:"sessionend"})}function D(e){for(let t=0;t<e.removed.length;t++){const a=e.removed[t],n=w.indexOf(a);n>=0&&(w[n]=null,x[n].disconnect(a))}for(let t=0;t<e.added.length;t++){const a=e.added[t];let n=w.indexOf(a);if(-1===n){for(let e=0;e<x.length;e++){if(e>=w.length){w.push(a),n=e;break}if(null===w[e]){w[e]=a,n=e;break}}if(-1===n)break}const r=x[n];r&&r.connect(a)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=x[e];return void 0===t&&(t=new GS,x[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=x[e];return void 0===t&&(t=new GS,x[e]=t),t.getGripSpace()},this.getHand=function(e){let t=x[e];return void 0===t&&(t=new GS,x[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===a.isPresenting&&Gx("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===a.isPresenting&&Gx("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||i},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return null===u&&f&&(u=new XRWebGLBinding(n,t)),u},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(c){if(n=c,null!==n){y=e.getRenderTarget(),n.addEventListener("select",I),n.addEventListener("selectstart",I),n.addEventListener("selectend",I),n.addEventListener("squeeze",I),n.addEventListener("squeezestart",I),n.addEventListener("squeezeend",I),n.addEventListener("end",R),n.addEventListener("inputsourceschange",D),!0!==g.xrCompatible&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(_);if(f&&"createProjectionLayer"in XRWebGLBinding.prototype){let a=null,i=null,o=null;g.depth&&(o=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,a=g.stencil?Db:Rb,i=g.stencil?Cb:_b);const s={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:r};u=this.getBinding(),d=u.createProjectionLayer(s),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),b=new Tw(d.textureWidth,d.textureHeight,{format:Ib,type:gb,depthTexture:new VM(d.textureWidth,d.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,a),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}else{const a={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(n,t,a),n.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),b=new Tw(h.framebufferWidth,h.framebufferHeight,{format:Ib,type:gb,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}b.isXRRenderTarget=!0,this.setFoveation(s),l=null,i=await n.requestReferenceSpace(o),F.setContext(n),F.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const P=new rw,L=new rw;function N(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===n)return;let t=e.near,a=e.far;null!==m.texture&&(m.depthNear>0&&(t=m.depthNear),m.depthFar>0&&(a=m.depthFar)),C.near=T.near=M.near=t,C.far=T.far=M.far=a,A===C.near&&E===C.far||(n.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,E=C.far),C.layers.mask=6|e.layers.mask,M.layers.mask=3&C.layers.mask,T.layers.mask=5&C.layers.mask;const r=e.parent,i=C.cameras;N(C,r);for(let n=0;n<i.length;n++)N(i[n],r);2===i.length?function(e,t,a){P.setFromMatrixPosition(t.matrixWorld),L.setFromMatrixPosition(a.matrixWorld);const n=P.distanceTo(L),r=t.projectionMatrix.elements,i=a.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],d=(i[8]+1)/i[0],h=o*u,p=o*d,f=n/(-u+d),m=f*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===r[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=o+f,a=s+f,r=h-m,i=p+(n-m),u=l*s/a*t,d=c*s/a*t;e.projectionMatrix.makePerspective(r,i,u,d,t,a),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(C,M,T):C.projectionMatrix.copy(M.projectionMatrix),function(e,t,a){null===a?e.matrix.copy(t.matrixWorld):(e.matrix.copy(a.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*$x*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,C,r)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==d||null!==h)return s},this.setFoveation=function(e){s=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(C)},this.getCameraTexture=function(e){return v[e]};let O=null;const F=new NT;F.setAnimationLoop(function(t,r){if(c=r.getViewerPose(l||i),p=r,null!==c){const t=c.views;null!==h&&(e.setRenderTargetFramebuffer(b,h.framebuffer),e.setRenderTarget(b));let r=!1;t.length!==C.cameras.length&&(C.cameras.length=0,r=!0);for(let a=0;a<t.length;a++){const n=t[a];let i=null;if(null!==h)i=h.getViewport(n);else{const t=u.getViewSubImage(d,n);i=t.viewport,0===a&&(e.setRenderTargetTextures(b,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(b))}let o=k[a];void 0===o&&(o=new OS,o.layers.enable(a),o.viewport=new Sw,k[a]=o),o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(n.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(i.x,i.y,i.width,i.height),0===a&&(C.matrix.copy(o.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),!0===r&&C.cameras.push(o)}const i=n.enabledFeatures;if(i&&i.includes("depth-sensing")&&"gpu-optimized"==n.depthUsage&&f){u=a.getBinding();const e=u.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&m.init(e,n.renderState)}if(i&&i.includes("camera-access")&&f){e.state.unbindTexture(),u=a.getBinding();for(let e=0;e<t.length;e++){const a=t[e].camera;if(a){let e=v[a];e||(e=new GM,v[a]=e);const t=u.getCameraImage(a);e.sourceTexture=t}}}}for(let e=0;e<x.length;e++){const t=w[e],a=x[e];null!==t&&void 0!==a&&a.update(t,r,l||i)}O&&O(t,r),r.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:r}),p=null}),this.setAnimationLoop=function(e){O=e},this.dispose=function(){}}}const _A=new d_,SA=new t_;function MA(e,t){function a(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function n(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map,a(n.map,e.mapTransform)),n.alphaMap&&(e.alphaMap.value=n.alphaMap,a(n.alphaMap,e.alphaMapTransform)),n.bumpMap&&(e.bumpMap.value=n.bumpMap,a(n.bumpMap,e.bumpMapTransform),e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,a(n.normalMap,e.normalMapTransform),e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,a(n.displacementMap,e.displacementMapTransform),e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap,a(n.emissiveMap,e.emissiveMapTransform)),n.specularMap&&(e.specularMap.value=n.specularMap,a(n.specularMap,e.specularMapTransform)),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);const r=t.get(n),i=r.envMap,o=r.envMapRotation;i&&(e.envMap.value=i,_A.copy(o),_A.x*=-1,_A.y*=-1,_A.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(_A.y*=-1,_A.z*=-1),e.envMapRotation.value.setFromMatrix4(SA.makeRotationFromEuler(_A)),e.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity,a(n.lightMap,e.lightMapTransform)),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity,a(n.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,a){a.color.getRGB(t.fogColor.value,ES(e)),a.isFog?(t.fogNear.value=a.near,t.fogFar.value=a.far):a.isFogExp2&&(t.fogDensity.value=a.density)},refreshMaterialUniforms:function(e,r,i,o,s){r.isMeshBasicMaterial||r.isMeshLambertMaterial?n(e,r):r.isMeshToonMaterial?(n(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(n(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(n(e,r),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,a(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,a(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,a(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,a(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,a(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,a(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,a(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,a(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,a(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,a(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,a(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,a(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,a(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,a(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,s)):r.isMeshMatcapMaterial?(n(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?n(e,r):r.isMeshDistanceMaterial?(n(e,r),function(e,a){const n=t.get(a).light;e.referencePosition.value.setFromMatrixPosition(n.matrixWorld),e.nearDistance.value=n.shadow.camera.near,e.farDistance.value=n.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?n(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,a(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map,a(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,a(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,i,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,a(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,a(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function TA(e,t,a,n){let r={},i={},o=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,a,n){const r=e.value,i=t+"_"+a;if(void 0===n[i])return n[i]="number"==typeof r||"boolean"==typeof r?r:r.clone(),!0;{const e=n[i];if("number"==typeof r||"boolean"==typeof r){if(e!==r)return n[i]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?Gx("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Gx("WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const a=t.target;a.removeEventListener("dispose",u);const n=o.indexOf(a.__bindingPointIndex);o.splice(n,1),e.deleteBuffer(r[a.id]),delete r[a.id],delete i[a.id]}return{bind:function(e,t){const a=t.program;n.uniformBlockBinding(e,a)},update:function(a,d){let h=r[a.id];void 0===h&&(!function(e){const t=e.uniforms;let a=0;const n=16;for(let i=0,o=t.length;i<o;i++){const e=Array.isArray(t[i])?t[i]:[t[i]];for(let t=0,r=e.length;t<r;t++){const r=e[t],i=Array.isArray(r.value)?r.value:[r.value];for(let e=0,t=i.length;e<t;e++){const t=c(i[e]),o=a%n,s=o%t.boundary,l=o+s;a+=s,0!==l&&n-l<t.storage&&(a+=n-l),r.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=a,a+=t.storage}}}const r=a%n;r>0&&(a+=n-r);e.__size=a,e.__cache={}}(a),h=function(t){const a=function(){for(let e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return Wx("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=a;const n=e.createBuffer(),r=t.__size,i=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,n),e.bufferData(e.UNIFORM_BUFFER,r,i),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,a,n),n}(a),r[a.id]=h,a.addEventListener("dispose",u));const p=d.program;n.updateUBOMapping(a,p);const f=t.render.frame;i[a.id]!==f&&(!function(t){const a=r[t.id],n=t.uniforms,i=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,a);for(let r=0,o=n.length;r<o;r++){const t=Array.isArray(n[r])?n[r]:[n[r]];for(let a=0,n=t.length;a<n;a++){const n=t[a];if(!0===l(n,r,a,i)){const t=n.__offset,a=Array.isArray(n.value)?n.value:[n.value];let r=0;for(let i=0;i<a.length;i++){const o=a[i],s=c(o);"number"==typeof o||"boolean"==typeof o?(n.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+r,n.__data)):o.isMatrix3?(n.__data[0]=o.elements[0],n.__data[1]=o.elements[1],n.__data[2]=o.elements[2],n.__data[3]=0,n.__data[4]=o.elements[3],n.__data[5]=o.elements[4],n.__data[6]=o.elements[5],n.__data[7]=0,n.__data[8]=o.elements[6],n.__data[9]=o.elements[7],n.__data[10]=o.elements[8],n.__data[11]=0):(o.toArray(n.__data,r),r+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,n.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(a),i[a.id]=f)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);o=[],r={},i={}}}}const kA=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let CA=null;class AA{constructor(e={}){const{canvas:t=zx(),context:a=null,depth:n=!0,stencil:r=!1,alpha:i=!1,antialias:o=!1,premultipliedAlpha:s=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:d=!1,outputBufferType:h=gb}=e;let p;if(this.isWebGLRenderer=!0,null!==a){if("undefined"!=typeof WebGLRenderingContext&&a instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");p=a.getContextAttributes().alpha}else p=i;const f=h,m=new Set([Ob,Nb,Pb]),v=new Set([gb,_b,xb,Cb,Tb,kb]),g=new Uint32Array(4),y=new Int32Array(4);let b=null,x=null;const w=[],_=[];let S=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=0,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const M=this;let T=!1;this._outputColorSpace=xx;let k=0,C=0,A=null,E=-1,I=null;const R=new Sw,D=new Sw;let P=null;const L=new j_(0);let N=0,O=t.width,F=t.height,B=1,U=null,z=null;const V=new Sw(0,0,O,F),H=new Sw(0,0,O,F);let G=!1;const W=new bM;let q=!1,Y=!1;const j=new t_,X=new rw,$=new Sw,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Z=!1;function J(){return null===A?B:1}let Q,ee,te,ae,ne,re,ie,oe,se,le,ce,ue,de,he,pe,fe,me,ve,ge,ye,be,xe,we,_e,Se=a;function Me(e,a){return t.getContext(e,a)}try{const e={alpha:!0,depth:n,stencil:r,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${uy}`),t.addEventListener("webglcontextlost",Ce,!1),t.addEventListener("webglcontextrestored",Ae,!1),t.addEventListener("webglcontextcreationerror",Ee,!1),null===Se){const t="webgl2";if(Se=Me(t,e),null===Se)throw Me(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(TQe){throw Wx("WebGLRenderer: "+TQe.message),TQe}function Te(){Q=new dk(Se),Q.init(),xe=new bA(Se,Q),ee=new YT(Se,Q,e,xe),te=new gA(Se,Q),ee.reversedDepthBuffer&&d&&te.buffers.depth.setReversed(!0),ae=new fk(Se),ne=new QC,re=new yA(Se,Q,te,ne,ee,xe,ae),ie=new XT(M),oe=new uk(M),se=new OT(Se),we=new WT(Se,se),le=new hk(Se,se,ae,we),ce=new vk(Se,le,se,ae),ge=new mk(Se,ee,re),fe=new jT(ne),ue=new JC(M,ie,oe,Q,ee,we,fe),de=new MA(M,ne),he=new nA,pe=new cA(Q),ve=new GT(M,ie,oe,te,ce,p,s),me=new mA(M,ce,ee),_e=new TA(Se,ae,ee,te),ye=new qT(Se,Q,ae),be=new pk(Se,Q,ae),ae.programs=ue.programs,M.capabilities=ee,M.extensions=Q,M.properties=ne,M.renderLists=he,M.shadowMap=me,M.state=te,M.info=ae}Te(),f!==gb&&(S=new yk(f,t.width,t.height,n,r));const ke=new wA(M,Se);function Ce(e){e.preventDefault(),Hx("WebGLRenderer: Context Lost."),T=!0}function Ae(){Hx("WebGLRenderer: Context Restored."),T=!1;const e=ae.autoReset,t=me.enabled,a=me.autoUpdate,n=me.needsUpdate,r=me.type;Te(),ae.autoReset=e,me.enabled=t,me.autoUpdate=a,me.needsUpdate=n,me.type=r}function Ee(e){Wx("WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ie(e){const t=e.target;t.removeEventListener("dispose",Ie),function(e){(function(e){const t=ne.get(e).programs;void 0!==t&&(t.forEach(function(e){ue.releaseProgram(e)}),e.isShaderMaterial&&ue.releaseShaderCache(e))})(e),ne.remove(e)}(t)}function Re(e,t,a){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Ve(e,t,a),e.side=0,e.needsUpdate=!0,Ve(e,t,a),e.side=2):Ve(e,t,a)}this.xr=ke,this.getContext=function(){return Se},this.getContextAttributes=function(){return Se.getContextAttributes()},this.forceContextLoss=function(){const e=Q.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=Q.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(e){void 0!==e&&(B=e,this.setSize(O,F,!1))},this.getSize=function(e){return e.set(O,F)},this.setSize=function(e,a,n=!0){ke.isPresenting?Gx("WebGLRenderer: Can't change size while VR device is presenting."):(O=e,F=a,t.width=Math.floor(e*B),t.height=Math.floor(a*B),!0===n&&(t.style.width=e+"px",t.style.height=a+"px"),null!==S&&S.setSize(t.width,t.height),this.setViewport(0,0,e,a))},this.getDrawingBufferSize=function(e){return e.set(O*B,F*B).floor()},this.setDrawingBufferSize=function(e,a,n){O=e,F=a,B=n,t.width=Math.floor(e*n),t.height=Math.floor(a*n),this.setViewport(0,0,e,a)},this.setEffects=function(e){if(f!==gb){if(e)for(let t=0;t<e.length;t++)if(!0===e[t].isOutputPass){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}S.setEffects(e||[])}else console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.")},this.getCurrentViewport=function(e){return e.copy(R)},this.getViewport=function(e){return e.copy(V)},this.setViewport=function(e,t,a,n){e.isVector4?V.set(e.x,e.y,e.z,e.w):V.set(e,t,a,n),te.viewport(R.copy(V).multiplyScalar(B).round())},this.getScissor=function(e){return e.copy(H)},this.setScissor=function(e,t,a,n){e.isVector4?H.set(e.x,e.y,e.z,e.w):H.set(e,t,a,n),te.scissor(D.copy(H).multiplyScalar(B).round())},this.getScissorTest=function(){return G},this.setScissorTest=function(e){te.setScissorTest(G=e)},this.setOpaqueSort=function(e){U=e},this.setTransparentSort=function(e){z=e},this.getClearColor=function(e){return e.copy(ve.getClearColor())},this.setClearColor=function(){ve.setClearColor(...arguments)},this.getClearAlpha=function(){return ve.getClearAlpha()},this.setClearAlpha=function(){ve.setClearAlpha(...arguments)},this.clear=function(e=!0,t=!0,a=!0){let n=0;if(e){let e=!1;if(null!==A){const t=A.texture.format;e=m.has(t)}if(e){const e=A.texture.type,t=v.has(e),a=ve.getClearColor(),n=ve.getClearAlpha(),r=a.r,i=a.g,o=a.b;t?(g[0]=r,g[1]=i,g[2]=o,g[3]=n,Se.clearBufferuiv(Se.COLOR,0,g)):(y[0]=r,y[1]=i,y[2]=o,y[3]=n,Se.clearBufferiv(Se.COLOR,0,y))}else n|=Se.COLOR_BUFFER_BIT}t&&(n|=Se.DEPTH_BUFFER_BIT),a&&(n|=Se.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Se.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ce,!1),t.removeEventListener("webglcontextrestored",Ae,!1),t.removeEventListener("webglcontextcreationerror",Ee,!1),ve.dispose(),he.dispose(),pe.dispose(),ne.dispose(),ie.dispose(),oe.dispose(),ce.dispose(),we.dispose(),_e.dispose(),ue.dispose(),ke.dispose(),ke.removeEventListener("sessionstart",Pe),ke.removeEventListener("sessionend",Le),Ne.stop()},this.renderBufferDirect=function(e,t,a,n,r,i){null===t&&(t=K);const o=r.isMesh&&r.matrixWorld.determinant()<0,s=function(e,t,a,n,r){!0!==t.isScene&&(t=K);re.resetTextureUnits();const i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,s=null===A?M.outputColorSpace:!0===A.isXRRenderTarget?A.texture.colorSpace:_x,l=(n.isMeshStandardMaterial?oe:ie).get(n.envMap||o),c=!0===n.vertexColors&&!!a.attributes.color&&4===a.attributes.color.itemSize,u=!!a.attributes.tangent&&(!!n.normalMap||n.anisotropy>0),d=!!a.morphAttributes.position,h=!!a.morphAttributes.normal,p=!!a.morphAttributes.color;let f=0;n.toneMapped&&(null!==A&&!0!==A.isXRRenderTarget||(f=M.toneMapping));const m=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,v=void 0!==m?m.length:0,g=ne.get(n),y=x.state.lights;if(!0===q&&(!0===Y||e!==I)){const t=e===I&&n.id===E;fe.setState(n,e,t)}let b=!1;n.version===g.__version?g.needsLights&&g.lightsStateVersion!==y.state.version||g.outputColorSpace!==s||r.isBatchedMesh&&!1===g.batching?b=!0:r.isBatchedMesh||!0!==g.batching?r.isBatchedMesh&&!0===g.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===g.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===g.instancing?b=!0:r.isInstancedMesh||!0!==g.instancing?r.isSkinnedMesh&&!1===g.skinning?b=!0:r.isSkinnedMesh||!0!==g.skinning?r.isInstancedMesh&&!0===g.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===g.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===g.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===g.instancingMorph&&null!==r.morphTexture||g.envMap!==l||!0===n.fog&&g.fog!==i?b=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===fe.numPlanes&&g.numIntersection===fe.numIntersection?(g.vertexAlphas!==c||g.vertexTangents!==u||g.morphTargets!==d||g.morphNormals!==h||g.morphColors!==p||g.toneMapping!==f||g.morphTargetsCount!==v)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,g.__version=n.version);let w=g.currentProgram;!0===b&&(w=Ve(n,t,r));let _=!1,S=!1,T=!1;const k=w.getUniforms(),C=g.uniforms;te.useProgram(w.program)&&(_=!0,S=!0,T=!0);n.id!==E&&(E=n.id,S=!0);if(_||I!==e){te.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),k.setValue(Se,"projectionMatrix",e.projectionMatrix),k.setValue(Se,"viewMatrix",e.matrixWorldInverse);const t=k.map.cameraPosition;void 0!==t&&t.setValue(Se,X.setFromMatrixPosition(e.matrixWorld)),ee.logarithmicDepthBuffer&&k.setValue(Se,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&k.setValue(Se,"isOrthographic",!0===e.isOrthographicCamera),I!==e&&(I=e,S=!0,T=!0)}g.needsLights&&(y.state.directionalShadowMap.length>0&&k.setValue(Se,"directionalShadowMap",y.state.directionalShadowMap,re),y.state.spotShadowMap.length>0&&k.setValue(Se,"spotShadowMap",y.state.spotShadowMap,re),y.state.pointShadowMap.length>0&&k.setValue(Se,"pointShadowMap",y.state.pointShadowMap,re));if(r.isSkinnedMesh){k.setOptional(Se,r,"bindMatrix"),k.setOptional(Se,r,"bindMatrixInverse");const e=r.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),k.setValue(Se,"boneTexture",e.boneTexture,re))}r.isBatchedMesh&&(k.setOptional(Se,r,"batchingTexture"),k.setValue(Se,"batchingTexture",r._matricesTexture,re),k.setOptional(Se,r,"batchingIdTexture"),k.setValue(Se,"batchingIdTexture",r._indirectTexture,re),k.setOptional(Se,r,"batchingColorTexture"),null!==r._colorsTexture&&k.setValue(Se,"batchingColorTexture",r._colorsTexture,re));const R=a.morphAttributes;void 0===R.position&&void 0===R.normal&&void 0===R.color||ge.update(r,a,w);(S||g.receiveShadow!==r.receiveShadow)&&(g.receiveShadow=r.receiveShadow,k.setValue(Se,"receiveShadow",r.receiveShadow));n.isMeshGouraudMaterial&&null!==n.envMap&&(C.envMap.value=l,C.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);n.isMeshStandardMaterial&&null===n.envMap&&null!==t.environment&&(C.envMapIntensity.value=t.environmentIntensity);void 0!==C.dfgLUT&&(C.dfgLUT.value=(null===CA&&(CA=new dM(kA,16,16,Lb,Mb),CA.name="DFG_LUT",CA.minFilter=fb,CA.magFilter=fb,CA.wrapS=cb,CA.wrapT=cb,CA.generateMipmaps=!1,CA.needsUpdate=!0),CA));S&&(k.setValue(Se,"toneMappingExposure",M.toneMappingExposure),g.needsLights&&(P=T,(D=C).ambientLightColor.needsUpdate=P,D.lightProbe.needsUpdate=P,D.directionalLights.needsUpdate=P,D.directionalLightShadows.needsUpdate=P,D.pointLights.needsUpdate=P,D.pointLightShadows.needsUpdate=P,D.spotLights.needsUpdate=P,D.spotLightShadows.needsUpdate=P,D.rectAreaLights.needsUpdate=P,D.hemisphereLights.needsUpdate=P),i&&!0===n.fog&&de.refreshFogUniforms(C,i),de.refreshMaterialUniforms(C,n,B,F,x.state.transmissionRenderTarget[e.id]),SC.upload(Se,He(g),C,re));var D,P;n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(SC.upload(Se,He(g),C,re),n.uniformsNeedUpdate=!1);n.isSpriteMaterial&&k.setValue(Se,"center",r.center);if(k.setValue(Se,"modelViewMatrix",r.modelViewMatrix),k.setValue(Se,"normalMatrix",r.normalMatrix),k.setValue(Se,"modelMatrix",r.matrixWorld),n.isShaderMaterial||n.isRawShaderMaterial){const e=n.uniformsGroups;for(let t=0,a=e.length;t<a;t++){const a=e[t];_e.update(a,w),_e.bind(a,w)}}return w}(e,t,a,n,r);te.setMaterial(n,o);let l=a.index,c=1;if(!0===n.wireframe){if(l=le.getWireframeAttribute(a),void 0===l)return;c=2}const u=a.drawRange,d=a.attributes.position;let h=u.start*c,p=(u.start+u.count)*c;null!==i&&(h=Math.max(h,i.start*c),p=Math.min(p,(i.start+i.count)*c)),null!==l?(h=Math.max(h,0),p=Math.min(p,l.count)):null!=d&&(h=Math.max(h,0),p=Math.min(p,d.count));const f=p-h;if(f<0||f===1/0)return;let m;we.setup(r,n,s,a,l);let v=ye;if(null!==l&&(m=se.get(l),v=be,v.setIndex(m)),r.isMesh)!0===n.wireframe?(te.setLineWidth(n.wireframeLinewidth*J()),v.setMode(Se.LINES)):v.setMode(Se.TRIANGLES);else if(r.isLine){let e=n.linewidth;void 0===e&&(e=1),te.setLineWidth(e*J()),r.isLineSegments?v.setMode(Se.LINES):r.isLineLoop?v.setMode(Se.LINE_LOOP):v.setMode(Se.LINE_STRIP)}else r.isPoints?v.setMode(Se.POINTS):r.isSprite&&v.setMode(Se.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)qx("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if(Q.get("WEBGL_multi_draw"))v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const e=r._multiDrawStarts,t=r._multiDrawCounts,a=r._multiDrawCount,i=l?se.get(l).bytesPerElement:1,o=ne.get(n).currentProgram.getUniforms();for(let n=0;n<a;n++)o.setValue(Se,"_gl_DrawID",n),v.render(e[n]/i,t[n])}else if(r.isInstancedMesh)v.renderInstances(h,f,r.count);else if(a.isInstancedBufferGeometry){const e=void 0!==a._maxInstanceCount?a._maxInstanceCount:1/0,t=Math.min(a.instanceCount,e);v.renderInstances(h,f,t)}else v.render(h,f)},this.compile=function(e,t,a=null){null===a&&(a=e),x=pe.get(a),x.init(t),_.push(x),a.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(x.pushLight(e),e.castShadow&&x.pushShadow(e))}),e!==a&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(x.pushLight(e),e.castShadow&&x.pushShadow(e))}),x.setupLights();const n=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const i=t[r];Re(i,a,e),n.add(i)}else Re(t,a,e),n.add(t)}),x=_.pop(),n},this.compileAsync=function(e,t,a=null){const n=this.compile(e,t,a);return new Promise(t=>{function a(){n.forEach(function(e){ne.get(e).currentProgram.isReady()&&n.delete(e)}),0!==n.size?setTimeout(a,10):t(e)}null!==Q.get("KHR_parallel_shader_compile")?a():setTimeout(a,10)})};let De=null;function Pe(){Ne.stop()}function Le(){Ne.start()}const Ne=new NT;function Oe(e,t,a,n){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)a=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)x.pushLight(e),e.castShadow&&x.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||W.intersectsSprite(e)){n&&$.setFromMatrixPosition(e.matrixWorld).applyMatrix4(j);const t=ce.update(e),r=e.material;r.visible&&b.push(e,t,r,a,$.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||W.intersectsObject(e))){const t=ce.update(e),r=e.material;if(n&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),$.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),$.copy(t.boundingSphere.center)),$.applyMatrix4(e.matrixWorld).applyMatrix4(j)),Array.isArray(r)){const n=t.groups;for(let i=0,o=n.length;i<o;i++){const o=n[i],s=r[o.materialIndex];s&&s.visible&&b.push(e,t,s,a,$.z,o)}}else r.visible&&b.push(e,t,r,a,$.z,null)}const r=e.children;for(let i=0,o=r.length;i<o;i++)Oe(r[i],t,a,n)}function Fe(e,t,a,n){const{opaque:r,transmissive:i,transparent:o}=e;x.setupLightsView(a),!0===q&&fe.setGlobalState(M.clippingPlanes,a),n&&te.viewport(R.copy(n)),r.length>0&&Ue(r,t,a),i.length>0&&Ue(i,t,a),o.length>0&&Ue(o,t,a),te.buffers.depth.setTest(!0),te.buffers.depth.setMask(!0),te.buffers.color.setMask(!0),te.setPolygonOffset(!1)}function Be(e,t,a,n){if(null!==(!0===a.isScene?a.overrideMaterial:null))return;if(void 0===x.state.transmissionRenderTarget[n.id]){const e=Q.has("EXT_color_buffer_half_float")||Q.has("EXT_color_buffer_float");x.state.transmissionRenderTarget[n.id]=new Tw(1,1,{generateMipmaps:!0,type:e?Mb:gb,minFilter:vb,samples:ee.samples,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:hw.workingColorSpace})}const i=x.state.transmissionRenderTarget[n.id],o=n.viewport||R;i.setSize(o.z*M.transmissionResolutionScale,o.w*M.transmissionResolutionScale);const s=M.getRenderTarget(),l=M.getActiveCubeFace(),c=M.getActiveMipmapLevel();M.setRenderTarget(i),M.getClearColor(L),N=M.getClearAlpha(),N<1&&M.setClearColor(16777215,.5),M.clear(),Z&&ve.render(a);const u=M.toneMapping;M.toneMapping=0;const d=n.viewport;if(void 0!==n.viewport&&(n.viewport=void 0),x.setupLightsView(n),!0===q&&fe.setGlobalState(M.clippingPlanes,n),Ue(e,a,n),re.updateMultisampleRenderTarget(i),re.updateRenderTargetMipmap(i),!1===Q.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,i=t.length;r<i;r++){const i=t[r],{object:o,geometry:s,material:l,group:c}=i;if(2===l.side&&o.layers.test(n.layers)){const t=l.side;l.side=1,l.needsUpdate=!0,ze(o,a,n,s,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(re.updateMultisampleRenderTarget(i),re.updateRenderTargetMipmap(i))}M.setRenderTarget(s,l,c),M.setClearColor(L,N),void 0!==d&&(n.viewport=d),M.toneMapping=u}function Ue(e,t,a){const n=!0===t.isScene?t.overrideMaterial:null;for(let r=0,i=e.length;r<i;r++){const i=e[r],{object:o,geometry:s,group:l}=i;let c=i.material;!0===c.allowOverride&&null!==n&&(c=n),o.layers.test(a.layers)&&ze(o,t,a,s,c,l)}}function ze(e,t,a,n,r,i){e.onBeforeRender(M,t,a,n,r,i),e.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(M,t,a,n,e,i),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=1,r.needsUpdate=!0,M.renderBufferDirect(a,t,n,r,e,i),r.side=0,r.needsUpdate=!0,M.renderBufferDirect(a,t,n,r,e,i),r.side=2):M.renderBufferDirect(a,t,n,r,e,i),e.onAfterRender(M,t,a,n,r,i)}function Ve(e,t,a){!0!==t.isScene&&(t=K);const n=ne.get(e),r=x.state.lights,i=x.state.shadowsArray,o=r.state.version,s=ue.getParameters(e,r.state,i,t,a),l=ue.getProgramCacheKey(s);let c=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?oe:ie).get(e.envMap||n.environment),n.envMapRotation=null!==n.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Ie),c=new Map,n.programs=c);let u=c.get(l);if(void 0!==u){if(n.currentProgram===u&&n.lightsStateVersion===o)return Ge(e,s),u}else s.uniforms=ue.getUniforms(e),e.onBeforeCompile(s,M),u=ue.acquireProgram(s,l),c.set(l,u),n.uniforms=s.uniforms;const d=n.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=fe.uniform),Ge(e,s),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=o,n.needsLights&&(d.ambientLightColor.value=r.state.ambient,d.lightProbe.value=r.state.probe,d.directionalLights.value=r.state.directional,d.directionalLightShadows.value=r.state.directionalShadow,d.spotLights.value=r.state.spot,d.spotLightShadows.value=r.state.spotShadow,d.rectAreaLights.value=r.state.rectArea,d.ltc_1.value=r.state.rectAreaLTC1,d.ltc_2.value=r.state.rectAreaLTC2,d.pointLights.value=r.state.point,d.pointLightShadows.value=r.state.pointShadow,d.hemisphereLights.value=r.state.hemi,d.directionalShadowMap.value=r.state.directionalShadowMap,d.directionalShadowMatrix.value=r.state.directionalShadowMatrix,d.spotShadowMap.value=r.state.spotShadowMap,d.spotLightMatrix.value=r.state.spotLightMatrix,d.spotLightMap.value=r.state.spotLightMap,d.pointShadowMap.value=r.state.pointShadowMap,d.pointShadowMatrix.value=r.state.pointShadowMatrix),n.currentProgram=u,n.uniformsList=null,u}function He(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=SC.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Ge(e,t){const a=ne.get(e);a.outputColorSpace=t.outputColorSpace,a.batching=t.batching,a.batchingColor=t.batchingColor,a.instancing=t.instancing,a.instancingColor=t.instancingColor,a.instancingMorph=t.instancingMorph,a.skinning=t.skinning,a.morphTargets=t.morphTargets,a.morphNormals=t.morphNormals,a.morphColors=t.morphColors,a.morphTargetsCount=t.morphTargetsCount,a.numClippingPlanes=t.numClippingPlanes,a.numIntersection=t.numClipIntersection,a.vertexAlphas=t.vertexAlphas,a.vertexTangents=t.vertexTangents,a.toneMapping=t.toneMapping}Ne.setAnimationLoop(function(e){De&&De(e)}),"undefined"!=typeof self&&Ne.setContext(self),this.setAnimationLoop=function(e){De=e,ke.setAnimationLoop(e),null===e?Ne.stop():Ne.start()},ke.addEventListener("sessionstart",Pe),ke.addEventListener("sessionend",Le),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void Wx("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===T)return;const a=!0===ke.enabled&&!0===ke.isPresenting,n=null!==S&&(null===A||a)&&S.begin(M,A);if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0!==ke.enabled||!0!==ke.isPresenting||null!==S&&!1!==S.isCompositing()||(!0===ke.cameraAutoUpdate&&ke.updateCamera(t),t=ke.getCamera()),!0===e.isScene&&e.onBeforeRender(M,e,t,A),x=pe.get(e,_.length),x.init(t),_.push(x),j.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),W.setFromProjectionMatrix(j,Ox,t.reversedDepth),Y=this.localClippingEnabled,q=fe.init(this.clippingPlanes,Y),b=he.get(e,w.length),b.init(),w.push(b),!0===ke.enabled&&!0===ke.isPresenting){const e=M.xr.getDepthSensingMesh();null!==e&&Oe(e,t,-1/0,M.sortObjects)}Oe(e,t,0,M.sortObjects),b.finish(),!0===M.sortObjects&&b.sort(U,z),Z=!1===ke.enabled||!1===ke.isPresenting||!1===ke.hasDepthSensing(),Z&&ve.addToRenderList(b,e),this.info.render.frame++,!0===q&&fe.beginShadows();const r=x.state.shadowsArray;me.render(r,e,t),!0===q&&fe.endShadows(),!0===this.info.autoReset&&this.info.reset();if(!1===(n&&S.hasRenderPass())){const a=b.opaque,n=b.transmissive;if(x.setupLights(),t.isArrayCamera){const r=t.cameras;if(n.length>0)for(let t=0,i=r.length;t<i;t++){Be(a,n,e,r[t])}Z&&ve.render(e);for(let t=0,a=r.length;t<a;t++){const a=r[t];Fe(b,e,a,a.viewport)}}else n.length>0&&Be(a,n,e,t),Z&&ve.render(e),Fe(b,e,t)}null!==A&&0===C&&(re.updateMultisampleRenderTarget(A),re.updateRenderTargetMipmap(A)),n&&S.end(M),!0===e.isScene&&e.onAfterRender(M,e,t),we.resetDefaultState(),E=-1,I=null,_.pop(),_.length>0?(x=_[_.length-1],!0===q&&fe.setGlobalState(M.clippingPlanes,x.state.camera)):x=null,w.pop(),b=w.length>0?w[w.length-1]:null},this.getActiveCubeFace=function(){return k},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(e,t,a){const n=ne.get(e);n.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===n.__autoAllocateDepthBuffer&&(n.__useRenderToTexture=!1),ne.get(e.texture).__webglTexture=t,ne.get(e.depthTexture).__webglTexture=n.__autoAllocateDepthBuffer?void 0:a,n.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const a=ne.get(e);a.__webglFramebuffer=t,a.__useDefaultFramebuffer=void 0===t};const We=Se.createFramebuffer();this.setRenderTarget=function(e,t=0,a=0){A=e,k=t,C=a;let n=null,r=!1,i=!1;if(e){const o=ne.get(e);if(void 0!==o.__useDefaultFramebuffer)return te.bindFramebuffer(Se.FRAMEBUFFER,o.__webglFramebuffer),R.copy(e.viewport),D.copy(e.scissor),P=e.scissorTest,te.viewport(R),te.scissor(D),te.setScissorTest(P),void(E=-1);if(void 0===o.__webglFramebuffer)re.setupRenderTarget(e);else if(o.__hasExternalTextures)re.rebindTextures(e,ne.get(e.texture).__webglTexture,ne.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(o.__boundDepthTexture!==t){if(null!==t&&ne.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");re.setupDepthRenderbuffer(e)}}const s=e.texture;(s.isData3DTexture||s.isDataArrayTexture||s.isCompressedArrayTexture)&&(i=!0);const l=ne.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(n=Array.isArray(l[t])?l[t][a]:l[t],r=!0):n=e.samples>0&&!1===re.useMultisampledRTT(e)?ne.get(e).__webglMultisampledFramebuffer:Array.isArray(l)?l[a]:l,R.copy(e.viewport),D.copy(e.scissor),P=e.scissorTest}else R.copy(V).multiplyScalar(B).floor(),D.copy(H).multiplyScalar(B).floor(),P=G;0!==a&&(n=We);if(te.bindFramebuffer(Se.FRAMEBUFFER,n)&&te.drawBuffers(e,n),te.viewport(R),te.scissor(D),te.setScissorTest(P),r){const n=ne.get(e.texture);Se.framebufferTexture2D(Se.FRAMEBUFFER,Se.COLOR_ATTACHMENT0,Se.TEXTURE_CUBE_MAP_POSITIVE_X+t,n.__webglTexture,a)}else if(i){const n=t;for(let t=0;t<e.textures.length;t++){const r=ne.get(e.textures[t]);Se.framebufferTextureLayer(Se.FRAMEBUFFER,Se.COLOR_ATTACHMENT0+t,r.__webglTexture,a,n)}}else if(null!==e&&0!==a){const t=ne.get(e.texture);Se.framebufferTexture2D(Se.FRAMEBUFFER,Se.COLOR_ATTACHMENT0,Se.TEXTURE_2D,t.__webglTexture,a)}E=-1},this.readRenderTargetPixels=function(e,t,a,n,r,i,o,s=0){if(!e||!e.isWebGLRenderTarget)return void Wx("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=ne.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){te.bindFramebuffer(Se.FRAMEBUFFER,l);try{const o=e.textures[s],l=o.format,c=o.type;if(!ee.textureFormatReadable(l))return void Wx("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!ee.textureTypeReadable(c))return void Wx("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-n&&a>=0&&a<=e.height-r&&(e.textures.length>1&&Se.readBuffer(Se.COLOR_ATTACHMENT0+s),Se.readPixels(t,a,n,r,xe.convert(l),xe.convert(c),i))}finally{const e=null!==A?ne.get(A).__webglFramebuffer:null;te.bindFramebuffer(Se.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,a,n,r,i,o,s=0){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=ne.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(l=l[o]),l){if(t>=0&&t<=e.width-n&&a>=0&&a<=e.height-r){te.bindFramebuffer(Se.FRAMEBUFFER,l);const o=e.textures[s],c=o.format,u=o.type;if(!ee.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ee.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const d=Se.createBuffer();Se.bindBuffer(Se.PIXEL_PACK_BUFFER,d),Se.bufferData(Se.PIXEL_PACK_BUFFER,i.byteLength,Se.STREAM_READ),e.textures.length>1&&Se.readBuffer(Se.COLOR_ATTACHMENT0+s),Se.readPixels(t,a,n,r,xe.convert(c),xe.convert(u),0);const h=null!==A?ne.get(A).__webglFramebuffer:null;te.bindFramebuffer(Se.FRAMEBUFFER,h);const p=Se.fenceSync(Se.SYNC_GPU_COMMANDS_COMPLETE,0);return Se.flush(),await function(e,t,a){return new Promise(function(n,r){setTimeout(function i(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(i,a);break;default:n()}},a)})}(Se,p,4),Se.bindBuffer(Se.PIXEL_PACK_BUFFER,d),Se.getBufferSubData(Se.PIXEL_PACK_BUFFER,0,i),Se.deleteBuffer(d),Se.deleteSync(p),i}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,a=0){const n=Math.pow(2,-a),r=Math.floor(e.image.width*n),i=Math.floor(e.image.height*n),o=null!==t?t.x:0,s=null!==t?t.y:0;re.setTexture2D(e,0),Se.copyTexSubImage2D(Se.TEXTURE_2D,a,0,0,o,s,r,i),te.unbindTexture()};const qe=Se.createFramebuffer(),Ye=Se.createFramebuffer();this.copyTextureToTexture=function(e,t,a=null,n=null,r=0,i=null){let o,s,l,c,u,d,h,p,f;null===i&&(0!==r?(qx("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),i=r,r=0):i=0);const m=e.isCompressedTexture?e.mipmaps[i]:e.image;if(null!==a)o=a.max.x-a.min.x,s=a.max.y-a.min.y,l=a.isBox3?a.max.z-a.min.z:1,c=a.min.x,u=a.min.y,d=a.isBox3?a.min.z:0;else{const t=Math.pow(2,-r);o=Math.floor(m.width*t),s=Math.floor(m.height*t),l=e.isDataArrayTexture?m.depth:e.isData3DTexture?Math.floor(m.depth*t):1,c=0,u=0,d=0}null!==n?(h=n.x,p=n.y,f=n.z):(h=0,p=0,f=0);const v=xe.convert(t.format),g=xe.convert(t.type);let y;t.isData3DTexture?(re.setTexture3D(t,0),y=Se.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(re.setTexture2DArray(t,0),y=Se.TEXTURE_2D_ARRAY):(re.setTexture2D(t,0),y=Se.TEXTURE_2D),Se.pixelStorei(Se.UNPACK_FLIP_Y_WEBGL,t.flipY),Se.pixelStorei(Se.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Se.pixelStorei(Se.UNPACK_ALIGNMENT,t.unpackAlignment);const b=Se.getParameter(Se.UNPACK_ROW_LENGTH),x=Se.getParameter(Se.UNPACK_IMAGE_HEIGHT),w=Se.getParameter(Se.UNPACK_SKIP_PIXELS),_=Se.getParameter(Se.UNPACK_SKIP_ROWS),S=Se.getParameter(Se.UNPACK_SKIP_IMAGES);Se.pixelStorei(Se.UNPACK_ROW_LENGTH,m.width),Se.pixelStorei(Se.UNPACK_IMAGE_HEIGHT,m.height),Se.pixelStorei(Se.UNPACK_SKIP_PIXELS,c),Se.pixelStorei(Se.UNPACK_SKIP_ROWS,u),Se.pixelStorei(Se.UNPACK_SKIP_IMAGES,d);const M=e.isDataArrayTexture||e.isData3DTexture,T=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const a=ne.get(e),n=ne.get(t),m=ne.get(a.__renderTarget),v=ne.get(n.__renderTarget);te.bindFramebuffer(Se.READ_FRAMEBUFFER,m.__webglFramebuffer),te.bindFramebuffer(Se.DRAW_FRAMEBUFFER,v.__webglFramebuffer);for(let g=0;g<l;g++)M&&(Se.framebufferTextureLayer(Se.READ_FRAMEBUFFER,Se.COLOR_ATTACHMENT0,ne.get(e).__webglTexture,r,d+g),Se.framebufferTextureLayer(Se.DRAW_FRAMEBUFFER,Se.COLOR_ATTACHMENT0,ne.get(t).__webglTexture,i,f+g)),Se.blitFramebuffer(c,u,o,s,h,p,o,s,Se.DEPTH_BUFFER_BIT,Se.NEAREST);te.bindFramebuffer(Se.READ_FRAMEBUFFER,null),te.bindFramebuffer(Se.DRAW_FRAMEBUFFER,null)}else if(0!==r||e.isRenderTargetTexture||ne.has(e)){const a=ne.get(e),n=ne.get(t);te.bindFramebuffer(Se.READ_FRAMEBUFFER,qe),te.bindFramebuffer(Se.DRAW_FRAMEBUFFER,Ye);for(let e=0;e<l;e++)M?Se.framebufferTextureLayer(Se.READ_FRAMEBUFFER,Se.COLOR_ATTACHMENT0,a.__webglTexture,r,d+e):Se.framebufferTexture2D(Se.READ_FRAMEBUFFER,Se.COLOR_ATTACHMENT0,Se.TEXTURE_2D,a.__webglTexture,r),T?Se.framebufferTextureLayer(Se.DRAW_FRAMEBUFFER,Se.COLOR_ATTACHMENT0,n.__webglTexture,i,f+e):Se.framebufferTexture2D(Se.DRAW_FRAMEBUFFER,Se.COLOR_ATTACHMENT0,Se.TEXTURE_2D,n.__webglTexture,i),0!==r?Se.blitFramebuffer(c,u,o,s,h,p,o,s,Se.COLOR_BUFFER_BIT,Se.NEAREST):T?Se.copyTexSubImage3D(y,i,h,p,f+e,c,u,o,s):Se.copyTexSubImage2D(y,i,h,p,c,u,o,s);te.bindFramebuffer(Se.READ_FRAMEBUFFER,null),te.bindFramebuffer(Se.DRAW_FRAMEBUFFER,null)}else T?e.isDataTexture||e.isData3DTexture?Se.texSubImage3D(y,i,h,p,f,o,s,l,v,g,m.data):t.isCompressedArrayTexture?Se.compressedTexSubImage3D(y,i,h,p,f,o,s,l,v,m.data):Se.texSubImage3D(y,i,h,p,f,o,s,l,v,g,m):e.isDataTexture?Se.texSubImage2D(Se.TEXTURE_2D,i,h,p,o,s,v,g,m.data):e.isCompressedTexture?Se.compressedTexSubImage2D(Se.TEXTURE_2D,i,h,p,m.width,m.height,v,m.data):Se.texSubImage2D(Se.TEXTURE_2D,i,h,p,o,s,v,g,m);Se.pixelStorei(Se.UNPACK_ROW_LENGTH,b),Se.pixelStorei(Se.UNPACK_IMAGE_HEIGHT,x),Se.pixelStorei(Se.UNPACK_SKIP_PIXELS,w),Se.pixelStorei(Se.UNPACK_SKIP_ROWS,_),Se.pixelStorei(Se.UNPACK_SKIP_IMAGES,S),0===i&&t.generateMipmaps&&Se.generateMipmap(y),te.unbindTexture()},this.initRenderTarget=function(e){void 0===ne.get(e).__webglFramebuffer&&re.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?re.setTextureCube(e,0):e.isData3DTexture?re.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?re.setTexture2DArray(e,0):re.setTexture2D(e,0),te.unbindTexture()},this.resetState=function(){k=0,C=0,A=null,te.reset(),we.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ox}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=hw._getDrawingBufferColorSpace(e),t.unpackColorSpace=hw._getUnpackColorSpace()}}const EA={type:"change"},IA={type:"start"},RA={type:"end"},DA=new e_,PA=new mM,LA=Math.cos(70*tw),NA=new rw,OA=2*Math.PI,FA=-1,BA=0,UA=1,zA=2,VA=3,HA=4,GA=5,WA=6,qA=1e-6;class YA extends PT{constructor(e,t=null){super(e,t),this.state=FA,this.target=new rw,this.cursor=new rw,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:dy,MIDDLE:hy,RIGHT:py},this.touches={ONE:fy,TWO:vy},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new rw,this._lastQuaternion=new nw,this._lastTargetPosition=new rw,this._quat=(new nw).setFromUnitVectors(e.up,new rw(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new CT,this._sphericalDelta=new CT,this._scale=1,this._panOffset=new rw,this._rotateStart=new aw,this._rotateEnd=new aw,this._rotateDelta=new aw,this._panStart=new aw,this._panEnd=new aw,this._panDelta=new aw,this._dollyStart=new aw,this._dollyEnd=new aw,this._dollyDelta=new aw,this._dollyDirection=new rw,this._mouse=new aw,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=XA.bind(this),this._onPointerDown=jA.bind(this),this._onPointerUp=$A.bind(this),this._onContextMenu=aE.bind(this),this._onMouseWheel=JA.bind(this),this._onKeyDown=QA.bind(this),this._onTouchStart=eE.bind(this),this._onTouchMove=tE.bind(this),this._onMouseDown=KA.bind(this),this._onMouseMove=ZA.bind(this),this._interceptControlDown=nE.bind(this),this._interceptControlUp=rE.bind(this),null!==this.domElement&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1});this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents();this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(EA),this.update(),this.state=FA}update(e=null){const t=this.object.position;NA.copy(t).sub(this.target),NA.applyQuaternion(this._quat),this._spherical.setFromVector3(NA),this.autoRotate&&this.state===FA&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let a=this.minAzimuthAngle,n=this.maxAzimuthAngle;isFinite(a)&&isFinite(n)&&(a<-Math.PI?a+=OA:a>Math.PI&&(a-=OA),n<-Math.PI?n+=OA:n>Math.PI&&(n-=OA),this._spherical.theta=a<=n?Math.max(a,Math.min(n,this._spherical.theta)):this._spherical.theta>(a+n)/2?Math.max(a,this._spherical.theta):Math.min(n,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const e=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=e!=this._spherical.radius}if(NA.setFromSpherical(this._spherical),NA.applyQuaternion(this._quatInverse),t.copy(this.target).add(NA),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let e=null;if(this.object.isPerspectiveCamera){const t=NA.length();e=this._clampDistance(t*this._scale);const a=t-e;this.object.position.addScaledVector(this._dollyDirection,a),this.object.updateMatrixWorld(),r=!!a}else if(this.object.isOrthographicCamera){const t=new rw(this._mouse.x,this._mouse.y,0);t.unproject(this.object);const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=a!==this.object.zoom;const n=new rw(this._mouse.x,this._mouse.y,0);n.unproject(this.object),this.object.position.sub(n).add(t),this.object.updateMatrixWorld(),e=NA.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==e&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(e).add(this.object.position):(DA.origin.copy(this.object.position),DA.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(DA.direction))<LA?this.object.lookAt(this.target):(PA.setFromNormalAndCoplanarPoint(this.object.up,this.target),DA.intersectPlane(PA,this.target))))}else if(this.object.isOrthographicCamera){const e=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),e!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,!!(r||this._lastPosition.distanceToSquared(this.object.position)>qA||8*(1-this._lastQuaternion.dot(this.object.quaternion))>qA||this._lastTargetPosition.distanceToSquared(this.target)>qA)&&(this.dispatchEvent(EA),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?OA/60*this.autoRotateSpeed*e:OA/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){NA.setFromMatrixColumn(t,0),NA.multiplyScalar(-e),this._panOffset.add(NA)}_panUp(e,t){!0===this.screenSpacePanning?NA.setFromMatrixColumn(t,1):(NA.setFromMatrixColumn(t,0),NA.crossVectors(this.object.up,NA)),NA.multiplyScalar(e),this._panOffset.add(NA)}_pan(e,t){const a=this.domElement;if(this.object.isPerspectiveCamera){const n=this.object.position;NA.copy(n).sub(this.target);let r=NA.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*r/a.clientHeight,this.object.matrix),this._panUp(2*t*r/a.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/a.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/a.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const a=this.domElement.getBoundingClientRect(),n=e-a.left,r=t-a.top,i=a.width,o=a.height;this._mouse.x=n/i*2-1,this._mouse.y=-r/o*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(OA*this._rotateDelta.x/t.clientHeight),this._rotateUp(OA*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(OA*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-OA*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(OA*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-OA*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),a=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._rotateStart.set(a,n)}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),a=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._panStart.set(a,n)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),a=e.pageX-t.x,n=e.pageY-t.y,r=Math.sqrt(a*a+n*n);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),a=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._rotateEnd.set(a,n)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(OA*this._rotateDelta.x/t.clientHeight),this._rotateUp(OA*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),a=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._panEnd.set(a,n)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),a=e.pageX-t.x,n=e.pageY-t.y,r=Math.sqrt(a*a+n*n);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const i=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);this._updateZoomParameters(i,o)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new aw,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,a={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:a.deltaY*=16;break;case 2:a.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(a.deltaY*=10),a}}function jA(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(e)||(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e)))}function XA(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function $A(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(RA),this.state=FA;break;case 1:const t=this._pointers[0],a=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:a.x,pageY:a.y})}}function KA(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case hy:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=UA;break;case dy:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=zA}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=BA}break;case py:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=BA}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=zA}break;default:this.state=FA}this.state!==FA&&this.dispatchEvent(IA)}function ZA(e){switch(this.state){case BA:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case UA:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case zA:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function JA(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===FA&&(e.preventDefault(),this.dispatchEvent(IA),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(RA))}function QA(e){!1!==this.enabled&&this._handleKeyDown(e)}function eE(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case fy:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=VA;break;case my:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=HA;break;default:this.state=FA}break;case 2:switch(this.touches.TWO){case vy:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=GA;break;case gy:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=WA;break;default:this.state=FA}break;default:this.state=FA}this.state!==FA&&this.dispatchEvent(IA)}function tE(e){switch(this._trackPointer(e),this.state){case VA:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case HA:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case GA:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case WA:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=FA}}function aE(e){!1!==this.enabled&&e.preventDefault()}function nE(e){if("Control"===e.key){this._controlActive=!0;this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0})}}function rE(e){if("Control"===e.key){this._controlActive=!1;this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0})}}let iE=null;class oE{scene;camera;renderer;controls;container;trajectoryLine=null;trajectoryPoints=null;trajectoryNodes=[];transitionMarkers=[];regimeEllipsoids=[];regimeCentroids=[];axesHelper=null;gridHelper=null;marketData=[];hmmModel=null;regimeConfigs=[];regimeSphereRadii=new Map;animationId=null;isAnimating=!1;autoRotate=!1;autoAnimationPlaying=!1;autoAnimationStartTime=0;autoAnimationDuration=5e3;raycaster=null;mouse=new aw;hoveredObject=null;onHoverCallback=null;showTrajectory=!0;showEllipsoids=!0;showCentroids=!1;showGrid=!0;currentTimeIndex=0;showTransitionArrows=!1;transitionArrows=[];renaissanceMode=!1;selectedTimeframe="daily";nonRandomSegments=[];arbitrageZones=[];meanReversionBands=[];momentumArrows=[];signalMarkers=[];probabilityWaves=[];decodingParticles=[];portfolioHeatmap=null;comparisonOverlay=null;constructor(e){this.container=e,this.initScene(),this.initCamera(),this.initRenderer(),this.initControls(),this.initLighting(),this.initInteractivity(),this.animate()}initScene(){this.scene=new qS,this.scene.background=new j_(0),this.scene.fog=new WS(0,.008)}initCamera(){const e=this.container.clientWidth,t=this.container.clientHeight;this.camera=new OS(60,e/t,.1,1e3),this.camera.position.set(90,90,90),this.camera.lookAt(60,40,60)}initRenderer(){this.renderer=new AA({antialias:!0,alpha:!0,powerPreference:"high-performance"}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=2,this.container.appendChild(this.renderer.domElement)}initControls(){this.controls=new YA(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.minDistance=10,this.controls.maxDistance=200,this.controls.maxPolarAngle=Math.PI,this.controls.target.set(60,40,60),this.controls.update()}initLighting(){const e=new wT(16777215,.6);this.scene.add(e);const t=new xT(6333946,.7);t.position.set(30,30,30),t.castShadow=!0,this.scene.add(t);const a=new xT(10980346,.5);a.position.set(-30,30,-30),this.scene.add(a);const n=new xT(4906624,.4);n.position.set(0,-30,0),this.scene.add(n)}initInteractivity(){this.raycaster=new MT;this.renderer.domElement.addEventListener("mousemove",e=>{if(!this.renderer||!this.camera)return;const t=this.renderer.domElement.getBoundingClientRect();this.mouse.x=(e.clientX-t.left)/t.width*2-1,this.mouse.y=-(e.clientY-t.top)/t.height*2+1,this.updateHover()}),this.renderer.domElement.addEventListener("mouseout",()=>{this.hoveredObject&&(this.hoveredObject=null,this.onHoverCallback&&this.onHoverCallback(null))})}updateHover(){if(!this.raycaster||!this.camera)return;this.raycaster.setFromCamera(this.mouse,this.camera);let e=null,t=1/0;const a=[...this.trajectoryNodes];if(this.regimeEllipsoids.forEach(e=>{e.children.forEach(e=>{e instanceof MS&&e.userData.point&&!a.includes(e)&&a.push(e)})}),a.length>0){const n=this.raycaster.intersectObjects(a,!1);n.length>0&&n[0].distance<t&&(e=n[0].object,t=n[0].distance)}if(this.regimeCentroids.length>0){const a=this.raycaster.intersectObjects(this.regimeCentroids,!1);a.length>0&&a[0].distance<t&&(e=a[0].object,t=a[0].distance)}if(!e||t>5){const a=[];if(this.regimeEllipsoids.forEach(e=>{e.children.forEach(e=>{e instanceof MS&&!(e instanceof DM)&&a.push(e)})}),a.length>0){const n=this.raycaster.intersectObjects(a,!1);n.length>0&&!e&&(e=n[0].object,t=n[0].distance)}}if(e){if(this.hoveredObject!==e){this.hoveredObject=e;const t=this.getHoverInfo(e);this.onHoverCallback&&this.onHoverCallback(t)}}else this.hoveredObject&&(this.hoveredObject=null,this.onHoverCallback&&this.onHoverCallback(null))}getHoverInfo(e){for(const t of this.trajectoryNodes)if(t===e)return this.createTrajectoryNodeInfo(t);for(const t of this.regimeEllipsoids)for(const a of t.children)if(a===e&&a instanceof MS&&a.userData.point)return this.createTrajectoryNodeInfo(a);for(const t of this.regimeCentroids)if(t===e||t.parent&&t.parent.children.includes(e)){const e=t.userData.config;if(e&&this.hmmModel){const a=this.hmmModel.getEmissionMeans()[e.id];return{type:"centroid",title:`Ядро режима: ${e.name}`,data:{"Режим":e.name,"Доходность (mean)":a&&void 0!==a[0]?(100*a[0]).toFixed(2)+"%":"N/A","Волатильность (mean)":a&&void 0!==a[1]?a[1].toFixed(2)+"%":"N/A","Ликвидность (mean)":a&&void 0!==a[2]?a[2].toFixed(3):"N/A",X:t.position.x.toFixed(2),Y:t.position.y.toFixed(2),Z:t.position.z.toFixed(2)},position:[t.position.x,t.position.y,t.position.z]}}}for(let t=0;t<this.regimeEllipsoids.length;t++){const a=this.regimeEllipsoids[t];let n=!1,r=null;if(a===e)n=!0,r=a.children.find(e=>e instanceof MS)||a;else for(const t of a.children)if(t===e){n=!0,r=t;break}if(n&&r){const e=a.userData?.regimeId??t,n=a.userData?.config||this.regimeConfigs.find(t=>t.id===e);if(n&&this.hmmModel){const e=this.hmmModel.getEmissionMeans()[n.id],t=this.regimeSphereRadii.get(n.id)||0,i=r.position.clone();return 0===i.lengthSq()&&a.children[0]&&i.copy(a.children[0].position),{type:"ellipsoid",title:`Сфера режима: ${n.name}`,data:{"Режим":n.name,"Радиус сферы":t.toFixed(2),"Доходность (mean)":e&&void 0!==e[0]?(100*e[0]).toFixed(2)+"%":"N/A","Волатильность (mean)":e&&void 0!==e[1]?e[1].toFixed(2)+"%":"N/A","Ликвидность (mean)":e&&void 0!==e[2]?e[2].toFixed(3):"N/A","Позиция X":i.x.toFixed(2),"Позиция Y":i.y.toFixed(2),"Позиция Z":i.z.toFixed(2),"Наблюдений в режиме":String(this.marketData.filter(e=>(e.regime||0)===n.id).length)},position:[i.x,i.y,i.z]}}}}return null}createTrajectoryNodeInfo(e){const t=e.userData,a=t.point;return a?{type:"trajectory-node",title:`Наблюдение #${t.timeIndex??"N/A"}`,data:{"Индекс":String(t.timeIndex??0),"Режим ID":String(t.regimeId??0),"Дата":a.date||"N/A","Доходность":void 0!==a.return?(100*a.return).toFixed(2)+"%":"N/A","Волатильность":void 0!==a.volatility?a.volatility.toFixed(2)+"%":"N/A","Ликвидность":void 0!==a.liquidity?a.liquidity.toFixed(3):"N/A","Режим":this.getRegimeName(t.regimeId??0),X:e.position.x.toFixed(2),Y:e.position.y.toFixed(2),Z:e.position.z.toFixed(2),point:a},position:[e.position.x,e.position.y,e.position.z]}:null}getRegimeName(e){const t=this.regimeConfigs.find(t=>t.id===e);return t?t.name:`Режим ${e}`}setOnHover(e){this.onHoverCallback=e}setData(e,t,a){console.log("RegimeSpaceRenderer.setData called:",{marketDataLength:e.length,hmmModelExists:!!t,regimeConfigsLength:a.length,showTrajectory:this.showTrajectory,samplePoint:e.length>0?e[0]:null}),this.marketData=e,this.hmmModel=t,this.regimeConfigs=a,this.currentTimeIndex=e.length-1,this.updateVisualization(),console.log("After updateVisualization:",{trajectoryNodesCount:this.trajectoryNodes.length,trajectoryLineExists:!!this.trajectoryLine,regimeEllipsoidsCount:this.regimeEllipsoids.length})}updateVisualization(){this.clearScene(),this.createAxes(),this.createGrid(),this.createRegimeEllipsoids(),this.createRegimeCentroids(),this.createTrajectory(),this.showTransitionArrows&&this.createTransitionArrows()}clearScene(){this.trajectoryLine&&this.scene.remove(this.trajectoryLine),this.trajectoryPoints&&this.scene.remove(this.trajectoryPoints),this.trajectoryNodes.forEach(e=>this.scene.remove(e)),this.transitionMarkers.forEach(e=>this.scene.remove(e)),this.axesHelper&&this.scene.remove(this.axesHelper),this.gridHelper&&this.scene.remove(this.gridHelper),this.regimeEllipsoids.forEach(e=>this.scene.remove(e)),this.regimeCentroids.forEach(e=>{e.parent&&this.scene.remove(e.parent)}),this.transitionArrows.forEach(e=>this.scene.remove(e)),this.clearRenaissanceOverlays(),this.regimeEllipsoids=[],this.regimeCentroids=[],this.transitionArrows=[],this.transitionMarkers=[]}getRegimeXPosition(e){if(!this.hmmModel)return 0;const t=this.hmmModel.getEmissionMeans();if(!t||!Array.isArray(t))return 0;const a=[];if(t.forEach((e,t)=>{if(e&&Array.isArray(e)&&e.length>=3){const n=void 0!==e[1]?e[1]:0;a.push({id:t,volatility:n})}}),0===a.length)return 0;a.sort((e,t)=>e.volatility-t.volatility);let n=a.map(e=>e.id).indexOf(e);3===a.length&&2===n?n=1:3===a.length&&1===n&&(n=2);return 15+n*(a.length>1?85/(a.length-1):0)}getRegimeZPosition(e){if(!this.hmmModel)return 0;const t=this.hmmModel.getEmissionMeans();if(!t||!Array.isArray(t))return 0;const a=[];if(t.forEach((e,t)=>{if(e&&Array.isArray(e)&&e.length>=3){const n=void 0!==e[1]?e[1]:0;a.push({id:t,volatility:n})}}),0===a.length)return 0;a.sort((e,t)=>e.volatility-t.volatility);let n=a.map(e=>e.id).indexOf(e);3===a.length&&2===n?n=1:3===a.length&&1===n&&(n=2);return 15+n*(a.length>1?85/(a.length-1):0)}getRegimePosition(e){if(!this.hmmModel)return new rw(0,0,0);const t=this.hmmModel.getEmissionMeans();if(!t||!t[e]||!Array.isArray(t[e]))return new rw(0,0,0);const a=t[e],n=this.getRegimeZPosition(e),r=Math.max(0,void 0!==a[1]?a[1]:0),i=this.getRegimeXPosition(e);return new rw(n,r,i)}getRegimeColorByVolatility(e){return e<15?"#60a5fa":e<=30?"#fb923c":"#ef4444"}createTransitionArrows(){if(!this.hmmModel||0===this.marketData.length)return;const e=this.marketData[this.currentTimeIndex];if(!e||void 0===e.regime)return;const t=this.hmmModel.getTransitionMatrix(),a=e.regime;if(!this.regimeConfigs.find(e=>e.id===a))return;const n=this.getRegimePosition(a);t[a].forEach((e,t)=>{if(t===a||e<.1)return;const r=this.regimeConfigs.find(e=>e.id===t);if(!r)return;const i=this.getRegimePosition(t),o=new rw;o.subVectors(i,n);const s=o.length();if(s<5)return;o.normalize();const l=e,c=new j_(r.color),u=new DT(o,n,.8*s,c.getHex(),2,1),d=u.line.material;d.opacity=l,d.transparent=!0,this.transitionArrows.push(u),this.scene.add(u)})}createAxes(){this.axesHelper=new VS,this.scene.add(this.axesHelper)}addAxisLabel(e,t,a,n){const r=document.createElement("canvas");r.width=512,r.height=256;const i=r.getContext("2d");i.fillStyle=`#${a.toString(16).padStart(6,"0")}`,i.font="bold 48px Arial",i.textAlign="center",i.textBaseline="middle",i.fillText(e,256,128);const o=new zM(r);o.needsUpdate=!0;const s=new $S({map:o}),l=new cM(s);l.scale.set(8,4,1),l.position.copy(t),n.add(l)}createGrid(){if(!this.showGrid)return;const e=new VS,t=new xM({color:16777215,opacity:1,transparent:!1}),a=new xM({color:16777215,opacity:.7,transparent:!0}),n=120;for(let s=0;s<=24;s++){const r=5*s,i=new hS,o=new Float32Array([0,0,r,n,0,r]);i.setAttribute("position",new tS(o,3));const l=new AM(i,s%4==0?t:a);e.add(l)}for(let s=0;s<=24;s++){const r=5*s,i=new hS,o=new Float32Array([r,0,0,r,0,n]);i.setAttribute("position",new tS(o,3));const l=new AM(i,s%4==0?t:a);e.add(l)}for(let s=0;s<=24;s++){const n=5*s,r=new hS,i=new Float32Array([0,0,n,0,80,n]);r.setAttribute("position",new tS(i,3));const o=new AM(r,s%4==0?t:a);e.add(o)}for(let s=0;s<=16;s++){const r=5*s,i=new hS,o=new Float32Array([0,r,0,0,r,n]);i.setAttribute("position",new tS(o,3));const l=new AM(i,s%4==0?t:a);e.add(l)}const r=this.createAxisLabelAtEnd("Return",new rw(n,5,10),6333946);r&&e.add(r);const i=this.createAxisLabelAtEnd("Volatility",new rw(5,80,10),10980346);i&&e.add(i);const o=this.createAxisLabelAtEnd("Liquidity",new rw(10,5,n),4906624);o&&e.add(o),this.gridHelper=e,this.scene.add(e)}createLongAxisLabel(e,t,a,n){try{const r=new VS,i=a.length(),o=a.clone().normalize(),s=t.clone().add(o.clone().multiplyScalar(i/2)),l=document.createElement("canvas");l.width=8192,l.height=2048;const c=l.getContext("2d");if(!c)return null;c.fillStyle=`#${n.toString(16).padStart(6,"0")}`,c.font="bold 200px Arial",c.textAlign="center",c.textBaseline="middle",c.fillText(e,l.width/2,l.height/2);const u=new zM(l);u.needsUpdate=!0;const d=new $S({map:u,transparent:!0,alphaTest:.1}),h=new cM(d);if(h.scale.set(.9*i,25,1),h.position.copy(s),0===o.y&&(h.position.y+=2),0!==o.x||0!==o.z){const e=Math.atan2(o.x,o.z);h.rotation.y=e}else 0!==o.y&&(h.rotation.x=Math.PI/2);return r.add(h),r}catch(QXe){return console.error("Error creating long axis label:",QXe),null}}createAxisLabelAtEnd(e,t,a){try{const n=document.createElement("canvas");n.width=2048,n.height=512;const r=n.getContext("2d");if(!r)return null;r.fillStyle=`#${a.toString(16).padStart(6,"0")}`,r.font="bold 120px Arial",r.textAlign="center",r.textBaseline="middle",r.fillText(e,n.width/2,n.height/2);const i=new zM(n);i.needsUpdate=!0;const o=new $S({map:i,transparent:!0,alphaTest:.1}),s=new cM(o);return s.scale.set(20,5,1),s.position.copy(t),s}catch(QXe){return console.error("Error creating axis label at end:",QXe),null}}createGridLabel(e,t,a,n=!1,r=!1){try{const i=document.createElement("canvas");i.width=n?1024:r?512:256,i.height=n?512:r?256:128;const o=i.getContext("2d");if(!o)return null;o.fillStyle=`#${a.toString(16).padStart(6,"0")}`,o.font=n?"bold 48px Arial":r?"bold 36px Arial":"bold 20px Arial",o.textAlign="center",o.textBaseline="middle",o.fillText(e,i.width/2,i.height/2);const s=new zM(i);s.needsUpdate=!0;const l=new $S({map:s,transparent:!0,alphaTest:.1}),c=new cM(l);return n?c.scale.set(16,8,1):r?c.scale.set(8,4,1):c.scale.set(4,2,1),c.position.copy(t),c}catch(QXe){return console.error("Error creating grid label:",QXe),null}}calculateSphereRadii(){if(!this.hmmModel)return;this.regimeSphereRadii.clear();this.hmmModel.getEmissionCovariances().forEach((e,t)=>{if(!e||!Array.isArray(e)||e.length<3)return;if(!e[0]||!e[1]||!e[2])return;const a=void 0!==e[0][0]?e[0][0]:1,n=void 0!==e[1][1]?e[1][1]:1,r=void 0!==e[2][2]?e[2][2]:1,i=4.5*((Math.sqrt(Math.max(0,a))+Math.sqrt(Math.max(0,n))+Math.sqrt(Math.max(0,r)))/3);this.regimeSphereRadii.set(t,i)})}createRegimeEllipsoids(){if(!this.hmmModel)return;if(this.calculateSphereRadii(),!this.showEllipsoids)return;const e=this.hmmModel.getEmissionMeans(),t=this.hmmModel.getEmissionCovariances();e.forEach((e,a)=>{const n=this.regimeConfigs.find(e=>e.id===a);if(!n)return;if(!e||!Array.isArray(e)||e.length<3)return;const r=t[a];if(!r||!Array.isArray(r)||r.length<3)return;if(!r[0]||!Array.isArray(r[0])||r[0].length<3)return;if(!r[1]||!Array.isArray(r[1])||r[1].length<3)return;if(!r[2]||!Array.isArray(r[2])||r[2].length<3)return;const i=void 0!==e[1]?e[1]:0,o=this.getRegimeColorByVolatility(i),s=new oT(1,32,32),l=new lT({color:new j_(o),transparent:!0,opacity:.5,side:2,emissive:new j_(o),emissiveIntensity:.5}),c=new MS(s,l),u=void 0!==r[0][0]?r[0][0]:1,d=void 0!==r[1][1]?r[1][1]:1,h=void 0!==r[2][2]?r[2][2]:1,p=(Math.sqrt(Math.max(0,u))+Math.sqrt(Math.max(0,d))+Math.sqrt(Math.max(0,h)))/3,f=this.regimeSphereRadii.get(a)||4.5*p;c.scale.set(f,f,f);const m=this.getRegimeZPosition(a),v=Math.max(0,void 0!==e[1]?e[1]:0),g=this.getRegimeXPosition(a);c.position.set(m,v,g);const y=new DM(new KM(s),new xM({color:new j_(o),opacity:.7,transparent:!0}));y.scale.copy(c.scale),y.position.copy(c.position);const b=new rw(m,v+f+3,g),x=this.createRegimeLabel(n.name,b,o),w=[];if(this.marketData.length>0){const e=this.marketData.filter(e=>(e.regime||0)===a),t=50,n=Math.max(1,Math.floor(e.length/t));e.forEach((r,i)=>{if(i%n!==0&&e.length>t)return;if(void 0===r.return||void 0===r.volatility||void 0===r.liquidity)return;const o=.6*f;let s=2*(r.liquidity-.5),l=2*(r.volatility/60-.5),c=2.5*r.return;const u=Math.sqrt(s*s+l*l+c*c);if(u>0){const e=Math.min(1,1/u)*o;s*=e,l*=e,c*=e}const d=Math.max(5,Math.min(115,m+s)),h=Math.max(5,Math.min(75,v+l)),p=Math.max(5,Math.min(115,g+c)),y=r.regime||a;if(this.regimeConfigs.find(e=>e.id===y)&&this.hmmModel){const e=this.hmmModel.getEmissionMeans();if(e&&e[y]&&Array.isArray(e[y])){const t=void 0!==e[y][1]?e[y][1]:r.volatility;this.getRegimeColorByVolatility(t)}}const b=new oT(.8,12,12),x=new lT({color:new j_(16777215),emissive:new j_(16777215),emissiveIntensity:.6,transparent:!0,opacity:1,shininess:100}),_=new MS(b,x);_.position.set(d,h,p),_.userData={regimeId:y,point:r,timeIndex:i},w.push(_)})}const _=new VS;_.userData={regimeId:a,config:n},_.add(c),_.add(y),x&&_.add(x),w.forEach(e=>_.add(e)),this.regimeEllipsoids.push(_),this.scene.add(_)})}createRegimeLabel(e,t,a){try{const n=document.createElement("canvas");n.width=512,n.height=256;const r=n.getContext("2d");if(!r)return null;r.fillStyle=a,r.font="bold 36px Arial",r.textAlign="center",r.textBaseline="middle",r.fillText(e,256,128);const i=new zM(n);i.needsUpdate=!0;const o=new $S({map:i,transparent:!0,alphaTest:.1}),s=new cM(o);return s.scale.set(8,4,1),s.position.copy(t),s}catch(QXe){return console.error("Error creating regime label:",QXe),null}}createRegimeCentroids(){if(!this.showCentroids||!this.hmmModel)return;console.log("createRegimeCentroids called, showCentroids:",this.showCentroids);this.hmmModel.getEmissionMeans().forEach((e,t)=>{const a=this.regimeConfigs.find(e=>e.id===t);if(!a)return;if(!e||!Array.isArray(e)||e.length<3)return;const n=void 0!==e[1]?e[1]:0,r=this.getRegimeColorByVolatility(n),i=this.regimeSphereRadii.get(t)||10,o=Math.max(3,.25*i),s=Math.max(5,.4*i);console.log("Creating centroid for regime",t,"sphereRadius:",i,"coreRadius:",o);const l=new oT(o,24,24),c=new lT({color:new j_(16777215),emissive:new j_(r),emissiveIntensity:1.5,transparent:!0,opacity:1,shininess:200,depthTest:!1}),u=new MS(l,c);u.renderOrder=100;const d=this.getRegimeZPosition(t),h=Math.max(0,void 0!==e[1]?e[1]:0),p=this.getRegimeXPosition(t);u.position.set(d,h,p),u.userData={regimeId:t,config:a,pulsePhase:Math.random()*Math.PI*2,baseRadius:o};const f=new oT(s,24,24),m=new Z_({color:new j_(r),transparent:!0,opacity:.4,depthTest:!1}),v=new MS(f,m);v.renderOrder=99,v.position.copy(u.position),v.userData={baseScale:1,baseOpacity:.3,pulsePhase:Math.random()*Math.PI*2,baseRadius:s};const g=new VS;g.add(u),g.add(v),this.regimeCentroids.push(u),this.scene.add(g)})}createTrajectory(){if(console.log("createTrajectory called, marketData.length:",this.marketData.length,"showTrajectory:",this.showTrajectory),0===this.marketData.length)return;const e=[],t=[];if(this.marketData.forEach((a,n)=>{if(void 0===a.return||void 0===a.volatility||void 0===a.liquidity)return;const r=a.regime||0,i=this.getRegimeZPosition(r),o=this.getRegimeXPosition(r);let s=15;if(this.hmmModel){const e=this.hmmModel.getEmissionMeans();e&&e[r]&&void 0!==e[r][1]&&(s=e[r][1])}const l=.6*(this.regimeSphereRadii.get(r)||10);let c=2*(a.liquidity-.5),u=2*(a.volatility/60-.5),d=2.5*a.return;const h=Math.sqrt(c*c+u*u+d*d);if(h>0){const e=Math.min(1,1/h)*l;c*=e,u*=e,d*=e}const p=Math.max(5,Math.min(115,i+c)),f=Math.max(5,Math.min(75,s+u)),m=Math.max(5,Math.min(115,o+d));e.push(new rw(p,f,m));let v=a.volatility;if(this.hmmModel){const e=this.hmmModel.getEmissionMeans();e&&e[r]&&Array.isArray(e[r])&&void 0!==e[r][1]&&(v=e[r][1])}const g=this.getRegimeColorByVolatility(v),y=new j_(g);t.push(y)}),console.log("Trajectory points created:",e.length,"showTrajectory:",this.showTrajectory),e.length>0&&console.log("Sample point coordinates:",e[0],e[e.length-1]),this.showTrajectory&&e.length>1){if(e.length<2)return;const a=new nT(e,!1,"centripetal"),n=a.getPoints(Math.max(100,15*e.length)),r=[];for(let l=0;l<n.length;l++){const a=l/(n.length-1),i=Math.min(Math.floor(a*(e.length-1)),e.length-2),o=Math.min(i+1,e.length-1),s=a*(e.length-1)-i,c=t[i],u=t[o],d=(new j_).lerpColors(c,u,s);r.push(d.r,d.g,d.b)}const i=new hS,o=new Float32Array(3*n.length);n.forEach((e,t)=>{o[3*t]=e.x,o[3*t+1]=e.y,o[3*t+2]=e.z}),i.setAttribute("position",new tS(o,3)),i.setAttribute("color",new rS(r,3));const s=new xM({vertexColors:!0,transparent:!0,opacity:.9,linewidth:3});this.trajectoryLine=new AM(i,s),this.scene.add(this.trajectoryLine),this.createTransitionMarkers(a,e)}this.trajectoryNodes=[],this.showTrajectory&&e.length>1&&(this.marketData.forEach((e,t)=>{if(void 0===e.return||void 0===e.volatility||void 0===e.liquidity)return;const a=e.regime||0,n=this.getRegimeZPosition(a),r=this.getRegimeXPosition(a);let i=15;if(this.hmmModel){const e=this.hmmModel.getEmissionMeans();e&&e[a]&&void 0!==e[a][1]&&(i=e[a][1])}const o=.6*(this.regimeSphereRadii.get(a)||10);let s=2*(e.liquidity-.5),l=2*(e.volatility/60-.5),c=2.5*e.return;const u=Math.sqrt(s*s+l*l+c*c);if(u>0){const e=Math.min(1,1/u)*o;s*=e,l*=e,c*=e}const d=Math.max(5,Math.min(115,n+s)),h=Math.max(5,Math.min(75,i+l)),p=Math.max(5,Math.min(115,r+c)),f=new oT(.6,12,12),m=new lT({color:new j_(16777215),emissive:new j_(16777215),emissiveIntensity:.6,transparent:!0,opacity:1,shininess:100}),v=new MS(f,m);v.position.set(d,h,p),v.userData={timeIndex:t,point:e,regimeId:e.regime||0},v.visible=!0,this.trajectoryNodes.push(v),this.scene.add(v)}),console.log("Trajectory nodes created:",this.trajectoryNodes.length)),this.currentTimeIndex=this.marketData.length-1,console.log("createTrajectory finished:",{trajectoryLineExists:!!this.trajectoryLine,trajectoryNodesCount:this.trajectoryNodes.length})}startAutoAnimation(){0===this.trajectoryNodes.length||this.autoAnimationPlaying||(this.autoAnimationPlaying=!0,this.autoAnimationStartTime=Date.now(),this.currentTimeIndex=0,this.trajectoryNodes.forEach(e=>{e.visible=!1}),this.trajectoryLine&&(this.scene.remove(this.trajectoryLine),this.trajectoryLine=null))}updateAutoAnimation(){if(!this.autoAnimationPlaying||0===this.trajectoryNodes.length)return;const e=Date.now()-this.autoAnimationStartTime,t=Math.min(1,e/this.autoAnimationDuration),a=this.trajectoryNodes.length,n=Math.min(a-1,Math.floor(t*a));this.trajectoryNodes.forEach((e,t)=>{const a=t<=n;if(e.visible=a,a&&e.material instanceof lT)if(t===n){const t=.3*Math.sin(.01*Date.now())+.7;e.material.emissiveIntensity=.8+.4*t,e.scale.setScalar(1+.3*t)}else e.material.emissiveIntensity=.6,e.scale.setScalar(1)});const r=Math.min(this.marketData.length-1,n);r!==this.currentTimeIndex&&(this.currentTimeIndex=r,n>0&&this.createTrajectoryLine()),(t>=1||n>=a-1)&&(this.autoAnimationPlaying=!1,this.trajectoryNodes.forEach(e=>{e.visible=!0,e.material instanceof lT&&(e.material.emissiveIntensity=.6,e.scale.setScalar(1))}),this.currentTimeIndex=this.marketData.length-1,this.createTrajectoryLine())}createTransitionMarkers(e,t){if(this.marketData.length<2||t.length<2)return;this.transitionMarkers=[];const a=this.marketData.slice(0,this.currentTimeIndex+1);for(let n=1;n<a.length;n++){const r=a[n-1],i=a[n],o=r.regime||0,s=i.regime||0;if(o!==s){const a=(Math.max(0,Math.min(1,(n-1)/Math.max(1,t.length-1)))+Math.max(0,Math.min(1,n/Math.max(1,t.length-1))))/2,l=e.getPoint(a);if(!l||void 0===l.x||void 0===l.y||void 0===l.z)continue;let c=r.volatility,u=i.volatility;if(this.hmmModel){const e=this.hmmModel.getEmissionMeans();e[o]&&e[o][1]&&(c=e[o][1]),e[s]&&e[s][1]&&(u=e[s][1])}this.getRegimeColorByVolatility(c),this.getRegimeColorByVolatility(u);const d=new oT(.6,16,16),h=new lT({color:16777215,emissive:16766720,emissiveIntensity:.8,transparent:!0,opacity:.9,shininess:100}),p=new MS(d,h);p.position.copy(l);const f=new oT(.9,16,16),m=new Z_({color:16766720,transparent:!0,opacity:.3}),v=new MS(f,m);v.position.copy(l);const g=new VS;g.add(p),g.add(v),g.userData={fromRegime:o,toRegime:s,timeIndex:n,transitionPoint:l},this.transitionMarkers.push(g),this.scene.add(g)}}}setTimeIndex(e){this.currentTimeIndex=Math.max(0,Math.min(e,this.marketData.length-1)),this.updateTrajectory()}updateTrajectory(){if(this.autoAnimationPlaying)return this.trajectoryLine&&(this.scene.remove(this.trajectoryLine),this.trajectoryLine=null),void this.createTrajectoryLine();this.trajectoryLine&&this.scene.remove(this.trajectoryLine),this.trajectoryPoints&&this.scene.remove(this.trajectoryPoints),this.trajectoryNodes.forEach(e=>this.scene.remove(e)),this.transitionMarkers.forEach(e=>this.scene.remove(e)),this.trajectoryNodes=[],this.transitionMarkers=[],this.createTrajectory(),this.showTransitionArrows&&(this.transitionArrows.forEach(e=>this.scene.remove(e)),this.transitionArrows=[],this.createTransitionArrows())}createTrajectoryLine(){if(0===this.marketData.length||!this.showTrajectory)return;const e=[],t=[];if(this.marketData.forEach((a,n)=>{if(void 0===a.return||void 0===a.volatility||void 0===a.liquidity)return;const r=a.regime||0,i=this.getRegimeZPosition(r),o=this.getRegimeXPosition(r);let s=15;if(this.hmmModel){const e=this.hmmModel.getEmissionMeans();e&&e[r]&&void 0!==e[r][1]&&(s=e[r][1])}const l=.6*(this.regimeSphereRadii.get(r)||10);let c=2*(a.liquidity-.5),u=2*(a.volatility/60-.5),d=2.5*a.return;const h=Math.sqrt(c*c+u*u+d*d);if(h>0){const e=Math.min(1,1/h)*l;c*=e,u*=e,d*=e}const p=Math.max(5,Math.min(115,i+c)),f=Math.max(5,Math.min(75,s+u)),m=Math.max(5,Math.min(115,o+d));e.push(new rw(p,f,m));const v=this.getRegimeColorByVolatility(a.volatility);t.push(new j_(v))}),e.length<2)return;const a=new nT(e,!1,"centripetal").getPoints(Math.max(100,15*e.length)),n=[];for(let s=0;s<a.length;s++){const r=s/(a.length-1),i=Math.min(Math.floor(r*(e.length-1)),e.length-2),o=Math.min(i+1,e.length-1),l=r*(e.length-1)-i,c=t[i],u=t[o],d=(new j_).lerpColors(c,u,l);n.push(d.r,d.g,d.b)}const r=new hS,i=new Float32Array(3*a.length);a.forEach((e,t)=>{i[3*t]=e.x,i[3*t+1]=e.y,i[3*t+2]=e.z}),r.setAttribute("position",new tS(i,3)),r.setAttribute("color",new rS(n,3));const o=new xM({vertexColors:!0,transparent:!0,opacity:.9,linewidth:3});this.trajectoryLine=new AM(r,o),this.scene.add(this.trajectoryLine)}setShowTransitionArrows(e){this.showTransitionArrows=e,e?this.createTransitionArrows():(this.transitionArrows.forEach(e=>this.scene.remove(e)),this.transitionArrows=[])}setShowTrajectory(e){this.showTrajectory=e,this.updateVisualization()}setShowEllipsoids(e){this.showEllipsoids=e,this.updateVisualization()}setShowCentroids(e){this.showCentroids=e,this.updateVisualization()}setShowGrid(e){this.showGrid=e,this.gridHelper&&(e?this.scene.add(this.gridHelper):this.scene.remove(this.gridHelper))}async setCameraPreset(e){const t=await async function(){return"undefined"==typeof window?null:iE||(iE=ne(()=>Promise.resolve().then(()=>fo),void 0).then(e=>e.gsap),iE)}();if(!t)return this.camera.position.set(...e.position),this.controls.target.set(...e.target),void this.controls.update();t.to(this.camera.position,{duration:1.2,x:e.position[0],y:e.position[1],z:e.position[2],ease:"power2.out",onUpdate:()=>{this.controls.target.set(...e.target),this.controls.update()}})}setAutoRotate(e){this.autoRotate=e,this.controls.autoRotate=e,this.controls.autoRotateSpeed=1}animate(){this.animationId=requestAnimationFrame(()=>this.animate()),this.controls&&this.controls.update(),this.raycaster&&this.updateHover(),this.autoAnimationPlaying&&this.updateAutoAnimation(),this.autoRotate;const e=.001*Date.now();this.regimeCentroids.forEach((t,a)=>{if(!t||!t.parent)return;if(void 0!==t.userData.pulsePhase){const a=.3*Math.sin(3*e+t.userData.pulsePhase)+1;if(t.scale.setScalar(a),t.material instanceof lT){const a=.8+.5*Math.sin(4*e+t.userData.pulsePhase);t.material.emissiveIntensity=a,t.material.opacity=.8+.15*Math.sin(3*e+t.userData.pulsePhase)}}const n=t.parent.children.find(e=>e!==t&&"Mesh"===e.type);if(n&&void 0!==n.userData.pulsePhase){const t=.5*Math.sin(2.5*e+n.userData.pulsePhase+Math.PI/4)+1,a=n.userData.baseScale||1;if(n.scale.setScalar(a*t),n.material instanceof Z_){const t=n.userData.baseOpacity||.3,a=.15*Math.sin(2.5*e+n.userData.pulsePhase)+t;n.material.opacity=Math.max(.15,Math.min(.6,a))}}}),this.renaissanceMode&&(this.arbitrageZones.forEach((e,t)=>{const a=.2*Math.sin(.002*Date.now()+t)+1;e.scale.setScalar(a)}),this.probabilityWaves.forEach(e=>{e.children.forEach((e,t)=>{if(e instanceof MS&&e.material instanceof Z_){const a=(e.userData.baseOpacity||.3)*(.5+.5*Math.sin(.001*Date.now()+t));e.material.opacity=a}})}),this.decodingParticles.forEach(e=>{if(e.userData.velocity){const t=e.geometry.attributes.position.array,a=e.userData.velocity;for(let e=0;e<t.length;e+=3)t[e+1]-=a[e/3],t[e+1]<-50&&(t[e+1]=50);e.geometry.attributes.position.needsUpdate=!0}}),this.meanReversionBands.forEach((e,t)=>{e.rotation&&(e.rotation.z+=.01*(t%2==0?1:-1))})),this.renderer.render(this.scene,this.camera)}resize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}dispose(){this.animationId&&cancelAnimationFrame(this.animationId),this.clearScene(),this.renderer&&this.renderer.dispose(),this.container&&this.renderer?.domElement&&this.container.removeChild(this.renderer.domElement)}exportScreenshot(e="regime-space.png"){this.renderer.render(this.scene,this.camera);const t=this.renderer.domElement.toDataURL("image/png"),a=document.createElement("a");a.href=t,a.download=e,a.click()}setRenaissanceMode(e,t,a,n){this.renaissanceMode=e,e?this.createRenaissanceOverlays(t,a,n):this.clearRenaissanceOverlays()}setTimeframe(e){this.selectedTimeframe=e,this.renaissanceMode&&this.marketData.length>0&&this.hmmModel&&(this.clearRenaissanceOverlays(),this.createRenaissanceOverlays(this.marketData,this.hmmModel,this.regimeConfigs))}createRenaissanceOverlays(e,t,a){this.createNonRandomPatterns(e,a),this.createArbitrageZones(e,t,a),this.createMeanReversionBands(e,t,a),this.createMomentumArrows(e,a),this.createSignalMarkers(e,t,a),this.createProbabilityWaves(t,a),this.createDecodingEffect(e),this.createPortfolioHeatmap(e,t,a),this.createComparisonOverlay(e)}clearRenaissanceOverlays(){this.nonRandomSegments.forEach(e=>this.scene.remove(e)),this.arbitrageZones.forEach(e=>this.scene.remove(e)),this.meanReversionBands.forEach(e=>this.scene.remove(e)),this.momentumArrows.forEach(e=>this.scene.remove(e)),this.signalMarkers.forEach(e=>this.scene.remove(e)),this.probabilityWaves.forEach(e=>this.scene.remove(e)),this.decodingParticles.forEach(e=>this.scene.remove(e)),this.portfolioHeatmap&&this.scene.remove(this.portfolioHeatmap),this.comparisonOverlay&&this.scene.remove(this.comparisonOverlay),this.nonRandomSegments=[],this.arbitrageZones=[],this.meanReversionBands=[],this.momentumArrows=[],this.signalMarkers=[],this.probabilityWaves=[],this.decodingParticles=[],this.portfolioHeatmap=null,this.comparisonOverlay=null}createNonRandomPatterns(e,t){for(let a=0;a<e.length-10;a++){const t=e.slice(a,a+10),n=this.calculateRegimeStability(t),r=this.calculatePredictability(t);if(n>.8&&r>.7){const e=[];if(t.forEach((t,a)=>{if(void 0===t.return||void 0===t.volatility||void 0===t.liquidity)return;const n=Math.max(0,35*t.liquidity),r=Math.max(0,t.volatility),i=Math.max(0,t.return);e.push(new rw(n,r,i))}),e.length<2)return;const a=(new hS).setFromPoints(e),n=new xM({color:16776960,linewidth:4,transparent:!0,opacity:.8}),r=new AM(a,n),i=new VS;i.add(r);const o=(new hS).setFromPoints(e),s=new xM({color:16776960,linewidth:6,transparent:!0,opacity:.3}),l=new AM(o,s);i.add(l),this.nonRandomSegments.push(i),this.scene.add(i)}}}createArbitrageZones(e,t,a){const n=t.getEmissionMeans(),r=t.getTransitionMatrix();n.forEach((e,t)=>{if(!a.find(e=>e.id===t))return;const n=e[1]||0,i=this.getRegimeColorByVolatility(n);if(Math.max(...r[t].filter((e,a)=>a!==t))>.3){const a=new oT(5,16,16),n=new Z_({color:new j_(i),transparent:!0,opacity:.2,wireframe:!0}),r=new MS(a,n),o=this.getRegimeZPosition(t),s=Math.max(0,void 0!==e[1]?e[1]:0),l=this.getRegimeXPosition(t);r.position.set(o,s,l),r.userData={pulse:0},this.arbitrageZones.push(r),this.scene.add(r)}})}createMeanReversionBands(e,t,a){const n=t.getEmissionMeans();for(let r=0;r<n.length;r++)for(let e=r+1;e<n.length;e++){const t=this.getRegimeZPosition(r),a=Math.max(0,void 0!==n[r][1]?n[r][1]:0),i=this.getRegimeXPosition(r),o=new rw(t,a,i),s=this.getRegimeZPosition(e),l=Math.max(0,void 0!==n[e][1]?n[e][1]:0),c=this.getRegimeXPosition(e),u=new rw(s,l,c),d=(new rw).addVectors(o,u).multiplyScalar(.5);(new rw).subVectors(u,o).normalize();const h=new WM(.5,.5,o.distanceTo(u),8),p=new Z_({color:16777215,transparent:!0,opacity:.15,wireframe:!0}),f=new MS(h,p);f.position.copy(d),f.lookAt(u),f.rotateX(Math.PI/2),this.meanReversionBands.push(f),this.scene.add(f)}}createMomentumArrows(e,t){for(let a=5;a<e.length;a++){const t=e.slice(a-5,a),n=t.reduce((e,t)=>e+t.return,0)/5,r=t.reduce((e,t)=>e+t.volatility,0)/5;if(Math.abs(n)>.1&&r<20){const t=e[a],r=e[a-5];if(void 0===t.return||void 0===t.volatility||void 0===t.liquidity)continue;if(void 0===r.return||void 0===r.volatility||void 0===r.liquidity)continue;const i=Math.max(0,35*t.liquidity),o=Math.max(0,t.volatility),s=Math.max(0,t.return),l=Math.max(0,35*r.liquidity),c=Math.max(0,r.volatility),u=Math.max(0,r.return),d=new rw(i-l,o-c,s-u).normalize(),h=new rw(i,o,s),p=new DT(d,h,3,n>0?4906624:16281969,1.5,.8);this.momentumArrows.push(p),this.scene.add(p)}}}createSignalMarkers(e,t,a){const n=t.getTransitionMatrix(),r=t.getEmissionMeans();for(let i=1;i<e.length;i++){const t=e[i],a=e[i-1];if(void 0===t.regime||void 0===a.regime)continue;const o=n[a.regime][t.regime],s=r[t.regime][0];if(o*(s>0?1:.5)>.4){if(void 0===t.return||void 0===t.volatility||void 0===t.liquidity)continue;const e=Math.max(0,35*t.liquidity),a=Math.max(0,t.volatility),n=Math.max(0,t.return),r=new rw(e,a,n),i=s>0,o=i?4906624:16281969,l=new qM(.8,2,8),c=new Z_({color:o,transparent:!0,opacity:.7}),u=new MS(l,c);u.position.copy(r),u.lookAt(r.clone().add(new rw(0,i?1:-1,0))),u.rotateX(-Math.PI/2);const d=new VS;d.add(u);const h=new qM(1,2.5,8),p=new Z_({color:o,transparent:!0,opacity:.2}),f=new MS(h,p);f.position.copy(r),f.lookAt(r.clone().add(new rw(0,i?1:-1,0))),f.rotateX(-Math.PI/2),d.add(f),this.signalMarkers.push(d),this.scene.add(d)}}}createProbabilityWaves(e,t){e.getEmissionMeans().forEach((e,a)=>{if(!t.find(e=>e.id===a))return;const n=e[1]||0,r=this.getRegimeColorByVolatility(n);for(let t=1;t<=3;t++){const n=new iT(2*t,2.5*t,32),i=new Z_({color:new j_(r),transparent:!0,opacity:.3/t,side:2}),o=new MS(n,i),s=this.getRegimeZPosition(a),l=Math.max(0,void 0!==e[1]?e[1]:0),c=this.getRegimeXPosition(a);o.position.set(s,l,c),o.rotation.x=Math.PI/2,o.userData={baseOpacity:.3/t,ring:t};const u=new VS;u.add(o),this.probabilityWaves.push(u),this.scene.add(u)}})}createDecodingEffect(e){const t=[],a=[];for(let n=1;n<e.length;n++)if(e[n].regime!==e[n-1].regime){if(void 0===e[n].return||void 0===e[n].volatility||void 0===e[n].liquidity)continue;const r=Math.max(0,35*e[n].liquidity),i=Math.max(0,e[n].volatility),o=Math.max(0,e[n].return);for(let e=0;e<20;e++){const e=r+10*(Math.random()-.5),n=i+5*Math.random(),s=o+5*(Math.random()-.5);t.push(Math.max(0,e),Math.max(0,n),Math.max(0,s)),a.push(0,1,0)}}if(t.length>0){const e=new hS;e.setAttribute("position",new rS(t,3)),e.setAttribute("color",new rS(a,3));const n=new PM({size:.5,vertexColors:!0,transparent:!0,opacity:.6}),r=new BM(e,n);r.userData={velocity:t.map(()=>.1*Math.random()-.05)},this.decodingParticles.push(r),this.scene.add(r)}}createPortfolioHeatmap(e,t,a){const n=t.getEmissionMeans(),r=new VS;n.forEach((e,t)=>{if(!a.find(e=>e.id===t))return;const n=new rT(10,10,10,10),i=e[0],o=(i+.2)/.4,s=new Z_({color:new j_(i>0?4906624:16281969),transparent:!0,opacity:.3*Math.abs(o),side:2}),l=new MS(n,s),c=this.getRegimeZPosition(t),u=Math.max(0,void 0!==e[1]?e[1]:0)-5,d=this.getRegimeXPosition(t);l.position.set(c,u,d),l.rotation.x=-Math.PI/2,r.add(l)}),this.portfolioHeatmap=r,this.scene.add(r)}createComparisonOverlay(e){const t=new VS,a=[];if(e.forEach((e,t)=>{if(void 0===e.return||void 0===e.volatility||void 0===e.liquidity)return;const n=Math.max(0,1.2*e.return),r=Math.max(0,35*e.liquidity),i=Math.max(0,.9*e.volatility),o=Math.max(0,n);a.push(new rw(r,i,o))}),a.length>1){const e=(new hS).setFromPoints(a),n=new xM({color:16766720,transparent:!0,opacity:.4,linewidth:2,dashed:!0}),r=new AM(e,n);t.add(r)}this.comparisonOverlay=t,this.scene.add(t)}calculateRegimeStability(e){if(0===e.length)return 0;const t=e.map(e=>e.regime||0),a=t.sort((e,a)=>t.filter(t=>t===e).length-t.filter(e=>e===a).length).pop()||0;return t.filter(e=>e===a).length/e.length}calculatePredictability(e){if(e.length<2)return 0;let t=0;for(let a=1;a<e.length;a++)e[a].regime===e[a-1].regime&&t++;return t/(e.length-1)}}const sE={class:"regime-space-3d"},lE={class:"main-layout"},cE={class:"controls-panel"},uE={class:"glass-card panel"},dE={class:"controls-section"},hE={class:"input-group"},pE={class:"input-group"},fE={class:"scrub-row"},mE={class:"input-group"},vE=["disabled"],gE={key:0},yE={key:1,class:"flex items-center gap-2"},bE={key:0,class:"glass-card panel"},xE={class:"view-controls"},wE={class:"checkbox-label"},_E={class:"checkbox-label"},SE={class:"checkbox-label"},ME={class:"checkbox-label"},TE={class:"camera-presets"},kE={class:"preset-buttons"},CE=["onClick"],AE={class:"checkbox-label"},EE={key:1,class:"glass-card panel"},IE={class:"regime-info"},RE={class:"regime-name"},DE={class:"regime-stats"},PE={class:"stat-row"},LE={class:"stat-value"},NE={class:"stat-row"},OE={class:"stat-row"},FE={class:"stat-value"},BE={key:0,class:"glass-card panel"},UE={class:"m-val"},zE={class:"m-lbl"},VE={class:"main-content"},HE={key:0,class:"visualization-header"},GE={class:"timeline-controls"},WE=["disabled"],qE={class:"timeline-wrapper"},YE=["max","disabled"],jE=["disabled"],XE={class:"current-date"},$E={key:0,class:"loading-overlay"},KE={class:"tooltip-header"},ZE={class:"tooltip-title"},JE={class:"tooltip-type"},QE={class:"tooltip-body"},eI={class:"tooltip-key"},tI={class:"tooltip-value"},aI={key:1,class:"stats-panel"},nI={class:"stats-card"},rI={class:"distribution-bars"},iI={class:"dist-label"},oI={class:"stats-card"},sI={class:"duration-list"},lI={class:"duration-name"},cI={class:"duration-value"},uI={key:0,class:"stats-card trajectory-node-details"},dI={class:"trajectory-node-data"},hI={class:"data-row"},pI={class:"data-value"},fI={class:"data-row"},mI={class:"data-value"},vI={class:"data-row"},gI={class:"data-row"},yI={class:"data-row"},bI={class:"data-value"},xI={class:"data-row"},wI={class:"data-value"},_I={key:0,class:"data-row"},SI={class:"data-value"},MI=e({__name:"RegimeSpace3D",props:{initialAsset:{},initialNStates:{}},setup(e){const a=e,o=t(null),d=t(!1),g=t(!1),b=t(a.initialAsset||"SPY"),x=t(a.initialNStates||4),_=t("1Y"),C=t(0),A=t(!1),E=t(1),P=t(!1),N=t(!0),O=t(!0),F=t(!1),B=t(!0),U=t(!1),z=t(null),V=t({x:0,y:0}),H=t(null),G=t([]),W=S(()=>{if("ALL"===_.value)return G.value;const e={"3M":90,"6M":180,"1Y":252,"2Y":504}[_.value]||252;return G.value.slice(-e)}),q=t(null),Y=t(null),j=t([]),X=t([]);let $=null;const K=t([{id:0,name:"Low Vol / Accumulation",color:"#60a5fa",mean:[.15,8,.8]},{id:1,name:"Normal / Trending",color:"#fb923c",mean:[.08,15,.6]},{id:2,name:"High Vol / Distribution",color:"#ef4444",mean:[-.05,35,.4]},{id:3,name:"Crisis / Panic",color:"#dc2626",mean:[-.2,60,.2]},{id:4,name:"Recovery",color:"#fb923c",mean:[.12,20,.5]}]),Z=[{name:"top",label:"Сверху",position:[0,100,0],target:[0,0,0]},{name:"side",label:"Сбоку",position:[0,40,80],target:[0,0,0]},{name:"isometric",label:"Изометрия",position:[50,50,50],target:[0,0,0]},{name:"front",label:"Спереди",position:[0,0,80],target:[0,0,0]}];let J=null;const Q=S(()=>0===W.value.length?0:C.value/(W.value.length-1)*100),ee=S(()=>{if(0===W.value.length)return"—";const e=W.value[C.value];return e?.date||"—"}),te=S(()=>{if(0===W.value.length||!W.value[C.value])return null;const e=W.value[C.value],t=void 0!==e.regime?Math.max(0,Math.min(e.regime,x.value-1)):0,a=Math.max(0,Math.min(t,K.value.length-1)),n=K.value[a];if(!n)return null;const r=e.probability&&a<e.probability.length?e.probability[a]:0,i=q.value?.getEmissionMeans(),o=i&&a<i.length?i[a]:[0,0,0];return{...n,probability:r,meanReturn:o[0]||0,meanVolatility:o[1]||0}}),ae=S(()=>{if(!z.value||!z.value.data)return{};const e={};for(const[t,a]of Object.entries(z.value.data))"object"!=typeof a&&null!==a&&"point"!==t&&"Индекс"!==t&&"Режим ID"!==t&&(e[t]=String(a));return e}),re=()=>{const e=[];for(let t=0;t<x.value;t++)if(t<K.value.length)e.push(K.value[t]);else{const a=["#4ade80","#60a5fa","#a78bfa","#f87171","#fbbf24","#fb923c","#3b82f6"];e.push({id:t,name:`Режим ${t}`,color:a[t%a.length],mean:[0,10,.5]})}return e},ie=async()=>{if(o.value){console.log("Starting HMM analysis...",{nStates:x.value,containerSize:{width:o.value.clientWidth,height:o.value.clientHeight}}),d.value=!0,g.value=!1;try{const{getChartData:e,getRegimeStatistics:t,getTransitionMatrix:a}=await ne(async()=>{const{getChartData:e,getRegimeStatistics:t,getTransitionMatrix:a}=await Promise.resolve().then(()=>HR);return{getChartData:e,getRegimeStatistics:t,getTransitionMatrix:a}},void 0),{usePortfolioStore:n}=await ne(async()=>{const{usePortfolioStore:e}=await Promise.resolve().then(()=>js);return{usePortfolioStore:e}},void 0),i=(n(),await e());if(!i.success||!i.data||0===i.data.length)throw new Error("Нет данных HMM модели. Сначала запустите анализ на странице RegimeAnalysis.");G.value=i.data.map((e,t)=>({date:new Date(Date.now()-24*(i.data.length-t)*60*60*1e3).toISOString().split("T")[0],return:(e.price-100)/100,volatility:e.vol,liquidity:.5+.5*Math.random(),regime:e.regime,probability:Array(x.value).fill(0).map((t,a)=>a===e.regime?.8:.2/(x.value-1))}));const[s,l]=await Promise.all([a(),t()]);x.value=s.n_regimes,q.value=new cy;const c=s.transition_matrix,u=[],d=[];for(let r=0;r<l.statistics.length;r++){const e=l.statistics[r],t=e.mean.reduce((e,t)=>e+t,0)/e.mean.length,a=e.volatility_per_asset.reduce((e,t)=>e+t,0)/e.volatility_per_asset.length;u.push([t,a,.5]);const n=e.covariance;n&&n.length>=3&&n[0].length>=3?d.push([[n[0][0]||.01,n[0][1]||0,n[0][2]||0],[n[1][0]||0,n[1][1]||.01,n[1][2]||0],[n[2][0]||0,n[2][1]||0,.1]]):d.push([[.01,0,0],[0,.01,0],[0,0,.1]])}if(q.value.setParameters({nStates:x.value,transitionMatrix:c,initialStateDistribution:Array(x.value).fill(1/x.value),emissionMeans:u,emissionCovariances:d}),q.value){j.value=q.value.computeStationaryDistribution(),X.value=[];for(let e=0;e<x.value;e++)X.value.push(q.value.computeExpectedDuration(e))}if(Y.value=c,o.value&&!$){if(0===o.value.clientWidth||0===o.value.clientHeight)return console.warn("Canvas container has zero dimensions, retrying..."),void setTimeout(()=>ie(),200);$=new oE(o.value),$.setOnHover(e=>{if(z.value=e,e&&"trajectory-node"===e.type){z.value=e;const t=e.data.point;t&&(H.value={point:t,timeIndex:parseInt(e.data["Индекс"]||"0"),regimeId:parseInt(e.data["Режим ID"]||"0")})}else!e||"centroid"!==e.type&&"ellipsoid"!==e.type?(z.value=null,H.value=null):(z.value=e,H.value=null)});const e=e=>{if(o.value&&z.value){const t=o.value.getBoundingClientRect();V.value={x:e.clientX-t.left,y:e.clientY-t.top}}};o.value.addEventListener("mousemove",e),r(()=>{o.value&&o.value.removeEventListener("mousemove",e)});const t=()=>{if($&&o.value){const e=o.value.clientWidth,t=o.value.clientHeight;e>0&&t>0&&$.resize(e,t)}};window.addEventListener("resize",t),r(()=>{window.removeEventListener("resize",t)}),setTimeout(()=>{if($&&o.value){const e=o.value.clientWidth,t=o.value.clientHeight;e>0&&t>0&&$.resize(e,t)}},100)}if($&&q.value){const e=re();$.setData(W.value,q.value,e)}C.value=W.value.length-1,g.value=!0,console.log("HMM analysis completed successfully",{dataPoints:W.value.length,rendererInitialized:!!$,hmmModelInitialized:!!q.value})}catch(QXe){console.error("Error running analysis:",QXe),alert("Ошибка при запуске анализа: "+QXe.message)}finally{d.value=!1}}else console.error("Canvas container not found")},oe=()=>{ie()},se=()=>{if($&&q.value){const e=re();$.setData(W.value,q.value,e)}},le=()=>{if($&&q.value){const e=re();$.setData(W.value,q.value,e),C.value=Math.min(C.value,W.value.length-1)}},ce=()=>{$&&($.setShowTrajectory(N.value),$.setShowEllipsoids(O.value),$.setShowCentroids(F.value),$.setShowGrid(B.value))},ue=()=>{$&&$.setAutoRotate(P.value)},de=()=>{if($){const e=Math.max(0,(W.value.length||1)-1);C.value=Math.max(0,Math.min(C.value,e)),$.setTimeIndex(C.value),U.value&&($.setShowTransitionArrows(!1),setTimeout(()=>{$&&$.setShowTransitionArrows(!0)},100))}},he=()=>{A.value=!A.value,A.value?pe():fe()},pe=()=>{if(fe(),!g.value||0===W.value.length)return;const e=()=>{if(!A.value||!g.value||0===W.value.length)return void fe();const t=parseFloat(E.value.toString()),a=Math.max(1,Math.ceil(t));if(C.value=Math.min(C.value+a,W.value.length-1),C.value>=W.value.length-1)return C.value=W.value.length-1,void fe();de();const n=Math.max(30,Math.min(200,150/t));J=window.setTimeout(e,n)};e()},fe=()=>{J&&(clearTimeout(J),J=null),A.value=!1},me=()=>{fe(),g.value&&W.value.length>0&&(C.value=0,de())},ve=()=>{$&&$.exportScreenshot(`regime-space-${b.value}-${Date.now()}.png`)},ge=()=>{const e=[["Date","Return","Volatility","Liquidity","Regime","Probability"].join(","),...W.value.map(e=>[e.date,e.return.toFixed(4),e.volatility.toFixed(4),e.liquidity.toFixed(4),e.regime||0,e.probability?Math.max(...e.probability).toFixed(4):"0"].join(","))].join("\n"),t=new Blob([e],{type:"text/csv"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=`regime-data-${b.value}-${Date.now()}.csv`,n.click(),URL.revokeObjectURL(a)};return R(()=>W.value,()=>{if($&&q.value&&W.value.length>0){const e=re();$.setData(W.value,q.value,e)}},{deep:!0}),n(()=>{setTimeout(()=>{!o.value||d.value||g.value||ie()},100)}),r(()=>{fe(),$&&($.dispose(),$=null)}),(e,t)=>(w(),i("div",sE,[s("div",lE,[s("aside",cE,[s("div",uE,[t[17]||(t[17]=s("div",{class:"panel-header"},[s("h3",null,"Управление")],-1)),s("div",dE,[s("div",hE,[t[11]||(t[11]=s("label",{class:"lbl"},"Актив",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),class:"glass-select",onChange:oe},[...t[10]||(t[10]=[s("option",{value:"SPY"},"S&P 500 (SPY)",-1),s("option",{value:"QQQ"},"Nasdaq 100 (QQQ)",-1),s("option",{value:"BTC"},"Bitcoin (BTC)",-1),s("option",{value:"IMOEX"},"IMOEX Index",-1)])],544),[[D,b.value]])]),s("div",pE,[t[13]||(t[13]=s("label",{class:"lbl"},"Количество режимов",-1)),s("div",fE,[u(ly,{modelValue:x.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>x.value=e),se],min:2,max:5,step:1,class:"text-accent font-bold"},null,8,["modelValue"]),t[12]||(t[12]=s("span",{class:"unit"},"states",-1))])]),s("div",mE,[t[15]||(t[15]=s("label",{class:"lbl"},"Временной период",-1)),T(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>_.value=e),class:"glass-select",onChange:le},[...t[14]||(t[14]=[I('<option value="3M" data-v-273d2efa>3 месяца</option><option value="6M" data-v-273d2efa>6 месяцев</option><option value="1Y" data-v-273d2efa>1 год</option><option value="2Y" data-v-273d2efa>2 года</option><option value="ALL" data-v-273d2efa>Все данные</option>',5)])],544),[[D,_.value]])]),s("button",{onClick:ie,disabled:d.value,class:"btn-primary-gradient"},[d.value?(w(),i("span",yE,[...t[16]||(t[16]=[s("span",{class:"spinner-mini"},null,-1),m(" Обучение HMM... ",-1)])])):(w(),i("span",gE,"Запустить анализ"))],8,vE)])]),g.value?(w(),i("div",bE,[t[24]||(t[24]=s("div",{class:"panel-header"},[s("h3",null,"Вид")],-1)),s("div",xE,[s("label",wE,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>N.value=e),onChange:ce},null,544),[[L,N.value]]),t[18]||(t[18]=s("span",null,"Траектория",-1))]),s("label",_E,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>O.value=e),onChange:ce},null,544),[[L,O.value]]),t[19]||(t[19]=s("span",null,"Эллипсоиды",-1))]),s("label",SE,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>F.value=e),onChange:ce},null,544),[[L,F.value]]),t[20]||(t[20]=s("span",null,"Центроиды",-1))]),s("label",ME,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>B.value=e),onChange:ce},null,544),[[L,B.value]]),t[21]||(t[21]=s("span",null,"Сетка",-1))])]),s("div",TE,[t[23]||(t[23]=s("h4",{class:"presets-title"},"Вид камеры",-1)),s("div",kE,[(w(),i(p,null,f(Z,e=>s("button",{key:e.name,onClick:t=>(e=>{$&&$.setCameraPreset(e)})(e),class:"btn-preset"},v(e.label),9,CE)),64))]),s("label",AE,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>P.value=e),onChange:ue},null,544),[[L,P.value]]),t[22]||(t[22]=s("span",null,"Авто-вращение",-1))])])])):l("",!0),te.value?(w(),i("div",EE,[t[28]||(t[28]=s("div",{class:"panel-header"},[s("h3",null,"Текущий режим")],-1)),s("div",IE,[s("div",{class:"regime-badge",style:y({borderColor:te.value.color})},[s("span",{class:"regime-dot",style:y({backgroundColor:te.value.color})},null,4),s("span",RE,v(te.value.name),1)],4),s("div",DE,[s("div",PE,[t[25]||(t[25]=s("span",{class:"stat-label"},"Вероятность:",-1)),s("span",LE,v((100*te.value.probability).toFixed(1))+"%",1)]),s("div",NE,[t[26]||(t[26]=s("span",{class:"stat-label"},"Доходность:",-1)),s("span",{class:c(["stat-value",te.value.meanReturn>=0?"text-green":"text-red"])},v(te.value.meanReturn.toFixed(2))+"% ",3)]),s("div",OE,[t[27]||(t[27]=s("span",{class:"stat-label"},"Волатильность:",-1)),s("span",FE,v(te.value.meanVolatility.toFixed(1))+"%",1)])])])])):l("",!0),u(M,{name:"fade"},{default:h(()=>[Y.value?(w(),i("div",BE,[t[29]||(t[29]=s("div",{class:"panel-header"},[s("h3",null,"Матрица переходов")],-1)),s("div",{class:"matrix-grid",style:y({gridTemplateColumns:`repeat(${x.value}, 1fr)`})},[(w(!0),i(p,null,f(Y.value,(e,t)=>(w(),i("div",{key:t,class:"matrix-row-group"},[(w(!0),i(p,null,f(e,(e,a)=>(w(),i("div",{key:a,class:"matrix-cell",style:y({backgroundColor:`rgba(96, 165, 250, ${.6*e})`})},[s("span",UE,v((100*e).toFixed(0))+"%",1),s("span",zE,"S"+v(t)+"→S"+v(a),1)],4))),128))]))),128))],4)])):l("",!0)]),_:1})]),s("main",VE,[g.value?(w(),i("div",HE,[t[31]||(t[31]=s("div",{class:"header-left"},[s("h2",{class:"vis-title"},"Пространство скрытых состояний"),s("p",{class:"vis-subtitle"}," 3D визуализация рыночных режимов (HMM) ")],-1)),s("div",GE,[s("button",{onClick:he,class:c(["btn-play",{active:A.value}]),disabled:!g.value||0===W.value.length},v(A.value?"⏸":"▶"),11,WE),s("div",qE,[T(s("input",{type:"range",min:0,max:Math.max(0,(W.value.length||1)-1),"onUpdate:modelValue":t[8]||(t[8]=e=>C.value=e),onInput:de,class:"timeline-slider",disabled:!g.value},null,40,YE),[[k,C.value,void 0,{number:!0}]]),s("div",{class:"timeline-track",style:y({width:Q.value+"%"})},null,4),s("div",{class:"timeline-thumb",style:y({left:Q.value+"%"})},null,4)]),T(s("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>E.value=e),class:"speed-select"},[...t[30]||(t[30]=[s("option",{value:"0.5"},"0.5x",-1),s("option",{value:"1"},"1x",-1),s("option",{value:"2"},"2x",-1),s("option",{value:"5"},"5x",-1)])],512),[[D,E.value]]),s("button",{onClick:me,class:"btn-reset",disabled:!g.value||0===W.value.length},"↺",8,jE),s("div",XE,v(ee.value),1)])])):l("",!0),s("div",{ref_key:"canvasContainer",ref:o,class:c(["canvas-container",{loading:d.value}])},[d.value?(w(),i("div",$E,[...t[32]||(t[32]=[s("div",{class:"spinner-large"},null,-1),s("p",null,"Инициализация 3D пространства...",-1)])])):l("",!0),z.value?(w(),i("div",{key:1,class:"hover-tooltip",style:y({left:V.value.x+"px",top:V.value.y+"px"})},[s("div",KE,[s("h4",ZE,v(z.value.title),1),s("span",JE,v(z.value.type),1)]),s("div",QE,[(w(!0),i(p,null,f(ae.value,(e,t)=>(w(),i("div",{key:t,class:"tooltip-row"},[s("span",eI,v(t)+":",1),s("span",tI,v(e),1)]))),128))])],4)):l("",!0)],2),g.value?(w(),i("div",aI,[s("div",nI,[t[33]||(t[33]=s("h4",null,"Стационарное распределение",-1)),t[34]||(t[34]=s("p",{class:"info-hint"},"Долгосрочная вероятность каждого режима",-1)),s("div",rI,[(w(!0),i(p,null,f(j.value,(e,t)=>(w(),i("div",{key:t,class:"dist-bar",style:y({width:100*e+"%",backgroundColor:K.value[t]?.color||"#888"})},[s("span",iI,"S"+v(t)+": "+v((100*e).toFixed(1))+"%",1)],4))),128))])]),s("div",oI,[t[35]||(t[35]=s("h4",null,"Ожидаемая длительность режимов",-1)),t[36]||(t[36]=s("p",{class:"info-hint"},"Средняя продолжительность режима в днях",-1)),s("div",sI,[(w(!0),i(p,null,f(X.value,(e,t)=>(w(),i("div",{key:t,class:"duration-item"},[s("span",{class:"duration-dot",style:y({backgroundColor:K.value[t]?.color||"#888"})},null,4),s("span",lI,v(K.value[t]?.name||`Режим ${t}`),1),s("span",cI,v(e.toFixed(1))+" дней",1)]))),128))])]),H.value?(w(),i("div",uI,[t[44]||(t[44]=s("h4",null,"Детализация узла траектории",-1)),t[45]||(t[45]=s("p",{class:"info-hint"},"Информация о наведенном наблюдении",-1)),s("div",dI,[s("div",hI,[t[37]||(t[37]=s("span",{class:"data-label"},"Индекс:",-1)),s("span",pI,v(H.value.timeIndex),1)]),s("div",fI,[t[38]||(t[38]=s("span",{class:"data-label"},"Дата:",-1)),s("span",mI,v(H.value.point.date||"N/A"),1)]),s("div",vI,[t[39]||(t[39]=s("span",{class:"data-label"},"Режим:",-1)),s("span",{class:"data-value",style:y({color:K.value[H.value.regimeId]?.color||"#fff"})},v(K.value[H.value.regimeId]?.name||`Режим ${H.value.regimeId}`),5)]),s("div",gI,[t[40]||(t[40]=s("span",{class:"data-label"},"Доходность:",-1)),s("span",{class:c(["data-value",H.value.point.return&&H.value.point.return>=0?"text-green":"text-red"])},v(void 0!==H.value.point.return?(100*H.value.point.return).toFixed(2)+"%":"N/A"),3)]),s("div",yI,[t[41]||(t[41]=s("span",{class:"data-label"},"Волатильность:",-1)),s("span",bI,v(void 0!==H.value.point.volatility?H.value.point.volatility.toFixed(2)+"%":"N/A"),1)]),s("div",xI,[t[42]||(t[42]=s("span",{class:"data-label"},"Ликвидность:",-1)),s("span",wI,v(void 0!==H.value.point.liquidity?H.value.point.liquidity.toFixed(3):"N/A"),1)]),H.value.point.probability?(w(),i("div",_I,[t[43]||(t[43]=s("span",{class:"data-label"},"Вероятность режима:",-1)),s("span",SI,v((100*H.value.point.probability[H.value.regimeId]).toFixed(1)+"%"),1)])):l("",!0)])])):l("",!0),s("div",{class:"export-section"},[s("button",{onClick:ve,class:"btn-export"}," 📷 Скриншот "),s("button",{onClick:ge,class:"btn-export"}," 📊 CSV ")])])):l("",!0)])])]))}}),TI=xe(MI,[["__scopeId","data-v-273d2efa"]]),kI={class:"page-container custom-scroll"},CI={class:"section-header"},AI={class:"header-actions"},EI={class:"glass-pill status-pill"},II={class:"status-label"},RI={class:"text-white"},DI={class:"view-tabs"},PI={key:0,class:"regime-3d-container"},LI={key:1,class:"dashboard-grid"},NI={class:"left-panel"},OI={class:"glass-card panel"},FI={class:"controls-form"},BI={class:"input-group"},UI={class:"glass-pill status-pill"},zI={class:"status-label text-muted"},VI={class:"text-white"},HI={class:"info-text"},GI={class:"input-group mt-2"},WI={class:"checkbox-label"},qI={key:0,class:"input-group mt-2"},YI={class:"scrub-row"},jI=["disabled"],XI={key:0},$I={key:1,class:"flex items-center gap-2"},KI={key:0,class:"glass-card panel"},ZI={class:"m-val"},JI={class:"m-lbl"},QI={key:0,class:"glass-card panel"},eR={class:"stats-list"},tR={class:"stat-head"},aR={class:"s-name"},nR={class:"stat-metrics"},rR={class:"text-muted"},iR={class:"main-panel"},oR={class:"glass-card chart-card"},sR={class:"chart-header"},lR={class:"ch-left"},cR={key:0,class:"badge-live"},uR={key:0,class:"playback-controls"},dR={key:0},hR={key:1},pR={class:"timeline-wrapper"},fR=["max"],mR={class:"chart-container"},vR={key:0,viewBox:"0 0 800 400",preserveAspectRatio:"none",class:"regime-svg"},gR=["x","width","fill"],yR=["d"],bR=["x1","x2"],xR={key:1,class:"empty-state"},wR={key:0,class:"spinner-large"},_R={key:1},SR={class:"glass-card chart-card mt-4"},MR={class:"chart-container-sm"},TR={key:0,viewBox:"0 0 800 160",preserveAspectRatio:"none",class:"regime-svg"},kR=["y1","y2"],CR=["cx","cy","fill"],AR={class:"glass-card chart-card mt-4"},ER={class:"chart-container-sm"},IR={key:0,viewBox:"0 0 800 160",preserveAspectRatio:"none",class:"regime-svg"},RR=["y1","y2"],DR=["y"],PR=["y"],LR=["y"],NR=["cx","cy","fill"],OR=e({__name:"RegimeAnalysis",setup(e){const a=_e(),n=Ys(),o=t("SPY"),d=t(3),g=t(!0),b=t("2d"),x=t(!1),_=t(null),C=t([]),A=t([]),E=t(0),I=t(!1);let R=null;const D=S(()=>C.value.length?E.value/(C.value.length-1)*100:0),N=async()=>{if(x.value)return;x.value=!0,B();const e=n.selectedBank?.name||"Портфель",t=a.addTask(`Обучение HMM на портфеле ${e}...`,"simulation");try{a.updateProgress(t,10);const{fitModel:e,getChartData:r,getRegimeStatistics:i,getTransitionMatrix:o}=await ne(async()=>{const{fitModel:e,getChartData:t,getRegimeStatistics:a,getTransitionMatrix:n}=await Promise.resolve().then(()=>HR);return{fitModel:e,getChartData:t,getRegimeStatistics:a,getTransitionMatrix:n}},void 0),s=await e({bank_reg_number:n.selectedBank?.regNumber,auto_optimize:g.value,n_regimes:g.value?void 0:d.value,criterion:"aicc",max_iterations:50,tol:1e-6,random_state:42,period_days:252});a.updateProgress(t,70),g.value&&(d.value=s.n_regimes);const l=await r();a.updateProgress(t,85);const c=await i(),u=await o();a.updateProgress(t,95),C.value=l.data.map(e=>({price:e.price,regime:e.regime,vol:e.vol})),_.value=u.transition_matrix,A.value=c.statistics.map(e=>{const t=e.mean.reduce((e,t)=>e+t,0)/e.mean.length,a=e.volatility_per_asset.reduce((e,t)=>e+t,0)/e.volatility_per_asset.length;return{ret:(100*t).toFixed(2),vol:(100*a).toFixed(1)}}),E.value=C.value.length-1,a.updateProgress(t,100),setTimeout(()=>{F()},500)}catch(TQe){console.error("Ошибка обучения HMM:",TQe),a.failTask(t),alert(`Ошибка: ${TQe.message||"Неизвестная ошибка"}`)}finally{x.value=!1}},F=()=>{I.value?B():(E.value>=C.value.length-1&&(E.value=0),I.value=!0,z())},B=()=>{I.value=!1,R&&cancelAnimationFrame(R)},U=()=>{B(),E.value=0},z=()=>{if(!I.value)return;const e=E.value+3;e>=C.value.length?(E.value=C.value.length-1,B()):(E.value=e,R=requestAnimationFrame(z))},V=S(()=>800/(C.value.length||1)),H=e=>e*V.value,G=e=>{let t=(e-0)/.8;return t>1&&(t=1),t<0&&(t=0),160-140*t-10},W=e=>0===e?130:1===e?80:30,q=S(()=>{if(!C.value.length)return"";const e=C.value.slice(0,E.value+1),t=C.value.map(e=>e.price),a=Math.min(...t),n=Math.max(...t);return"M "+e.map((e,t)=>`${H(t).toFixed(1)},${((e,t,a)=>400-(e-t)/(a-t||1)*360-20)(e.price,a,n).toFixed(1)}`).join(" L ")}),Y=e=>0===e?"Стабильный (Низкая волатильность)":1===e?"Рост (Бычий)":2===e?"Стресс (Медвежий)":"Коррекция",j=e=>1===e?"#4ade80":2===e?"#f87171":"#3b82f6",X=e=>1===e?"bg-green":2===e?"bg-red":"bg-blue",$=S(()=>{if(!C.value.length)return"—";const e=Math.min(E.value,C.value.length-1);return Y(C.value[e].regime)}),K=S(()=>{if(!C.value.length)return"bg-grey";const e=Math.min(E.value,C.value.length-1);return X(C.value[e].regime)});return r(()=>{R&&cancelAnimationFrame(R)}),(e,t)=>(w(),i("div",kI,[s("div",CI,[t[6]||(t[6]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Анализ рыночных режимов"),s("p",{class:"section-subtitle"},"HMM: Классификация скрытых состояний рынка")],-1)),s("div",AI,[s("div",EI,[s("span",{class:c(["dot",K.value])},null,2),s("span",II,[t[5]||(t[5]=m("Текущий режим: ",-1)),s("b",RI,v($.value),1)])])])]),s("div",DI,[s("button",{onClick:t[0]||(t[0]=e=>b.value="2d"),class:c(["tab-btn",{active:"2d"===b.value}])}," 2D Анализ ",2),s("button",{onClick:t[1]||(t[1]=e=>b.value="3d"),class:c(["tab-btn",{active:"3d"===b.value}])}," 3D Пространство режимов ",2)]),"3d"===b.value?(w(),i("div",PI,[u(TI,{"initial-asset":o.value,"initial-n-states":d.value},null,8,["initial-asset","initial-n-states"])])):(w(),i("div",LI,[s("aside",NI,[s("div",OI,[t[12]||(t[12]=s("div",{class:"panel-header"},[s("h3",null,"Параметры модели")],-1)),s("div",FI,[s("div",BI,[t[7]||(t[7]=s("label",{class:"lbl"},"Портфель банка",-1)),s("div",UI,[s("span",zI,[s("b",VI,v(O(n).selectedBank?.name||"Не выбран"),1)])]),s("p",HI,"Используется портфель из "+v(O(n).positions.length)+" активов",1)]),s("div",GI,[s("label",WI,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>g.value=e)},null,512),[[L,g.value]]),t[8]||(t[8]=s("span",null,"Автоматически определить количество режимов",-1))])]),g.value?l("",!0):(w(),i("div",qI,[t[10]||(t[10]=s("label",{class:"lbl"},"Количество режимов",-1)),s("div",YI,[u(ly,{modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=e=>d.value=e),min:2,max:5,step:1,class:"text-accent font-bold"},null,8,["modelValue"]),t[9]||(t[9]=s("span",{class:"unit"},"режимов",-1))])])),s("button",{onClick:N,disabled:x.value,class:"btn-primary-gradient mt-6"},[x.value?(w(),i("span",$I,[...t[11]||(t[11]=[s("span",{class:"spinner-mini"},null,-1),m(" Обучение... ",-1)])])):(w(),i("span",XI,"Запустить анализ"))],8,jI)])]),u(M,{name:"fade"},{default:h(()=>[_.value?(w(),i("div",KI,[t[13]||(t[13]=s("div",{class:"panel-header"},[s("h3",null,"Матрица переходов")],-1)),s("div",{class:"matrix-grid",style:y({gridTemplateColumns:`repeat(${d.value}, 1fr)`})},[(w(!0),i(p,null,f(_.value,(e,t)=>(w(),i("div",{key:t,class:"matrix-row-group"},[(w(!0),i(p,null,f(e,(e,a)=>(w(),i("div",{key:a,class:"matrix-cell",style:y({backgroundColor:`rgba(59, 130, 246, ${.8*e})`})},[s("span",ZI,v((100*e).toFixed(0))+"%",1),s("span",JI,"S"+v(t)+"→S"+v(a),1)],4))),128))]))),128))],4)])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[A.value.length?(w(),i("div",QI,[t[14]||(t[14]=s("div",{class:"panel-header"},[s("h3",null,"Статистика режимов")],-1)),s("div",eR,[(w(!0),i(p,null,f(A.value,(e,t)=>(w(),i("div",{class:"stat-item",key:t},[s("div",tR,[s("span",{class:c(["dot",X(t)])},null,2),s("span",aR,v(Y(t)),1)]),s("div",nR,[s("span",{class:c(parseFloat(e.ret)>0?"text-green":"text-red")},"μ: "+v(e.ret)+"%",3),s("span",rR,"σ: "+v(e.vol)+"%",1)])]))),128))])])):l("",!0)]),_:1})]),s("main",iR,[s("div",oR,[s("div",sR,[s("div",lR,[t[15]||(t[15]=s("h3",null,"Динамика цены и режимы",-1)),I.value?(w(),i("span",cR,"В ПРЯМОМ ЭФИРЕ")):l("",!0)]),C.value.length?(w(),i("div",uR,[s("button",{class:"icon-btn",onClick:F,title:"Воспроизвести/Пауза"},[I.value?(w(),i("span",dR,"⏸")):(w(),i("span",hR,"▶"))]),s("div",pR,[T(s("input",{type:"range",min:"0",max:C.value.length-1,"onUpdate:modelValue":t[4]||(t[4]=e=>E.value=e),onInput:B,class:"timeline-slider"},null,40,fR),[[k,E.value,void 0,{number:!0}]]),s("div",{class:"timeline-track",style:y({width:D.value+"%"})},null,4),s("div",{class:"timeline-thumb",style:y({left:D.value+"%"})},null,4)]),s("button",{class:"icon-btn",onClick:U,title:"Сброс"},"↺")])):l("",!0)]),s("div",mR,[C.value.length?(w(),i("svg",vR,[(w(!0),i(p,null,f(C.value,(e,t)=>{return T((w(),i("rect",{key:"bg-"+t,x:H(t),y:"0",width:V.value+.5,height:"400",fill:(a=e.regime,n=.15,1===a?`rgba(74, 222, 128, ${n})`:2===a?`rgba(248, 113, 113, ${n})`:`rgba(59, 130, 246, ${n})`)},null,8,gR)),[[P,t<=E.value]]);var a,n}),128)),t[16]||(t[16]=s("line",{x1:"0",y1:"100",x2:"800",y2:"100",stroke:"rgba(255,255,255,0.05)"},null,-1)),t[17]||(t[17]=s("line",{x1:"0",y1:"200",x2:"800",y2:"200",stroke:"rgba(255,255,255,0.05)"},null,-1)),t[18]||(t[18]=s("line",{x1:"0",y1:"300",x2:"800",y2:"300",stroke:"rgba(255,255,255,0.05)"},null,-1)),s("path",{d:q.value,fill:"none",stroke:"#fff","stroke-width":"2","stroke-linejoin":"round",filter:"drop-shadow(0 0 4px rgba(0,0,0,0.5))"},null,8,yR),E.value<C.value.length-1?(w(),i("line",{key:0,x1:H(E.value),y1:"0",x2:H(E.value),y2:"400",stroke:"rgba(255,255,255,0.8)","stroke-dasharray":"3"},null,8,bR)):l("",!0)])):(w(),i("div",xR,[x.value?(w(),i("div",wR)):(w(),i("span",_R,"Нажмите «Запустить анализ» для генерации"))]))])]),s("div",SR,[t[19]||(t[19]=s("div",{class:"chart-header"},[s("h3",null,"Скользящая волатильность (20Д)")],-1)),s("div",MR,[C.value.length?(w(),i("svg",TR,[(w(),i(p,null,f(3,e=>s("line",{key:e,x1:"0",y1:40*e,x2:"800",y2:40*e,stroke:"rgba(255,255,255,0.05)"},null,8,kR)),64)),(w(!0),i(p,null,f(C.value,(e,t)=>T((w(),i("circle",{key:"v-"+t,cx:H(t),cy:G(e.vol),r:"2",fill:j(e.regime)},null,8,CR)),[[P,t<=E.value]])),128))])):l("",!0)])]),s("div",AR,[t[20]||(t[20]=s("div",{class:"chart-header"},[s("h3",null,"Предсказанные скрытые состояния")],-1)),s("div",ER,[C.value.length?(w(),i("svg",IR,[(w(),i(p,null,f([0,1,2],e=>s("line",{key:"g-"+e,x1:"0",y1:W(e),x2:"800",y2:W(e),stroke:"rgba(255,255,255,0.05)","stroke-dasharray":"4"},null,8,RR)),64)),s("text",{x:"10",y:W(0)-8,fill:"rgba(255,255,255,0.2)","font-size":"10"},"Стабильный (0)",8,DR),s("text",{x:"10",y:W(1)-8,fill:"rgba(255,255,255,0.2)","font-size":"10"},"Рост (1)",8,PR),s("text",{x:"10",y:W(2)-8,fill:"rgba(255,255,255,0.2)","font-size":"10"},"Стресс (2)",8,LR),(w(!0),i(p,null,f(C.value,(e,t)=>T((w(),i("circle",{key:"s-"+t,cx:H(t),cy:W(e.regime),r:"3",fill:j(e.regime)},null,8,NR)),[[P,t<=E.value]])),128))])):l("",!0)])])])]))]))}}),FR=xe(OR,[["__scopeId","data-v-5955305a"]]),BR="   https://stochastic-dashbord-v1-production.up.railway.app";async function UR(){const e=await fetch(`${BR}/api/multivariate-hmm/statistics`);if(!e.ok){const t=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(t.detail||`Ошибка получения статистики: ${e.status}`)}return e.json()}async function zR(){const e=await fetch(`${BR}/api/multivariate-hmm/transition-matrix`);if(!e.ok){const t=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(t.detail||`Ошибка получения матрицы переходов: ${e.status}`)}return e.json()}async function VR(){const e=await fetch(`${BR}/api/multivariate-hmm/chart-data`);if(!e.ok){const t=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(t.detail||`Ошибка получения данных для графиков: ${e.status}`)}return e.json()}const HR=Object.freeze(Object.defineProperty({__proto__:null,fitModel:async function(e){const t=await fetch(`${BR}/api/multivariate-hmm/fit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`Ошибка обучения модели: ${t.status}`)}return t.json()},getChartData:VR,getRegimeStatistics:UR,getTransitionMatrix:zR},Symbol.toStringTag,{value:"Module"})),GR={class:"page-container custom-scroll"},WR={key:0,class:"loading-container"},qR={key:1,class:"grid-3 mb-6"},YR={class:"card-head"},jR={class:"card-body"},XR={class:"desc"},$R={key:0,class:"metrics-table"},KR={class:"m-row"},ZR={class:"m-row"},JR={class:"m-row"},QR={class:"m-row"},eD={class:"m-row"},tD={class:"m-row"},aD={class:"grid-2 mb-6"},nD={class:"glass-card panel"},rD={class:"heatmap-container"},iD={key:0,class:"heatmap-grid"},oD={class:"glass-card panel flex-col"},sD={class:"table-wrapper"},lD={class:"glass-table"},cD={key:0},uD={key:1},dD={class:"pl-2"},hD={class:"stationary"},pD=e({__name:"RegimeDetails",setup(e){Ys();const a=t([]),r=t(null),o=t([]),u=t(!0);n(async()=>{try{const[e,t,n]=await Promise.all([UR(),zR(),VR()]);a.value=e.statistics,r.value=t.transition_matrix,o.value=n.data,u.value=!1}catch(TQe){console.error("Ошибка загрузки данных режимов:",TQe),u.value=!1}});const d=S(()=>{if(!r.value)return[];let e=Array(r.value.length).fill(1/r.value.length);for(let t=0;t<100;t++){const t=r.value[0].map((t,a)=>e.reduce((e,t,n)=>e+t*r.value[n][a],0)),a=t.reduce((e,t)=>e+t,0);e=t.map(e=>e/a)}return e});S(()=>r.value?r.value.map((e,t)=>{const a=e[t];return a>=1?null:1/(1-a)}):[]);const h=e=>{if(!a.value[e])return null;const t=a.value[e],n=o.value.filter(t=>t.regime===e).length;return{days:n,frequency:n/o.value.length,meanReturn:t.mean.reduce((e,t)=>e+t,0)/t.mean.length,volatility:t.volatility_per_asset.reduce((e,t)=>e+t,0)/t.volatility_per_asset.length,persistence:t.persistence,duration:t.duration_days}},g=e=>["Стабильность","Падение","Рост","Коррекция","Восстановление"][e]||`Режим ${e}`,b=e=>{const t=["blue","red","green","orange","purple"];return t[e%t.length]},x=e=>{const t=["59, 130, 246","248, 113, 113","74, 222, 128","251, 191, 36","168, 85, 247"];return t[e%t.length]},_=e=>{if(!r.value||!r.value.length)return[];const t=o.value.length>0?o.value[o.value.length-1].regime:0;let a=Array(r.value.length).fill(0);a[t]=1;for(let n=0;n<e;n++){const e=Array(r.value.length).fill(0);for(let t=0;t<r.value.length;t++)for(let n=0;n<r.value.length;n++)e[t]+=a[n]*r.value[n][t];a=e}return a};return(e,t)=>(w(),i("div",GR,[t[14]||(t[14]=I('<div class="section-header" data-v-6751b809><div class="header-left" data-v-6751b809><h1 class="section-title" data-v-6751b809>Детальный анализ режимов</h1><p class="section-subtitle" data-v-6751b809>Метрики устойчивости, матрицы переходов и сценарное прогнозирование</p></div><div class="header-actions" data-v-6751b809><div class="glass-pill status-pill" data-v-6751b809><span class="status-label text-muted" data-v-6751b809>Данные: <b class="text-white" data-v-6751b809>01.11.2025</b></span></div></div></div>',1)),u.value?(w(),i("div",WR,[...t[0]||(t[0]=[s("div",{class:"spinner-large"},null,-1),s("p",null,"Загрузка данных режимов...",-1)])])):(w(),i("div",qR,[(w(!0),i(p,null,f(a.value,(e,a)=>{return w(),i("div",{key:a,class:c(["glass-card regime-card",`border-${b(a)}`])},[s("div",YR,[s("span",{class:c(["dot",`bg-${b(a)}`])},null,2),s("h3",null,"Состояние "+v(a)+": "+v(g(a)),1)]),s("div",jR,[s("p",XR,v((n=a,["Динамическое равновесие без ярко выраженного направления. Рынок стабилизируется, волатильность минимальна.",'Фаза понижательного тренда с высокой волатильностью. "Липкое" состояние с короткими отскоками.',"Периоды возрастающего тренда. Систематический рост стоимости активов с умеренными колебаниями.","Коррекционная фаза после роста. Умеренное снижение с сохранением общей тенденции.","Фаза восстановления после падения. Постепенный возврат к равновесию."][n]||"Режим рыночной активности")),1),h(a)?(w(),i("div",$R,[s("div",KR,[t[1]||(t[1]=s("span",null,"Количество дней",-1)),s("strong",null,v(h(a).days),1)]),s("div",ZR,[t[2]||(t[2]=s("span",null,"Доля периода",-1)),s("strong",null,v((100*h(a).frequency).toFixed(1))+"%",1)]),s("div",JR,[t[3]||(t[3]=s("span",null,"Ср. доходность",-1)),s("strong",{class:c(h(a).meanReturn>=0?"text-green":"text-red")},v((100*h(a).meanReturn).toFixed(3))+"% ",3)]),s("div",QR,[t[4]||(t[4]=s("span",null,"Волатильность",-1)),s("strong",null,v((100*h(a).volatility).toFixed(3))+"%",1)]),s("div",eD,[t[5]||(t[5]=s("span",null,"Устойчивость",-1)),s("strong",null,v(h(a).persistence.toFixed(4)),1)]),s("div",tD,[t[6]||(t[6]=s("span",null,"Ожид. длительность",-1)),s("strong",null,v(h(a).duration?h(a).duration.toFixed(1)+" дня":"∞"),1)])])):l("",!0)])],2);var n}),128))])),s("div",aD,[s("div",nD,[t[9]||(t[9]=s("div",{class:"panel-header"},[s("h3",null,"Матрица переходов")],-1)),s("div",rD,[r.value?(w(),i("div",iD,[t[7]||(t[7]=s("div",{class:"h-label"},"От \\ К",-1)),(w(!0),i(p,null,f(r.value.length,e=>(w(),i("div",{key:e,class:c(["h-col-header",`text-${b(e-1)}`])},v(g(e-1).substring(0,6)),3))),128)),(w(!0),i(p,null,f(r.value,(e,t)=>(w(),i(p,{key:t},[s("div",{class:c(["h-row-header",`text-${b(t)}`])},v(g(t).substring(0,6)),3),(w(!0),i(p,null,f(e,(e,t)=>(w(),i("div",{key:t,class:"h-cell",style:y({background:`rgba(${x(t)}, ${.8*e})`})},v(e.toFixed(2)),5))),128))],64))),128))])):l("",!0),t[8]||(t[8]=s("div",{class:"analysis-note mt-4"},[s("p",null,[m("• "),s("strong",null,"Стабильность"),m(" имеет наивысшую инерцию (0.96)."),s("br"),m("• Из "),s("strong",null,"Падения"),m(" выход в Рост (25%) вероятнее, чем в Стабильность (8%).")])],-1))])]),s("div",oD,[t[12]||(t[12]=s("div",{class:"panel-header"},[s("h3",null,"Прогноз вероятностей"),s("span",{class:"sub-label"},[m("Начальное состояние: "),s("b",null,"Рост")])],-1)),s("div",sD,[s("table",lD,[r.value?(w(),i("thead",cD,[s("tr",null,[t[10]||(t[10]=s("th",{class:"text-left pl-2"},"Горизонт",-1)),(w(!0),i(p,null,f(a.value,(e,t)=>(w(),i("th",{key:t,class:c([`text-${b(t)}`,"text-right"])}," P("+v(g(t).substring(0,4))+") ",3))),128))])])):l("",!0),r.value&&d.value.length>0?(w(),i("tbody",uD,[(w(),i(p,null,f([1,5,10],e=>s("tr",{key:e},[s("td",dD,v(e)+" "+v(1===e?"день":"дней"),1),(w(!0),i(p,null,f(_(e),(e,t)=>(w(),i("td",{key:t,class:"text-right"},v((100*e).toFixed(1))+"% ",1))),128))])),64)),s("tr",hD,[t[11]||(t[11]=s("td",{class:"pl-2 text-orange font-bold"},"∞ (Долгосрочный)",-1)),(w(!0),i(p,null,f(d.value,(e,t)=>(w(),i("td",{key:t,class:"text-right font-bold text-orange"},v((100*e).toFixed(1))+"% ",1))),128))])])):l("",!0)])]),t[13]||(t[13]=I('<div class="chart-mini mt-4" data-v-6751b809><div class="chart-label-sm" data-v-6751b809>Сходимость к стационарному состоянию</div><svg viewBox="0 0 400 60" class="svg-curves" data-v-6751b809><path d="M0,50 Q100,45 200,30 T400,10" fill="none" stroke="#3b82f6" stroke-width="2" data-v-6751b809></path><path d="M0,10 Q100,20 200,30 T400,45" fill="none" stroke="#4ade80" stroke-width="2" data-v-6751b809></path><line x1="0" y1="10" x2="400" y2="10" stroke="rgba(255,255,255,0.1)" stroke-dasharray="4" data-v-6751b809></line><line x1="0" y1="50" x2="400" y2="50" stroke="rgba(255,255,255,0.1)" stroke-dasharray="4" data-v-6751b809></line></svg></div>',1))])]),t[15]||(t[15]=I('<div class="grid-2 mb-6" data-v-6751b809><div class="glass-card panel" data-v-6751b809><div class="panel-header" data-v-6751b809><h3 data-v-6751b809>Распределение доходностей по режимам</h3></div><div class="chart-container-rect" data-v-6751b809><svg viewBox="0 0 600 250" class="svg-chart" data-v-6751b809><line x1="50" y1="220" x2="550" y2="220" stroke="rgba(255,255,255,0.1)" data-v-6751b809></line><line x1="300" y1="20" x2="300" y2="220" stroke="rgba(255,255,255,0.1)" stroke-dasharray="4" data-v-6751b809></line><path d="M150,220 Q300,-100 450,220" fill="rgba(59, 130, 246, 0.1)" stroke="#3b82f6" stroke-width="2" data-v-6751b809></path><path d="M50,220 Q200,50 400,220" fill="rgba(248, 113, 113, 0.1)" stroke="#f87171" stroke-width="2" data-v-6751b809></path><path d="M200,220 Q380,50 500,220" fill="rgba(74, 222, 128, 0.1)" stroke="#4ade80" stroke-width="2" data-v-6751b809></path><text x="310" y="30" fill="#3b82f6" font-size="10" font-weight="600" data-v-6751b809>Стабильность (Низкая σ)</text><text x="100" y="100" fill="#f87171" font-size="10" font-weight="600" data-v-6751b809>Падение (Отрицательная μ)</text><text x="450" y="100" fill="#4ade80" font-size="10" font-weight="600" data-v-6751b809>Рост (Положительная μ)</text></svg></div><p class="chart-caption" data-v-6751b809>Распределение изменений доходностей. Режим «Падение» имеет &quot;толстый хвост&quot; слева.</p></div><div class="glass-card panel" data-v-6751b809><div class="panel-header" data-v-6751b809><h3 data-v-6751b809>Характеристики режимов (Волатильность vs Доходность)</h3></div><div class="chart-container-rect" data-v-6751b809><svg viewBox="0 0 500 250" class="svg-chart" data-v-6751b809><rect x="50" y="150" width="40" height="50" fill="#3b82f6" opacity="0.8" rx="4" data-v-6751b809></rect><rect x="100" y="195" width="40" height="5" fill="#3b82f6" opacity="0.3" rx="4" data-v-6751b809></rect><rect x="200" y="50" width="40" height="150" fill="#f87171" opacity="0.8" rx="4" data-v-6751b809></rect><rect x="250" y="200" width="40" height="40" fill="#f87171" opacity="0.3" rx="4" data-v-6751b809></rect><rect x="350" y="100" width="40" height="100" fill="#4ade80" opacity="0.8" rx="4" data-v-6751b809></rect><rect x="400" y="160" width="40" height="40" fill="#4ade80" opacity="0.3" rx="4" data-v-6751b809></rect><text x="95" y="240" fill="rgba(255,255,255,0.6)" text-anchor="middle" font-size="12" data-v-6751b809>Стабильность</text><text x="245" y="240" fill="rgba(255,255,255,0.6)" text-anchor="middle" font-size="12" data-v-6751b809>Падение</text><text x="395" y="240" fill="rgba(255,255,255,0.6)" text-anchor="middle" font-size="12" data-v-6751b809>Рост</text><rect x="340" y="20" width="10" height="10" fill="#fff" opacity="0.8" rx="2" data-v-6751b809></rect> <text x="360" y="30" fill="#fff" font-size="10" data-v-6751b809>Волатильность (σ)</text><rect x="340" y="40" width="10" height="10" fill="#fff" opacity="0.3" rx="2" data-v-6751b809></rect> <text x="360" y="50" fill="#fff" font-size="10" data-v-6751b809>Доходность (|μ|)</text></svg></div></div></div>',1))]))}}),fD=xe(pD,[["__scopeId","data-v-6751b809"]]),mD="http://localhost:8000";function vD(e){return{Noise:"Шум",Transient:"Переходный",Normal:"Нормальный",Stress:"Стрессовый",Crisis:"Кризисный"}[e]||e}function gD(e){return{Noise:"#94a3b8",Transient:"#fbbf24",Normal:"#4ade80",Stress:"#f97316",Crisis:"#ef4444"}[e]||"#3b82f6"}function yD(e){const t=["#3b82f6","#4ade80","#f97316","#ef4444","#a855f7","#06b6d4","#f43f5e"];return t[e%t.length]}function bD(e){return!isFinite(e)||e<=0?"N/A":e<1?"< 1 дня":e<7?`${e.toFixed(1)} дн.`:e<30?`${(e/7).toFixed(1)} нед.`:e<365?`${(e/30).toFixed(1)} мес.`:`${(e/365).toFixed(1)} лет`}const xD={class:"page-container custom-scroll"},wD={class:"section-header"},_D={class:"header-actions"},SD={key:0,class:"glass-pill status-pill"},MD={class:"status-label"},TD={class:"text-white"},kD={key:1,class:"glass-pill"},CD={class:"dashboard-grid"},AD={class:"left-panel"},ED={class:"glass-card panel"},ID={class:"controls-form"},RD={class:"input-group"},DD={class:"input-group mt-2"},PD=["value"],LD={class:"input-group mt-2"},ND={class:"glass-card panel"},OD={class:"controls-form"},FD={class:"input-group"},BD={class:"checkbox-label"},UD={class:"range-row"},zD=["disabled"],VD={class:"range-value"},HD={class:"range-row"},GD=["disabled"],WD={class:"range-value"},qD=["disabled"],YD={key:0},jD={key:1,class:"flex items-center gap-2"},XD={key:0,class:"glass-card panel"},$D={class:"metrics-grid"},KD={class:"metric-item"},ZD={class:"metric-value text-blue"},JD={class:"metric-item"},QD={class:"metric-value"},eP={key:0,class:"text-xs text-yellow ml-1"},tP={class:"metric-item"},aP={class:"metric-item"},nP={class:"metric-value text-green"},rP={key:0,class:"optimization-info"},iP={class:"opt-item"},oP={class:"opt-value"},sP={class:"opt-item"},lP={class:"opt-value"},cP={key:0},uP={key:1},dP={key:0},hP={key:1},pP={key:0,class:"glass-card panel"},fP={class:"regime-list"},mP={class:"regime-header"},vP={class:"regime-name"},gP={class:"regime-metrics"},yP={class:"rm-item"},bP={class:"rm-value"},xP={class:"rm-item"},wP={class:"rm-value"},_P={class:"rm-item"},SP={class:"rm-value"},MP={class:"regime-bar"},TP={class:"regime-bar-label"},kP={class:"main-panel"},CP={class:"glass-card chart-card"},AP={class:"chart-header"},EP={key:0,class:"badge-info"},IP={class:"poles-container"},RP={key:0,viewBox:"-1.5 -1.5 3 3",preserveAspectRatio:"xMidYMid meet",class:"poles-svg"},DP=["cx","cy","fill"],PP=["cx","cy","fill"],LP=["x","y"],NP={key:1,viewBox:"-1.5 -1.5 3 3",preserveAspectRatio:"xMidYMid meet",class:"poles-svg placeholder"},OP={class:"glass-card chart-card mt-4"},FP={class:"chart-header"},BP={class:"ch-left"},UP={key:0,class:"badge-ticker"},zP={key:0,class:"playback-controls"},VP=["title"],HP={key:0},GP={key:1},WP={class:"timeline-wrapper"},qP=["max"],YP={class:"chart-container"},jP={key:0,viewBox:"0 0 800 300",preserveAspectRatio:"none",class:"dynamics-svg"},XP=["x","width","fill"],$P=["y1","y2"],KP=["d"],ZP=["x1","x2"],JP={key:1,viewBox:"0 0 800 300",preserveAspectRatio:"none",class:"dynamics-svg placeholder"},QP=["y1","y2"],eL={key:0},tL={key:1,x:"400",y:"150",fill:"rgba(255,255,255,0.3)","font-size":"14","text-anchor":"middle","font-weight":"300"},aL={class:"glass-card chart-card mt-4"},nL={class:"chart-container-sm"},rL={key:0,viewBox:"0 0 800 160",preserveAspectRatio:"none",class:"energy-svg"},iL=["d","fill"],oL={key:1,viewBox:"0 0 800 120",preserveAspectRatio:"none",class:"entropy-svg placeholder"},sL={class:"glass-card chart-card mt-4"},lL={class:"chart-header"},cL={key:0,class:"badge-info"},uL={class:"chart-container-sm"},dL={key:0,viewBox:"0 0 800 120",preserveAspectRatio:"none",class:"entropy-svg"},hL=["d"],pL=["y1","y2"],fL=["y"],mL={key:1,viewBox:"0 0 800 120",preserveAspectRatio:"none",class:"entropy-svg placeholder"},vL={class:"glass-card chart-card mt-4"},gL={class:"chart-container-sm"},yL={key:0,viewBox:"0 0 800 140",preserveAspectRatio:"none",class:"spectrum-svg"},bL=["d"],xL=["y1","y2"],wL={key:1,viewBox:"0 0 800 140",preserveAspectRatio:"none",class:"spectrum-svg placeholder"},_L=["y1","y2"],SL={key:0,class:"error-toast"},ML=e({__name:"SpectralRegimeAnalysis",setup(e){const a=t(null),n=t("stocks"),o=t("SPY"),d=t(252),g=t(!0),b=t(5),x=t(20),_=t(!1),C=t("Загрузка..."),A=t(""),E=t(null),P=t(null),N=t(0),F=t(!1);let B=null;const U=S(()=>a.value&&a.value[n.value]||[]);R(n,()=>{const e=U.value;e.length>0&&(o.value=e[0].ticker)}),(async()=>{try{const e=await async function(){const e=await fetch(`${mD}/api/spectral-regime/assets`);if(!e.ok)throw new Error(`Ошибка получения списка активов: ${e.status}`);return e.json()}();e.success&&(a.value=e.data)}catch(TQe){console.error("Failed to load assets:",TQe)}})();const z=S(()=>E.value?E.value.analysis.visualization.dynamics:null),V=S(()=>E.value?E.value.analysis.visualization.spectrum:null),H=S(()=>E.value?E.value.analysis.visualization.poles:[]),G=S(()=>E.value?E.value.analysis.visualization.regime_poles:[]),W=S(()=>{if(!E.value)return[];const e=E.value.analysis.summary.regime_params;return Object.values(e)}),q=S(()=>E.value?E.value.analysis.summary.current_metrics.regime_index:-1),Y=S(()=>{if(!E.value)return"N/A";return vD(E.value.analysis.summary.current_metrics.regime_type)}),j=S(()=>{if(!E.value)return"#3b82f6";const e=q.value;return yD(e>=0?e:0)}),X=S(()=>E.value?E.value.analysis.summary.current_metrics.entropy.toFixed(3):"N/A"),$=S(()=>{if(!E.value)return"";const e=E.value.analysis.summary.current_metrics.entropy/Math.log(E.value.analysis.summary.n_regimes);return e<.3?"text-green":e<.7?"text-yellow":"text-red"}),K=S(()=>z.value?z.value.regime_signal.length-1:0),Z=S(()=>0===K.value?0:N.value/K.value*100),J=S(()=>z.value?z.value.regime_signal.slice(0,N.value+1):[]),Q=S(()=>z.value?800/z.value.regime_signal.length:1),ee=e=>e*Q.value,te=S(()=>{if(!z.value||!z.value.time_series.length)return"";const e=z.value.time_series.slice(0,N.value+1),t=Math.min(...z.value.time_series),a=Math.max(...z.value.time_series)-t||1;return"M "+e.map((e,n)=>{const r=ee(n),i=300-(e-t)/a*260-20;return`${r.toFixed(1)},${i.toFixed(1)}`}).join(" L ")}),ae=e=>{if(!z.value||!z.value.regime_energies.length)return"";const t=z.value.regime_energies.slice(0,N.value+1),a=t.length;let n=[],r=[];for(let i=0;i<a;i++){const a=ee(i);let o=0;for(let n=0;n<e;n++)o+=t[i][n]||0;const s=160-150*(o+(t[i][e]||0))-5,l=160-150*o-5;n.push(`${a.toFixed(1)},${s.toFixed(1)}`),r.push(`${a.toFixed(1)},${l.toFixed(1)}`)}return`M ${n[0]} L ${n.join(" L ")} L ${r.reverse().join(" L ")} Z`},ne=S(()=>{if(!z.value||!z.value.entropy.length)return"";const e=z.value.entropy.slice(0,N.value+1);Math.log(E.value?.analysis.summary.n_regimes||3);let t="M 0,120 ";return e.forEach((e,a)=>{const n=ee(a),r=re(e);t+=`L ${n.toFixed(1)},${r.toFixed(1)} `}),t+=`L ${ee(e.length-1).toFixed(1)},120 Z`,t}),re=e=>115-e/(1.1*Math.log(E.value?.analysis.summary.n_regimes||3))*100,ie=S(()=>{if(!V.value||!V.value.amplitude.length)return"";const e=V.value.amplitude,t=Math.max(...e),a=Math.min(...e),n=t-a||1;return"M "+e.map((t,r)=>{const i=r/e.length*800,o=130-(t-a)/n*110-10;return`${i.toFixed(1)},${o.toFixed(1)}`}).join(" L ")}),oe=e=>{if(!E.value)return 0;const t=E.value.analysis.summary.regime_time_stats[String(e)];return t?.percentage||0},se=()=>{F.value?le():(N.value>=K.value&&(N.value=0),F.value=!0,ue())},le=()=>{F.value=!1,B&&(cancelAnimationFrame(B),B=null)},ce=()=>{le(),N.value=0},ue=()=>{if(!F.value)return;const e=N.value+2;e>=K.value?(N.value=K.value,le()):(N.value=e,B=requestAnimationFrame(ue))},de=async()=>{if(!_.value){_.value=!0,C.value="Загрузка данных...",A.value="",le();try{C.value="Загрузка данных...",await new Promise(e=>setTimeout(e,100)),C.value=g.value?"Оптимизация параметров...":"Анализ спектра...";const e=await async function(e,t=252,a,n,r=!0,i="bic"){const o=new URLSearchParams({ticker:e,period_days:t.toString(),auto_optimize:r.toString(),criterion:i});null!=a&&o.append("n_poles",a.toString()),null!=n&&o.append("window_size",n.toString());const s=await fetch(`${mD}/api/spectral-regime/analyze-asset?${o}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!s.ok){const e=await s.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`Ошибка анализа актива: ${s.status}`)}return s.json()}(o.value,d.value,g.value?null:b.value,g.value?null:x.value,g.value,"bic");e.success?(E.value=e,P.value=e.asset_metadata,N.value=0,setTimeout(()=>{N.value=K.value},100)):A.value="Ошибка при выполнении анализа"}catch(TQe){console.error("Analysis error:",TQe),A.value=TQe.message||"Неизвестная ошибка"}finally{_.value=!1,C.value=""}}};return r(()=>{le()}),(e,t)=>(w(),i("div",xD,[s("div",wD,[t[9]||(t[9]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Комплексный анализ скрытых рыночных режимов"),s("p",{class:"section-subtitle"},"Спектральная декомпозиция через мероморфное расширение")],-1)),s("div",_D,[E.value?(w(),i("div",SD,[s("span",{class:"dot",style:y({background:j.value})},null,4),s("span",MD,[t[8]||(t[8]=m(" Режим: ",-1)),s("b",TD,v(Y.value),1)])])):l("",!0),E.value?(w(),i("div",kD,[s("span",{class:c(E.value.summary.stability.is_stable?"text-green":"text-red")},v(E.value.summary.stability.is_stable?"Стабильный":"Нестабильный"),3)])):l("",!0)])]),s("div",CD,[s("aside",AD,[s("div",ED,[t[15]||(t[15]=s("div",{class:"panel-header"},[s("h3",null,"Выбор актива")],-1)),s("div",ID,[s("div",RD,[t[11]||(t[11]=s("label",{class:"lbl"},"Категория",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),class:"glass-select full-width"},[...t[10]||(t[10]=[I('<option value="stocks" data-v-ea19de92>Акции (US)</option><option value="crypto" data-v-ea19de92>Криптовалюты</option><option value="commodities" data-v-ea19de92>Сырьё</option><option value="bonds" data-v-ea19de92>Облигации</option><option value="forex" data-v-ea19de92>Валюты</option><option value="russia" data-v-ea19de92>Россия</option>',6)])],512),[[D,n.value]])]),s("div",DD,[t[12]||(t[12]=s("label",{class:"lbl"},"Актив",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),class:"glass-select full-width"},[(w(!0),i(p,null,f(U.value,e=>(w(),i("option",{key:e.ticker,value:e.ticker},v(e.name)+" ("+v(e.ticker)+") ",9,PD))),128))],512),[[D,o.value]])]),s("div",LD,[t[14]||(t[14]=s("label",{class:"lbl"},"Период (дни)",-1)),T(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e),class:"glass-select full-width"},[...t[13]||(t[13]=[s("option",{value:126},"6 месяцев (126)",-1),s("option",{value:252},"1 год (252)",-1),s("option",{value:504},"2 года (504)",-1),s("option",{value:756},"3 года (756)",-1),s("option",{value:1260},"5 лет (1260)",-1)])],512),[[D,d.value]])])])]),s("div",ND,[t[23]||(t[23]=s("div",{class:"panel-header"},[s("h3",null,"Параметры анализа")],-1)),s("div",OD,[s("div",FD,[s("label",BD,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>g.value=e),class:"checkbox-input"},null,512),[[L,g.value]]),t[16]||(t[16]=s("span",{class:"checkbox-text"},"Автоматическая оптимизация параметров",-1))]),t[17]||(t[17]=s("span",{class:"hint"},"Автоматически определяет оптимальные значения",-1))]),s("div",{class:c(["input-group",{"opacity-50":g.value}])},[t[18]||(t[18]=s("label",{class:"lbl"},"Количество полюсов (M)",-1)),s("div",UD,[T(s("input",{type:"range","onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e),min:"3",max:"12",step:"1",class:"range-slider",disabled:g.value},null,8,zD),[[k,b.value,void 0,{number:!0}]]),s("span",VD,v(g.value?"auto":b.value),1)]),t[19]||(t[19]=s("span",{class:"hint"},"Рекомендуется 5-8",-1))],2),s("div",{class:c(["input-group mt-3",{"opacity-50":g.value}])},[t[20]||(t[20]=s("label",{class:"lbl"},"Размер окна (W)",-1)),s("div",HD,[T(s("input",{type:"range","onUpdate:modelValue":t[5]||(t[5]=e=>x.value=e),min:"10",max:"50",step:"5",class:"range-slider",disabled:g.value},null,8,GD),[[k,x.value,void 0,{number:!0}]]),s("span",WD,v(g.value?"auto":x.value+" дн."),1)]),t[21]||(t[21]=s("span",{class:"hint"},"Для динамического анализа",-1))],2),s("button",{onClick:de,disabled:_.value,class:"btn-primary-gradient mt-6"},[_.value?(w(),i("span",jD,[t[22]||(t[22]=s("span",{class:"spinner-mini"},null,-1)),m(" "+v(C.value),1)])):(w(),i("span",YD,"Запустить анализ"))],8,qD)])]),u(M,{name:"fade"},{default:h(()=>[E.value?(w(),i("div",XD,[t[30]||(t[30]=s("div",{class:"panel-header"},[s("h3",null,"Текущие метрики")],-1)),s("div",$D,[s("div",KD,[t[24]||(t[24]=s("span",{class:"metric-label"},"Режимов",-1)),s("span",ZD,v(E.value.summary.n_regimes),1)]),s("div",JD,[t[25]||(t[25]=s("span",{class:"metric-label"},"Полюсов",-1)),s("span",QD,[m(v(E.value.summary.n_poles)+" ",1),E.value.summary.optimization?.auto_optimized?(w(),i("span",eP,"(auto)")):l("",!0)])]),s("div",tP,[t[26]||(t[26]=s("span",{class:"metric-label"},"Энтропия",-1)),s("span",{class:c(["metric-value",$.value])},v(X.value),3)]),s("div",aP,[t[27]||(t[27]=s("span",{class:"metric-label"},"Качество",-1)),s("span",nP,v(E.value.summary.reconstruction.pct_explained.toFixed(1))+"% ",1)])]),E.value.summary.optimization?.auto_optimized?(w(),i("div",rP,[s("div",iP,[t[28]||(t[28]=s("span",{class:"opt-label"},"Окно:",-1)),s("span",oP,v(E.value.summary.optimization.window_size_used)+" дн.",1)]),s("div",sP,[t[29]||(t[29]=s("span",{class:"opt-label"},"Критерий:",-1)),s("span",lP,v(E.value.summary.optimization.criterion_used?.toUpperCase()||"BIC"),1)])])):l("",!0),s("div",{class:c(["stability-badge",E.value.summary.stability.is_stable?"stable":"unstable"])},[E.value.summary.stability.is_stable?(w(),i("span",cP," Все полюсы внутри единичного круга ")):(w(),i("span",uP,v(E.value.summary.stability.n_violations)+" нестабильных полюсов ",1))],2),s("div",{class:c(["stability-badge mt-2",E.value.summary.minimum_phase.is_minimum_phase?"stable":"warning"])},[E.value.summary.minimum_phase.is_minimum_phase?(w(),i("span",dP," Минимально-фазовая система ")):(w(),i("span",hP," Non-minimum phase (признак кризиса) "))],2)])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[E.value&&W.value.length?(w(),i("div",pP,[t[34]||(t[34]=s("div",{class:"panel-header"},[s("h3",null,"Параметры режимов")],-1)),s("div",fP,[(w(!0),i(p,null,f(W.value,(e,a)=>(w(),i("div",{key:a,class:c(["regime-item",{active:q.value===a}])},[s("div",mP,[s("span",{class:"regime-dot",style:y({background:O(yD)(a)})},null,4),s("span",vP,"Режим "+v(a),1),s("span",{class:"regime-type",style:y({color:O(gD)(e.type)})},v(O(vD)(e.type)),5)]),s("div",gP,[s("div",yP,[t[31]||(t[31]=s("span",{class:"rm-label"},"|λ|",-1)),s("span",bP,v(e.radius.toFixed(3)),1)]),s("div",xP,[t[32]||(t[32]=s("span",{class:"rm-label"},"τ",-1)),s("span",wP,v(O(bD)(e.duration)),1)]),s("div",_P,[t[33]||(t[33]=s("span",{class:"rm-label"},"I",-1)),s("span",SP,v(e.intensity.toFixed(3)),1)])]),s("div",MP,[s("div",{class:"regime-bar-fill",style:y({width:oe(a)+"%",background:O(yD)(a)})},null,4),s("span",TP,v(oe(a).toFixed(0))+"% времени",1)])],2))),128))])])):l("",!0)]),_:1})]),s("main",kP,[s("div",CP,[s("div",AP,[t[35]||(t[35]=s("h3",null,"Диаграмма полюсов в комплексной плоскости",-1)),E.value?(w(),i("span",EP,v(E.value.summary.n_poles)+" полюсов",1)):l("",!0)]),s("div",IP,[E.value?(w(),i("svg",RP,[t[36]||(t[36]=I('<line x1="-1.5" y1="0" x2="1.5" y2="0" stroke="rgba(255,255,255,0.1)" stroke-width="0.01" data-v-ea19de92></line><line x1="0" y1="-1.5" x2="0" y2="1.5" stroke="rgba(255,255,255,0.1)" stroke-width="0.01" data-v-ea19de92></line><circle cx="0" cy="0" r="1" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="0.02" stroke-dasharray="0.05 0.03" data-v-ea19de92></circle><circle cx="0" cy="0" r="0.5" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.01" data-v-ea19de92></circle><circle cx="0" cy="0" r="0.8" fill="rgba(74, 222, 128, 0.05)" stroke="none" data-v-ea19de92></circle><circle cx="0" cy="0" r="0.95" fill="none" stroke="rgba(251, 191, 36, 0.2)" stroke-width="0.01" data-v-ea19de92></circle>',6)),(w(!0),i(p,null,f(H.value,(e,t)=>{return w(),i("g",{key:"pole-"+t},[s("circle",{cx:e.real,cy:-e.imag,r:"0.04",fill:(a=e.radius,a<.5?"#94a3b8":a<.8?"#fbbf24":a<.95?"#4ade80":a<.999?"#f97316":"#ef4444"),stroke:"rgba(255,255,255,0.5)","stroke-width":"0.01"},null,8,DP)]);var a}),128)),(w(!0),i(p,null,f(G.value,(e,t)=>(w(),i("g",{key:"regime-pole-"+t},[s("circle",{cx:e.real,cy:-e.imag,r:"0.08",fill:O(yD)(e.regime),stroke:"white","stroke-width":"0.015",class:"regime-pole-marker"},null,8,PP),s("text",{x:e.real+.1,y:-e.imag,fill:"white","font-size":"0.12","alignment-baseline":"middle"}," R"+v(e.regime),9,LP)]))),128)),t[37]||(t[37]=s("text",{x:"1.35",y:"0.05",fill:"rgba(255,255,255,0.4)","font-size":"0.08"},"Re",-1)),t[38]||(t[38]=s("text",{x:"0.05",y:"-1.35",fill:"rgba(255,255,255,0.4)","font-size":"0.08"},"Im",-1)),t[39]||(t[39]=s("text",{x:"1.02",y:"0.12",fill:"rgba(255,255,255,0.3)","font-size":"0.06"},"|z|=1",-1))])):(w(),i("svg",NP,[...t[40]||(t[40]=[I('<line x1="-1.5" y1="0" x2="1.5" y2="0" stroke="rgba(255,255,255,0.1)" stroke-width="0.01" data-v-ea19de92></line><line x1="0" y1="-1.5" x2="0" y2="1.5" stroke="rgba(255,255,255,0.1)" stroke-width="0.01" data-v-ea19de92></line><circle cx="0" cy="0" r="1" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="0.02" stroke-dasharray="0.05 0.03" data-v-ea19de92></circle><circle cx="0" cy="0" r="0.5" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="0.01" data-v-ea19de92></circle><circle cx="0" cy="0" r="0.8" fill="rgba(74, 222, 128, 0.03)" stroke="none" data-v-ea19de92></circle><circle cx="0" cy="0" r="0.95" fill="none" stroke="rgba(251, 191, 36, 0.1)" stroke-width="0.01" data-v-ea19de92></circle><circle cx="0.6" cy="0.3" r="0.04" fill="#4ade80" fill-opacity="0.4" stroke="rgba(255,255,255,0.3)" stroke-width="0.01" data-v-ea19de92></circle><circle cx="0.7" cy="-0.2" r="0.04" fill="#fbbf24" fill-opacity="0.4" stroke="rgba(255,255,255,0.3)" stroke-width="0.01" data-v-ea19de92></circle><circle cx="0.85" cy="0.1" r="0.08" fill="#3b82f6" fill-opacity="0.4" stroke="rgba(255,255,255,0.4)" stroke-width="0.015" data-v-ea19de92></circle><circle cx="0.4" cy="0.5" r="0.04" fill="#f97316" fill-opacity="0.4" stroke="rgba(255,255,255,0.3)" stroke-width="0.01" data-v-ea19de92></circle><text x="1.35" y="0.05" fill="rgba(255,255,255,0.2)" font-size="0.08" data-v-ea19de92>Re</text><text x="0.05" y="-1.35" fill="rgba(255,255,255,0.2)" font-size="0.08" data-v-ea19de92>Im</text><text x="1.02" y="0.12" fill="rgba(255,255,255,0.15)" font-size="0.06" data-v-ea19de92>|z|=1</text><text x="0" y="0.3" fill="rgba(255,255,255,0.3)" font-size="0.2" text-anchor="middle" font-weight="300" data-v-ea19de92> Запустите анализ </text>',14)])]))])]),s("div",OP,[s("div",FP,[s("div",BP,[t[41]||(t[41]=s("h3",null,"Динамика и режимы",-1)),P.value?(w(),i("span",UP,v(P.value.ticker),1)):l("",!0)]),E.value?(w(),i("div",zP,[s("button",{class:"icon-btn",onClick:se,title:F.value?"Пауза":"Воспроизвести"},[F.value?(w(),i("span",HP,"⏸")):(w(),i("span",GP,"▶"))],8,VP),s("div",WP,[T(s("input",{type:"range",min:0,max:K.value,"onUpdate:modelValue":t[6]||(t[6]=e=>N.value=e),onInput:le,class:"timeline-slider"},null,40,qP),[[k,N.value,void 0,{number:!0}]]),s("div",{class:"timeline-track",style:y({width:Z.value+"%"})},null,4)]),s("button",{class:"icon-btn",onClick:ce,title:"Сброс"},"↺")])):l("",!0)]),s("div",YP,[E.value&&z.value?(w(),i("svg",jP,[(w(!0),i(p,null,f(J.value,(e,t)=>(w(),i("rect",{key:"bg-"+t,x:ee(t),y:"0",width:Q.value+.5,height:"300",fill:O(yD)(e),"fill-opacity":"0.15"},null,8,XP))),128)),(w(),i(p,null,f([75,150,225],e=>s("line",{key:"grid-"+e,x1:"0",y1:e,x2:"800",y2:e,stroke:"rgba(255,255,255,0.05)"},null,8,$P)),64)),s("path",{d:te.value,fill:"none",stroke:"white","stroke-width":"1.5","stroke-linejoin":"round"},null,8,KP),N.value<K.value?(w(),i("line",{key:0,x1:ee(N.value),y1:"0",x2:ee(N.value),y2:"300",stroke:"rgba(255,255,255,0.6)","stroke-dasharray":"4"},null,8,ZP)):l("",!0)])):(w(),i("svg",JP,[(w(),i(p,null,f([75,150,225],e=>s("line",{key:"grid-"+e,x1:"0",y1:e,x2:"800",y2:e,stroke:"rgba(255,255,255,0.05)"},null,8,QP)),64)),t[43]||(t[43]=I('<rect x="0" y="0" width="160" height="300" fill="rgba(59, 130, 246, 0.08)" data-v-ea19de92></rect><rect x="160" y="0" width="160" height="300" fill="rgba(74, 222, 128, 0.08)" data-v-ea19de92></rect><rect x="320" y="0" width="160" height="300" fill="rgba(59, 130, 246, 0.08)" data-v-ea19de92></rect><rect x="480" y="0" width="160" height="300" fill="rgba(251, 191, 36, 0.08)" data-v-ea19de92></rect><rect x="640" y="0" width="160" height="300" fill="rgba(59, 130, 246, 0.08)" data-v-ea19de92></rect><path d="M 0,150 Q 100,100 200,120 T 400,140 T 600,130 T 800,150" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="1.5" stroke-linejoin="round" stroke-dasharray="4 2" data-v-ea19de92></path>',6)),_.value?(w(),i("g",eL,[...t[42]||(t[42]=[s("circle",{cx:"400",cy:"150",r:"20",fill:"none",stroke:"rgba(59, 130, 246, 0.5)","stroke-width":"2","stroke-dasharray":"10 5"},[s("animateTransform",{attributeName:"transform",type:"rotate",from:"0 400 150",to:"360 400 150",dur:"1s",repeatCount:"indefinite"})],-1),s("text",{x:"400",y:"200",fill:"rgba(255,255,255,0.4)","font-size":"12","text-anchor":"middle"},"Загрузка...",-1)])])):(w(),i("text",tL," Нажмите «Запустить анализ» "))]))])]),s("div",aL,[t[45]||(t[45]=s("div",{class:"chart-header"},[s("h3",null,"Энергии режимов (нормализованные)")],-1)),s("div",nL,[E.value&&z.value?(w(),i("svg",rL,[(w(!0),i(p,null,f(Array.from({length:E.value.summary.n_regimes},(e,t)=>t).reverse(),e=>(w(),i("g",{key:"energy-"+e},[s("path",{d:ae(e),fill:O(yD)(e),"fill-opacity":"0.6",stroke:"none"},null,8,iL)]))),128))])):(w(),i("svg",oL,[...t[44]||(t[44]=[s("line",{x1:"0",y1:"60",x2:"800",y2:"60",stroke:"rgba(255,255,255,0.1)","stroke-dasharray":"4"},null,-1),s("path",{d:"M 0,100 Q 100,80 200,70 T 400,65 T 600,75 T 800,85",fill:"rgba(139, 92, 246, 0.15)",stroke:"rgba(139, 92, 246, 0.4)","stroke-width":"1.5"},null,-1),s("path",{d:"M 0,100 Q 100,80 200,70 T 400,65 T 600,75 T 800,85 L 800,120 L 0,120 Z",fill:"rgba(139, 92, 246, 0.15)",stroke:"none"},null,-1),s("text",{x:"400",y:"70",fill:"rgba(255,255,255,0.2)","font-size":"11","text-anchor":"middle","font-weight":"300"}," Энтропия режимности ",-1)])]))])]),s("div",sL,[s("div",lL,[t[46]||(t[46]=s("h3",null,"Энтропия режимности",-1)),E.value?(w(),i("span",cL," Средняя: "+v(E.value.summary.entropy_stats.mean?.toFixed(3)||"N/A"),1)):l("",!0)]),s("div",uL,[E.value&&z.value?(w(),i("svg",dL,[s("path",{d:ne.value,fill:"rgba(139, 92, 246, 0.3)",stroke:"#8b5cf6","stroke-width":"1.5"},null,8,hL),s("line",{x1:"0",y1:re(Math.log(E.value.summary.n_regimes)),x2:"800",y2:re(Math.log(E.value.summary.n_regimes)),stroke:"rgba(255,255,255,0.2)","stroke-dasharray":"4"},null,8,pL),s("text",{x:"10",y:re(Math.log(E.value.summary.n_regimes))-5,fill:"rgba(255,255,255,0.3)","font-size":"9"}," max entropy ",8,fL)])):(w(),i("svg",mL,[...t[47]||(t[47]=[s("line",{x1:"0",y1:"60",x2:"800",y2:"60",stroke:"rgba(255,255,255,0.1)","stroke-dasharray":"4"},null,-1),s("path",{d:"M 0,100 Q 100,80 200,70 T 400,65 T 600,75 T 800,85",fill:"rgba(139, 92, 246, 0.15)",stroke:"rgba(139, 92, 246, 0.4)","stroke-width":"1.5"},null,-1),s("path",{d:"M 0,100 Q 100,80 200,70 T 400,65 T 600,75 T 800,85 L 800,120 L 0,120 Z",fill:"rgba(139, 92, 246, 0.15)",stroke:"none"},null,-1),s("text",{x:"400",y:"70",fill:"rgba(255,255,255,0.2)","font-size":"11","text-anchor":"middle","font-weight":"300"}," Энтропия режимности ",-1)])]))])]),s("div",vL,[t[52]||(t[52]=s("div",{class:"chart-header"},[s("h3",null,"Амплитудный спектр |H(e^iw)|")],-1)),s("div",gL,[E.value&&V.value?(w(),i("svg",yL,[s("path",{d:ie.value,fill:"none",stroke:"#60a5fa","stroke-width":"1.5"},null,8,bL),(w(),i(p,null,f([35,70,105],e=>s("line",{key:"spec-grid-"+e,x1:"0",y1:e,x2:"800",y2:e,stroke:"rgba(255,255,255,0.05)"},null,8,xL)),64)),t[48]||(t[48]=s("text",{x:"5",y:"135",fill:"rgba(255,255,255,0.3)","font-size":"9"},"0",-1)),t[49]||(t[49]=s("text",{x:"395",y:"135",fill:"rgba(255,255,255,0.3)","font-size":"9"},"π/2",-1)),t[50]||(t[50]=s("text",{x:"790",y:"135",fill:"rgba(255,255,255,0.3)","font-size":"9"},"π",-1))])):(w(),i("svg",wL,[(w(),i(p,null,f([35,70,105],e=>s("line",{key:"spec-grid-"+e,x1:"0",y1:e,x2:"800",y2:e,stroke:"rgba(255,255,255,0.05)"},null,8,_L)),64)),t[51]||(t[51]=I('<path d="M 0,120 Q 200,100 400,60 T 800,40" fill="none" stroke="rgba(96, 165, 250, 0.4)" stroke-width="1.5" stroke-dasharray="3 2" data-v-ea19de92></path><text x="5" y="135" fill="rgba(255,255,255,0.2)" font-size="9" data-v-ea19de92>0</text><text x="395" y="135" fill="rgba(255,255,255,0.2)" font-size="9" data-v-ea19de92>π/2</text><text x="790" y="135" fill="rgba(255,255,255,0.2)" font-size="9" data-v-ea19de92>π</text><text x="400" y="80" fill="rgba(255,255,255,0.2)" font-size="11" text-anchor="middle" font-weight="300" data-v-ea19de92> Амплитудный спектр </text>',5))]))])])])]),u(M,{name:"fade"},{default:h(()=>[A.value?(w(),i("div",SL,[m(v(A.value)+" ",1),s("button",{onClick:t[7]||(t[7]=e=>A.value=""),class:"close-btn"},"×")])):l("",!0)]),_:1})]))}}),TL=xe(ML,[["__scopeId","data-v-ea19de92"]]),kL={class:"page-container custom-scroll"},CL={class:"section-header"},AL={class:"header-actions"},EL={class:"glass-pill control-pill"},IL={class:"text-white font-bold"},RL={class:"text-white font-bold"},DL={class:"dropdown-header"},PL={class:"asset-list"},LL=["value"],NL={class:"asset-checkbox-content"},OL={class:"asset-info"},FL={class:"asset-symbol"},BL={class:"asset-name"},UL={class:"asset-allocation"},zL={class:"analysis-grid"},VL={class:"charts-column"},HL={class:"glass-card chart-container"},GL={class:"chart-area big-chart"},WL={viewBox:"0 0 1000 320",preserveAspectRatio:"none",class:"svg-chart"},qL=["y1","y2"],YL=["d","stroke"],jL=["d"],XL={class:"glass-card chart-container"},$L={class:"panel-header"},KL={class:"legend"},ZL={class:"chart-area big-chart"},JL={viewBox:"0 0 1000 320",preserveAspectRatio:"none",class:"svg-chart"},QL=["y1","y2"],eN=["d"],tN=["d","stroke","filter"],aN=e({__name:"YieldAnalysis",setup(e){const a=Ys(),o=S(()=>a.selectedBank),d=S(()=>a.positions),g=t(!1),b=t(""),x=t([]),_=S(()=>{if(!b.value.trim())return d.value;const e=b.value.toLowerCase();return d.value.filter(t=>t.symbol.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}),C=S(()=>d.value.filter(e=>x.value.includes(e.symbol))),A=t([]),D=t([]),P=t({}),N=()=>{if(0===x.value.length)return void console.warn("No assets selected");const e=[],t=[];for(let n=0;n<50;n++){const a=[],r=[0];let i=0;for(let e=0;e<250;e++){let t=1;e>0&&Math.abs(a[e-1])>2&&(t=2.5);let o=2*(Math.random()-.5)*t;e>220&&Math.random()>.95&&48===n&&(o*=6),a.push(o),i+=o,r.push(i)}e.push(a),t.push(r)}A.value=e,D.value=t;const a={};x.value.forEach(e=>{const t=d.value.find(t=>t.symbol===e);if(t){const n=e.includes("SU")||e.includes("RU000")||e.includes("обл"),r=t.allocation||0,i=t.dayChange||0,o=(n?.8:1.5)*(1+r/100),s=(n?.08:i/100*.5)*(1+Math.abs(i)/50);a[e]=O(s,o)}}),P.value=a},O=(e,t)=>{const a=[0];let n=0;for(let r=0;r<250;r++)n+=(Math.random()-.5)*t+e,a.push(n);return a},F=e=>`hsla(${137*e%360}, 70%, 75%, 0.6)`,B=e=>{const t=d.value.find(t=>t.symbol===e);return t?.color||"#3b82f6"},U=()=>{g.value=!g.value,g.value&&(b.value="")},z=()=>{x.value=_.value.map(e=>e.symbol),N()},V=()=>{x.value=[],P.value={}},H=()=>{N()},G=e=>{const t=e.target;t.closest(".asset-selector-pill")||t.closest(".asset-dropdown")||(g.value=!1)},W=()=>{if(d.value.length>0){const e=[...d.value].sort((e,t)=>t.allocation-e.allocation).slice(0,Math.min(5,d.value.length)).map(e=>e.symbol);x.value=e,N()}};R(()=>a.positions,e=>{e.length>0&&(x.value=x.value.filter(t=>e.some(e=>e.symbol===t)),0===x.value.length?W():N())},{deep:!0});const q=(e,t,a)=>{if(!e||0===e.length)return"";return"M "+e.map((n,r)=>{return`${(t=>t/(e.length-1)*1e3)(r).toFixed(1)},${(i=n,320-(i-a)/(t-a)*320).toFixed(1)}`;var i}).join(" L ")};return n(()=>{document.addEventListener("click",G),W()}),r(()=>{document.removeEventListener("click",G)}),(e,t)=>(w(),i("div",kL,[s("div",CL,[t[7]||(t[7]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Анализ кривых доходности"),s("p",{class:"section-subtitle"},"Сценарное моделирование и стресс-тестирование (Monte Carlo)")],-1)),s("div",AL,[s("div",EL,[t[3]||(t[3]=s("span",{class:"lbl-mini"},"Банк:",-1)),s("span",IL,v(o.value.name),1)]),s("div",{class:c(["glass-pill control-pill asset-selector-pill",{"is-open":g.value}]),onClick:E(U,["stop"])},[t[4]||(t[4]=s("span",{class:"lbl-mini"},"Активы:",-1)),s("span",RL,v(x.value.length>0?`${x.value.length} выбрано`:"Не выбрано"),1),t[5]||(t[5]=s("svg",{class:"chevron",width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M1 1L6 6L11 1"})],-1))],2),s("button",{class:"btn-glass",onClick:N},[...t[6]||(t[6]=[s("span",{class:"icon"},"↻",-1),m(" Обновить симуляцию ",-1)])])]),u(M,{name:"dropdown-fade"},{default:h(()=>[g.value?(w(),i("div",{key:0,class:"asset-dropdown",onClick:t[2]||(t[2]=E(()=>{},["stop"]))},[s("div",DL,[T(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),placeholder:"Поиск активов...",class:"asset-search-input"},null,512),[[k,b.value]]),s("div",{class:"dropdown-actions"},[s("button",{onClick:z,class:"btn-link-sm"},"Выбрать все"),s("button",{onClick:V,class:"btn-link-sm"},"Снять все")])]),s("div",PL,[(w(!0),i(p,null,f(_.value,e=>(w(),i("label",{key:e.symbol,class:c(["asset-checkbox-item",{"is-selected":x.value.includes(e.symbol)}])},[T(s("input",{type:"checkbox",value:e.symbol,"onUpdate:modelValue":t[1]||(t[1]=e=>x.value=e),onChange:H},null,40,LL),[[L,x.value]]),s("div",NL,[s("span",{class:"asset-dot",style:y({background:e.color})},null,4),s("div",OL,[s("span",FL,v(e.symbol),1),s("span",BL,v(e.name),1)]),s("span",UL,v(e.allocation)+"%",1)])],2))),128))])])):l("",!0)]),_:1})]),s("div",zL,[s("div",VL,[s("div",HL,[t[10]||(t[10]=I('<div class="panel-header" data-v-3024ebc7><h3 data-v-3024ebc7>Ежедневные изменения</h3><div class="legend" data-v-3024ebc7><span class="l-item faded" data-v-3024ebc7><span class="dot bg-gray" data-v-3024ebc7></span> Сценарии</span><span class="l-item" data-v-3024ebc7><span class="dot bg-green" data-v-3024ebc7></span> Выбросы</span></div></div>',1)),s("div",GL,[(w(),i("svg",WL,[(w(),i(p,null,f(6,e=>s("line",{key:"g1-"+e,x1:"0",y1:50*e,x2:"1000",y2:50*e,stroke:"rgba(255,255,255,0.05)"},null,8,qL)),64)),t[8]||(t[8]=s("line",{x1:"0",y1:"160",x2:"1000",y2:"160",stroke:"rgba(255,255,255,0.2)","stroke-dasharray":"4"},null,-1)),(w(!0),i(p,null,f(A.value,(e,t)=>(w(),i("path",{key:"d-"+t,d:q(e,12,-12),fill:"none",stroke:F(t),"stroke-width":"0.8",opacity:"0.5",style:{"mix-blend-mode":"screen"}},null,8,YL))),128)),A.value.length?(w(),i("path",{key:0,d:q(A.value[48],12,-12),fill:"none",stroke:"#4ade80","stroke-width":"2",filter:"drop-shadow(0 0 4px rgba(74,222,128,0.5))"},null,8,jL)):l("",!0)])),t[9]||(t[9]=s("div",{class:"chart-label"},"Симуляция волатильности (250 шагов)",-1))])]),s("div",XL,[s("div",$L,[t[11]||(t[11]=s("h3",null,"Накопленная доходность",-1)),s("div",KL,[(w(!0),i(p,null,f(C.value,e=>(w(),i("span",{key:e.symbol,class:"l-item"},[s("span",{class:"dot",style:y({background:e.color})},null,4),m(" "+v(e.symbol),1)]))),128))])]),s("div",ZL,[(w(),i("svg",JL,[(w(),i(p,null,f(6,e=>s("line",{key:"g2-"+e,x1:"0",y1:50*e,x2:"1000",y2:50*e,stroke:"rgba(255,255,255,0.05)"},null,8,QL)),64)),t[12]||(t[12]=s("line",{x1:"0",y1:"160",x2:"1000",y2:"160",stroke:"rgba(255,255,255,0.2)","stroke-dasharray":"4"},null,-1)),(w(!0),i(p,null,f(D.value,(e,t)=>(w(),i("path",{key:"c-"+t,d:q(e,50,-50),fill:"none",stroke:"rgba(255,255,255,0.05)","stroke-width":"1"},null,8,eN))),128)),(w(!0),i(p,null,f(P.value,(e,t)=>(w(),i("path",{key:t,d:q(e,50,-50),fill:"none",stroke:B(t),"stroke-width":"3",filter:`drop-shadow(0 0 6px ${B(t)}40)`},null,8,tN))),128))])),t[13]||(t[13]=s("div",{class:"chart-label"},"Долгосрочные тренды",-1))])])]),t[14]||(t[14]=I('<aside class="stats-column" data-v-3024ebc7><div class="glass-card sticky-panel" data-v-3024ebc7><div class="panel-header-sm" data-v-3024ebc7><h3 data-v-3024ebc7>Статистика волатильности</h3></div><div class="stat-list" data-v-3024ebc7><div class="stat-row" data-v-3024ebc7><span class="lbl" data-v-3024ebc7>Макс. дневное изменение</span><span class="val text-red font-mono" data-v-3024ebc7>+8.4%</span></div><div class="stat-row" data-v-3024ebc7><span class="lbl" data-v-3024ebc7>Возврат к среднему</span><span class="val font-mono" data-v-3024ebc7>0.45</span></div><div class="stat-row" data-v-3024ebc7><span class="lbl" data-v-3024ebc7>Kurtosis (Эксцесс)</span><span class="val text-orange font-mono" data-v-3024ebc7>5.2</span></div></div><div class="divider" data-v-3024ebc7></div><div class="panel-header-sm" data-v-3024ebc7><h3 data-v-3024ebc7>Параметры симуляции</h3></div><div class="stat-list" data-v-3024ebc7><div class="stat-row" data-v-3024ebc7><span class="lbl" data-v-3024ebc7>Количество сценариев</span><span class="val font-mono" data-v-3024ebc7>50</span></div><div class="stat-row" data-v-3024ebc7><span class="lbl" data-v-3024ebc7>Горизонт</span><span class="val font-mono" data-v-3024ebc7>250 дней</span></div><div class="stat-row" data-v-3024ebc7><span class="lbl" data-v-3024ebc7>Модель</span><span class="val font-mono text-blue" data-v-3024ebc7>—</span></div></div><div class="divider" data-v-3024ebc7></div><div class="info-block" data-v-3024ebc7><div class="info-item" data-v-3024ebc7><span class="icon" data-v-3024ebc7>PARAMS</span><p data-v-3024ebc7><strong data-v-3024ebc7>График 1</strong> визуализирует &quot;шум&quot; и кластеризацию волатильности. Зеленая линия выделяет экстремальный сценарий (tail risk).</p></div><div class="info-item mt-4" data-v-3024ebc7><span class="icon" data-v-3024ebc7>TRENDS</span><p data-v-3024ebc7><strong data-v-3024ebc7>График 2</strong> показывает интегральные траектории (накопленный итог), формирующие долгосрочные тренды US10Y и US02Y.</p></div></div></div></aside>',1))])]))}}),nN=xe(aN,[["__scopeId","data-v-3024ebc7"]]);
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var rN={version:"0.18.5"},iN=1252,oN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sN={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},lN=function(e){-1!=oN.indexOf(e)&&(iN=sN[0]=e)};var cN=function(e){lN(e)};function uN(){cN(1200),lN(1252)}function dN(e){for(var t=[],a=0,n=e.length;a<n;++a)t[a]=e.charCodeAt(a);return t}function hN(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return t.join("")}var pN,fN=function(e){var t=e.charCodeAt(0),a=e.charCodeAt(1);return 255==t&&254==a?function(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==a?hN(e.slice(2)):65279==t?e.slice(1):e},mN=function(e){return String.fromCharCode(e)},vN=function(e){return String.fromCharCode(e)},gN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yN(e){for(var t="",a=0,n=0,r=0,i=0,o=0,s=0,l=0,c=0;c<e.length;)i=(a=e.charCodeAt(c++))>>2,o=(3&a)<<4|(n=e.charCodeAt(c++))>>4,s=(15&n)<<2|(r=e.charCodeAt(c++))>>6,l=63&r,isNaN(n)?s=l=64:isNaN(r)&&(l=64),t+=gN.charAt(i)+gN.charAt(o)+gN.charAt(s)+gN.charAt(l);return t}function bN(e){var t="",a=0,n=0,r=0,i=0,o=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)a=gN.indexOf(e.charAt(l++))<<2|(i=gN.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(a),n=(15&i)<<4|(o=gN.indexOf(e.charAt(l++)))>>2,64!==o&&(t+=String.fromCharCode(n)),r=(3&o)<<6|(s=gN.indexOf(e.charAt(l++))),64!==s&&(t+=String.fromCharCode(r));return t}var xN=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),wN=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(TQe){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function _N(e){return xN?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function SN(e){return xN?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var MN=function(e){return xN?wN(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function TN(e){if("undefined"==typeof ArrayBuffer)return MN(e);for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!=e.length;++n)a[n]=255&e.charCodeAt(n);return t}function kN(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function CN(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return CN(new Uint8Array(e));for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=e[a];return t}var AN=xN?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:wN(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,a=0;for(t=0;t<e.length;++t)a+=e[t].length;var n=new Uint8Array(a),r=0;for(t=0,a=0;t<e.length;a+=r,++t)if(r=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],a);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),a)}return n}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var EN=/\u0000/g,IN=/[\u0001-\u0006]/g;function RN(e){for(var t="",a=e.length-1;a>=0;)t+=e.charAt(a--);return t}function DN(e,t){var a=""+e;return a.length>=t?a:qO("0",t-a.length)+a}function PN(e,t){var a=""+e;return a.length>=t?a:qO(" ",t-a.length)+a}function LN(e,t){var a=""+e;return a.length>=t?a:a+qO(" ",t-a.length)}var NN=Math.pow(2,32);function ON(e,t){return e>NN||e<-NN?function(e,t){var a=""+Math.round(e);return a.length>=t?a:qO("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:qO("0",t-a.length)+a}(Math.round(e),t)}function FN(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var BN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],UN=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var zN={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},VN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},HN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function GN(e,t,a){for(var n=e<0?-1:1,r=e*n,i=0,o=1,s=0,l=1,c=0,u=0,d=Math.floor(r);c<t&&(s=(d=Math.floor(r))*o+i,u=d*c+l,!(r-d<5e-8));)r=1/(r-d),i=o,o=s,l=c,c=u;if(u>t&&(c>t?(u=l,s=i):(u=c,s=o)),!a)return[0,n*s,u];var h=Math.floor(n*s/u);return[h,n*s-h*u,u]}function WN(e,t,a){if(e>2958465||e<0)return null;var n=0|e,r=Math.floor(86400*(e-n)),i=0,o=[],s={D:n,T:r,u:86400*(e-n)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++r&&(s.T=r=0,++n,++s.D)),60===n)o=a?[1317,10,29]:[1900,2,29],i=3;else if(0===n)o=a?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),a&&(i=function(e,t){t[0]-=581;var a=e.getDay();e<60&&(a=(a+6)%7);return a}(l,o))}return s.y=o[0],s.m=o[1],s.d=o[2],s.S=r%60,r=Math.floor(r/60),s.M=r%60,r=Math.floor(r/60),s.H=r,s.q=i,s}var qN=new Date(1899,11,31,0,0,0),YN=qN.getTime(),jN=new Date(1900,2,1,0,0,0);function XN(e,t){var a=e.getTime();return t?a-=1262304e5:e>=jN&&(a+=864e5),(a-(YN+6e4*(e.getTimezoneOffset()-qN.getTimezoneOffset())))/864e5}function $N(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function KN(e){var t,a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=a>=-4&&a<=-1?e.toPrecision(10+a):Math.abs(a)<=9?function(e){var t=e<0?12:11,a=$N(e.toFixed(12));return a.length<=t||(a=e.toPrecision(10)).length<=t?a:e.toExponential(5)}(e):10===a?e.toFixed(10).substr(0,12):function(e){var t=$N(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),$N(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function ZN(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):KN(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return yO(14,XN(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function JN(e,t,a,n){var r,i="",o=0,s=0,l=a.y,c=0;switch(e){case 98:l=a.y+543;case 121:switch(t.length){case 1:case 2:r=l%100,c=2;break;default:r=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:r=a.m,c=t.length;break;case 3:return UN[a.m-1][1];case 5:return UN[a.m-1][0];default:return UN[a.m-1][2]}break;case 100:switch(t.length){case 1:case 2:r=a.d,c=t.length;break;case 3:return BN[a.q][0];default:return BN[a.q][1]}break;case 104:switch(t.length){case 1:case 2:r=1+(a.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:r=a.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:r=a.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==a.u||"s"!=t&&"ss"!=t?(s=n>=2?3===n?1e3:100:1===n?10:1,(o=Math.round(s*(a.S+a.u)))>=60*s&&(o=0),"s"===t?0===o?"0":""+o/s:(i=DN(o,2+n),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):DN(a.S,t.length);case 90:switch(t){case"[h]":case"[hh]":r=24*a.D+a.H;break;case"[m]":case"[mm]":r=60*(24*a.D+a.H)+a.M;break;case"[s]":case"[ss]":r=60*(60*(24*a.D+a.H)+a.M)+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:r=l,c=1}return c>0?DN(r,c):""}function QN(e){if(e.length<=3)return e;for(var t=e.length%3,a=e.substr(0,t);t!=e.length;t+=3)a+=(a.length>0?",":"")+e.substr(t,3);return a}var eO=/%/g;function tO(e,t){var a,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+tO(e,-t);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%r;if(i<0&&(i+=r),-1===(a=(t/Math.pow(10,i)).toPrecision(n+1+(r+i)%r)).indexOf("e")){var o=Math.floor(Math.log(t)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,r)+"."+a.substr(2+r)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,a,n){return t+a+n.substr(0,(r+i)%r)+"."+n.substr(i)+"E"})}else a=t.toExponential(n);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var aO=/# (\?+)( ?)\/( ?)(\d+)/;var nO=/^#*0*\.([0#]+)/,rO=/\).*[0#]/,iO=/\(###\) ###\\?-####/;function oO(e){for(var t,a="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function sO(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a}function lO(e,t){var a=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(a*n)).length?0:Math.round(a*n)}function cO(e,t,a){if(40===e.charCodeAt(0)&&!t.match(rO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?cO("n",n,a):"("+cO("n",n,-a)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,a){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return hO(e,t.substr(0,n),a/Math.pow(10,3*(t.length-n)))}(e,t,a);if(-1!==t.indexOf("%"))return function(e,t,a){var n=t.replace(eO,""),r=t.length-n.length;return hO(e,n,a*Math.pow(10,2*r))+qO("%",r)}(e,t,a);if(-1!==t.indexOf("E"))return tO(t,a);if(36===t.charCodeAt(0))return"$"+cO(e,t.substr(" "==t.charAt(1)?2:1),a);var r,i,o,s,l=Math.abs(a),c=a<0?"-":"";if(t.match(/^00+$/))return c+ON(l,t.length);if(t.match(/^[#?]+$/))return"0"===(r=ON(a,0))&&(r=""),r.length>t.length?r:oO(t.substr(0,t.length-r.length))+r;if(i=t.match(aO))return function(e,t,a){var n=parseInt(e[4],10),r=Math.round(t*n),i=Math.floor(r/n),o=r-i*n,s=n;return a+(0===i?"":""+i)+" "+(0===o?qO(" ",e[1].length+1+e[4].length):PN(o,e[1].length)+e[2]+"/"+e[3]+DN(s,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+ON(l,t.length-t.indexOf("0"));if(i=t.match(nO))return r=sO(a,i[1].length).replace(/^([^\.]+)$/,"$1."+oO(i[1])).replace(/\.$/,"."+oO(i[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+qO("0",oO(i[1]).length-t.length)}),-1!==t.indexOf("0.")?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+sO(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+QN(ON(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+cO(e,t,-a):QN(""+(Math.floor(a)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(a,i[1].length)))+"."+DN(lO(a,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return cO(e,t.replace(/^#,#*,/,""),a);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=RN(cO(e,t.replace(/[\\-]/g,""),a)),o=0,RN(RN(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return o<r.length?r.charAt(o++):"0"===e?"0":""}));if(t.match(iO))return"("+(r=cO(e,"##########",a)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=GN(l,Math.pow(10,o)-1,!1),r=""+c," "==(u=hO("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),r+=u+i[2]+"/"+i[3],(u=LN(s[2],o)).length<i[4].length&&(u=oO(i[4].substr(i[4].length-u.length))+u),r+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c+((s=GN(l,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?PN(s[1],o)+i[2]+"/"+i[3]+LN(s[2],o):qO(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return r=ON(a,0),t.length<=r.length?r:oO(t.substr(0,t.length-r.length))+r;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+a.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var d=t.indexOf(".")-o,h=t.length-r.length-d;return oO(t.substr(0,d)+r+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=lO(a,i[1].length),a<0?"-"+cO(e,t,-a):QN(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?DN(0,3-e.length):"")+e})+"."+DN(o,i[1].length);switch(t){case"###,##0.00":return cO(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var p=QN(ON(l,0));return"0"!==p?c+p:"";case"###,###.00":return cO(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return cO(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function uO(e,t){var a,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+uO(e,-t);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%r;if(i<0&&(i+=r),!(a=(t/Math.pow(10,i)).toPrecision(n+1+(r+i)%r)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,a,n){return t+a+n.substr(0,(r+i)%r)+"."+n.substr(i)+"E"})}else a=t.toExponential(n);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function dO(e,t,a){if(40===e.charCodeAt(0)&&!t.match(rO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?dO("n",n,a):"("+dO("n",n,-a)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,a){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return hO(e,t.substr(0,n),a/Math.pow(10,3*(t.length-n)))}(e,t,a);if(-1!==t.indexOf("%"))return function(e,t,a){var n=t.replace(eO,""),r=t.length-n.length;return hO(e,n,a*Math.pow(10,2*r))+qO("%",r)}(e,t,a);if(-1!==t.indexOf("E"))return uO(t,a);if(36===t.charCodeAt(0))return"$"+dO(e,t.substr(" "==t.charAt(1)?2:1),a);var r,i,o,s,l=Math.abs(a),c=a<0?"-":"";if(t.match(/^00+$/))return c+DN(l,t.length);if(t.match(/^[#?]+$/))return r=""+a,0===a&&(r=""),r.length>t.length?r:oO(t.substr(0,t.length-r.length))+r;if(i=t.match(aO))return function(e,t,a){return a+(0===t?"":""+t)+qO(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+DN(l,t.length-t.indexOf("0"));if(i=t.match(nO))return r=(r=(""+a).replace(/^([^\.]+)$/,"$1."+oO(i[1])).replace(/\.$/,"."+oO(i[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+qO("0",oO(i[1]).length-t.length)}),-1!==t.indexOf("0.")?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+QN(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+dO(e,t,-a):QN(""+a)+"."+qO("0",i[1].length);if(i=t.match(/^#,#*,#0/))return dO(e,t.replace(/^#,#*,/,""),a);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=RN(dO(e,t.replace(/[\\-]/g,""),a)),o=0,RN(RN(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return o<r.length?r.charAt(o++):"0"===e?"0":""}));if(t.match(iO))return"("+(r=dO(e,"##########",a)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),s=GN(l,Math.pow(10,o)-1,!1),r=""+c," "==(u=hO("n",i[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),r+=u+i[2]+"/"+i[3],(u=LN(s[2],o)).length<i[4].length&&(u=oO(i[4].substr(i[4].length-u.length))+u),r+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c+((s=GN(l,Math.pow(10,o)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?PN(s[1],o)+i[2]+"/"+i[3]+LN(s[2],o):qO(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return r=""+a,t.length<=r.length?r:oO(t.substr(0,t.length-r.length))+r;if(i=t.match(/^([#0]+)\.([#0]+)$/)){r=""+a.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=r.indexOf(".");var d=t.indexOf(".")-o,h=t.length-r.length-d;return oO(t.substr(0,d)+r+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return a<0?"-"+dO(e,t,-a):QN(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?DN(0,3-e.length):"")+e})+"."+DN(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=QN(""+l);return"0"!==p?c+p:"";default:if(t.match(/\.[0#?]*$/))return dO(e,t.slice(0,t.lastIndexOf(".")),a)+oO(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function hO(e,t,a){return(0|a)===a?dO(e,t,a):cO(e,t,a)}var pO=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fO(e){for(var t=0,a="",n="";t<e.length;)switch(a=e.charAt(t)){case"G":FN(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=a;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(pO))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++t))>-1||"\\"==a&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===a;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var mO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vO(e,t){if(null==t)return!1;var a=parseFloat(t[2]);switch(t[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0}return!1}function gO(e,t){var a=function(e){for(var t=[],a=!1,n=0,r=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:a=!a;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(r,n-r),r=n+1}if(t[t.length]=e.substr(r),!0===a)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=a.length,r=a[n-1].indexOf("@");if(n<4&&r>-1&&--n,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if("number"!=typeof t)return[4,4===a.length||r>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=r>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=r>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=r>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"]}var i=t>0?a[0]:t<0?a[1]:a[2];if(-1===a[0].indexOf("[")&&-1===a[1].indexOf("["))return[n,i];if(null!=a[0].match(/\[[=<>]/)||null!=a[1].match(/\[[=<>]/)){var o=a[0].match(mO),s=a[1].match(mO);return vO(t,o)?[n,a[0]]:vO(t,s)?[n,a[1]]:[n,a[null!=o&&null!=s?2:1]]}return[n,i]}function yO(e,t,a){null==a&&(a={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&a.dateNF?a.dateNF:e;break;case"number":null==(n=14==e&&a.dateNF?a.dateNF:(null!=a.table?a.table:zN)[e])&&(n=a.table&&a.table[VN[e]]||zN[VN[e]]),null==n&&(n=HN[e]||"General")}if(FN(n,0))return ZN(t,a);t instanceof Date&&(t=XN(t,a.date1904));var r=gO(n,t);if(FN(r[1]))return ZN(t,a);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,a,n){for(var r,i,o,s=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!FN(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(o=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(o);s[s.length]={t:"t",v:l},++c;break;case"\\":var p=e.charAt(++c),f="("===p||")"===p?p:"t";s[s.length]={t:f,v:p},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==r&&null==(r=WN(t,a,"2"===e.charAt(c+1))))return"";s[s.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==r&&null==(r=WN(t,a)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),s[s.length]={t:u,v:l},d=u;break;case"A":case"a":case"上":var m={t:u,v:u};if(null==r&&(r=WN(t,a)),"A/P"===e.substr(c,3).toUpperCase()?(null!=r&&(m.v=r.H>=12?"P":"A"),m.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=r&&(m.v=r.H>=12?"PM":"AM"),m.t="T",c+=5,h="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=r&&(m.v=r.H>=12?"下午":"上午"),m.t="T",c+=5,h="h"):(m.t="t",++c),null==r&&"T"===m.t)return"";s[s.length]=m,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(pO)){if(null==r&&null==(r=WN(t,a)))return"";s[s.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",fO(e)||(s[s.length]={t:"t",v:l}));break;case".":if(null!=r){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":s[s.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c}var v,g=0,y=0;for(c=s.length-1,d="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=h,d="h",g<1&&(g=1);break;case"s":(v=s[c].v.match(/\.0+$/))&&(y=Math.max(y,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":d=s[c].t;break;case"m":"s"===d&&(s[c].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[c].v.match(/[Hh]/)&&(g=1),g<2&&s[c].v.match(/[Mm]/)&&(g=2),g<3&&s[c].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var b,x="";for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=JN(s[c].t.charCodeAt(0),s[c].v,r,y),s[c].t="t";break;case"n":case"?":for(b=c+1;null!=s[b]&&("?"===(u=s[b].t)||"D"===u||(" "===u||"t"===u)&&null!=s[b+1]&&("?"===s[b+1].t||"t"===s[b+1].t&&"/"===s[b+1].v)||"("===s[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===s[b].v||" "===s[b].v&&null!=s[b+1]&&"?"==s[b+1].t));)s[c].v+=s[b].v,s[b]={v:"",t:";"},++b;x+=s[c].v,c=b-1;break;case"G":s[c].t="t",s[c].v=ZN(t,a)}var w,_,S="";if(x.length>0){40==x.charCodeAt(0)?(w=t<0&&45===x.charCodeAt(0)?-t:t,_=hO("n",x,w)):(_=hO("n",x,w=t<0&&n>1?-t:t),w<0&&s[0]&&"t"==s[0].t&&(_=_.substr(1),s[0].v="-"+s[0].v)),b=_.length-1;var M=s.length;for(c=0;c<s.length;++c)if(null!=s[c]&&"t"!=s[c].t&&s[c].v.indexOf(".")>-1){M=c;break}var T=s.length;if(M===s.length&&-1===_.indexOf("E")){for(c=s.length-1;c>=0;--c)null!=s[c]&&-1!=="n?".indexOf(s[c].t)&&(b>=s[c].v.length-1?(b-=s[c].v.length,s[c].v=_.substr(b+1,s[c].v.length)):b<0?s[c].v="":(s[c].v=_.substr(0,b+1),b=-1),s[c].t="t",T=c);b>=0&&T<s.length&&(s[T].v=_.substr(0,b+1)+s[T].v)}else if(M!==s.length&&-1===_.indexOf("E")){for(b=_.indexOf(".")-1,c=M;c>=0;--c)if(null!=s[c]&&-1!=="n?".indexOf(s[c].t)){for(i=s[c].v.indexOf(".")>-1&&c===M?s[c].v.indexOf(".")-1:s[c].v.length-1,S=s[c].v.substr(i+1);i>=0;--i)b>=0&&("0"===s[c].v.charAt(i)||"#"===s[c].v.charAt(i))&&(S=_.charAt(b--)+S);s[c].v=S,s[c].t="t",T=c}for(b>=0&&T<s.length&&(s[T].v=_.substr(0,b+1)+s[T].v),b=_.indexOf(".")+1,c=M;c<s.length;++c)if(null!=s[c]&&(-1!=="n?(".indexOf(s[c].t)||c===M)){for(i=s[c].v.indexOf(".")>-1&&c===M?s[c].v.indexOf(".")+1:0,S=s[c].v.substr(0,i);i<s[c].v.length;++i)b<_.length&&(S+=_.charAt(b++));s[c].v=S,s[c].t="t",T=c}}}for(c=0;c<s.length;++c)null!=s[c]&&"n?".indexOf(s[c].t)>-1&&(w=n>1&&t<0&&c>0&&"-"===s[c-1].v?-t:t,s[c].v=hO(s[c].t,s[c].v,w),s[c].t="t");var k="";for(c=0;c!==s.length;++c)null!=s[c]&&(k+=s[c].v);return k}(r[1],t,a,r[0])}function bO(e,t){if("number"!=typeof t){t=+t||-1;for(var a=0;a<392;++a)if(null!=zN[a]){if(zN[a]==e){t=a;break}}else t<0&&(t=a);t<0&&(t=391)}return zN[t]=e,t}function xO(e){for(var t=0;392!=t;++t)void 0!==e[t]&&bO(e[t],t)}function wO(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',zN=e}var _O={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},SO=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var MO=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),a=0;256!=a;++a)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=a)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[a]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();var a=function(e){var t=0,a=0,n=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)r[n]=e[n];for(n=0;256!=n;++n)for(a=e[n],t=256+n;t<4096;t+=256)a=r[t]=a>>>8^e[255&a];var i=[];for(n=1;16!=n;++n)i[n-1]="undefined"!=typeof Int32Array?r.subarray(256*n,256*n+256):r.slice(256*n,256*n+256);return i}(t),n=a[0],r=a[1],i=a[2],o=a[3],s=a[4],l=a[5],c=a[6],u=a[7],d=a[8],h=a[9],p=a[10],f=a[11],m=a[12],v=a[13],g=a[14];return e.table=t,e.bstr=function(e,a){for(var n=-1^a,r=0,i=e.length;r<i;)n=n>>>8^t[255&(n^e.charCodeAt(r++))];return~n},e.buf=function(e,a){for(var y=-1^a,b=e.length-15,x=0;x<b;)y=g[e[x++]^255&y]^v[e[x++]^y>>8&255]^m[e[x++]^y>>16&255]^f[e[x++]^y>>>24]^p[e[x++]]^h[e[x++]]^d[e[x++]]^u[e[x++]]^c[e[x++]]^l[e[x++]]^s[e[x++]]^o[e[x++]]^i[e[x++]]^r[e[x++]]^n[e[x++]]^t[e[x++]];for(b+=15;x<b;)y=y>>>8^t[255&(y^e[x++])];return~y},e.str=function(e,a){for(var n=-1^a,r=0,i=e.length,o=0,s=0;r<i;)(o=e.charCodeAt(r++))<128?n=n>>>8^t[255&(n^o)]:o<2048?n=(n=n>>>8^t[255&(n^(192|o>>6&31))])>>>8^t[255&(n^(128|63&o))]:o>=55296&&o<57344?(o=64+(1023&o),s=1023&e.charCodeAt(r++),n=(n=(n=(n=n>>>8^t[255&(n^(240|o>>8&7))])>>>8^t[255&(n^(128|o>>2&63))])>>>8^t[255&(n^(128|s>>6&15|(3&o)<<4))])>>>8^t[255&(n^(128|63&s))]):n=(n=(n=n>>>8^t[255&(n^(224|o>>12&15))])>>>8^t[255&(n^(128|o>>6&63))])>>>8^t[255&(n^(128|63&o))];return~n},e}(),TO=function(){var e,t={};function a(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function r(e,t){"string"==typeof t&&(t=new Date(t));var a=t.getHours();a=(a=a<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,a);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function i(e){qB(e,0);for(var t={},a=0;e.l<=e.length-4;){var n=e.read_shift(2),r=e.read_shift(2),i=e.l+r,o={};if(21589===n)1&(a=e.read_shift(1))&&(o.mtime=e.read_shift(4)),r>5&&(2&a&&(o.atime=e.read_shift(4)),4&a&&(o.ctime=e.read_shift(4))),o.mtime&&(o.mt=new Date(1e3*o.mtime));e.l=i,t[n]=o}return t}function o(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=_(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var a=t&&t.root||"",n=(xN&&Buffer.isBuffer(e)?e.toString("binary"):_(e)).split("\r\n"),r=0,i="";for(r=0;r<n.length;++r)if(i=n[r],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),a||(a=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,a.length)!=a))for(;a.length>0&&(a=(a=a.slice(0,a.length-1)).slice(0,a.lastIndexOf("/")+1),i.slice(0,a.length)!=a););var o=(n[1]||"").match(/boundary="(.*?)"/);if(!o)throw new Error("MAD cannot find boundary");var s="--"+(o[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,p=0;for(r=0;r<n.length;++r){var f=n[r];f!==s&&f!==s+"--"||(p++&&ce(u,n.slice(d,r),a),d=r)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var a,n,r,i,o,s,p=512,f=[],m=e.slice(0,512);qB(m,0);var v=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(a=v[0]){case 3:p=512;break;case 4:p=4096;break;case 0:if(0==v[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+a)}512!==p&&qB(m=e.slice(0,p),28);var b=e.slice(0,p);!function(e,t){var a=9;switch(e.l+=2,a=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+a);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+a);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+a)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,a);var x=m.read_shift(4,"i");if(3===a&&0!==x)throw new Error("# Directory Sectors: Expected 0 saw "+x);m.l+=4,i=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),o=m.read_shift(4,"i"),n=m.read_shift(4,"i"),s=m.read_shift(4,"i"),r=m.read_shift(4,"i");for(var w=-1,S=0;S<109&&!((w=m.read_shift(4,"i"))<0);++S)f[S]=w;var M=function(e,t){for(var a=Math.ceil(e.length/t)-1,n=[],r=1;r<a;++r)n[r-1]=e.slice(r*t,(r+1)*t);return n[a-1]=e.slice(a*t),n}(e,p);c(s,r,M,p,f);var T=function(e,t,a,n){var r=e.length,i=[],o=[],s=[],l=[],c=n-1,u=0,d=0,h=0,p=0;for(u=0;u<r;++u)if(s=[],(h=u+t)>=r&&(h-=r),!o[h]){l=[];var f=[];for(d=h;d>=0;){f[d]=!0,o[d]=!0,s[s.length]=d,l.push(e[d]);var m=a[Math.floor(4*d/n)];if(n<4+(p=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+n);if(!e[m])break;if(f[d=FB(e[m],p)])break}i[h]={nodes:s,data:pB([l])}}return i}(M,i,f,p);T[i].name="!Directory",n>0&&o!==g&&(T[o].name="!MiniFAT"),T[f[0]].name="!FAT",T.fat_addrs=f,T.ssz=p;var k=[],C=[],A=[];!function(e,t,a,n,r,i,o,s){for(var c,h=0,p=n.length?2:0,f=t[e].data,m=0,v=0;m<f.length;m+=128){var y=f.slice(m,m+128);qB(y,64),v=y.read_shift(2),c=mB(y,0,v-p),n.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=g,b.name=""),5===b.type?(h=b.start,r>0&&h!==g&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(a,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==g&&b.start!==g&&t[h]&&(b.content=l(b,t[h].data,(t[s]||{}).data))),b.content&&qB(b.content,0),i[c]=b,o.push(b)}}(i,T,M,k,n,{},C,o),function(e,t,a){for(var n=0,r=0,i=0,o=0,s=0,l=a.length,c=[],u=[];n<l;++n)c[n]=u[n]=n,t[n]=a[n];for(;s<u.length;++s)r=e[n=u[s]].L,i=e[n].R,o=e[n].C,c[n]===n&&(-1!==r&&c[r]!==r&&(c[n]=c[r]),-1!==i&&c[i]!==i&&(c[n]=c[i])),-1!==o&&(c[o]=n),-1!==r&&n!=c[n]&&(c[r]=c[n],u.lastIndexOf(r)<s&&u.push(r)),-1!==i&&n!=c[n]&&(c[i]=c[n],u.lastIndexOf(i)<s&&u.push(i));for(n=1;n<l;++n)c[n]===n&&(-1!==i&&c[i]!==i?c[n]=c[i]:-1!==r&&c[r]!==r&&(c[n]=c[r]));for(n=1;n<l;++n)if(0!==e[n].type){if((s=n)!=c[s])do{s=c[s],t[n]=t[s]+"/"+t[n]}while(0!==s&&-1!==c[s]&&s!=c[s]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(C,A,k),k.shift();var E={FileIndex:C,FullPaths:A};return t&&t.raw&&(E.raw={header:b,sectors:M}),E}function l(e,t,a){for(var n=e.start,r=e.size,i=[],o=n;a&&r>0&&o>=0;)i.push(t.slice(o*v,o*v+v)),r-=v,o=FB(a,4*o);return 0===i.length?jB(0):AN(i).slice(0,e.size)}function c(e,t,a,n,r){var i=g;if(e===g){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var o=a[e],s=(n>>>2)-1;if(!o)return;for(var l=0;l<s&&(i=FB(o,4*l))!==g;++l)r.push(i);c(FB(o,n-4),t-1,a,n,r)}}function u(e,t,a,n,r){var i=[],o=[];r||(r=[]);var s=n-1,l=0,c=0;for(l=t;l>=0;){r[l]=!0,i[i.length]=l,o.push(e[l]);var u=a[Math.floor(4*l/n)];if(n<4+(c=4*l&s))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=FB(e[u],c)}return{nodes:i,data:pB([o])}}function d(e,t){return new Date(1e3*(OB(e,t+4)/1e7*Math.pow(2,32)+OB(e,t)/1e7-11644473600))}function h(e,t){var a=t||{},n=a.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),a.CLSID&&(e.FileIndex[0].clsid=a.CLSID),function(e){var t="Sh33tJ5";if(TO.find(e,"/"+t))return;var a=jB(4);a[0]=55,a[1]=a[3]=50,a[2]=54,e.FileIndex.push({name:t,type:2,content:a,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),p(e)}(e)}function p(e,t){h(e);for(var r=!1,i=!1,o=e.FullPaths.length-1;o>=0;--o){var s=e.FileIndex[o];switch(s.type){case 0:i?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(s.R*s.L*s.C)&&(r=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(r=!0);break;default:r=!0}}if(r||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(o=0;o<e.FullPaths.length;++o)u[e.FullPaths[o]]=!0,0!==e.FileIndex[o].type&&d.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<d.length;++o){var p=a(d[o][0]);(i=u[p])||(d.push([p,{name:n(p).replace("/",""),type:1,clsid:x,ct:l,mt:l,content:null}]),u[p]=!0)}for(d.sort(function(e,t){return function(e,t){for(var a=e.split("/"),n=t.split("/"),r=0,i=0,o=Math.min(a.length,n.length);r<o;++r){if(i=a[r].length-n[r].length)return i;if(a[r]!=n[r])return a[r]<n[r]?-1:1}return a.length-n.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],o=0;o<d.length;++o)e.FullPaths[o]=d[o][0],e.FileIndex[o]=d[o][1];for(o=0;o<d.length;++o){var f=e.FileIndex[o],m=e.FullPaths[o];if(f.name=n(m).replace("/",""),f.L=f.R=f.C=-(f.color=1),f.size=f.content?f.content.length:0,f.start=0,f.clsid=f.clsid||x,0===o)f.C=d.length>1?1:-1,f.size=0,f.type=5;else if("/"==m.slice(-1)){for(c=o+1;c<d.length&&a(e.FullPaths[c])!=m;++c);for(f.C=c>=d.length?-1:c,c=o+1;c<d.length&&a(e.FullPaths[c])!=a(m);++c);f.R=c>=d.length?-1:c,f.type=1}else a(e.FullPaths[o+1]||"")==a(m)&&(f.R=o+1),f.type=2}}}function f(e,t){var a=t||{};if("mad"==a.fileType)return function(e,t){for(var a=t||{},n=a.boundary||"SheetJS",r=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],i=e.FullPaths[0],o=i,s=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(o=e.FullPaths[l].slice(i.length),(s=e.FileIndex[l]).size&&s.content&&"Sh33tJ5"!=o){o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=s.content,u=xN&&Buffer.isBuffer(c)?c.toString("binary"):_(c),d=0,h=Math.min(1024,u.length),p=0,f=0;f<=h;++f)(p=u.charCodeAt(f))>=32&&p<128&&++d;var m=d>=4*h/5;r.push(n),r.push("Content-Location: "+(a.root||"file:///C:/SheetJS/")+o),r.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),r.push("Content-Type: "+oe(s,o)),r.push(""),r.push(m?le(u):se(u))}return r.push(n+"--\r\n"),r.join("\r\n")}(e,a);if(p(e),"zip"===a.fileType)return function(e,t){var a=t||{},n=[],i=[],o=jB(1),s=a.compression?8:0,l=0,c=0,u=0,d=0,h=0,p=e.FullPaths[0],f=p,m=e.FileIndex[0],v=[],g=0;for(c=1;c<e.FullPaths.length;++c)if(f=e.FullPaths[c].slice(p.length),(m=e.FileIndex[c]).size&&m.content&&"Sh33tJ5"!=f){var y=d,b=jB(f.length);for(u=0;u<f.length;++u)b.write_shift(1,127&f.charCodeAt(u));b=b.slice(0,b.l),v[h]=MO.buf(m.content,0);var x=m.content;8==s&&(x=S(x)),(o=jB(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,l),o.write_shift(2,s),m.mt?r(o,m.mt):o.write_shift(4,0),o.write_shift(-4,v[h]),o.write_shift(4,x.length),o.write_shift(4,m.content.length),o.write_shift(2,b.length),o.write_shift(2,0),d+=o.length,n.push(o),d+=b.length,n.push(b),d+=x.length,n.push(x),(o=jB(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,l),o.write_shift(2,s),o.write_shift(4,0),o.write_shift(-4,v[h]),o.write_shift(4,x.length),o.write_shift(4,m.content.length),o.write_shift(2,b.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,y),g+=o.l,i.push(o),g+=b.length,i.push(b),++h}return o=jB(22),o.write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,h),o.write_shift(2,h),o.write_shift(4,g),o.write_shift(4,d),o.write_shift(2,0),AN([AN(n),AN(i),o])}(e,a);var n=function(e){for(var t=0,a=0,n=0;n<e.FileIndex.length;++n){var r=e.FileIndex[n];if(r.content){var i=r.content.length;i>0&&(i<4096?t+=i+63>>6:a+=i+511>>9)}}for(var o=e.FullPaths.length+3>>2,s=t+127>>7,l=(t+7>>3)+a+o+s,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,s,o,a,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),i=jB(n[7]<<9),o=0,s=0;for(o=0;o<8;++o)i.write_shift(1,b[o]);for(o=0;o<8;++o)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),o=0;o<3;++o)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,n[2]),i.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:g),i.write_shift(4,n[3]),i.write_shift(-4,n[1]?n[0]-1:g),i.write_shift(4,n[1]),o=0;o<109;++o)i.write_shift(-4,o<n[2]?n[1]+o:-1);if(n[1])for(s=0;s<n[1];++s){for(;o<236+127*s;++o)i.write_shift(-4,o<n[2]?n[1]+o:-1);i.write_shift(-4,s===n[1]-1?g:s+1)}var l=function(e){for(s+=e;o<s-1;++o)i.write_shift(-4,o+1);e&&(++o,i.write_shift(-4,g))};for(s=o=0,s+=n[1];o<s;++o)i.write_shift(-4,w.DIFSECT);for(s+=n[2];o<s;++o)i.write_shift(-4,w.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=s,l(u+511>>9)));for(l(n[6]+7>>3);511&i.l;)i.write_shift(-4,w.ENDOFCHAIN);for(s=o=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=s,l(u+63>>6)));for(;511&i.l;)i.write_shift(-4,w.ENDOFCHAIN);for(o=0;o<n[4]<<2;++o){var h=e.FullPaths[o];if(h&&0!==h.length){d=e.FileIndex[o],0===o&&(d.start=d.size?d.start-1:g);var f=0===o&&a.root||d.name;if(u=2*(f.length+1),i.write_shift(64,f,"utf16le"),i.write_shift(2,u),i.write_shift(1,d.type),i.write_shift(1,d.color),i.write_shift(-4,d.L),i.write_shift(-4,d.R),i.write_shift(-4,d.C),d.clsid)i.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,d.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,d.start),i.write_shift(4,d.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(o=1;o<e.FileIndex.length;++o)if((d=e.FileIndex[o]).size>=4096)if(i.l=d.start+1<<9,xN&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)i.write_shift(1,d.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(o=1;o<e.FileIndex.length;++o)if((d=e.FileIndex[o]).size>0&&d.size<4096)if(xN&&Buffer.isBuffer(d.content))d.content.copy(i,i.l,0,d.size),i.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)i.write_shift(1,d.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(xN)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var m,v=64,g=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],x="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:g,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:x,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(e){for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function S(e){return m?m.deflateRawSync(e):X(e)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function C(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!=typeof Uint8Array,E=A?new Uint8Array(256):[],I=0;I<256;++I)E[I]=C(I);function R(e,t){var a=E[255&e];return t<=8?a>>>8-t:(a=a<<8|E[e>>8&255],t<=16?a>>>16-t:(a=a<<8|E[e>>16&255])>>>24-t)}function D(e,t){var a=7&t,n=t>>>3;return(e[n]|(a<=6?0:e[n+1]<<8))>>>a&3}function P(e,t){var a=7&t,n=t>>>3;return(e[n]|(a<=5?0:e[n+1]<<8))>>>a&7}function L(e,t){var a=7&t,n=t>>>3;return(e[n]|(a<=3?0:e[n+1]<<8))>>>a&31}function N(e,t){var a=7&t,n=t>>>3;return(e[n]|(a<=1?0:e[n+1]<<8))>>>a&127}function O(e,t,a){var n=7&t,r=t>>>3,i=(1<<a)-1,o=e[r]>>>n;return a<8-n?o&i:(o|=e[r+1]<<8-n,a<16-n?o&i:(o|=e[r+2]<<16-n,a<24-n?o&i:(o|=e[r+3]<<24-n)&i))}function F(e,t,a){var n=7&t,r=t>>>3;return n<=5?e[r]|=(7&a)<<n:(e[r]|=a<<n&255,e[r+1]=(7&a)>>8-n),t+3}function B(e,t,a){return a=(1&a)<<(7&t),e[t>>>3]|=a,t+1}function U(e,t,a){var n=t>>>3;return a<<=7&t,e[n]|=255&a,a>>>=8,e[n+1]=a,t+8}function z(e,t,a){var n=t>>>3;return a<<=7&t,e[n]|=255&a,a>>>=8,e[n+1]=255&a,e[n+2]=a>>>8,t+16}function V(e,t){var a=e.length,n=2*a>t?2*a:t+5,r=0;if(a>=t)return e;if(xN){var i=SN(n);if(e.copy)e.copy(i);else for(;r<e.length;++r)i[r]=e[r];return i}if(A){var o=new Uint8Array(n);if(o.set)o.set(e);else for(;r<a;++r)o[r]=e[r];return o}return e.length=n,e}function H(e){for(var t=new Array(e),a=0;a<e;++a)t[a]=0;return t}function G(e,t,a){var n=1,r=0,i=0,o=0,s=0,l=e.length,c=A?new Uint16Array(32):H(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<a;++i)e[i]=0;l=e.length;var u=A?new Uint16Array(l):H(l);for(i=0;i<l;++i)c[r=e[i]]++,n<r&&(n=r),u[i]=0;for(c[0]=0,i=1;i<=n;++i)c[i+16]=s=s+c[i-1]<<1;for(i=0;i<l;++i)0!=(s=e[i])&&(u[i]=c[s+16]++);var d=0;for(i=0;i<l;++i)if(0!=(d=e[i]))for(s=R(u[i],n)>>n-d,o=(1<<n+4-d)-1;o>=0;--o)t[s|o<<d]=15&d|i<<4;return n}var W=A?new Uint16Array(512):H(512),q=A?new Uint16Array(32):H(32);if(!A){for(var Y=0;Y<512;++Y)W[Y]=0;for(Y=0;Y<32;++Y)q[Y]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);G(e,q,32);var a=[];for(t=0;t<=143;t++)a.push(8);for(;t<=255;t++)a.push(9);for(;t<=279;t++)a.push(7);for(;t<=287;t++)a.push(8);G(a,W,288)}();var j=function(){for(var e=A?new Uint8Array(32768):[],t=0,a=0;t<k.length-1;++t)for(;a<k[t+1];++a)e[a]=t;for(;a<32768;++a)e[a]=29;var n=A?new Uint8Array(259):[];for(t=0,a=0;t<T.length-1;++t)for(;a<T[t+1];++a)n[a]=t;return function(t,a){return t.length<8?function(e,t){for(var a=0;a<e.length;){var n=Math.min(65535,e.length-a),r=a+n==e.length;for(t.write_shift(1,+r),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[a++]}return t.l}(t,a):function(t,a){for(var r=0,i=0,o=A?new Uint16Array(32768):[];i<t.length;){var s=Math.min(65535,t.length-i);if(s<10){for(7&(r=F(a,r,+!(i+s!=t.length)))&&(r+=8-(7&r)),a.l=r/8|0,a.write_shift(2,s),a.write_shift(2,65535&~s);s-- >0;)a[a.l++]=t[i++];r=8*a.l}else{r=F(a,r,+!(i+s!=t.length)+2);for(var l=0;s-- >0;){var c=t[i],u=-1,d=0;if((u=o[l=32767&(l<<5^c)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+d]==t[i+d]&&d<250;)++d;if(d>2){(c=n[d])<=22?r=U(a,r,E[c+1]>>1)-1:(U(a,r,3),U(a,r+=5,E[c-23]>>5),r+=3);var h=c<8?0:c-4>>2;h>0&&(z(a,r,d-T[c]),r+=h),c=e[i-u],r=U(a,r,E[c]>>3),r-=3;var p=c<4?0:c-2>>1;p>0&&(z(a,r,i-u-k[c]),r+=p);for(var f=0;f<d;++f)o[l]=32767&i,l=32767&(l<<5^t[i]),++i;s-=d-1}else c<=143?c+=48:r=B(a,r,1),r=U(a,r,E[c]),o[l]=32767&i,++i}r=U(a,r,0)-1}}return a.l=(r+7)/8|0,a.l}(t,a)}}();function X(e){var t=jB(50+Math.floor(1.1*e.length)),a=j(e,t);return t.slice(0,a)}var $=A?new Uint16Array(32768):H(32768),K=A?new Uint16Array(32768):H(32768),Z=A?new Uint16Array(128):H(128),J=1,Q=1;function ee(e,t){var a=L(e,t)+257,n=L(e,t+=5)+1,r=function(e,t){var a=7&t,n=t>>>3;return(e[n]|(a<=4?0:e[n+1]<<8))>>>a&15}(e,t+=5)+4;t+=4;for(var i=0,o=A?new Uint8Array(19):H(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):H(8),u=A?new Uint8Array(8):H(8),d=o.length,h=0;h<r;++h)o[M[h]]=i=P(e,t),l<i&&(l=i),c[i]++,t+=3;var p=0;for(c[0]=0,h=1;h<=l;++h)u[h]=p=p+c[h-1]<<1;for(h=0;h<d;++h)0!=(p=o[h])&&(s[h]=u[p]++);var f=0;for(h=0;h<d;++h)if(0!=(f=o[h])){p=E[s[h]]>>8-f;for(var m=(1<<7-f)-1;m>=0;--m)Z[p|m<<f]=7&f|h<<3}var v=[];for(l=1;v.length<a+n;)switch(t+=7&(p=Z[N(e,t)]),p>>>=3){case 16:for(i=3+D(e,t),t+=2,p=v[v.length-1];i-- >0;)v.push(p);break;case 17:for(i=3+P(e,t),t+=3;i-- >0;)v.push(0);break;case 18:for(i=11+N(e,t),t+=7;i-- >0;)v.push(0);break;default:v.push(p),l<p&&(l=p)}var g=v.slice(0,a),y=v.slice(a);for(h=a;h<286;++h)g[h]=0;for(h=n;h<30;++h)y[h]=0;return J=G(g,$,286),Q=G(y,K,30),t}function te(e,t){var a=function(e,t){if(3==e[0]&&!(3&e[1]))return[_N(t),2];for(var a=0,n=0,r=SN(t||1<<18),i=0,o=r.length>>>0,s=0,l=0;!(1&n);)if(n=P(e,a),a+=3,n>>>1!=0)for(n>>1==1?(s=9,l=5):(a=ee(e,a),s=J,l=Q);;){!t&&o<i+32767&&(o=(r=V(r,i+32767)).length);var c=O(e,a,s),u=n>>>1==1?W[c]:$[c];if(a+=15&u,(u>>>=4)>>>8&255){if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=i+T[u];d>0&&(h+=O(e,a,d),a+=d),c=O(e,a,l),a+=15&(u=n>>>1==1?q[c]:K[c]);var p=(u>>>=4)<4?0:u-2>>1,f=k[u];for(p>0&&(f+=O(e,a,p),a+=p),!t&&o<h&&(o=(r=V(r,h+100)).length);i<h;)r[i]=r[i-f],++i}else r[i++]=u}else{7&a&&(a+=8-(7&a));var m=e[a>>>3]|e[(a>>>3)+1]<<8;if(a+=32,m>0)for(!t&&o<i+m&&(o=(r=V(r,i+m)).length);m-- >0;)r[i++]=e[a>>>3],a+=8}return t?[r,a+7>>>3]:[r.slice(0,i),a+7>>>3]}(e.slice(e.l||0),t);return e.l+=a[1],a[0]}function ae(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function ne(e,t){var a=e;qB(a,0);var n={FileIndex:[],FullPaths:[]};h(n,{root:t.root});for(var r=a.length-4;(80!=a[r]||75!=a[r+1]||5!=a[r+2]||6!=a[r+3])&&r>=0;)--r;a.l=r+4,a.l+=4;var o=a.read_shift(2);a.l+=6;var s=a.read_shift(4);for(a.l=s,r=0;r<o;++r){a.l+=20;var l=a.read_shift(4),c=a.read_shift(4),u=a.read_shift(2),d=a.read_shift(2),p=a.read_shift(2);a.l+=8;var f=a.read_shift(4),m=i(a.slice(a.l+u,a.l+u+d));a.l+=u+d+p;var v=a.l;a.l=f+4,re(a,l,c,n,m),a.l=v}return n}function re(e,t,a,n,r){e.l+=2;var o=e.read_shift(2),s=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),a=65535&e.read_shift(2),n=new Date,r=31&a,i=15&(a>>>=5);a>>>=4,n.setMilliseconds(0),n.setFullYear(a+1980),n.setMonth(i-1),n.setDate(r);var o=31&t,s=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(s),n.setSeconds(o<<1),n}(e);if(8257&o)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),p="",f=0;f<d;++f)p+=String.fromCharCode(e[e.l++]);if(h){var v=i(e.slice(e.l,e.l+h));(v[21589]||{}).mt&&(l=v[21589].mt),((r||{})[21589]||{}).mt&&(l=r[21589].mt)}e.l+=h;var g=e.slice(e.l,e.l+c);switch(s){case 8:g=function(e,t){if(!m)return te(e,t);var a=new(0,m.InflateRaw),n=a._processChunk(e.slice(e.l),a._finishFlushFlag);return e.l+=a.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var y=!1;8&o&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ae(y,"Bad compressed size: "+t+" != "+c),u!=a&&ae(y,"Bad uncompressed size: "+a+" != "+u),ue(n,p,g,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oe(e,t){if(e.ctype)return e.ctype;var a=e.name||"",n=a.match(/\.([^\.]+)$/);return n&&ie[n[1]]||t&&(n=(a=t).match(/[\.\\]([^\.\\])+$/))&&ie[n[1]]?ie[n[1]]:"application/octet-stream"}function se(e){for(var t=yN(e),a=[],n=0;n<t.length;n+=76)a.push(t.slice(n,n+76));return a.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var a=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),r=0;r<n.length;++r){var i=n[r];if(0!=i.length)for(var o=0;o<i.length;){var s=76,l=i.slice(o,o+s);"="==l.charAt(s-1)?s--:"="==l.charAt(s-2)?s-=2:"="==l.charAt(s-3)&&(s-=3),l=i.slice(o,o+s),(o+=s)<i.length&&(l+="="),a.push(l)}else a.push("")}return a.join("\r\n")}function ce(e,t,a){for(var n,r="",i="",o="",s=0;s<10;++s){var l=t[s];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":r=c[2].trim();break;case"content-type":o=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++s,i.toLowerCase()){case"base64":n=MN(bN(t.slice(s).join("")));break;case"quoted-printable":n=function(e){for(var t=[],a=0;a<e.length;++a){for(var n=e[a];a<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++a];t.push(n)}for(var r=0;r<t.length;++r)t[r]=t[r].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return MN(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,r.slice(a.length),n,{unsafe:!0});o&&(u.ctype=o)}function ue(e,t,a,r){var i=r&&r.unsafe;i||h(e);var o=!i&&TO.find(e,t);if(!o){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),o={name:n(t),type:2},e.FileIndex.push(o),e.FullPaths.push(s),i||TO.utils.cfb_gc(e)}return o.content=a,o.size=a?a.length:0,r&&(r.CLSID&&(o.clsid=r.CLSID),r.mt&&(o.mt=r.mt),r.ct&&(o.ct=r.ct)),o}return t.find=function(e,t){var a=e.FullPaths.map(function(e){return e.toUpperCase()}),n=a.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),r=!1;47===t.charCodeAt(0)?(r=!0,t=a[0].slice(0,-1)+t):r=-1!==t.indexOf("/");var i=t.toUpperCase(),o=!0===r?a.indexOf(i):n.indexOf(i);if(-1!==o)return e.FileIndex[o];var s=!i.match(IN);for(i=i.replace(EN,""),s&&(i=i.replace(IN,"!")),o=0;o<a.length;++o){if((s?a[o].replace(IN,"!"):a[o]).replace(EN,"")==i)return e.FileIndex[o];if((s?n[o].replace(IN,"!"):n[o]).replace(EN,"")==i)return e.FileIndex[o]}return null},t.read=function(t,a){var n=a&&a.type;switch(n||xN&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,a){return o(),s(e.readFileSync(t),a)}(t,a);case"base64":return s(MN(bN(t)),a);case"binary":return s(MN(t),a)}return s(t,a)},t.parse=s,t.write=function(t,a){var n=f(t,a);switch(a&&a.type||"buffer"){case"file":return o(),e.writeFileSync(a.filename,n),n;case"binary":return"string"==typeof n?n:_(n);case"base64":return yN("string"==typeof n?n:_(n));case"buffer":if(xN)return Buffer.isBuffer(n)?n:wN(n);case"array":return"string"==typeof n?MN(n):n}return n},t.writeFile=function(t,a,n){o();var r=f(t,n);e.writeFileSync(a,r)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var a=TO.find(e,t);if(a)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==a)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,a){h(e);var r=TO.find(e,t);if(r)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==r)return e.FileIndex[i].name=n(a),e.FullPaths[i]=a,!0;return!1},cfb_gc:function(e){p(e,!0)},ReadShift:UB,CheckField:WB,prep_blob:qB,bconcat:AN,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(TQe){console.error("cannot use native zlib: "+(TQe.message||TQe))}},_deflateRaw:X,_inflateRaw:te,consts:w},t}();function kO(e){return"string"==typeof e?TN(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function CO(e,t,a){if("undefined"!=typeof Deno){if(a&&"string"==typeof t)switch(a){case"utf8":t=new TextEncoder(a).encode(t);break;case"binary":t=TN(t);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,t)}var n="utf8"==a?RF(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){var r=new Blob([kO(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(r,e);if("undefined"!=typeof saveAs)return saveAs(r,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(r);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=kN(t)),s.write(t),s.close(),t}catch(TQe){if(!TQe.message||!TQe.message.match(/onstruct/))throw TQe}throw new Error("cannot save file "+e)}function AO(e){for(var t=Object.keys(e),a=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&a.push(t[n]);return a}function EO(e,t){for(var a=[],n=AO(e),r=0;r!==n.length;++r)null==a[e[n[r]][t]]&&(a[e[n[r]][t]]=n[r]);return a}function IO(e){for(var t=[],a=AO(e),n=0;n!==a.length;++n)t[e[a[n]]]=a[n];return t}function RO(e){for(var t=[],a=AO(e),n=0;n!==a.length;++n)t[e[a[n]]]=parseInt(a[n],10);return t}var DO=new Date(1899,11,30,0,0,0);function PO(e,t){return(e.getTime()-(DO.getTime()+6e4*(e.getTimezoneOffset()-DO.getTimezoneOffset())))/864e5}var LO=new Date,NO=DO.getTime()+6e4*(LO.getTimezoneOffset()-DO.getTimezoneOffset()),OO=LO.getTimezoneOffset();function FO(e){var t=new Date;return t.setTime(24*e*60*60*1e3+NO),t.getTimezoneOffset()!==OO&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-OO)),t}function BO(e){var t=0,a=0,n=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=r.length;++i)if(r[i]){switch(a=1,i>3&&(n=!0),r[i].slice(r[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[i].slice(r[i].length-1));case"D":a*=24;case"H":a*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");a*=60}t+=a*parseInt(r[i],10)}return t}var UO=new Date("2017-02-19T19:06:09.000Z"),zO=isNaN(UO.getFullYear())?new Date("2/19/17"):UO,VO=2017==zO.getFullYear();function HO(e,t){var a=new Date(e);if(VO)return t>0?a.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3):t<0&&a.setTime(a.getTime()-60*a.getTimezoneOffset()*1e3),a;if(e instanceof Date)return e;if(1917==zO.getFullYear()&&!isNaN(a.getFullYear())){var n=a.getFullYear();return e.indexOf(""+n)>-1||a.setFullYear(a.getFullYear()+100),a}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function GO(e,t){if(xN&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return RF(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return RF(hN(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return RF(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return RF(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return a[e]||e})}catch(TQe){}for(var n=[],r=0;r!=e.length;++r)n.push(String.fromCharCode(e[r]));return n.join("")}function WO(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=WO(e[a]));return t}function qO(e,t){for(var a="";a.length<t;)a+=e;return a}function YO(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var a=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,function(e,t){return a=-a,t}),isNaN(t=Number(n))?t:t/a):t/a}var jO=["january","february","march","april","may","june","july","august","september","october","november","december"];function XO(e){var t=new Date(e),a=new Date(NaN),n=t.getYear(),r=t.getMonth(),i=t.getDate();if(isNaN(i))return a;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==jO.indexOf(o))return a}else if(o.match(/[a-z]/))return a;return n<0||n>8099?a:(r>0||i>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?a:t}var $O=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,a,n){if(e||"string"==typeof a)return t.split(a);for(var r=t.split(a),i=[r[0]],o=1;o<r.length;++o)i.push(n),i.push(r[o]);return i}}();function KO(e){return e?e.content&&e.type?GO(e.content,!0):e.data?fN(e.data):e.asNodeBuffer&&xN?fN(e.asNodeBuffer().toString("binary")):e.asBinary?fN(e.asBinary()):e._data&&e._data.getContent?fN(GO(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ZO(e){if(!e)return null;if(e.data)return dN(e.data);if(e.asNodeBuffer&&xN)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?dN(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function JO(e,t){for(var a=e.FullPaths||AO(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),r=n.replace(/\\/g,"/"),i=0;i<a.length;++i){var o=a[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||r==o)return e.files?e.files[a[i]]:e.FileIndex[i]}return null}function QO(e,t){var a=JO(e,t);if(null==a)throw new Error("Cannot find file "+t+" in zip");return a}function eF(e,t,a){if(!a)return(n=QO(e,t))&&".bin"===n.name.slice(-4)?ZO(n):KO(n);var n;if(!t)return null;try{return eF(e,t)}catch(TQe){return null}}function tF(e,t,a){if(!a)return KO(QO(e,t));if(!t)return null;try{return tF(e,t)}catch(TQe){return null}}function aF(e){for(var t=e.FullPaths||AO(e.files),a=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&a.push(t[n].replace(/^Root Entry[\/]/,""));return a.sort()}function nF(e,t,a){if(e.FullPaths){var n;if("string"==typeof a)return n=xN?wN(a):function(e){for(var t=[],a=0,n=e.length+250,r=_N(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)r[a++]=o;else if(o<2048)r[a++]=192|o>>6&31,r[a++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var s=1023&e.charCodeAt(++i);r[a++]=240|o>>8&7,r[a++]=128|o>>2&63,r[a++]=128|s>>6&15|(3&o)<<4,r[a++]=128|63&s}else r[a++]=224|o>>12&15,r[a++]=128|o>>6&63,r[a++]=128|63&o;a>n&&(t.push(r.slice(0,a)),a=0,r=_N(65535),n=65530)}return t.push(r.slice(0,a)),AN(t)}(a),TO.utils.cfb_add(e,t,n);TO.utils.cfb_add(e,t,a)}else e.file(t,a)}function rF(){return TO.utils.cfb_new()}function iF(e,t){switch(t.type){case"base64":return TO.read(e,{type:"base64"});case"binary":return TO.read(e,{type:"binary"});case"buffer":case"array":return TO.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function oF(e,t){if("/"==e.charAt(0))return e.slice(1);var a=t.split("/");"/"!=t.slice(-1)&&a.pop();for(var n=e.split("/");0!==n.length;){var r=n.shift();".."===r?a.pop():"."!==r&&a.push(r)}return a.join("/")}var sF='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',lF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cF=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,uF=sF.match(cF)?cF:/<[^>]*>/g,dF=/<\w*:/,hF=/<(\/?)\w+:/;function pF(e,t,a){for(var n={},r=0,i=0;r!==e.length&&(32!==(i=e.charCodeAt(r))&&10!==i&&13!==i);++r);if(t||(n[0]=e.slice(0,r)),r===e.length)return n;var o=e.match(lF),s=0,l="",c=0,u="",d="",h=1;if(o)for(c=0;c!=o.length;++c){for(d=o[c],i=0;i!=d.length&&61!==d.charCodeAt(i);++i);for(u=d.slice(0,i).trim();32==d.charCodeAt(i+1);)++i;for(h=34==(r=d.charCodeAt(i+1))||39==r?1:0,l=d.slice(i+1+h,d.length-h),s=0;s!=u.length&&58!==u.charCodeAt(s);++s);if(s===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(5===s&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(s+1);if(n[p]&&"ext"==u.slice(s-3,s))continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function fF(e){return e.replace(hF,"<$1")}var mF={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vF=IO(mF),gF=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function a(n){var r=n+"",i=r.indexOf("<![CDATA[");if(-1==i)return r.replace(e,function(e,t){return mF[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var o=r.indexOf("]]>");return a(r.slice(0,i))+r.slice(i+9,o)+a(r.slice(o+3))}}(),yF=/[&<>'"]/g,bF=/[\u0000-\u0008\u000b-\u001f]/g;function xF(e){return(e+"").replace(yF,function(e){return vF[e]}).replace(bF,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wF(e){return xF(e).replace(/ /g,"_x0020_")}var _F=/[\u0000-\u001f]/g;function SF(e){return(e+"").replace(yF,function(e){return vF[e]}).replace(/\n/g,"<br/>").replace(_F,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var MF=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(a){return a.replace(e,t)}}();function TF(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function kF(e){for(var t="",a=0,n=0,r=0,i=0,o=0,s=0;a<e.length;)(n=e.charCodeAt(a++))<128?t+=String.fromCharCode(n):(r=e.charCodeAt(a++),n>191&&n<224?(o=(31&n)<<6,o|=63&r,t+=String.fromCharCode(o)):(i=e.charCodeAt(a++),n<240?t+=String.fromCharCode((15&n)<<12|(63&r)<<6|63&i):(s=((7&n)<<18|(63&r)<<12|(63&i)<<6|63&(o=e.charCodeAt(a++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function CF(e){var t,a,n,r=_N(2*e.length),i=1,o=0,s=0;for(a=0;a<e.length;a+=i)i=1,(n=e.charCodeAt(a))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(a+1)),i=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(a+1))+(63&e.charCodeAt(a+2)),i=3):(i=4,t=262144*(7&n)+4096*(63&e.charCodeAt(a+1))+64*(63&e.charCodeAt(a+2))+(63&e.charCodeAt(a+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(r[o++]=255&s,r[o++]=s>>>8,s=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function AF(e){return wN(e,"binary").toString("utf8")}var EF="foo bar bazâð£",IF=xN&&(AF(EF)==kF(EF)&&AF||CF(EF)==kF(EF)&&CF)||kF,RF=xN?function(e){return wN(e,"utf8").toString("binary")}:function(e){for(var t=[],a=0,n=0,r=0;a<e.length;)switch(n=e.charCodeAt(a++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,r=e.charCodeAt(a++)-56320+(n<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},DF=function(){var e={};return function(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}}(),PF=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),LF=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),NF=/<\/?(?:vt:)?variant>/g,OF=/<(?:vt:)([^>]*)>([\s\S]*)</;function FF(e,t){var a=pF(e),n=e.match(LF(a.baseType))||[],r=[];if(n.length!=a.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+a.size);return r}return n.forEach(function(e){var t=e.replace(NF,"").match(OF);t&&r.push({v:IF(t[2]),t:t[1]})}),r}var BF=/(^\s|\s$|\n)/;function UF(e,t){return"<"+e+(t.match(BF)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function zF(e){return AO(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function VF(e,t,a){return"<"+e+(null!=a?zF(a):"")+(null!=t?(t.match(BF)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function HF(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(TQe){if(t)throw TQe}return""}function GF(e){if(xN&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return IF(kN(CN(e)));throw new Error("Bad input format: expected Buffer or string")}var WF=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,qF="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",YF="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",jF="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",XF="http://schemas.openxmlformats.org/package/2006/content-types",$F="http://schemas.openxmlformats.org/package/2006/relationships",KF="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",ZF="http://purl.org/dc/elements/1.1/",JF="http://purl.org/dc/terms/",QF="http://purl.org/dc/dcmitype/",eB="http://schemas.openxmlformats.org/officeDocument/2006/relationships",tB="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",aB="http://www.w3.org/2001/XMLSchema-instance",nB="http://www.w3.org/2001/XMLSchema",rB=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],iB="urn:schemas-microsoft-com:office:office",oB="urn:schemas-microsoft-com:office:excel",sB="urn:schemas-microsoft-com:office:spreadsheet",lB="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",cB="http://macVmlSchemaUri",uB="urn:schemas-microsoft-com:vml",dB="http://www.w3.org/TR/REC-html40";var hB=function(e){for(var t=[],a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,r=e[0][a].length;n<r;n+=10240)t.push.apply(t,e[0][a].slice(n,n+10240));return t},pB=xN?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:wN(e)})):hB(e)}:hB,fB=function(e,t,a){for(var n=[],r=t;r<a;r+=2)n.push(String.fromCharCode(LB(e,r)));return n.join("").replace(EN,"")},mB=xN?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf16le",t,a).replace(EN,""):fB(e,t,a)}:fB,vB=function(e,t,a){for(var n=[],r=t;r<t+a;++r)n.push(("0"+e[r].toString(16)).slice(-2));return n.join("")},gB=xN?function(e,t,a){return Buffer.isBuffer(e)?e.toString("hex",t,t+a):vB(e,t,a)}:vB,yB=function(e,t,a){for(var n=[],r=t;r<a;r++)n.push(String.fromCharCode(PB(e,r)));return n.join("")},bB=xN?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf8",t,a):yB(e,t,a)}:yB,xB=function(e,t){var a=OB(e,t);return a>0?bB(e,t+4,t+4+a-1):""},wB=xB,_B=function(e,t){var a=OB(e,t);return a>0?bB(e,t+4,t+4+a-1):""},SB=_B,MB=function(e,t){var a=2*OB(e,t);return a>0?bB(e,t+4,t+4+a-1):""},TB=MB,kB=function(e,t){var a=OB(e,t);return a>0?mB(e,t+4,t+4+a):""},CB=kB,AB=function(e,t){var a=OB(e,t);return a>0?bB(e,t+4,t+4+a):""},EB=AB,IB=function(e,t){return function(e,t){for(var a=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),r=15&e[t+6],i=5;i>=0;--i)r=256*r+e[t+i];return 2047==n?0==r?a*(1/0):NaN:(0==n?n=-1022:(n-=1023,r+=Math.pow(2,52)),a*Math.pow(2,n-52)*r)}(e,t)},RB=IB,DB=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};xN&&(wB=function(e,t){if(!Buffer.isBuffer(e))return xB(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},SB=function(e,t){if(!Buffer.isBuffer(e))return _B(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},TB=function(e,t){if(!Buffer.isBuffer(e))return MB(e,t);var a=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a-1)},CB=function(e,t){if(!Buffer.isBuffer(e))return kB(e,t);var a=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a)},EB=function(e,t){if(!Buffer.isBuffer(e))return AB(e,t);var a=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+a)},RB=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):IB(e,t)},DB=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var PB=function(e,t){return e[t]},LB=function(e,t){return 256*e[t+1]+e[t]},NB=function(e,t){var a=256*e[t+1]+e[t];return a<32768?a:-1*(65535-a+1)},OB=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},FB=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},BB=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function UB(e,t){var a,n,r,i,o,s,l="",c=[];switch(t){case"dbcs":if(s=this.l,xN&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)l+=String.fromCharCode(LB(this,s)),s+=2;e*=2;break;case"utf8":l=bB(this,this.l,this.l+e);break;case"utf16le":e*=2,l=mB(this,this.l,this.l+e);break;case"wstr":return UB.call(this,e,"dbcs");case"lpstr-ansi":l=wB(this,this.l),e=4+OB(this,this.l);break;case"lpstr-cp":l=SB(this,this.l),e=4+OB(this,this.l);break;case"lpwstr":l=TB(this,this.l),e=4+2*OB(this,this.l);break;case"lpp4":e=4+OB(this,this.l),l=CB(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+OB(this,this.l),l=EB(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(r=PB(this,this.l+e++));)c.push(mN(r));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(r=LB(this,this.l+e));)c.push(mN(r)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",s=this.l,o=0;o<e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return r=PB(this,s),this.l=s+1,i=UB.call(this,e-o,r?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(mN(LB(this,s))),s+=2}l=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(l="",s=this.l,o=0;o!=e;++o){if(this.lens&&-1!==this.lens.indexOf(s))return r=PB(this,s),this.l=s+1,i=UB.call(this,e-o,r?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(mN(PB(this,s))),s+=1}l=c.join("");break;default:switch(e){case 1:return a=PB(this,this.l),this.l++,a;case 2:return a=("i"===t?NB:LB)(this,this.l),this.l+=2,a;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(n=OB(this,this.l),this.l+=4,n):(a=(e>0?FB:BB)(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return n=8==e?RB(this,this.l):RB([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=gB(this,this.l,e)}}return this.l+=e,l}var zB=function(e,t,a){e[a]=255&t,e[a+1]=t>>>8&255,e[a+2]=t>>>16&255,e[a+3]=t>>>24&255},VB=function(e,t,a){e[a]=255&t,e[a+1]=t>>8&255,e[a+2]=t>>16&255,e[a+3]=t>>24&255},HB=function(e,t,a){e[a]=255&t,e[a+1]=t>>>8&255};function GB(e,t,a){var n=0,r=0;if("dbcs"===a){for(r=0;r!=t.length;++r)HB(this,t.charCodeAt(r),this.l+2*r);n=2*t.length}else if("sbcs"===a){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=255&t.charCodeAt(r);n=t.length}else{if("hex"===a){for(;r<e;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}if("utf16le"===a){var i=Math.min(this.l+e,this.length);for(r=0;r<Math.min(t.length,e);++r){var o=t.charCodeAt(r);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,zB(this,t,this.l);break;case 8:if(n=8,"f"===a){!function(e,t,a){var n=(t<0||1/t==-1/0?1:0)<<7,r=0,i=0,o=n?-t:t;isFinite(o)?0==o?r=i=0:(r=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-r),r<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?r=-1022:(i-=Math.pow(2,52),r+=1023)):(r=2047,i=isNaN(t)?26985:0);for(var s=0;s<=5;++s,i/=256)e[a+s]=255&i;e[a+6]=(15&r)<<4|15&i,e[a+7]=r>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,VB(this,t,this.l)}}return this.l+=n,this}function WB(e,t){var a=gB(this,this.l,e.length>>1);if(a!==e)throw new Error(t+"Expected "+e+" saw "+a);this.l+=e.length>>1}function qB(e,t){e.l=t,e.read_shift=UB,e.chk=WB,e.write_shift=GB}function YB(e,t){e.l+=t}function jB(e){var t=_N(e);return qB(t,0),t}function XB(e,t,a){if(e){var n,r,i;qB(e,e.l||0);for(var o=e.length,s=0,l=0;e.l<o;){128&(s=e.read_shift(1))&&(s=(127&s)+((127&e.read_shift(1))<<7));var c=aY[s]||aY[65535];for(i=127&(n=e.read_shift(1)),r=1;r<4&&128&n;++r)i+=(127&(n=e.read_shift(1)))<<7*r;l=e.l+i;var u=c.f&&c.f(e,i,a);if(e.l=l,t(u,c,s))return}}}function $B(){var e=[],t=xN?256:2048,a=function(e){var t=jB(e);return qB(t,0),t},n=a(t),r=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},i=function(e){return n&&e<n.length-n.l?n:(r(),n=a(Math.max(e+1,t)))};return{next:i,push:function(e){r(),null==(n=e).l&&(n.l=n.length),i(t)},end:function(){return r(),AN(e)},_bufs:e}}function KB(e,t,a,n){var r,i=+t;if(!isNaN(i)){n||(n=aY[i].p||(a||[]).length||0),r=1+(i>=128?1:0)+1,n>=128&&++r,n>=16384&&++r,n>=2097152&&++r;var o=e.next(r);i<=127?o.write_shift(1,i):(o.write_shift(1,128+(127&i)),o.write_shift(1,i>>7));for(var s=0;4!=s;++s){if(!(n>=128)){o.write_shift(1,n);break}o.write_shift(1,128+(127&n)),n>>=7}n>0&&DB(a)&&e.push(a)}}function ZB(e,t,a){var n=WO(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!a||a.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function JB(e,t,a){var n=WO(e);return n.s=ZB(n.s,t.s,a),n.e=ZB(n.e,t.s,a),n}function QB(e,t){if(e.cRel&&e.c<0)for(e=WO(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=WO(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var a=oU(e);return e.cRel||null==e.cRel||(a=a.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(a=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(a)),a}function eU(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?QB(e.s,t.biff)+":"+QB(e.e,t.biff):(e.s.rRel?"":"$")+aU(e.s.r)+":"+(e.e.rRel?"":"$")+aU(e.e.r):(e.s.cRel?"":"$")+rU(e.s.c)+":"+(e.e.cRel?"":"$")+rU(e.e.c)}function tU(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function aU(e){return""+(e+1)}function nU(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),a=0,n=0;n!==t.length;++n)a=26*a+t.charCodeAt(n)-64;return a-1}function rU(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function iU(e){for(var t=0,a=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(a=26*a+(r-64))}return{c:a-1,r:t-1}}function oU(e){for(var t=e.c+1,a="";t;t=(t-1)/26|0)a=String.fromCharCode((t-1)%26+65)+a;return a+(e.r+1)}function sU(e){var t=e.indexOf(":");return-1==t?{s:iU(e),e:iU(e)}:{s:iU(e.slice(0,t)),e:iU(e.slice(t+1))}}function lU(e,t){return void 0===t||"number"==typeof t?lU(e.s,e.e):("string"!=typeof e&&(e=oU(e)),"string"!=typeof t&&(t=oU(t)),e==t?e:e+":"+t)}function cU(e){var t={s:{c:0,r:0},e:{c:0,r:0}},a=0,n=0,r=0,i=e.length;for(a=0;n<i&&!((r=e.charCodeAt(n)-64)<1||r>26);++n)a=26*a+r;for(t.s.c=--a,a=0;n<i&&!((r=e.charCodeAt(n)-48)<0||r>9);++n)a=10*a+r;if(t.s.r=--a,n===i||10!=r)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,a=0;n!=i&&!((r=e.charCodeAt(n)-64)<1||r>26);++n)a=26*a+r;for(t.e.c=--a,a=0;n!=i&&!((r=e.charCodeAt(n)-48)<0||r>9);++n)a=10*a+r;return t.e.r=--a,t}function uU(e,t){var a="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=yO(e.z,a?PO(t):t)}catch(TQe){}try{return e.w=yO((e.XF||{}).numFmtId||(a?14:0),a?PO(t):t)}catch(TQe){return""+t}}function dU(e,t,a){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),"e"==e.t?KU[e.v]||e.v:uU(e,null==t?e.v:t))}function hU(e,t){var a=t&&t.sheet?t.sheet:"Sheet1",n={};return n[a]=e,{SheetNames:[a],Sheets:n}}function pU(e,t,a){var n=a||{},r=e?Array.isArray(e):n.dense,i=e||(r?[]:{}),o=0,s=0;if(i&&null!=n.origin){if("number"==typeof n.origin)o=n.origin;else{var l="string"==typeof n.origin?iU(n.origin):n.origin;o=l.r,s=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=cU(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==o&&(c.e.r=o=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(void 0!==t[d][h]){var p={v:t[d][h]},f=o+d,m=s+h;if(c.s.r>f&&(c.s.r=f),c.s.c>m&&(c.s.c=m),c.e.r<f&&(c.e.r=f),c.e.c<m&&(c.e.c=m),!t[d][h]||"object"!=typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),null===p.v)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else{if(!n.sheetStubs)continue;p.t="z"}else"number"==typeof p.v?p.t="n":"boolean"==typeof p.v?p.t="b":p.v instanceof Date?(p.z=n.dateNF||zN[14],n.cellDates?(p.t="d",p.w=yO(p.z,PO(p.v))):(p.t="n",p.v=PO(p.v),p.w=yO(p.z,p.v))):p.t="s";else p=t[d][h];if(r)i[f]||(i[f]=[]),i[f][m]&&i[f][m].z&&(p.z=i[f][m].z),i[f][m]=p;else{var v=oU({c:m,r:f});i[v]&&i[v].z&&(p.z=i[v].z),i[v]=p}}}return c.s.c<1e7&&(i["!ref"]=lU(c)),i}function fU(e,t){return pU(null,e,t)}function mU(e,t){return t||(t=jB(4)),t.write_shift(4,e),t}function vU(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function gU(e,t){var a=!1;return null==t&&(a=!0,t=jB(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),a?t.slice(0,t.l):t}function yU(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bU(e,t){var a=e.l,n=e.read_shift(1),r=vU(e),i=[],o={t:r,h:r};if(1&n){for(var s=e.read_shift(4),l=0;l!=s;++l)i.push(yU(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=a+t,o}var xU=bU;function wU(e,t){var a=!1;return null==t&&(a=!0,t=jB(23+4*e.t.length)),t.write_shift(1,1),gU(e.t,t),t.write_shift(4,1),function(e,t){t||(t=jB(4)),t.write_shift(2,0),t.write_shift(2,0)}(0,t),a?t.slice(0,t.l):t}function _U(e){var t=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:a}}function SU(e,t){return null==t&&(t=jB(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function MU(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function TU(e,t){return null==t&&(t=jB(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var kU=vU,CU=gU;function AU(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function EU(e,t){var a=!1;return null==t&&(a=!0,t=jB(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),a?t.slice(0,t.l):t}var IU=vU,RU=AU,DU=EU;function PU(e){var t=e.slice(e.l,e.l+4),a=1&t[0],n=2&t[0];e.l+=4;var r=0===n?RB([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):FB(t,0)>>2;return a?r/100:r}function LU(e,t){null==t&&(t=jB(4));var a=0,n=0,r=100*e;if(e==(0|e)&&e>=-536870912&&e<1<<29?n=1:r==(0|r)&&r>=-536870912&&r<1<<29&&(n=1,a=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((a?r:e)<<2)+(a+2))}function NU(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var OU=NU,FU=function(e,t){return t||(t=jB(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function BU(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function UU(e,t){return(t||jB(8)).write_shift(8,e,"f")}function zU(e,t){if(t||(t=jB(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),t.write_shift(2,a),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function VU(e,t){var a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var HU=80,GU=[HU,81],WU={1:{n:"CodePage",t:2},2:{n:"Category",t:HU},3:{n:"PresentationFormat",t:HU},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:HU},15:{n:"Company",t:HU},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:HU},27:{n:"ContentStatus",t:HU},28:{n:"Language",t:HU},29:{n:"Version",t:HU},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},qU={1:{n:"CodePage",t:2},2:{n:"Title",t:HU},3:{n:"Subject",t:HU},4:{n:"Author",t:HU},5:{n:"Keywords",t:HU},6:{n:"Comments",t:HU},7:{n:"Template",t:HU},8:{n:"LastAuthor",t:HU},9:{n:"RevNumber",t:HU},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:HU},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},YU={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function XU(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var $U=WO(XU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),KU={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZU={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},JU={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},QU={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ez(e,t){var a,n=function(e){for(var t=[],a=AO(e),n=0;n!==a.length;++n)null==t[e[a[n]]]&&(t[e[a[n]]]=[]),t[e[a[n]]].push(a[n]);return t}(JU),r=[];r[r.length]=sF,r[r.length]=VF("Types",null,{xmlns:XF,"xmlns:xsd":nB,"xmlns:xsi":aB}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return VF("Default",null,{Extension:e[0],ContentType:e[1]})}));var i=function(n){e[n]&&e[n].length>0&&(a=e[n][0],r[r.length]=VF("Override",null,{PartName:("/"==a[0]?"":"/")+a,ContentType:QU[n][t.bookType]||QU[n].xlsx}))},o=function(a){(e[a]||[]).forEach(function(e){r[r.length]=VF("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:QU[a][t.bookType]||QU[a].xlsx})})},s=function(t){(e[t]||[]).forEach(function(e){r[r.length]=VF("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:n[t][0]})})};return i("workbooks"),o("sheets"),o("charts"),s("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),o("metadata"),s("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var tz={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function az(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function nz(e,t){var a={"!id":{}};if(!e)return a;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(uF)||[]).forEach(function(e){var r=pF(e);if("<Relationship"===r[0]){var i={};i.Type=r.Type,i.Target=r.Target,i.Id=r.Id,r.TargetMode&&(i.TargetMode=r.TargetMode);var o="External"===r.TargetMode?r.Target:oF(r.Target,t);a[o]=i,n[r.Id]=i}}),a["!id"]=n,a}function rz(e){var t=[sF,VF("Relationships",null,{xmlns:$F})];return AO(e["!id"]).forEach(function(a){t[t.length]=VF("Relationship",null,e["!id"][a])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function iz(e,t,a,n,r,i){if(r||(r={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,r.Id="rId"+t,r.Type=n,r.Target=a,[tz.HLINK,tz.XPATH,tz.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),e["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][r.Id]=r,e[("/"+r.Target).replace("//","/")]=r,t}function oz(e,t,a){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function sz(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function lz(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rN.version+"</meta:generator></office:meta></office:document-meta>"}var cz=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],uz=function(){for(var e=new Array(cz.length),t=0;t<cz.length;++t){var a=cz[t],n="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function dz(e){var t={};e=IF(e);for(var a=0;a<cz.length;++a){var n=cz[a],r=e.match(uz[a]);null!=r&&r.length>0&&(t[n[1]]=gF(r[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=HO(t[n[1]]))}return t}function hz(e,t,a,n,r){null==r[e]&&null!=t&&""!==t&&(r[e]=t,t=xF(t),n[n.length]=a?VF(e,t,a):UF(e,t))}function pz(e,t){var a=t||{},n=[sF,VF("cp:coreProperties",null,{"xmlns:cp":qF,"xmlns:dc":ZF,"xmlns:dcterms":JF,"xmlns:dcmitype":QF,"xmlns:xsi":aB})],r={};if(!e&&!a.Props)return n.join("");e&&(null!=e.CreatedDate&&hz("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:HF(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r),null!=e.ModifiedDate&&hz("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:HF(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r));for(var i=0;i!=cz.length;++i){var o=cz[i],s=a.Props&&null!=a.Props[o[1]]?a.Props[o[1]]:e?e[o[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&hz(o[0],s,null,n,r)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var fz=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mz=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vz(e,t,a,n){var r=[];if("string"==typeof e)r=FF(e,n);else for(var i=0;i<e.length;++i)r=r.concat(e[i].map(function(e){return{v:e}}));var o="string"==typeof t?FF(t,n).map(function(e){return e.v}):t,s=0,l=0;if(o.length>0)for(var c=0;c!==r.length;c+=2){switch(l=+r[c+1].v,r[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":a.Worksheets=l,a.SheetNames=o.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":a.NamedRanges=l,a.DefinedNames=o.slice(s,s+l);break;case"Charts":case"Diagramme":a.Chartsheets=l,a.ChartNames=o.slice(s,s+l)}s+=l}}function gz(e){var t=[],a=VF;return e||(e={}),e.Application="SheetJS",t[t.length]=sF,t[t.length]=VF("Properties",null,{xmlns:jF,"xmlns:vt":tB}),fz.forEach(function(n){if(void 0!==e[n[1]]){var r;switch(n[2]){case"string":r=xF(String(e[n[1]]));break;case"bool":r=e[n[1]]?"true":"false"}void 0!==r&&(t[t.length]=a(n[0],r))}}),t[t.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+xF(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yz=/<[^>]+>[^<]*/g;function bz(e){var t=[sF,VF("Properties",null,{xmlns:YF,"xmlns:vt":tB})];if(!e)return t.join("");var a=1;return AO(e).forEach(function(n){++a,t[t.length]=VF("property",function(e){switch(typeof e){case"string":var t=VF("vt:lpwstr",xF(e));return t.replace(/&quot;/g,"_x0022_");case"number":return VF((0|e)==e?"vt:i4":"vt:r8",xF(String(e)));case"boolean":return VF("vt:bool",e?"true":"false")}if(e instanceof Date)return VF("vt:filetime",HF(e));throw new Error("Unable to serialize "+e)}(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:xF(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xz,wz={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function _z(e,t,a){xz||(xz=IO(wz)),e[t=xz[t]||t]=a}function Sz(e){var t=e.read_shift(4),a=e.read_shift(4);return new Date(1e3*(a/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Mz(e,t,a){var n=e.l,r=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-n&3;)++e.l;return r}function Tz(e,t,a){return e.read_shift(0,"lpwstr")}function kz(e,t,a){return 31===t?Tz(e):Mz(e,0,a)}function Cz(e,t,a){return kz(e,t,!1===a?0:4)}function Az(e){var t=e.l,a=Rz(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[a,Rz(e,3)]}function Ez(e,t){for(var a=e.read_shift(4),n={},r=0;r!=a;++r){var i=e.read_shift(4),o=e.read_shift(4);n[i]=e.read_shift(o,1200===t?"utf16le":"utf8").replace(EN,"").replace(IN,"!"),1200===t&&o%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Iz(e){var t=e.read_shift(4),a=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),a}function Rz(e,t,a){var n,r=e.read_shift(2),i=a||{};if(e.l+=2,12!==t&&r!==t&&-1===GU.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&r)))throw new Error("Expected type "+t+" saw "+r);switch(12===t?r:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return Mz(e,0,4).replace(EN,"");case 31:return Tz(e);case 64:return Sz(e);case 65:return Iz(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Cz(e,r,!i.raw).replace(EN,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return kz(e,t,0)}(e,r).replace(EN,"");case 4108:return function(e){for(var t=e.read_shift(4),a=[],n=0;n<t/2;++n)a.push(Az(e));return a}(e);case 4126:case 4127:return 4127==r?function(e){for(var t=e.read_shift(4),a=[],n=0;n!=t;++n){var r=e.l;a[n]=e.read_shift(0,"lpwstr").replace(EN,""),e.l-r&2&&(e.l+=2)}return a}(e):function(e){for(var t=e.read_shift(4),a=[],n=0;n!=t;++n)a[n]=e.read_shift(0,"lpstr-cp").replace(EN,"");return a}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function Dz(e,t){var a=jB(4),n=jB(4);switch(a.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=jB(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,a=t%Math.pow(2,32),n=(t-a)/Math.pow(2,32);n*=1e7;var r=(a*=1e7)/Math.pow(2,32)|0;r>0&&(a%=Math.pow(2,32),n+=r);var i=jB(8);return i.write_shift(4,a),i.write_shift(4,n),i}(t);break;case 31:case 80:for((n=jB(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return AN([a,n])}function Pz(e,t){var a=e.l,n=e.read_shift(4),r=e.read_shift(4),i=[],o=0,s=0,l=-1,c={};for(o=0;o!=r;++o){var u=e.read_shift(4),d=e.read_shift(4);i[o]=[u,d+a]}i.sort(function(e,t){return e[1]-t[1]});var h={};for(o=0;o!=r;++o){if(e.l!==i[o][1]){var p=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,p=!1);break;case 80:case 4108:e.l<=i[o][1]&&(e.l=i[o][1],p=!1)}if((!t||0==o)&&e.l<=i[o][1]&&(p=!1,e.l=i[o][1]),p)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var f=t[i[o][0]];if(h[f.n]=Rz(e,f.t,{raw:!0}),"version"===f.p&&(h[f.n]=String(h[f.n]>>16)+"."+("0000"+String(65535&h[f.n])).slice(-4)),"CodePage"==f.n)switch(h[f.n]){case 0:h[f.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:cN(s=h[f.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[f.n])}}else if(1===i[o][0]){if(s=h.CodePage=Rz(e,2),cN(s),-1!==l){var m=e.l;e.l=i[l][1],c=Ez(e,s),e.l=m}}else if(0===i[o][0]){if(0===s){l=o,e.l=i[o+1][1];continue}c=Ez(e,s)}else{var v,g=c[i[o][0]];switch(e[e.l]){case 65:e.l+=4,v=Iz(e);break;case 30:case 31:e.l+=4,v=Cz(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=zz(e,4);break;case 64:e.l+=4,v=HO(Sz(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=a+n,h}var Lz=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Nz(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Oz(e,t,a){var n=jB(8),r=[],i=[],o=8,s=0,l=jB(8),c=jB(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),r.push(c),o+=8+l.length,!t){(c=jB(8)).write_shift(4,0),r.unshift(c);var u=[jB(4)];for(u[0].write_shift(4,e.length),s=0;s<e.length;++s){var d=e[s][0];for((l=jB(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=AN(u),i.unshift(l),o+=8+l.length}for(s=0;s<e.length;++s)if((!t||t[e[s][0]])&&!(Lz.indexOf(e[s][0])>-1||mz.indexOf(e[s][0])>-1)&&null!=e[s][1]){var h=e[s][1],p=0;if(t){var f=a[p=+t[e[s][0]]];if("version"==f.p&&"string"==typeof h){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}l=Dz(f.t,h)}else{var v=Nz(h);-1==v&&(v=31,h=String(h)),l=Dz(v,h)}i.push(l),(c=jB(8)).write_shift(4,t?p:2+s),r.push(c),o+=8+l.length}var g=8*(i.length+1);for(s=0;s<i.length;++s)r[s].write_shift(4,g),g+=i[s].length;return n.write_shift(4,o),n.write_shift(4,i.length),AN([n].concat(r).concat(i))}function Fz(e,t,a){var n=e.content;if(!n)return{};qB(n,0);var r,i,o,s,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==TO.utils.consts.HEADER_CLSID&&u!==a)throw new Error("Bad PropertySet CLSID "+u);if(1!==(r=n.read_shift(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(i=n.read_shift(16),s=n.read_shift(4),1===r&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);2===r&&(o=n.read_shift(16),l=n.read_shift(4));var d,h=Pz(n,t),p={SystemIdentifier:c};for(var f in h)p[f]=h[f];if(p.FMTID=i,1===r)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{d=Pz(n,null)}catch(TQe){}for(f in d)p[f]=d[f];return p.FMTID=[i,o],p}function Bz(e,t,a,n,r,i){var o=jB(r?68:48),s=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,TO.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,r?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,r?68:48);var l=Oz(e,a,n);if(s.push(l),r){var c=Oz(r,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+l.length),s.push(c)}return AN(s)}function Uz(e,t){return e.read_shift(t),null}function zz(e,t){return 1===e.read_shift(t)}function Vz(e,t){return t||(t=jB(2)),t.write_shift(2,+!!e),t}function Hz(e){return e.read_shift(2,"u")}function Gz(e,t){return t||(t=jB(2)),t.write_shift(2,e),t}function Wz(e,t){return function(e,t,a){for(var n=[],r=e.l+t;e.l<r;)n.push(a(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return n}(e,t,Hz)}function qz(e,t,a){return a||(a=jB(2)),a.write_shift(1,"e"==t?+e:+!!e),a.write_shift(1,"e"==t?1:0),a}function Yz(e,t,a){var n=e.read_shift(a&&a.biff>=12?2:1),r="sbcs-cont";(a&&a.biff,a&&8!=a.biff)?12==a.biff&&(r="wstr"):e.read_shift(1)&&(r="dbcs-cont");return a.biff>=2&&a.biff<=5&&(r="cpstr"),n?e.read_shift(n,r):""}function jz(e){var t,a=e.read_shift(2),n=e.read_shift(1),r=4&n,i=8&n,o=1+(1&n),s=0,l={};i&&(s=e.read_shift(2)),r&&(t=e.read_shift(4));var c=2==o?"dbcs-cont":"sbcs-cont",u=0===a?"":e.read_shift(a,c);return i&&(e.l+=4*s),r&&(e.l+=t),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Xz(e){var t=e.t||"",a=jB(3);a.write_shift(2,t.length),a.write_shift(1,1);var n=jB(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),AN([a,n])}function $z(e,t,a){if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(t,"cpstr");if(a.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Kz(e,t,a){var n=e.read_shift(a&&2==a.biff?1:2);return 0===n?(e.l++,""):$z(e,n,a)}function Zz(e,t,a){if(a.biff>5)return Kz(e,0,a);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Jz(e,t,a){return a||(a=jB(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function Qz(e,t){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),a=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=a);var r=e.read_shift((n?t-24:t)>>1,"utf16le").replace(EN,"");return n&&(e.l+=24),r}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),a="";t-- >0;)a+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return a+n.replace(/\\/g,"/");var r=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return a+e.read_shift(r>>1,"utf16le").replace(EN,"")}(e);default:throw new Error("Unsupported Moniker "+a)}}function eV(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(EN,""):""}function tV(e,t){t||(t=jB(6+2*e.length)),t.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function aV(e){var t=jB(512),a=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var r=n.indexOf("#"),i=r>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(a=0;a<o.length;++a)t.write_shift(4,o[a]);if(28==i)tV(n=n.slice(1),t);else if(2&i){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<o.length;++a)t.write_shift(1,parseInt(o[a],16));var s=r>-1?n.slice(0,r):n;for(t.write_shift(4,2*(s.length+1)),a=0;a<s.length;++a)t.write_shift(2,s.charCodeAt(a));t.write_shift(2,0),8&i&&tV(r>-1?n.slice(r+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<o.length;++a)t.write_shift(1,parseInt(o[a],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),a=0;a<n.length-3*l;++a)t.write_shift(1,255&n.charCodeAt(a+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),a=0;a<6;++a)t.write_shift(4,0)}return t.slice(0,t.l)}function nV(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function rV(e,t){var a=nV(e);return a[3]=0,a}function iV(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function oV(e,t,a,n){return n||(n=jB(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,a||0),n}function sV(e,t,a){var n=a.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function lV(e){return[e.read_shift(2),PU(e)]}function cV(e){var t=e.read_shift(2),a=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:a}}}function uV(e,t){return t||(t=jB(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function dV(e){var t=e.read_shift(2),a=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:a}}}var hV=dV;function pV(e){e.l+=4;var t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[a,t,n]}function fV(e){e.l+=2,e.l+=e.read_shift(2)}var mV={0:fV,4:fV,5:fV,6:fV,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:fV,9:fV,10:fV,11:fV,12:fV,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:fV,15:fV,16:fV,17:fV,18:fV,19:fV,20:fV,21:pV};function vV(e,t){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),(t-=2)>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(t),a}function gV(e,t,a){var n=1536,r=16;switch(a.bookType){case"biff8":case"xla":break;case"biff5":n=1280,r=8;break;case"biff4":n=4,r=6;break;case"biff3":n=3,r=6;break;case"biff2":n=2,r=4;break;default:throw new Error("unsupported BIFF version")}var i=jB(r);return i.write_shift(2,n),i.write_shift(2,t),r>4&&i.write_shift(2,29282),r>6&&i.write_shift(2,1997),r>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function yV(e,t){var a=!t||t.biff>=8?2:1,n=jB(8+a*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(a*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var r=n.slice(0,n.l);return r.l=n.l,r}function bV(e,t,a){var n=0;a&&2==a.biff||(n=e.read_shift(2));var r=e.read_shift(2);return a&&2==a.biff&&(n=1-(r>>15),r&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},r]}function xV(e,t,a,n){var r=a&&5==a.biff;n||(n=jB(r?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(r?1:2,t.length),r||n.write_shift(1,1),n.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return null==i.l&&(i.l=i.length),i}var wV=Zz;function _V(e,t,a){var n=e.l+t,r=8!=a.biff&&a.biff?2:4,i=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:s},e:{r:o,c:l}}}function SV(e,t,a,n){var r=a&&5==a.biff;n||(n=jB(r?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&r&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),r||n.write_shift(4,0),n.write_shift(2,0),n}function MV(e,t,a){var n=iV(e);2!=a.biff&&9!=t||++e.l;var r=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=r,n.t=!0===r||!1===r?"b":"e",n}var TV=function(e,t,a){return 0===t?"":Zz(e,0,a)};function kV(e,t,a){var n,r=e.read_shift(2),i={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===a.sbcch&&(n=function(e,t,a){e.l+=4,t-=4;var n=e.l+t,r=Yz(e,0,a),i=e.read_shift(2);if(i!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,r}(e,t-2,a)),i.body=n||e.read_shift(t-2),"string"==typeof n&&(i.Name=n),i}var CV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function AV(e,t,a){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(a&&2==a.biff?1:2),l=0;(!a||a.biff>=5)&&(5!=a.biff&&(e.l+=2),l=e.read_shift(2),5==a.biff&&(e.l+=2),e.l+=4);var c=$z(e,o,a);32&r&&(c=CV[c.charCodeAt(0)]);var u=n-e.l;a&&2==a.biff&&--u;var d=n!=e.l&&0!==s&&u>0?function(e,t,a,n){var r,i=e.l+t,o=GG(e,n,a);i!==e.l&&(r=HG(e,i-e.l,o,a));return[o,r]}(e,u,a,s):[];return{chKey:i,Name:c,itab:l,rgce:d}}function EV(e,t,a){if(a.biff<8)return function(e,t,a){3==e[e.l+1]&&e[e.l]++;var n=Yz(e,0,a);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,a);for(var n=[],r=e.l+t,i=e.read_shift(a.biff>8?4:2);0!==i--;)n.push(sV(e,a.biff,a));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return n}function IV(e,t,a){var n=hV(e);switch(a.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,$G(e,t,a)]}var RV={8:function(e,t){var a=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var r=e.read_shift(1);return e.l+=r,e.l=a,{fmt:n}}};function DV(e){var t=jB(24),a=iU(e[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(n[r],16));return AN([t,aV(e[1])])}function PV(e){var t=e[1].Tooltip,a=jB(10+2*(t.length+1));a.write_shift(2,2048);var n=iU(e[0]);a.write_shift(2,n.r),a.write_shift(2,n.r),a.write_shift(2,n.c),a.write_shift(2,n.c);for(var r=0;r<t.length;++r)a.write_shift(2,t.charCodeAt(r));return a.write_shift(2,0),a}function LV(e,t,a){if(!a.cellStyles)return YB(e,t);var n=a&&a.biff>=12?4:2,r=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:r,e:i,w:o,ixfe:s,flags:l};return(a.biff>=5||!a.biff)&&(c.level=l>>8&7),c}var NV=iV,OV=Wz,FV=Kz;var BV=[2,3,48,49,131,139,140,245],UV=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=IO({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(t,a){var n=a||{};n.dateNF||(n.dateNF="yyyymmdd");var r=fU(function(t,a){var n=[],r=_N(1);switch(a.type){case"base64":r=MN(bN(t));break;case"binary":r=MN(t);break;case"buffer":case"array":r=t}qB(r,0);var i=r.read_shift(1),o=!!(136&i),s=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,o=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,u=521;2==i&&(c=r.read_shift(2)),r.l+=3,2!=i&&(c=r.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(u=r.read_shift(2));var d=r.read_shift(2),h=a.codepage||1252;2!=i&&(r.l+=16,r.read_shift(1),0!==r[r.l]&&(h=e[r[r.l]]),r.l+=1,r.l+=2),l&&(r.l+=36);for(var p=[],f={},m=Math.min(r.length,2==i?521:u-10-(s?264:0)),v=l?32:11;r.l<m&&13!=r[r.l];)switch((f={}).name=pN.utils.decode(h,r.slice(r.l,r.l+v)).replace(/[\u0000\r\n].*$/g,""),r.l+=v,f.type=String.fromCharCode(r.read_shift(1)),2==i||l||(f.offset=r.read_shift(4)),f.len=r.read_shift(1),2==i&&(f.offset=r.read_shift(2)),f.dec=r.read_shift(1),f.name.length&&p.push(f),2!=i&&(r.l+=l?13:14),f.type){case"B":s&&8==f.len||!a.WTF||console.log("Skipping "+f.name+":"+f.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+f.name+":"+f.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==r[r.l]&&(r.l=u-1),13!==r.read_shift(1))throw new Error("DBF Terminator not found "+r.l+" "+r[r.l]);r.l=u;var g=0,y=0;for(n[0]=[],y=0;y!=p.length;++y)n[0][y]=p[y].name;for(;c-- >0;)if(42!==r[r.l])for(++r.l,n[++g]=[],y=0,y=0;y!=p.length;++y){var b=r.slice(r.l,r.l+p[y].len);r.l+=p[y].len,qB(b,0);var x=pN.utils.decode(h,b);switch(p[y].type){case"C":x.trim().length&&(n[g][y]=x.replace(/\s+$/,""));break;case"D":8===x.length?n[g][y]=new Date(+x.slice(0,4),+x.slice(4,6)-1,+x.slice(6,8)):n[g][y]=x;break;case"F":n[g][y]=parseFloat(x.trim());break;case"+":case"I":n[g][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(x.trim().toUpperCase()){case"Y":case"T":n[g][y]=!0;break;case"N":case"F":n[g][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+x+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));n[g][y]="##MEMO##"+(l?parseInt(x.trim(),10):b.read_shift(4));break;case"N":(x=x.replace(/\u0000/g,"").trim())&&"."!=x&&(n[g][y]=+x||0);break;case"@":n[g][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":n[g][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":n[g][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[g][y]=-b.read_shift(-8,"f");break;case"B":if(s&&8==p[y].len){n[g][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=p[y].len;break;case"0":if("_NullFlags"===p[y].name)break;default:throw new Error("DBF Unsupported data type "+p[y].type)}}else r.l+=d;if(2!=i&&r.l<r.length&&26!=r[r.l++])throw new Error("DBF EOF Marker missing "+(r.l-1)+" of "+r.length+" "+r[r.l-1].toString(16));return a&&a.sheetRows&&(n=n.slice(0,a.sheetRows)),a.DBF=p,n}(t,n),n);return r["!cols"]=n.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete n.DBF,r}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return hU(a(e,t),t)}catch(TQe){if(t&&t.WTF)throw TQe}return{SheetNames:[],Sheets:{}}},to_sheet:a,from_sheet:function(e,a){var r=a||{};if(+r.codepage>=0&&cN(+r.codepage),"string"==r.type)throw new Error("Cannot write DBF to JS string");var i=$B(),o=wj(e,{header:1,raw:!0,cellDates:!0}),s=o[0],l=o.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,p=1;for(u=0;u<s.length;++u)if(((c[u]||{}).DBF||{}).name)s[u]=c[u].DBF.name,++h;else if(null!=s[u]){if(++h,"number"==typeof s[u]&&(s[u]=s[u].toString(10)),"string"!=typeof s[u])throw new Error("DBF Invalid column name "+s[u]+" |"+typeof s[u]+"|");if(s.indexOf(s[u])!==u)for(d=0;d<1024;++d)if(-1==s.indexOf(s[u]+"_"+d)){s[u]+="_"+d;break}}var f=cU(e["!ref"]),m=[],v=[],g=[];for(u=0;u<=f.e.c-f.s.c;++u){var y="",b="",x=0,w=[];for(d=0;d<l.length;++d)null!=l[d][u]&&w.push(l[d][u]);if(0!=w.length&&null!=s[u]){for(d=0;d<w.length;++d){switch(typeof w[d]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=w[d]instanceof Date?"D":"C"}x=Math.max(x,String(w[d]).length),y=y&&y!=b?"C":b}x>250&&(x=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>x&&(x=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",g[u]=c[u].DBF.dec,x=c[u].DBF.len),v[u]="C"==y||"N"==b?x:n[y]||0,p+=v[u],m[u]=y}else m[u]="?"}var _=i.next(32);for(_.write_shift(4,318902576),_.write_shift(4,l.length),_.write_shift(2,296+32*h),_.write_shift(2,p),u=0;u<4;++u)_.write_shift(4,0);for(_.write_shift(4,(+t[iN]||3)<<8),u=0,d=0;u<s.length;++u)if(null!=s[u]){var S=i.next(32),M=(s[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,M,"sbcs"),S.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),S.write_shift(4,d),S.write_shift(1,v[u]||n[m[u]]||0),S.write_shift(1,g[u]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),d+=v[u]||n[m[u]]||0}var T=i.next(264);for(T.write_shift(4,13),u=0;u<65;++u)T.write_shift(4,0);for(u=0;u<l.length;++u){var k=i.next(p);for(k.write_shift(1,0),d=0;d<s.length;++d)if(null!=s[d])switch(m[d]){case"L":k.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":k.write_shift(8,l[u][d]||0,"f");break;case"N":var C="0";for("number"==typeof l[u][d]&&(C=l[u][d].toFixed(g[d]||0)),h=0;h<v[d]-C.length;++h)k.write_shift(1,32);k.write_shift(1,C,"sbcs");break;case"D":l[u][d]?(k.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),k.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),k.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):k.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[u][d]?l[u][d]:"").slice(0,v[d]);for(k.write_shift(1,A,"sbcs"),h=0;h<v[d]-A.length;++h)k.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),zV=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+AO(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(t,a){var n=e[a];return"number"==typeof n?vN(n):n},n=function(e,t,a){var n=t.charCodeAt(0)-32<<4|a.charCodeAt(0)-48;return 59==n?e:vN(n)};function r(e,r){var i,o=e.split(/[\n\r]+/),s=-1,l=-1,c=0,u=0,d=[],h=[],p=null,f={},m=[],v=[],g=[],y=0;for(+r.codepage>=0&&cN(+r.codepage);c!==o.length;++c){y=0;var b,x=o[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,a),w=x.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),_=w[0];if(x.length>0)switch(_){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(x.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,M=!1,T=!1,k=!1,C=-1,A=-1;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[u].slice(1))-1,M=!0;break;case"Y":for(s=parseInt(w[u].slice(1))-1,M||(l=0),i=d.length;i<=s;++i)d[i]=[];break;case"K":'"'===(b=w[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(YO(b))?isNaN(XO(b).getDate())||(b=HO(b)):(b=YO(b),null!==p&&fO(p)&&(b=FO(b))),S=!0;break;case"E":k=!0;var E=gG(w[u].slice(1),{r:s,c:l});d[s][l]=[d[s][l],E];break;case"S":T=!0,d[s][l]=[d[s][l],"S5S"];break;case"R":C=parseInt(w[u].slice(1))-1;break;case"C":A=parseInt(w[u].slice(1))-1;break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+x)}if(S&&(d[s][l]&&2==d[s][l].length?d[s][l][0]=b:d[s][l]=b,p=null),T){if(k)throw new Error("SYLK shared formula cannot have own formula");var I=C>-1&&d[C][A];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");d[s][l][1]=xG(I[1],{r:s-C,c:l-A})}break;case"F":var R=0;for(u=1;u<w.length;++u)switch(w[u].charAt(0)){case"X":l=parseInt(w[u].slice(1))-1,++R;break;case"Y":for(s=parseInt(w[u].slice(1))-1,i=d.length;i<=s;++i)d[i]=[];break;case"M":y=parseInt(w[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":p=h[parseInt(w[u].slice(1))];break;case"W":for(g=w[u].slice(1).split(" "),i=parseInt(g[0],10);i<=parseInt(g[1],10);++i)y=parseInt(g[2],10),v[i-1]=0===y?{hidden:!0}:{wch:y},kH(v[i-1]);break;case"C":v[l=parseInt(w[u].slice(1))-1]||(v[l]={});break;case"R":m[s=parseInt(w[u].slice(1))-1]||(m[s]={}),y>0?(m[s].hpt=y,m[s].hpx=EH(y)):0===y&&(m[s].hidden=!0);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+x)}R<1&&(p=null);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+x)}}return m.length>0&&(f["!rows"]=m),v.length>0&&(f["!cols"]=v),r&&r.sheetRows&&(d=d.slice(0,r.sheetRows)),[d,f]}function i(e,t){var a=function(e,t){switch(t.type){case"base64":return r(bN(e),t);case"binary":return r(e,t);case"buffer":return r(xN&&Buffer.isBuffer(e)?e.toString("binary"):kN(e),t);case"array":return r(GO(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=a[0],i=a[1],o=fU(n,t);return AO(i).forEach(function(e){o[e]=i[e]}),o}function o(e,t,a,n){var r="C;Y"+(a+1)+";X"+(n+1)+";K";switch(e.t){case"n":r+=e.v||0,e.f&&!e.F&&(r+=";E"+bG(e.f,{r:a,c:n}));break;case"b":r+=e.v?"TRUE":"FALSE";break;case"e":r+=e.w||e.v;break;case"d":r+='"'+(e.w||e.v)+'"';break;case"s":r+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return r}return e["|"]=254,{to_workbook:function(e,t){return hU(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var a,n=["ID;PWXL;N;E"],r=[],i=cU(e["!ref"]),s=Array.isArray(e),l="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&function(e,t){t.forEach(function(t,a){var n="F;W"+(a+1)+" "+(a+1)+" ";t.hidden?n+="0":("number"!=typeof t.width||t.wpx||(t.wpx=wH(t.width)),"number"!=typeof t.wpx||t.wch||(t.wch=_H(t.wpx)),"number"==typeof t.wch&&(n+=Math.round(t.wch)))," "!=n.charAt(n.length-1)&&e.push(n)})}(n,e["!cols"]),e["!rows"]&&function(e,t){t.forEach(function(t,a){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*AH(t.hpx)+";"),n.length>2&&e.push(n+"R"+(a+1))})}(n,e["!rows"]),n.push("B;Y"+(i.e.r-i.s.r+1)+";X"+(i.e.c-i.s.c+1)+";D"+[i.s.c,i.s.r,i.e.c,i.e.r].join(" "));for(var c=i.s.r;c<=i.e.r;++c)for(var u=i.s.c;u<=i.e.c;++u){var d=oU({r:c,c:u});(a=s?(e[c]||[])[u]:e[d])&&(null!=a.v||a.f&&!a.F)&&r.push(o(a,0,c,u))}return n.join(l)+l+r.join(l)+l+"E"+l}}}(),VV=function(){function e(e,t){for(var a=e.split("\n"),n=-1,r=-1,i=0,o=[];i!==a.length;++i)if("BOT"!==a[i].trim()){if(!(n<0)){for(var s=a[i].trim().split(","),l=s[0],c=s[1],u=a[++i]||"";1&(u.match(/["]/g)||[]).length&&i<a.length-1;)u+="\n"+a[++i];switch(u=u.trim(),+l){case-1:if("BOT"===u){o[++n]=[],r=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?o[n][r]=!0:"FALSE"===u?o[n][r]=!1:isNaN(YO(c))?isNaN(XO(c).getDate())?o[n][r]=c:o[n][r]=HO(c):o[n][r]=YO(c),++r;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),o[n][r++]=""!==u?u:null}if("EOD"===u)break}}else o[++n]=[],r=0;return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}function t(t,a){return fU(function(t,a){switch(a.type){case"base64":return e(bN(t),a);case"binary":return e(t,a);case"buffer":return e(xN&&Buffer.isBuffer(t)?t.toString("binary"):kN(t),a);case"array":return e(GO(t),a)}throw new Error("Unrecognized type "+a.type)}(t,a),a)}var a=function(){var e=function(e,t,a,n,r){e.push(t),e.push(a+","+n),e.push('"'+r.replace(/"/g,'""')+'"')},t=function(e,t,a,n){e.push(t+","+a),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(a){var n,r=[],i=cU(a["!ref"]),o=Array.isArray(a);e(r,"TABLE",0,1,"sheetjs"),e(r,"VECTORS",0,i.e.r-i.s.r+1,""),e(r,"TUPLES",0,i.e.c-i.s.c+1,""),e(r,"DATA",0,0,"");for(var s=i.s.r;s<=i.e.r;++s){t(r,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=oU({r:s,c:l});if(n=o?(a[s]||[])[l]:a[c])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(r,1,0,"="+n.f):t(r,1,0,""):t(r,0,u,"V");break;case"b":t(r,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(r,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=yO(n.z||zN[14],PO(HO(n.v)))),t(r,0,n.w,"V");break;default:t(r,1,0,"")}else t(r,1,0,"")}}t(r,-1,0,"EOD");return r.join("\r\n")}}();return{to_workbook:function(e,a){return hU(t(e,a),a)},to_sheet:t,from_sheet:a}}(),HV=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(t,a){return fU(function(t,a){for(var n=t.split("\n"),r=-1,i=-1,o=0,s=[];o!==n.length;++o){var l=n[o].trim().split(":");if("cell"===l[0]){var c=iU(l[1]);if(s.length<=c.r)for(r=s.length;r<=c.r;++r)s[r]||(s[r]=[]);switch(r=c.r,i=c.c,l[2]){case"t":s[r][i]=e(l[3]);break;case"v":s[r][i]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?s[r][i]=!!+l[4]:s[r][i]=+l[4],"vtf"==l[2]&&(s[r][i]=[s[r][i],u])}}}return a&&a.sheetRows&&(s=s.slice(0,a.sheetRows)),s}(t,a),a)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),o="--SocialCalcSpreadsheetControlSave--";function s(e){if(!e||!e["!ref"])return"";for(var a,n=[],r=[],i="",o=sU(e["!ref"]),s=Array.isArray(e),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c)if(i=oU({r:l,c:c}),(a=s?(e[l]||[])[c]:e[i])&&null!=a.v&&"z"!==a.t){switch(r=["cell",i,"t"],a.t){case"s":case"str":r.push(t(a.v));break;case"n":a.f?(r[2]="vtf",r[3]="n",r[4]=a.v,r[5]=t(a.f)):(r[2]="v",r[3]=a.v);break;case"b":r[2]="vt"+(a.f?"f":"c"),r[3]="nl",r[4]=a.v?"1":"0",r[5]=t(a.f||(a.v?"TRUE":"FALSE"));break;case"d":var u=PO(HO(a.v));r[2]="vtc",r[3]="nd",r[4]=""+u,r[5]=a.w||yO(a.z||zN[14],u);break;case"e":continue}n.push(r.join(":"))}return n.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return hU(a(e,t),t)},to_sheet:a,from_sheet:function(e){return[n,r,i,r,s(e),o].join("\n")}}}(),GV=function(){function e(e,t,a,n,r){r.raw?t[a][n]=e:""===e||("TRUE"===e?t[a][n]=!0:"FALSE"===e?t[a][n]=!1:isNaN(YO(e))?isNaN(XO(e).getDate())?t[a][n]=e:t[a][n]=HO(e):t[a][n]=YO(e))}var t={44:",",9:"\t",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(e){for(var n={},r=!1,i=0,o=0;i<e.length;++i)34==(o=e.charCodeAt(i))?r=!r:!r&&o in t&&(n[o]=(n[o]||0)+1);for(i in o=[],n)Object.prototype.hasOwnProperty.call(n,i)&&o.push([n[i],i]);if(!o.length)for(i in n=a)Object.prototype.hasOwnProperty.call(n,i)&&o.push([n[i],i]);return o.sort(function(e,t){return e[0]-t[0]||a[e[1]]-a[t[1]]}),t[o.pop()[1]]||44}function r(e,t){var a=t||{},r="",i=a.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(r=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(r=e.charAt(4),e=e.slice(6)):r=n(e.slice(0,1024)):r=a&&a.FS?a.FS:n(e.slice(0,1024));var s=0,l=0,c=0,u=0,d=0,h=r.charCodeAt(0),p=!1,f=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var v,g,y=null!=a.dateNF?(v=a.dateNF,g=(g="number"==typeof v?zN[v]:v).replace(SO,"(\\d+)"),new RegExp("^"+g+"$")):null;function b(){var t=e.slice(u,d),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(a.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=YO(t)))if(!isNaN(XO(t).getDate())||y&&t.match(y)){n.z=a.dateNF||zN[14];var r=0;y&&t.match(y)&&(t=function(e,t,a){var n=-1,r=-1,i=-1,o=-1,s=-1,l=-1;(t.match(SO)||[]).forEach(function(e,t){var c=parseInt(a[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":i=c;break;case"h":o=c;break;case"s":l=c;break;case"m":o>=0?s=c:r=c}}),l>=0&&-1==s&&r>=0&&(s=r,r=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==o&&-1==s&&-1==l?c:-1==n&&-1==r&&-1==i?u:c+"T"+u}(0,a.dateNF,t.match(y)||[]),r=1),a.cellDates?(n.t="d",n.v=HO(t,r)):(n.t="n",n.v=PO(HO(t,r))),!1!==a.cellText&&(n.w=yO(n.z,n.v instanceof Date?PO(n.v):n.v)),a.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==a.cellText&&(n.w=t),n.v=c;if("z"==n.t||(a.dense?(i[s]||(i[s]=[]),i[s][l]=n):i[oU({c:l,r:s})]=n),u=d+1,m=e.charCodeAt(u),o.e.c<l&&(o.e.c=l),o.e.r<s&&(o.e.r=s),f==h)++l;else if(l=0,++s,a.sheetRows&&a.sheetRows<=s)return!0}e:for(;d<e.length;++d)switch(f=e.charCodeAt(d)){case 34:34===m&&(p=!p);break;case h:case 10:case 13:if(!p&&b())break e}return d-u>0&&b(),i["!ref"]=lU(o),i}function i(t,a){return a&&a.PRN?a.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?r(t,a):fU(function(t,a){var n=a||{},r=[];if(!t||0===t.length)return r;for(var i=t.split(/[\r\n]/),o=i.length-1;o>=0&&0===i[o].length;)--o;for(var s=10,l=0,c=0;c<=o;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,s=Math.max(s,l);for(c=0;c<=o;++c){r[c]=[];var u=0;for(e(i[c].slice(0,s).trim(),r,c,u,n),u=1;u<=(i[c].length-s)/10+1;++u)e(i[c].slice(s+10*(u-1),s+10*u).trim(),r,c,u,n)}return n.sheetRows&&(r=r.slice(0,n.sheetRows)),r}(t,a),a):r(t,a)}function o(e,t){var a="",n="string"==t.type?[0,0,0,0]:uj(e,t);switch(t.type){case"base64":a=bN(e);break;case"binary":case"string":a=e;break;case"buffer":65001==t.codepage?a=e.toString("utf8"):(t.codepage,a=xN&&Buffer.isBuffer(e)?e.toString("binary"):kN(e));break;case"array":a=GO(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?a=IF(a.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?a=IF(a):t.type,"socialcalc:version:"==a.slice(0,19)?HV.to_sheet("string"==t.type?a:IF(a),t):i(a,t)}return{to_workbook:function(e,t){return hU(o(e,t),t)},to_sheet:o,from_sheet:function(e){for(var t,a=[],n=cU(e["!ref"]),r=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){for(var o=[],s=n.s.c;s<=n.e.c;++s){var l=oU({r:i,c:s});if((t=r?(e[i]||[])[s]:e[l])&&null!=t.v){for(var c=(t.w||(dU(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";o.push(c+(0===s?" ":""))}else o.push("          ")}a.push(o.join(""))}return a.join("\n")}}}();var WV=function(){function e(e,t,a){if(e){qB(e,e.l||0);for(var n=a.Enum||g;e.l<e.length;){var r=e.read_shift(2),i=n[r]||n[65535],o=e.read_shift(2),s=e.l+o,l=i.f&&i.f(e,o,a);if(e.l=s,t(l,i,r))return}}}function t(t,a){if(!t)return t;var n=a||{},r=n.dense?[]:{},i="Sheet1",o="",s=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=g,e(t,function(e,t,a){switch(a){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:d=e;break;case 204:e&&(o=e);break;case 222:o=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==a&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||zN[14],n.cellDates&&(e[1].t="d",e[1].v=FO(e[1].v))),n.qpro&&e[3]>s&&(r["!ref"]=lU(d),l[i]=r,c.push(i),r=n.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i=o||"Sheet"+(s+1),o="");var u=n.dense?(r[e[0].r]||[])[e[0].c]:r[oU(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[oU(e[0])]=e[1]}},n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=y,14==t[2]&&(n.qpro=!0,t.l=0),e(t,function(e,t,a){switch(a){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(r["!ref"]=lU(d),l[i]=r,c.push(i),r=n.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],i="Sheet"+(s+1)),h>0&&e[0].r>=h)break;n.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[oU(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==s&&(i=e[1])}},n)}if(r["!ref"]=lU(d),l[o||i]=r,c.push(o||i),!u.length)return{SheetNames:c,Sheets:l};for(var p={},f=[],m=0;m<u.length;++m)l[c[m]]?(f.push(u[m]||c[m]),p[u[m]]=l[u[m]]||l[c[m]]):(f.push(u[m]),p[u[m]]={"!ref":"A1"});return{SheetNames:f,Sheets:p}}function a(e,t,a){var n=[{c:0,r:0},{t:"n",v:0},0,0];return a.qpro&&20768!=a.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var r=e.l+t,i=a(e,0,n);if(i[1].t="s",20768==n.vers){e.l++;var o=e.read_shift(1);return i[1].v=e.read_shift(o,"utf8"),i}return n.qpro&&e.l++,i[1].v=e.read_shift(r-e.l,"cstr"),i}function r(e,t,a){var n=jB(7+a.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var r=0;r<n.length;++r){var i=a.charCodeAt(r);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function i(e,t,a){var n=jB(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,a,"i"),n}function o(e,t,a){var n=jB(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,a,"f"),n}function s(e,t,a){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(a?rU(t):aU(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,a,n){var r=jB(6+n.length);r.write_shift(2,e),r.write_shift(1,a),r.write_shift(1,t),r.write_shift(1,39);for(var i=0;i<n.length;++i){var o=n.charCodeAt(i);r.write_shift(1,o>=128?95:o)}return r.write_shift(1,0),r}function h(e,t){var a=u(e),n=e.read_shift(4),r=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===n&&3221225472===r?(a[1].t="e",a[1].v=15):0===n&&3489660928===r?(a[1].t="e",a[1].v=42):a[1].v=0,a;var o=32768&i;return i=(32767&i)-16446,a[1].v=(1-2*o)*(r*Math.pow(2,i+32)+n*Math.pow(2,i)),a}function p(e,t,a,n){var r=jB(14);if(r.write_shift(2,e),r.write_shift(1,a),r.write_shift(1,t),0==n)return r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,65535),r;var i,o=0,s=0,l=0;return n<0&&(o=1,n=-n),s=0|Math.log2(n),2147483648&(l=(n/=Math.pow(2,s-31))>>>0)||(++s,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,i=(n*=Math.pow(2,32))>>>0,r.write_shift(4,i),r.write_shift(4,l),s+=16383+(o?32768:0),r.write_shift(2,s),r}function f(e,t){var a=u(e),n=e.read_shift(8,"f");return a[1].v=n,a}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function v(e,t){var a=jB(5+e.length);a.write_shift(2,14e3),a.write_shift(2,t);for(var n=0;n<e.length;++n){var r=e.charCodeAt(n);a[a.l++]=r>127?95:r}return a[a.l++]=0,a}var g={0:{n:"BOF",f:Hz},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,a){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&a.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&a.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&a.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var r=a(e,0,n);return r[1].v=e.read_shift(2,"i"),r}},14:{n:"NUMBER",f:function(e,t,n){var r=a(e,0,n);return r[1].v=e.read_shift(8,"f"),r}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var r=e.l+t,i=a(e,0,n);if(i[1].v=e.read_shift(8,"f"),n.qpro)e.l=r;else{var o=e.read_shift(2);!function(e,t){qB(e,0);var a=[],n=0,r="",i="",o="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:a.push(e.read_shift(8,"f"));break;case 1:i=s(t[0].c,e.read_shift(2),!0),r=s(t[0].r,e.read_shift(2),!1),a.push(i+r);break;case 2:var h=s(t[0].c,e.read_shift(2),!0),p=s(t[0].r,e.read_shift(2),!1);i=s(t[0].c,e.read_shift(2),!0),r=s(t[0].r,e.read_shift(2),!1),a.push(h+p+":"+i+r);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:a.push("("+a.pop()+")");break;case 5:a.push(e.read_shift(2));break;case 6:for(var f="";d=e[e.l++];)f+=String.fromCharCode(d);a.push('"'+f.replace(/"/g,'""')+'"');break;case 8:a.push("-"+a.pop());break;case 23:a.push("+"+a.pop());break;case 22:a.push("NOT("+a.pop()+")");break;case 20:case 21:u=a.pop(),o=a.pop(),a.push(["AND","OR"][d-20]+"("+o+","+u+")");break;default:if(d<32&&c[d])u=a.pop(),o=a.pop(),a.push(o+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(n=l[d][1])&&(n=e[e.l++]),n>a.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+a.join("|")+"|");var m=a.slice(-n);a.length-=n,a.push(l[d][0]+"("+m.join(",")+")")}}}1==a.length?t[1].f=""+a[0]:console.error("WK1 bad formula parse |"+a.join("|")+"|")}(e.slice(e.l,e.l+o),i),e.l+=o}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var a=e[e.l++];a>t-1&&(a=t-1);for(var n="";n.length<a;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var a=u(e);return a[1].t="s",a[1].v=e.read_shift(t-4,"cstr"),a}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var a=u(e);a[1].v=e.read_shift(2);var n=a[1].v>>1;if(1&a[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return a[1].v=n,a}},25:{n:"FORMULA19",f:function(e,t){var a=h(e);return e.l+=t-14,a}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var a={},n=e.l+t;e.l<n;){var r=e.read_shift(2);if(14e3==r){for(a[r]=[0,""],a[r][0]=e.read_shift(2);e[e.l];)a[r][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return a}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var a=u(e),n=e.read_shift(4);return a[1].v=n>>6,a}},38:{n:"??"},39:{n:"NUMBER27",f:f},40:{n:"FORMULA28",f:function(e,t){var a=f(e);return e.l+=t-10,a}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,a){if(a.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var a=t||{};if(+a.codepage>=0&&cN(+a.codepage),"string"==a.type)throw new Error("Cannot write WK1 to JS string");var n=$B(),s=cU(e["!ref"]),l=Array.isArray(e),c=[];rY(n,0,function(e){var t=jB(2);return t.write_shift(2,e),t}(1030)),rY(n,6,function(e){var t=jB(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var u=Math.min(s.e.r,8191),d=s.s.r;d<=u;++d)for(var h=aU(d),p=s.s.c;p<=s.e.c;++p){d===s.s.r&&(c[p]=rU(p));var f=c[p]+h,m=l?(e[d]||[])[p]:e[f];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?rY(n,13,i(d,p,m.v)):rY(n,14,o(d,p,m.v));else rY(n,15,r(d,p,dU(m).slice(0,239)))}return rY(n,1),n.end()},book_to_wk3:function(e,t){var a=t||{};if(+a.codepage>=0&&cN(+a.codepage),"string"==a.type)throw new Error("Cannot write WK3 to JS string");var n=$B();rY(n,0,function(e){var t=jB(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var a=0,n=0,r=0,i=0;i<e.SheetNames.length;++i){var o=e.SheetNames[i],s=e.Sheets[o];if(s&&s["!ref"]){++r;var l=sU(s["!ref"]);a<l.e.r&&(a=l.e.r),n<l.e.c&&(n=l.e.c)}}a>8191&&(a=8191);return t.write_shift(2,a),t.write_shift(1,r),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var r=0,i=0;r<e.SheetNames.length;++r)(e.Sheets[e.SheetNames[r]]||{})["!ref"]&&rY(n,27,v(e.SheetNames[r],i++));var o=0;for(r=0;r<e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(s&&s["!ref"]){for(var l=cU(s["!ref"]),c=Array.isArray(s),u=[],h=Math.min(l.e.r,8191),f=l.s.r;f<=h;++f)for(var m=aU(f),g=l.s.c;g<=l.e.c;++g){f===l.s.r&&(u[g]=rU(g));var y=u[g]+m,b=c?(s[f]||[])[g]:s[y];if(b&&"z"!=b.t)if("n"==b.t)rY(n,23,p(f,g,o,b.v));else rY(n,22,d(f,g,o,dU(b).slice(0,239)))}++o}}return rY(n,1),n.end()},to_workbook:function(e,a){switch(a.type){case"base64":return t(MN(bN(e)),a);case"binary":return t(MN(e),a);case"buffer":case"array":return t(e,a)}throw"Unsupported type "+a.type}}}();var qV=function(){var e=DF("t"),t=DF("rPr");function a(a){var n=a.match(e);if(!n)return{t:"s",v:""};var r={t:"s",v:gF(n[1])},i=a.match(t);return i&&(r.s=function(e){var t={},a=e.match(uF),n=0,r=!1;if(a)for(;n!=a.length;++n){var i=pF(a[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=sN[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(47!==i[0].charCodeAt(1)&&!r)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),r}var n=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(r).map(a).filter(function(e){return e.v})}}(),YV=function(){var e=/(\r\n|\n)/g;function t(t){var a=[[],t.v,[]];return t.v?(t.s&&function(e,t,a){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),a.push("</b>")),e.i&&(t.push("<i>"),a.push("</i>")),e.strike&&(t.push("<s>"),a.push("</s>"));var r=e.valign||"";"superscript"==r||"super"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(t.push("<"+r+">"),a.push("</"+r+">")),a.push("</span>")}(t.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(e){return e.map(t).join("")}}(),jV=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,XV=/<(?:\w+:)?r>/,$V=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function KV(e,t){var a=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=gF(IF(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=IF(e),a&&(n.h=SF(n.t))):e.match(XV)&&(n.r=IF(e),n.t=gF(IF((e.replace($V,"").match(jV)||[]).join("").replace(uF,""))),a&&(n.h=YV(qV(n.r)))),n):{t:""}}var ZV=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,JV=/<(?:\w+:)?(?:si|sstItem)>/g,QV=/<\/(?:\w+:)?(?:si|sstItem)>/;var eH=/^\s|\s$|[\t\n\r]/;function tH(e,t){if(!t.bookSST)return"";var a=[sF];a[a.length]=VF("sst",null,{xmlns:rB[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var r=e[n],i="<si>";r.r?i+=r.r:(i+="<t",r.t||(r.t=""),r.t.match(eH)&&(i+=' xml:space="preserve"'),i+=">"+xF(r.t)+"</t>"),i+="</si>",a[a.length]=i}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}var aH=function(e,t){var a=!1;return null==t&&(a=!0,t=jB(15+4*e.t.length)),t.write_shift(1,0),gU(e.t,t),a?t.slice(0,t.l):t};function nH(e){var t=$B();KB(t,159,function(e,t){return t||(t=jB(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var a=0;a<e.length;++a)KB(t,19,aH(e[a]));return KB(t,160),t.end()}function rH(e){for(var t=[],a=e.split(""),n=0;n<a.length;++n)t[n]=a[n].charCodeAt(0);return t}function iH(e,t){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),a}function oH(e){for(var t=e.read_shift(4),a=e.l+t-4,n={},r=e.read_shift(4),i=[];r-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return n}function sH(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=iH(e,4),t.U=iH(e,4),t.W=iH(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function lH(e,t){var a=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var r=!1;switch(n.AlgID){case 26126:case 26127:case 26128:r=36==n.Flags;break;case 26625:r=4==n.Flags;break;case 0:r=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,n}function cH(e,t){var a={},n=e.l+t;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,n),e.l=n,a}function uH(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:lH(e,t),v:cH(e,e.length-e.l)}}function dH(){throw new Error("File is password-protected: ECMA-376 Extensible")}function hH(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),n={};return a.replace(uF,function(e){var a=pF(e);switch(fF(a[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){n[e]=a[e]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=a.uri;break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function pH(e){var t,a,n=0,r=rH(e),i=r.length+1;for((t=_N(i))[0]=r.length,a=1;a!=i;++a)t[a]=r[a-1];for(a=i-1;a>=0;--a)n=((16384&n?1:0)|n<<1&32767)^t[a];return 52811^n}var fH=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((a=e^t)/2|128*a);var a};return function(r){for(var i,o,s,l=rH(r),c=function(e){for(var n=t[e.length-1],r=104,i=e.length-1;i>=0;--i)for(var o=e[i],s=0;7!=s;++s)64&o&&(n^=a[r]),o*=2,--r;return n}(l),u=l.length,d=_N(16),h=0;16!=h;++h)d[h]=0;for(1&~u||(i=c>>8,d[u]=n(e[0],i),--u,i=255&c,o=l[l.length-1],d[u]=n(o,i));u>0;)i=c>>8,d[--u]=n(l[u],i),i=255&c,d[--u]=n(l[u],i);for(u=15,s=15-l.length;s>0;)i=c>>8,d[u]=n(e[s],i),--s,i=255&c,d[--u]=n(l[u],i),--u,--s;return d}}(),mH=function(e){var t=0,a=fH(e);return function(e){var n=function(e,t,a,n,r){var i,o;for(r||(r=t),n||(n=fH(e)),i=0;i!=t.length;++i)o=t[i],o=255&((o^=n[a])>>5|o<<3),r[i]=o,++a;return[r,a,n]}("",e,t,a);return t=n[1],n[0]}};function vH(e,t,a){var n=a||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},a=t.EncryptionVersionInfo=iH(e,4);if(1!=a.Major||1!=a.Minor)throw"unrecognized version code "+a.Major+" : "+a.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var a={},n=a.EncryptionVersionInfo=iH(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);a.Flags=e.read_shift(4),t-=4;var r=e.read_shift(4);return t-=4,a.EncryptionHeader=lH(e,r),t-=r,a.EncryptionVerifier=cH(e,t),a}(e,t),n}var gH=function(){function e(e,a){switch(a.type){case"base64":return t(bN(e),a);case"binary":return t(e,a);case"buffer":return t(xN&&Buffer.isBuffer(e)?e.toString("binary"):kN(e),a);case"array":return t(GO(e),a)}throw new Error("Unrecognized type "+a.type)}function t(e,t){var a=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var r={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach(function(e,t){Array.isArray(a)&&(a[t]=[]);for(var n,i=/\\\w+\b/g,o=0,s=-1;n=i.exec(e);){if("\\cell"===n[0]){var l=e.slice(o,i.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++s,l.length){var c={v:l,t:"s"};Array.isArray(a)?a[t][s]=c:a[oU({r:t,c:s})]=c}}o=i.lastIndex}s>r.e.c&&(r.e.c=s)}),a["!ref"]=lU(r),a}return{to_workbook:function(t,a){return hU(e(t,a),a)},to_sheet:e,from_sheet:function(e){for(var t,a=["{\\rtf1\\ansi"],n=cU(e["!ref"]),r=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){a.push("\\trowd\\trautofit1");for(var o=n.s.c;o<=n.e.c;++o)a.push("\\cellx"+(o+1));for(a.push("\\pard\\intbl"),o=n.s.c;o<=n.e.c;++o){var s=oU({r:i,c:o});(t=r?(e[i]||[])[o]:e[s])&&(null!=t.v||t.f&&!t.F)&&(a.push(" "+(t.w||(dU(t),t.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}}}();function yH(e){for(var t=0,a=1;3!=t;++t)a=256*a+(e[t]>255?255:e[t]<0?0:e[t]);return a.toString(16).toUpperCase().slice(1)}function bH(e,t){if(0===t)return e;var a=function(e){var t=e[0]/255,a=e[1]/255,n=e[2]/255,r=Math.max(t,a,n),i=Math.min(t,a,n),o=r-i;if(0===o)return[0,0,t];var s,l=0,c=r+i;switch(s=o/(c>1?2-c:c),r){case t:l=((a-n)/o+6)%6;break;case a:l=(n-t)/o+2;break;case n:l=(t-a)/o+4}return[l/6,s,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return a[2]=t<0?a[2]*(1+t):1-(1-a[2])*(1-t),yH(function(e){var t,a=e[0],n=e[1],r=e[2],i=2*n*(r<.5?r:1-r),o=r-i/2,s=[o,o,o],l=6*a;if(0!==n)switch(0|l){case 0:case 6:t=i*l,s[0]+=i,s[1]+=t;break;case 1:t=i*(2-l),s[0]+=t,s[1]+=i;break;case 2:t=i*(l-2),s[1]+=i,s[2]+=t;break;case 3:t=i*(4-l),s[1]+=t,s[2]+=i;break;case 4:t=i*(l-4),s[2]+=i,s[0]+=t;break;case 5:t=i*(6-l),s[2]+=t,s[0]+=i}for(var c=0;3!=c;++c)s[c]=Math.round(255*s[c]);return s}(a))}var xH=6;function wH(e){return Math.floor((e+Math.round(128/xH)/256)*xH)}function _H(e){return Math.floor((e-5)/xH*100+.5)/100}function SH(e){return Math.round((e*xH+5)/xH*256)/256}function MH(e){return SH(_H(wH(e)))}function TH(e){var t=Math.abs(e-MH(e)),a=xH;if(t>.005)for(xH=1;xH<15;++xH)Math.abs(e-MH(e))<=t&&(t=Math.abs(e-MH(e)),a=xH);xH=a}function kH(e){e.width?(e.wpx=wH(e.width),e.wch=_H(e.wpx),e.MDW=xH):e.wpx?(e.wch=_H(e.wpx),e.width=SH(e.wch),e.MDW=xH):"number"==typeof e.wch&&(e.width=SH(e.wch),e.wpx=wH(e.width),e.MDW=xH),e.customWidth&&delete e.customWidth}var CH=96;function AH(e){return 96*e/CH}function EH(e){return e*CH/96}var IH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var RH=["numFmtId","fillId","fontId","borderId","xfId"],DH=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var PH=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,r=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,o,s){var l,c={};return i?((l=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,a){t.NumberFmt=[];for(var n=AO(zN),r=0;r<n.length;++r)t.NumberFmt[n[r]]=zN[n[r]];var i=e[0].match(uF);if(i)for(r=0;r<i.length;++r){var o=pF(i[r]);switch(fF(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var s=gF(IF(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=s}bO(s,l)}break;default:if(a.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}(l,c,s),(l=i.match(n))&&function(e,t,a,n){t.Fonts=[];var r={},i=!1;(e[0].match(uF)||[]).forEach(function(e){var o=pF(e);switch(fF(o[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(r),r={};break;case"<name":o.val&&(r.name=IF(o.val));break;case"<b":r.bold=o.val?TF(o.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=o.val?TF(o.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(o.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=o.val?TF(o.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=o.val?TF(o.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=o.val?TF(o.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=o.val?TF(o.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=o.val?TF(o.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":o.val&&(r.sz=+o.val);break;case"<vertAlign":o.val&&(r.vertAlign=o.val);break;case"<family":o.val&&(r.family=parseInt(o.val,10));break;case"<scheme":o.val&&(r.scheme=o.val);break;case"<charset":if("1"==o.val)break;o.codepage=sN[parseInt(o.val,10)];break;case"<color":if(r.color||(r.color={}),o.auto&&(r.color.auto=TF(o.auto)),o.rgb)r.color.rgb=o.rgb.slice(-6);else if(o.indexed){r.color.index=parseInt(o.indexed,10);var s=$U[r.color.index];81==r.color.index&&(s=$U[1]),s||(s=$U[1]),r.color.rgb=s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}else o.theme&&(r.color.theme=parseInt(o.theme,10),o.tint&&(r.color.tint=parseFloat(o.tint)),o.theme&&a.themeElements&&a.themeElements.clrScheme&&(r.color.rgb=bH(a.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}(l,c,o,s),(l=i.match(a))&&function(e,t,a,n){t.Fills=[];var r={},i=!1;(e[0].match(uF)||[]).forEach(function(e){var a=pF(e);switch(fF(a[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r={},t.Fills.push(r);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":a.patternType&&(r.patternType=a.patternType);break;case"<bgColor":r.bgColor||(r.bgColor={}),a.indexed&&(r.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(r.bgColor.theme=parseInt(a.theme,10)),a.tint&&(r.bgColor.tint=parseFloat(a.tint)),a.rgb&&(r.bgColor.rgb=a.rgb.slice(-6));break;case"<fgColor":r.fgColor||(r.fgColor={}),a.theme&&(r.fgColor.theme=parseInt(a.theme,10)),a.tint&&(r.fgColor.tint=parseFloat(a.tint)),null!=a.rgb&&(r.fgColor.rgb=a.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in fills")}})}(l,c,0,s),(l=i.match(r))&&function(e,t,a,n){t.Borders=[];var r={},i=!1;(e[0].match(uF)||[]).forEach(function(e){var a=pF(e);switch(fF(a[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":r={},a.diagonalUp&&(r.diagonalUp=TF(a.diagonalUp)),a.diagonalDown&&(r.diagonalDown=TF(a.diagonalDown)),t.Borders.push(r);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in borders")}})}(l,c,0,s),(l=i.match(t))&&function(e,t,a){var n;t.CellXf=[];var r=!1;(e[0].match(uF)||[]).forEach(function(e){var i=pF(e),o=0;switch(fF(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=i)[0],o=0;o<RH.length;++o)n[RH[o]]&&(n[RH[o]]=parseInt(n[RH[o]],10));for(o=0;o<DH.length;++o)n[DH[o]]&&(n[DH[o]]=TF(n[DH[o]]));if(t.NumberFmt&&n.numFmtId>392)for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var s={};i.vertical&&(s.vertical=i.vertical),i.horizontal&&(s.horizontal=i.horizontal),null!=i.textRotation&&(s.textRotation=i.textRotation),i.indent&&(s.indent=i.indent),i.wrapText&&(s.wrapText=TF(i.wrapText)),n.alignment=s;break;case"<AlternateContent":case"<ext":r=!0;break;case"</AlternateContent>":case"</ext>":r=!1;break;default:if(a&&a.WTF&&!r)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}(l,c,s),c):c}}();function LH(e,t){var a,n=[sF,VF("styleSheet",null,{xmlns:rB[0],"xmlns:vt":tB})];return e.SSF&&null!=(a=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)null!=e[n]&&(t[t.length]=VF("numFmt",null,{numFmtId:n,formatCode:xF(e[n])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=VF("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(n[n.length]=a),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=function(e){var t=[];return t[t.length]=VF("cellXfs",null),e.forEach(function(e){t[t.length]=VF("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=VF("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(n[n.length]=a),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function NH(e,t,a){a||(a=jB(6+4*t.length)),a.write_shift(2,e),gU(t,a);var n=a.length>a.l?a.slice(0,a.l):a;return null==a.l&&(a.l=a.length),n}function OH(e,t){t||(t=jB(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=jB(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,a),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var a=0;"superscript"==e.vertAlign?a=1:"subscript"==e.vertAlign&&(a=2),t.write_shift(2,a),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),zU(e.color,t);return t.write_shift(1,2),gU(e.name,t),t.length>t.l?t.slice(0,t.l):t}var FH,BH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],UH=YB;function zH(e,t){t||(t=jB(84)),FH||(FH=IO(BH));var a=FH[e.patternType];null==a&&(a=40),t.write_shift(4,a);var n=0;if(40!=a)for(zU({auto:1},t),zU({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function VH(e,t,a){a||(a=jB(16)),a.write_shift(2,t||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);return a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function HH(e,t){return t||(t=jB(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var GH=YB;function WH(e){var t;KB(e,613,mU(1)),KB(e,46,(t||(t=jB(51)),t.write_shift(1,0),HH(0,t),HH(0,t),HH(0,t),HH(0,t),HH(0,t),t.length>t.l?t.slice(0,t.l):t)),KB(e,614)}function qH(e){var t,a;KB(e,619,mU(1)),KB(e,48,(t={xfId:0,name:"Normal"},a||(a=jB(52)),a.write_shift(4,t.xfId),a.write_shift(2,1),a.write_shift(1,0),a.write_shift(1,0),EU(t.name||"",a),a.length>a.l?a.slice(0,a.l):a)),KB(e,620)}function YH(e){KB(e,508,function(e,t,a){var n=jB(2052);return n.write_shift(4,e),EU(t,n),EU(a,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),KB(e,509)}function jH(e,t){var a=$B();return KB(a,278),function(e,t){if(t){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++a}),0!=a&&(KB(e,615,mU(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)null!=t[n]&&KB(e,44,NH(n,t[n]))}),KB(e,616))}}(a,e.SSF),function(e){KB(e,611,mU(1)),KB(e,43,OH({sz:12,color:{theme:1},name:"Calibri",family:2})),KB(e,612)}(a),function(e){KB(e,603,mU(2)),KB(e,45,zH({patternType:"none"})),KB(e,45,zH({patternType:"gray125"})),KB(e,604)}(a),WH(a),function(e){KB(e,626,mU(1)),KB(e,47,VH({numFmtId:0},65535)),KB(e,627)}(a),function(e,t){KB(e,617,mU(t.length)),t.forEach(function(t){KB(e,47,VH(t,0))}),KB(e,618)}(a,t.cellXfs),qH(a),function(e){KB(e,505,mU(0)),KB(e,506)}(a),YH(a),KB(a,279),a.end()}var XH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $H(e,t,a){t.themeElements.clrScheme=[];var n={};(e[0].match(uF)||[]).forEach(function(e){var r=pF(e);switch(r[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=r.val;break;case"<a:sysClr":n.rgb=r.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===r[0].charAt(1)?(t.themeElements.clrScheme[XH.indexOf(r[0])]=n,n={}):n.name=r[0].slice(3,r[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+r[0]+" in clrScheme")}})}function KH(){}function ZH(){}var JH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,QH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eG=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var tG=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function aG(e,t){var a;e&&0!==e.length||(e=nG());var n={};if(!(a=e.match(tG)))throw new Error("themeElements not found in theme");return function(e,t,a){var n;t.themeElements={},[["clrScheme",JH,$H],["fontScheme",QH,KH],["fmtScheme",eG,ZH]].forEach(function(r){if(!(n=e.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](n,t,a)})}(a[0],n,t),n.raw=e,n}function nG(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var a=[sF];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function rG(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return YB(e,t)}(e,4);break;case 2:t.xclrValue=nV(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function iG(e){var t=e.read_shift(2),a=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=rG(e);break;case 6:n[1]=function(e,t){return YB(e,t)}(e,a);break;case 14:case 15:n[1]=e.read_shift(1===a?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+a)}return n}function oG(e,t){t.forEach(function(e){e[0]})}function sG(){var e,t,a=$B();return KB(a,332),KB(a,334,mU(1)),KB(a,335,((t=jB(12+2*(e={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,e.flags),t.write_shift(4,e.version),gU(e.name,t),t.slice(0,t.l))),KB(a,336),KB(a,339,function(e,t){var a=jB(8+2*t.length);return a.write_shift(4,e),gU(t,a),a.slice(0,a.l)}(1,"XLDAPR")),KB(a,52),KB(a,35,mU(514)),KB(a,4096,mU(0)),KB(a,4097,Gz(1)),KB(a,36),KB(a,53),KB(a,340),KB(a,337,function(e){var t=jB(8);return t.write_shift(4,e),t.write_shift(4,1),t}(1)),KB(a,51,function(e){var t=jB(4+8*e.length);t.write_shift(4,e.length);for(var a=0;a<e.length;++a)t.write_shift(4,e[a][0]),t.write_shift(4,e[a][1]);return t}([[1,0]])),KB(a,338),KB(a,333),a.end()}function lG(){var e=[sF];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var cG=1024;function uG(e,t){for(var a=[21600,21600],n=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),r=[VF("xml",null,{"xmlns:v":uB,"xmlns:o":iB,"xmlns:x":oB,"xmlns:mv":cB}).replace(/\/>/,">"),VF("o:shapelayout",VF("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),VF("v:shapetype",[VF("v:stroke",null,{joinstyle:"miter"}),VF("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:n})];cG<1e3*e;)cG+=1e3;return t.forEach(function(e){var t=iU(e[0]),a={color2:"#BEFF82",type:"gradient"};"gradient"==a.type&&(a.angle="-180");var n="gradient"==a.type?VF("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=VF("v:fill",n,a);++cG,r=r.concat(["<v:shape"+zF({id:"_x0000_s"+cG,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,VF("v:shadow",null,{on:"t",obscured:"t"}),VF("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",UF("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),UF("x:AutoFill","False"),UF("x:Row",String(t.r)),UF("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function dG(e,t,a,n){var r,i=Array.isArray(e);t.forEach(function(t){var o=iU(t.ref);if(i?(e[o.r]||(e[o.r]=[]),r=e[o.r][o.c]):r=e[t.ref],!r){r={t:"z"},i?e[o.r][o.c]=r:e[t.ref]=r;var s=cU(e["!ref"]||"BDWGO1000001:A1");s.s.r>o.r&&(s.s.r=o.r),s.e.r<o.r&&(s.e.r=o.r),s.s.c>o.c&&(s.s.c=o.c),s.e.c<o.c&&(s.e.c=o.c);var l=lU(s);l!==e["!ref"]&&(e["!ref"]=l)}r.c||(r.c=[]);var c={a:t.author,t:t.t,r:t.r,T:a};t.h&&(c.h=t.h);for(var u=r.c.length-1;u>=0;--u){if(!a&&r.c[u].T)return;a&&!r.c[u].T&&r.c.splice(u,1)}if(a&&n)for(u=0;u<n.length;++u)if(c.a==n[u].id){c.a=n[u].name||c.a;break}r.c.push(c)})}function hG(e){var t=[sF,VF("comments",null,{xmlns:rB[0]})],a=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var n=xF(e.a);-1==a.indexOf(n)&&(a.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==a.indexOf("tc="+e.ID)&&(a.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==a.length&&(a.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var n=0,r=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?n=a.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(n=a.indexOf(xF(e.a))),r.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>'),r.length<=1)t.push(UF("t",xF(r[0]||"")));else{for(var i="Comment:\n    "+r[0]+"\n",o=1;o<r.length;++o)i+="Reply:\n    "+r[o]+"\n";t.push(UF("t",xF(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function pG(e,t,a){var n=[sF,VF("ThreadedComments",null,{xmlns:KF}).replace(/[\/]>/,">")];return e.forEach(function(e){var r="";(e[1]||[]).forEach(function(i,o){if(i.T){i.a&&-1==t.indexOf(i.a)&&t.push(i.a);var s={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};0==o?r=s.id:s.parentId=r,i.ID=s.id,i.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(VF("threadedComment",UF("text",i.t||""),s))}else delete i.ID})}),n.push("</ThreadedComments>"),n.join("")}var fG=vU;function mG(e){var t=$B(),a=[];return KB(t,628),KB(t,630),e.forEach(function(e){e[1].forEach(function(e){a.indexOf(e.a)>-1||(a.push(e.a.slice(0,54)),KB(t,632,function(e){return gU(e.slice(0,54))}(e.a)))})}),KB(t,631),KB(t,633),e.forEach(function(e){e[1].forEach(function(n){n.iauthor=a.indexOf(n.a);var r={s:iU(e[0]),e:iU(e[0])};KB(t,635,function(e,t){return null==t&&(t=jB(36)),t.write_shift(4,e[1].iauthor),FU(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([r,n])),n.t&&n.t.length>0&&KB(t,637,wU(n)),KB(t,636),delete n.iauthor})}),KB(t,634),KB(t,629),t.end()}var vG=["xlsb","xlsm","xlam","biff8","xla"];var gG=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function a(e,a,n,r){var i=!1,o=!1;0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1)),0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1));var s=n.length>0?0|parseInt(n,10):0,l=r.length>0?0|parseInt(r,10):0;return i?l+=t.c:--l,o?s+=t.r:--s,a+(i?"":"$")+rU(l)+(o?"":"$")+aU(s)}return function(n,r){return t=r,n.replace(e,a)}}(),yG=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bG=function(){return function(e,t){return e.replace(yG,function(e,a,n,r,i,o){var s=nU(r)-(n?0:t.c),l=tU(o)-(i?0:t.r);return a+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==s?"":n?s+1:"["+s+"]")})}}();function xG(e,t){return e.replace(yG,function(e,a,n,r,i,o){return a+("$"==n?n+r:rU(nU(r)+t.c))+("$"==i?i+o:aU(tU(o)+t.r))})}function wG(e,t,a){var n=sU(t).s,r=iU(a);return xG(e,{r:r.r-n.r,c:r.c-n.c})}function _G(e){return e.replace(/_xlfn\./g,"")}function SG(e){e.l+=1}function MG(e,t){var a=e.read_shift(2);return[16383&a,a>>14&1,a>>15&1]}function TG(e,t,a){var n=2;if(a){if(a.biff>=2&&a.biff<=5)return kG(e);12==a.biff&&(n=4)}var r=e.read_shift(n),i=e.read_shift(n),o=MG(e),s=MG(e);return{s:{r:r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function kG(e){var t=MG(e),a=MG(e),n=e.read_shift(1),r=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:a[0],c:r,cRel:a[1],rRel:a[2]}}}function CG(e,t,a){if(a&&a.biff>=2&&a.biff<=5)return function(e){var t=MG(e),a=e.read_shift(1);return{r:t[0],c:a,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(a&&12==a.biff?4:2),r=MG(e);return{r:n,c:r[0],cRel:r[1],rRel:r[2]}}function AG(e){var t=e.read_shift(2),a=e.read_shift(2);return{r:t,c:255&a,fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}}function EG(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function IG(e){return[e.read_shift(1),e.read_shift(1)]}function RG(e,t){var a=[e.read_shift(1)];if(12==t)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2}switch(a[0]){case 4:a[1]=zz(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:a[1]=KU[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:a[1]=BU(e);break;case 2:a[1]=Zz(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function DG(e,t,a){for(var n=e.read_shift(12==a.biff?4:2),r=[],i=0;i!=n;++i)r.push((12==a.biff?OU:cV)(e));return r}function PG(e,t,a){var n=0,r=0;12==a.biff?(n=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),n=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--n,0==--r&&(r=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var s=0;s!=r;++s)o[i][s]=RG(e,a.biff);return o}function LG(e,t,a){return e.l+=2,[AG(e)]}function NG(e){return e.l+=6,[]}function OG(e){return e.l+=2,[Hz(e),1&e.read_shift(2)]}var FG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var BG={1:{n:"PtgExp",f:function(e,t,a){return e.l++,a&&12==a.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(a&&2==a.biff?1:2)]}},2:{n:"PtgTbl",f:YB},3:{n:"PtgAdd",f:SG},4:{n:"PtgSub",f:SG},5:{n:"PtgMul",f:SG},6:{n:"PtgDiv",f:SG},7:{n:"PtgPower",f:SG},8:{n:"PtgConcat",f:SG},9:{n:"PtgLt",f:SG},10:{n:"PtgLe",f:SG},11:{n:"PtgEq",f:SG},12:{n:"PtgGe",f:SG},13:{n:"PtgGt",f:SG},14:{n:"PtgNe",f:SG},15:{n:"PtgIsect",f:SG},16:{n:"PtgUnion",f:SG},17:{n:"PtgRange",f:SG},18:{n:"PtgUplus",f:SG},19:{n:"PtgUminus",f:SG},20:{n:"PtgPercent",f:SG},21:{n:"PtgParen",f:SG},22:{n:"PtgMissArg",f:SG},23:{n:"PtgStr",f:function(e,t,a){return e.l++,Yz(e,0,a)}},26:{n:"PtgSheet",f:function(e,t,a){return e.l+=5,e.l+=2,e.l+=2==a.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,a){return e.l+=2==a.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,KU[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,BU(e)}},32:{n:"PtgArray",f:function(e,t,a){var n=(96&e[e.l++])>>5;return e.l+=2==a.biff?6:12==a.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,a){var n=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(a&&a.biff<=3?1:2);return[oW[r],iW[r],n]}},34:{n:"PtgFuncVar",f:function(e,t,a){var n=e[e.l++],r=e.read_shift(1),i=a&&a.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[r,(0===i[0]?iW:rW)[i[1]]]}},35:{n:"PtgName",f:function(e,t,a){var n=e.read_shift(1)>>>5&3,r=!a||a.biff>=8?4:2,i=e.read_shift(r);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,i]}},36:{n:"PtgRef",f:function(e,t,a){var n=(96&e[e.l])>>5;return e.l+=1,[n,CG(e,0,a)]}},37:{n:"PtgArea",f:function(e,t,a){return[(96&e[e.l++])>>5,TG(e,a.biff>=2&&a.biff,a)]}},38:{n:"PtgMemArea",f:function(e,t,a){var n=e.read_shift(1)>>>5&3;return e.l+=a&&2==a.biff?3:4,[n,e.read_shift(a&&2==a.biff?1:2)]}},39:{n:"PtgMemErr",f:YB},40:{n:"PtgMemNoMem",f:YB},41:{n:"PtgMemFunc",f:function(e,t,a){return[e.read_shift(1)>>>5&3,e.read_shift(a&&2==a.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,a){var n=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,12==a.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,a){var n=(96&e[e.l++])>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,a){var n=(96&e[e.l])>>5;e.l+=1;var r=function(e,t,a){var n=a&&a.biff?a.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),a=e.read_shift(1),n=(32768&t)>>15,r=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==r&&a>=128&&(a-=256),{r:t,c:a,cRel:r,rRel:n}}(e);var r=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(16384&i)>>14,s=(32768&i)>>15;if(i&=16383,1==s)for(;r>524287;)r-=1048576;if(1==o)for(;i>8191;)i-=16384;return{r:r,c:i,cRel:o,rRel:s}}(e,0,a);return[n,r]}},45:{n:"PtgAreaN",f:function(e,t,a){var n=(96&e[e.l++])>>5,r=function(e,t,a){if(a.biff<8)return kG(e);var n=e.read_shift(12==a.biff?4:2),r=e.read_shift(12==a.biff?4:2),i=MG(e),o=MG(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:r,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,a);return[n,r]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,a){return 5==a.biff?function(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,a,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,a){var n=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(2);return a&&5==a.biff&&(e.l+=12),[n,r,CG(e,0,a)]}},59:{n:"PtgArea3d",f:function(e,t,a){var n=(96&e[e.l++])>>5,r=e.read_shift(2,"i");if(a)switch(a.biff){case 5:e.l+=12;break;case 12:0}return[n,r,TG(e,0,a)]}},60:{n:"PtgRefErr3d",f:function(e,t,a){var n=(96&e[e.l++])>>5,r=e.read_shift(2),i=4;if(a)switch(a.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[n,r]}},61:{n:"PtgAreaErr3d",f:function(e,t,a){var n=(96&e[e.l++])>>5,r=e.read_shift(2),i=8;if(a)switch(a.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[n,r]}},255:{}},UG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zG={1:{n:"PtgElfLel",f:OG},2:{n:"PtgElfRw",f:LG},3:{n:"PtgElfCol",f:LG},6:{n:"PtgElfRwV",f:LG},7:{n:"PtgElfColV",f:LG},10:{n:"PtgElfRadical",f:LG},11:{n:"PtgElfRadicalS",f:NG},13:{n:"PtgElfColS",f:NG},15:{n:"PtgElfColSV",f:NG},16:{n:"PtgElfRadicalLel",f:OG},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(4),r=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&a,rt:FG[a>>2&31],idx:n,c:r,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},VG={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,a){var n=255&e[e.l+1]?1:0;return e.l+=a&&2==a.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,a){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(a&&2==a.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,a){e.l+=2;for(var n=e.read_shift(a&&2==a.biff?1:2),r=[],i=0;i<=n;++i)r.push(e.read_shift(a&&2==a.biff?1:2));return r}},8:{n:"PtgAttrGoto",f:function(e,t,a){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(a&&2==a.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,a){e.l+=a&&2==a.biff?3:4}},32:{n:"PtgAttrBaxcel",f:EG},33:{n:"PtgAttrBaxcel",f:EG},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),IG(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),IG(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function HG(e,t,a,n){if(n.biff<8)return YB(e,t);for(var r=e.l+t,i=[],o=0;o!==a.length;++o)switch(a[o][0]){case"PtgArray":a[o][1]=PG(e,0,n),i.push(a[o][1]);break;case"PtgMemArea":a[o][2]=DG(e,a[o][1],n),i.push(a[o][2]);break;case"PtgExp":n&&12==n.biff&&(a[o][1][1]=e.read_shift(4),i.push(a[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[o][0]}return 0!==(t=r-e.l)&&i.push(YB(e,t)),i}function GG(e,t,a){for(var n,r,i=e.l+t,o=[];i!=e.l;)t=i-e.l,r=e[e.l],n=BG[r]||BG[UG[r]],24!==r&&25!==r||(n=(24===r?zG:VG)[e[e.l+1]]),n&&n.f?o.push([n.n,n.f(e,t,a)]):YB(e,t);return o}function WG(e){for(var t=[],a=0;a<e.length;++a){for(var n=e[a],r=[],i=0;i<n.length;++i){var o=n[i];if(o)if(2===o[0])r.push('"'+o[1].replace(/"/g,'""')+'"');else r.push(o[1]);else r.push("")}t.push(r.join(","))}return t.join(";")}var qG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function YG(e,t,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(a.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var r="";if(a.biff>8)switch(e[n[0]][0]){case 357:return r=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?r:r+":"+e.SheetNames[n[2]];case 358:return null!=a.SID?e.SheetNames[a.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return r=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?r:r+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(r=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?r:r+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function jG(e,t,a){var n=YG(e,t,a);return"#REF"==n?n:function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,a)}function XG(e,t,a,n,r){var i,o,s,l,c=r&&r.biff||8,u={s:{c:0,r:0}},d=[],h=0,p=0,f="";if(!e[0]||!e[0][0])return"";for(var m=-1,v="",g=0,y=e[0].length;g<y;++g){var b=e[0][g];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=d.pop(),o=d.pop(),m>=0){switch(e[0][m][1][0]){case 0:v=qO(" ",e[0][m][1][1]);break;case 1:v=qO("\r",e[0][m][1][1]);break;default:if(v="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}o+=v,m=-1}d.push(o+qG[b[0]]+i);break;case"PtgIsect":i=d.pop(),o=d.pop(),d.push(o+" "+i);break;case"PtgUnion":i=d.pop(),o=d.pop(),d.push(o+","+i);break;case"PtgRange":i=d.pop(),o=d.pop(),d.push(o+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=ZB(b[1][1],u,r),d.push(QB(s,c));break;case"PtgRefN":s=a?ZB(b[1][1],a,r):b[1][1],d.push(QB(s,c));break;case"PtgRef3d":h=b[1][1],s=ZB(b[1][2],u,r),f=jG(n,h,r),d.push(f+"!"+QB(s,c));break;case"PtgFunc":case"PtgFuncVar":var x=b[1][0],w=b[1][1];x||(x=0);var _=0==(x&=127)?[]:d.slice(-x);d.length-=x,"User"===w&&(w=_.shift()),d.push(w+"("+_.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=JB(b[1][1],a?{s:a}:u,r),d.push(eU(l,r));break;case"PtgArea":l=JB(b[1][1],u,r),d.push(eU(l,r));break;case"PtgArea3d":h=b[1][1],l=b[1][2],f=jG(n,h,r),d.push(f+"!"+eU(l,r));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":p=b[1][2];var S=(n.names||[])[p-1]||(n[0]||[])[p],M=S?S.Name:"SH33TJSNAME"+String(p);M&&"_xlfn."==M.slice(0,6)&&!r.xlfn&&(M=M.slice(6)),d.push(M);break;case"PtgNameX":var T,k=b[1][1];if(p=b[1][2],!(r.biff<=5)){var C="";if(14849==((n[k]||[])[0]||[])[0]||(1025==((n[k]||[])[0]||[])[0]?n[k][p]&&n[k][p].itab>0&&(C=n.SheetNames[n[k][p].itab-1]+"!"):C=n.SheetNames[p-1]+"!"),n[k]&&n[k][p])C+=n[k][p].Name;else if(n[0]&&n[0][p])C+=n[0][p].Name;else{var A=(YG(n,k,r)||"").split(";;");A[p-1]?C=A[p-1]:C+="SH33TJSERRX"}d.push(C);break}k<0&&(k=-k),n[k]&&(T=n[k][p]),T||(T={Name:"SH33TJSERRY"}),d.push(T.Name);break;case"PtgParen":var E="(",I=")";if(m>=0){switch(v="",e[0][m][1][0]){case 2:E=qO(" ",e[0][m][1][1])+E;break;case 3:E=qO("\r",e[0][m][1][1])+E;break;case 4:I=qO(" ",e[0][m][1][1])+I;break;case 5:I=qO("\r",e[0][m][1][1])+I;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}d.push(E+d.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":s={c:b[1][1],r:b[1][0]};var R={c:a.c,r:a.r};if(n.sharedf[oU(s)]){var D=n.sharedf[oU(s)];d.push(XG(D,u,R,n,r))}else{var P=!1;for(i=0;i!=n.arrayf.length;++i)if(o=n.arrayf[i],!(s.c<o[0].s.c||s.c>o[0].e.c||s.r<o[0].s.r||s.r>o[0].e.r)){d.push(XG(o[1],u,R,n,r)),P=!0;break}P||d.push(b[1])}break;case"PtgArray":d.push("{"+WG(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=r.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var L=!0;switch((b=e[0][m])[1][0]){case 4:L=!1;case 0:v=qO(" ",b[1][1]);break;case 5:L=!1;case 1:v=qO("\r",b[1][1]);break;default:if(v="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((L?v:"")+d.pop()+(L?"":v)),m=-1}}if(d.length>1&&r.WTF)throw new Error("bad formula stack");return d[0]}function $G(e,t,a){var n,r=e.l+t,i=2==a.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],YB(e,t-2)];var s=GG(e,o,a);return t!==o+i&&(n=HG(e,t-o-i,s,a)),e.l=r,[s,n]}function KG(e,t,a){var n,r=e.l+t,i=e.read_shift(2),o=GG(e,i,a);return 65535==i?[[],YB(e,t-2)]:(t!==i+2&&(n=HG(e,r-i-2,o,a)),[o,n])}function ZG(e,t,a){var n=e.l+t,r=iV(e);2==a.biff&&++e.l;var i=function(e){var t;if(65535!==LB(e,e.l+6))return[BU(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),o=e.read_shift(1);2!=a.biff&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var s=function(e,t,a){var n,r=e.l+t,i=2==a.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],YB(e,t-2)];var s=GG(e,o,a);return t!==o+i&&(n=HG(e,t-o-i,s,a)),e.l=r,[s,n]}(e,n-e.l,a);return{cell:r,val:i[0],formula:s,shared:o>>3&1,tt:i[1]}}function JG(e,t,a,n,r){var i=oV(t,a,r),o=function(e){if(null==e){var t=jB(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return UU("number"==typeof e?e:0)}(e.v),s=jB(6);s.write_shift(2,33),s.write_shift(4,0);for(var l=jB(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return AN([i,o,s,l])}function QG(e,t,a){var n=e.read_shift(4),r=GG(e,n,a),i=e.read_shift(4);return[r,i>0?HG(e,i,r,a):null]}var eW=QG,tW=QG,aW=QG,nW=QG,rW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},iW={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sW(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function lW(e){return("of:="+e.replace(yG,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function cW(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function uW(e){return e.replace(/\./,"!")}var dW={},hW={},pW="undefined"!=typeof Map;function fW(e,t,a){var n=0,r=e.length;if(a){if(pW?a.has(t):Object.prototype.hasOwnProperty.call(a,t))for(var i=pW?a.get(t):a[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}else for(;n<r;++n)if(e[n].t===t)return e.Count++,n;return e[r]={t:t},e.Count++,e.Unique++,a&&(pW?(a.has(t)||a.set(t,[]),a.get(t).push(r)):(Object.prototype.hasOwnProperty.call(a,t)||(a[t]=[]),a[t].push(r))),r}function mW(e,t){var a={min:e+1,max:e+1},n=-1;return t.MDW&&(xH=t.MDW),null!=t.width?a.customWidth=1:null!=t.wpx?n=_H(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(a.width=SH(n),a.customWidth=1):null!=t.width&&(a.width=t.width),t.hidden&&(a.hidden=!0),null!=t.level&&(a.outlineLevel=a.level=t.level),a}function vW(e,t){if(e){var a=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(a=[1,1,1,1,.5,.5]),null==e.left&&(e.left=a[0]),null==e.right&&(e.right=a[1]),null==e.top&&(e.top=a[2]),null==e.bottom&&(e.bottom=a[3]),null==e.header&&(e.header=a[4]),null==e.footer&&(e.footer=a[5])}}function gW(e,t,a){var n=a.revssf[null!=t.z?t.z:"General"],r=60,i=e.length;if(null==n&&a.ssf)for(;r<392;++r)if(null==a.ssf[r]){bO(t.z,r),a.ssf[r]=t.z,a.revssf[t.z]=n=r;break}for(r=0;r!=i;++r)if(e[r].numFmtId===n)return r;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function yW(e,t,a,n,r,i){try{n.cellNF&&(e.z=zN[t])}catch(TQe){if(n.WTF)throw TQe}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=HO(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==zN[t]&&bO(_O[t]||"General",t),"e"===e.t)e.w=e.w||KU[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=KN(e.v);else if("d"===e.t){var o=PO(e.v);e.w=(0|o)===o?o.toString(10):KN(o)}else{if(void 0===e.v)return"";e.w=ZN(e.v,hW)}else"d"===e.t?e.w=yO(t,PO(e.v),hW):e.w=yO(t,e.v,hW)}catch(TQe){if(n.WTF)throw TQe}if(n.cellStyles&&null!=a)try{e.s=i.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=bH(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=bH(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(TQe){if(n.WTF&&i.Fills)throw TQe}}}function bW(e,t,a){if(e&&e["!ref"]){var n=cU(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}var xW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,wW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_W=/<(?:\w:)?hyperlink [^>]*>/gm,SW=/"(\w*:\w*)"/,MW=/<(?:\w:)?col\b[^>]*[\/]?>/g,TW=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,kW=/<(?:\w:)?pageMargins[^>]*\/>/g,CW=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,AW=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,EW=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function IW(e,t,a,n,r,i,o){if(!e)return e;n||(n={"!id":{}});var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(wW);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(CW);h?RW(h[0],s,r,a):(h=c.match(AW))&&function(e,t,a,n,r){RW(e.slice(0,e.indexOf(">")),a,n,r)}(h[0],h[1],s,r,a);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var f=c.slice(p,p+50).match(SW);f&&function(e,t){var a=cU(t);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=lU(a))}(s,f[1])}var m=c.match(EW);m&&m[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(LW)||[]).forEach(function(e,a){var n=pF(e);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),TF(n.rightToLeft)&&(t.Views[a].RTL=!0)})}(m[1],r);var v=[];if(t.cellStyles){var g=c.match(MW);g&&function(e,t){for(var a=!1,n=0;n!=t.length;++n){var r=pF(t[n],!0);r.hidden&&(r.hidden=TF(r.hidden));var i=parseInt(r.min,10)-1,o=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!a&&r.width&&(a=!0,TH(r.width)),kH(r);i<=o;)e[i++]=WO(r)}}(v,g)}d&&OW(d[1],s,t,l,i,o);var y=u.match(TW);y&&(s["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],x=u.match(xW);if(x)for(p=0;p!=x.length;++p)b[p]=cU(x[p].slice(x[p].indexOf('"')+1));var w=u.match(_W);w&&function(e,t,a){for(var n=Array.isArray(e),r=0;r!=t.length;++r){var i=pF(IF(t[r]),!0);if(!i.ref)return;var o=((a||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+gF(i.location))):(i.Target="#"+gF(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var s=cU(i.ref),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var u=oU({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(s,w,n);var _,S,M=u.match(kW);if(M&&(s["!margins"]=(_=pF(M[0]),S={},["left","right","top","bottom","header","footer"].forEach(function(e){_[e]&&(S[e]=parseFloat(_[e]))}),S)),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=lU(l)),t.sheetRows>0&&s["!ref"]){var T=cU(s["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),s["!fullref"]=s["!ref"],s["!ref"]=lU(T))}return v.length>0&&(s["!cols"]=v),b.length>0&&(s["!merges"]=b),s}function RW(e,t,a,n){var r=pF(e);a.Sheets[n]||(a.Sheets[n]={}),r.codeName&&(a.Sheets[n].CodeName=gF(IF(r.codeName)))}var DW=["objects","scenarios","selectLockedCells","selectUnlockedCells"],PW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var LW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function NW(e,t,a,n){if(e.c&&a["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var r="",i=e.t,o=e.v;if("z"!==e.t)switch(e.t){case"b":r=e.v?"1":"0";break;case"n":r=""+e.v;break;case"e":r=KU[e.v];break;case"d":n&&n.cellDates?r=HO(e.v,-1).toISOString():((e=WO(e)).t="n",r=""+(e.v=PO(HO(e.v)))),void 0===e.z&&(e.z=zN[14]);break;default:r=e.v}var s=UF("v",xF(r)),l={r:t},c=gW(n.cellXfs,e,n);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){s=UF("v",""+fW(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=o),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=VF("f",xF(e.f),u)+(null!=e.v?s:"")}return e.l&&a["!links"].push([t,e.l]),e.D&&(l.cm=1),VF("c",s,l)}var OW=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,i=DF("v"),o=DF("f");return function(s,l,c,u,d,h){for(var p,f,m,v,g,y=0,b="",x=[],w=[],_=0,S=0,M=0,T="",k=0,C=0,A=0,E=0,I=Array.isArray(h.CellXf),R=[],D=[],P=Array.isArray(l),L=[],N={},O=!1,F=!!c.sheetStubs,B=s.split(t),U=0,z=B.length;U!=z;++U){var V=(b=B[U].trim()).length;if(0!==V){var H=0;e:for(y=0;y<V;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(c&&c.cellStyles){if(k=null!=(f=pF(b.slice(H,y),!0)).r?parseInt(f.r,10):k+1,C=-1,c.sheetRows&&c.sheetRows<k)continue;N={},O=!1,f.ht&&(O=!0,N.hpt=parseFloat(f.ht),N.hpx=EH(N.hpt)),"1"==f.hidden&&(O=!0,N.hidden=!0),null!=f.outlineLevel&&(O=!0,N.level=+f.outlineLevel),O&&(L[k-1]=N)}break;case"<":H=y}if(H>=y)break;if(k=null!=(f=pF(b.slice(H,y),!0)).r?parseInt(f.r,10):k+1,C=-1,!(c.sheetRows&&c.sheetRows<k)){u.s.r>k-1&&(u.s.r=k-1),u.e.r<k-1&&(u.e.r=k-1),c&&c.cellStyles&&(N={},O=!1,f.ht&&(O=!0,N.hpt=parseFloat(f.ht),N.hpx=EH(N.hpt)),"1"==f.hidden&&(O=!0,N.hidden=!0),null!=f.outlineLevel&&(O=!0,N.level=+f.outlineLevel),O&&(L[k-1]=N)),x=b.slice(y).split(e);for(var G=0;G!=x.length&&"<"==x[G].trim().charAt(0);++G);for(x=x.slice(G),y=0;y!=x.length;++y)if(0!==(b=x[y].trim()).length){if(w=b.match(a),_=y,S=0,M=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=w&&2===w.length){for(_=0,T=w[1],S=0;S!=T.length&&!((M=T.charCodeAt(S)-64)<1||M>26);++S)_=26*_+M;C=--_}else++C;for(S=0;S!=b.length&&62!==b.charCodeAt(S);++S);if(++S,(f=pF(b.slice(0,S),!0)).r||(f.r=oU({r:k-1,c:C})),p={t:""},null!=(w=(T=b.slice(S)).match(i))&&""!==w[1]&&(p.v=gF(w[1])),c.cellFormula){if(null!=(w=T.match(o))&&""!==w[1]){if(p.f=gF(IF(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(p.f=_G(p.f)),w[0].indexOf('t="array"')>-1)p.F=(T.match(r)||[])[1],p.F.indexOf(":")>-1&&R.push([cU(p.F),p.F]);else if(w[0].indexOf('t="shared"')>-1){v=pF(w[0]);var W=gF(IF(w[1]));c.xlfn||(W=_G(W)),D[parseInt(v.si,10)]=[v,W,f.r]}}else(w=T.match(/<f[^>]*\/>/))&&D[(v=pF(w[0])).si]&&(p.f=wG(D[v.si][1],D[v.si][2],f.r));var q=iU(f.r);for(S=0;S<R.length;++S)q.r>=R[S][0].s.r&&q.r<=R[S][0].e.r&&q.c>=R[S][0].s.c&&q.c<=R[S][0].e.c&&(p.F=R[S][1])}if(null==f.t&&void 0===p.v)if(p.f||p.F)p.v=0,p.t="n";else{if(!F)continue;p.t="z"}else p.t=f.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),p.t){case"n":if(""==p.v||null==p.v){if(!F)continue;p.t="z"}else p.v=parseFloat(p.v);break;case"s":if(void 0===p.v){if(!F)continue;p.t="z"}else m=dW[parseInt(p.v,10)],p.v=m.t,p.r=m.r,c.cellHTML&&(p.h=m.h);break;case"str":p.t="s",p.v=null!=p.v?IF(p.v):"",c.cellHTML&&(p.h=SF(p.v));break;case"inlineStr":w=T.match(n),p.t="s",null!=w&&(m=KV(w[1]))?(p.v=m.t,c.cellHTML&&(p.h=m.h)):p.v="";break;case"b":p.v=TF(p.v);break;case"d":c.cellDates?p.v=HO(p.v,1):(p.v=PO(HO(p.v,1)),p.t="n");break;case"e":c&&!1===c.cellText||(p.w=p.v),p.v=ZU[p.v]}if(A=E=0,g=null,I&&void 0!==f.s&&null!=(g=h.CellXf[f.s])&&(null!=g.numFmtId&&(A=g.numFmtId),c.cellStyles&&null!=g.fillId&&(E=g.fillId)),yW(p,A,E,c,d,h),c.cellDates&&I&&"n"==p.t&&fO(zN[A])&&(p.t="d",p.v=FO(p.v)),f.cm&&c.xlmeta){var Y=(c.xlmeta.Cell||[])[+f.cm-1];Y&&"XLDAPR"==Y.type&&(p.D=!0)}if(P){var j=iU(f.r);l[j.r]||(l[j.r]=[]),l[j.r][j.c]=p}else l[f.r]=p}}}}L.length>0&&(l["!rows"]=L)}}();function FW(e,t,a,n){var r,i=[sF,VF("worksheet",null,{xmlns:rB[0],"xmlns:r":eB})],o=a.SheetNames[e],s="",l=a.Sheets[o];null==l&&(l={});var c=l["!ref"]||"A1",u=cU(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=lU(u)}n||(n={}),l["!comments"]=[];var d=[];!function(e,t,a,n,r){var i=!1,o={},s=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[a];try{t.Workbook&&(l=t.Workbook.Sheets[a].CodeName||l)}catch(TQe){}i=!0,o.codeName=RF(xF(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),s=(s||"")+VF("outlinePr",null,c)}(i||s)&&(r[r.length]=VF("sheetPr",s,o))}(l,a,e,t,i),i[i.length]=VF("dimension",null,{ref:c}),i[i.length]=function(e,t,a,n){var r={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),VF("sheetViews",VF("sheetView",null,r),{})}(0,0,0,a),t.sheetFormat&&(i[i.length]=VF("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,t){for(var a,n=["<cols>"],r=0;r!=t.length;++r)(a=t[r])&&(n[n.length]=VF("col",null,mW(r,a)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),i[r=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function(e,t){var a,n,r=[],i=[],o=cU(e["!ref"]),s="",l="",c=[],u=0,d=0,h=e["!rows"],p=Array.isArray(e),f={r:l},m=-1;for(d=o.s.c;d<=o.e.c;++d)c[d]=rU(d);for(u=o.s.r;u<=o.e.r;++u){for(i=[],l=aU(u),d=o.s.c;d<=o.e.c;++d){a=c[d]+l;var v=p?(e[u]||[])[d]:e[a];void 0!==v&&null!=(s=NW(v,a,e,t))&&i.push(s)}(i.length>0||h&&h[u])&&(f={r:l},h&&h[u]&&((n=h[u]).hidden&&(f.hidden=1),m=-1,n.hpx?m=AH(n.hpx):n.hpt&&(m=n.hpt),m>-1&&(f.ht=m,f.customHeight=1),n.level&&(f.outlineLevel=n.level)),r[r.length]=VF("row",i.join(""),f))}if(h)for(;u<h.length;++u)h&&h[u]&&(f={r:u+1},(n=h[u]).hidden&&(f.hidden=1),m=-1,n.hpx?m=AH(n.hpx):n.hpt&&(m=n.hpt),m>-1&&(f.ht=m,f.customHeight=1),n.level&&(f.outlineLevel=n.level),r[r.length]=VF("row","",f));return r.join("")}(l,t),s.length>0&&(i[i.length]=s)),i.length>r+1&&(i[i.length]="</sheetData>",i[r]=i[r].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var t={sheet:1};return DW.forEach(function(a){null!=e[a]&&e[a]&&(t[a]="1")}),PW.forEach(function(a){null==e[a]||e[a]||(t[a]="0")}),e.password&&(t.password=pH(e.password).toString(16).toUpperCase()),VF("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,t,a,n){var r="string"==typeof e.ref?e.ref:lU(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var i=a.Workbook.Names,o=sU(r);o.s.r==o.e.r&&(o.e.r=sU(t["!ref"]).e.r,r=lU(o));for(var s=0;s<i.length;++s){var l=i[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+a.SheetNames[n]+"'!"+r;break}}return s==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+a.SheetNames[n]+"'!"+r}),VF("autoFilter",null,{ref:r})}(l["!autofilter"],l,a,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)t+='<mergeCell ref="'+lU(e[a])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,p,f=-1,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=iz(n,-1,xF(e[1].Target).replace(/#.*$/,""),tz.HLINK),h["r:id"]="rId"+m),(f=e[1].Target.indexOf("#"))>-1&&(h.location=xF(e[1].Target.slice(f+1))),e[1].Tooltip&&(h.tooltip=xF(e[1].Tooltip)),i[i.length]=VF("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(vW(p=l["!margins"]),VF("pageMargins",null,p))),t&&!t.ignoreEC&&null!=t.ignoreEC||(i[i.length]=UF("ignoredErrors",VF("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(m=iz(n,-1,"../drawings/drawing"+(e+1)+".xml",tz.DRAW),i[i.length]=VF("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=d),l["!comments"].length>0&&(m=iz(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",tz.VML),i[i.length]=VF("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function BW(e,t,a,n){var r=function(e,t,a){var n=jB(145),r=(a["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;r.hpx?i=20*AH(r.hpx):r.hpt&&(i=20*r.hpt),n.write_shift(2,i),n.write_shift(1,0);var o=0;r.level&&(o|=r.level),r.hidden&&(o|=16),(r.hpx||r.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var s=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,p=u<<10;p<u+1<<10;++p)c.c=p,(Array.isArray(a)?(a[c.r]||[])[c.c]:a[oU(c)])&&(d<0&&(d=p),h=p);d<0||(++s,n.write_shift(4,d),n.write_shift(4,h))}var f=n.l;return n.l=l,n.write_shift(4,s),n.l=f,n.length>n.l?n.slice(0,n.l):n}(n,a,t);(r.length>17||(t["!rows"]||[])[n])&&KB(e,0,r)}var UW=OU,zW=FU;function VW(e){return[MU(e),BU(e),"n"]}var HW=OU,GW=FU;var WW=["left","right","top","bottom","header","footer"];function qW(e,t,a,n,r,i,o){if(void 0===t.v)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=WO(t)).z=t.z||zN[14],t.v=PO(HO(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var l={r:a,c:n};switch(l.s=gW(r.cellXfs,t,r),t.l&&i["!links"].push([oU(l),t.l]),t.c&&i["!comments"].push([oU(l),t.c]),t.t){case"s":case"str":return r.bookSST?(s=fW(r.Strings,t.v,r.revStrings),l.t="s",l.v=s,o?KB(e,18,function(e,t,a){return null==a&&(a=jB(8)),TU(t,a),a.write_shift(4,t.v),a}(0,l)):KB(e,7,function(e,t,a){return null==a&&(a=jB(12)),SU(t,a),a.write_shift(4,t.v),a}(0,l))):(l.t="str",o?KB(e,17,function(e,t,a){return null==a&&(a=jB(8+4*e.v.length)),TU(t,a),gU(e.v,a),a.length>a.l?a.slice(0,a.l):a}(t,l)):KB(e,6,function(e,t,a){return null==a&&(a=jB(12+4*e.v.length)),SU(t,a),gU(e.v,a),a.length>a.l?a.slice(0,a.l):a}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?o?KB(e,13,function(e,t,a){return null==a&&(a=jB(8)),TU(t,a),LU(e.v,a),a}(t,l)):KB(e,2,function(e,t,a){return null==a&&(a=jB(12)),SU(t,a),LU(e.v,a),a}(t,l)):o?KB(e,16,function(e,t,a){return null==a&&(a=jB(12)),TU(t,a),UU(e.v,a),a}(t,l)):KB(e,5,function(e,t,a){return null==a&&(a=jB(16)),SU(t,a),UU(e.v,a),a}(t,l)),!0;case"b":return l.t="b",o?KB(e,15,function(e,t,a){return null==a&&(a=jB(5)),TU(t,a),a.write_shift(1,e.v?1:0),a}(t,l)):KB(e,4,function(e,t,a){return null==a&&(a=jB(9)),SU(t,a),a.write_shift(1,e.v?1:0),a}(t,l)),!0;case"e":return l.t="e",o?KB(e,14,function(e,t,a){return null==a&&(a=jB(8)),TU(t,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}(t,l)):KB(e,3,function(e,t,a){return null==a&&(a=jB(9)),SU(t,a),a.write_shift(1,e.v),a}(t,l)),!0}return o?KB(e,12,function(e,t,a){return null==a&&(a=jB(4)),TU(t,a)}(0,l)):KB(e,1,function(e,t,a){return null==a&&(a=jB(8)),SU(t,a)}(0,l)),!0}function YW(e,t){var a,n;t&&t["!merges"]&&(KB(e,177,(a=t["!merges"].length,null==n&&(n=jB(4)),n.write_shift(4,a),n)),t["!merges"].forEach(function(t){KB(e,176,GW(t))}),KB(e,178))}function jW(e,t){t&&t["!cols"]&&(KB(e,390),t["!cols"].forEach(function(t,a){t&&KB(e,60,function(e,t,a){null==a&&(a=jB(18));var n=mW(e,t);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,256*(n.width||10)),a.write_shift(4,0);var r=0;return t.hidden&&(r|=1),"number"==typeof n.width&&(r|=2),t.level&&(r|=t.level<<8),a.write_shift(2,r),a}(a,t))}),KB(e,391))}function XW(e,t){t&&t["!ref"]&&(KB(e,648),KB(e,649,function(e){var t=jB(24);return t.write_shift(4,4),t.write_shift(4,1),FU(e,t),t}(cU(t["!ref"]))),KB(e,650))}function $W(e,t,a){t["!links"].forEach(function(t){if(t[1].Target){var n=iz(a,-1,t[1].Target.replace(/#.*$/,""),tz.HLINK);KB(e,494,function(e,t){var a=jB(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));FU({s:iU(e[0]),e:iU(e[0])},a),DU("rId"+t,a);var n=e[1].Target.indexOf("#");return gU((-1==n?"":e[1].Target.slice(n+1))||"",a),gU(e[1].Tooltip||"",a),gU("",a),a.slice(0,a.l)}(t,n))}}),delete t["!links"]}function KW(e,t,a){KB(e,133),KB(e,137,function(e,t,a){null==a&&(a=jB(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),a.write_shift(2,n),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}(0,a)),KB(e,138),KB(e,134)}function ZW(e,t){var a,n;t["!protect"]&&KB(e,535,(a=t["!protect"],null==n&&(n=jB(66)),n.write_shift(2,a.password?pH(a.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?n.write_shift(4,null==a[e[0]]||a[e[0]]?0:1):n.write_shift(4,null!=a[e[0]]&&a[e[0]]?0:1)}),n))}function JW(e,t,a,n){var r=$B(),i=a.SheetNames[e],o=a.Sheets[i]||{},s=i;try{a&&a.Workbook&&(s=a.Workbook.Sheets[e].CodeName||s)}catch(TQe){}var l,c,u=cU(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],KB(r,129),(a.vbaraw||o["!outline"])&&KB(r,147,function(e,t,a){null==a&&(a=jB(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),a.write_shift(1,n);for(var r=1;r<3;++r)a.write_shift(1,0);return zU({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),CU(e,a),a.slice(0,a.l)}(s,o["!outline"])),KB(r,148,zW(u)),KW(r,0,a.Workbook),jW(r,o),function(e,t,a,n){var r,i=cU(t["!ref"]||"A1"),o="",s=[];KB(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=aU(u),BW(e,t,i,u);var d=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(s[h]=rU(h)),r=s[h]+o;var p=l?(t[u]||[])[h]:t[r];d=!!p&&qW(e,p,u,h,n,t,d)}}KB(e,146)}(r,o,0,t),ZW(r,o),function(e,t,a,n){if(t["!autofilter"]){var r=t["!autofilter"],i="string"==typeof r.ref?r.ref:lU(r.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var o=a.Workbook.Names,s=sU(i);s.s.r==s.e.r&&(s.e.r=sU(t["!ref"]).e.r,i=lU(s));for(var l=0;l<o.length;++l){var c=o[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref="'"+a.SheetNames[n]+"'!"+i;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+a.SheetNames[n]+"'!"+i}),KB(e,161,FU(cU(i))),KB(e,162)}}(r,o,a,e),YW(r,o),$W(r,o,n),o["!margins"]&&KB(r,476,(l=o["!margins"],null==c&&(c=jB(48)),vW(l),WW.forEach(function(e){UU(l[e],c)}),c)),t&&!t.ignoreEC&&null!=t.ignoreEC||XW(r,o),function(e,t,a,n){if(t["!comments"].length>0){var r=iz(n,-1,"../drawings/vmlDrawing"+(a+1)+".vml",tz.VML);KB(e,551,DU("rId"+r)),t["!legacy"]=r}}(r,o,e,n),KB(r,130),r.end()}function QW(e,t,a,n,r,i){var o=i||{"!type":"chart"};if(!e)return i;var s=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,a=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(a[+t[1]]=n?+t[2]:t[2])});var r=gF((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[a,r,t]}(e);u.s.r=u.s.c=0,u.e.c=s,c=rU(s),t[0].forEach(function(e,a){o[c+aU(a)]={t:"n",v:e,z:t[1]},l=a}),u.e.r<l&&(u.e.r=l),++s}),s>0&&(o["!ref"]=lU(u)),o}var eq=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],tq=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],aq=[],nq=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function rq(e,t){for(var a=0;a!=e.length;++a)for(var n=e[a],r=0;r!=t.length;++r){var i=t[r];if(null==n[i[0]])n[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof n[i[0]]&&(n[i[0]]=TF(n[i[0]]));break;case"int":"string"==typeof n[i[0]]&&(n[i[0]]=parseInt(n[i[0]],10))}}}function iq(e,t){for(var a=0;a!=t.length;++a){var n=t[a];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=TF(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function oq(e){iq(e.WBProps,eq),iq(e.CalcPr,nq),rq(e.WBView,tq),rq(e.Sheets,aq),hW.date1904=TF(e.WBProps.date1904)}var sq="][*?/\\".split("");function lq(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");return sq.forEach(function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),!0}function cq(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,a){e.forEach(function(n,r){lq(n);for(var i=0;i<r;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(a){var o=t&&t[r]&&t[r].CodeName||n;if(95==o.charCodeAt(0)&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}(e.SheetNames,t,!!e.vbaraw);for(var a=0;a<e.SheetNames.length;++a)bW(e.Sheets[e.SheetNames[a]],e.SheetNames[a],a)}var uq=/<\w+:workbook/;function dq(e){var t=[sF];t[t.length]=VF("workbook",null,{xmlns:rB[0],"xmlns:r":eB});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(eq.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=VF("workbookPr",null,n);var r=e.Workbook&&e.Workbook.Sheets||[],i=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&r[i]&&r[i].Hidden;++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:xF(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),r[i])switch(r[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden"}t[t.length]=VF("sheet",null,o)}return t[t.length]="</sheets>",a&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var a={name:e.Name};e.Comment&&(a.comment=e.Comment),null!=e.Sheet&&(a.localSheetId=""+e.Sheet),e.Hidden&&(a.hidden="1"),e.Ref&&(t[t.length]=VF("definedName",xF(e.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function hq(e,t){return t||(t=jB(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),DU(e.strRelID,t),gU(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function pq(e,t){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=t-8,a}function fq(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var a,n,r=t.Workbook.Sheets,i=0,o=-1,s=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&-1==o?o=i:1==r[i].Hidden&&-1==s&&(s=i);if(!(s>o))KB(e,135),KB(e,158,(a=o,n||(n=jB(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,a),n.write_shift(4,a),n.write_shift(1,120),n.length>n.l?n.slice(0,n.l):n)),KB(e,136)}}function mq(e,t){var a=$B();return KB(a,131),KB(a,128,function(e,t){t||(t=jB(127));for(var a=0;4!=a;++a)t.write_shift(4,0);return gU("SheetJS",t),gU(rN.version,t),gU(rN.version,t),gU("7262",t),t.length>t.l?t.slice(0,t.l):t}()),KB(a,153,function(e,t){t||(t=jB(72));var a=0;return e&&e.filterPrivacy&&(a|=8),t.write_shift(4,a),t.write_shift(4,0),CU(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),fq(a,e),function(e,t){KB(e,143);for(var a=0;a!=t.SheetNames.length;++a)KB(e,156,hq({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[a]&&t.Workbook.Sheets[a].Hidden||0,iTabID:a+1,strRelID:"rId"+(a+1),name:t.SheetNames[a]}));KB(e,144)}(a,e),KB(a,132),a.end()}function vq(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],r=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],aY[16]={n:"BrtFRTArchID$",f:pq},XB(e,function(e,s,l){switch(l){case 156:o.SheetNames.push(e.name),a.Sheets.push(e);break;case 153:a.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=XG(e.Ptg,0,null,o,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:o[0].length?o.push([l,e]):o[0]=[l,e],o[o.length-1].XTI=[];break;case 362:0===o.length&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(e),o.XTI=o.XTI.concat(e);break;case 35:case 37:n.push(l),r=!0;break;case 36:case 38:n.pop(),r=!1;break;default:if(s.T);else if(!r||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),oq(a),a.Names=i,a.supbooks=o,a}(e,a):function(e,t){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,r="xmlns",i={},o=0;if(e.replace(uF,function(s,l){var c=pF(s);switch(fF(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":s.match(uq)&&(r="xmlns"+s.match(/<(\w+):/)[1]),a.xmlns=c[r];break;case"<fileVersion":delete c[0],a.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":eq.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":a.WBProps[e[0]]=TF(c[e[0]]);break;case"int":a.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:a.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(a.WBProps.CodeName=IF(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],a.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=gF(IF(c.name)),delete c[0],a.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(i={}).Name=IF(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),TF(c.hidden||"0")&&(i.Hidden=!0),o=l+s.length;break;case"</definedName>":i.Ref=gF(IF(e.slice(o,l))),a.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete c[0],a.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return s}),-1===rB.indexOf(a.xmlns))throw new Error("Unknown Namespace: "+a.xmlns);return oq(a),a}(e,a)}function gq(e,t,a,n,r,i,o,s){return".bin"===t.slice(-4)?function(e,t,a,n,r,i,o){if(!e)return e;var s=t||{};n||(n={"!id":{}});var l,c,u,d,h,p,f,m,v,g,y=s.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,w=!1,_=[];s.biff=12,s["!row"]=0;var S=0,M=!1,T=[],k={},C=s.supbooks||r.supbooks||[[]];if(C.sharedf=k,C.arrayf=T,C.SheetNames=r.SheetNames||r.Sheets.map(function(e){return e.name}),!s.supbooks&&(s.supbooks=C,r.Names))for(var A=0;A<r.Names.length;++A)C[0][A+1]=r.Names[A];var E,I=[],R=[],D=!1;if(aY[16]={n:"BrtShortReal",f:VW},XB(e,function(e,t,A){if(!w)switch(A){case 148:l=e;break;case 0:c=e,s.sheetRows&&s.sheetRows<=c.r&&(w=!0),v=aU(h=c.r),s["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=EH(e.hpt)),R[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=dW[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==s.cellText&&(u.w=KU[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=o.CellXf[e[0].iStyleRef])&&yW(u,d.numFmtId,null,s,i,o),p=-1==e[0].c?p+1:e[0].c,s.dense?(y[h]||(y[h]=[]),y[h][p]=u):y[rU(p)+v]=u,s.cellFormula){for(M=!1,S=0;S<T.length;++S){var P=T[S];c.r>=P[0].s.r&&c.r<=P[0].e.r&&p>=P[0].s.c&&p<=P[0].e.c&&(u.F=lU(P[0]),M=!0)}!M&&e.length>3&&(u.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>p&&(b.s.c=p),b.e.r<c.r&&(b.e.r=c.r),b.e.c<p&&(b.e.c=p),s.cellDates&&d&&"n"==u.t&&fO(zN[d.numFmtId])){var L=WN(u.v);L&&(u.t="d",u.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}E&&("XLDAPR"==E.type&&(u.D=!0),E=void 0);break;case 1:case 12:if(!s.sheetStubs||x)break;u={t:"z",v:void 0},p=-1==e[0].c?p+1:e[0].c,s.dense?(y[h]||(y[h]=[]),y[h][p]=u):y[rU(p)+v]=u,b.s.r>c.r&&(b.s.r=c.r),b.s.c>p&&(b.s.c=p),b.e.r<c.r&&(b.e.r=c.r),b.e.c<p&&(b.e.c=p),E&&("XLDAPR"==E.type&&(u.D=!0),E=void 0);break;case 176:_.push(e);break;case 49:E=((s.xlmeta||{}).Cell||[])[e-1];break;case 494:var N=n["!id"][e.relId];for(N?(e.Target=N.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=N):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(p=e.rfx.s.c;p<=e.rfx.e.c;++p)s.dense?(y[h]||(y[h]=[]),y[h][p]||(y[h][p]={t:"z",v:void 0}),y[h][p].l=e):(f=oU({c:p,r:h}),y[f]||(y[f]={t:"z",v:void 0}),y[f].l=e);break;case 426:if(!s.cellFormula)break;T.push(e),(g=s.dense?y[h][p]:y[rU(p)+v]).f=XG(e[1],0,{r:c.r,c:p},C,s),g.F=lU(e[0]);break;case 427:if(!s.cellFormula)break;k[oU(e[0].s)]=e[1],(g=s.dense?y[h][p]:y[rU(p)+v]).f=XG(e[1],0,{r:c.r,c:p},C,s);break;case 60:if(!s.cellStyles)break;for(;e.e>=e.s;)I[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,TH(e.w/256)),kH(I[e.e+1]);break;case 161:y["!autofilter"]={ref:lU(e)};break;case 476:y["!margins"]=e;break;case 147:r.Sheets[a]||(r.Sheets[a]={}),e.name&&(r.Sheets[a].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),e.RTL&&(r.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:x=!0;break;case 36:case 38:x=!1;break;default:if(t.T);else if(!x||s.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}},s),delete s.supbooks,delete s["!row"],!y["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=lU(l||b)),s.sheetRows&&y["!ref"]){var P=cU(y["!ref"]);s.sheetRows<=+P.e.r&&(P.e.r=s.sheetRows-1,P.e.r>b.e.r&&(P.e.r=b.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>b.e.c&&(P.e.c=b.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),y["!fullref"]=y["!ref"],y["!ref"]=lU(P))}return _.length>0&&(y["!merges"]=_),I.length>0&&(y["!cols"]=I),R.length>0&&(y["!rows"]=R),y}(e,n,a,r,i,o,s):IW(e,n,a,r,i,o,s)}function yq(e,t,a,n,r,i,o,s){return".bin"===t.slice(-4)?function(e,t,a,n,r){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return XB(e,function(e,n,s){switch(s){case 550:i["!rel"]=e;break;case 651:r.Sheets[a]||(r.Sheets[a]={}),e.name&&(r.Sheets[a].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:o=!0;break;case 36:o=!1;break;default:if(n.T>0);else if(n.T<0);else if(!o||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,n,a,r,i):function(e,t,a,n,r){if(!e)return e;n||(n={"!id":{}});var i,o={"!type":"chart","!drawel":null,"!rel":""},s=e.match(CW);return s&&RW(s[0],0,r,a),(i=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=i[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}(e,0,a,r,i)}function bq(e,t,a,n){return".bin"===t.slice(-4)?function(e,t,a){var n={NumberFmt:[]};for(var r in zN)n.NumberFmt[r]=zN[r];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return XB(e,function(e,r,s){switch(s){case 44:n.NumberFmt[e[0]]=e[1],bO(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=bH(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&n.CellXf.push(e);break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(s),o=!0;break;case 38:i.pop(),o=!1;break;default:if(r.T>0)i.push(s);else if(r.T<0)i.pop();else if(!o||a.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+s.toString(16))}}),n}(e,a,n):PH(e,a,n)}function xq(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a=[],n=!1;return XB(e,function(e,r,i){switch(i){case 159:a.Count=e[0],a.Unique=e[1];break;case 19:a.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(r.T,!n||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),a}(e,a):function(e,t){var a=[],n="";if(!e)return a;var r=e.match(ZV);if(r){n=r[2].replace(JV,"").split(QV);for(var i=0;i!=n.length;++i){var o=KV(n[i].trim(),t);null!=o&&(a[a.length]=o)}r=pF(r[1]),a.Count=r.count,a.Unique=r.uniqueCount}return a}(e,a)}function wq(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a=[],n=[],r={},i=!1;return XB(e,function(e,o,s){switch(s){case 632:n.push(e);break;case 635:r=e;break;case 637:r.t=e.t,r.h=e.h,r.r=e.r;break;case 636:if(r.author=n[r.iauthor],delete r.iauthor,t.sheetRows&&r.rfx&&t.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,a.push(r);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(o.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),a}(e,a):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],n=[],r=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&a.push(t[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var r=e.match(/<(?:\w+:)?comment[^>]*>/);if(r){var i=pF(r[0]),o={author:i.authorId&&a[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},s=iU(i.ref);if(!(t.sheetRows&&t.sheetRows<=s.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&KV(l[1])||{r:"",t:"",h:""};o.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),o.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(o.h=c.h),n.push(o)}}}}),n}(e,a)}function _q(e,t,a){return".bin"===t.slice(-4)?function(e){var t=[];return XB(e,function(e,a,n){if(63===n)t.push(e);else if(!a.T)throw new Error("Unexpected record 0x"+n.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var a=1;return(e.match(uF)||[]).forEach(function(e){var n=pF(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?a=n.i:n.i=a,t.push(n)}}),t}(e)}function Sq(e,t,a,n){if(".bin"===a.slice(-4))return function(e,t,a,n){if(!e)return e;var r=n||{},i=!1;XB(e,function(e,t,a){switch(a){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||r.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}},r)}(e,0,0,n)}function Mq(e,t,a){return".bin"===t.slice(-4)?function(e,t,a){var n={Types:[],Cell:[],Value:[]},r=a||{},i=[],o=!1,s=2;return XB(e,function(e,t,a){switch(a){case 335:n.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==s?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==s&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})});break;case 337:s=e?1:0;break;case 338:s=2;break;case 35:i.push(a),o=!0;break;case 36:i.pop(),o=!1;break;default:if(t.T);else if(!o||r.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+a.toString(16))}}),n}(e,0,a):function(e,t,a){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var r,i=!1,o=2;return e.replace(uF,function(e){var t=pF(e);switch(fF(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var s=0;s<n.Types.length;++s)n.Types[s].name==t.name&&(r=n.Types[s]);break;case"<rc":1==o?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==o&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":o=1;break;case"</cellMetadata>":case"</valueMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!r)break;r.offsets||(r.offsets=[]),r.offsets.push(+t.i);break;default:if(!i&&a.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),n}(e,0,a)}function Tq(e,t,a,n,r){return(".bin"===t.slice(-4)?JW:FW)(e,a,n,r)}function kq(e,t,a){return(".bin"===t.slice(-4)?mG:hG)(e)}var Cq,Aq=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Eq=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Iq(e,t){var a=e.split(/\s+/),n=[];if(n[0]=a[0],1===a.length)return n;var r,i,o,s=e.match(Aq);if(s)for(o=0;o!=s.length;++o)-1===(i=(r=s[o].match(Eq))[1].indexOf(":"))?n[r[1]]=r[2].slice(1,r[2].length-1):n["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(i+1)]=r[2].slice(1,r[2].length-1);return n}function Rq(e){var t={};if(1===e.split(/\s+/).length)return t;var a,n,r,i=e.match(Aq);if(i)for(r=0;r!=i.length;++r)-1===(n=(a=i[r].match(Eq))[1].indexOf(":"))?t[a[1]]=a[2].slice(1,a[2].length-1):t["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(n+1)]=a[2].slice(1,a[2].length-1);return t}function Dq(e,t,a,n){var r=n;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=TF(n);break;case"i2":case"int":r=parseInt(n,10);break;case"r4":case"float":r=parseFloat(n);break;case"date":case"dateTime.tz":r=HO(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[gF(t)]=r}function Pq(e,t,a){if("z"!==e.t){if(!a||!1!==a.cellText)try{"e"===e.t?e.w=e.w||KU[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=KN(e.v):e.w=ZN(e.v):e.w=function(e,t){var a=Cq[e]||gF(e);return"General"===a?ZN(t):yO(a,t)}(t||"General",e.v)}catch(TQe){if(a.WTF)throw TQe}try{var n=Cq[t]||t||"General";if(a.cellNF&&(e.z=n),a.cellDates&&"n"==e.t&&fO(n)){var r=WN(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(TQe){if(a.WTF)throw TQe}}}function Lq(e,t,a){if(a.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=IH[n.Pattern]||n.Pattern)}e[t.ID]=t}function Nq(e,t,a,n,r,i,o,s,l,c){var u="General",d=n.StyleID,h={};c=c||{};var p=[],f=0;for(void 0===d&&s&&(d=s.StyleID),void 0===d&&o&&(d=o.StyleID);void 0!==i[d]&&(i[d].nf&&(u=i[d].nf),i[d].Interior&&p.push(i[d].Interior),i[d].Parent);)d=i[d].Parent;switch(a.Type){case"Boolean":n.t="b",n.v=TF(e);break;case"String":n.t="s",n.r=MF(gF(e)),n.v=e.indexOf("<")>-1?gF(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(HO(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!=n.v?n.v=gF(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ZU[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=MF(t||e))}if(Pq(n,u,c),!1!==c.cellFormula)if(n.Formula){var m=gF(n.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),n.f=gG(m,r),delete n.Formula,"RC"==n.ArrayRange?n.F=gG("RC:RC",r):n.ArrayRange&&(n.F=gG(n.ArrayRange,r),l.push([cU(n.F),n.F]))}else for(f=0;f<l.length;++f)r.r>=l[f][0].s.r&&r.r<=l[f][0].e.r&&r.c>=l[f][0].s.c&&r.c<=l[f][0].e.c&&(n.F=l[f][1]);c.cellStyles&&(p.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),n.s=h),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function Oq(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Fq(e,t){var a=t||{};wO();var n=fN(GF(e));"binary"!=a.type&&"array"!=a.type&&"base64"!=a.type||(n=IF(n));var r,i=n.slice(0,1024).toLowerCase(),o=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var s=WO(a);return s.type="string",GV.to_workbook(n,s)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){i.indexOf("<"+e)>=0&&(o=!0)}),o)return function(e,t){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||0==a.length)throw new Error("Invalid HTML: could not find <table>");if(1==a.length)return hU(fY(a[0],t),t);var n={SheetNames:[],Sheets:{}};return a.forEach(function(e,a){Ej(n,fY(e,t),"Sheet"+(a+1))}),n}(n,a);Cq={"General Number":"General","General Date":zN[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":zN[15],"Short Date":zN[14],"Long Time":zN[19],"Medium Time":zN[18],"Short Time":zN[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:zN[2],Standard:zN[4],Percent:zN[10],Scientific:zN[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c,u=[],d={},h=[],p=a.dense?[]:{},f="",m={},v={},g=Iq('<Data ss:Type="String">'),y=0,b=0,x=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},S={},M="",T=0,k=[],C={},A={},E=0,I=[],R=[],D={},P=[],L=!1,N=[],O=[],F={},B=0,U=0,z={Sheets:[],WBProps:{date1904:!1}},V={};WF.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var H="";r=WF.exec(n);)switch(r[3]=(H=r[3]).toLowerCase()){case"data":if("data"==H){if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&u.push([r[3],!0]);break}if(u[u.length-1][1])break;"/"===r[1]?Nq(n.slice(y,r.index),M,g,"comment"==u[u.length-1][0]?D:m,{c:b,r:x},_,P[b],v,N,a):(M="",g=Iq(r[0]),y=r.index+r[0].length);break;case"cell":if("/"===r[1])if(R.length>0&&(m.c=R),(!a.sheetRows||a.sheetRows>x)&&void 0!==m.v&&(a.dense?(p[x]||(p[x]=[]),p[x][b]=m):p[rU(b)+aU(x)]=m),m.HRef&&(m.l={Target:gF(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(B=b+(0|parseInt(m.MergeAcross,10)),U=x+(0|parseInt(m.MergeDown,10)),k.push({s:{c:b,r:x},e:{c:B,r:U}})),a.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var G=b;G<=B;++G)for(var W=x;W<=U;++W)(G>b||W>x)&&(a.dense?(p[W]||(p[W]=[]),p[W][G]={t:"z"}):p[rU(G)+aU(W)]={t:"z"});b=B+1}else++b;else m.MergeAcross?b=B+1:++b;else(m=Rq(r[0])).Index&&(b=+m.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),"/>"===r[0].slice(-2)&&++b,R=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(x<w.s.r&&(w.s.r=x),x>w.e.r&&(w.e.r=x),"/>"===r[0].slice(-2)&&(v=Iq(r[0])).Index&&(x=+v.Index-1),b=0,++x):((v=Iq(r[0])).Index&&(x=+v.Index-1),F={},("0"==v.AutoFitHeight||v.Height)&&(F.hpx=parseInt(v.Height,10),F.hpt=AH(F.hpx),O[x]=F),"1"==v.Hidden&&(F.hidden=!0,O[x]=F));break;case"worksheet":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"));h.push(f),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=lU(w),a.sheetRows&&a.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=a.sheetRows-1,p["!ref"]=lU(w))),k.length&&(p["!merges"]=k),P.length>0&&(p["!cols"]=P),O.length>0&&(p["!rows"]=O),d[f]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=b=0,u.push([r[3],!1]),l=Iq(r[0]),f=gF(l.Name),p=a.dense?[]:{},k=[],N=[],O=[],V={name:f,Hidden:0},z.Sheets.push(V);break;case"table":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==r[0].slice(-2))break;u.push([r[3],!1]),P=[],L=!1}break;case"style":"/"===r[1]?Lq(_,S,a):S=Iq(r[0]);break;case"numberformat":S.nf=gF(Iq(r[0]).Format||"General"),Cq[S.nf]&&(S.nf=Cq[S.nf]);for(var q=0;392!=q&&zN[q]!=S.nf;++q);if(392==q)for(q=57;392!=q;++q)if(null==zN[q]){bO(S.nf,q);break}break;case"column":if("table"!==u[u.length-1][0])break;if((c=Iq(r[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!L&&c.wpx>10){L=!0,xH=6;for(var Y=0;Y<P.length;++Y)P[Y]&&kH(P[Y])}L&&kH(c),P[c.Index-1||P.length]=c;for(var j=0;j<+c.Span;++j)P[P.length]=WO(c);break;case"namedrange":if("/"===r[1])break;z.Names||(z.Names=[]);var X=pF(r[0]),$={Name:X.Name,Ref:gG(X.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&($.Sheet=z.Sheets.length-1),z.Names.push($);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===r[0].slice(-2))break;"/"===r[1]?M+=n.slice(T,r.index):T=r.index+r[0].length;break;case"interior":if(!a.cellStyles)break;S.Interior=Iq(r[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===r[0].slice(-2))break;"/"===r[1]?_z(C,H,n.slice(E,r.index)):E=r.index+r[0].length;break;case"styles":case"workbook":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else u.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"));Oq(D),R.push(D)}else u.push([r[3],!1]),D={a:(l=Iq(r[0])).Author};break;case"autofilter":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==r[0].charAt(r[0].length-2)){var K=Iq(r[0]);p["!autofilter"]={ref:gG(K.Range).replace(/\$/g,"")},u.push([r[3],!0])}break;case"datavalidation":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&u.push([r[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((l=u.pop())[0]!==r[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&u.push([r[3],!0]);break;default:if(0==u.length&&"document"==r[3])return MY(n,a);if(0==u.length&&"uof"==r[3])return MY(n,a);var Z=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Z=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Z=!1}break;case"excelworkbook":switch(r[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Z=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:Z=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"===r[0].slice(-2));else if("/"===r[1])switch(n.slice(E,r.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2}else E=r.index+r[0].length;break;case"header":p["!margins"]||vW(p["!margins"]={},"xlml"),isNaN(+pF(r[0]).Margin)||(p["!margins"].header=+pF(r[0]).Margin);break;case"footer":p["!margins"]||vW(p["!margins"]={},"xlml"),isNaN(+pF(r[0]).Margin)||(p["!margins"].footer=+pF(r[0]).Margin);break;case"pagemargins":var J=pF(r[0]);p["!margins"]||vW(p["!margins"]={},"xlml"),isNaN(+J.Top)||(p["!margins"].top=+J.Top),isNaN(+J.Left)||(p["!margins"].left=+J.Left),isNaN(+J.Right)||(p["!margins"].right=+J.Right),isNaN(+J.Bottom)||(p["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;default:Z=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Z=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Z=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Z=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Z=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Z=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Z=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Z=!1}break;case"smarttags":break;default:Z=!1}if(Z)break;if(r[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+u.join("|");if("customdocumentproperties"===u[u.length-1][0]){if("/>"===r[0].slice(-2))break;"/"===r[1]?Dq(A,H,I,n.slice(E,r.index)):(I=r,E=r.index+r[0].length);break}if(a.WTF)throw"Unrecognized tag: "+r[3]+"|"+u.join("|")}var Q={};return a.bookSheets||a.bookProps||(Q.Sheets=d),Q.SheetNames=h,Q.Workbook=z,Q.SSF=WO(zN),Q.Props=C,Q.Custprops=A,Q}function Bq(e,t){switch(aj(t=t||{}),t.type||"base64"){case"base64":return Fq(bN(e),t);case"binary":case"buffer":case"file":return Fq(e,t);case"array":return Fq(kN(e),t)}}function Uq(e,t){var a=[];return e.Props&&a.push(function(e,t){var a=[];return AO(wz).map(function(e){for(var t=0;t<cz.length;++t)if(cz[t][1]==e)return cz[t];for(t=0;t<fz.length;++t)if(fz[t][1]==e)return fz[t];throw e}).forEach(function(n){if(null!=e[n[1]]){var r=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof r?r=String(r):!0===r||!1===r?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),a.push(UF(wz[n[1]]||n[1],r))}}),VF("DocumentProperties",a.join(""),{xmlns:iB})}(e.Props,t)),e.Custprops&&a.push(function(e,t){var a=["Worksheets","SheetNames"],n="CustomDocumentProperties",r=[];return e&&AO(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<cz.length;++n)if(t==cz[n][1])return;for(n=0;n<fz.length;++n)if(t==fz[n][1])return;for(n=0;n<a.length;++n)if(t==a[n])return;var i=e[t],o="string";"number"==typeof i?(o="float",i=String(i)):!0===i||!1===i?(o="boolean",i=i?"1":"0"):i=String(i),r.push(VF(wF(t),i,{"dt:dt":o}))}}),t&&AO(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&(!e||!Object.prototype.hasOwnProperty.call(e,a))){var n=t[a],i="string";"number"==typeof n?(i="float",n=String(n)):!0===n||!1===n?(i="boolean",n=n?"1":"0"):n instanceof Date?(i="dateTime.tz",n=n.toISOString()):n=String(n),r.push(VF(wF(a),n,{"dt:dt":i}))}}),"<"+n+' xmlns="'+iB+'">'+r.join("")+"</"+n+">"}(e.Props,e.Custprops)),a.join("")}function zq(e){return VF("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+bG(e.Ref,{r:0,c:0})})}function Vq(e,t,a,n,r,i,o){if(!e||null==e.v&&null==e.f)return"";var s={};if(e.f&&(s["ss:Formula"]="="+xF(bG(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=iU(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=xF(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=xF(e.l.Tooltip))),a["!merges"])for(var c=a["!merges"],u=0;u!=c.length;++u)c[u].s.c==o.c&&c[u].s.r==o.r&&(c[u].e.c>c[u].s.c&&(s["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(s["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=KU[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||zN[14]);break;case"s":d="String",h=function(e){return(e+"").replace(yF,function(e){return vF[e]}).replace(_F,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}(e.v||"")}var p=gW(n.cellXfs,e,n);s["ss:StyleID"]="s"+(21+p),s["ss:Index"]=o.c+1;var f=null!=e.v?h:"",m="z"==e.t?"":'<Data ss:Type="'+d+'">'+f+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map(function(e){var t=VF("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return VF("Comment",t,{"ss:Author":e.a})}).join("")),VF("Cell",m,s)}function Hq(e,t){var a='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=EH(t.hpt)),t.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(a+=' ss:Hidden="1"')),a+">"}function Gq(e,t,a){var n=[],r=a.SheetNames[e],i=a.Sheets[r],o=i?function(e,t,a,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var r=n.Workbook.Names,i=[],o=0;o<r.length;++o){var s=r[o];s.Sheet==a&&(s.Name.match(/^_xlfn\./)||i.push(zq(s)))}return i.join("")}(i,0,e,a):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?function(e,t){if(!e["!ref"])return"";var a=cU(e["!ref"]),n=e["!merges"]||[],r=0,i=[];e["!cols"]&&e["!cols"].forEach(function(e,t){kH(e);var a=!!e.width,n=mW(t,e),r={"ss:Index":t+1};a&&(r["ss:Width"]=wH(n.width)),e.hidden&&(r["ss:Hidden"]="1"),i.push(VF("Column",null,r))});for(var o=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){for(var l=[Hq(s,(e["!rows"]||[])[s])],c=a.s.c;c<=a.e.c;++c){var u=!1;for(r=0;r!=n.length;++r)if(!(n[r].s.c>c||n[r].s.r>s||n[r].e.c<c||n[r].e.r<s)){n[r].s.c==c&&n[r].s.r==s||(u=!0);break}if(!u){var d={r:s,c:c},h=oU(d),p=o?(e[s]||[])[c]:e[h];l.push(Vq(p,h,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&i.push(l.join(""))}return i.join("")}(i,t):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(function(e,t,a,n){if(!e)return"";var r=[];if(e["!margins"]&&(r.push("<PageSetup>"),e["!margins"].header&&r.push(VF("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&r.push(VF("Footer",null,{"x:Margin":e["!margins"].footer})),r.push(VF("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),r.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a])if(n.Workbook.Sheets[a].Hidden)r.push(VF("Visible",1==n.Workbook.Sheets[a].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<a&&(!n.Workbook.Sheets[i]||n.Workbook.Sheets[i].Hidden);++i);i==a&&r.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),e["!protect"]&&(r.push(UF("ProtectContents","True")),e["!protect"].objects&&r.push(UF("ProtectObjects","True")),e["!protect"].scenarios&&r.push(UF("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||r.push(UF("EnableSelection","UnlockedCells")):r.push(UF("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&r.push("<"+t[1]+"/>")})),0==r.length?"":VF("WorksheetOptions",r.join(""),{xmlns:oB})}(i,0,e,a)),n.join("")}function Wq(e,t){t||(t={}),e.SSF||(e.SSF=WO(zN)),e.SSF&&(wO(),xO(e.SSF),t.revssf=RO(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gW(t.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(Uq(e,t)),a.push(""),a.push(""),a.push("");for(var n=0;n<e.SheetNames.length;++n)a.push(VF("Worksheet",Gq(n,t,e),{"ss:Name":xF(e.SheetNames[n])}));return a[2]=function(e,t){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var n=[];n.push(VF("NumberFormat",null,{"ss:Format":xF(zN[e.numFmtId])}));var r={"ss:ID":"s"+(21+t)};a.push(VF("Style",n.join(""),r))}),VF("Styles",a.join(""))}(0,t),a[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,a=[],n=0;n<t.length;++n){var r=t[n];null==r.Sheet&&(r.Name.match(/^_xlfn\./)||a.push(zq(r)))}return VF("Names",a.join(""))}(e),sF+VF("Workbook",a.join(""),{xmlns:sB,"xmlns:o":iB,"xmlns:x":oB,"xmlns:ss":sB,"xmlns:dt":lB,"xmlns:html":dB})}function qq(e){var t={},a=e.content;if(a.l=28,t.AnsiUserType=a.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return VU(e,1)}(a),a.length-a.l<=4)return t;var n=a.read_shift(4);return 0==n||n>40?t:(a.l-=4,t.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4||1907505652!==(n=a.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return VU(e,2)}(a),0==(n=a.read_shift(4))||n>40?t:(a.l-=4,void(t.Reserved2=a.read_shift(0,"lpwstr")))))}var Yq=[60,1084,2066,2165,2175];function jq(e,t,a,n,r){var i=n,o=[],s=a.slice(a.l,a.l+i);if(r&&r.enc&&r.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:r.enc.insitu(s)}o.push(s),a.l+=i;for(var l=LB(a,a.l),c=nY[l],u=0;null!=c&&Yq.indexOf(l)>-1;)i=LB(a,a.l+2),u=a.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),s=a.slice(u,a.l+4+i),o.push(s),a.l+=4+i,c=nY[l=LB(a,a.l)];var d=AN(o);qB(d,0);var h=0;d.lens=[];for(var p=0;p<o.length;++p)d.lens.push(h),h+=o[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,r)}function Xq(e,t,a){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=zN[n])}catch(TQe){if(t.WTF)throw TQe}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||KU[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=KN(e.v):e.w=ZN(e.v):e.w=yO(n,e.v,{date1904:!!a,dateNF:t&&t.dateNF})}catch(TQe){if(t.WTF)throw TQe}if(t.cellDates&&n&&"n"==e.t&&fO(zN[n]||String(n))){var r=WN(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function $q(e,t,a){return{v:e,ixfe:t,t:a}}function Kq(e,t){var a,n,r,i,o,s,l,c,u={opts:{}},d={},h=t.dense?[]:{},p={},f={},m=null,v=[],g="",y={},b="",x={},w=[],_=[],S=[],M={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},k=function(e){return e<8?$U[e]:e<64&&S[e-8]||$U[e]},C=function(e,t,n){if(!(F>1||n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,a){var n,r=t.XF.data;r&&r.patternType&&a&&a.cellStyles&&(t.s={},t.s.patternType=r.patternType,(n=yH(k(r.icvFore)))&&(t.s.fgColor={rgb:n}),(n=yH(k(r.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,n),delete t.ixfe,delete t.XF,a=e,b=oU(e),f&&f.s&&f.e||(f={s:{r:0,c:0},e:{r:0,c:0}}),e.r<f.s.r&&(f.s.r=e.r),e.c<f.s.c&&(f.s.c=e.c),e.r+1>f.e.r&&(f.e.r=e.r+1),e.c+1>f.e.c&&(f.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<w.length;++r)if(!(w[r][0].s.c>e.c||w[r][0].s.r>e.r||w[r][0].e.c<e.c||w[r][0].e.r<e.r)){t.F=lU(w[r][0]),w[r][0].s.c==e.c&&w[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+XG(w[r][1],0,e,L,A));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[b]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var E=[],I=[],R=[],D=[],P=!1,L=[];L.SheetNames=A.snames,L.sharedf=A.sharedf,L.arrayf=A.arrayf,L.names=[],L.XTI=[];var N,O=0,F=0,B=0,U=[],z=[];A.codepage=1200,cN(1200);for(var V=!1;e.l<e.length-1;){var H=e.l,G=e.read_shift(2);if(0===G&&10===O)break;var W=e.l===e.length?0:e.read_shift(2),q=nY[G];if(q&&q.f){if(t.bookSheets&&133===O&&133!==G)break;if(O=G,2===q.r||12==q.r){var Y=e.read_shift(2);if(W-=2,!A.enc&&Y!==G&&((255&Y)<<8|Y>>8)!==G)throw new Error("rt mismatch: "+Y+"!="+G);12==q.r&&(e.l+=10,W-=10)}var j={};if(j=10===G?q.f(e,W,A):jq(G,q,e,W,A),0==F&&-1===[9,521,1033,2057].indexOf(O))continue;switch(G){case 34:u.opts.Date1904=M.WBProps.date1904=j;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=j,!t.password)throw new Error("File is password-protected");if(null==j.valid)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=j;break;case 66:var X=Number(j);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252}cN(A.codepage=X),V=!0;break;case 317:A.rrtabid=j;break;case 25:A.winlocked=j;break;case 439:u.opts.RefreshAll=j;break;case 12:u.opts.CalcCount=j;break;case 16:u.opts.CalcDelta=j;break;case 17:u.opts.CalcIter=j;break;case 13:u.opts.CalcMode=j;break;case 14:u.opts.CalcPrecision=j;break;case 95:u.opts.CalcSaveRecalc=j;break;case 15:A.CalcRefMode=j;break;case 2211:u.opts.FullCalc=j;break;case 129:j.fDialog&&(h["!type"]="dialog"),j.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),j.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:_.push(j);break;case 430:L.push([j]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(j);break;case 24:case 536:N={Name:j.Name,Ref:XG(j.rgce,0,null,L,A)},j.itab>0&&(N.Sheet=j.itab-1),L.names.push(N),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(j),"_xlnm._FilterDatabase"==j.Name&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&"PtgArea3d"==j.rgce[0][0][0]&&(z[j.itab-1]={ref:lU(j.rgce[0][0][1][2])});break;case 22:A.ExternCount=j;break;case 23:0==L.length&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(j),L.XTI=L.XTI.concat(j);break;case 2196:if(A.biff<8)break;null!=N&&(N.Comment=j[1]);break;case 18:h["!protect"]=j;break;case 19:0!==j&&A.WTF&&console.error("Password verifier: "+j);break;case 133:p[j.pos]=j,A.snames.push(j.name);break;case 10:if(--F)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,h["!ref"]=lU(f),t.sheetRows&&t.sheetRows<=f.e.r){var $=f.e.r;f.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=lU(f),f.e.r=$}f.e.r++,f.e.c++}E.length>0&&(h["!merges"]=E),I.length>0&&(h["!objects"]=I),R.length>0&&(h["!cols"]=R),D.length>0&&(h["!rows"]=D),M.Sheets.push(T)}""===g?y=h:d[g]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[G]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),A.biffguess=0==j.BIFFVer,0==j.BIFFVer&&4096==j.dt&&(A.biff=5,V=!0,cN(A.codepage=28591)),8==A.biff&&0==j.BIFFVer&&16==j.dt&&(A.biff=2),F++)break;if(h=t.dense?[]:{},A.biff<8&&!V&&(V=!0,cN(A.codepage=t.codepage||1252)),A.biff<5||0==j.BIFFVer&&4096==j.dt){""===g&&(g="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var K={pos:e.l-W,name:g};p[K.pos]=K,A.snames.push(g)}else g=(p[H]||{name:""}).name;32==j.dt&&(h["!type"]="chart"),64==j.dt&&(h["!type"]="macro"),E=[],I=[],A.arrayf=w=[],R=[],D=[],P=!1,T={Hidden:(p[H]||{hs:0}).hs,name:g};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[j.r]||[])[j.c]:h[oU({c:j.c,r:j.r})])&&++j.c,s={ixfe:j.ixfe,XF:_[j.ixfe]||{},v:j.val,t:"n"},B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:j.c,r:j.r},s,t);break;case 5:case 517:s={ixfe:j.ixfe,XF:_[j.ixfe],v:j.val,t:j.t},B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:j.c,r:j.r},s,t);break;case 638:s={ixfe:j.ixfe,XF:_[j.ixfe],v:j.rknum,t:"n"},B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:j.c,r:j.r},s,t);break;case 189:for(var Z=j.c;Z<=j.C;++Z){var J=j.rkrec[Z-j.c][0];s={ixfe:J,XF:_[J],v:j.rkrec[Z-j.c][1],t:"n"},B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:Z,r:j.r},s,t)}break;case 6:case 518:case 1030:if("String"==j.val){m=j;break}if((s=$q(j.val,j.cell.ixfe,j.tt)).XF=_[s.ixfe],t.cellFormula){var Q=j.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],te=Q[0][0][1][1],ae=oU({r:ee,c:te});x[ae]?s.f=""+XG(j.formula,0,j.cell,L,A):s.F=((t.dense?(h[ee]||[])[te]:h[ae])||{}).F}else s.f=""+XG(j.formula,0,j.cell,L,A)}B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C(j.cell,s,t),m=j;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=j,(s=$q(j,m.cell.ixfe,"s")).XF=_[s.ixfe],t.cellFormula&&(s.f=""+XG(m.formula,0,m.cell,L,A)),B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C(m.cell,s,t),m=null;break;case 33:case 545:w.push(j);var ne=oU(j[0].s);if(n=t.dense?(h[j[0].s.r]||[])[j[0].s.c]:h[ne],t.cellFormula&&n){if(!m)break;if(!ne||!n)break;n.f=""+XG(j[1],0,j[0],L,A),n.F=lU(j[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!m)break;x[oU(m.cell)]=j[0],((n=t.dense?(h[m.cell.r]||[])[m.cell.c]:h[oU(m.cell)])||{}).f=""+XG(j[0],0,a,L,A)}break;case 253:s=$q(v[j.isst].t,j.ixfe,"s"),v[j.isst].h&&(s.h=v[j.isst].h),s.XF=_[s.ixfe],B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:j.c,r:j.r},s,t);break;case 513:t.sheetStubs&&(s={ixfe:j.ixfe,XF:_[j.ixfe],t:"z"},B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:j.c,r:j.r},s,t));break;case 190:if(t.sheetStubs)for(var re=j.c;re<=j.C;++re){var ie=j.ixfe[re-j.c];s={ixfe:ie,XF:_[ie],t:"z"},B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:re,r:j.r},s,t)}break;case 214:case 516:case 4:(s=$q(j.val,j.ixfe,"s")).XF=_[s.ixfe],B>0&&(s.z=U[s.ixfe>>8&63]),Xq(s,t,u.opts.Date1904),C({c:j.c,r:j.r},s,t);break;case 0:case 512:1===F&&(f=j);break;case 252:v=j;break;case 1054:if(4==A.biff){U[B++]=j[1];for(var oe=0;oe<B+163&&zN[oe]!=j[1];++oe);oe>=163&&bO(j[1],B+163)}else bO(j[1],j[0]);break;case 30:U[B++]=j;for(var se=0;se<B+163&&zN[se]!=j;++se);se>=163&&bO(j,B+163);break;case 229:E=E.concat(j);break;case 93:I[j.cmo[0]]=A.lastobj=j;break;case 438:A.lastobj.TxO=j;break;case 127:A.lastobj.ImData=j;break;case 440:for(o=j[0].s.r;o<=j[0].e.r;++o)for(i=j[0].s.c;i<=j[0].e.c;++i)(n=t.dense?(h[o]||[])[i]:h[oU({c:i,r:o})])&&(n.l=j[1]);break;case 2048:for(o=j[0].s.r;o<=j[0].e.r;++o)for(i=j[0].s.c;i<=j[0].e.c;++i)(n=t.dense?(h[o]||[])[i]:h[oU({c:i,r:o})])&&n.l&&(n.l.Tooltip=j[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;n=t.dense?(h[j[0].r]||[])[j[0].c]:h[oU(j[0])];var le=I[j[2]];n||(t.dense?(h[j[0].r]||(h[j[0].r]=[]),n=h[j[0].r][j[0].c]={t:"z"}):n=h[oU(j[0])]={t:"z"},f.e.r=Math.max(f.e.r,j[0].r),f.s.r=Math.min(f.s.r,j[0].r),f.e.c=Math.max(f.e.c,j[0].c),f.s.c=Math.min(f.s.c,j[0].c)),n.c||(n.c=[]),r={a:j[1],t:le.TxO.t},n.c.push(r);break;case 2173:oG(_[j.ixfe],j.ext);break;case 125:if(!A.cellStyles)break;for(;j.e>=j.s;)R[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(1&j.flags)},P||(P=!0,TH(j.w/256)),kH(R[j.e+1]);break;case 520:var ce={};null!=j.level&&(D[j.r]=ce,ce.level=j.level),j.hidden&&(D[j.r]=ce,ce.hidden=!0),j.hpt&&(D[j.r]=ce,ce.hpt=j.hpt,ce.hpx=EH(j.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||vW(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[G]]=j;break;case 161:h["!margins"]||vW(h["!margins"]={}),h["!margins"].header=j.header,h["!margins"].footer=j.footer;break;case 574:j.RTL&&(M.Views[0].RTL=!0);break;case 146:S=j;break;case 2198:c=j;break;case 140:l=j;break;case 442:g?T.CodeName=j||T.name:M.WBProps.CodeName=j||"ThisWorkbook"}}else q||console.error("Missing Info for XLS Record 0x"+G.toString(16)),e.l+=W}return u.SheetNames=AO(p).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return p[e].name}),t.bookSheets||(u.Sheets=d),!u.SheetNames.length&&y["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=y)):u.Preamble=y,u.Sheets&&z.forEach(function(e,t){u.Sheets[u.SheetNames[t]]["!autofilter"]=e}),u.Strings=v,u.SSF=WO(zN),A.enc&&(u.Encryption=A.enc),c&&(u.Themes=c),u.Metadata={},void 0!==l&&(u.Metadata.Country=l),L.names.length>0&&(M.Names=L.names),u.Workbook=M,u}var Zq="e0859ff2f94f6810ab9108002b27b3d9",Jq="02d5cdd59c2e1b10939708002b2cf9ae",Qq="05d5cdd59c2e1b10939708002b2cf9ae";function eY(e,t){var a,n,r,i;if(t||(t={}),aj(t),uN(),t.codepage&&lN(t.codepage),e.FullPaths){if(TO.find(e,"/encryption"))throw new Error("File is password-protected");a=TO.find(e,"!CompObj"),n=TO.find(e,"/Workbook")||TO.find(e,"/Book")}else{switch(t.type){case"base64":e=MN(bN(e));break;case"binary":e=MN(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}qB(e,0),n={content:e}}if(a&&qq(a),t.bookProps&&!t.bookSheets)r={};else{var o=xN?"buffer":"array";if(n&&n.content)r=Kq(n.content,t);else if((i=TO.find(e,"PerfectOffice_MAIN"))&&i.content)r=WV.to_workbook(i.content,(t.type=o,t));else{if(!(i=TO.find(e,"NativeContent_MAIN"))||!i.content)throw(i=TO.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r=WV.to_workbook(i.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&TO.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=function(e){var t=TO.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,n){if("/"!==a.slice(-1)&&a.match(/_VBA_PROJECT_CUR/)){var r=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");TO.utils.cfb_add(t,r,e.FileIndex[n].content)}}),TO.write(t)}(e))}var s={};return e.FullPaths&&function(e,t,a){var n=TO.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var r=Fz(n,WU,Jq);for(var i in r)t[i]=r[i]}catch(TQe){if(a.WTF)throw TQe}var o=TO.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var s=Fz(o,qU,Zq);for(var l in s)null==t[l]&&(t[l]=s[l])}catch(TQe){if(a.WTF)throw TQe}t.HeadingPairs&&t.TitlesOfParts&&(vz(t.HeadingPairs,t.TitlesOfParts,t,a),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,s,t),r.Props=r.Custprops=s,t.bookFiles&&(r.cfb=e),r}function tY(e,t){var a=t||{},n=TO.utils.cfb_new({root:"R"}),r="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":r="/Workbook",a.biff=8;break;case"biff5":r="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return TO.utils.cfb_add(n,r,pY(e,a)),8==a.biff&&(e.Props||e.Custprops)&&function(e,t){var a,n=[],r=[],i=[],o=0,s=EO(WU,"n"),l=EO(qU,"n");if(e.Props)for(a=AO(e.Props),o=0;o<a.length;++o)(Object.prototype.hasOwnProperty.call(s,a[o])?n:Object.prototype.hasOwnProperty.call(l,a[o])?r:i).push([a[o],e.Props[a[o]]]);if(e.Custprops)for(a=AO(e.Custprops),o=0;o<a.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},a[o])||(Object.prototype.hasOwnProperty.call(s,a[o])?n:Object.prototype.hasOwnProperty.call(l,a[o])?r:i).push([a[o],e.Custprops[a[o]]]);var c=[];for(o=0;o<i.length;++o)Lz.indexOf(i[o][0])>-1||mz.indexOf(i[o][0])>-1||null!=i[o][1]&&c.push(i[o]);r.length&&TO.utils.cfb_add(t,"/SummaryInformation",Bz(r,Zq,l,qU)),(n.length||c.length)&&TO.utils.cfb_add(t,"/DocumentSummaryInformation",Bz(n,Jq,s,WU,c.length?c:null,Qq))}(e,n),8==a.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(a,n){if(0!=n){var r=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==r.slice(-1)&&TO.utils.cfb_add(e,r,t.FileIndex[n].content)}})}(n,TO.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var aY={0:{f:function(e,t){var a={},n=e.l+t;a.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,7&i&&(a.level=7&i),16&i&&(a.hidden=!0),32&i&&(a.hpt=r/20),a}},1:{f:function(e){return[_U(e)]}},2:{f:function(e){return[_U(e),PU(e),"n"]}},3:{f:function(e){return[_U(e),e.read_shift(1),"e"]}},4:{f:function(e){return[_U(e),e.read_shift(1),"b"]}},5:{f:function(e){return[_U(e),BU(e),"n"]}},6:{f:function(e){return[_U(e),vU(e),"str"]}},7:{f:function(e){return[_U(e),e.read_shift(4),"s"]}},8:{f:function(e,t,a){var n=e.l+t,r=_U(e);r.r=a["!row"];var i=[r,vU(e),"str"];if(a.cellFormula){e.l+=2;var o=tW(e,n-e.l,a);i[3]=XG(o,0,r,a.supbooks,a)}else e.l=n;return i}},9:{f:function(e,t,a){var n=e.l+t,r=_U(e);r.r=a["!row"];var i=[r,BU(e),"n"];if(a.cellFormula){e.l+=2;var o=tW(e,n-e.l,a);i[3]=XG(o,0,r,a.supbooks,a)}else e.l=n;return i}},10:{f:function(e,t,a){var n=e.l+t,r=_U(e);r.r=a["!row"];var i=[r,e.read_shift(1),"b"];if(a.cellFormula){e.l+=2;var o=tW(e,n-e.l,a);i[3]=XG(o,0,r,a.supbooks,a)}else e.l=n;return i}},11:{f:function(e,t,a){var n=e.l+t,r=_U(e);r.r=a["!row"];var i=[r,e.read_shift(1),"e"];if(a.cellFormula){e.l+=2;var o=tW(e,n-e.l,a);i[3]=XG(o,0,r,a.supbooks,a)}else e.l=n;return i}},12:{f:function(e){return[MU(e)]}},13:{f:function(e){return[MU(e),PU(e),"n"]}},14:{f:function(e){return[MU(e),e.read_shift(1),"e"]}},15:{f:function(e){return[MU(e),e.read_shift(1),"b"]}},16:{f:VW},17:{f:function(e){return[MU(e),vU(e),"str"]}},18:{f:function(e){return[MU(e),e.read_shift(4),"s"]}},19:{f:bU},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,a){var n=e.l+t;e.l+=4,e.l+=1;var r=e.read_shift(4),i=IU(e),o=aW(e,0,a),s=AU(e);e.l=n;var l={Name:i,Ptg:o};return r<268435455&&(l.Sheet=r),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function(e,t,a){var n={};n.sz=e.read_shift(2)/20;var r=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(r.fItalic&&(n.italic=1),r.fCondense&&(n.condense=1),r.fExtend&&(n.extend=1),r.fShadow&&(n.shadow=1),r.fOutline&&(n.outline=1),r.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var s=e.read_shift(1);switch(s>0&&(n.charset=s),e.l++,n.color=function(e){var t={},a=e.read_shift(1)>>>1,n=e.read_shift(1),r=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),s=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var l=$U[n];l&&(t.rgb=yH(l));break;case 2:t.rgb=yH([i,o,s]);break;case 3:t.theme=n}return 0!=r&&(t.tint=r>0?r/32767:r/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=vU(e),n}},44:{f:function(e,t){return[e.read_shift(2),vU(e)]}},45:{f:UH},46:{f:GH},47:{f:function(e,t){var a=e.l+t,n=e.read_shift(2),r=e.read_shift(2);return e.l=a,{ixfe:n,numFmtId:r}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],a=e.read_shift(4);a-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:LV},62:{f:function(e){return[_U(e),bU(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),t.r=oU(a);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:YB,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var a={},n=e[e.l];return++e.l,a.above=!(64&n),a.left=!(128&n),e.l+=18,a.name=kU(e),a}},148:{f:UW,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var a={},n=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var r=t>8?vU(e):"";return r.length>0&&(a.CodeName=r),a.autoCompressPictures=!!(65536&n),a.backupFile=!!(64&n),a.checkCompatibility=!!(4096&n),a.date1904=!!(1&n),a.filterPrivacy=!!(8&n),a.hidePivotFieldList=!!(1024&n),a.promptedSolutions=!!(16&n),a.publishItems=!!(2048&n),a.refreshAllConnections=!!(262144&n),a.saveExternalLinkValues=!!(128&n),a.showBorderUnselectedTables=!!(4&n),a.showInkAnnotation=!!(32&n),a.showObjects=["all","placeholders","none"][n>>13&3],a.showPivotChartFilter=!!(32768&n),a.updateLinks=["userSet","never","always"][n>>8&3],a}},154:{},155:{},156:{f:function(e,t){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=RU(e),a.name=vU(e),a}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:OU},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:HW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:vU(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:RU},357:{},358:{},359:{},360:{T:1},361:{},362:{f:EV},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,a){var n=e.l+t,r=NU(e),i=e.read_shift(1),o=[r];if(o[2]=i,a.cellFormula){var s=eW(e,n-e.l,a);o[1]=s}else e.l=n;return o}},427:{f:function(e,t,a){var n=e.l+t,r=[OU(e)];if(a.cellFormula){var i=nW(e,n-e.l,a);r[1]=i,e.l=n}else e.l=n;return r}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return WW.forEach(function(a){t[a]=BU(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var a=e.l+t,n=OU(e),r=AU(e),i=vU(e),o=vU(e),s=vU(e);e.l=a;var l={rfx:n,relId:r,loc:i,display:s};return o&&(l.Tooltip=o),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:RU},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fG},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var a=OU(e);return t.rfx=a.s,t.ref=oU(a.s),e.l+=16,t}},636:{T:-1},637:{f:xU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:vU(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nY={6:{f:ZG},10:{f:Uz},12:{f:Hz},13:{f:Hz},14:{f:zz},15:{f:zz},16:{f:BU},17:{f:zz},18:{f:zz},19:{f:Hz},20:{f:TV},21:{f:TV},23:{f:EV},24:{f:AV},25:{f:zz},26:{},27:{},28:{f:function(e,t,a){return function(e,t,a){if(!(a.biff<8)){var n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),s=Zz(e,0,a);return a.biff<8&&e.read_shift(1),[{r:n,c:r},s,o,i]}}(e,0,a)}},29:{},34:{f:zz},35:{f:kV},38:{f:BU},39:{f:BU},40:{f:BU},41:{f:BU},42:{f:zz},43:{f:zz},47:{f:function(e,t,a){var n={Type:a.biff>=8?e.read_shift(2):0};return n.Type?vH(e,t-2,n):function(e,t,a,n){var r={key:Hz(e),verificationBytes:Hz(e)};a.password&&(r.verifier=pH(a.password)),n.valid=r.verificationBytes===r.verifier,n.valid&&(n.insitu=mH(a.password))}(e,a.biff,a,n),n}},49:{f:function(e,t,a){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=Yz(e,0,a),n}},51:{f:Hz},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:zz},65:{f:function(){}},66:{f:Hz},77:{},80:{},81:{},82:{},85:{f:Hz},89:{},90:{},91:{},92:{f:function(e,t,a){if(a.enc)return e.l+=t,"";var n=e.l,r=Zz(e,0,a);return e.read_shift(t+n-e.l),r}},93:{f:function(e,t,a){if(a&&a.biff<8)return function(e,t,a){e.l+=4;var n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((RV[n]||YB)(e,t,a)),{cmo:[r,n,i],ft:o}}(e,t,a);var n=pV(e),r=function(e,t){for(var a=e.l+t,n=[];e.l<a;){var r=e.read_shift(2);e.l-=2;try{n.push(mV[r](e,a-e.l))}catch(TQe){return e.l=a,n}}return e.l!=a&&(e.l=a),n}(e,t-22,n[1]);return{cmo:n,ft:r}}},94:{},95:{f:zz},96:{},97:{},99:{f:zz},125:{f:LV},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,a){var n=a&&8==a.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:Hz},131:{f:zz},132:{f:zz},133:{f:function(e,t,a){var n=e.read_shift(4),r=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var o=Yz(e,0,a);return 0===o.length&&(o="Sheet1"),{pos:n,hs:r,dt:i,name:o}}},134:{},140:{f:function(e){var t,a=[0,0];return t=e.read_shift(2),a[0]=YU[t]||t,t=e.read_shift(2),a[1]=YU[t]||t,a}},141:{f:Hz},144:{},146:{f:function(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(rV(e));return a}},151:{},152:{},153:{},154:{},155:{},156:{f:Hz},157:{},158:{},160:{f:OV},161:{f:function(e,t){var a={};return t<32||(e.l+=16,a.header=BU(e),a.footer=BU(e),e.l+=2),a}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var a=e.l+t-2,n=e.read_shift(2),r=e.read_shift(2),i=[];e.l<a;)i.push(lV(e));if(e.l!==a)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-r+1)throw new Error("MulRK length mismatch");return{r:n,c:r,C:o,rkrec:i}}},190:{f:function(e,t){for(var a=e.l+t-2,n=e.read_shift(2),r=e.read_shift(2),i=[];e.l<a;)i.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-r+1)throw new Error("MulBlank length mismatch");return{r:n,c:r,C:o,ixfe:i}}},193:{f:Uz},197:{},198:{},199:{},200:{},201:{},202:{f:zz},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Hz},220:{},221:{f:zz},222:{},224:{f:function(e,t,a){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,a,n){var r={},i=e.read_shift(4),o=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return r.patternType=jU[s>>26],n.cellStyles?(r.alc=7&i,r.fWrap=i>>3&1,r.alcV=i>>4&7,r.fJustLast=i>>7&1,r.trot=i>>8&255,r.cIndent=i>>16&15,r.fShrinkToFit=i>>20&1,r.iReadOrder=i>>22&2,r.fAtrNum=i>>26&1,r.fAtrFnt=i>>27&1,r.fAtrAlc=i>>28&1,r.fAtrBdr=i>>29&1,r.fAtrPat=i>>30&1,r.fAtrProt=i>>31&1,r.dgLeft=15&o,r.dgRight=o>>4&15,r.dgTop=o>>8&15,r.dgBottom=o>>12&15,r.icvLeft=o>>16&127,r.icvRight=o>>23&127,r.grbitDiag=o>>30&3,r.icvTop=127&s,r.icvBottom=s>>7&127,r.icvDiag=s>>14&127,r.dgDiag=s>>21&15,r.icvFore=127&l,r.icvBack=l>>7&127,r.fsxButton=l>>14&1,r):r}(e,0,n.fStyle,a),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Uz},227:{},229:{f:function(e,t){for(var a=[],n=e.read_shift(2);n--;)a.push(cV(e));return a}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var a=e.l+t,n=e.read_shift(4),r=e.read_shift(4),i=[],o=0;o!=r&&e.l<a;++o)i.push(jz(e));return i.Count=n,i.Unique=r,i}},253:{f:function(e){var t=iV(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var a={};return a.dsst=e.read_shift(2),e.l+=t-2,a}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Wz},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zz},353:{f:Uz},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,a){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);if(a.sbcch=i,1025==i||14849==i)return[i,r];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=$z(e,i),s=[];n>e.l;)s.push(Kz(e));return[i,r,o,s]}},431:{f:zz},432:{},433:{},434:{},437:{},438:{f:function(e,t,a){var n=e.l,r="";try{e.l+=4;var i=(a.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[t,a]}(e);var o=e.read_shift(2);e.read_shift(2),Hz(e);var s=e.read_shift(2);e.l+=s;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((r+=$z(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?o:2*o))break}if(r.length!==o&&r.length!==2*o)throw new Error("cchText: "+o+" != "+r.length);return e.l=n+t,{t:r}}catch(TQe){return e.l=n+t,{t:r}}}},439:{f:zz},440:{f:function(e,t){var a=cV(e);e.l+=16;var n=function(e,t){var a=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var r=e.read_shift(2);e.l+=2;var i,o,s,l,c,u,d="";16&r&&(i=eV(e,e.l)),128&r&&(o=eV(e,e.l)),257&~r||(s=eV(e,e.l)),1==(257&r)&&(l=Qz(e,e.l)),8&r&&(d=eV(e,e.l)),32&r&&(c=e.read_shift(16)),64&r&&(u=Sz(e)),e.l=a;var h=o||s||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&r&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var p={Target:h};return c&&(p.guid=c),u&&(p.time=u),i&&(p.Tooltip=i),p}(e,t-24);return[a,n]}},441:{},442:{f:Kz},443:{},444:{f:Hz},445:{},446:{},448:{f:Uz},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Uz},512:{f:_V},513:{f:NV},515:{f:function(e,t,a){a.biffguess&&2==a.biff&&(a.biff=5);var n=iV(e),r=BU(e);return n.val=r,n}},516:{f:function(e,t,a){a.biffguess&&2==a.biff&&(a.biff=5),e.l;var n=iV(e);2==a.biff&&e.l++;var r=Kz(e,e.l,a);return n.val=r,n}},517:{f:MV},519:{f:FV},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var a=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=a/20),t}},523:{},545:{f:IV},549:{f:bV},566:{},574:{f:function(e,t,a){return a&&a.biff>=2&&a.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),a=e.read_shift(2),n=lV(e);return{r:t,c:a,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,a){return[e.read_shift(2),Zz(e,0,a)]}},1084:{},1212:{f:function(e,t,a){var n=dV(e);e.l++;var r=e.read_shift(1);return[KG(e,t-=8,a),r,n]}},2048:{f:function(e,t){e.read_shift(2);var a=cV(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[a,n=n.replace(EN,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:vV},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Uz},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),r=[];n-- >0;)r.push(iG(e,e.l));return{ixfe:a,ext:r}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zz,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,a){if(!(a.biff<8)){var n=e.read_shift(2),r=e.read_shift(2);return[$z(e,n,a),$z(e,r,a)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,a){var n=e.l+t;if(124226!==e.read_shift(4))if(a.cellStyles){var r,i=e.slice(e.l);e.l=n;try{r=iF(i,{type:"array"})}catch(TQe){return}var o=tF(r,"theme/theme/theme1.xml",!0);if(o)return aG(o,a)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Uz},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:t,flags:a}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Hz},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,a){var n={area:!1};if(5!=a.biff)return e.l+=t,n;var r=e.read_shift(1);return e.l+=3,16&r&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(rV(e));return a}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_V},1:{},2:{f:function(e){var t=iV(e);++e.l;var a=e.read_shift(2);return t.t="n",t.val=a,t}},3:{f:function(e){var t=iV(e);++e.l;var a=BU(e);return t.t="n",t.val=a,t}},4:{f:function(e,t,a){a.biffguess&&5==a.biff&&(a.biff=2);var n=iV(e);++e.l;var r=Zz(e,0,a);return n.t="str",n.val=r,n}},5:{f:MV},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:vV},11:{},22:{f:Hz},30:{f:wV},31:{},32:{},33:{f:IV},36:{},37:{f:bV},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Hz},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(4),r={fmt:t,env:a,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,r}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,a){var n=e.l+t,r=iV(e),i=e.read_shift(2),o=$z(e,i,a);return e.l=n,r.t="str",r.val=o,r}},223:{},234:{},354:{},421:{},518:{f:ZG},521:{f:vV},536:{f:AV},547:{f:kV},561:{},579:{},1030:{f:ZG},1033:{f:vV},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rY(e,t,a,n){var r=t;if(!isNaN(r)){var i=n||(a||[]).length||0,o=e.next(4);o.write_shift(2,r),o.write_shift(2,i),i>0&&DB(a)&&e.push(a)}}function iY(e,t,a){return e||(e=jB(7)),e.write_shift(2,t),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function oY(e,t,a,n){if(null!=t.v)switch(t.t){case"d":case"n":var r="d"==t.t?PO(HO(t.v)):t.v;return void(r==(0|r)&&r>=0&&r<65536?rY(e,2,function(e,t,a){var n=jB(9);return iY(n,e,t),n.write_shift(2,a),n}(a,n,r)):rY(e,3,function(e,t,a){var n=jB(15);return iY(n,e,t),n.write_shift(8,a,"f"),n}(a,n,r)));case"b":case"e":return void rY(e,5,function(e,t,a,n){var r=jB(9);return iY(r,e,t),qz(a,n||"b",r),r}(a,n,t.v,t.t));case"s":case"str":return void rY(e,4,function(e,t,a){var n=jB(8+2*a.length);return iY(n,e,t),n.write_shift(1,a.length),n.write_shift(a.length,a,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(a,n,(t.v||"").slice(0,255)))}rY(e,1,iY(null,a,n))}function sY(e,t){for(var a=t||{},n=$B(),r=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==a.sheet&&(r=i);if(0==r&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return rY(n,4==a.biff?1033:3==a.biff?521:9,gV(0,16,a)),function(e,t,a,n){var r,i=Array.isArray(t),o=cU(t["!ref"]||"A1"),s="",l=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),r=lU(o)}for(var c=o.s.r;c<=o.e.r;++c){s=aU(c);for(var u=o.s.c;u<=o.e.c;++u){c===o.s.r&&(l[u]=rU(u)),r=l[u]+s;var d=i?(t[c]||[])[u]:t[r];d&&oY(e,d,c,u)}}}(n,e.Sheets[e.SheetNames[r]],0,a),rY(n,10),n.end()}function lY(e,t,a){rY(e,49,function(e,t){var a=e.name||"Arial",n=t&&5==t.biff,r=jB(n?15+a.length:16+2*a.length);return r.write_shift(2,20*e.sz),r.write_shift(4,0),r.write_shift(2,400),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(1,a.length),n||r.write_shift(1,1),r.write_shift((n?1:2)*a.length,a,n?"sbcs":"utf16le"),r}({sz:12,name:"Arial"},a))}function cY(e,t){if(t){var a=0;t.forEach(function(t,n){++a<=256&&t&&rY(e,125,function(e,t){var a=jB(12);a.write_shift(2,t),a.write_shift(2,t),a.write_shift(2,256*e.width),a.write_shift(2,0);var n=0;return e.hidden&&(n|=1),a.write_shift(1,n),n=e.level||0,a.write_shift(1,n),a.write_shift(2,0),a}(mW(n,t),n))})}}function uY(e,t,a,n,r){var i=16+gW(r.cellXfs,t,r);if(null!=t.v||t.bf)if(t.bf)rY(e,6,JG(t,a,n,0,i));else switch(t.t){case"d":case"n":rY(e,515,function(e,t,a,n){var r=jB(14);return oV(e,t,n,r),UU(a,r),r}(a,n,"d"==t.t?PO(HO(t.v)):t.v,i));break;case"b":case"e":rY(e,517,function(e,t,a,n,r,i){var o=jB(8);return oV(e,t,n,o),qz(a,i,o),o}(a,n,t.v,i,0,t.t));break;case"s":case"str":if(r.bookSST)rY(e,253,function(e,t,a,n){var r=jB(10);return oV(e,t,n,r),r.write_shift(4,a),r}(a,n,fW(r.Strings,t.v,r.revStrings),i));else rY(e,516,function(e,t,a,n,r){var i=!r||8==r.biff,o=jB(+i+8+(1+i)*a.length);return oV(e,t,n,o),o.write_shift(2,a.length),i&&o.write_shift(1,1),o.write_shift((1+i)*a.length,a,i?"utf16le":"sbcs"),o}(a,n,(t.v||"").slice(0,255),i,r));break;default:rY(e,513,oV(a,n,i))}else rY(e,513,oV(a,n,i))}function dY(e,t,a){var n,r,i=$B(),o=a.SheetNames[e],s=a.Sheets[o]||{},l=(a||{}).Workbook||{},c=(l.Sheets||[])[e]||{},u=Array.isArray(s),d=8==t.biff,h="",p=[],f=cU(s["!ref"]||"A1"),m=d?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}rY(i,2057,gV(0,16,t)),rY(i,13,Gz(1)),rY(i,12,Gz(100)),rY(i,15,Vz(!0)),rY(i,17,Vz(!1)),rY(i,16,UU(.001)),rY(i,95,Vz(!0)),rY(i,42,Vz(!1)),rY(i,43,Vz(!1)),rY(i,130,Gz(1)),rY(i,128,((r=jB(8)).write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r)),rY(i,131,Vz(!1)),rY(i,132,Vz(!1)),d&&cY(i,s["!cols"]),rY(i,512,function(e,t){var a=8!=t.biff&&t.biff?2:4,n=jB(2*a+6);return n.write_shift(a,e.s.r),n.write_shift(a,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(f,t)),d&&(s["!links"]=[]);for(var v=f.s.r;v<=f.e.r;++v){h=aU(v);for(var g=f.s.c;g<=f.e.c;++g){v===f.s.r&&(p[g]=rU(g)),n=p[g]+h;var y=u?(s[v]||[])[g]:s[n];y&&(uY(i,y,v,g,t),d&&y.l&&s["!links"].push([n,y.l]))}}var b=c.CodeName||c.name||o;return d&&rY(i,574,function(e){var t=jB(18),a=1718;return e&&e.RTL&&(a|=64),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&rY(i,229,function(e){var t=jB(2+8*e.length);t.write_shift(2,e.length);for(var a=0;a<e.length;++a)uV(e[a],t);return t}(s["!merges"])),d&&function(e,t){for(var a=0;a<t["!links"].length;++a){var n=t["!links"][a];rY(e,440,DV(n)),n[1].Tooltip&&rY(e,2048,PV(n))}delete t["!links"]}(i,s),rY(i,442,Jz(b)),d&&function(e,t){var a=jB(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),rY(e,2151,a),(a=jB(39)).write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),uV(cU(t["!ref"]||"A1"),a),a.write_shift(4,4),rY(e,2152,a)}(i,s),rY(i,10),i.end()}function hY(e,t,a){var n,r=$B(),i=(e||{}).Workbook||{},o=i.Sheets||[],s=i.WBProps||{},l=8==a.biff,c=5==a.biff;(rY(r,2057,gV(0,5,a)),"xla"==a.bookType&&rY(r,135),rY(r,225,l?Gz(1200):null),rY(r,193,function(e,t){t||(t=jB(e));for(var a=0;a<e;++a)t.write_shift(1,0);return t}(2)),c&&rY(r,191),c&&rY(r,192),rY(r,226),rY(r,92,function(e,t){var a=!t||8==t.biff,n=jB(a?112:54);for(n.write_shift(8==t.biff?2:1,7),a&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(a?0:536870912));n.l<n.length;)n.write_shift(1,a?0:32);return n}(0,a)),rY(r,66,Gz(l?1200:1252)),l&&rY(r,353,Gz(0)),l&&rY(r,448),rY(r,317,function(e){for(var t=jB(2*e),a=0;a<e;++a)t.write_shift(2,a+1);return t}(e.SheetNames.length)),l&&e.vbaraw&&rY(r,211),l&&e.vbaraw)&&rY(r,442,Jz(s.CodeName||"ThisWorkbook"));rY(r,156,Gz(17)),rY(r,25,Vz(!1)),rY(r,18,Vz(!1)),rY(r,19,Gz(0)),l&&rY(r,431,Vz(!1)),l&&rY(r,444,Gz(0)),rY(r,61,((n=jB(18)).write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n)),rY(r,64,Vz(!1)),rY(r,141,Gz(0)),rY(r,34,Vz("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&TF(e.Workbook.WBProps.date1904)?"true":"false"}(e))),rY(r,14,Vz(!0)),l&&rY(r,439,Vz(!1)),rY(r,218,Gz(0)),lY(r,0,a),function(e,t,a){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&rY(e,1054,xV(r,t[r],a))})}(r,e.SSF,a),function(e,t){for(var a=0;a<16;++a)rY(e,224,SV({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){rY(e,224,SV(a,0,t))})}(r,a),l&&rY(r,352,Vz(!1));var u=r.end(),d=$B();l&&rY(d,140,function(e){return e||(e=jB(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),l&&a.Strings&&function(e,t,a){var n=(a||[]).length||0;if(n<=8224)return rY(e,t,a,n);var r=t;if(!isNaN(r)){for(var i=a.parts||[],o=0,s=0,l=0;l+(i[o]||8224)<=8224;)l+=i[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,r),c.write_shift(2,l),e.push(a.slice(s,s+l)),s+=l;s<n;){for((c=e.next(4)).write_shift(2,60),l=0;l+(i[o]||8224)<=8224;)l+=i[o]||8224,o++;c.write_shift(2,l),e.push(a.slice(s,s+l)),s+=l}}}(d,252,function(e){var t=jB(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=Xz(e[n]);var r=AN([t].concat(a));return r.parts=[t.length].concat(a.map(function(e){return e.length})),r}(a.Strings)),rY(d,10);var h=d.end(),p=$B(),f=0,m=0;for(m=0;m<e.SheetNames.length;++m)f+=(l?12:11)+(l?2:1)*e.SheetNames[m].length;var v=u.length+f+h.length;for(m=0;m<e.SheetNames.length;++m){rY(p,133,yV({pos:v,hs:(o[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},a)),v+=t[m].length}var g=p.end();if(f!=g.length)throw new Error("BS8 "+f+" != "+g.length);var y=[];return u.length&&y.push(u),g.length&&y.push(g),h.length&&y.push(h),AN(y)}function pY(e,t){for(var a=0;a<=e.SheetNames.length;++a){var n=e.Sheets[e.SheetNames[a]];if(n&&n["!ref"])sU(n["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}var r=t||{};switch(r.biff||2){case 8:case 5:return function(e,t){var a=t||{},n=[];e&&!e.SSF&&(e.SSF=WO(zN)),e&&e.SSF&&(wO(),xO(e.SSF),a.revssf=RO(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,nj(a),a.cellXfs=[],gW(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var r=0;r<e.SheetNames.length;++r)n[n.length]=dY(r,a,e);return n.unshift(hY(e,n,a)),AN(n)}(e,t);case 4:case 3:case 2:return sY(e,t)}throw new Error("invalid type "+r.bookType+" for BIFF")}function fY(e,t){var a=t||{},n=a.dense?[]:{},r=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=r.index,s=i&&i.index||e.length,l=$O(e.slice(o,s),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},f=[];for(o=0;o<l.length;++o){var m=l[o].trim(),v=m.slice(0,3).toLowerCase();if("<tr"!=v){if("<td"==v||"<th"==v){var g=m.split(/<\/t[dh]>/i);for(s=0;s<g.length;++s){var y=g[s].trim();if(y.match(/<t[dh]/i)){for(var b=y,x=0;"<"==b.charAt(0)&&(x=b.indexOf(">"))>-1;)b=b.slice(x+1);for(var w=0;w<f.length;++w){var _=f[w];_.s.c==u&&_.s.r<c&&c<=_.e.r&&(u=_.e.c+1,w=-1)}var S=pF(y.slice(0,y.indexOf(">")));h=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||h>1)&&f.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var M=S.t||S["data-t"]||"";if(b.length)if(b=PF(b),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),b.length){var T={t:"s",v:b};a.raw||!b.trim().length||"s"==M||("TRUE"===b?T={t:"b",v:!0}:"FALSE"===b?T={t:"b",v:!1}:isNaN(YO(b))?isNaN(XO(b).getDate())||(T={t:"d",v:HO(b)},a.cellDates||(T={t:"n",v:PO(T.v)}),T.z=a.dateNF||zN[14]):T={t:"n",v:YO(b)}),a.dense?(n[c]||(n[c]=[]),n[c][u]=T):n[oU({r:c,c:u})]=T,u+=h}else u+=h;else u+=h}}}}else{if(++c,a.sheetRows&&a.sheetRows<=c){--c;break}u=0}}return n["!ref"]=lU(p),f.length&&(n["!merges"]=f),n}function mY(e,t,a,n){for(var r=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var s=0,l=0,c=0;c<r.length;++c)if(!(r[c].s.r>a||r[c].s.c>o||r[c].e.r<a||r[c].e.c<o)){if(r[c].s.r<a||r[c].s.c<o){s=-1;break}s=r[c].e.r-r[c].s.r+1,l=r[c].e.c-r[c].s.c+1;break}if(!(s<0)){var u=oU({r:a,c:o}),d=n.dense?(e[a]||[])[o]:e[u],h=d&&null!=d.v&&(d.h||SF(d.w||(dU(d),d.w)||""))||"",p={};s>1&&(p.rowspan=s),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",null!=d.v&&(p["data-v"]=d.v),null!=d.z&&(p["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(VF("td",h,p))}}return"<tr>"+i.join("")+"</tr>"}function vY(e,t){var a=t||{},n=null!=a.header?a.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',r=null!=a.footer?a.footer:"</body></html>",i=[n],o=sU(e["!ref"]);a.dense=Array.isArray(e),i.push(function(e,t,a){return[].join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}(0,0,a));for(var s=o.s.r;s<=o.e.r;++s)i.push(mY(e,o,s,a));return i.push("</table>"+r),i.join("")}function gY(e,t,a){var n=a||{},r=0,i=0;if(null!=n.origin)if("number"==typeof n.origin)r=n.origin;else{var o="string"==typeof n.origin?iU(n.origin):n.origin;r=o.r,i=o.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:r,c:i}};if(e["!ref"]){var u=sU(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==r&&(c.e.r=r=u.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),f=0,m=0,v=0,g=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);f<s.length&&m<l;++f){var x=s[f];if(bY(x)){if(n.display)continue;p[m]={hidden:!0}}var w=x.children;for(v=g=0;v<w.length;++v){var _=w[v];if(!n.display||!bY(_)){var S=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):PF(_.innerHTML),M=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<d.length;++h){var T=d[h];T.s.c==g+i&&T.s.r<m+r&&m+r<=T.e.r&&(g=T.e.c+1-i,h=-1)}b=+_.getAttribute("colspan")||1,((y=+_.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:m+r,c:g+i},e:{r:m+r+(y||1)-1,c:g+i+(b||1)-1}});var k={t:"s",v:S},C=_.getAttribute("data-t")||_.getAttribute("t")||"";null!=S&&(0==S.length?k.t=C||"z":n.raw||0==S.trim().length||"s"==C||("TRUE"===S?k={t:"b",v:!0}:"FALSE"===S?k={t:"b",v:!1}:isNaN(YO(S))?isNaN(XO(S).getDate())||(k={t:"d",v:HO(S)},n.cellDates||(k={t:"n",v:PO(k.v)}),k.z=n.dateNF||zN[14]):k={t:"n",v:YO(S)})),void 0===k.z&&null!=M&&(k.z=M);var A="",E=_.getElementsByTagName("A");if(E&&E.length)for(var I=0;I<E.length&&(!E[I].hasAttribute("href")||"#"==(A=E[I].getAttribute("href")).charAt(0));++I);A&&"#"!=A.charAt(0)&&(k.l={Target:A}),n.dense?(e[m+r]||(e[m+r]=[]),e[m+r][g+i]=k):e[oU({c:g+i,r:m+r})]=k,c.e.c<g+i&&(c.e.c=g+i),g+=b}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+r),e["!ref"]=lU(c),m>=l&&(e["!fullref"]=lU((c.e.r=s.length-f+m-1+r,c))),e}function yY(e,t){return gY((t||{}).dense?[]:{},e,t)}function bY(e){var t="",a=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return a&&(t=a(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function xY(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[gF(t.replace(/<[^>]*>/g,""))]}var wY={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _Y(e,t){var a,n,r,i,o,s,l=t||{},c=GF(e),u=[],d={name:""},h="",p=0,f={},m=[],v=l.dense?[]:{},g={value:""},y="",b=0,x=[],w=-1,_=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,T={},k=[],C={},A=[],E=1,I=1,R=[],D={Names:[]},P={},L=["",""],N=[],O={},F="",B=0,U=!1,z=!1,V=0;for(WF.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=WF.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===o[1]?(S.e.c>=S.s.c&&S.e.r>=S.s.r?v["!ref"]=lU(S):v["!ref"]="A1:A1",l.sheetRows>0&&l.sheetRows<=S.e.r&&(v["!fullref"]=v["!ref"],S.e.r=l.sheetRows-1,v["!ref"]=lU(S)),k.length&&(v["!merges"]=k),A.length&&(v["!rows"]=A),r.name=r["名称"]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),m.push(r.name),f[r.name]=v,z=!1):"/"!==o[0].charAt(o[0].length-2)&&(r=pF(o[0],!1),w=_=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,v=l.dense?[]:{},k=[],A=[],z=!0);break;case"table-row-group":"/"===o[1]?--M:++M;break;case"table-row":case"行":if("/"===o[1]){w+=E,E=1;break}if((i=pF(o[0],!1))["行号"]?w=i["行号"]-1:-1==w&&(w=0),(E=+i["number-rows-repeated"]||1)<10)for(V=0;V<E;++V)M>0&&(A[w+V]={level:M});_=-1;break;case"covered-table-cell":"/"!==o[1]&&++_,l.sheetStubs&&(l.dense?(v[w]||(v[w]=[]),v[w][_]={t:"z"}):v[oU({r:w,c:_})]={t:"z"}),y="",x=[];break;case"table-cell":case"数据":if("/"===o[0].charAt(o[0].length-2))++_,g=pF(o[0],!1),I=parseInt(g["number-columns-repeated"]||"1",10),s={t:"z",v:null},g.formula&&0!=l.cellFormula&&(s.f=sW(gF(g.formula))),"string"==(g["数据类型"]||g["value-type"])&&(s.t="s",s.v=gF(g["string-value"]||""),l.dense?(v[w]||(v[w]=[]),v[w][_]=s):v[oU({r:w,c:_})]=s),_+=I-1;else if("/"!==o[1]){y="",b=0,x=[],I=1;var H=E?w+E-1:w;if(++_>S.e.c&&(S.e.c=_),_<S.s.c&&(S.s.c=_),w<S.s.r&&(S.s.r=w),H>S.e.r&&(S.e.r=H),N=[],O={},s={t:(g=pF(o[0],!1))["数据类型"]||g["value-type"],v:null},l.cellFormula)if(g.formula&&(g.formula=gF(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(C={s:{r:w,c:_},e:{r:w+(parseInt(g["number-matrix-rows-spanned"],10)||0)-1,c:_+(parseInt(g["number-matrix-columns-spanned"],10)||0)-1}},s.F=lU(C),R.push([C,s.F])),g.formula)s.f=sW(g.formula);else for(V=0;V<R.length;++V)w>=R[V][0].s.r&&w<=R[V][0].e.r&&_>=R[V][0].s.c&&_<=R[V][0].e.c&&(s.F=R[V][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(C={s:{r:w,c:_},e:{r:w+(parseInt(g["number-rows-spanned"],10)||0)-1,c:_+(parseInt(g["number-columns-spanned"],10)||0)-1}},k.push(C)),g["number-columns-repeated"]&&(I=parseInt(g["number-columns-repeated"],10)),s.t){case"boolean":s.t="b",s.v=TF(g["boolean-value"]);break;case"float":case"percentage":case"currency":s.t="n",s.v=parseFloat(g.value);break;case"date":s.t="d",s.v=HO(g["date-value"]),l.cellDates||(s.t="n",s.v=PO(s.v)),s.z="m/d/yy";break;case"time":s.t="n",s.v=BO(g["time-value"])/86400,l.cellDates&&(s.t="d",s.v=FO(s.v)),s.z="HH:MM:SS";break;case"number":s.t="n",s.v=parseFloat(g["数据数值"]);break;default:if("string"!==s.t&&"text"!==s.t&&s.t)throw new Error("Unsupported value type "+s.t);s.t="s",null!=g["string-value"]&&(y=gF(g["string-value"]),x=[])}}else{if(U=!1,"s"===s.t&&(s.v=y||"",x.length&&(s.R=x),U=0==b),P.Target&&(s.l=P),N.length>0&&(s.c=N,N=[]),y&&!1!==l.cellText&&(s.w=y),U&&(s.t="z",delete s.v),(!U||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=w))for(var G=0;G<E;++G){if(I=parseInt(g["number-columns-repeated"]||"1",10),l.dense)for(v[w+G]||(v[w+G]=[]),v[w+G][_]=0==G?s:WO(s);--I>0;)v[w+G][_+I]=WO(s);else for(v[oU({r:w+G,c:_})]=s;--I>0;)v[oU({r:w+G,c:_+I})]=WO(s);S.e.c<=_&&(S.e.c=_)}_+=(I=parseInt(g["number-columns-repeated"]||"1",10))-1,I=0,s={},y="",x=[]}P={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((a=u.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((a=u.pop())[0]!==o[3])throw"Bad state: "+a;O.t=y,x.length&&(O.R=x),O.a=F,N.push(O)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",B=0,y="",b=0,x=[];break;case"creator":"/"===o[1]?F=c.slice(B,o.index):B=o.index+o[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((a=u.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,x=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(T[d.name]=h,(a=u.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&(h="",d=pF(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":n=pF(o[0],!1),h+=wY[o[3]]["long"===n.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(p,o.index)}else p=o.index+o[0].length;break;case"named-range":L=cW((n=pF(o[0],!1))["cell-range-address"]);var W={Name:n.name,Ref:L[0]+"!"+L[1]};z&&(W.Sheet=m.length),D.Names.push(W);break;case"p":case"文本串":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||g&&g["string-value"])pF(o[0],!1),b=o.index+o[0].length;else{var q=xY(c.slice(b,o.index));y=(y.length>0?y+"\n":"")+q[0]}break;case"database-range":if("/"===o[1])break;try{f[(L=cW(pF(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:L[1]}}catch(TQe){}break;case"a":if("/"!==o[1]){if(!(P=pF(o[0],!1)).href)break;P.Target=gF(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(L=cW(P.Target.slice(1)),P.Target="#"+L[0]+"!"+L[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(l.WTF)throw new Error(o)}}var Y={Sheets:f,SheetNames:m,Workbook:D};return l.bookSheets&&delete Y.Sheets,Y}function SY(e,t){t=t||{},JO(e,"META-INF/manifest.xml")&&function(e,t){for(var a,n,r=GF(e);a=WF.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if("/"==(n=pF(a[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}(eF(e,"META-INF/manifest.xml"),t);var a=tF(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var n=_Y(IF(a),t);return JO(e,"meta.xml")&&(n.Props=dz(eF(e,"meta.xml"))),n}function MY(e,t){return _Y(e,t)}var TY=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+zF({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return sF+t}}(),kY=function(){var e=function(e){return xF(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",a=function(a,n,r){var i=[];i.push('      <table:table table:name="'+xF(n.SheetNames[r])+'" table:style-name="ta1">\n');var o=0,s=0,l=sU(a["!ref"]||"A1"),c=a["!merges"]||[],u=0,d=Array.isArray(a);if(a["!cols"])for(s=0;s<=l.e.c;++s)i.push("        <table:table-column"+(a["!cols"][s]?' table:style-name="co'+a["!cols"][s].ods+'"':"")+"></table:table-column>\n");var h="",p=a["!rows"]||[];for(o=0;o<l.s.r;++o)h=p[o]?' table:style-name="ro'+p[o].ods+'"':"",i.push("        <table:table-row"+h+"></table:table-row>\n");for(;o<=l.e.r;++o){for(h=p[o]?' table:style-name="ro'+p[o].ods+'"':"",i.push("        <table:table-row"+h+">\n"),s=0;s<l.s.c;++s)i.push(t);for(;s<=l.e.c;++s){var f=!1,m={},v="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>s||c[u].s.r>o||c[u].e.c<s||c[u].e.r<o)){c[u].s.c==s&&c[u].s.r==o||(f=!0),m["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,m["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(f)i.push("          <table:covered-table-cell/>\n");else{var g=oU({r:o,c:s}),y=d?(a[o]||[])[s]:a[g];if(y&&y.f&&(m["table:formula"]=xF(lW(y.f)),y.F&&y.F.slice(0,g.length)==g)){var b=sU(y.F);m["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,m["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":v=y.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=y.v?"true":"false";break;case"n":v=y.w||String(y.v||0),m["office:value-type"]="float",m["office:value"]=y.v||0;break;case"s":case"str":v=null==y.v?"":y.v,m["office:value-type"]="string";break;case"d":v=y.w||HO(y.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=HO(y.v).toISOString(),m["table:style-name"]="ce1";break;default:i.push(t);continue}var x=e(v);if(y.l&&y.l.Target){var w=y.l.Target;"#"==(w="#"==w.charAt(0)?"#"+uW(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),x=VF("text:a",x,{"xlink:href":w.replace(/&/g,"&amp;")})}i.push("          "+VF("table:table-cell",VF("text:p",x,{}),m)+"\n")}else i.push(t)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,t){var n=[sF],r=zF({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=zF({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(n.push("<office:document"+r+i+">\n"),n.push(lz().replace(/office:document-meta/g,"office:meta"))):n.push("<office:document-content"+r+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var a=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var r=t["!cols"][n];if(null==r.width&&null==r.wpx&&null==r.wch)continue;kH(r),r.ods=a;var i=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+a+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++a}});var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var a=0;a<t["!rows"].length;++a)if(t["!rows"][a]){t["!rows"][a].ods=n;var r=t["!rows"][a].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+r+'"/>\n'),e.push("  </style:style>\n"),++n}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(n,e),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var o=0;o!=e.SheetNames.length;++o)n.push(a(e.Sheets[e.SheetNames[o]],e,o));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==t.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function CY(e,t){if("fods"==t.bookType)return kY(e,t);var a=rF(),n="",r=[],i=[];return nF(a,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),nF(a,n="content.xml",kY(e,t)),r.push([n,"text/xml"]),i.push([n,"ContentFile"]),nF(a,n="styles.xml",TY(e,t)),r.push([n,"text/xml"]),i.push([n,"StylesFile"]),nF(a,n="meta.xml",sF+lz()),r.push([n,"text/xml"]),i.push([n,"MetadataFile"]),nF(a,n="manifest.rdf",function(e){var t=[sF];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var a=0;a!=e.length;++a)t.push(oz(e[a][0],e[a][1])),t.push(sz("",e[a][0]));return t.push(oz("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(i)),r.push([n,"application/rdf+xml"]),nF(a,n="META-INF/manifest.xml",function(e){var t=[sF];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var a=0;a<e.length;++a)t.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(r)),a}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function AY(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function EY(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):IF(kN(e))}function IY(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):MN(RF(e))}function RY(e){var t=e.reduce(function(e,t){return e+t.length},0),a=new Uint8Array(t),n=0;return e.forEach(function(e){a.set(e,n),n+=e.length}),a}function DY(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function PY(e,t){var a=t?t[0]:0,n=127&e[a];e:if(e[a++]>=128){if(n|=(127&e[a])<<7,e[a++]<128)break e;if(n|=(127&e[a])<<14,e[a++]<128)break e;if(n|=(127&e[a])<<21,e[a++]<128)break e;if(n+=(127&e[a])*Math.pow(2,28),++a,e[a++]<128)break e;if(n+=(127&e[a])*Math.pow(2,35),++a,e[a++]<128)break e;if(n+=(127&e[a])*Math.pow(2,42),++a,e[a++]<128)break e}return t&&(t[0]=a),n}function LY(e){var t=new Uint8Array(7);t[0]=127&e;var a=1;e:if(e>127){if(t[a-1]|=128,t[a]=e>>7&127,++a,e<=16383)break e;if(t[a-1]|=128,t[a]=e>>14&127,++a,e<=2097151)break e;if(t[a-1]|=128,t[a]=e>>21&127,++a,e<=268435455)break e;if(t[a-1]|=128,t[a]=e/256>>>21&127,++a,e<=34359738367)break e;if(t[a-1]|=128,t[a]=e/65536>>>21&127,++a,e<=4398046511103)break e;t[a-1]|=128,t[a]=e/16777216>>>21&127,++a}return t.slice(0,a)}function NY(e){var t=0,a=127&e[t];e:if(e[t++]>=128){if(a|=(127&e[t])<<7,e[t++]<128)break e;if(a|=(127&e[t])<<14,e[t++]<128)break e;if(a|=(127&e[t])<<21,e[t++]<128)break e;a|=(127&e[t])<<28}return a}function OY(e){for(var t=[],a=[0];a[0]<e.length;){var n,r=a[0],i=PY(e,a),o=7&i,s=0;if(0==(i=Math.floor(i/8)))break;switch(o){case 0:for(var l=a[0];e[a[0]++]>=128;);n=e.slice(l,a[0]);break;case 5:s=4,n=e.slice(a[0],a[0]+s),a[0]+=s;break;case 1:s=8,n=e.slice(a[0],a[0]+s),a[0]+=s;break;case 2:s=PY(e,a),n=e.slice(a[0],a[0]+s),a[0]+=s;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(r))}var c={data:n,type:o};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function FY(e){var t=[];return e.forEach(function(e,a){e.forEach(function(e){e.data&&(t.push(LY(8*a+e.type)),2==e.type&&t.push(LY(e.data.length)),t.push(e.data))})}),RY(t)}function BY(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function UY(e){for(var t,a=[],n=[0];n[0]<e.length;){var r=PY(e,n),i=OY(e.slice(n[0],n[0]+r));n[0]+=r;var o={id:NY(i[1][0].data),messages:[]};i[2].forEach(function(t){var a=OY(t.data),r=NY(a[3][0].data);o.messages.push({meta:a,data:e.slice(n[0],n[0]+r)}),n[0]+=r}),(null==(t=i[3])?void 0:t[0])&&(o.merge=NY(i[3][0].data)>>>0>0),a.push(o)}return a}function zY(e){var t=[];return e.forEach(function(e){var a=[];a[1]=[{data:LY(e.id),type:0}],a[2]=[],null!=e.merge&&(a[3]=[{data:LY(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(e){n.push(e.data),e.meta[3]=[{type:0,data:LY(e.data.length)}],a[2].push({data:FY(e.meta),type:2})});var r=FY(a);t.push(LY(r.length)),t.push(r),n.forEach(function(e){return t.push(e)})}),RY(t)}function VY(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],n=PY(t,a),r=[];a[0]<t.length;){var i=3&t[a[0]];if(0!=i){var o=0,s=0;if(1==i?(s=4+(t[a[0]]>>2&7),o=(224&t[a[0]++])<<3,o|=t[a[0]++]):(s=1+(t[a[0]++]>>2),2==i?(o=t[a[0]]|t[a[0]+1]<<8,a[0]+=2):(o=(t[a[0]]|t[a[0]+1]<<8|t[a[0]+2]<<16|t[a[0]+3]<<24)>>>0,a[0]+=4)),r=[RY(r)],0==o)throw new Error("Invalid offset 0");if(o>r[0].length)throw new Error("Invalid offset beyond length");if(s>=o)for(r.push(r[0].slice(-o)),s-=o;s>=r[r.length-1].length;)r.push(r[r.length-1]),s-=r[r.length-1].length;r.push(r[0].slice(-o,-o+s))}else{var l=t[a[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[a[0]],c>1&&(l|=t[a[0]+1]<<8),c>2&&(l|=t[a[0]+2]<<16),c>3&&(l|=t[a[0]+3]<<24),l>>>=0,l++,a[0]+=c}r.push(t.slice(a[0],a[0]+l)),a[0]+=l}}var u=RY(r);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function HY(e){for(var t=[],a=0;a<e.length;){var n=e[a++],r=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,t.push(VY(n,e.slice(a,a+r))),a+=r}if(a!==e.length)throw new Error("data is not a valid framed stream!");return RY(t)}function GY(e){for(var t=[],a=0;a<e.length;){var n=Math.min(e.length-a,268435455),r=new Uint8Array(4);t.push(r);var i=LY(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(a,a+n)),o+=n,r[0]=0,r[1]=255&o,r[2]=o>>8&255,r[3]=o>>16&255,a+=n}return RY(t)}function WY(e,t,a){var n,r=AY(e),i=r.getUint32(8,!0),o=12,s=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&i&&(c=function(e,t){for(var a=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],r=t+13;r>=t;--r)n=256*n+e[r];return(128&e[t+15]?-n:n)*Math.pow(10,a-6176)}(e,o),o+=16),2&i&&(u=r.getFloat64(o,!0),o+=8),4&i&&(d.setTime(d.getTime()+1e3*r.getFloat64(o,!0)),o+=8),8&i&&(l=r.getUint32(o,!0),o+=4),16&i&&(s=r.getUint32(o,!0),o+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:d};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));n={t:"s",v:a[s]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return n}function qY(e,t){var a=new Uint8Array(32),n=AY(a),r=12,i=0;switch(a[0]=5,e.t){case"n":a[1]=2,function(e,t,a){var n=Math.floor(0==a?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,r=a/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var i=0;r>=1;++i,r/=256)e[t+i]=255&r;e[t+15]|=a>=0?0:128}(a,r,e.v),i|=1,r+=16;break;case"b":a[1]=6,n.setFloat64(r,e.v?1:0,!0),i|=2,r+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,n.setUint32(r,t.indexOf(e.v),!0),i|=8,r+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),a.slice(0,r)}function YY(e,t){var a=new Uint8Array(32),n=AY(a),r=12,i=0;switch(a[0]=3,e.t){case"n":a[2]=2,n.setFloat64(r,e.v,!0),i|=32,r+=8;break;case"b":a[2]=6,n.setFloat64(r,e.v?1:0,!0),i|=32,r+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,n.setUint32(r,t.indexOf(e.v),!0),i|=16,r+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),a.slice(0,r)}function jY(e,t,a){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,a,n){var r,i=AY(e),o=i.getUint32(4,!0),s=(n>1?12:8)+4*DY(o&(n>1?3470:398)),l=-1,c=-1,u=NaN,d=new Date(2001,0,1);switch(512&o&&(l=i.getUint32(s,!0),s+=4),s+=4*DY(o&(n>1?12288:4096)),16&o&&(c=i.getUint32(s,!0),s+=4),32&o&&(u=i.getFloat64(s,!0),s+=8),64&o&&(d.setTime(d.getTime()+1e3*i.getFloat64(s,!0)),s+=8),e[2]){case 0:break;case 2:r={t:"n",v:u};break;case 3:r={t:"s",v:t[c]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(l>-1)r={t:"s",v:a[l]};else if(c>-1)r={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));r={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return r}(e,t,a,e[0]);case 5:return WY(e,t,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function XY(e){return PY(OY(e)[1][0].data)}function $Y(e,t){var a=OY(t.data),n=NY(a[1][0].data),r=a[3],i=[];return(r||[]).forEach(function(t){var a=OY(t.data),r=NY(a[1][0].data)>>>0;switch(n){case 1:i[r]=EY(a[3][0].data);break;case 8:var o=OY(e[XY(a[9][0].data)][0].data),s=e[XY(o[1][0].data)][0],l=NY(s.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=OY(s.data);i[r]=c[3].map(function(e){return EY(e.data)}).join("")}}),i}function KY(e,t){var a,n=OY(t.data),r=(null==(a=null==n?void 0:n[7])?void 0:a[0])?NY(n[7][0].data)>>>0>0?1:0:-1,i=BY(n[5],function(e){return function(e,t){var a,n,r,i,o,s,l,c,u,d,h,p,f,m,v,g,y=OY(e),b=NY(y[1][0].data)>>>0,x=NY(y[2][0].data)>>>0,w=(null==(n=null==(a=y[8])?void 0:a[0])?void 0:n.data)&&NY(y[8][0].data)>0||!1;if((null==(i=null==(r=y[7])?void 0:r[0])?void 0:i.data)&&0!=t)v=null==(s=null==(o=y[7])?void 0:o[0])?void 0:s.data,g=null==(c=null==(l=y[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(d=null==(u=y[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");v=null==(p=null==(h=y[4])?void 0:h[0])?void 0:p.data,g=null==(m=null==(f=y[3])?void 0:f[0])?void 0:m.data}for(var _=w?4:1,S=AY(v),M=[],T=0;T<v.length/2;++T){var k=S.getUint16(2*T,!0);k<65535&&M.push([T,k])}if(M.length!=x)throw"Expected ".concat(x," cells, found ").concat(M.length);var C=[];for(T=0;T<M.length-1;++T)C[M[T][0]]=g.subarray(M[T][1]*_,M[T+1][1]*_);return M.length>=1&&(C[M[M.length-1][0]]=g.subarray(M[M.length-1][1]*_)),{R:b,cells:C}}(e,r)});return{nrows:NY(n[4][0].data)>>>0,data:i.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(a,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=a}),e},[])}}function ZY(e,t){var a={"!ref":"A1"},n=e[XY(OY(t.data)[2][0].data)],r=NY(n[0].meta[1][0].data);if(6001!=r)throw new Error("6000 unexpected reference to ".concat(r));return function(e,t,a){var n,r=OY(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(NY(r[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(i.e.c=(NY(r[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));a["!ref"]=lU(i);var o=OY(r[4][0].data),s=$Y(e,e[XY(o[4][0].data)][0]),l=(null==(n=o[17])?void 0:n[0])?$Y(e,e[XY(o[17][0].data)][0]):[],c=OY(o[3][0].data),u=0;c[1].forEach(function(t){var n=OY(t.data),r=e[XY(n[2][0].data)][0],i=NY(r.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var o=KY(0,r);o.data.forEach(function(e,t){e.forEach(function(e,n){var r=oU({r:u+t,c:n}),i=jY(e,s,l);i&&(a[r]=i)})}),u+=o.nrows})}(e,n[0],a),a}function JY(e,t){var a={SheetNames:[],Sheets:{}};if(BY(OY(t.data)[1],XY).forEach(function(t){e[t].forEach(function(t){if(2==NY(t.meta[1][0].data)){var n=function(e,t){var a,n=OY(t.data),r={name:(null==(a=n[1])?void 0:a[0])?EY(n[1][0].data):"",sheets:[]};return BY(n[2],XY).forEach(function(t){e[t].forEach(function(t){6e3==NY(t.meta[1][0].data)&&r.sheets.push(ZY(e,t))})}),r}(e,t);n.sheets.forEach(function(e,t){Ej(a,e,0==t?n.name:n.name+"_"+t,!0)})}})}),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a}function QY(e){var t,a,n,r,i={},o=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,a;try{t=HY(e.content)}catch(TQe){return console.log("?? "+e.content.length+" "+(TQe.message||TQe))}try{a=UY(t)}catch(TQe){return console.log("## "+(TQe.message||TQe))}a.forEach(function(e){i[e.id]=e.messages,o.push(e.id)})}}),!o.length)throw new Error("File has no messages");var s=(null==(r=null==(n=null==(a=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:a.meta)?void 0:n[1])?void 0:r[0].data)&&1==NY(i[1][0].meta[1][0].data)&&i[1][0];if(s||o.forEach(function(e){i[e].forEach(function(e){if(1==NY(e.meta[1][0].data)>>>0){if(s)throw new Error("Document has multiple roots");s=e}})}),!s)throw new Error("Cannot find Document root");return JY(i,s)}function ej(e,t,a){var n,r,i,o;if(!(null==(n=e[6])?void 0:n[0])||!(null==(r=e[7])?void 0:r[0]))throw"Mutation only works on post-BNC storages!";if((null==(o=null==(i=e[8])?void 0:i[0])?void 0:o.data)&&NY(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var s=0,l=AY(e[7][0].data),c=0,u=[],d=AY(e[4][0].data),h=0,p=[],f=0;f<t.length;++f)if(null!=t[f]){var m,v;switch(l.setUint16(2*f,c,!0),d.setUint16(2*f,h,!0),typeof t[f]){case"string":m=qY({t:"s",v:t[f]},a),v=YY({t:"s",v:t[f]},a);break;case"number":m=qY({t:"n",v:t[f]},a),v=YY({t:"n",v:t[f]},a);break;case"boolean":m=qY({t:"b",v:t[f]},a),v=YY({t:"b",v:t[f]},a);break;default:throw new Error("Unsupported value "+t[f])}u.push(m),c+=m.length,p.push(v),h+=v.length,++s}else l.setUint16(2*f,65535,!0),d.setUint16(2*f,65535);for(e[2][0].data=LY(s);f<e[7][0].data.length/2;++f)l.setUint16(2*f,65535,!0),d.setUint16(2*f,65535,!0);return e[6][0].data=RY(u),e[3][0].data=RY(p),s}function tj(e){return function(t){for(var a=0;a!=e.length;++a){var n=e[a];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function aj(e){tj([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function nj(e){tj([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function rj(e){return tz.WS.indexOf(e)>-1?"sheet":e==tz.CS?"chart":e==tz.DS?"dialog":e==tz.MS?"macro":e&&e.length?e:"sheet"}function ij(e,t,a,n,r,i,o,s,l,c,u,d){try{i[n]=nz(tF(e,a,!0),t);var h,p=eF(e,t);switch(s){case"sheet":h=gq(p,t,r,l,i[n],c,u,d);break;case"chart":if(!(h=yq(p,t,r,l,i[n],c))||!h["!drawel"])break;var f=oF(h["!drawel"].Target,t),m=az(f),v=function(e,t){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][a].Target}(tF(e,f,!0),nz(tF(e,m,!0),f)),g=oF(v,f),y=az(g);h=QW(tF(e,g,!0),0,0,nz(tF(e,y,!0),g),0,h);break;case"macro":x=t,i[n],x.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[n]);break;default:throw new Error("Unrecognized sheet type "+s)}o[n]=h;var b=[];i&&i[n]&&AO(i[n]).forEach(function(a){var r="";if(i[n][a].Type==tz.CMNT){r=oF(i[n][a].Target,t);var o=wq(eF(e,r,!0),r,l);if(!o||!o.length)return;dG(h,o,!1)}i[n][a].Type==tz.TCMNT&&(r=oF(i[n][a].Target,t),b=b.concat(function(e,t){var a=[],n=!1,r={},i=0;return e.replace(uF,function(o,s){var l=pF(o);switch(fF(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":r={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=r.t&&a.push(r);break;case"<text>":case"<text":i=s+o.length;break;case"</text>":r.t=e.slice(i,s).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),a}(eF(e,r,!0),l)))}),b&&b.length&&dG(h,b,!0,l.people||[])}catch(TQe){if(l.WTF)throw TQe}var x}function oj(e){return"/"==e.charAt(0)?e.slice(1):e}function sj(e,t){if(wO(),aj(t=t||{}),JO(e,"META-INF/manifest.xml"))return SY(e,t);if(JO(e,"objectdata.xml"))return SY(e,t);if(JO(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==QY){if(e.FileIndex)return QY(e);var a=TO.utils.cfb_new();return aF(e).forEach(function(t){nF(a,t,function(e,t){return ZO(QO(e,t))}(e,t))}),QY(a)}throw new Error("Unsupported NUMBERS file")}if(!JO(e,"[Content_Types].xml")){if(JO(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(JO(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,r,i=aF(e),o=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var a={};if((e.match(uF)||[]).forEach(function(e){var n=pF(e);switch(n[0].replace(dF,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[JU[n.ContentType]]&&t[JU[n.ContentType]].push(n.PartName)}}),t.xmlns!==XF)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=a,delete t.calcchains,t}(tF(e,"[Content_Types].xml")),s=!1;if(0===o.workbooks.length&&eF(e,r="xl/workbook.xml",!0)&&o.workbooks.push(r),0===o.workbooks.length){if(!eF(e,r="xl/workbook.bin",!0))throw new Error("Could not find workbook");o.workbooks.push(r),s=!0}"bin"==o.workbooks[0].slice(-3)&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(dW=[],o.sst)try{dW=xq(eF(e,oj(o.sst)),o.sst,t)}catch(TQe){if(t.WTF)throw TQe}t.cellStyles&&o.themes.length&&(l=function(e,t,a){return aG(e,a)}(tF(e,o.themes[0].replace(/^\//,""),!0)||"",o.themes[0],t)),o.style&&(c=bq(eF(e,oj(o.style)),o.style,l,t))}o.links.map(function(a){try{nz(tF(e,az(oj(a))),a);return Sq(eF(e,oj(a)),0,a,t)}catch(TQe){}});var u=vq(eF(e,oj(o.workbooks[0])),o.workbooks[0],t),d={},h="";o.coreprops.length&&((h=eF(e,oj(o.coreprops[0]),!0))&&(d=dz(h)),0!==o.extprops.length&&(h=eF(e,oj(o.extprops[0]),!0))&&function(e,t,a){var n={};t||(t={}),e=IF(e),fz.forEach(function(a){var r=(e.match(DF(a[0]))||[])[1];switch(a[2]){case"string":r&&(t[a[1]]=gF(r));break;case"bool":t[a[1]]="true"===r;break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1])}}),n.HeadingPairs&&n.TitlesOfParts&&vz(n.HeadingPairs,n.TitlesOfParts,t,a)}(h,d,t));var p={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(h=tF(e,oj(o.custprops[0]),!0))&&(p=function(e,t){var a={},n="",r=e.match(yz);if(r)for(var i=0;i!=r.length;++i){var o=r[i],s=pF(o);switch(s[0]){case"<?xml":case"<Properties":break;case"<property":n=gF(s.name);break;case"</property>":n=null;break;default:if(0===o.indexOf("<vt:")){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":a[n]=gF(u);break;case"bool":a[n]=TF(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":a[n]=parseFloat(u);break;case"filetime":case"date":a[n]=HO(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",o,c,l)}}else if("</"===o.slice(0,2));else if(t.WTF)throw new Error(o)}}return a}(h,t));var f={};if((t.bookSheets||t.bookProps)&&(u.Sheets?n=u.Sheets.map(function(e){return e.name}):d.Worksheets&&d.SheetNames.length>0&&(n=d.SheetNames),t.bookProps&&(f.Props=d,f.Custprops=p),t.bookSheets&&void 0!==n&&(f.SheetNames=n),t.bookSheets?f.SheetNames:t.bookProps))return f;n={};var m={};t.bookDeps&&o.calcchain&&(m=_q(eF(e,oj(o.calcchain)),o.calcchain));var v,g,y=0,b={},x=u.Sheets;d.Worksheets=x.length,d.SheetNames=[];for(var w=0;w!=x.length;++w)d.SheetNames[w]=x[w].name;var _=s?"bin":"xml",S=o.workbooks[0].lastIndexOf("/"),M=(o.workbooks[0].slice(0,S+1)+"_rels/"+o.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");JO(e,M)||(M="xl/_rels/workbook."+_+".rels");var T=nz(tF(e,M,!0),M.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=Mq(eF(e,oj(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=function(e,t){var a=[],n=!1;return e.replace(uF,function(e){var r=pF(e);switch(fF(r[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":a.push({name:r.displayname,id:r.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e}),a}(eF(e,oj(o.people[0])),t)),T&&(T=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,rj(e["!id"][t.id].Type)]})}catch(TQe){return null}return e&&0!==e.length?e:null}(T,u.Sheets));var k=eF(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var C="sheet";if(T&&T[y]?(v="xl/"+T[y][1].replace(/[\/]?xl\//,""),JO(e,v)||(v=T[y][1]),JO(e,v)||(v=M.replace(/_rels\/.*$/,"")+T[y][1]),C=T[y][2]):v=(v="xl/worksheets/sheet"+(y+1-k)+"."+_).replace(/sheet0\./,"sheet."),g=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,E=0;E!=t.sheets.length;++E)"number"==typeof t.sheets[E]&&t.sheets[E]==y&&(A=1),"string"==typeof t.sheets[E]&&t.sheets[E].toLowerCase()==d.SheetNames[y].toLowerCase()&&(A=1);if(!A)continue e}}ij(e,v,g,d.SheetNames[y],y,b,n,C,t,u,l,c)}return f={Directory:o,Workbook:u,Props:d,Custprops:p,Deps:m,Sheets:n,SheetNames:d.SheetNames,Strings:dW,Styles:c,Themes:l,SSF:WO(zN)},t&&t.bookFiles&&(e.files?(f.keys=i,f.files=e.files):(f.keys=[],f.files={},e.FullPaths.forEach(function(t,a){t=t.replace(/^Root Entry[\/]/,""),f.keys.push(t),f.files[t]=e.FileIndex[a]}))),t&&t.bookVBA&&(o.vba.length>0?f.vbaraw=eF(e,oj(o.vba[0]),!0):o.defaults&&"application/vnd.ms-office.vbaProject"===o.defaults.bin&&(f.vbaraw=eF(e,"xl/vbaProject.bin",!0))),f}function lj(e,t){var a,n,r=t||{},i="Workbook",o=TO.find(e,i);try{if(i="/!DataSpaces/Version",!(o=TO.find(e,i))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(a=o.content,(n={}).id=a.read_shift(0,"lpp4"),n.R=iH(a,4),n.U=iH(a,4),n.W=iH(a,4),i="/!DataSpaces/DataSpaceMap",!(o=TO.find(e,i))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);var s=function(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(oH(e));return t}(o.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(o=TO.find(e,i))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);var l=function(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(o.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(o=TO.find(e,i))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);sH(o.content)}catch(TQe){}if(i="/EncryptionInfo",!(o=TO.find(e,i))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=function(e){var t=iH(e);switch(t.Minor){case 2:return[t.Minor,uH(e)];case 3:return[t.Minor,dH()];case 4:return[t.Minor,hH(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(o.content);if(i="/EncryptedPackage",!(o=TO.find(e,i))||!o.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],o.content,r.password||"",r);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],o.content,r.password||"",r);throw new Error("File is password-protected")}function cj(e,t){return"ods"==t.bookType?CY(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=sU(a["!ref"]);n.s.r=n.s.c=0;var r=!1;n.e.c>9&&(r=!0,n.e.c=9),n.e.r>49&&(r=!0,n.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(lU(n)));var i=wj(a,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&o.push(e)})});var s={},l=[],c=TO.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],a=e[1];2==t.type&&t.name.match(/\.iwa/)&&UY(HY(t.content)).forEach(function(e){l.push(e.id),s[e.id]={deps:[],location:a,type:NY(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,LY(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&UY(HY(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=NY(e.meta[1][0].data)&&function(e,t){e:for(var a=0;a<=e.length-t.length;++a){for(var n=0;n<t.length;++n)if(e[a+n]!=t[n])continue e;return!0}return!1}(e.data,t[1])})&&s[t[0]].deps.push(e.id)})})})});for(var d,h=TO.find(c,s[1].location),p=UY(HY(h.content)),f=0;f<p.length;++f){var m=p[f];1==m.id&&(d=m)}var v=XY(OY(d.messages[0].data)[1][0].data);for(p=UY(HY((h=TO.find(c,s[v].location)).content)),f=0;f<p.length;++f)(m=p[f]).id==v&&(d=m);for(v=XY(OY(d.messages[0].data)[2][0].data),p=UY(HY((h=TO.find(c,s[v].location)).content)),f=0;f<p.length;++f)(m=p[f]).id==v&&(d=m);for(v=XY(OY(d.messages[0].data)[2][0].data),p=UY(HY((h=TO.find(c,s[v].location)).content)),f=0;f<p.length;++f)(m=p[f]).id==v&&(d=m);var g=OY(d.messages[0].data);g[6][0].data=LY(n.e.r+1),g[7][0].data=LY(n.e.c+1);for(var y=XY(g[46][0].data),b=TO.find(c,s[y].location),x=UY(HY(b.content)),w=0;w<x.length&&x[w].id!=y;++w);if(x[w].id!=y)throw"Bad ColumnRowUIDMapArchive";var _=OY(x[w].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var S=0;S<=n.e.c;++S){var M=[];M[1]=M[2]=[{type:0,data:LY(S+420690)}],_[1].push({type:2,data:FY(M)}),_[2].push({type:0,data:LY(S)}),_[3].push({type:0,data:LY(S)})}_[4]=[],_[5]=[],_[6]=[];for(var T=0;T<=n.e.r;++T)(M=[])[1]=M[2]=[{type:0,data:LY(T+726270)}],_[4].push({type:2,data:FY(M)}),_[5].push({type:0,data:LY(T)}),_[6].push({type:0,data:LY(T)});x[w].messages[0].data=FY(_),b.content=GY(zY(x)),b.size=b.content.length,delete g[46];var k=OY(g[4][0].data);k[7][0].data=LY(n.e.r+1);var C=XY(OY(k[1][0].data)[2][0].data);if((x=UY(HY((b=TO.find(c,s[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var A=OY(x[0].messages[0].data);for(T=0;T<i.length;++T){var E=OY(A[2][0].data);E[1][0].data=LY(T),E[4][0].data=LY(i[T].length),A[2][T]={type:A[2][0].type,data:FY(E)}}x[0].messages[0].data=FY(A),b.content=GY(zY(x)),b.size=b.content.length;var I=XY(k[2][0].data);if((x=UY(HY((b=TO.find(c,s[I].location)).content)))[0].id!=I)throw"Bad HeaderStorageBucket";for(A=OY(x[0].messages[0].data),S=0;S<=n.e.c;++S)(E=OY(A[2][0].data))[1][0].data=LY(S),E[4][0].data=LY(n.e.r+1),A[2][S]={type:A[2][0].type,data:FY(E)};x[0].messages[0].data=FY(A),b.content=GY(zY(x)),b.size=b.content.length;var R=XY(k[4][0].data);!function(){for(var e,t=TO.find(c,s[R].location),a=UY(HY(t.content)),n=0;n<a.length;++n){var r=a[n];r.id==R&&(e=r)}var i=OY(e.messages[0].data);i[3]=[];var l=[];o.forEach(function(e,t){l[1]=[{type:0,data:LY(t)}],l[2]=[{type:0,data:LY(1)}],l[3]=[{type:2,data:IY(e)}],i[3].push({type:2,data:FY(l)})}),e.messages[0].data=FY(i);var u=GY(zY(a));t.content=u,t.size=t.content.length}();var D=OY(k[3][0].data),P=D[1][0];delete D[2];var L=OY(P.data),N=XY(L[2][0].data);!function(){for(var e,t=TO.find(c,s[N].location),a=UY(HY(t.content)),r=0;r<a.length;++r){var l=a[r];l.id==N&&(e=l)}var u=OY(e.messages[0].data);delete u[6],delete D[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var h=0,p=0;p<=n.e.r;++p){var f=OY(d);h+=ej(f,i[p],o),f[1][0].data=LY(p),u[5].push({data:FY(f),type:2})}u[1]=[{type:0,data:LY(n.e.c+1)}],u[2]=[{type:0,data:LY(n.e.r+1)}],u[3]=[{type:0,data:LY(h)}],u[4]=[{type:0,data:LY(n.e.r+1)}],e.messages[0].data=FY(u);var m=GY(zY(a));t.content=m,t.size=t.content.length}(),P.data=FY(L),k[3][0].data=FY(D),g[4][0].data=FY(k),d.messages[0].data=FY(g);var O=GY(zY(p));return h.content=O,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){cG=1024,e&&!e.SSF&&(e.SSF=WO(zN));e&&e.SSF&&(wO(),xO(e.SSF),t.revssf=RO(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pW?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var a="xlsb"==t.bookType?"bin":"xml",n=vG.indexOf(t.bookType)>-1,r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};nj(t=t||{});var i=rF(),o="",s=0;t.cellXfs=[],gW(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(nF(i,o="docProps/core.xml",pz(e.Props,t)),r.coreprops.push(o),iz(t.rels,2,o,tz.CORE_PROPS),o="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,nF(i,o,gz(e.Props)),r.extprops.push(o),iz(t.rels,3,o,tz.EXT_PROPS),e.Custprops!==e.Props&&AO(e.Custprops||{}).length>0&&(nF(i,o="docProps/custom.xml",bz(e.Custprops)),r.custprops.push(o),iz(t.rels,4,o,tz.CUST_PROPS));for(s=1;s<=e.SheetNames.length;++s){var u={"!id":{}},d=e.Sheets[e.SheetNames[s-1]];(d||{})["!type"];if(nF(i,o="xl/worksheets/sheet"+s+"."+a,Tq(s-1,o,t,e,u)),r.sheets.push(o),iz(t.wbrels,-1,"worksheets/sheet"+s+"."+a,tz.WS[0]),d){var h=d["!comments"],p=!1,f="";h&&h.length>0&&(nF(i,f="xl/comments"+s+"."+a,kq(h,f)),r.comments.push(f),iz(u,-1,"../comments"+s+"."+a,tz.CMNT),p=!0),d["!legacy"]&&p&&nF(i,"xl/drawings/vmlDrawing"+s+".vml",uG(s,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&nF(i,az(o),rz(u))}null!=t.Strings&&t.Strings.length>0&&(nF(i,o="xl/sharedStrings."+a,function(e,t,a){return(".bin"===t.slice(-4)?nH:tH)(e,a)}(t.Strings,o,t)),r.strs.push(o),iz(t.wbrels,-1,"sharedStrings."+a,tz.SST));nF(i,o="xl/workbook."+a,function(e,t){return(".bin"===t.slice(-4)?mq:dq)(e)}(e,o)),r.workbooks.push(o),iz(t.rels,1,o,tz.WB),nF(i,o="xl/theme/theme1.xml",nG(e.Themes,t)),r.themes.push(o),iz(t.wbrels,-1,"theme/theme1.xml",tz.THEME),nF(i,o="xl/styles."+a,function(e,t,a){return(".bin"===t.slice(-4)?jH:LH)(e,a)}(e,o,t)),r.styles.push(o),iz(t.wbrels,-1,"styles."+a,tz.STY),e.vbaraw&&n&&(nF(i,o="xl/vbaProject.bin",e.vbaraw),r.vba.push(o),iz(t.wbrels,-1,"vbaProject.bin",tz.VBA));return nF(i,o="xl/metadata."+a,function(e){return(".bin"===e.slice(-4)?sG:lG)()}(o)),r.metadata.push(o),iz(t.wbrels,-1,"metadata."+a,tz.XLMETA),nF(i,"[Content_Types].xml",ez(r,t)),nF(i,"_rels/.rels",rz(t.rels)),nF(i,"xl/_rels/workbook."+a+".rels",rz(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t):function(e,t){cG=1024,e&&!e.SSF&&(e.SSF=WO(zN));e&&e.SSF&&(wO(),xO(e.SSF),t.revssf=RO(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,pW?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var a="xml",n=vG.indexOf(t.bookType)>-1,r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};nj(t=t||{});var i=rF(),o="",s=0;t.cellXfs=[],gW(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(nF(i,o="docProps/core.xml",pz(e.Props,t)),r.coreprops.push(o),iz(t.rels,2,o,tz.CORE_PROPS),o="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,nF(i,o,gz(e.Props)),r.extprops.push(o),iz(t.rels,3,o,tz.EXT_PROPS),e.Custprops!==e.Props&&AO(e.Custprops||{}).length>0&&(nF(i,o="docProps/custom.xml",bz(e.Custprops)),r.custprops.push(o),iz(t.rels,4,o,tz.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var d={"!id":{}},h=e.Sheets[e.SheetNames[s-1]];(h||{})["!type"];if(nF(i,o="xl/worksheets/sheet"+s+"."+a,FW(s-1,t,e,d)),r.sheets.push(o),iz(t.wbrels,-1,"worksheets/sheet"+s+"."+a,tz.WS[0]),h){var p=h["!comments"],f=!1,m="";if(p&&p.length>0){var v=!1;p.forEach(function(e){e[1].forEach(function(e){1==e.T&&(v=!0)})}),v&&(nF(i,m="xl/threadedComments/threadedComment"+s+"."+a,pG(p,u,t)),r.threadedcomments.push(m),iz(d,-1,"../threadedComments/threadedComment"+s+"."+a,tz.TCMNT)),nF(i,m="xl/comments"+s+"."+a,hG(p)),r.comments.push(m),iz(d,-1,"../comments"+s+"."+a,tz.CMNT),f=!0}h["!legacy"]&&f&&nF(i,"xl/drawings/vmlDrawing"+s+".vml",uG(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&nF(i,az(o),rz(d))}null!=t.Strings&&t.Strings.length>0&&(nF(i,o="xl/sharedStrings."+a,tH(t.Strings,t)),r.strs.push(o),iz(t.wbrels,-1,"sharedStrings."+a,tz.SST));nF(i,o="xl/workbook."+a,dq(e)),r.workbooks.push(o),iz(t.rels,1,o,tz.WB),nF(i,o="xl/theme/theme1.xml",nG(e.Themes,t)),r.themes.push(o),iz(t.wbrels,-1,"theme/theme1.xml",tz.THEME),nF(i,o="xl/styles."+a,LH(e,t)),r.styles.push(o),iz(t.wbrels,-1,"styles."+a,tz.STY),e.vbaraw&&n&&(nF(i,o="xl/vbaProject.bin",e.vbaraw),r.vba.push(o),iz(t.wbrels,-1,"vbaProject.bin",tz.VBA));nF(i,o="xl/metadata."+a,lG()),r.metadata.push(o),iz(t.wbrels,-1,"metadata."+a,tz.XLMETA),u.length>1&&(nF(i,o="xl/persons/person.xml",function(e){var t=[sF,VF("personList",null,{xmlns:KF,"xmlns:x":rB[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,a){t.push(VF("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),r.people.push(o),iz(t.wbrels,-1,"persons/person.xml",tz.PEOPLE));return nF(i,"[Content_Types].xml",ez(r,t)),nF(i,"_rels/.rels",rz(t.rels)),nF(i,"xl/_rels/workbook."+a+".rels",rz(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t)}function uj(e,t){var a="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=bN(e.slice(0,12));break;case"binary":a=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function dj(e,t){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Bq(e.slice(a),t);default:break e}return GV.to_workbook(e,t)}function hj(e,t,a,n){return n?(a.type="string",GV.to_workbook(e,a)):GV.to_workbook(t,a)}function pj(e,t){uN();var a=t||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return pj(new Uint8Array(e),((a=WO(a)).type="array",a));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!a.type&&(a.type="undefined"!=typeof Deno?"buffer":"array");var n,r=e,i=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),hW={},a.dateNF&&(hW.dateNF=a.dateNF),a.type||(a.type=xN&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==a.type&&(a.type=xN?"buffer":"binary",r=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var a=t.read();return t.close(),a}catch(TQe){if(!TQe.message||!TQe.message.match(/onstruct/))throw TQe}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||xN||(a.type="array")),"string"==a.type&&(i=!0,a.type="binary",a.codepage=65001,r=function(e){return e.match(/[^\x00-\x7F]/)?RF(e):e}(e)),"array"==a.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var o=new ArrayBuffer(3),s=new Uint8Array(o);if(s.foo="bar",!s.foo)return(a=WO(a)).type="array",pj(CN(r),a)}switch((n=uj(r,a))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return TO.find(e,"EncryptedPackage")?lj(e,t):eY(e,t)}(TO.read(r,a),a);break;case 9:if(n[1]<=8)return eY(r,a);break;case 60:return Bq(r,a);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var a=t||{},n=!!a.WTF;a.WTF=!0;try{var r=zV.to_workbook(e,a);return a.WTF=n,r}catch(TQe){if(a.WTF=n,!TQe.message.match(/SYLK bad record ID/)&&n)throw TQe;return GV.to_workbook(e,t)}}(r,a);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return VV.to_workbook(r,a);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var a=e,n=t||{};return n.type||(n.type=xN&&Buffer.isBuffer(e)?"buffer":"base64"),sj(iF(a,n),n)}(r,a):hj(e,r,a,i);case 239:return 60===n[3]?Bq(r,a):hj(e,r,a,i);case 255:if(254===n[1])return function(e,t){var a=e;return"base64"==t.type&&(a=bN(a)),a=pN.utils.decode(1200,a.slice(2),"str"),t.type="binary",dj(a,t)}(r,a);if(0===n[1]&&2===n[2]&&0===n[3])return WV.to_workbook(r,a);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return WV.to_workbook(r,a);if(0===n[2]&&(8===n[3]||9===n[3]))return WV.to_workbook(r,a)}break;case 3:case 131:case 139:case 140:return UV.to_workbook(r,a);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return gH.to_workbook(r,a);break;case 10:case 13:case 32:return function(e,t){var a="",n=uj(e,t);switch(t.type){case"base64":a=bN(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=GO(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(a=IF(a)),t.type="binary",dj(a,t)}(r,a);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return BV.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?UV.to_workbook(r,a):hj(e,r,a,i)}function fj(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return CO(t.file,TO.write(e,{type:xN?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return TO.write(e,t)}function mj(e,t){var a=WO(t||{});return function(e,t){var a={},n=xN?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";t.compression&&(a.compression="DEFLATE");if(t.password)a.type=n;else switch(t.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":a.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var r=e.FullPaths?TO.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!t.compression}):e.generate(a);if("undefined"!=typeof Deno&&"string"==typeof r){if("binary"==t.type||"base64"==t.type)return r;r=new Uint8Array(TN(r))}return t.password&&"undefined"!=typeof encrypt_agile?fj(encrypt_agile(r,t.password),t):"file"===t.type?CO(t.file,r):"string"==t.type?IF(r):r}(cj(e,a),a)}function vj(e,t,a){a||(a="");var n=a+e;switch(t.type){case"base64":return yN(RF(n));case"binary":return RF(n);case"string":return e;case"file":return CO(t.file,n,"utf8");case"buffer":return xN?wN(n,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(n):vj(n,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function gj(e,t){switch(t.type){case"string":case"base64":case"binary":for(var a="",n=0;n<e.length;++n)a+=String.fromCharCode(e[n]);return"base64"==t.type?yN(a):"string"==t.type?IF(a):a;case"file":return CO(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function yj(e,t){uN(),cq(e);var a=WO(t||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),"array"==a.type){a.type="binary";var n=yj(e,a);return a.type="array",TN(n)}var r=0;if(a.sheet&&(r="number"==typeof a.sheet?a.sheet:e.SheetNames.indexOf(a.sheet),!e.SheetNames[r]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return vj(Wq(e,a),a);case"slk":case"sylk":return vj(zV.from_sheet(e.Sheets[e.SheetNames[r]],a),a);case"htm":case"html":return vj(vY(e.Sheets[e.SheetNames[r]],a),a);case"txt":return function(e,t){switch(t.type){case"base64":return yN(e);case"binary":case"string":return e;case"file":return CO(t.file,e,"binary");case"buffer":return xN?wN(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(Tj(e.Sheets[e.SheetNames[r]],a),a);case"csv":return vj(Mj(e.Sheets[e.SheetNames[r]],a),a,"\ufeff");case"dif":return vj(VV.from_sheet(e.Sheets[e.SheetNames[r]],a),a);case"dbf":return gj(UV.from_sheet(e.Sheets[e.SheetNames[r]],a),a);case"prn":return vj(GV.from_sheet(e.Sheets[e.SheetNames[r]],a),a);case"rtf":return vj(gH.from_sheet(e.Sheets[e.SheetNames[r]],a),a);case"eth":return vj(HV.from_sheet(e.Sheets[e.SheetNames[r]],a),a);case"fods":return vj(CY(e,a),a);case"wk1":return gj(WV.sheet_to_wk1(e.Sheets[e.SheetNames[r]],a),a);case"wk3":return gj(WV.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),gj(pY(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),function(e,t){var a=t||{};return fj(tY(e,a),a)}(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return mj(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function bj(e,t,a){var n={type:"file"};return n.file=t,function(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(n),yj(e,n)}function xj(e,t,a,n,r,i,o,s){var l=aU(a),c=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,h=1===r?[]:{};if(1!==r)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:a,enumerable:!1})}catch(TQe){h.__rowNum__=a}else h.__rowNum__=a;if(!o||e[a])for(var p=t.s.c;p<=t.e.c;++p){var f=o?e[a][p]:e[n[p]+l];if(void 0!==f&&void 0!==f.t){var m=f.v;switch(f.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+f.t)}if(null!=i[p]){if(null==m)if("e"==f.t&&null===m)h[i[p]]=null;else if(void 0!==c)h[i[p]]=c;else{if(!u||null!==m)continue;h[i[p]]=null}else h[i[p]]=u&&("n"!==f.t||"n"===f.t&&!1!==s.rawNumbers)?m:dU(f,m,s);null!=m&&(d=!1)}}else{if(void 0===c)continue;null!=i[p]&&(h[i[p]]=c)}}return{row:h,isempty:d}}function wj(e,t){if(null==e||null==e["!ref"])return[];var a={t:"n",v:0},n=0,r=1,i=[],o=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof u){case"string":l=cU(u);break;case"number":(l=cU(e["!ref"])).s.r=u;break;default:l=u}n>0&&(r=0);var d=aU(l.s.r),h=[],p=[],f=0,m=0,v=Array.isArray(e),g=l.s.r,y=0,b={};v&&!e[g]&&(e[g]=[]);var x=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(x[y]||{}).hidden)switch(h[y]=rU(y),a=v?e[g][y]:e[h[y]+d],n){case 1:i[y]=y-l.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=c.header[y-l.s.c];break;default:if(null==a&&(a={w:"__EMPTY",t:"s"}),s=o=dU(a,null,c),m=b[o]||0){do{s=o+"_"+m++}while(b[s]);b[o]=m,b[s]=1}else b[o]=1;i[y]=s}for(g=l.s.r+r;g<=l.e.r;++g)if(!(w[g]||{}).hidden){var _=xj(e,l,g,h,n,i,v,c);(!1===_.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(p[f++]=_.row)}return p.length=f,p}var _j=/"/g;function Sj(e,t,a,n,r,i,o,s){for(var l=!0,c=[],u="",d=aU(a),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=s.dense?(e[a]||[])[h]:e[n[h]+d];if(null==p)u="";else if(null!=p.v){l=!1,u=""+(s.rawNumbers&&"n"==p.t?p.v:dU(p,null,s));for(var f=0,m=0;f!==u.length;++f)if((m=u.charCodeAt(f))===r||m===i||34===m||s.forceQuotes){u='"'+u.replace(_j,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==p.f||p.F?u="":(l=!1,(u="="+p.f).indexOf(",")>=0&&(u='"'+u.replace(_j,'""')+'"'));c.push(u)}return!1===s.blankrows&&l?null:c.join(o)}function Mj(e,t){var a=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var r=cU(e["!ref"]),i=void 0!==n.FS?n.FS:",",o=i.charCodeAt(0),s=void 0!==n.RS?n.RS:"\n",l=s.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],f=r.s.c;f<=r.e.c;++f)(h[f]||{}).hidden||(d[f]=rU(f));for(var m=0,v=r.s.r;v<=r.e.r;++v)(p[v]||{}).hidden||null!=(u=Sj(e,r,v,d,o,l,i,n))&&(n.strip&&(u=u.replace(c,"")),(u||!1!==n.blankrows)&&a.push((m++?s:"")+u));return delete n.dense,a.join("")}function Tj(e,t){return t||(t={}),t.FS="\t",t.RS="\n",Mj(e,t)}function kj(e,t,a){var n,r=a||{},i=+!r.skipHeader,o=e||{},s=0,l=0;if(o&&null!=r.origin)if("number"==typeof r.origin)s=r.origin;else{var c="string"==typeof r.origin?iU(r.origin):r.origin;s=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:s+t.length-1+i}};if(o["!ref"]){var d=cU(o["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==s&&(s=d.e.r+1,u.e.r=s+t.length-1+i)}else-1==s&&(s=0,u.e.r=t.length-1+i);var h=r.header||[],p=0;t.forEach(function(e,t){AO(e).forEach(function(a){-1==(p=h.indexOf(a))&&(h[p=h.length]=a);var c=e[a],u="z",d="",f=oU({c:l+p,r:s+t+i});n=Cj(o,f),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",r.cellDates||(u="n",c=PO(c)),d=r.dateNF||zN[14]):null===c&&r.nullError&&(u="e",c=0),n?(n.t=u,n.v=c,delete n.w,delete n.R,d&&(n.z=d)):o[f]=n={t:u,v:c},d&&(n.z=d)):o[f]=c})}),u.e.c=Math.max(u.e.c,l+h.length-1);var f=aU(s);if(i)for(p=0;p<h.length;++p)o[rU(p+l)+f]={t:"s",v:h[p]};return o["!ref"]=lU(u),o}function Cj(e,t,a){if("string"==typeof t){if(Array.isArray(e)){var n=iU(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Cj(e,oU("number"!=typeof t?t:{r:t,c:a||0}))}function Aj(){return{SheetNames:[],Sheets:{}}}function Ej(e,t,a,n){var r=1;if(!a)for(;r<=65535&&-1!=e.SheetNames.indexOf(a="Sheet"+r);++r,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(a)>=0){var i=a.match(/(^.*?)(\d+)$/);r=i&&+i[2]||0;var o=i&&i[1]||a;for(++r;r<=65535&&-1!=e.SheetNames.indexOf(a=o+r);++r);}if(lq(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=t,a}function Ij(e,t,a){return t?(e.l={Target:t},a&&(e.l.Tooltip=a)):delete e.l,e}var Rj={encode_col:rU,encode_row:aU,encode_cell:oU,encode_range:lU,decode_col:nU,decode_row:tU,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:iU,decode_range:sU,format_cell:dU,sheet_add_aoa:pU,sheet_add_json:kj,sheet_add_dom:gY,aoa_to_sheet:fU,json_to_sheet:function(e,t){return kj(null,e,t)},table_to_sheet:yY,table_to_book:function(e,t){return hU(yY(e,t),t)},sheet_to_csv:Mj,sheet_to_txt:Tj,sheet_to_json:wj,sheet_to_html:vY,sheet_to_formulae:function(e){var t,a="",n="";if(null==e||null==e["!ref"])return[];var r,i=cU(e["!ref"]),o="",s=[],l=[],c=Array.isArray(e);for(r=i.s.c;r<=i.e.c;++r)s[r]=rU(r);for(var u=i.s.r;u<=i.e.r;++u)for(o=aU(u),r=i.s.c;r<=i.e.c;++r)if(a=s[r]+o,n="",void 0!==(t=c?(e[u]||[])[r]:e[a])){if(null!=t.F){if(a=t.F,!t.f)continue;n=t.f,-1==a.indexOf(":")&&(a=a+":"+a)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=a+"="+n}return l},sheet_to_row_object_array:wj,sheet_get_cell:Cj,book_new:Aj,book_append_sheet:Ej,book_set_sheet_visibility:function(e,t,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var a=e.SheetNames.indexOf(t);if(a>-1)return a;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[n].Hidden=a},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Ij,cell_set_internal_link:function(e,t,a){return Ij(e,"#"+t,a)},cell_add_comment:function(e,t,a){e.c||(e.c=[]),e.c.push({t:t,a:a||"SheetJS"})},sheet_set_array_formula:function(e,t,a,n){for(var r="string"!=typeof t?t:cU(t),i="string"==typeof t?t:lU(t),o=r.s.r;o<=r.e.r;++o)for(var s=r.s.c;s<=r.e.c;++s){var l=Cj(e,o,s);l.t="n",l.F=i,delete l.v,o==r.s.r&&s==r.s.c&&(l.f=a,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Dj="   https://stochastic-dashbord-v1-production.up.railway.app",Pj=async e=>{try{const t=await fetch(`${Dj}/api/bond/valuate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Bond Valuation Failed:",QXe),QXe}},Lj={class:"page-container custom-scroll"},Nj={class:"section-header"},Oj={class:"header-actions"},Fj={class:"control-group"},Bj=["disabled"],Uj=["disabled"],zj={key:0},Vj={key:1,class:"flex-center"},Hj={key:0,class:"glass-card panel",style:{"margin-bottom":"24px"}},Gj={class:"panel-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},Wj={class:"card-subtitle"},qj={style:{display:"flex",gap:"8px"}},Yj=["disabled"],jj={key:0},Xj={key:1},$j=["disabled"],Kj={key:0},Zj={key:1},Jj={class:"table-wrapper custom-scroll"},Qj={class:"glass-table"},eX={key:0},tX={key:1},aX=["onClick"],nX={class:"mono"},rX={class:"mono"},iX={class:"mono"},oX={class:"mono"},sX={class:"mono"},lX={key:0,class:"mono text-blue"},cX={key:1,class:"mono text-green"},uX=["onClick"],dX={class:"dashboard-grid"},hX={class:"left-panel"},pX={class:"glass-card panel"},fX={class:"controls-form"},mX={class:"form-group"},vX={class:"form-group"},gX={class:"form-group"},yX={class:"form-group"},bX={class:"lbl"},xX={key:0,class:"form-group"},wX={key:0,class:"glass-card panel input-scenario scenario-1-input"},_X={class:"scenario-input-group"},SX={key:1,class:"glass-card panel input-scenario scenario-2-input"},MX={class:"scenario-input-group"},TX={key:2,class:"glass-card panel input-scenario scenario-1-input"},kX={class:"scenario-input-group"},CX=["disabled"],AX={key:0},EX={key:1},IX={key:0,class:"error-banner"},RX={key:0,class:"glass-card panel info-panel"},DX={class:"info-list"},PX={class:"info-row"},LX={class:"info-row"},NX={class:"info-row"},OX={class:"info-row"},FX={class:"info-row"},BX={class:"main-panel"},UX={key:0,class:"glass-card panel comparison-panel h-auto"},zX={class:"comparison-table-wrapper"},VX={class:"comparison-table"},HX={class:"scenario-col"},GX={class:"scenario-rate"},WX={class:"scenario-col"},qX={class:"scenario-rate variant-2"},YX={class:"mono text-gradient-blue"},jX={class:"mono text-gradient-green"},XX={class:"mono"},$X={class:"mono"},KX={class:"mono"},ZX={class:"mono"},JX={class:"mono"},QX={class:"mono"},e$={key:0},t$={class:"mono"},a$={class:"mono"},n$={key:1},r$={class:"mono"},i$={class:"mono"},o$={key:2},s$={class:"mono"},l$={class:"mono"},c$={key:3},u$={class:"mono"},d$={class:"mono"},h$={key:4},p$={class:"mono"},f$={class:"mono"},m$={key:5},v$={class:"mono"},g$={class:"mono"},y$={key:6},b$={class:"mono"},x$={class:"mono"},w$={key:7},_$={class:"mono"},S$={class:"mono"},M$={key:8},T$={class:"mono"},k$={class:"mono"},C$={key:9},A$={class:"mono"},E$={class:"mono"},I$={key:0,class:"glass-card panel h-auto"},R$={class:"panel-header"},D$={class:"glass-pill"},P$={class:"table-wrapper custom-scroll"},L$={class:"glass-table"},N$={class:"text-right mono font-bold"},O$={class:"text-right mono"},F$={key:0,class:"glass-card panel h-auto"},B$={class:"panel-header"},U$={class:"glass-pill"},z$={class:"table-wrapper custom-scroll"},V$={class:"glass-table"},H$={class:"text-right mono font-bold"},G$={class:"text-right mono"},W$={key:0,class:"glass-card panel h-auto"},q$={class:"panel-header"},Y$={class:"glass-pill"},j$={class:"table-wrapper custom-scroll"},X$={class:"glass-table"},$$={class:"text-muted"},K$={class:"text-right mono text-muted"},Z$={class:"text-right mono"},J$={class:"text-right mono text-muted"},Q$={class:"text-right mono font-bold text-blue"},eK={class:"text-right mono text-blue font-bold"},tK={key:0,class:"glass-card panel h-auto"},aK={class:"panel-header"},nK={class:"glass-pill"},rK={class:"table-wrapper custom-scroll"},iK={class:"glass-table"},oK={class:"text-muted"},sK={class:"text-right mono text-muted"},lK={class:"text-right mono"},cK={class:"text-right mono text-muted"},uK={class:"text-right mono font-bold text-green"},dK={class:"text-right mono text-green font-bold"},hK={key:0,class:"glass-card panel h-auto"},pK={class:"panel-header"},fK={class:"schedule-stats"},mK={class:"stat-badge paid"},vK={class:"stat-badge future"},gK={class:"schedule-grid"},yK={class:"coupon-index"},bK={class:"coupon-content"},xK={class:"coupon-date"},wK={class:"coupon-amount"},_K={class:"coupon-status"},SK={key:0,class:"empty-placeholder"},MK=e({__name:"BondValuation",setup(e){const a=t({secid:"RU000A10AU99",valuationDate:(new Date).toISOString().split("T")[0],discountYield1:14,discountYield2:16,dayCount:365,dayCountConvention:"",useMarketYield:!1,marketYield:void 0}),n=t(null),r=t(!1),o=t(!1),d=t(""),g=t(null),y=t([]),b=t(null),x=t([]),_=t(!1),S=t(!1),C=async()=>{if(a.value.secid&&a.value.valuationDate){o.value=!0,d.value="";try{const e="   https://stochastic-dashbord-v1-production.up.railway.app",t=await fetch(`${e}/api/bond/market-yield?secid=${a.value.secid.trim()}&date=${a.value.valuationDate}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}const n=await t.json();null!==n.yield&&void 0!==n.yield?a.value.marketYield=n.yield:d.value="Доходность не найдена для данной даты"}catch(TQe){console.error("Ошибка загрузки доходности:",TQe),d.value=TQe.message||"Ошибка загрузки доходности из MOEX API"}finally{o.value=!1}}else d.value="Введите ISIN и дату оценки"},A=()=>{a.value.useMarketYield&&a.value.secid&&a.value.valuationDate&&C()},R=async()=>{if(r.value=!0,d.value="",n.value=null,!a.value.secid||!a.value.secid.trim())return d.value="Введите ISIN облигации",void(r.value=!1);if(a.value.useMarketYield){if(!a.value.marketYield||a.value.marketYield<=0)return d.value="Загрузите рыночную доходность из MOEX API или введите вручную",void(r.value=!1);a.value.discountYield1=a.value.marketYield,a.value.discountYield2=a.value.marketYield}else if(!a.value.discountYield1||!a.value.discountYield2)return d.value="Заполните обе ставки дисконтирования",void(r.value=!1);try{const e=await Pj({secid:a.value.secid.trim(),valuationDate:a.value.valuationDate,discountYield1:a.value.discountYield1,discountYield2:a.value.discountYield2,dayCount:a.value.dayCount,dayCountConvention:a.value.dayCountConvention||void 0});n.value=e}catch(TQe){console.error("Ошибка оценки облигации:",TQe),d.value=TQe.message||"Ошибка соединения с API или получения данных облигации"}finally{r.value=!1}},P=async e=>{const t=e.target,n=t.files?.[0];if(n)try{const e=pj(await n.arrayBuffer(),{type:"array"}),t=e.SheetNames[0],r=e.Sheets[t],i=Rj.sheet_to_json(r,{raw:!1}),o=[];for(const n of i){const e=n["Рыночная доходность"]||n["Market Yield"]||n.market_yield||n.YTM||n.ytm||"",t=e?parseFloat(e):null,r=null!==t&&t>0,i={secid:n.ISIN||n.isin||n.SECID||n.secid||n["Облигация"]||"",valuationDate:n["Дата оценки"]||n["Valuation Date"]||n.valuation_date||n["Дата"]||a.value.valuationDate,useMarketYield:r,marketYield:t,discountYield1:r?t:parseFloat(n["Y аналога"]||n["Y Analogue"]||n.y_analogue||n["Доходность 1"]||n["Discount Yield 1"]||String(a.value.discountYield1)||"14.0"),discountYield2:r?t:parseFloat(n["Y индекса"]||n["Y Index"]||n.y_index||n["Доходность 2"]||n["Discount Yield 2"]||String(a.value.discountYield2)||"16.0"),marketActivity:n["Активность рынка"]||n["Market Activity"]||n.market_activity||null,dayCountConvention:n["Базис расчета"]||n["Day Count"]||n.day_count||a.value.dayCountConvention||""};i.secid&&i.secid.trim()&&o.push(i)}for(const a of o)a.useMarketYield&&(!a.marketYield||a.marketYield<=0)&&(a.marketYield=null);y.value=o,b.value=null,x.value=[],d.value=""}catch(r){console.error("Excel parsing error:",r),d.value=`Ошибка при загрузке файла: ${r.message}`}},N=async()=>{_.value=!0,x.value=[],d.value="";try{for(let a=0;a<y.value.length;a++){const n=y.value[a];try{let t=n.discountYield1,r=n.discountYield2;if(n.useMarketYield)if(!n.marketYield||n.marketYield<=0)try{const e="   https://stochastic-dashbord-v1-production.up.railway.app",i=await fetch(`${e}/api/bond/market-yield?secid=${n.secid.trim()}&date=${n.valuationDate}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(i.ok){const e=await i.json();null!==e.yield&&void 0!==e.yield&&(t=e.yield,r=e.yield,y.value[a].marketYield=e.yield)}}catch(e){console.warn(`Could not fetch market yield for ${n.secid}:`,e)}else t=n.marketYield,r=n.marketYield;const i=await Pj({secid:n.secid.trim(),valuationDate:n.valuationDate,discountYield1:t,discountYield2:r,dayCountConvention:n.dayCountConvention||void 0});x.value.push(i)}catch(t){x.value.push(null),console.error(`Error calculating bond ${a+1}:`,t)}}}catch(t){console.error("Error calculating bonds:",t),d.value=`Ошибка при расчете облигаций: ${t.message}`}finally{_.value=!1}},O=()=>{if(0===y.value.length)return;const e=y.value.map((e,t)=>({"№":t+1,ISIN:e.secid||"","Дата оценки":e.valuationDate||"","Y аналога (%)":e.discountYield1||0,"Y индекса (%)":e.discountYield2||0,"Рыночная доходность (%)":e.marketYield||"","Активность рынка":e.marketActivity||"","Базис расчета":e.dayCountConvention||"","Dirty Price (Сценарий 1)":x.value[t]?.scenario1?.dirtyPrice||"","Dirty Price (Сценарий 2)":x.value[t]?.scenario2?.dirtyPrice||"","Clean Price (Сценарий 1)":x.value[t]?.scenario1?.cleanPrice||"","Clean Price (Сценарий 2)":x.value[t]?.scenario2?.cleanPrice||"","Duration (Сценарий 1)":x.value[t]?.scenario1?.duration||"","Duration (Сценарий 2)":x.value[t]?.scenario2?.duration||""})),t=Rj.json_to_sheet(e),a=Rj.book_new();Rj.book_append_sheet(a,t,"Реестр облигаций");bj(a,`реестр_облигаций_${(new Date).toISOString().split("T")[0]}.xlsx`)},F=()=>{y.value=[],b.value=null,x.value=[],g.value&&(g.value.value="")},B=e=>{if(!e)return"Не определено";return{high:"Высокая",medium:"Средняя",low:"Низкая",unknown:"Не определено"}[e.toLowerCase()]||e},U=async()=>{if(0!==y.value.length){S.value=!0,d.value="";try{const e=await(async(e,t)=>{try{const a=await fetch(`${Dj}/api/database/export/registry/parquet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registry_type:e,data:t})});if(!a.ok){const e=await a.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${a.status}`)}return await a.json()}catch(d){throw console.error("Save Registry to Parquet Failed:",d),d}})("bond",y.value);e.success&&(d.value=`Реестр успешно сохранен: ${e.data.file_name}`,setTimeout(()=>{d.value=""},5e3))}catch(e){console.error("Error saving registry to parquet:",e),d.value=`Ошибка при сохранении реестра: ${e.message}`}finally{S.value=!1}}},z=(e,t=2)=>e.toLocaleString("ru-RU",{minimumFractionDigits:t,maximumFractionDigits:t}),V=e=>new Date(e).toLocaleDateString("ru-RU");return(e,t)=>(w(),i("div",Lj,[s("div",Nj,[t[11]||(t[11]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Оценка облигаций"),s("p",{class:"section-subtitle"},"Моделирование денежных потоков на данных MOEX ISS API")],-1)),s("div",Oj,[s("div",Fj,[t[9]||(t[9]=s("label",{class:"control-label"},"Реестр:",-1)),s("input",{type:"file",ref_key:"fileInputRef",ref:g,onChange:P,accept:".xlsx,.xls,.xlsm",style:{display:"none"},id:"bond-excel-upload"},null,544),s("button",{onClick:t[0]||(t[0]=()=>{g.value&&g.value.click()}),class:"btn-glass secondary",title:"Загрузить реестр облигаций из Excel"}," 📂 Загрузить Excel ")]),s("button",{onClick:O,class:"btn-glass secondary",disabled:0===y.value.length,title:"Выгрузить реестр в Excel"}," 📥 Выгрузить Excel ",8,Bj),s("button",{class:"btn-glass primary",onClick:R,disabled:r.value},[r.value?(w(),i("span",Vj,[...t[10]||(t[10]=[s("span",{class:"spinner-mini"},null,-1),m(" Загрузка...",-1)])])):(w(),i("span",zj,"Рассчитать"))],8,Uj)])]),y.value.length>0?(w(),i("div",Hj,[s("div",Gj,[s("div",null,[t[12]||(t[12]=s("h3",null,"Реестр облигаций",-1)),s("span",Wj,"Загружено облигаций: "+v(y.value.length),1)]),s("div",qj,[s("button",{onClick:U,class:"btn-glass secondary",disabled:0===y.value.length||S.value,style:{"font-size":"11px",padding:"6px 12px"},title:"Сохранить реестр в Supabase (parquet)"},[S.value?(w(),i("span",Xj,"↺ Сохранение...")):(w(),i("span",jj,"💾 Сохранить в БД"))],8,Yj),s("button",{onClick:N,class:"btn-glass secondary",disabled:_.value,style:{"font-size":"11px",padding:"6px 12px"}},[_.value?(w(),i("span",Zj,"↺ Считаю...")):(w(),i("span",Kj,"Рассчитать все"))],8,$j),s("button",{onClick:F,class:"btn-glass secondary",style:{"font-size":"11px",padding:"6px 12px",background:"rgba(239, 68, 68, 0.2)","border-color":"rgba(239, 68, 68, 0.3)"}}," ✕ Очистить ")])]),s("div",Jj,[s("table",Qj,[s("thead",null,[s("tr",null,[t[13]||(t[13]=s("th",null,"№",-1)),t[14]||(t[14]=s("th",null,"ISIN",-1)),t[15]||(t[15]=s("th",null,"Дата оценки",-1)),t[16]||(t[16]=s("th",null,"Y аналога (%)",-1)),t[17]||(t[17]=s("th",null,"Y индекса (%)",-1)),t[18]||(t[18]=s("th",null,"Рыночная доходность (%)",-1)),t[19]||(t[19]=s("th",null,"Активность рынка",-1)),x.value.length>0?(w(),i("th",eX,"Dirty Price (Сценарий 1)")):l("",!0),x.value.length>0?(w(),i("th",tX,"Dirty Price (Сценарий 2)")):l("",!0),t[20]||(t[20]=s("th",null,"Действие",-1))])]),s("tbody",null,[(w(!0),i(p,null,f(y.value,(e,t)=>(w(),i("tr",{key:t,class:c({selected:b.value===t}),onClick:e=>(e=>{b.value=e})(t)},[s("td",null,v(t+1),1),s("td",nX,v(e.secid||"-"),1),s("td",rX,v(e.valuationDate||"-"),1),s("td",iX,v(e.discountYield1?z(e.discountYield1,2):"-")+"%",1),s("td",oX,v(e.discountYield2?z(e.discountYield2,2):"-")+"%",1),s("td",sX,v(e.marketYield?z(e.marketYield,2):"-")+"%",1),s("td",null,[s("span",{class:c(["market-activity-badge",e.marketActivity||"unknown"])},v(B(e.marketActivity)),3)]),x.value.length>0&&x.value[t]?(w(),i("td",lX,v(x.value[t]?.scenario1?.dirtyPrice?z(x.value[t].scenario1.dirtyPrice,2):"-")+" ₽ ",1)):l("",!0),x.value.length>0&&x.value[t]?(w(),i("td",cX,v(x.value[t]?.scenario2?.dirtyPrice?z(x.value[t].scenario2.dirtyPrice,2):"-")+" ₽ ",1)):l("",!0),s("td",null,[s("button",{onClick:E(e=>(e=>{const t=y.value[e];t&&(a.value.secid=t.secid||a.value.secid,a.value.valuationDate=t.valuationDate||a.value.valuationDate,a.value.discountYield1=t.discountYield1||a.value.discountYield1,a.value.discountYield2=t.discountYield2||a.value.discountYield2,a.value.dayCountConvention=t.dayCountConvention||a.value.dayCountConvention,setTimeout(()=>{R()},100))})(t),["stop"]),class:"btn-small",title:"Загрузить в форму"}," Загрузить ",8,uX)])],10,aX))),128))])])])])):l("",!0),s("div",dX,[s("div",hX,[s("div",pX,[t[29]||(t[29]=s("div",{class:"panel-header"},[s("h3",null,"Параметры оценки")],-1)),s("div",fX,[s("div",mX,[t[21]||(t[21]=s("label",{class:"lbl"},"ISIN Облигации",-1)),T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.secid=e),type:"text",class:"glass-input",placeholder:"RU000..."},null,512),[[k,a.value.secid]])]),s("div",vX,[t[22]||(t[22]=s("label",{class:"lbl"},"Дата оценки",-1)),T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.value.valuationDate=e),type:"date",class:"glass-input"},null,512),[[k,a.value.valuationDate]])]),s("div",gX,[t[24]||(t[24]=s("label",{class:"lbl"},"Базис расчета дней",-1)),T(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.value.dayCountConvention=e),class:"glass-input day-count-select"},[...t[23]||(t[23]=[I('<option value="" data-v-8e417c48>Actual/365F (по умолчанию)</option><option value="Actual/365F" data-v-8e417c48>Actual/365F (Fixed 365)</option><option value="Actual/360" data-v-8e417c48>Actual/360 (French)</option><option value="Actual/Actual (ISDA)" data-v-8e417c48>Actual/Actual (ISDA)</option><option value="30/360 (US)" data-v-8e417c48>30/360 (US Municipal Bond Basis)</option><option value="30E/360 (ISDA)" data-v-8e417c48>30E/360 (ISDA) / 30/360 German</option><option value="30E/360" data-v-8e417c48>30E/360 (Eurobond Basis)</option><option value="Actual/Actual (ISMA)" data-v-8e417c48>Actual/Actual (ISMA) / Actual/Actual (ICMA)</option>',8)])],512),[[D,a.value.dayCountConvention]])]),s("div",yX,[s("label",bX,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>a.value.useMarketYield=e),onChange:A},null,544),[[L,a.value.useMarketYield]]),t[25]||(t[25]=m(" Использовать доходность из MOEX API ",-1))]),t[26]||(t[26]=s("span",{class:"form-hint"},"Если включено, доходности будут загружены из MOEX на дату оценки",-1))]),a.value.useMarketYield?(w(),i("div",xX,[t[27]||(t[27]=s("label",{class:"lbl"},"Рыночная доходность (%)",-1)),T(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>a.value.marketYield=e),type:"number",step:"0.1",class:"glass-input",placeholder:"15.5"},null,512),[[k,a.value.marketYield,void 0,{number:!0}]]),t[28]||(t[28]=s("span",{class:"form-hint"}," Введите вручную или загрузите из MOEX API ",-1))])):l("",!0)])]),a.value.useMarketYield?l("",!0):(w(),i("div",wX,[t[31]||(t[31]=s("div",{class:"panel-header"},[s("h3",null,"Сценарий 1: Y аналога")],-1)),s("div",_X,[t[30]||(t[30]=s("label",{class:"lbl"},"Ставка дисконтирования (%)",-1)),T(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>a.value.discountYield1=e),type:"number",step:"0.1",class:"glass-input scenario-input",placeholder:"14.0"},null,512),[[k,a.value.discountYield1,void 0,{number:!0}]])])])),a.value.useMarketYield?l("",!0):(w(),i("div",SX,[t[33]||(t[33]=s("div",{class:"panel-header"},[s("h3",null,"Сценарий 2: Y индекса")],-1)),s("div",MX,[t[32]||(t[32]=s("label",{class:"lbl"},"Ставка дисконтирования (%)",-1)),T(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>a.value.discountYield2=e),type:"number",step:"0.1",class:"glass-input scenario-input",placeholder:"16.0"},null,512),[[k,a.value.discountYield2,void 0,{number:!0}]])])])),a.value.useMarketYield?(w(),i("div",TX,[t[36]||(t[36]=s("div",{class:"panel-header"},[s("h3",null,"Доходность из MOEX API")],-1)),s("div",kX,[t[34]||(t[34]=s("label",{class:"lbl"},"Рыночная доходность на дату оценки (%)",-1)),T(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>a.value.marketYield=e),type:"number",step:"0.1",class:"glass-input scenario-input",placeholder:"Введите или загрузите из MOEX"},null,512),[[k,a.value.marketYield,void 0,{number:!0}]]),s("button",{onClick:C,class:"btn-glass secondary",disabled:o.value||!a.value.secid||!a.value.valuationDate,style:{"margin-top":"8px",width:"100%"}},[o.value?(w(),i("span",EX,"↺ Загрузка...")):(w(),i("span",AX,"🔄 Загрузить из MOEX"))],8,CX),t[35]||(t[35]=s("span",{class:"form-hint",style:{"margin-top":"8px"}}," Доходность будет использована для оценки вместо двух сценариев ",-1))])])):l("",!0),u(M,{name:"fade"},{default:h(()=>[d.value?(w(),i("div",IX,[t[37]||(t[37]=s("span",{class:"icon"},"⚠",-1)),m(" "+v(d.value),1)])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value?(w(),i("div",RX,[t[48]||(t[48]=s("div",{class:"panel-header"},[s("h3",null,"Паспорт бумаги")],-1)),s("div",DX,[s("div",PX,[t[38]||(t[38]=s("span",null,"SECID",-1)),t[39]||(t[39]=m()),s("strong",null,v(n.value.secid),1)]),s("div",LX,[t[40]||(t[40]=s("span",null,"Номинал",-1)),t[41]||(t[41]=m()),s("strong",null,v(z(n.value.faceValue,0))+" ₽",1)]),s("div",NX,[t[42]||(t[42]=s("span",null,"Купон",-1)),t[43]||(t[43]=m()),s("strong",null,v(n.value.couponPercent)+"%",1)]),s("div",OX,[t[44]||(t[44]=s("span",null,"Погашение",-1)),t[45]||(t[45]=m()),s("strong",null,v(V(n.value.maturityDate)),1)]),s("div",FX,[t[46]||(t[46]=s("span",null,"Частота",-1)),t[47]||(t[47]=m()),s("strong",null,v(n.value.paymentsPerYear)+" / год",1)])])])):l("",!0)]),_:1})]),s("div",BX,[u(M,{name:"fade"},{default:h(()=>[n.value?(w(),i("div",UX,[t[67]||(t[67]=s("div",{class:"panel-header"},[s("h3",null,"Сравнение сценариев")],-1)),s("div",zX,[s("table",VX,[s("thead",null,[s("tr",null,[t[51]||(t[51]=s("th",null,"Метрика",-1)),s("th",HX,[t[49]||(t[49]=s("span",{class:"scenario-label"},"Сценарий 1",-1)),s("span",GX,v(z(a.value.discountYield1,1))+"%",1)]),s("th",WX,[t[50]||(t[50]=s("span",{class:"scenario-label"},"Сценарий 2",-1)),s("span",qX,v(z(a.value.discountYield2,1))+"%",1)]),t[52]||(t[52]=s("th",{class:"diff-col"},[s("span",{class:"scenario-label"},"Разница")],-1))])]),s("tbody",null,[s("tr",null,[t[53]||(t[53]=s("td",null,[s("strong",null,"Dirty Price")],-1)),s("td",YX,v(z(n.value.scenario1.dirtyPrice,2))+" ₽",1),s("td",jX,v(z(n.value.scenario2.dirtyPrice,2))+" ₽",1),s("td",{class:c(["mono",n.value.scenario1.dirtyPrice>n.value.scenario2.dirtyPrice?"text-green":"text-red"])},v(z(n.value.scenario1.dirtyPrice-n.value.scenario2.dirtyPrice,2))+" ₽ ",3)]),s("tr",null,[t[54]||(t[54]=s("td",null,[s("strong",null,"Clean Price")],-1)),s("td",XX,v(z(n.value.scenario1.cleanPrice,2))+" ₽",1),s("td",$X,v(z(n.value.scenario2.cleanPrice,2))+" ₽",1),s("td",{class:c(["mono",n.value.scenario1.cleanPrice>n.value.scenario2.cleanPrice?"text-green":"text-red"])},v(z(n.value.scenario1.cleanPrice-n.value.scenario2.cleanPrice,2))+" ₽ ",3)]),s("tr",null,[t[55]||(t[55]=s("td",null,[s("strong",null,"% от номинала")],-1)),s("td",KX,v(z(n.value.scenario1.pricePercent,2))+"%",1),s("td",ZX,v(z(n.value.scenario2.pricePercent,2))+"%",1),s("td",{class:c(["mono",n.value.scenario1.pricePercent>n.value.scenario2.pricePercent?"text-green":"text-red"])},v(z(n.value.scenario1.pricePercent-n.value.scenario2.pricePercent,2))+"% ",3)]),s("tr",null,[t[56]||(t[56]=s("td",null,[s("strong",null,"Дюрация Маколея")],-1)),s("td",JX,v(z(n.value.scenario1.duration,4))+" лет",1),s("td",QX,v(z(n.value.scenario2.duration,4))+" лет",1),s("td",{class:c(["mono",n.value.scenario1.duration>n.value.scenario2.duration?"text-green":"text-red"])},v(z(n.value.scenario1.duration-n.value.scenario2.duration,4))+" лет ",3)]),void 0!==n.value.scenario1.modifiedDuration?(w(),i("tr",e$,[t[57]||(t[57]=s("td",null,[s("strong",null,"Модифицированная дюрация")],-1)),s("td",t$,v(z(n.value.scenario1.modifiedDuration,4))+" лет",1),s("td",a$,v(z(n.value.scenario2.modifiedDuration||0,4))+" лет",1),s("td",{class:c(["mono",(n.value.scenario1.modifiedDuration||0)>(n.value.scenario2.modifiedDuration||0)?"text-green":"text-red"])},v(z((n.value.scenario1.modifiedDuration||0)-(n.value.scenario2.modifiedDuration||0),4))+" лет ",3)])):l("",!0),void 0!==n.value.scenario1.currentYield?(w(),i("tr",n$,[t[58]||(t[58]=s("td",null,[s("strong",null,"Текущая доходность (CY)")],-1)),s("td",r$,v(z(n.value.scenario1.currentYield,2))+"%",1),s("td",i$,v(z(n.value.scenario2.currentYield||0,2))+"%",1),s("td",{class:c(["mono",(n.value.scenario1.currentYield||0)>(n.value.scenario2.currentYield||0)?"text-green":"text-red"])},v(z((n.value.scenario1.currentYield||0)-(n.value.scenario2.currentYield||0),2))+"% ",3)])):l("",!0),void 0!==n.value.scenario1.adjustedCurrentYield?(w(),i("tr",o$,[t[59]||(t[59]=s("td",null,[s("strong",null,"Скорректированная CY (ACY)")],-1)),s("td",s$,v(z(n.value.scenario1.adjustedCurrentYield,2))+"%",1),s("td",l$,v(z(n.value.scenario2.adjustedCurrentYield||0,2))+"%",1),s("td",{class:c(["mono",(n.value.scenario1.adjustedCurrentYield||0)>(n.value.scenario2.adjustedCurrentYield||0)?"text-green":"text-red"])},v(z((n.value.scenario1.adjustedCurrentYield||0)-(n.value.scenario2.adjustedCurrentYield||0),2))+"% ",3)])):l("",!0),void 0!==n.value.scenario1.simpleYield?(w(),i("tr",c$,[t[60]||(t[60]=s("td",null,[s("strong",null,"Простая доходность (SY)")],-1)),s("td",u$,v(z(n.value.scenario1.simpleYield,2))+"%",1),s("td",d$,v(z(n.value.scenario2.simpleYield||0,2))+"%",1),s("td",{class:c(["mono",(n.value.scenario1.simpleYield||0)>(n.value.scenario2.simpleYield||0)?"text-green":"text-red"])},v(z((n.value.scenario1.simpleYield||0)-(n.value.scenario2.simpleYield||0),2))+"% ",3)])):l("",!0),void 0!==n.value.scenario1.ytmPercent?(w(),i("tr",h$,[t[61]||(t[61]=s("td",null,[s("strong",null,"YTM (доходность к погашению)")],-1)),s("td",p$,v(z(n.value.scenario1.ytmPercent,2))+"%",1),s("td",f$,v(z(n.value.scenario2.ytmPercent||0,2))+"%",1),s("td",{class:c(["mono",(n.value.scenario1.ytmPercent||0)>(n.value.scenario2.ytmPercent||0)?"text-green":"text-red"])},v(z((n.value.scenario1.ytmPercent||0)-(n.value.scenario2.ytmPercent||0),2))+"% ",3)])):l("",!0),void 0!==n.value.scenario1.nominalYield?(w(),i("tr",m$,[t[62]||(t[62]=s("td",null,[s("strong",null,"Номинальная доходность (NY)")],-1)),s("td",v$,v(z(n.value.scenario1.nominalYield,2))+"%",1),s("td",g$,v(z(n.value.scenario2.nominalYield||0,2))+"%",1),s("td",{class:c(["mono",(n.value.scenario1.nominalYield||0)>(n.value.scenario2.nominalYield||0)?"text-green":"text-red"])},v(z((n.value.scenario1.nominalYield||0)-(n.value.scenario2.nominalYield||0),2))+"% ",3)])):l("",!0),void 0!==n.value.scenario1.convexity?(w(),i("tr",y$,[t[63]||(t[63]=s("td",null,[s("strong",null,"Выпуклость (Convexity)")],-1)),s("td",b$,v(z(n.value.scenario1.convexity,2)),1),s("td",x$,v(z(n.value.scenario2.convexity||0,2)),1),s("td",{class:c(["mono",(n.value.scenario1.convexity||0)>(n.value.scenario2.convexity||0)?"text-green":"text-red"])},v(z((n.value.scenario1.convexity||0)-(n.value.scenario2.convexity||0),2)),3)])):l("",!0),void 0!==n.value.scenario1.pvbp?(w(),i("tr",w$,[t[64]||(t[64]=s("td",null,[s("strong",null,"PVBP/DV01 (% от номинала)")],-1)),s("td",_$,v(z(n.value.scenario1.pvbp,4))+"%",1),s("td",S$,v(z(n.value.scenario2.pvbp||0,4))+"%",1),s("td",{class:c(["mono",(n.value.scenario1.pvbp||0)>(n.value.scenario2.pvbp||0)?"text-green":"text-red"])},v(z((n.value.scenario1.pvbp||0)-(n.value.scenario2.pvbp||0),4))+"% ",3)])):l("",!0),void 0!==n.value.scenario1.pvbpAbsolute?(w(),i("tr",M$,[t[65]||(t[65]=s("td",null,[s("strong",null,"PVBP/DV01 (абсолютное)")],-1)),s("td",T$,v(z(n.value.scenario1.pvbpAbsolute,2))+" ₽",1),s("td",k$,v(z(n.value.scenario2.pvbpAbsolute||0,2))+" ₽",1),s("td",{class:c(["mono",(n.value.scenario1.pvbpAbsolute||0)>(n.value.scenario2.pvbpAbsolute||0)?"text-green":"text-red"])},v(z((n.value.scenario1.pvbpAbsolute||0)-(n.value.scenario2.pvbpAbsolute||0),2))+" ₽ ",3)])):l("",!0),null!==n.value.scenario1.discountMargin&&void 0!==n.value.scenario1.discountMargin?(w(),i("tr",C$,[t[66]||(t[66]=s("td",null,[s("strong",null,"Discount Margin (DM)")],-1)),s("td",A$,v(z(n.value.scenario1.discountMargin,2))+" bp",1),s("td",E$,v(z(n.value.scenario2.discountMargin||0,2))+" bp",1),s("td",{class:c(["mono",(n.value.scenario1.discountMargin||0)>(n.value.scenario2.discountMargin||0)?"text-green":"text-red"])},v(z((n.value.scenario1.discountMargin||0)-(n.value.scenario2.discountMargin||0),2))+" bp ",3)])):l("",!0)])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value&&n.value.scenario1.sensitivityScenarios&&n.value.scenario1.sensitivityScenarios.length>0?(w(),i("div",I$,[s("div",R$,[t[68]||(t[68]=s("h3",null,"Анализ чувствительности цены (Сценарий 1)",-1)),s("div",D$,v(n.value.scenario1.sensitivityScenarios.length)+" сценариев",1)]),s("div",P$,[s("table",L$,[t[69]||(t[69]=s("thead",null,[s("tr",null,[s("th",null,"Δ Доходность (bp)"),s("th",{class:"text-right"},"Δ Доходность (%)"),s("th",{class:"text-right"},"Δ Цена (%)"),s("th",{class:"text-right"},"Δ Цена (₽)"),s("th",{class:"text-right"},"Новая цена (₽)"),s("th",{class:"text-right"},"Новая YTM (%)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(n.value.scenario1.sensitivityScenarios,(e,t)=>(w(),i("tr",{key:t},[s("td",{class:c(["mono",e.yieldChangeBps>0?"text-red":e.yieldChangeBps<0?"text-green":""])},v(e.yieldChangeBps>0?"+":"")+v(e.yieldChangeBps)+" bp ",3),s("td",{class:c(["text-right mono",e.yieldChangePercent>0?"text-red":e.yieldChangePercent<0?"text-green":""])},v(e.yieldChangePercent>0?"+":"")+v(z(e.yieldChangePercent,2))+"% ",3),s("td",{class:c(["text-right mono",e.priceChangePercent>0?"text-green":e.priceChangePercent<0?"text-red":""])},v(e.priceChangePercent>0?"+":"")+v(z(e.priceChangePercent,2))+"% ",3),s("td",{class:c(["text-right mono",e.priceChangeAbsolute>0?"text-green":e.priceChangeAbsolute<0?"text-red":""])},v(e.priceChangeAbsolute>0?"+":"")+v(z(e.priceChangeAbsolute,2))+" ₽ ",3),s("td",N$,v(z(e.newDirtyPrice,2))+" ₽",1),s("td",O$,v(z(e.newYtmPercent,2))+"%",1)]))),128))])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value&&n.value.scenario2.sensitivityScenarios&&n.value.scenario2.sensitivityScenarios.length>0?(w(),i("div",F$,[s("div",B$,[t[70]||(t[70]=s("h3",null,"Анализ чувствительности цены (Сценарий 2)",-1)),s("div",U$,v(n.value.scenario2.sensitivityScenarios.length)+" сценариев",1)]),s("div",z$,[s("table",V$,[t[71]||(t[71]=s("thead",null,[s("tr",null,[s("th",null,"Δ Доходность (bp)"),s("th",{class:"text-right"},"Δ Доходность (%)"),s("th",{class:"text-right"},"Δ Цена (%)"),s("th",{class:"text-right"},"Δ Цена (₽)"),s("th",{class:"text-right"},"Новая цена (₽)"),s("th",{class:"text-right"},"Новая YTM (%)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(n.value.scenario2.sensitivityScenarios,(e,t)=>(w(),i("tr",{key:t},[s("td",{class:c(["mono",e.yieldChangeBps>0?"text-red":e.yieldChangeBps<0?"text-green":""])},v(e.yieldChangeBps>0?"+":"")+v(e.yieldChangeBps)+" bp ",3),s("td",{class:c(["text-right mono",e.yieldChangePercent>0?"text-red":e.yieldChangePercent<0?"text-green":""])},v(e.yieldChangePercent>0?"+":"")+v(z(e.yieldChangePercent,2))+"% ",3),s("td",{class:c(["text-right mono",e.priceChangePercent>0?"text-green":e.priceChangePercent<0?"text-red":""])},v(e.priceChangePercent>0?"+":"")+v(z(e.priceChangePercent,2))+"% ",3),s("td",{class:c(["text-right mono",e.priceChangeAbsolute>0?"text-green":e.priceChangeAbsolute<0?"text-red":""])},v(e.priceChangeAbsolute>0?"+":"")+v(z(e.priceChangeAbsolute,2))+" ₽ ",3),s("td",H$,v(z(e.newDirtyPrice,2))+" ₽",1),s("td",G$,v(z(e.newYtmPercent,2))+"%",1)]))),128))])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value&&n.value.cashFlows1?(w(),i("div",W$,[s("div",q$,[t[72]||(t[72]=s("h3",null,"Денежные потоки (Сценарий 1)",-1)),s("div",Y$,v(n.value.cashFlows1.length)+" платежей",1)]),s("div",j$,[s("table",X$,[t[74]||(t[74]=s("thead",null,[s("tr",null,[s("th",null,"Дата"),s("th",{class:"text-right"},"T (лет)"),s("th",{class:"text-right"},"CF (₽)"),s("th",{class:"text-right"},"DF"),s("th",{class:"text-right"},"PV (₽)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(n.value.cashFlows1,(e,t)=>(w(),i("tr",{key:t},[s("td",$$,v(V(e.date)),1),s("td",K$,v(z(e.t,3)),1),s("td",Z$,v(z(e.cf,2)),1),s("td",J$,v(z(e.df,4)),1),s("td",Q$,v(z(e.pv,2)),1)]))),128))]),s("tfoot",null,[s("tr",null,[t[73]||(t[73]=s("td",{colspan:"4",class:"text-right text-muted"},"Общая PV (Dirty):",-1)),s("td",eK,v(z(n.value.scenario1.dirtyPrice,2)),1)])])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value&&n.value.cashFlows2?(w(),i("div",tK,[s("div",aK,[t[75]||(t[75]=s("h3",null,"Денежные потоки (Сценарий 2)",-1)),s("div",nK,v(n.value.cashFlows2.length)+" платежей",1)]),s("div",rK,[s("table",iK,[t[77]||(t[77]=s("thead",null,[s("tr",null,[s("th",null,"Дата"),s("th",{class:"text-right"},"T (лет)"),s("th",{class:"text-right"},"CF (₽)"),s("th",{class:"text-right"},"DF"),s("th",{class:"text-right"},"PV (₽)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(n.value.cashFlows2,(e,t)=>(w(),i("tr",{key:t},[s("td",oK,v(V(e.date)),1),s("td",sK,v(z(e.t,3)),1),s("td",lK,v(z(e.cf,2)),1),s("td",cK,v(z(e.df,4)),1),s("td",uK,v(z(e.pv,2)),1)]))),128))]),s("tfoot",null,[s("tr",null,[t[76]||(t[76]=s("td",{colspan:"4",class:"text-right text-muted"},"Общая PV (Dirty):",-1)),s("td",dK,v(z(n.value.scenario2.dirtyPrice,2)),1)])])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value&&n.value.allCoupons?(w(),i("div",hK,[s("div",pK,[t[78]||(t[78]=s("h3",null,"График купонных выплат",-1)),s("div",fK,[s("span",mK,v(n.value.allCoupons.filter(e=>e.isPaid).length)+" выплачено",1),s("span",vK,v(n.value.allCoupons.filter(e=>!e.isPaid).length)+" будущих",1)])]),s("div",gK,[(w(!0),i(p,null,f(n.value.allCoupons,(e,t)=>(w(),i("div",{key:t,class:c(["coupon-card",e.isPaid?"paid":"future"])},[s("div",yK,v(t+1),1),s("div",bK,[s("div",xK,v(V(e.date)),1),s("div",wK,v(z(e.value,2))+" ₽",1)]),s("div",_K,[s("span",{class:c(["status-badge",e.isPaid?"paid":"future"])},v(e.isPaid?"✓ Выплачен":"◯ Будущий"),3)])],2))),128))])])):l("",!0)]),_:1}),n.value||r.value?l("",!0):(w(),i("div",SK,[...t[79]||(t[79]=[s("div",{class:"placeholder-content"},[s("span",{class:"icon-lg"},"📊"),s("h3",null,"Введите параметры и нажмите «Рассчитать»"),s("p",null,"Для загрузки данных о купонах используется MOEX API")],-1)])]))])])]))}}),TK=xe(MK,[["__scopeId","data-v-8e417c48"]]);re.register(...ie);const kK={class:"page-container"},CK={class:"section-header"},AK={class:"header-actions"},EK={class:"glass-pill control-pill"},IK=["max","disabled"],RK=["disabled"],DK={key:0,width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},PK={key:1,class:"spinner-mini"},LK={class:"kpi-cards-grid"},NK={class:"glass-card kpi-card"},OK={class:"kpi-value"},FK={class:"glass-card kpi-card"},BK={class:"kpi-value text-gradient-blue"},UK={class:"glass-card kpi-card"},zK={class:"kpi-value"},VK={class:"glass-card kpi-card"},HK={class:"kpi-value text-gradient-green"},GK={class:"dashboard-grid"},WK={class:"col-left"},qK={class:"glass-card panel"},YK={class:"search-container"},jK={class:"search-input-wrapper"},XK={key:0,class:"period-suggestions"},$K=["onClick"],KK={class:"suggestion-term"},ZK={class:"suggestion-rate"},JK={class:"form-hint"},QK={key:0,class:"glass-card panel highlight-panel"},eZ={class:"panel-header"},tZ={class:"badge-glass"},aZ={class:"result-metrics"},nZ={class:"metric-item"},rZ={class:"metric-value"},iZ={class:"metric-item"},oZ={class:"metric-value text-gradient-blue"},sZ={class:"metric-item"},lZ={class:"metric-value"},cZ={class:"glass-card panel"},uZ={class:"chart-container"},dZ={class:"glass-card panel"},hZ={class:"panel-header"},pZ={class:"badge-glass"},fZ={class:"table-wrapper"},mZ={class:"glass-table"},vZ={class:"col-index"},gZ={class:"col-term mono"},yZ={class:"col-rate mono text-gradient-blue"},bZ={class:"col-class"},xZ={class:"badge-type"},wZ={key:0},_Z={class:"col-right"},SZ={class:"glass-card panel"},MZ={class:"metrics-kv-list"},TZ={class:"kv-row"},kZ={class:"v mono"},CZ={class:"kv-row"},AZ={class:"v mono"},EZ={class:"kv-row"},IZ={class:"v mono"},RZ={class:"kv-row"},DZ=e({__name:"ZCYCViewer",setup(e){const a=t({date:(new Date).toISOString().split("T")[0]}),r=t({status:"ok",date:"2026-01-03",count:12,min_term:.083,max_term:10,min_rate:13.45,max_rate:14.82,mean_rate:14.12,data:[{term:.083,value:13.45},{term:.25,value:13.52},{term:.5,value:13.68},{term:1,value:13.95},{term:2,value:14.28},{term:3,value:14.42},{term:5,value:14.65},{term:7,value:14.75},{term:10,value:14.82},{term:15,value:14.8},{term:20,value:14.75},{term:30,value:14.7}]}),o=t(!1),u=t(null),d=t(null),h=t(""),g=t(null),y=t(!1),b=(new Date).toISOString().split("T")[0],x=S(()=>{if(!h.value||!r.value)return[];const e=parseFloat(h.value);return isNaN(e)?[]:r.value.data.map(t=>({...t,diff:Math.abs(t.term-e)})).sort((e,t)=>e.diff-t.diff).slice(0,10).map(({diff:e,...t})=>t)}),_=async()=>{if(a.value.date){o.value=!0;try{const{getZCYC:e}=await ne(async()=>{const{getZCYC:e}=await import("./zcycService-OewXv6Yo.js");return{getZCYC:e}},[]),t=await e(a.value.date);"ok"===t.status?(r.value=t,E(r.value)):(console.error("Ошибка загрузки КБД:",t.error),alert(`Ошибка загрузки кривой: ${t.error||"Неизвестная ошибка"}`))}catch(QXe){console.error("Ошибка загрузки кривой бескупонных доходностей:",QXe);const t=QXe.message||"Неизвестная ошибка";console.error("Детали ошибки:",{message:t,date:a.value.date}),alert(`Ошибка загрузки кривой: ${t}\n\nПроверьте:\n1. Запущен ли бэкенд сервер\n2. Правильность URL API в настройках`)}finally{o.value=!1}}else console.warn("Дата не выбрана")},M=()=>{a.value.date&&_()},C=()=>{y.value=h.value.length>0},A=()=>{if(!h.value||!r.value)return void(g.value=null);const e=parseFloat(h.value);if(isNaN(e))return void(g.value=null);if(e<r.value.min_term||e>r.value.max_term)return void(g.value=null);const t=(e=>{if(!r.value||r.value.data.length<2)return null;const t=r.value.data,a=t.find(t=>Math.abs(t.term-e)<1e-4);if(a)return a.value;let n=null,i=null;for(let r=0;r<t.length;r++)t[r].term<=e&&(!n||t[r].term>n.term)&&(n=t[r]),t[r].term>=e&&(!i||t[r].term<i.term)&&(i=t[r]);if(!n)return t[0].value;if(!i)return t[t.length-1].value;if(!n||!i||n===i)return n?.value||null;const o=(e-n.term)/(i.term-n.term);return n.value+o*(i.value-n.value)})(e);g.value=null!==t?{term:e,value:t}:null},E=e=>{if(!u.value)return;d.value&&d.value.destroy();const t=u.value.getContext("2d");t&&(d.value=new re(t,{type:"line",data:{labels:e.data.map(e=>`${e.term.toFixed(2)}y`),datasets:[{label:"Ставка КБД (%)",data:e.data.map(e=>e.value),borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.1)",borderWidth:2.5,fill:!0,tension:.35,pointRadius:4,pointBackgroundColor:"#60a5fa",pointBorderColor:"#ffffff",pointBorderWidth:1.5,pointHoverRadius:6,pointHoverBackgroundColor:"#3b82f6"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{boxWidth:12,padding:15,font:{size:14,weight:"bold"},color:"rgba(255,255,255,0.6)"}},tooltip:{enabled:!0,backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:13,weight:"bold"},bodyFont:{size:12},borderColor:"#60a5fa",borderWidth:1,titleColor:"#60a5fa",bodyColor:"#e5e7eb",displayColors:!1,callbacks:{label:e=>`Ставка: ${Number(e.parsed.y).toFixed(3)}%`}}},scales:{y:{beginAtZero:!1,grid:{color:"rgba(255, 255, 255, 0.08)",lineWidth:1},ticks:{color:"rgba(255,255,255,0.6)",font:{size:12},callback:e=>`${Number(e).toFixed(1)}%`,padding:10},title:{display:!0,text:"Ставка, % годовых",font:{weight:"bold",size:13},color:"rgba(255,255,255,0.6)",padding:12}},x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.6)",font:{size:12},padding:10,maxRotation:0},title:{display:!0,text:"Срок до погашения",font:{weight:"bold",size:13},color:"rgba(255,255,255,0.6)",padding:12}}}}}))},R=e=>e<=.5?"Ночной":e<=1?"Краткосрочный":e<=3?"Среднесрочный":e<=5?"Долгосрочный":"Очень долгосрочный",D=()=>{if(!r.value||0===r.value.data.length)return 0;const e=r.value.data;let t=e[e.length-1].value,a=e[0].value;for(const n of e)Math.abs(n.term-5)<Math.abs(t-5)&&(t=n.value),Math.abs(n.term-.5)<Math.abs(a-.5)&&(a=n.value);return t-a},P=(e,t=2)=>e.toLocaleString("ru-RU",{minimumFractionDigits:t,maximumFractionDigits:t}),L=e=>new Date(e+"T00:00:00").toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"});return n(()=>{_()}),(e,t)=>(w(),i("div",kK,[s("div",CK,[t[4]||(t[4]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"КБД"),s("p",{class:"section-subtitle"},"Кривая бескупонных доходностей от MOEX ISS API")],-1)),s("div",AK,[s("div",EK,[t[2]||(t[2]=s("span",{class:"lbl-mini"},"Дата:",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.date=e),type:"date",class:"date-input",max:O(b),min:"2014-01-06",onChange:M,disabled:o.value},null,40,IK),[[k,a.value.date]])]),s("button",{class:"btn-glass primary",onClick:_,disabled:o.value},[o.value?(w(),i("span",PK)):(w(),i("svg",DK,[...t[3]||(t[3]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),s("span",null,v(o.value?"Загрузка...":"Загрузить"),1)],8,RK)])]),s("div",LK,[s("div",NK,[t[5]||(t[5]=s("div",{class:"kpi-label"},"Дата КБД",-1)),s("div",OK,v(L(r.value.date)),1),t[6]||(t[6]=s("div",{class:"kpi-sub"},[s("span",{class:"text-muted"},"Последнее обновление")],-1))]),s("div",FK,[t[7]||(t[7]=s("div",{class:"kpi-label"},"Точек на кривой",-1)),s("div",BK,v(r.value.count),1),t[8]||(t[8]=s("div",{class:"kpi-sub"},[s("span",{class:"text-muted"},"Точек данных")],-1))]),s("div",UK,[t[9]||(t[9]=s("div",{class:"kpi-label"},"Минимальная ставка",-1)),s("div",zK,v(P(r.value.min_rate,3))+"%",1),t[10]||(t[10]=s("div",{class:"kpi-sub"},[s("span",{class:"text-muted"},"Мин. ставка")],-1))]),s("div",VK,[t[11]||(t[11]=s("div",{class:"kpi-label"},"Максимальная ставка",-1)),s("div",HK,v(P(r.value.max_rate,3))+"%",1),t[12]||(t[12]=s("div",{class:"kpi-sub"},[s("span",{class:"text-muted"},"Макс. ставка")],-1))])]),s("div",GK,[s("div",WK,[s("div",qK,[t[14]||(t[14]=s("div",{class:"panel-header"},[s("h3",null,"Поиск периода (интерполяция)")],-1)),s("div",YK,[s("div",jK,[T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>h.value=e),type:"number",step:"0.01",class:"search-input",placeholder:"Введите срок (например 2.23)",onInput:C,onChange:A,onKeydown:U(A,["enter"])},null,544),[[k,h.value]]),t[13]||(t[13]=s("span",{class:"search-unit"},"лет",-1))]),y.value&&x.value.length>0?(w(),i("div",XK,[(w(!0),i(p,null,f(x.value.slice(0,5),(e,t)=>(w(),i("div",{key:t,class:"suggestion-item",onClick:t=>(e=>{e&&(g.value=e,h.value=P(e.term,4),y.value=!1)})(e)},[s("span",KK,v(P(e.term,4)),1),s("span",ZK,v(P(e.value,3))+"%",1)],8,$K))),128))])):l("",!0)]),s("small",JK,v(g.value?`Найдено: ${P(g.value.term,4)} лет → ${P(g.value.value,4)}%`:"Введите срок и нажмите Enter"),1)]),g.value?(w(),i("div",QK,[s("div",eZ,[t[15]||(t[15]=s("h3",null,"Результат интерполяции",-1)),s("div",tZ,v(R(g.value.term)),1)]),s("div",aZ,[s("div",nZ,[t[16]||(t[16]=s("span",{class:"metric-label"},"Период",-1)),s("span",rZ,v(P(g.value.term,4))+" лет",1)]),s("div",iZ,[t[17]||(t[17]=s("span",{class:"metric-label"},"Доходность",-1)),s("span",oZ,v(P(g.value.value,4))+"%",1)]),s("div",sZ,[t[18]||(t[18]=s("span",{class:"metric-label"},"На дату",-1)),s("span",lZ,v(L(r.value.date)),1)])])])):l("",!0),s("div",cZ,[t[19]||(t[19]=s("div",{class:"panel-header"},[s("h3",null,"Кривая доходности"),s("div",{class:"legend"},[s("span",{class:"dot-legend bg-blue"}),m(" Ставка КБД ")])],-1)),s("div",uZ,[s("canvas",{ref_key:"chartCanvas",ref:u,class:"chart-canvas"},null,512)])]),s("div",dZ,[s("div",hZ,[t[20]||(t[20]=s("h3",null,"Таблица данных",-1)),s("div",pZ,v(r.value.data.length)+" точек",1)]),s("div",fZ,[s("table",mZ,[t[22]||(t[22]=s("thead",null,[s("tr",null,[s("th",{class:"col-index"},"#"),s("th",{class:"col-term"},"Срок (годы)"),s("th",{class:"col-rate"},"Ставка (%)"),s("th",{class:"col-class"},"Класс")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(r.value.data,(e,t)=>{return w(),i("tr",{key:t,class:c((a=e.term,{"short-term":a<=1,"medium-term":a>1&&a<=3,"long-term":a>3}))},[s("td",vZ,v(t+1),1),s("td",gZ,v(P(e.term,4)),1),s("td",yZ,v(P(e.value,4)),1),s("td",bZ,[s("span",xZ,v(R(e.term)),1)])],2);var a}),128)),0===r.value.data.length?(w(),i("tr",wZ,[...t[21]||(t[21]=[s("td",{colspan:"4",class:"empty-state"},"Нет данных для отображения",-1)])])):l("",!0)])])])])]),s("div",_Z,[s("div",SZ,[t[27]||(t[27]=s("div",{class:"panel-header"},[s("h3",null,"Статистика кривой")],-1)),s("div",MZ,[s("div",TZ,[t[23]||(t[23]=s("span",{class:"k"},"Диапазон сроков",-1)),s("span",kZ,v(P(r.value.min_term,4))+" – "+v(P(r.value.max_term,2)),1)]),s("div",CZ,[t[24]||(t[24]=s("span",{class:"k"},"Средняя ставка",-1)),s("span",AZ,v(P(r.value.mean_rate,3))+"%",1)]),s("div",EZ,[t[25]||(t[25]=s("span",{class:"k"},"Разброс (max-min)",-1)),s("span",IZ,v(P(r.value.max_rate-r.value.min_rate,3))+"%",1)]),s("div",RZ,[t[26]||(t[26]=s("span",{class:"k"},"Наклон (5л - 0.5л)",-1)),s("span",{class:c(["v mono",D()>0?"text-green":"text-red"])},v(P(D(),3))+"%",3)])])]),t[28]||(t[28]=I('<div class="glass-card panel" data-v-b1a86551><div class="panel-header" data-v-b1a86551><h3 data-v-b1a86551>Классификация сроков</h3></div><div class="factor-list" data-v-b1a86551><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Ночной</span><span class="sub-lbl" data-v-b1a86551>≤ 0.5 лет</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Краткосрочный</span><span class="sub-lbl" data-v-b1a86551>0.5 – 1 год</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Среднесрочный</span><span class="sub-lbl" data-v-b1a86551>1 – 3 года</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Долгосрочный</span><span class="sub-lbl" data-v-b1a86551>3 – 5 лет</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Очень долгосрочный</span><span class="sub-lbl" data-v-b1a86551>&gt; 5 лет</span></div></div></div></div><div class="glass-card panel" data-v-b1a86551><div class="panel-header" data-v-b1a86551><h3 data-v-b1a86551>О КБД</h3></div><div class="info-text" data-v-b1a86551><p data-v-b1a86551><strong data-v-b1a86551>КБД</strong> — кривая бескупонных доходностей показывает зависимость доходности до погашения бескупонных облигаций от сроков до погашения. </p><p data-v-b1a86551><strong data-v-b1a86551>Источник:</strong> MOEX ISS API </p><p data-v-b1a86551><strong data-v-b1a86551>Интерполяция:</strong> MOEX использует метод Нельсона-Сигеля для интерполяции кривой. Если срок не совпадает ни с одной точкой кривой, система вычисляет доходность методом линейной интерполяции между двумя ближайшими точками. </p><p data-v-b1a86551><strong data-v-b1a86551>Выбор даты:</strong> Выберите дату для получения кривой бескупонных доходностей. Доступны данные с 2014 года по текущую дату. </p></div></div>',2))])])]))}}),PZ=xe(DZ,[["__scopeId","data-v-b1a86551"]]),LZ={class:"page-container"},NZ={class:"section-header"},OZ={class:"header-actions"},FZ=["disabled"],BZ={key:0,width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},UZ={key:1,class:"spinner-mini"},zZ={class:"glass-card panel step-panel"},VZ={class:"controls-form"},HZ={class:"params-grid"},GZ={class:"form-group"},WZ={class:"form-group"},qZ={class:"form-group"},YZ={class:"form-group"},jZ=["disabled"],XZ={key:0},$Z={key:1,class:"flex-center"},KZ={key:0,class:"alert-glass alert-danger"},ZZ={key:0,class:"glass-card panel step-panel"},JZ={class:"report-config"},QZ={class:"config-section"},eJ={class:"checkbox-grid"},tJ={class:"checkbox-item"},aJ={class:"checkbox-item"},nJ={class:"checkbox-item"},rJ={class:"checkbox-item"},iJ={class:"checkbox-item"},oJ={class:"checkbox-item"},sJ={class:"config-section"},lJ={class:"form-row-2"},cJ={class:"form-group"},uJ={class:"form-group"},dJ={class:"form-group"},hJ={key:0,class:"glass-card panel step-panel preview-panel"},pJ={class:"report-preview"},fJ={key:0,class:"report-section"},mJ={class:"summary-box"},vJ={class:"summary-row"},gJ={class:"value mono"},yJ={class:"summary-row"},bJ={class:"value text-gradient-blue"},xJ={class:"summary-row"},wJ={class:"value"},_J={class:"summary-row"},SJ={class:"value"},MJ={class:"summary-row"},TJ={class:"value text-orange"},kJ={key:1,class:"report-section"},CJ={class:"report-table-wrapper"},AJ={class:"report-table"},EJ={class:"value mono"},IJ={class:"value mono"},RJ={class:"value mono"},DJ={class:"value"},PJ={class:"value"},LJ={class:"value"},NJ={key:2,class:"report-section"},OJ={class:"report-table-wrapper"},FJ={class:"report-table"},BJ={class:"value mono text-gradient-blue"},UJ={class:"value mono"},zJ={class:"value mono"},VJ={class:"value mono"},HJ={class:"value mono text-orange"},GJ={key:3,class:"report-section"},WJ={class:"table-scroll"},qJ={class:"report-table cf-table"},YJ={class:"text-right mono"},jJ={class:"text-right mono"},XJ={class:"text-right mono"},$J={class:"text-right mono"},KJ={class:"text-right mono"},ZJ={key:4,class:"report-section"},JJ={class:"table-scroll"},QJ={class:"report-table coupon-table"},eQ={class:"text-right mono"},tQ={key:5,class:"report-section"},aQ={class:"report-table-wrapper"},nQ={class:"report-table"},rQ={class:"value"},iQ={class:"value mono"},oQ={class:"value mono"},sQ={class:"value"},lQ={key:0},cQ={class:"value"},uQ={class:"report-footer"},dQ={key:0,class:"footer-item"},hQ={key:1,class:"footer-item"},pQ={class:"footer-item"},fQ={key:0,class:"action-bar"},mQ=["disabled"],vQ=e({__name:"BondReport",setup(e){const a=t({secid:"RU000A10AU99",valuationDate:(new Date).toISOString().split("T")[0],discountYield:14,dayCount:365}),n=t({secid:"RU000A10AU99",faceValue:1e3,couponPercent:9,issueDate:"2023-01-01",maturityDate:"2028-01-01",paymentsPerYear:2,dirtyPrice:987.65,accruedInterest:15.5,cleanPrice:972.15,pricePercent:97.215,duration:2.45,cashFlows:[{date:"2026-07-03",t:.5,cf:45,df:.9326,pv:41.97},{date:"2027-01-03",t:1,cf:45,df:.8704,pv:39.17},{date:"2027-07-03",t:1.5,cf:45,df:.8118,pv:36.53},{date:"2028-01-03",t:2,cf:45,df:.7565,pv:34.04},{date:"2028-07-03",t:2.5,cf:45,df:.7041,pv:31.69},{date:"2029-01-03",t:3,cf:1045,df:.6543,pv:683.55}],allCoupons:[{date:"2025-07-03",value:45,isPaid:!0},{date:"2026-01-03",value:45,isPaid:!0},{date:"2026-07-03",value:45,isPaid:!1},{date:"2027-01-03",value:45,isPaid:!1},{date:"2027-07-03",value:45,isPaid:!1},{date:"2028-01-03",value:45,isPaid:!1},{date:"2028-07-03",value:45,isPaid:!1},{date:"2029-01-03",value:1045,isPaid:!1}]}),r=t(!1),o=t(""),d=t({includeExec:!0,includeBondInfo:!0,includeValuation:!0,includeCashFlows:!0,includeCoupons:!0,includeMetadata:!0,author:"Аналитик",company:"Компания",notes:""}),g=async()=>{r.value=!0,o.value="",n.value=null;try{const e=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/bond/valuate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secid:a.value.secid,valuation_date:a.value.valuationDate,discount_yield:a.value.discountYield/100,day_count:a.value.dayCount})});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);n.value=await e.json()}catch(e){o.value=e.message||"Ошибка при расчёте облигации",n.value=null}finally{r.value=!1}},y=()=>{n.value=null},b=async()=>{if(n.value)try{r.value=!0,window.print()}catch(e){o.value="Ошибка при генерации отчета"}finally{r.value=!1}},x=()=>{window.print()},_=async()=>{const e=document.querySelector(".report-preview");if(e)try{const t=e.innerText;await navigator.clipboard.writeText(t),alert("Отчет скопирован в буфер обмена")}catch(t){o.value="Ошибка при копировании"}},S=(e,t=2)=>e.toLocaleString("ru-RU",{minimumFractionDigits:t,maximumFractionDigits:t}),C=e=>new Date(e+"T00:00:00").toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"});return(e,t)=>(w(),i("div",LZ,[s("div",NZ,[t[14]||(t[14]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Отчет по оценке облигаций"),s("p",{class:"section-subtitle"},"Формирование аналитического отчёта")],-1)),s("div",OZ,[s("button",{class:"btn-glass primary",onClick:b,disabled:r.value||!n.value},[r.value?(w(),i("span",UZ)):(w(),i("svg",BZ,[...t[13]||(t[13]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m4-3H8m7-7H5a2 2 0 00-2 2v12a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2z"},null,-1)])])),s("span",null,v(r.value?"Генерация...":"Скачать PDF"),1)],8,FZ)])]),s("div",zZ,[t[21]||(t[21]=s("div",{class:"panel-header"},[s("h3",null,"Шаг 1: Загрузка данных из оценки"),s("span",{class:"step-badge"},"1")],-1)),s("div",VZ,[s("div",HZ,[s("div",GZ,[t[15]||(t[15]=s("label",{class:"lbl"},"ISIN Облигации",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.secid=e),type:"text",class:"glass-input",placeholder:"RU000A10AU99",onChange:y},null,544),[[k,a.value.secid]])]),s("div",WZ,[t[16]||(t[16]=s("label",{class:"lbl"},"Дата оценки",-1)),T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.valuationDate=e),type:"date",class:"glass-input",onChange:y},null,544),[[k,a.value.valuationDate]])]),s("div",qZ,[t[17]||(t[17]=s("label",{class:"lbl"},"Доходность (%)",-1)),T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.value.discountYield=e),type:"number",step:"0.01",class:"glass-input",placeholder:"14.0",onChange:y},null,544),[[k,a.value.discountYield,void 0,{number:!0}]])]),s("div",YZ,[t[19]||(t[19]=s("label",{class:"lbl"},"База расчета",-1)),T(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.value.dayCount=e),class:"glass-input",onChange:y},[...t[18]||(t[18]=[s("option",{value:365},"ACT/365",-1),s("option",{value:360},"30/360",-1)])],544),[[D,a.value.dayCount,void 0,{number:!0}]])])]),s("button",{class:"btn-glass primary wide",onClick:g,disabled:r.value},[r.value?(w(),i("span",$Z,[...t[20]||(t[20]=[s("span",{class:"spinner-mini"},null,-1),m(" Загрузка...",-1)])])):(w(),i("span",XZ,"Загрузить оценку"))],8,jZ)])]),u(M,{name:"fade"},{default:h(()=>[o.value?(w(),i("div",KZ,[t[22]||(t[22]=s("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})],-1)),s("span",null,v(o.value),1)])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value?(w(),i("div",ZZ,[t[34]||(t[34]=s("div",{class:"panel-header"},[s("h3",null,"Шаг 2: Конфигурация отчёта"),s("span",{class:"step-badge variant-2"},"2")],-1)),s("div",JZ,[s("div",QZ,[t[29]||(t[29]=s("h4",{class:"section-label"},"Содержание отчета",-1)),s("div",eJ,[s("label",tJ,[T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>d.value.includeExec=e),type:"checkbox"},null,512),[[L,d.value.includeExec]]),t[23]||(t[23]=s("span",null,"Резюме",-1))]),s("label",aJ,[T(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>d.value.includeBondInfo=e),type:"checkbox"},null,512),[[L,d.value.includeBondInfo]]),t[24]||(t[24]=s("span",null,"Параметры облигации",-1))]),s("label",nJ,[T(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>d.value.includeValuation=e),type:"checkbox"},null,512),[[L,d.value.includeValuation]]),t[25]||(t[25]=s("span",null,"Результаты оценки",-1))]),s("label",rJ,[T(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>d.value.includeCashFlows=e),type:"checkbox"},null,512),[[L,d.value.includeCashFlows]]),t[26]||(t[26]=s("span",null,"Таблица денежных потоков",-1))]),s("label",iJ,[T(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>d.value.includeCoupons=e),type:"checkbox"},null,512),[[L,d.value.includeCoupons]]),t[27]||(t[27]=s("span",null,"График купонов",-1))]),s("label",oJ,[T(s("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>d.value.includeMetadata=e),type:"checkbox"},null,512),[[L,d.value.includeMetadata]]),t[28]||(t[28]=s("span",null,"Метаданные модели",-1))])])]),s("div",sJ,[t[33]||(t[33]=s("h4",{class:"section-label"},"Параметры отчета",-1)),s("div",lJ,[s("div",cJ,[t[30]||(t[30]=s("label",{class:"lbl"},"Автор отчета",-1)),T(s("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>d.value.author=e),type:"text",class:"glass-input",placeholder:"Имя аналитика"},null,512),[[k,d.value.author]])]),s("div",uJ,[t[31]||(t[31]=s("label",{class:"lbl"},"Компания",-1)),T(s("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>d.value.company=e),type:"text",class:"glass-input",placeholder:"Компания/Фонд"},null,512),[[k,d.value.company]])])]),s("div",dJ,[t[32]||(t[32]=s("label",{class:"lbl"},"Дополнительные примечания",-1)),T(s("textarea",{"onUpdate:modelValue":t[12]||(t[12]=e=>d.value.notes=e),class:"glass-input textarea",rows:"4",placeholder:"Комментарии, допущения, ограничения модели..."},null,512),[[k,d.value.notes]])])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value?(w(),i("div",hJ,[t[69]||(t[69]=s("div",{class:"panel-header"},[s("h3",null,"Шаг 3: Предпросмотр отчета"),s("span",{class:"step-badge variant-3"},"3")],-1)),s("div",pJ,[d.value.includeExec?(w(),i("div",fJ,[t[40]||(t[40]=s("h2",{class:"report-title"},"Резюме",-1)),s("div",mJ,[s("div",vJ,[t[35]||(t[35]=s("span",{class:"label"},"Облигация",-1)),s("span",gJ,v(n.value.secid),1)]),s("div",yJ,[t[36]||(t[36]=s("span",{class:"label"},"Справедливая стоимость",-1)),s("span",bJ,v(S(n.value.dirtyPrice,4))+" ₽",1)]),s("div",xJ,[t[37]||(t[37]=s("span",{class:"label"},"Чистая цена",-1)),s("span",wJ,v(S(n.value.cleanPrice,4))+" ₽",1)]),s("div",_J,[t[38]||(t[38]=s("span",{class:"label"},"% от номинала",-1)),s("span",SJ,v(S(n.value.pricePercent,2))+"%",1)]),s("div",MJ,[t[39]||(t[39]=s("span",{class:"label"},"Дюрация (Modified)",-1)),s("span",TJ,v(S(n.value.duration,4))+" лет",1)])])])):l("",!0),d.value.includeBondInfo?(w(),i("div",kJ,[t[47]||(t[47]=s("h2",{class:"report-title"},"Параметры облигации",-1)),s("div",CJ,[s("table",AJ,[s("tbody",null,[s("tr",null,[t[41]||(t[41]=s("td",{class:"label"},"SECID/ISIN",-1)),s("td",EJ,v(n.value.secid),1)]),s("tr",null,[t[42]||(t[42]=s("td",{class:"label"},"Номинал",-1)),s("td",IJ,v(S(n.value.faceValue))+" ₽",1)]),s("tr",null,[t[43]||(t[43]=s("td",{class:"label"},"Купон",-1)),s("td",RJ,v(S(n.value.couponPercent,3))+"% годовых",1)]),s("tr",null,[t[44]||(t[44]=s("td",{class:"label"},"Дата выпуска",-1)),s("td",DJ,v(C(n.value.issueDate)),1)]),s("tr",null,[t[45]||(t[45]=s("td",{class:"label"},"Дата погашения",-1)),s("td",PJ,v(C(n.value.maturityDate)),1)]),s("tr",null,[t[46]||(t[46]=s("td",{class:"label"},"Периодичность выплат",-1)),s("td",LJ,v(n.value.paymentsPerYear)+" раз(а) в год",1)])])])])])):l("",!0),d.value.includeValuation?(w(),i("div",NJ,[t[53]||(t[53]=s("h2",{class:"report-title"},"Результаты оценки",-1)),s("div",OJ,[s("table",FJ,[s("tbody",null,[s("tr",null,[t[48]||(t[48]=s("td",{class:"label"},"Dirty Price",-1)),s("td",BJ,v(S(n.value.dirtyPrice,4))+" ₽",1)]),s("tr",null,[t[49]||(t[49]=s("td",{class:"label"},"НКД",-1)),s("td",UJ,v(S(n.value.accruedInterest,4))+" ₽",1)]),s("tr",null,[t[50]||(t[50]=s("td",{class:"label"},"Clean Price",-1)),s("td",zJ,v(S(n.value.cleanPrice,4))+" ₽",1)]),s("tr",null,[t[51]||(t[51]=s("td",{class:"label"},"Цена в % от номинала",-1)),s("td",VJ,v(S(n.value.pricePercent,3))+"%",1)]),s("tr",null,[t[52]||(t[52]=s("td",{class:"label"},"Дюрация (Modified)",-1)),s("td",HJ,v(S(n.value.duration,4))+" лет",1)])])])])])):l("",!0),d.value.includeCashFlows&&n.value.cashFlows?(w(),i("div",GJ,[t[56]||(t[56]=s("h2",{class:"report-title"},"Денежные потоки",-1)),t[57]||(t[57]=s("p",{class:"report-desc"},"Таблица дисконтированных денежных потоков",-1)),s("div",WJ,[s("table",qJ,[t[55]||(t[55]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Дата"),s("th",{class:"text-right"},"T (лет)"),s("th",{class:"text-right"},"CF (₽)"),s("th",{class:"text-right"},"DF"),s("th",{class:"text-right"},"PV (₽)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(n.value.cashFlows,(e,t)=>(w(),i("tr",{key:t},[s("td",null,v(t+1),1),s("td",null,v(C(e.date)),1),s("td",YJ,v(S(e.t,4)),1),s("td",jJ,v(S(e.cf,2)),1),s("td",XJ,v(S(e.df,6)),1),s("td",$J,v(S(e.pv,4)),1)]))),128))]),s("tfoot",null,[s("tr",null,[t[54]||(t[54]=s("td",{colspan:"5",class:"text-right"},[s("strong",null,"Итого")],-1)),s("td",KJ,[s("strong",null,v(S(n.value.dirtyPrice,4)),1)])])])])])])):l("",!0),d.value.includeCoupons&&n.value.allCoupons?(w(),i("div",ZJ,[t[59]||(t[59]=s("h2",{class:"report-title"},"График купонных выплат",-1)),t[60]||(t[60]=s("p",{class:"report-desc"},"Полное расписание выплат купонов и номинала",-1)),s("div",JJ,[s("table",QJ,[t[58]||(t[58]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Дата купона"),s("th",{class:"text-right"},"Сумма (₽)"),s("th",null,"Статус")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(n.value.allCoupons,(e,t)=>(w(),i("tr",{key:t},[s("td",null,v(t+1),1),s("td",null,v(C(e.date)),1),s("td",eQ,v(S(e.value,2)),1),s("td",null,[s("span",{class:c(["status-badge",e.isPaid?"paid":"future"])},v(e.isPaid?"✓ Выплачен":"◯ Будущий"),3)])]))),128))])])])])):l("",!0),d.value.includeMetadata?(w(),i("div",tQ,[t[66]||(t[66]=s("h2",{class:"report-title"},"Метаданные модели",-1)),s("div",aQ,[s("table",nQ,[s("tbody",null,[s("tr",null,[t[61]||(t[61]=s("td",{class:"label"},"Дата оценки",-1)),s("td",rQ,v(C(a.value.valuationDate)),1)]),s("tr",null,[t[62]||(t[62]=s("td",{class:"label"},"Дисконтная ставка (YTM)",-1)),s("td",iQ,v(S(a.value.discountYield,3))+"%",1)]),s("tr",null,[t[63]||(t[63]=s("td",{class:"label"},"База расчета дней",-1)),s("td",oQ,v(a.value.dayCount)+" дней",1)]),s("tr",null,[t[64]||(t[64]=s("td",{class:"label"},"Кол-во денежных потоков",-1)),s("td",sQ,v(n.value.cashFlows.length),1)]),d.value.notes?(w(),i("tr",lQ,[t[65]||(t[65]=s("td",{class:"label"},"Примечания",-1)),s("td",cQ,v(d.value.notes),1)])):l("",!0)])])])])):l("",!0),s("div",uQ,[d.value.author?(w(),i("div",dQ,[t[67]||(t[67]=s("strong",null,"Автор:",-1)),m(" "+v(d.value.author),1)])):l("",!0),d.value.company?(w(),i("div",hQ,[t[68]||(t[68]=s("strong",null,"Компания:",-1)),m(" "+v(d.value.company),1)])):l("",!0),s("div",pQ,[s("small",null,"Отчет сформирован: "+v((new Date).toLocaleString("ru-RU")),1)])])])])):l("",!0)]),_:1}),u(M,{name:"fade"},{default:h(()=>[n.value?(w(),i("div",fQ,[s("button",{class:"btn-glass primary",onClick:b,disabled:r.value}," Скачать PDF ",8,mQ),s("button",{class:"btn-glass secondary",onClick:x}," Печать "),s("button",{class:"btn-glass secondary",onClick:_}," Копировать ")])):l("",!0)]),_:1})]))}}),gQ=xe(vQ,[["__scopeId","data-v-ec257f2e"]]),yQ="   https://stochastic-dashbord-v1-production.up.railway.app";async function bQ(e,t={}){const a=new URL(`https://iss.moex.com/iss${e}.json`);a.searchParams.set("iss.json","extended"),a.searchParams.set("iss.meta","off"),a.searchParams.set("lang","ru");for(const[r,i]of Object.entries(t))a.searchParams.set(r,i);const n=await fetch(a.toString());if(!n.ok)throw new Error(`MOEX ISS ${n.status}: ${e}`);return n.json()}function xQ(e,t){if(!e||!e[1]||!e[1][t])return[];const a=e[1][t];return Array.isArray(a)?a:a.data&&a.columns?a.data.map(e=>{const t={};return a.columns.forEach((a,n)=>{t[a]=e[n]}),t}):[]}async function wQ(e){const t=await bQ(`/securities/${e}`),a=xQ(t,"description"),n={};a.forEach(e=>{const t=(e.name||e.NAME||"").toLowerCase();n[t]=e.value||e.VALUE||""});const r=xQ(t,"boards"),i=r.find(e=>"TQCB"===e.boardid||"TQCB"===e.BOARDID),o=r[0]||{},s=(i||o)?.secid||(i||o)?.SECID||e;return{isin:n.isin||e,secid:s,shortname:n.shortname||n.name||"",name:n.name||n.shortname||"",issuer:n.emitter_id||n.issuername||n.name||"",facevalue:parseFloat(n.facevalue)||1e3,faceunit:n.faceunit||"RUB",issuedate:n.issuedate||"",matdate:n.matdate||"",couponpercent:parseFloat(n.couponpercent)||0,couponfrequency:parseInt(n.couponfrequency)||0,couponvalue:parseFloat(n.couponvalue)||0,type:n.type||"",typename:n.typename||"",group:n.group||"",listlevel:parseInt(n.listlevel)||0,initialfacevalue:parseFloat(n.initialfacevalue)||parseFloat(n.facevalue)||1e3}}async function _Q(e,t,a,n="TQCB"){const r=[];let i=0;for(;;){const o=xQ(await bQ(`/history/engines/stock/markets/bonds/boards/${n}/securities/${e}`,{from:t,till:a,start:i.toString()}),"history");if(!o.length)break;for(const e of o)r.push({date:e.TRADEDATE||e.tradedate||"",close:e.CLOSE||e.close||0,yield_close:e.YIELDCLOSE??e.yieldclose??null,volume:e.VOLUME||e.volume||0,num_trades:e.NUMTRADES||e.numtrades||0,value:e.VALUE||e.value||0,waprice:e.WAPRICE??e.waprice??null,duration:e.DURATION??e.duration??null});if(o.length<100)break;i+=o.length}return r}async function SQ(e){const t=await bQ(`/engines/stock/markets/bonds/securities/${e}`),a=xQ(t,"marketdata"),n=xQ(t,"securities"),r=a.find(t=>(t.SECID||t.secid)===e)||a[0]||{},i=n.find(t=>(t.SECID||t.secid)===e)||n[0]||{};return{last:r.LAST??r.last??null,bid:r.BID??r.bid??null,offer:r.OFFER??r.offer??null,spread:r.SPREAD??r.spread??null,yield:r.YIELD??r.yield??null,duration:r.DURATION??r.duration??null,accruedint:i.ACCRUEDINT??i.accruedint??null,waprice:r.WAPRICE??r.waprice??null,closeprice:r.CLOSEPRICE??r.closeprice??null,marketprice:r.MARKETPRICE2??i.PREVWAPRICE??i.prevwaprice??null}}function MQ(){const e=localStorage.getItem("rudata_credentials");if(!e)return null;try{return JSON.parse(atob(e))}catch{return null}}async function TQ(e,t={},a){const n=a||MQ();if(!n)return null;try{const a=await fetch(`${yQ}/api/rudata/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:n.login,password:n.password,path_method:e,body:t})});if(!a.ok)return null;const r=await a.json();return r.success?r.data:null}catch{return null}}async function kQ(e,t){const a=t||MQ();if(!a)return null;try{const t=await fetch(`${yQ}/api/rudata/fintool/reference?id=${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:a.login,password:a.password})});if(!t.ok)return null;const n=await t.json();return n.success?n.data:null}catch{return null}}async function CQ(e,t,a,n){const r=n||MQ();if(!r)return null;try{const n=await fetch(`${yQ}/api/rudata/bond/calculate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:r.login,password:r.password,isin:e,calc_date:t,price:a})});if(!n.ok)return null;const i=await n.json();if(!i.success||!i.data)return null;const o=Array.isArray(i.data)?i.data[0]:i.data;return o?{ytm:o.ytm??o.YTM??o.yld??o.yield_to_maturity??null,ytp:o.ytp??o.YTP??o.yield_to_put??o.y2o_last??o.Y2O_LAST??null,duration_days:o.duration??o.DURATION??null,duration_years:o.duration?o.duration/365:null,mod_duration:o.duration_n??o.modified_duration??o.mod_duration??null,convexity:o.convexity??o.CONVEXITY??null,offer_date:o.offer_date??o.offerdate??null,coupon_rate:o.cpn_rate??o.coupon_rate??o.couponrate??null,facevalue:o.current_fv??o.facevalue??o.nominal??null,accrued_interest:o.accruedint??o.accrued_interest??null,dm_bps:o.dm??o.discount_margin??null}:null}catch{return null}}async function AQ(e,t,a){const n=a||MQ();if(!n)return{offer_date:null,cpn_rate:null,current_fv:null};try{const a=await TQ("Bond/DateParams",{isin:e,date:t,fields:"offer_date,cpn_rate,current_fv"},n);if(!a)return{offer_date:null,cpn_rate:null,current_fv:null};const r=Array.isArray(a)?a[0]:a;return{offer_date:r?.offer_date??null,cpn_rate:r?.cpn_rate??null,current_fv:r?.current_fv??null}}catch{return{offer_date:null,cpn_rate:null,current_fv:null}}}async function EQ(e,t){const a=t||MQ();if(!a)return[];try{const t=await TQ("Rating/List",{filter:`fintoolid = '${e}' OR isin_code = '${e}'`,count:100},a);return t&&Array.isArray(t)?t.map(e=>({agency:e.ra_name||e.agency||"",rating:e.last_rating||e.rating||"",outlook:e.forecast||e.outlook||null,date:e.last_dt?String(e.last_dt).split("T")[0]:null})):[]}catch{return[]}}async function IQ(e,t){const a=t||MQ();if(!a)return[];try{const t=await TQ("Rating/List",{filter:`org_name LIKE '%${e}%'`,count:100},a);return t&&Array.isArray(t)?t.map(e=>({agency:e.ra_name||e.agency||"",rating:e.last_rating||e.rating||"",outlook:e.forecast||e.outlook||null,date:e.last_dt?String(e.last_dt).split("T")[0]:null})):[]}catch{return[]}}async function RQ(e){try{const t=await bQ(`/cci/rating/securities/${e}`),a=xQ(t,"ratings")||xQ(t,"rating"),n=[],r=[];for(const e of a){const t={agency:e.agency||e.AGENCY||e.ra_name||"",rating:e.rating||e.RATING||e.last_rating||"",outlook:e.outlook||e.OUTLOOK||e.forecast||null,date:e.date||e.DATE||e.last_dt||null},a=(e.type||e.TYPE||"").toLowerCase();a.includes("issuer")||a.includes("эмитент")?r.push(t):n.push(t)}return{issue:n,issuer:r}}catch{return{issue:[],issuer:[]}}}function DQ(e,t){const a=!!e&&""!==e.trim(),n=!!t&&""!==t.trim();return n&&!a?{type:"Call",date:t}:n&&a?{type:"Put",date:e}:{type:"Нет",date:null}}async function PQ(e,t){try{const a={term:e.toString(),method:"nelson_siegel"};t&&(a.date=t);const n=await fetch(`${yQ}/api/zcyc/interpolate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok)return await LQ(e,t);return((await n.json()).value||0)/100}catch{return await LQ(e,t)}}async function LQ(e,t){try{const a={};t&&(a.date=t);const n=await bQ("/statistics/engines/stock/zcyc",a),r=xQ(n,"yearyields")||xQ(n,"params");if(!r.length)return 0;const i=r[0],o=i.b0??i.B0??0,s=i.b1??i.B1??0,l=i.b2??i.B2??0,c=i.g1??i.G1??1,u=(e||1)/c,d=Math.exp(-u);return(o+s*((1-d)/u)+l*((1-d)/u-d))/100}catch{return 0}}async function NQ(e,t,a,n,r){const i=new Date(a),o=new Date(i.getTime()-2592e6),s=o.toISOString().split("T")[0],l=new Date(i.getTime()-864e5).toISOString().split("T")[0],c=await async function(e,t,a,n){const r=MQ();if(!r)return{};try{const i=await TQ("Efir/HistoryAgg",{isin:e,dateFrom:t,dateTo:a,mode:"DO",fields:n.join(",")},r);return i&&(Array.isArray(i)?i[0]:i)||{}}catch{return{}}}(e,s,l,["DEAL_ACC.SUM","DEAL_ACC.CNN","VAL_ACC.SUM"]);let u=0,d=0,h=0;if(!c||void 0===c["DEAL_ACC.SUM"]&&void 0===c["DEAL_ACC.CNN"]){const e=r.filter(e=>{const t=new Date(e.date);return t>=o&&t<=i});d=e.filter(e=>e.num_trades>0).length,u=e.reduce((e,t)=>e+t.num_trades,0),h=e.reduce((e,t)=>e+t.value,0)}else u=Number(c["DEAL_ACC.SUM"])||0,d=Number(c["DEAL_ACC.CNN"])||0,h=Number(c["VAL_ACC.SUM"])||0;const p=n>0?h/n:0;return{trading_days:d,trades:u,turnover_to_outstanding:p,traded_last_30d:d>0,total_volume:h,is_active:u>=10&&d>=5&&p>=.001}}function OQ(e,t,a,n,r){if(r<=0||n<=0)return 0;const i=a*t/n,o=Math.round(n*r),s=e/100*t;let l=a||.1;for(let c=0;c<200;c++){let e=0,a=0;for(let s=1;s<=o;s++){const r=s===o?i+t:i,c=Math.pow(1+l/n,-s);e+=r*c,a-=s/n*r*c/(1+l/n)}const r=e-s;if(Math.abs(r)<1e-4)break;if(Math.abs(a)<1e-12)break;l-=r/a,l<-.5&&(l=.001),l>2&&(l=1.999)}return l}function FQ(e,t,a,n,r){if(r<=0||n<=0)return 0;const i=a*t/n,o=Math.round(n*r);let s=0,l=0;for(let c=1;c<=o;c++){const a=c/n,r=(c===o?i+t:i)*Math.pow(1+e/n,-c);s+=a*r,l+=r}return l>0?s/l:0}const BQ=["TQCB","TQOB","TQIR"];async function UQ(e,t){try{const a={};t&&(a.from=t,a.till=t);const n=await bQ(`/statistics/engines/stock/markets/index/analytics/${e}`,a),r=xQ(n,"analytics")||xQ(n,"indices");if(r.length){const e=r[r.length-1],t=e.close??e.CLOSE??e.currentvalue??e.CURRENTVALUE??null;return null!==t?t/100:null}return await zQ(e,t)}catch{return await zQ(e,t)}}async function zQ(e,t){try{const a=t||(new Date).toISOString().split("T")[0],n=new Date(new Date(a).getTime()-864e6).toISOString().split("T")[0],r=xQ(await bQ(`/history/engines/stock/markets/index/boards/SNDX/securities/${e}`,{from:n,till:a}),"history");if(!r.length)return null;const i=r[r.length-1],o=i.CLOSE??i.close??null;return null!==o?o/100:null}catch{return null}}async function VQ(e,t){const a=MQ(),n=await wQ(e),r=await kQ(e,a??void 0),i=r&&Array.isArray(r)&&r.length>0?r[0]:null,o=i?.sumissueval||i?.issueval||i?.summarketval||1e6*n.facevalue,s=i?.offer_date||i?.offerdate||null,l=await AQ(e,t,a??void 0),c=l.offer_date,u=l.cpn_rate??n.couponpercent/100,d=l.current_fv??n.facevalue,h=DQ(c,s),p="Нет"!==h.type,f=await SQ(n.secid),m=t,v=new Date(new Date(m).getTime()-34128e6).toISOString().split("T")[0],{history:g}=await async function(e,t,a){for(const n of BQ){const r=await _Q(e,t,a,n);if(r.length>0)return{history:r,board:n}}return{history:[],board:"TQCB"}}(n.secid,v,m),y=await async function(e){try{const t=await bQ(`/securities/${e}/bondization`),a=xQ(t,"coupons"),n=xQ(t,"amortizations"),r=xQ(t,"offers"),i=a.map(e=>({date:e.coupondate||e.COUPONDATE||"",value:e.value||e.VALUE||0,valueprc:e.valueprc||e.VALUEPRC||0,value_rub:e.value_rub||e.VALUE_RUB||e.value||e.VALUE||0}));return{coupons:i,amortizations:n.map(e=>({date:e.amortdate||e.AMORTDATE||"",value:e.value||e.VALUE||0,valueprc:e.valueprc||e.VALUEPRC||0})),offers:r.map(e=>({date:e.offerdate||e.OFFERDATE||"",type:e.offertypename||e.OFFERTYPENAME||""}))}}catch{return{coupons:[],amortizations:[],offers:[]}}}(e),b=new Date(t),x=(new Date(n.matdate).getTime()-b.getTime())/31536e6,w=f.last??f.waprice??f.closeprice??f.marketprice??100,_=await CQ(e,t,w,a??void 0),S=await async function(e,t,a){const n=a||MQ();if(!n)return{convexity:null,duration_n:null};try{const a=await TQ("Efir/Yields",{isin:e,date:t,fields:"convexity,duration_n"},n);if(!a)return{convexity:null,duration_n:null};const r=Array.isArray(a)?a[0]:a;return{convexity:r?.convexity??null,duration_n:r?.duration_n??null}}catch{return{convexity:null,duration_n:null}}}(e,t,a??void 0),M=await async function(e,t,a,n){const r=n||MQ();if(!r)return{};try{const n=await TQ("Efir/EndOfDay",{isin:e,date:t,fields:a.join(",")},r);return n&&(Array.isArray(n)?n[0]:n)||{}}catch{return{}}}(e,t,["duration","Y2O_LAST","DURATION_O"],a??void 0);let T,k="YTM";p?(k="YTP",T=null!==(_?.ytp??null)?_.ytp:null!=M.Y2O_LAST?Number(M.Y2O_LAST)/100:f.yield&&f.yield>0?f.yield/100:OQ(w,d,u,n.couponfrequency||2,x)):(k="YTM",T=null!==(_?.ytm??null)?_.ytm:f.yield&&f.yield>0?f.yield/100:OQ(w,d,u,n.couponfrequency||2,x));const C=100*T;let A,E,I;if(p){const e=M.DURATION_O??M.duration_o??null;A=null!=e?Number(e)/365:null!==(_?.duration_years??null)?_.duration_years:f.duration?f.duration/365:FQ(T,d,u,n.couponfrequency||2,x)}else{const e=M.duration??null;A=null!=e?Number(e)/365:null!==(_?.duration_years??null)?_.duration_years:f.duration?f.duration/365:FQ(T,d,u,n.couponfrequency||2,x)}E=S.duration_n??_?.mod_duration??null,null==E&&(E=A/(1+T/(n.couponfrequency||2))),I=S.convexity??_?.convexity??null,null==I&&(I=function(e,t,a,n,r){if(r<=0||n<=0)return 0;const i=a*t/n,o=Math.round(n*r);let s=0,l=0;const c=e/n;for(let u=1;u<=o;u++){const e=u===o?i+t:i;s+=e*u*(u+1)*Math.pow(1+c,-(u+2)),l+=e*Math.pow(1+c,-u)}return l<=0?0:s/(l*n*n)}(T,d,u,n.couponfrequency||2,x));const R=await PQ(A,t),D=100*R,P=100*(C-D),L=Math.round(100*P)/100,N=function(e,t){return Math.abs(1e6*(1e-4*-e+.5*t*1e-4*1e-4))}(E,I),O=w/100*d+(f.accruedint??_?.accrued_interest??0),[F,B,U]=await Promise.all([RQ(e),EQ(e,a??void 0),n.issuer?IQ(n.issuer,a??void 0):Promise.resolve([])]),z=B.length>0?B:F.issue,V=U.length>0?U:F.issuer,H=await NQ(e,n.secid,t,o,g),G=await async function(e,t){const a=function(e){return e<1?{gov:{ticker:"RUGBITR1Y",name:"Доходность индекса государственных облигаций (менее года)"},aaa:{ticker:"RUCBTRAAANS",name:"Доходность индекса корпоративных облигаций с рейтингом AAA"},aa:{ticker:"RUCBTRAANS",name:"Доходность индекса корпоративных облигаций с рейтингом AA"},a:{ticker:"RUCBTRANS",name:"Доходность индекса корпоративных облигаций с рейтингом A"},bbb:{ticker:"RUCBTRBBBNS",name:"Доходность индекса корпоративных облигаций с рейтингом BBB"}}:e<3?{gov:{ticker:"RUGBITR3Y",name:"Доходность индекса государственных облигаций (1-3 года)"},aaa:{ticker:"RUCBTR3A3YNS",name:"Доходность индекса корпоративных облигаций с рейтингом AAA (1-3 года)"},aa:{ticker:"RUCBTRAA3YNS",name:"Доходность индекса корпоративных облигаций с рейтингом AA (1-3 года)"},a:{ticker:"RUCBTRA3YNS",name:"Доходность индекса корпоративных облигаций с рейтингом A (1-3 года)"},bbb:{ticker:"RUCBTRBBBNS",name:"Доходность индекса корпоративных облигаций с рейтингом BBB"}}:e<5?{gov:{ticker:"RUGBITR5Y",name:"Доходность индекса государственных облигаций (3-5 лет)"},aaa:{ticker:"RUCBTR3A5YNS",name:"Доходность индекса корпоративных облигаций с рейтингом AAA (3-5 лет)"},aa:{ticker:"RUCBTRAA5YNS",name:"Доходность индекса корпоративных облигаций с рейтингом AA (3-5 лет)"},a:{ticker:"RUCBTRA5YNS",name:"Доходность индекса корпоративных облигаций с рейтингом A (3-5 лет)"},bbb:{ticker:"RUCBTRBBBNS",name:"Доходность индекса корпоративных облигаций с рейтингом BBB"}}:{gov:{ticker:"RUGBITR5+",name:"Доходность индекса государственных облигаций (более 5 лет)"},aaa:{ticker:"RUCBTR3A5YNS",name:"Доходность индекса корпоративных облигаций с рейтингом AAA (3-5 лет)"},aa:{ticker:"RUCBTRAA5YNS",name:"Доходность индекса корпоративных облигаций с рейтингом AA (3-5 лет)"},a:{ticker:"RUCBTRA5YNS",name:"Доходность индекса корпоративных облигаций с рейтингом A (3-5 лет)"},bbb:{ticker:"RUCBTRBBBNS",name:"Доходность индекса корпоративных облигаций с рейтингом BBB"}}}(e),n={},[r,i,o,s,l]=await Promise.allSettled([UQ(a.gov.ticker,t),UQ(a.aaa.ticker,t),UQ(a.aa.ticker,t),UQ(a.a.ticker,t),UQ(a.bbb.ticker,t)]);return"fulfilled"===r.status&&null!==r.value&&(e<1?n.gov_less_1y=r.value:e<3?n.gov_1_3y=r.value:e<5?n.gov_3_5y=r.value:n.gov_5plus=r.value),"fulfilled"===i.status&&null!==i.value&&(n.corp_aaa=i.value),"fulfilled"===o.status&&null!==o.value&&(n.corp_aa=o.value),"fulfilled"===s.status&&null!==s.value&&(n.corp_a=s.value),"fulfilled"===l.status&&null!==l.value&&(n.corp_bbb=l.value),n}(A,t),W=await async function(e){const t=MQ();if(t)try{const a=await TQ("News/List",{filter:`isin_code = '${e}'`,count:20},t);if(a&&Array.isArray(a)&&a.length>0)return a.map(e=>({date:e.pub_date?String(e.pub_date).split("T")[0]:null,description:e.title||e.subject||e.text||""}))}catch{}try{const t=xQ(await bQ(`/securities/${e}/bondization`),"offers"),a=[];for(const e of t)a.push({date:e.offerdate||e.OFFERDATE||null,description:`Оферта: ${e.offertypename||e.OFFERTYPENAME||"Без типа"}`});return a}catch{return[]}}(e),q=function(e){return e.filter(e=>e.close>0||e.waprice&&e.waprice>0).map(e=>({date:e.date,price:e.waprice||e.close}))}(g),Y=await async function(e,t,a,n,r){const i=[],o=new Date(t),s=new Date(r.matdate),l=[];for(let c=0;c<13;c++){const e=new Date(o);e.setMonth(e.getMonth()-c),l.push(e.toISOString().split("T")[0])}for(const c of l){const e=new Date(c);let t=null,n=1/0;for(const r of a){if(!r.close&&!r.waprice)continue;const a=new Date(r.date),i=Math.abs(a.getTime()-e.getTime());i<n&&(n=i,t=r)}if(!t||n>864e6)continue;const o=new Date(t.date),l=(s.getTime()-o.getTime())/31536e6;let u=0;if(t.yield_close&&t.yield_close>0?u=t.yield_close/100:t.close>0&&(u=OQ(t.close,r.facevalue,r.couponpercent/100,r.couponfrequency||2,l)),u<=0)continue;let d=t.duration||0;!d&&l>0&&(d=365*l);const h=d/365,p=await PQ(h,t.date),f=100*u,m=100*p,v=1e4*(u-p);i.push({date:t.date,ytm:f,gcurve:m,gspread:Math.round(100*v)/100})}return i.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),i}(n.secid,t,g,0,n);let j="Россия",X="",$="";i&&(j=i.country||i.issuercountry||"Россия",X=i.sectorbond||i.sector||"",$=i.branch||i.industry||"");const K=f.accruedint??_?.accrued_interest??null,Z=function(e,t,a){return a<=0?0:e*t/(a/100*t)*100}(u,d,w),J=y.coupons.filter(e=>new Date(e.date)>b);return y.coupons.filter(e=>new Date(e.date)<=b),{isin:n.isin||e,issuer:n.name||n.shortname||n.issuer||e,risk_country:j,sector:X||"Корпоративный",industry:$,outstanding_amount:o,listing_level:n.listlevel||null,currency:n.faceunit||"RUB",nkd:K,current_yield:Z>0?Math.round(100*Z)/100:null,issue_info:{issue_date:i?.begdistdate||n.issuedate||null,maturity_date:i?.endmtydate||n.matdate||null,coupon_rate:u,coupon_per_year:i?.couponperyear||n.couponfrequency||null,nominal:d,offer:h},ratings:{issue:z,issuer:V,guarantor:[]},market_activity:H,pricing:{clean_price_pct:w,dirty_price:O,ytm:T,ytm_pct:C,g_spread_bps:L,g_curve_yield:R,g_curve_pct:D,yield_type:k},risk_indicators:{duration:Math.round(1e4*A)/1e4,mod_duration:Math.round(1e4*E)/1e4,convexity:Math.round(100*I)/100,dv01:Math.round(100*N)/100},indices:G,corporate_events:W,price_history:q,yield_history:Y,analogous_bonds:[],coupon_schedule:J,amortization_schedule:y.amortizations.filter(e=>new Date(e.date)>b)}}async function HQ(e,t){const a=MQ(),n=await VQ(e,t),r=await wQ(e);let i="",o=0,s=null,l=null;const c=await kQ(e,a??void 0);if(c&&Array.isArray(c)&&c.length>0){const e=c[0];i=e.coupon_type_desc||e.floatratename||e.coupondesc||"",e.floatratemargin&&(o=100*e.floatratemargin),s=e.floatratename||e.base_rate_name||null,null!=e.floatratevalue&&(l=e.floatratevalue)}if(!s&&i&&(/КС|ключев/i.test(i)?s="Ключевая ставка ЦБ РФ":/RUONIA/i.test(i)?s="RUONIA":/MosPrime/i.test(i)?s="MosPrime Rate":/ИПЦ|CPI/i.test(i)&&(s="ИПЦ")),i&&0===o){const e=i.match(/([+-])\s*([\d,.]+)\s*%?\s*$/);e&&(o=parseFloat(e[2].replace(",","."))*("-"===e[1]?-100:100))}!i&&r.couponpercent>0&&(i=`Переменная ставка (${r.couponpercent}%)`);let u=null;const d=await CQ(e,t,n.pricing.clean_price_pct,a??void 0);if(null!=d?.dm_bps&&(u=d.dm_bps),null==u&&n.pricing.dirty_price&&n.coupon_schedule.length>0){const e=new Date(t),a=l??n.pricing.ytm_pct-o/100,i=n.coupon_schedule.map(t=>({yearFraction:(new Date(t.date).getTime()-e.getTime())/31536e6,amount:t.value||t.valueprc/100*(r.facevalue||1e3),refRate:a>0?a:15}));i.length>0&&(i[i.length-1].amount+=r.facevalue||1e3);const s=n.issue_info.coupon_per_year||r.couponfrequency||4;u=function(e,t,a,n,r=100,i=1e-8){if(!a.length||e<=0||n<=0)return 0;const o=n;let s=0;for(let l=0;l<r;l++){let t=0,n=0;const r=s/1e4;for(const e of a){const a=e.refRate/100/o+r/o,i=e.yearFraction*o,s=Math.pow(1+a,i);s<=0||(t+=e.amount/s,n+=-e.amount*i*(1/o)/Math.pow(1+a,i+1))}const l=t-e;if(Math.abs(l)<i)break;if(Math.abs(n)<1e-12)break;s-=l/n,s<-5e3&&(s=-4999),s>5e4&&(s=49999)}return s}(n.pricing.dirty_price,r.facevalue,i,s),u=Math.round(100*u)/100}const h=xQ(await bQ(`/securities/${e}/bondization`),"coupons"),p=new Date(t),f=h.filter(e=>new Date(e.coupondate||e.COUPONDATE||"")>p).sort((e,t)=>new Date(e.coupondate||e.COUPONDATE||"").getTime()-new Date(t.coupondate||t.COUPONDATE||"").getTime()),m=f.length>0?(f[0].valueprc??f[0].VALUEPRC??f[0].value??f[0].VALUE??0)/100:null;let v=null;if(a&&n.issuer)try{const e=await TQ("Bond/List",{filter:`issuername LIKE '%${n.issuer.substring(0,20)}%' AND status = 'В обращении'`,count:200},a);e&&Array.isArray(e)&&(v=e.length)}catch{}const g=`с ${WQ(new Date(new Date(t).getTime()-2592e6))} по ${WQ(new Date(t))}`,y=await async function(e,t,a,n){const r=MQ(),i=[],o=new Date(a);for(let s=0;s<13;s++){const t=new Date(o);t.setMonth(t.getMonth()-s);const a=t.toISOString().split("T")[0],l=await CQ(e,a,void 0,r??void 0);null!=l?.dm_bps&&i.push({date:a,dm:l.dm_bps,qm:n,price:void 0})}if(0===i.length){const e=new Date(o.getTime()-34128e6).toISOString().split("T")[0],r=await _Q(t,e,a);for(let t=0;t<13;t++){const e=new Date(o);e.setMonth(e.getMonth()-t);const a=e.getTime();let s=null,l=1/0;for(const t of r){const e=Math.abs(new Date(t.date).getTime()-a);e<l&&null!=t.yield_close&&(l=e,s=t)}if(s&&l<864e6){const e=100*(s.yield_close||0)-n;i.push({date:s.date,dm:e,qm:n,price:s.close||void 0})}}}return i.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),i}(e,r.secid,t,o);return{...n,issues_count:v,analysis_period:g,coupon_formula:i||null,base_rate_name:s,base_rate_value:l,dm_bps:u,qm_bps:o||null,issue_info:{...n.issue_info,coupon_formula:i||null,next_coupon:m,nominal:r.facevalue},margin_history:y,analogous_bonds_note:void 0}}async function GQ(e,t){try{const a=MQ(),n=await wQ(e),r=await SQ(n.secid),i=new Date(n.matdate),o=new Date(t),s=(i.getTime()-o.getTime())/31536e6,l=r.last??r.waprice??r.closeprice??r.marketprice??100,c=await AQ(e,t,a??void 0),u=await kQ(e,a??void 0),d=u&&Array.isArray(u)&&u.length>0&&(u[0].offer_date||u[0].offerdate)||null,h="Нет"!==DQ(c.offer_date,d).type,p=await CQ(e,t,l,a??void 0);let f,m;return f=h&&null!=p?.ytp?100*p.ytp:null!=p?.ytm?100*p.ytm:r.yield&&r.yield>0?r.yield:100*OQ(l,n.facevalue,n.couponpercent/100,n.couponfrequency||2,s),m=null!=p?.duration_years?p.duration_years:r.duration&&r.duration>0?r.duration/365:FQ(f/100,n.facevalue,n.couponpercent/100,n.couponfrequency||2,s),{isin:n.isin||e,name:n.shortname||n.name||e,duration:m,yield:f,has_offer:h}}catch{return null}}function WQ(e){return`${String(e.getDate()).padStart(2,"0")}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`}const qQ={class:"page-container"},YQ={class:"section-header"},jQ={class:"header-left"},XQ={key:0,class:"section-title"},$Q={key:1,class:"section-title"},KQ={key:2,class:"section-subtitle"},ZQ={class:"text-accent"},JQ={key:3,class:"section-subtitle"},QQ={class:"text-accent"},e0={class:"header-actions"},t0={class:"glass-pill"},a0=["disabled"],n0={class:"glass-pill"},r0=["disabled"],i0={key:0,class:"state-section"},o0={class:"glass-card"},s0={key:1,class:"state-section"},l0={class:"glass-card error"},c0={key:2,class:"state-section"},u0={key:3,class:"report-content"},d0={class:"grid-2"},h0={class:"glass-card"},p0={class:"info-table"},f0={class:"value"},m0={key:1},v0={class:"value mono"},g0={class:"value"},y0={key:1},b0={class:"value"},x0={key:1},w0={class:"value"},_0={key:1},S0={class:"value mono"},M0={key:1},T0={class:"glass-card"},k0={class:"info-table"},C0={class:"value mono"},A0={key:1},E0={class:"value mono"},I0={key:1},R0={class:"value"},D0={key:1},P0={key:0,class:"accent"},L0={key:1},N0={class:"value mono"},O0={key:1},F0={class:"value mono"},B0={class:"value"},U0={key:0,class:"accent"},z0={key:1},V0={class:"value"},H0={class:"value"},G0={class:"grid-3"},W0={class:"glass-card"},q0={key:0,class:"ratings-list"},Y0={class:"agency"},j0={class:"grade"},X0={class:"date mono"},$0={key:1,class:"muted"},K0={class:"glass-card"},Z0={key:0,class:"ratings-list"},J0={class:"agency"},Q0={class:"rating-info"},e1={class:"grade"},t1={key:0,class:"outlook"},a1={class:"date mono"},n1={key:1,class:"muted"},r1={class:"glass-card"},i1={key:0,class:"ratings-list"},o1={class:"agency"},s1={class:"grade"},l1={class:"date mono"},c1={key:1,class:"muted"},u1={class:"grid-3"},d1={class:"glass-card"},h1={class:"card-header"},p1={key:0,class:"status-badge fulfilled"},f1={key:1,class:"status-badge inactive"},m1={class:"metric-list"},v1={class:"metric"},g1={class:"val"},y1={class:"metric"},b1={class:"val"},x1={class:"metric"},w1={class:"val"},_1={class:"metric"},S1={class:"val"},M1={key:0,class:"status-badge fulfilled"},T1={key:1},k1={class:"glass-card"},C1={class:"metric-list"},A1={class:"metric"},E1={class:"val accent"},I1={key:1},R1={class:"metric"},D1={class:"val accent"},P1={key:1},L1={class:"metric"},N1={class:"val mono"},O1={key:1},F1={key:0},B1={class:"metric"},U1={class:"val mono"},z1={key:1},V1={class:"metric"},H1={class:"val mono"},G1={class:"metric"},W1={class:"val mono"},q1={class:"glass-card"},Y1={class:"metric-list"},j1={class:"metric"},X1={class:"val"},$1={key:1},K1={class:"metric"},Z1={class:"val"},J1={key:1},Q1={class:"metric"},e2={class:"val"},t2={key:1},a2={class:"metric"},n2={class:"val"},r2={key:1},i2={class:"glass-card full-width"},o2={class:"chart-header"},s2={class:"chart-container tall"},l2={class:"glass-card full-width"},c2={class:"chart-header"},u2={class:"chart-container tall"},d2={class:"glass-card full-width"},h2={class:"comparison-section"},p2={class:"comparison-table"},f2={class:"mono"},m2={class:"mono"},v2={class:"mono"},g2={class:"highlight-row"},y2={class:"mono accent"},b2={class:"mono"},x2={class:"mono"},w2={class:"chart-container indices-chart"},_2={class:"glass-card full-width"},S2={class:"analogous-input-section"},M2={class:"glass-pill"},T2=["disabled"],k2={key:0,class:"analogs-list"},C2={class:"analog-isin mono"},A2={class:"analog-name"},E2=["onClick"],I2={class:"chart-container tall"},R2={key:0,class:"glass-card full-width"},D2={class:"card-header"},P2={class:"muted"},L2={class:"schedule-table-wrap"},N2={class:"schedule-table"},O2={class:"mono"},F2={class:"mono"},B2={class:"mono"},U2={key:1,class:"glass-card full-width"},z2={class:"card-header"},V2={class:"muted"},H2={class:"schedule-table-wrap"},G2={class:"schedule-table"},W2={class:"mono"},q2={class:"mono"},Y2={class:"mono"},j2={class:"glass-card full-width"},X2={key:0,class:"events-list"},$2={class:"event-date mono"},K2={class:"event-description"},Z2={key:1,class:"muted"},J2=e({__name:"VanilaBondReport",setup(e){const a=g(),r=x(),o=S(()=>a.params.isin||""),u=t(o.value),d=S(()=>{if(!_.value?.indices)return null;const e=_.value.indices;return e.gov_less_1y??e.gov_1_3y??e.gov_3_5y??e.gov_5plus??null}),h=t(!1),y=t("Загрузка данных..."),b=t(null),_=t(null),M=t((new Date).toISOString().split("T")[0]),C=t(!1),A=t(null),E=t(""),I=t(!1),R=t([]),D=t(!1),P=t(null),L=t(null),N=t(null),O=t(null);let F=null,B=null,V=null,H=null;const G=async e=>{if(e){h.value=!0,y.value="Загрузка спецификации с MOEX ISS...",b.value=null,_.value=null;try{y.value="Загрузка данных с MOEX ISS, ZCYC и RuData...";const t=await VQ(e,M.value);_.value=t,setTimeout(()=>W(),100)}catch(TQe){b.value=TQe.message||"Ошибка загрузки данных",console.error("Bond report error:",TQe)}finally{h.value=!1}}},W=()=>{if(F&&F.destroy(),B&&B.destroy(),V&&V.destroy(),H&&H.destroy(),P.value?.getContext("2d")&&_.value?.price_history?.length){const e=_.value.price_history,t=e.map(e=>{const t=new Date(e.date);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`}),a=e.map(e=>e.price);F=new re(P.value.getContext("2d"),{type:"line",data:{labels:t,datasets:[{label:"Цена, %",data:a,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:0,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},filler:{propagate:!0}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11},maxTicksLimit:12}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Цена, %",color:"rgba(255,255,255,0.5)",font:{size:11}}}}}})}if(L.value?.getContext("2d")&&_.value?.yield_history?.length){const e=_.value.yield_history,t=e.map(e=>{const t=new Date(e.date);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`});B=new re(L.value.getContext("2d"),{type:"line",data:{labels:t,datasets:[{label:`${_.value?.pricing?.yield_type||"YTM"}, %`,data:e.map(e=>e.ytm),borderColor:"#38bdf8",backgroundColor:"rgba(56, 189, 248, 0.08)",fill:!0,tension:.4,pointRadius:0,borderWidth:2,yAxisID:"y"},{label:"G-curve, %",data:e.map(e=>e.gcurve),borderColor:"#f59e0b",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:0,borderWidth:2,borderDash:[5,5],yAxisID:"y"},{label:"G-spread, bps",data:e.map(e=>e.gspread),borderColor:"#9ca3af",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:0,borderWidth:2,yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,labels:{color:"rgba(255,255,255,0.6)",font:{size:11},usePointStyle:!0},position:"top"}},scales:{y:{type:"linear",position:"left",grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Доходность, %",color:"rgba(255,255,255,0.5)",font:{size:11}}},y1:{type:"linear",position:"right",grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"G-spread, bps",color:"rgba(255,255,255,0.5)",font:{size:11}}},x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11},maxTicksLimit:12}}}}})}if(N.value?.getContext("2d")&&_.value?.indices&&_.value?.pricing){const e=_.value.indices,t=_.value.pricing.ytm_pct??100*(_.value.pricing.ytm||0),a=[{label:"Индекс гос. облигаций",value:100*(e.gov_less_1y??e.gov_1_3y??e.gov_3_5y??e.gov_5plus??0),color:"#9ca3af"},{label:"Индекс корп. облигаций (ААА)",value:100*(e.corp_aaa||0),color:"#9ca3af"},{label:"Индекс корп. облигаций (АА)",value:100*(e.corp_aa||0),color:"#9ca3af"},{label:`Оцениваемая облигация (${_.value.pricing.yield_type||"YTM"})`,value:t,color:"#ef4444"},{label:"Индекс корп. облигаций (А)",value:100*(e.corp_a||0),color:"#9ca3af"},{label:"Индекс корп. облигаций (ВВВ)",value:100*(e.corp_bbb||0),color:"#9ca3af"}].filter(e=>e.value>0);V=new re(N.value.getContext("2d"),{type:"scatter",data:{datasets:a.map((e,t)=>({label:e.label,data:[{x:e.value,y:0}],backgroundColor:e.label.startsWith("Оцениваемая облигация")?"rgba(239, 68, 68, 0)":e.color,borderColor:e.label.startsWith("Оцениваемая облигация")?"rgba(239, 68, 68, 0)":e.color,pointRadius:e.label.startsWith("Оцениваемая облигация")?1:10,pointHoverRadius:e.label.startsWith("Оцениваемая облигация")?14:12,showLine:!1}))},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},plugins:{legend:{display:!1},tooltip:{enabled:!0,displayColors:!1,backgroundColor:"rgba(0, 0, 0, 0.9)",titleColor:"rgba(255, 255, 255, 1)",bodyColor:"rgba(255, 255, 255, 0.9)",borderColor:"rgba(255, 255, 255, 0.3)",borderWidth:1,padding:14,titleFont:{size:13,weight:"bold"},bodyFont:{size:12},cornerRadius:8,callbacks:{title:e=>a[e[0].datasetIndex]?.label||"",label:e=>`Доходность: ${a[e.datasetIndex]?.value.toFixed(2)}%`}}},scales:{x:{type:"linear",position:"bottom",grid:{color:"rgba(255,255,255,0.05)",display:!0},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11},stepSize:1},title:{display:!0,text:"Доходность, %",color:"rgba(255,255,255,0.5)",font:{size:11}}},y:{type:"linear",min:-.5,max:.5,display:!1,grid:{display:!1},ticks:{display:!1}}}},plugins:[{id:"indicesTimeline",afterDraw:e=>{const t=e.ctx,a=e.chartArea,n=(a.top+a.bottom)/2;t.save(),t.fillStyle="rgba(245, 245, 220, 0.3)",t.fillRect(a.left,n-20,a.right-a.left,40),t.restore()}},{id:"blinkingRedPoint",afterDraw:e=>{const t=e.ctx,n=a.findIndex(e=>e.label.startsWith("Оцениваемая облигация"));if(n<0)return;const r=e.getDatasetMeta(n);if(!r?.data?.length)return;const i=r.data[0].getProps(["x","y"],!0),o=Date.now()/1e3,s=.5*Math.sin(3*o)+.5,l=.5+.5*s,c=10+4*s,u=t.createRadialGradient(i.x,i.y,0,i.x,i.y,2*c);u.addColorStop(0,`rgba(239, 68, 68, ${.4*l})`),u.addColorStop(.5,`rgba(239, 68, 68, ${.2*l})`),u.addColorStop(1,"rgba(239, 68, 68, 0)"),t.save(),t.fillStyle=u,t.beginPath(),t.arc(i.x,i.y,2*c,0,2*Math.PI),t.fill(),t.fillStyle=`rgba(239, 68, 68, ${l})`,t.strokeStyle=`rgba(255, 255, 255, ${.9*l})`,t.lineWidth=2,t.beginPath(),t.arc(i.x,i.y,c,0,2*Math.PI),t.fill(),t.stroke(),t.restore()}}]});let n=null,r=!0;const i=()=>{if(V&&r)try{V.draw(),r&&(n=requestAnimationFrame(i))}catch(TQe){r=!1}};if(i(),V){const e=V;e.__animationFrameId=n,e.__stopAnimation=()=>{r=!1,"number"==typeof e.__animationFrameId&&cancelAnimationFrame(e.__animationFrameId)}}}if(O.value?.getContext("2d")&&_.value?.risk_indicators&&_.value?.pricing){const e=R.value.filter(e=>void 0!==e.duration&&void 0!==e.yield),t=_.value.risk_indicators.duration||0,a=100*(_.value.pricing.ytm||0),n=_.value.issuer||"Оцениваемая облигация",r=[];e.length>0&&r.push({label:"Облигации-аналоги",data:e.map(e=>({x:e.duration,y:e.yield})),backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa",pointRadius:8,pointStyle:"diamond",borderWidth:2}),r.push({label:n,data:[{x:t,y:a}],backgroundColor:"#ef4444",borderColor:"#ef4444",pointRadius:10,pointStyle:"diamond",borderWidth:2,pointHoverRadius:12}),H=new re(O.value.getContext("2d"),{type:"scatter",data:{datasets:r},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},plugins:{legend:{display:!0,labels:{color:"rgba(255,255,255,0.6)",font:{size:11},usePointStyle:!0},position:"top"}},scales:{x:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Дюрация, лет",color:"rgba(255,255,255,0.5)",font:{size:11}}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Доходность к оферте/погашению, %",color:"rgba(255,255,255,0.5)",font:{size:11}}}}},plugins:[{id:"blinkingPoint",afterDraw:e=>{const t=e.ctx,a=e.data.datasets.length-1,n=e.getDatasetMeta(a);if(!n?.data?.length)return;const r=n.data[0].getProps(["x","y"],!0),i=Date.now()/1e3,o=.5*Math.sin(3*i)+.5,s=.4+.6*o,l=10+5*o,c=t.createRadialGradient(r.x,r.y,0,r.x,r.y,2.5*l);c.addColorStop(0,`rgba(239, 68, 68, ${.5*s})`),c.addColorStop(.4,`rgba(239, 68, 68, ${.2*s})`),c.addColorStop(1,"rgba(239, 68, 68, 0)"),t.save(),t.fillStyle=c,t.beginPath(),t.arc(r.x,r.y,2.5*l,0,2*Math.PI),t.fill(),t.fillStyle=`rgba(239, 68, 68, ${s})`,t.strokeStyle=`rgba(255, 255, 255, ${.8*s})`,t.lineWidth=2,t.beginPath(),t.arc(r.x,r.y,l,0,2*Math.PI),t.fill(),t.stroke(),t.restore()}}]});let i=null,o=!0;const s=()=>{if(H&&o)try{H.draw(),o&&(i=requestAnimationFrame(s))}catch(TQe){o=!1}};if(s(),H){const e=H;e.__animationFrameId=i,e.__stopAnimation=()=>{o=!1,"number"==typeof e.__animationFrameId&&cancelAnimationFrame(e.__animationFrameId)}}}},q=()=>{C.value=!C.value,C.value&&_.value?(A.value=JSON.parse(JSON.stringify(_.value)),A.value&&!A.value.issue_info&&(A.value.issue_info={issue_date:null,maturity_date:null,coupon_rate:null,coupon_per_year:null}),A.value&&!A.value.pricing&&(A.value.pricing={clean_price_pct:0,ytm:0,g_spread_bps:0,g_curve_yield:0}),A.value&&!A.value.risk_indicators&&(A.value.risk_indicators={duration:0,mod_duration:0,convexity:0,dv01:0})):!C.value&&A.value&&(_.value=JSON.parse(JSON.stringify(A.value)))},Y=()=>{_.value?.isin&&G(_.value.isin)},j=()=>{const e=C.value&&A.value?A.value:_.value;if(e)try{const t=[];t.push(["Отчет по облигации"]),t.push(["Дата оценки:",M.value]),t.push(["ISIN:",e.isin]),t.push([]),t.push(["ОБЩИЕ СВЕДЕНИЯ"]),t.push(["Эмитент",e.issuer||""]),t.push(["ISIN",e.isin]),t.push(["Страна",e.risk_country||""]),t.push(["Сектор",e.sector||""]),t.push(["Отрасль",e.industry||""]),t.push(["Объём",e.outstanding_amount||""]),t.push([]),t.push(["ПАРАМЕТРЫ ВЫПУСКА"]),t.push(["Дата начала",e.issue_info?.issue_date||""]),t.push(["Дата погашения",e.issue_info?.maturity_date||""]),t.push(["Ставка купона",e.issue_info?.coupon_rate?(100*e.issue_info.coupon_rate).toFixed(2)+"%":""]),t.push(["Купонов в год",e.issue_info?.coupon_per_year||""]),t.push([]),t.push(["КОТИРОВКА И ДОХОДНОСТЬ"]),t.push(["Чистая цена",e.pricing?.clean_price_pct?e.pricing.clean_price_pct.toFixed(2)+"%":""]),t.push(["YTM",e.pricing?.ytm?(100*e.pricing.ytm).toFixed(2)+"%":""]),t.push(["G-spread",e.pricing?.g_spread_bps?e.pricing.g_spread_bps+" bps":""]),t.push(["G-curve",e.pricing?.g_curve_yield?(100*e.pricing.g_curve_yield).toFixed(2)+"%":""]),t.push(["НКД",null!=e.nkd?e.nkd.toFixed(2):""]),t.push(["Текущая доходность (CY)",null!=e.current_yield?e.current_yield.toFixed(2)+"%":""]),t.push([]),t.push(["РИСК-МЕТРИКИ"]),t.push(["Мод. дюрация",e.risk_indicators?.mod_duration?.toFixed(4)||""]),t.push(["Дюрация",e.risk_indicators?.duration?.toFixed(4)||""]),t.push(["Выпуклость",e.risk_indicators?.convexity?.toFixed(2)||""]),t.push(["DV01",e.risk_indicators?.dv01||""]),t.push([]),e.indices&&(t.push(["СРАВНЕНИЕ С ИНДЕКСАМИ"]),e.indices.gov_less_1y&&t.push(["Индекс гос. облигаций (менее года)",(100*e.indices.gov_less_1y).toFixed(2)+"%"]),e.indices.corp_aaa&&t.push(["Индекс корп. облигаций (ААА)",(100*e.indices.corp_aaa).toFixed(2)+"%"]),e.indices.corp_aa&&t.push(["Индекс корп. облигаций (АА)",(100*e.indices.corp_aa).toFixed(2)+"%"]),t.push([`Оцениваемая облигация (${e.pricing?.yield_type||"YTM"})`,e.pricing?.ytm_pct?e.pricing.ytm_pct.toFixed(2)+"%":e.pricing?.ytm?(100*e.pricing.ytm).toFixed(2)+"%":""]),e.indices.corp_a&&t.push(["Индекс корп. облигаций (А)",(100*e.indices.corp_a).toFixed(2)+"%"]),e.indices.corp_bbb&&t.push(["Индекс корп. облигаций (ВВВ)",(100*e.indices.corp_bbb).toFixed(2)+"%"]),t.push([])),e.ratings?.issue?.length&&(t.push(["РЕЙТИНГ ЭМИССИИ"]),t.push(["Агентство","Рейтинг","Дата"]),e.ratings.issue.forEach(e=>t.push([e.agency,e.rating,e.date||""])),t.push([])),e.ratings?.issuer?.length&&(t.push(["РЕЙТИНГ ЭМИТЕНТА"]),t.push(["Агентство","Рейтинг","Прогноз","Дата"]),e.ratings.issuer.forEach(e=>t.push([e.agency,e.rating,e.outlook||"",e.date||""])),t.push([])),e.coupon_schedule?.length&&(t.push(["КУПОННОЕ РАСПИСАНИЕ"]),t.push(["Дата","Ставка, %","Сумма, руб."]),e.coupon_schedule.forEach(e=>t.push([e.date||"",e.valueprc?.toFixed(2)||"",e.value?.toFixed(2)||""])),t.push([])),e.amortization_schedule?.length&&(t.push(["ГРАФИК АМОРТИЗАЦИИ"]),t.push(["Дата","% от номинала","Сумма, руб."]),e.amortization_schedule.forEach(e=>t.push([e.date||"",e.valueprc?.toFixed(2)||"",e.value?.toFixed(2)||""])),t.push([])),e.corporate_events?.length&&(t.push(["КОРПОРАТИВНЫЕ СОБЫТИЯ"]),t.push(["Дата","Описание"]),e.corporate_events.forEach(e=>t.push([e.date||"",e.description])));const a=Rj.aoa_to_sheet(t),n=Rj.book_new();Rj.book_append_sheet(n,a,"Отчет"),a["!cols"]=[{wch:40},{wch:30}];bj(n,`Bond_Report_${e.isin}_${M.value}.xlsx`)}catch(t){console.error("Export error:",t),alert(`Ошибка при экспорте: ${t.message}`)}},X=()=>{u.value?.trim()&&(r.push({params:{isin:u.value}}),G(u.value))},$=e=>e?new Intl.NumberFormat("ru-RU").format(e):"—",K=e=>{if(!e)return"—";try{const t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`}catch{return e}},Z=async()=>{if(!E.value?.trim())return;const e=E.value.trim().toUpperCase();if(R.value.some(t=>t.isin===e))return b.value="Облигация с таким ISIN уже добавлена",void setTimeout(()=>{b.value=null},3e3);I.value=!0,R.value.push({isin:e,name:void 0,duration:void 0,yield:void 0}),E.value="";try{const t=await GQ(e,M.value),a=R.value.findIndex(t=>t.isin===e);-1!==a&&(t?R.value[a]={isin:e,name:t.name,duration:t.duration,yield:t.yield}:R.value[a].name=`${e} (нет данных)`),_.value&&(_.value.analogous_bonds=R.value.filter(e=>void 0!==e.duration&&void 0!==e.yield).map(e=>({name:e.name||e.isin,duration:e.duration,yield:e.yield})),setTimeout(()=>{H&&H.destroy(),W()},100))}catch(TQe){const a=R.value.findIndex(t=>t.isin===e);-1!==a&&R.value.splice(a,1),b.value=`Ошибка загрузки данных по ISIN ${e}`,setTimeout(()=>{b.value=null},3e3)}finally{I.value=!1}},J=e=>{const t="price"===e?P.value:L.value;if(!t)return;const a=document.createElement("a");a.href=t.toDataURL("image/png"),a.download=`bond-${e}-${(new Date).toISOString().split("T")[0]}.png`,a.click()};return n(()=>G(o.value||"RU000A103943")),z(()=>{if(F&&F.destroy(),B&&B.destroy(),V){const e=V.__stopAnimation;"function"==typeof e&&e(),V.destroy()}if(H){const e=H.__stopAnimation;"function"==typeof e&&e(),H.destroy()}}),(e,t)=>(w(),i("div",qQ,[s("div",YQ,[s("div",jQ,[_.value?(w(),i("h1",XQ,v(_.value.issuer)+", "+v(_.value.isin),1)):(w(),i("h1",$Q,"Vanilla Bond Report")),_.value?(w(),i("p",KQ,[t[23]||(t[23]=m(" Паспорт выпуска и аналитика по ISIN: ",-1)),s("span",ZQ,v(_.value.isin),1)])):(w(),i("p",JQ,[t[24]||(t[24]=m(" Паспорт выпуска и аналитика по ISIN: ",-1)),s("span",QQ,v(o.value||"—"),1)]))]),s("div",e0,[s("div",t0,[t[25]||(t[25]=s("label",{class:"lbl-mini"},"Дата оценки:",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>M.value=e),type:"date",class:"date-input-small",onChange:Y},null,544),[[k,M.value]])]),s("button",{onClick:q,class:c(["btn-toggle-edit",{active:C.value}])},v(C.value?"✓ Режим редактирования":"✎ Редактировать"),3),s("button",{onClick:j,class:"btn-export-excel",disabled:!_.value}," 📊 Excel ",8,a0),s("div",n0,[t[26]||(t[26]=s("label",{class:"lbl-mini"},"ISIN:",-1)),T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),type:"text",class:"search-input",placeholder:"RU000A103943",onKeyup:U(X,["enter"])},null,544),[[k,u.value]]),s("button",{class:"btn-search",onClick:X,disabled:!u.value},"🔍",8,r0)])])]),h.value?(w(),i("section",i0,[s("div",o0,[t[27]||(t[27]=s("span",{class:"spinner"},null,-1)),m(" "+v(y.value),1)])])):b.value?(w(),i("section",s0,[s("div",l0,"⚠ "+v(b.value),1)])):_.value?(w(),i("section",u0,[s("div",d0,[s("div",h0,[t[35]||(t[35]=s("div",{class:"card-header"},[s("h3",null,"Общие сведения")],-1)),s("table",p0,[s("tr",null,[t[29]||(t[29]=s("td",{class:"label"},"Эмитент",-1)),s("td",f0,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>A.value.issuer=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.issuer]]):(w(),i("span",m0,v(_.value.issuer),1))])]),s("tr",null,[t[30]||(t[30]=s("td",{class:"label"},"ISIN",-1)),s("td",v0,v(_.value.isin),1)]),s("tr",null,[t[31]||(t[31]=s("td",{class:"label"},"Страна",-1)),s("td",g0,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>A.value.risk_country=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.risk_country]]):(w(),i("span",y0,v(_.value.risk_country||"—"),1))])]),s("tr",null,[t[32]||(t[32]=s("td",{class:"label"},"Сектор",-1)),s("td",b0,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[4]||(t[4]=e=>A.value.sector=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.sector]]):(w(),i("span",x0,v(_.value.sector||"—"),1))])]),s("tr",null,[t[33]||(t[33]=s("td",{class:"label"},"Отрасль",-1)),s("td",w0,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[5]||(t[5]=e=>A.value.industry=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.industry]]):(w(),i("span",_0,v(_.value.industry||"—"),1))])]),s("tr",null,[t[34]||(t[34]=s("td",{class:"label"},"Объём",-1)),s("td",S0,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[6]||(t[6]=e=>A.value.outstanding_amount=e),type:"number",class:"edit-input"},null,512)),[[k,A.value.outstanding_amount,void 0,{number:!0}]]):(w(),i("span",M0,v($(_.value.outstanding_amount)||"—"),1))])])])]),s("div",T0,[t[44]||(t[44]=s("div",{class:"card-header"},[s("h3",null,"Параметры выпуска")],-1)),s("table",k0,[s("tr",null,[t[36]||(t[36]=s("td",{class:"label"},"Дата начала",-1)),s("td",C0,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=e=>A.value.issue_info.issue_date=e),type:"date",class:"edit-input"},null,512)),[[k,A.value.issue_info.issue_date]]):(w(),i("span",A0,v(K(_.value.issue_info?.issue_date)),1))])]),s("tr",null,[t[37]||(t[37]=s("td",{class:"label"},"Дата погашения",-1)),s("td",E0,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[8]||(t[8]=e=>A.value.issue_info.maturity_date=e),type:"date",class:"edit-input"},null,512)),[[k,A.value.issue_info.maturity_date]]):(w(),i("span",I0,v(K(_.value.issue_info?.maturity_date)),1))])]),s("tr",null,[t[38]||(t[38]=s("td",{class:"label"},"Ставка купона",-1)),s("td",R0,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[9]||(t[9]=e=>A.value.issue_info.coupon_rate=e),type:"number",step:"0.01",class:"edit-input",placeholder:"0.00"},null,512)),[[k,A.value.issue_info.coupon_rate,void 0,{number:!0}]]):(w(),i("span",D0,[null!==_.value.issue_info?.coupon_rate&&void 0!==_.value.issue_info?.coupon_rate?(w(),i("span",P0,v((100*(_.value.issue_info?.coupon_rate||0)).toFixed(2))+"%",1)):(w(),i("span",L0,"—"))]))])]),s("tr",null,[t[39]||(t[39]=s("td",{class:"label"},"Купонов в год",-1)),s("td",N0,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[10]||(t[10]=e=>A.value.issue_info.coupon_per_year=e),type:"number",class:"edit-input"},null,512)),[[k,A.value.issue_info.coupon_per_year,void 0,{number:!0}]]):(w(),i("span",O0,v(_.value.issue_info?.coupon_per_year??"—"),1))])]),s("tr",null,[t[40]||(t[40]=s("td",{class:"label"},"Номинал",-1)),s("td",F0,v(_.value.issue_info?.nominal?$(_.value.issue_info.nominal):"—"),1)]),s("tr",null,[t[41]||(t[41]=s("td",{class:"label"},"Оферта",-1)),s("td",B0,[_.value.issue_info?.offer&&"Нет"!==_.value.issue_info.offer.type?(w(),i("span",U0,v(_.value.issue_info.offer.type)+" — "+v(K(_.value.issue_info.offer.date)),1)):(w(),i("span",z0,"Нет"))])]),s("tr",null,[t[42]||(t[42]=s("td",{class:"label"},"Уровень листинга",-1)),s("td",V0,v(_.value.listing_level?_.value.listing_level+" уровень":"—"),1)]),s("tr",null,[t[43]||(t[43]=s("td",{class:"label"},"Валюта",-1)),s("td",H0,v(_.value.currency||"—"),1)])])])]),s("div",G0,[s("div",W0,[t[45]||(t[45]=s("div",{class:"card-header"},[s("h3",null,"Рейтинг эмиссии")],-1)),_.value.ratings?.issue?.length?(w(),i("div",q0,[(w(!0),i(p,null,f(_.value.ratings.issue,(e,t)=>(w(),i("div",{key:t,class:"rating-item"},[s("span",Y0,v(e.agency),1),s("span",j0,v(e.rating),1),s("span",X0,v(K(e.date)),1)]))),128))])):(w(),i("p",$0,"Нет данных"))]),s("div",K0,[t[46]||(t[46]=s("div",{class:"card-header"},[s("h3",null,"Рейтинг эмитента")],-1)),_.value.ratings?.issuer?.length?(w(),i("div",Z0,[(w(!0),i(p,null,f(_.value.ratings.issuer,(e,t)=>(w(),i("div",{key:t,class:"rating-item"},[s("span",J0,v(e.agency),1),s("div",Q0,[s("span",e1,v(e.rating),1),e.outlook?(w(),i("span",t1,v(e.outlook),1)):l("",!0)]),s("span",a1,v(K(e.date)),1)]))),128))])):(w(),i("p",n1,"Нет данных"))]),s("div",r1,[t[47]||(t[47]=s("div",{class:"card-header"},[s("h3",null,"Рейтинг гаранта")],-1)),_.value.ratings?.guarantor?.length?(w(),i("div",i1,[(w(!0),i(p,null,f(_.value.ratings.guarantor,(e,t)=>(w(),i("div",{key:t,class:"rating-item"},[s("span",o1,v(e.agency),1),s("span",s1,v(e.rating),1),s("span",l1,v(K(e.date)),1)]))),128))])):(w(),i("p",c1,"Нет данных"))])]),s("div",u1,[s("div",d1,[s("div",h1,[t[48]||(t[48]=s("h3",null,"Активность рынка",-1)),_.value.market_activity?.is_active?(w(),i("span",p1,"АКТИВНЫЙ")):(w(),i("span",f1,"НЕАКТИВНЫЙ"))]),s("div",m1,[s("div",v1,[t[49]||(t[49]=s("span",null,"Кол-во торговых дней",-1)),s("span",g1,v(_.value.market_activity?.trading_days??"—"),1)]),s("div",y1,[t[50]||(t[50]=s("span",null,"Кол-во сделок",-1)),s("span",b1,v(_.value.market_activity?.trades??"—"),1)]),s("div",x1,[t[51]||(t[51]=s("span",null,"Объем торгов/выпуск",-1)),s("span",w1,v(_.value.market_activity?.turnover_to_outstanding?(100*_.value.market_activity.turnover_to_outstanding).toFixed(2)+"%":"—"),1)]),s("div",_1,[t[52]||(t[52]=s("span",null,"Торги 30 дней",-1)),s("span",S1,[_.value.market_activity?.traded_last_30d?(w(),i("span",M1,"Да")):(w(),i("span",T1,"Нет"))])])])]),s("div",k1,[t[58]||(t[58]=s("div",{class:"card-header"},[s("h3",null,"Котировка и доходность")],-1)),s("div",C1,[s("div",A1,[t[53]||(t[53]=s("span",null,"Чистая цена",-1)),s("span",E1,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[11]||(t[11]=e=>A.value.pricing.clean_price_pct=e),type:"number",step:"0.01",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.clean_price_pct,void 0,{number:!0}]]):(w(),i("span",I1,v(_.value.pricing?.clean_price_pct?.toFixed(2))+"%",1))])]),s("div",R1,[s("span",null,v(_.value.pricing?.yield_type||"YTM"),1),s("span",D1,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[12]||(t[12]=e=>A.value.pricing.ytm=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.ytm,void 0,{number:!0}]]):(w(),i("span",P1,v(null!=_.value.pricing?.ytm_pct?_.value.pricing.ytm_pct.toFixed(2)+"%":_.value.pricing?.ytm?(100*_.value.pricing.ytm).toFixed(2)+"%":"—"),1))])]),s("div",L1,[t[54]||(t[54]=s("span",null,"G-spread",-1)),s("span",N1,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[13]||(t[13]=e=>A.value.pricing.g_spread_bps=e),type:"number",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.g_spread_bps,void 0,{number:!0}]]):(w(),i("span",O1,[m(v(_.value.pricing?.g_spread_bps??"—"),1),_.value.pricing?.g_spread_bps?(w(),i("span",F1," bps")):l("",!0)]))])]),s("div",B1,[t[55]||(t[55]=s("span",null,"G-curve",-1)),s("span",U1,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[14]||(t[14]=e=>A.value.pricing.g_curve_yield=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.g_curve_yield,void 0,{number:!0}]]):(w(),i("span",z1,v(null!=_.value.pricing?.g_curve_pct?_.value.pricing.g_curve_pct.toFixed(2)+"%":_.value.pricing?.g_curve_yield?(100*_.value.pricing.g_curve_yield).toFixed(2)+"%":"—"),1))])]),s("div",V1,[t[56]||(t[56]=s("span",null,"НКД",-1)),s("span",H1,v(null!=_.value.nkd?_.value.nkd.toFixed(2):"—"),1)]),s("div",G1,[t[57]||(t[57]=s("span",null,"Текущая доходность (CY)",-1)),s("span",W1,v(null!=_.value.current_yield?_.value.current_yield.toFixed(2)+"%":"—"),1)])])]),s("div",q1,[t[63]||(t[63]=s("div",{class:"card-header"},[s("h3",null,"Риск-метрики")],-1)),s("div",Y1,[s("div",j1,[t[59]||(t[59]=s("span",null,"Мод. дюрация",-1)),s("span",X1,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[15]||(t[15]=e=>A.value.risk_indicators.mod_duration=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.mod_duration,void 0,{number:!0}]]):(w(),i("span",$1,v(_.value.risk_indicators?.mod_duration?.toFixed(4)||_.value.risk_indicators?.duration?.toFixed(4)||"—"),1))])]),s("div",K1,[t[60]||(t[60]=s("span",null,"Дюрация",-1)),s("span",Z1,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[16]||(t[16]=e=>A.value.risk_indicators.duration=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.duration,void 0,{number:!0}]]):(w(),i("span",J1,v(_.value.risk_indicators?.duration?.toFixed(4)),1))])]),s("div",Q1,[t[61]||(t[61]=s("span",null,"Выпуклость",-1)),s("span",e2,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[17]||(t[17]=e=>A.value.risk_indicators.convexity=e),type:"number",step:"0.01",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.convexity,void 0,{number:!0}]]):(w(),i("span",t2,v(_.value.risk_indicators?.convexity?.toFixed(2)),1))])]),s("div",a2,[t[62]||(t[62]=s("span",null,"DV01",-1)),s("span",n2,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[18]||(t[18]=e=>A.value.risk_indicators.dv01=e),type:"number",step:"0.01",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.dv01,void 0,{number:!0}]]):(w(),i("span",r2,v($(_.value.risk_indicators?.dv01)),1))])])])])]),s("div",i2,[s("div",o2,[t[64]||(t[64]=s("h3",null,"Динамика цены",-1)),s("button",{class:"btn-export",onClick:t[19]||(t[19]=e=>J("price"))},"💾 PNG")]),s("div",s2,[s("canvas",{ref_key:"priceHistoryRef",ref:P},null,512)])]),s("div",l2,[s("div",c2,[t[65]||(t[65]=s("h3",null,"Динамика доходности облигации в RUB, g-curve, g-spread",-1)),s("button",{class:"btn-export",onClick:t[20]||(t[20]=e=>J("yield"))},"💾 PNG")]),s("div",u2,[s("canvas",{ref_key:"yieldDynamicsRef",ref:L},null,512)])]),s("div",d2,[t[72]||(t[72]=s("div",{class:"card-header"},[s("h3",null,"Сравнение с индексами корпоративных облигаций Московской биржи")],-1)),s("div",h2,[s("table",p2,[t[71]||(t[71]=s("thead",null,[s("tr",null,[s("th",null,"Индекс"),s("th",null,"Доходность, %")])],-1)),s("tbody",null,[s("tr",null,[t[66]||(t[66]=s("td",null,"Доходность индекса государственных облигаций",-1)),s("td",f2,v(null!=d.value?(100*d.value).toFixed(2)+"%":"—"),1)]),s("tr",null,[t[67]||(t[67]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом ААА",-1)),s("td",m2,v(null!=_.value.indices?.corp_aaa?(100*_.value.indices.corp_aaa).toFixed(2)+"%":"—"),1)]),s("tr",null,[t[68]||(t[68]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом АА",-1)),s("td",v2,v(null!=_.value.indices?.corp_aa?(100*_.value.indices.corp_aa).toFixed(2)+"%":"—"),1)]),s("tr",g2,[s("td",null,[s("strong",null,"Оцениваемая облигация ("+v(_.value.pricing?.yield_type||"YTM")+")",1)]),s("td",y2,[s("strong",null,v(null!=_.value.pricing?.ytm_pct?_.value.pricing.ytm_pct.toFixed(2)+"%":_.value.pricing?.ytm?(100*_.value.pricing.ytm).toFixed(2)+"%":"—"),1)])]),s("tr",null,[t[69]||(t[69]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом А",-1)),s("td",b2,v(null!=_.value.indices?.corp_a?(100*_.value.indices.corp_a).toFixed(2)+"%":"—"),1)]),s("tr",null,[t[70]||(t[70]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом ВВВ",-1)),s("td",x2,v(null!=_.value.indices?.corp_bbb?(100*_.value.indices.corp_bbb).toFixed(2)+"%":"—"),1)])])]),s("div",w2,[s("canvas",{ref_key:"indicesComparisonRef",ref:N},null,512)])])]),s("div",_2,[t[74]||(t[74]=s("div",{class:"card-header"},[s("h3",null,"Сравнение с облигациями-аналогами")],-1)),s("div",S2,[s("div",M2,[t[73]||(t[73]=s("label",{class:"lbl-mini"},"ISIN аналога:",-1)),T(s("input",{"onUpdate:modelValue":t[21]||(t[21]=e=>E.value=e),type:"text",class:"search-input",placeholder:"RU000A10XXXX",onKeyup:U(Z,["enter"])},null,544),[[k,E.value]]),s("button",{class:"btn-search",onClick:Z,disabled:!E.value||I.value},"➕",8,T2)]),R.value.length>0?(w(),i("div",k2,[(w(!0),i(p,null,f(R.value,(e,t)=>(w(),i("div",{key:t,class:"analog-item"},[s("span",C2,v(e.isin),1),s("span",A2,v(e.name||"Загрузка..."),1),s("button",{class:"btn-remove",onClick:e=>(e=>{R.value.splice(e,1),_.value&&(_.value.analogous_bonds=R.value.filter(e=>void 0!==e.duration&&void 0!==e.yield).map(e=>({name:e.name||e.isin,duration:e.duration,yield:e.yield})),setTimeout(()=>{H&&H.destroy(),W()},100))})(t),title:"Удалить"},"×",8,E2)]))),128))])):l("",!0)]),s("div",I2,[s("canvas",{ref_key:"analogousBondsRef",ref:O},null,512)])]),_.value.coupon_schedule?.length?(w(),i("div",R2,[s("div",D2,[t[75]||(t[75]=s("h3",null,"Купонное расписание (предстоящие)",-1)),s("span",P2,v(_.value.coupon_schedule.length)+" выплат",1)]),s("div",L2,[s("table",N2,[t[76]||(t[76]=s("thead",null,[s("tr",null,[s("th",null,"Дата"),s("th",null,"Ставка, %"),s("th",null,"Сумма, руб.")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(_.value.coupon_schedule.slice(0,D.value?void 0:6),(e,t)=>(w(),i("tr",{key:t},[s("td",O2,v(K(e.date)),1),s("td",F2,v(e.valueprc?e.valueprc.toFixed(2):"—"),1),s("td",B2,v(e.value?e.value.toFixed(2):"—"),1)]))),128))])]),_.value.coupon_schedule.length>6?(w(),i("button",{key:0,class:"btn-show-more",onClick:t[22]||(t[22]=e=>D.value=!D.value)},v(D.value?"Свернуть":`Показать все (${_.value.coupon_schedule.length})`),1)):l("",!0)])])):l("",!0),_.value.amortization_schedule?.length?(w(),i("div",U2,[s("div",z2,[t[77]||(t[77]=s("h3",null,"График амортизации",-1)),s("span",V2,v(_.value.amortization_schedule.length)+" выплат",1)]),s("div",H2,[s("table",G2,[t[78]||(t[78]=s("thead",null,[s("tr",null,[s("th",null,"Дата"),s("th",null,"% от номинала"),s("th",null,"Сумма, руб.")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(_.value.amortization_schedule,(e,t)=>(w(),i("tr",{key:t},[s("td",W2,v(K(e.date)),1),s("td",q2,v(e.valueprc?e.valueprc.toFixed(2)+"%":"—"),1),s("td",Y2,v(e.value?e.value.toFixed(2):"—"),1)]))),128))])])])])):l("",!0),s("div",j2,[t[79]||(t[79]=s("div",{class:"card-header"},[s("h3",null,"Корпоративные события")],-1)),_.value.corporate_events?.length?(w(),i("div",X2,[(w(!0),i(p,null,f(_.value.corporate_events,(e,t)=>(w(),i("div",{key:t,class:"event-item"},[s("span",$2,v(K(e.date)),1),s("span",K2,v(e.description),1)]))),128))])):(w(),i("p",Z2,"Нет данных о корпоративных событиях"))])])):(w(),i("section",c0,[...t[28]||(t[28]=[s("div",{class:"glass-card"},"Введите ISIN для генерации отчёта",-1)])]))]))}}),Q2=xe(J2,[["__scopeId","data-v-0f62bc4a"]]),e5={class:"page-container"},t5={class:"section-header"},a5={class:"header-left"},n5={key:0,class:"section-title"},r5={key:1,class:"section-title"},i5={key:2,class:"section-subtitle"},o5={class:"text-accent"},s5={key:3,class:"section-subtitle"},l5={class:"text-accent"},c5={class:"header-actions"},u5={class:"glass-pill"},d5=["disabled"],h5={class:"glass-pill"},p5=["disabled"],f5={key:0,class:"state-section"},m5={class:"glass-card"},v5={key:1,class:"state-section"},g5={class:"glass-card error"},y5={key:2,class:"state-section"},b5={key:3,class:"report-content"},x5={class:"grid-2"},w5={class:"glass-card"},_5={class:"info-table"},S5={class:"value"},M5={key:1},T5={class:"value mono"},k5={class:"value"},C5={key:1},A5={class:"value"},E5={key:1},I5={class:"value"},R5={key:1},D5={class:"value mono"},P5={key:1},L5={class:"value"},N5={class:"value"},O5={class:"glass-card"},F5={class:"info-table"},B5={class:"value mono"},U5={key:1},z5={class:"value mono"},V5={key:1},H5={class:"value mono"},G5={key:1},W5={class:"value accent"},q5={key:1},Y5={class:"value"},j5={key:0,class:"accent"},X5={key:0},$5={key:1},K5={class:"value accent"},Z5={key:1},J5={class:"value mono"},Q5={key:1},e4={class:"value mono"},t4={key:1},a4={class:"value"},n4={key:0,class:"accent"},r4={key:1},i4={class:"value mono"},o4={key:1},s4={class:"grid-3"},l4={class:"glass-card"},c4={key:0,class:"ratings-list"},u4={class:"agency"},d4={class:"grade"},h4={class:"date mono"},p4={key:1,class:"muted"},f4={class:"glass-card"},m4={key:0,class:"ratings-list"},v4={class:"agency"},g4={class:"rating-info"},y4={class:"grade"},b4={key:0,class:"outlook"},x4={class:"date mono"},w4={key:1,class:"muted"},_4={class:"glass-card"},S4={key:0,class:"ratings-list"},M4={class:"agency"},T4={class:"grade"},k4={class:"date mono"},C4={key:1,class:"muted"},A4={class:"grid-3"},E4={class:"glass-card"},I4={class:"card-header"},R4={key:0,class:"status-badge fulfilled"},D4={key:1,class:"status-badge inactive"},P4={class:"metric-list"},L4={class:"metric"},N4={class:"val"},O4={class:"metric"},F4={class:"val"},B4={class:"metric"},U4={class:"val"},z4={class:"metric"},V4={class:"val"},H4={key:0,class:"status-badge fulfilled"},G4={key:1},W4={class:"glass-card"},q4={class:"metric-list"},Y4={class:"metric"},j4={class:"val accent"},X4={key:1},$4={class:"metric"},K4={class:"val accent"},Z4={key:1},J4={class:"metric"},Q4={class:"val accent"},e3={class:"metric"},t3={class:"val mono"},a3={class:"metric"},n3={class:"val mono"},r3={key:1},i3={key:0},o3={class:"metric"},s3={class:"val mono"},l3={key:1},c3={class:"metric"},u3={class:"val mono"},d3={class:"glass-card"},h3={class:"metric-list"},p3={class:"metric"},f3={class:"val"},m3={key:1},v3={class:"metric"},g3={class:"val"},y3={key:1},b3={class:"metric"},x3={class:"val"},w3={key:1},_3={class:"metric"},S3={class:"val"},M3={key:1},T3={class:"glass-card full-width"},k3={class:"chart-header"},C3={class:"chart-container tall"},A3={class:"glass-card full-width"},E3={class:"chart-header"},I3={class:"chart-container tall"},R3={class:"glass-card full-width"},D3={class:"comparison-section"},P3={class:"comparison-table"},L3={class:"mono"},N3={class:"mono"},O3={class:"mono"},F3={class:"highlight-row"},B3={class:"mono accent"},U3={class:"mono"},z3={class:"mono"},V3={class:"chart-container indices-chart"},H3={class:"glass-card full-width"},G3={class:"analogous-input-section"},W3={class:"glass-pill"},q3=["disabled"],Y3={key:0,class:"analogs-list"},j3={class:"analog-isin mono"},X3={class:"analog-name"},$3=["onClick"],K3={class:"chart-container tall"},Z3={key:0,class:"note-text"},J3={key:0,class:"glass-card full-width"},Q3={class:"card-header"},e6={class:"muted"},t6={class:"schedule-table-wrap"},a6={class:"schedule-table"},n6={class:"mono"},r6={class:"mono"},i6={class:"mono"},o6={key:1,class:"glass-card full-width"},s6={class:"card-header"},l6={class:"muted"},c6={class:"schedule-table-wrap"},u6={class:"schedule-table"},d6={class:"mono"},h6={class:"mono"},p6={class:"mono"},f6={class:"glass-card full-width"},m6={key:0,class:"events-list"},v6={class:"event-date mono"},g6={class:"event-description"},y6={key:1,class:"muted"},b6=e({__name:"FloaterBondReport",setup(e){const a=g(),r=x(),o=S(()=>a.params.isin||""),u=t(o.value),d=S(()=>{if(!_.value?.indices)return null;const e=_.value.indices;return e.gov_less_1y??e.gov_1_3y??e.gov_3_5y??e.gov_5plus??null}),h=t(!1),y=t("Загрузка данных..."),b=t(null),_=t(null),M=t((new Date).toISOString().split("T")[0]),C=t(!1),A=t(null),E=t(""),I=t(!1),R=t([]),D=t(!1),P=t(null),L=t(null),N=t(null),O=t(null);let F=null,B=null,V=null,H=null;const G=async e=>{if(e){h.value=!0,y.value="Загрузка спецификации флоатера с MOEX ISS...",b.value=null,_.value=null;try{y.value="Загрузка данных с MOEX ISS, ZCYC и RuData...";const t=await HQ(e,M.value);_.value=t,setTimeout(()=>K(),100)}catch(TQe){b.value=TQe.message||"Ошибка загрузки данных",console.error("Floater bond report error:",TQe)}finally{h.value=!1}}},W=()=>{u.value?.trim()&&(r.push(`/floater-bond-report/${u.value}`),G(u.value))},q=()=>{_.value?.isin&&G(_.value.isin)},Y=()=>{C.value=!C.value,C.value&&_.value?(A.value=JSON.parse(JSON.stringify(_.value)),A.value&&!A.value.issue_info&&(A.value.issue_info={issue_date:null,maturity_date:null,coupon_rate:null,coupon_per_year:null}),A.value&&!A.value.pricing&&(A.value.pricing={clean_price_pct:0,ytm:0,ytm_pct:0,g_spread_bps:0,g_curve_yield:0,g_curve_pct:0,yield_type:"YTM"}),A.value&&!A.value.risk_indicators&&(A.value.risk_indicators={duration:0,mod_duration:0,convexity:0,dv01:0})):!C.value&&A.value&&(_.value=JSON.parse(JSON.stringify(A.value)))},j=()=>{const e=C.value&&A.value?A.value:_.value;if(e)try{const t=[];if(t.push(["Отчет по облигации с плавающим купоном"]),t.push(["Дата оценки:",M.value]),t.push(["ISIN:",e.isin]),t.push([]),t.push(["ОБЩИЕ СВЕДЕНИЯ"]),t.push(["Эмитент",e.issuer||""]),t.push(["ISIN",e.isin]),t.push(["Страна риска",e.risk_country||""]),t.push(["Сектор",e.sector||""]),t.push(["Отрасль",e.industry||""]),t.push(["Кол-во выпусков в обращении",e.issues_count||""]),t.push([]),t.push(["ИНФОРМАЦИЯ ПО ВЫПУСКУ"]),t.push(["Дата выпуска",e.issue_info?.issue_date||""]),t.push(["Объем в обращении",e.outstanding_amount||""]),t.push(["Дата погашения",e.issue_info?.maturity_date||""]),t.push(["Купон",e.issue_info?.coupon_formula||""]),t.push(["Следующий купон",e.issue_info?.next_coupon?(100*e.issue_info.next_coupon).toFixed(2)+"%":""]),t.push(["Номинал",e.issue_info?.nominal||""]),t.push(["Купонов в год",e.issue_info?.coupon_per_year||""]),t.push(["Анализируемый период",e.analysis_period||""]),t.push([]),t.push(["КОТИРОВКА И ДОХОДНОСТЬ"]),t.push(["Чистая цена",e.pricing?.clean_price_pct?e.pricing.clean_price_pct.toFixed(2)+"%":""]),t.push([e.pricing?.yield_type||"YTM",e.pricing?.ytm_pct?e.pricing.ytm_pct.toFixed(2)+"%":e.pricing?.ytm?(100*e.pricing.ytm).toFixed(2)+"%":""]),t.push(["DM (Discount Margin)",null!=e.dm_bps?e.dm_bps.toFixed(2)+" б.п.":""]),t.push(["QM (Quoted Margin)",null!=e.qm_bps?e.qm_bps.toFixed(2)+" б.п.":""]),t.push(["G-spread",e.pricing?.g_spread_bps?e.pricing.g_spread_bps+" bps":""]),t.push(["G-curve",e.pricing?.g_curve_pct?e.pricing.g_curve_pct.toFixed(2)+"%":e.pricing?.g_curve_yield?(100*e.pricing.g_curve_yield).toFixed(2)+"%":""]),t.push(["НКД",null!=e.nkd?e.nkd.toFixed(2):""]),e.base_rate_name&&t.push(["Базовая ставка",`${e.base_rate_name}${null!=e.base_rate_value?" ("+e.base_rate_value.toFixed(2)+"%)":""}`]),t.push([]),t.push(["РИСК-МЕТРИКИ"]),t.push(["Мод. дюрация",e.risk_indicators?.mod_duration?.toFixed(4)||""]),t.push(["Дюрация",e.risk_indicators?.duration?.toFixed(4)||""]),t.push(["Выпуклость",e.risk_indicators?.convexity?.toFixed(2)||""]),t.push(["DV01",e.risk_indicators?.dv01||""]),t.push([]),e.indices){t.push(["СРАВНЕНИЕ С ИНДЕКСАМИ"]);const a=e.indices.gov_less_1y??e.indices.gov_1_3y??e.indices.gov_3_5y??e.indices.gov_5plus;a&&t.push(["Индекс гос. облигаций",(100*a).toFixed(2)+"%"]),e.indices.corp_aaa&&t.push(["Индекс корп. облигаций (ААА)",(100*e.indices.corp_aaa).toFixed(2)+"%"]),e.indices.corp_aa&&t.push(["Индекс корп. облигаций (АА)",(100*e.indices.corp_aa).toFixed(2)+"%"]),t.push([`Оцениваемая облигация (${e.pricing?.yield_type||"YTM"})`,e.pricing?.ytm_pct?e.pricing.ytm_pct.toFixed(2)+"%":e.pricing?.ytm?(100*e.pricing.ytm).toFixed(2)+"%":""]),e.indices.corp_a&&t.push(["Индекс корп. облигаций (А)",(100*e.indices.corp_a).toFixed(2)+"%"]),e.indices.corp_bbb&&t.push(["Индекс корп. облигаций (ВВВ)",(100*e.indices.corp_bbb).toFixed(2)+"%"]),t.push([])}e.ratings?.issue?.length&&(t.push(["РЕЙТИНГ ЭМИССИИ"]),t.push(["Агентство","Рейтинг","Дата"]),e.ratings.issue.forEach(e=>t.push([e.agency,e.rating,e.date||""])),t.push([])),e.ratings?.issuer?.length&&(t.push(["РЕЙТИНГ ЭМИТЕНТА"]),t.push(["Агентство","Рейтинг","Прогноз","Дата"]),e.ratings.issuer.forEach(e=>t.push([e.agency,e.rating,e.outlook||"",e.date||""])),t.push([])),e.margin_history?.length&&(t.push(["ДИНАМИКА DM/QM"]),t.push(["Дата","DM (б.п.)","QM (б.п.)"]),e.margin_history.forEach(e=>t.push([e.date,e.dm?.toFixed(2)||"",e.qm?.toFixed(2)||""])),t.push([])),e.coupon_schedule?.length&&(t.push(["КУПОННОЕ РАСПИСАНИЕ"]),t.push(["Дата","Ставка, %","Сумма, руб."]),e.coupon_schedule.forEach(e=>t.push([e.date||"",e.valueprc?.toFixed(2)||"",e.value?.toFixed(2)||""])),t.push([])),e.amortization_schedule?.length&&(t.push(["ГРАФИК АМОРТИЗАЦИИ"]),t.push(["Дата","% от номинала","Сумма, руб."]),e.amortization_schedule.forEach(e=>t.push([e.date||"",e.valueprc?.toFixed(2)||"",e.value?.toFixed(2)||""])),t.push([])),e.corporate_events?.length&&(t.push(["КОРПОРАТИВНЫЕ СОБЫТИЯ"]),t.push(["Дата","Описание"]),e.corporate_events.forEach(e=>t.push([e.date||"",e.description])));const a=Rj.aoa_to_sheet(t),n=Rj.book_new();Rj.book_append_sheet(n,a,"Отчет"),a["!cols"]=[{wch:45},{wch:30}];bj(n,`Floater_Bond_Report_${e.isin}_${M.value}.xlsx`)}catch(t){console.error("Export error:",t),alert(`Ошибка при экспорте: ${t.message}`)}},X=e=>{if(!e)return"—";try{const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0");return`${a}.${n}.${t.getFullYear()}`}catch{return e}},$=e=>null==e?"—":new Intl.NumberFormat("ru-RU").format(e),K=()=>{if(F&&F.destroy(),B&&B.destroy(),V&&V.destroy(),H&&H.destroy(),P.value?.getContext("2d")&&_.value?.price_history?.length){const e=_.value.price_history,t=e.map(e=>{const t=new Date(e.date);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`}),a=e.map(e=>e.price);F=new re(P.value.getContext("2d"),{type:"line",data:{labels:t,datasets:[{label:"Цена, %",data:a,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:0,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},filler:{propagate:!0}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11},maxTicksLimit:12}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Цена, %",color:"rgba(255,255,255,0.5)",font:{size:11}}}}}})}if(L.value?.getContext("2d")&&_.value?.margin_history?.length){const e=_.value.margin_history,t=e.map(e=>{const t=new Date(e.date);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`}),a=e.map(e=>e.dm),n=e.map(e=>e.qm);B=new re(L.value.getContext("2d"),{type:"line",data:{labels:t,datasets:[{label:"DM (дисконтная маржа)",data:a,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:0,borderWidth:2},{label:"QM (фиксированная маржа)",data:n,borderColor:"#f59e0b",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:0,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0,labels:{color:"rgba(255,255,255,0.6)",font:{size:11},usePointStyle:!0},position:"top"}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11},maxTicksLimit:12}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"б.п.",color:"rgba(255,255,255,0.5)",font:{size:11}}}}}})}if(N.value?.getContext("2d")&&_.value?.indices&&_.value?.pricing){const e=_.value.indices,t=_.value.pricing.ytm_pct??100*(_.value.pricing.ytm||0),a=100*(e.gov_less_1y??e.gov_1_3y??e.gov_3_5y??e.gov_5plus??0),n=`Оцениваемая облигация (${_.value.pricing.yield_type||"YTM"})`,r=[{label:"Индекс гос. облигаций",value:a,color:"#9ca3af"},{label:"Индекс корп. облигаций (ААА)",value:100*(e.corp_aaa||0),color:"#9ca3af"},{label:"Индекс корп. облигаций (АА)",value:100*(e.corp_aa||0),color:"#9ca3af"},{label:n,value:t,color:"#ef4444"},{label:"Индекс корп. облигаций (А)",value:100*(e.corp_a||0),color:"#9ca3af"},{label:"Индекс корп. облигаций (ВВВ)",value:100*(e.corp_bbb||0),color:"#9ca3af"}].filter(e=>e.value>0);V=new re(N.value.getContext("2d"),{type:"scatter",data:{datasets:r.map(e=>({label:e.label,data:[{x:e.value,y:0}],backgroundColor:e.label.startsWith("Оцениваемая облигация")?"rgba(239, 68, 68, 0)":e.color,borderColor:e.label.startsWith("Оцениваемая облигация")?"rgba(239, 68, 68, 0)":e.color,pointRadius:e.label.startsWith("Оцениваемая облигация")?1:10,pointHoverRadius:e.label.startsWith("Оцениваемая облигация")?14:12,showLine:!1}))},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},plugins:{legend:{display:!1},tooltip:{enabled:!0,displayColors:!1,backgroundColor:"rgba(0, 0, 0, 0.9)",titleColor:"rgba(255, 255, 255, 1)",bodyColor:"rgba(255, 255, 255, 0.9)",borderColor:"rgba(255, 255, 255, 0.3)",borderWidth:1,padding:14,titleFont:{size:13,weight:"bold"},bodyFont:{size:12},cornerRadius:8,callbacks:{title:e=>r[e[0].datasetIndex]?.label||"",label:e=>`Доходность: ${r[e.datasetIndex]?.value.toFixed(2)}%`}}},scales:{x:{type:"linear",position:"bottom",grid:{color:"rgba(255,255,255,0.05)",display:!0},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11},stepSize:1},title:{display:!0,text:"Доходность, %",color:"rgba(255,255,255,0.5)",font:{size:11}}},y:{type:"linear",min:-.5,max:.5,display:!1,grid:{display:!1},ticks:{display:!1}}}},plugins:[{id:"indicesTimeline",afterDraw:e=>{const t=e.ctx,a=e.chartArea,n=(a.top+a.bottom)/2;t.save(),t.fillStyle="rgba(245, 245, 220, 0.3)",t.fillRect(a.left,n-20,a.right-a.left,40),t.restore()}},{id:"blinkingRedPoint",afterDraw:e=>{const t=e.ctx,a=r.findIndex(e=>e.label.startsWith("Оцениваемая облигация"));if(a<0)return;const n=e.getDatasetMeta(a);if(!n?.data?.length)return;const i=n.data[0].getProps(["x","y"],!0),o=Date.now()/1e3,s=.5*Math.sin(3*o)+.5,l=.5+.5*s,c=10+4*s,u=t.createRadialGradient(i.x,i.y,0,i.x,i.y,2*c);u.addColorStop(0,`rgba(239, 68, 68, ${.4*l})`),u.addColorStop(.5,`rgba(239, 68, 68, ${.2*l})`),u.addColorStop(1,"rgba(239, 68, 68, 0)"),t.save(),t.fillStyle=u,t.beginPath(),t.arc(i.x,i.y,2*c,0,2*Math.PI),t.fill(),t.fillStyle=`rgba(239, 68, 68, ${l})`,t.strokeStyle=`rgba(255, 255, 255, ${.9*l})`,t.lineWidth=2,t.beginPath(),t.arc(i.x,i.y,c,0,2*Math.PI),t.fill(),t.stroke(),t.restore()}}]});let i=null,o=!0;const s=()=>{if(V&&o)try{V.draw(),o&&(i=requestAnimationFrame(s))}catch(TQe){o=!1}};if(s(),V){const e=V;e.__animationFrameId=i,e.__stopAnimation=()=>{o=!1,"number"==typeof e.__animationFrameId&&cancelAnimationFrame(e.__animationFrameId)}}}if(O.value?.getContext("2d")&&_.value?.risk_indicators&&_.value?.pricing){const e=R.value.filter(e=>void 0!==e.duration&&void 0!==e.yield),t=_.value.risk_indicators.duration||0,a=100*(_.value.pricing.ytm||0),n=_.value.issuer||"Оцениваемая облигация",r=[];e.length>0&&r.push({label:"Облигации-аналоги",data:e.map(e=>({x:e.duration,y:e.yield})),backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa",pointRadius:8,pointStyle:"diamond",borderWidth:2}),r.push({label:n,data:[{x:t,y:a}],backgroundColor:"#ef4444",borderColor:"#ef4444",pointRadius:10,pointStyle:"diamond",borderWidth:2,pointHoverRadius:12}),H=new re(O.value.getContext("2d"),{type:"scatter",data:{datasets:r},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},plugins:{legend:{display:!0,labels:{color:"rgba(255,255,255,0.6)",font:{size:11},usePointStyle:!0},position:"top"}},scales:{x:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Дюрация, лет",color:"rgba(255,255,255,0.5)",font:{size:11}}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:11}},title:{display:!0,text:"Доходность к оферте/погашению, %",color:"rgba(255,255,255,0.5)",font:{size:11}}}}},plugins:[{id:"blinkingPoint",afterDraw:e=>{const t=e.ctx,a=e.data.datasets.length-1,n=e.getDatasetMeta(a);if(!n?.data?.length)return;const r=n.data[0].getProps(["x","y"],!0),i=Date.now()/1e3,o=.5*Math.sin(3*i)+.5,s=.4+.6*o,l=10+5*o,c=t.createRadialGradient(r.x,r.y,0,r.x,r.y,2.5*l);c.addColorStop(0,`rgba(239, 68, 68, ${.5*s})`),c.addColorStop(.4,`rgba(239, 68, 68, ${.2*s})`),c.addColorStop(1,"rgba(239, 68, 68, 0)"),t.save(),t.fillStyle=c,t.beginPath(),t.arc(r.x,r.y,2.5*l,0,2*Math.PI),t.fill(),t.fillStyle=`rgba(239, 68, 68, ${s})`,t.strokeStyle=`rgba(255, 255, 255, ${.8*s})`,t.lineWidth=2,t.beginPath(),t.arc(r.x,r.y,l,0,2*Math.PI),t.fill(),t.stroke(),t.restore()}}]});let i=null,o=!0;const s=()=>{if(H&&o)try{H.draw(),o&&(i=requestAnimationFrame(s))}catch(TQe){o=!1}};if(s(),H){const e=H;e.__animationFrameId=i,e.__stopAnimation=()=>{o=!1,"number"==typeof e.__animationFrameId&&cancelAnimationFrame(e.__animationFrameId)}}}},Z=async()=>{if(!E.value?.trim())return;const e=E.value.trim().toUpperCase();if(R.value.some(t=>t.isin===e))return b.value="Облигация с таким ISIN уже добавлена",void setTimeout(()=>{b.value=null},3e3);I.value=!0,R.value.push({isin:e,name:void 0,duration:void 0,yield:void 0}),E.value="";try{const t=await GQ(e,M.value),a=R.value.findIndex(t=>t.isin===e);-1!==a&&(t?R.value[a]={isin:e,name:t.name,duration:t.duration,yield:t.yield}:R.value[a].name=`${e} (нет данных)`),_.value&&(_.value.analogous_bonds=R.value.filter(e=>void 0!==e.duration&&void 0!==e.yield).map(e=>({name:e.name||e.isin,duration:e.duration,yield:e.yield})),setTimeout(()=>{H&&H.destroy(),K()},100))}catch(TQe){const a=R.value.findIndex(t=>t.isin===e);-1!==a&&R.value.splice(a,1),b.value=`Ошибка загрузки данных по ISIN ${e}`,setTimeout(()=>{b.value=null},3e3)}finally{I.value=!1}},J=e=>{const t="price"===e?P.value:L.value;if(!t)return;const a=document.createElement("a");a.href=t.toDataURL("image/png"),a.download=`floater-bond-${e}-${(new Date).toISOString().split("T")[0]}.png`,a.click()};return n(()=>{o.value?G(o.value):G("RU000A108VW7")}),z(()=>{if(F&&F.destroy(),B&&B.destroy(),V){const e=V.__stopAnimation;"function"==typeof e&&e(),V.destroy()}if(H){const e=H.__stopAnimation;"function"==typeof e&&e(),H.destroy()}}),(e,t)=>(w(),i("div",e5,[s("div",t5,[s("div",a5,[_.value?(w(),i("h1",n5,v(_.value.issuer)+", "+v(_.value.isin),1)):(w(),i("h1",r5,"Floater Bond Report")),_.value?(w(),i("p",i5,[t[27]||(t[27]=m(" Отчет по облигации с плавающим купоном ISIN: ",-1)),s("span",o5,v(_.value.isin),1)])):(w(),i("p",s5,[t[28]||(t[28]=m(" Отчет по облигации с плавающим купоном ISIN: ",-1)),s("span",l5,v(o.value||"—"),1)]))]),s("div",c5,[s("div",u5,[t[29]||(t[29]=s("label",{class:"lbl-mini"},"Дата оценки:",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>M.value=e),type:"date",class:"date-input-small",onChange:q},null,544),[[k,M.value]])]),s("button",{onClick:Y,class:c(["btn-toggle-edit",{active:C.value}])},v(C.value?"✓ Режим редактирования":"✎ Редактировать"),3),s("button",{onClick:j,class:"btn-export-excel",disabled:!_.value}," 📊 Excel ",8,d5),s("div",h5,[t[30]||(t[30]=s("label",{class:"lbl-mini"},"ISIN:",-1)),T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),type:"text",class:"search-input",placeholder:"RU000A108VW7",onKeyup:U(W,["enter"])},null,544),[[k,u.value]]),s("button",{class:"btn-search",onClick:W,disabled:!u.value},"🔍",8,p5)])])]),h.value?(w(),i("section",f5,[s("div",m5,[t[31]||(t[31]=s("span",{class:"spinner"},null,-1)),m(" "+v(y.value),1)])])):b.value?(w(),i("section",v5,[s("div",g5,"⚠ "+v(b.value),1)])):_.value?(w(),i("section",b5,[s("div",x5,[s("div",w5,[t[41]||(t[41]=s("div",{class:"card-header"},[s("h3",null,"Общие сведения")],-1)),s("table",_5,[s("tr",null,[t[33]||(t[33]=s("td",{class:"label"},"Эмитент",-1)),s("td",S5,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>A.value.issuer=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.issuer]]):(w(),i("span",M5,v(_.value.issuer),1))])]),s("tr",null,[t[34]||(t[34]=s("td",{class:"label"},"ISIN",-1)),s("td",T5,v(_.value.isin),1)]),s("tr",null,[t[35]||(t[35]=s("td",{class:"label"},"Страна риска",-1)),s("td",k5,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>A.value.risk_country=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.risk_country]]):(w(),i("span",C5,v(_.value.risk_country||"—"),1))])]),s("tr",null,[t[36]||(t[36]=s("td",{class:"label"},"Сектор",-1)),s("td",A5,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[4]||(t[4]=e=>A.value.sector=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.sector]]):(w(),i("span",E5,v(_.value.sector||"—"),1))])]),s("tr",null,[t[37]||(t[37]=s("td",{class:"label"},"Отрасль",-1)),s("td",I5,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[5]||(t[5]=e=>A.value.industry=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.industry]]):(w(),i("span",R5,v(_.value.industry||"—"),1))])]),s("tr",null,[t[38]||(t[38]=s("td",{class:"label"},"Кол-во выпусков в обращении",-1)),s("td",D5,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[6]||(t[6]=e=>A.value.issues_count=e),type:"number",class:"edit-input"},null,512)),[[k,A.value.issues_count,void 0,{number:!0}]]):(w(),i("span",P5,v(_.value.issues_count||"—"),1))])]),s("tr",null,[t[39]||(t[39]=s("td",{class:"label"},"Уровень листинга",-1)),s("td",L5,v(_.value.listing_level?_.value.listing_level+" уровень":"—"),1)]),s("tr",null,[t[40]||(t[40]=s("td",{class:"label"},"Валюта",-1)),s("td",N5,v(_.value.currency||"—"),1)])])]),s("div",O5,[t[52]||(t[52]=s("div",{class:"card-header"},[s("h3",null,"Информация по выпуску")],-1)),s("table",F5,[s("tr",null,[t[42]||(t[42]=s("td",{class:"label"},"Дата выпуска",-1)),s("td",B5,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=e=>A.value.issue_info.issue_date=e),type:"date",class:"edit-input"},null,512)),[[k,A.value.issue_info.issue_date]]):(w(),i("span",U5,v(X(_.value.issue_info?.issue_date)),1))])]),s("tr",null,[t[43]||(t[43]=s("td",{class:"label"},"Объем в обращении, RUB",-1)),s("td",z5,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[8]||(t[8]=e=>A.value.outstanding_amount=e),type:"number",class:"edit-input"},null,512)),[[k,A.value.outstanding_amount,void 0,{number:!0}]]):(w(),i("span",V5,v($(_.value.outstanding_amount)||"—"),1))])]),s("tr",null,[t[44]||(t[44]=s("td",{class:"label"},"Дата погашения",-1)),s("td",H5,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[9]||(t[9]=e=>A.value.issue_info.maturity_date=e),type:"date",class:"edit-input"},null,512)),[[k,A.value.issue_info.maturity_date]]):(w(),i("span",G5,v(X(_.value.issue_info?.maturity_date)),1))])]),s("tr",null,[t[45]||(t[45]=s("td",{class:"label"},"Купон, %",-1)),s("td",W5,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[10]||(t[10]=e=>A.value.issue_info.coupon_formula=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.issue_info.coupon_formula]]):(w(),i("span",q5,v(_.value.issue_info?.coupon_formula||"—"),1))])]),s("tr",null,[t[46]||(t[46]=s("td",{class:"label"},"Базовая ставка",-1)),s("td",Y5,[_.value.base_rate_name?(w(),i("span",j5,[m(v(_.value.base_rate_name)+" ",1),null!=_.value.base_rate_value?(w(),i("span",X5," ("+v(_.value.base_rate_value.toFixed(2))+"%)",1)):l("",!0)])):(w(),i("span",$5,"—"))])]),s("tr",null,[t[47]||(t[47]=s("td",{class:"label"},"Следующий купон",-1)),s("td",K5,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[11]||(t[11]=e=>A.value.issue_info.next_coupon=e),type:"number",step:"0.001",class:"edit-input"},null,512)),[[k,A.value.issue_info.next_coupon,void 0,{number:!0}]]):(w(),i("span",Z5,v(_.value.issue_info?.next_coupon?(100*_.value.issue_info.next_coupon).toFixed(2)+"%":"—"),1))])]),s("tr",null,[t[48]||(t[48]=s("td",{class:"label"},"Номинал, RUB",-1)),s("td",J5,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[12]||(t[12]=e=>A.value.issue_info.nominal=e),type:"number",class:"edit-input"},null,512)),[[k,A.value.issue_info.nominal,void 0,{number:!0}]]):(w(),i("span",Q5,v(_.value.issue_info?.nominal?$(_.value.issue_info.nominal):"—"),1))])]),s("tr",null,[t[49]||(t[49]=s("td",{class:"label"},"Кол-во купонных платежей в год",-1)),s("td",e4,[C.value&&A.value?.issue_info?T((w(),i("input",{key:0,"onUpdate:modelValue":t[13]||(t[13]=e=>A.value.issue_info.coupon_per_year=e),type:"number",class:"edit-input"},null,512)),[[k,A.value.issue_info.coupon_per_year,void 0,{number:!0}]]):(w(),i("span",t4,v(_.value.issue_info?.coupon_per_year??"—"),1))])]),s("tr",null,[t[50]||(t[50]=s("td",{class:"label"},"Оферта",-1)),s("td",a4,[_.value.issue_info?.offer&&"Нет"!==_.value.issue_info.offer.type?(w(),i("span",n4,v(_.value.issue_info.offer.type)+" — "+v(X(_.value.issue_info.offer.date)),1)):(w(),i("span",r4,"Нет"))])]),s("tr",null,[t[51]||(t[51]=s("td",{class:"label"},"Анализируемый период",-1)),s("td",i4,[C.value&&A.value?T((w(),i("input",{key:0,"onUpdate:modelValue":t[14]||(t[14]=e=>A.value.analysis_period=e),type:"text",class:"edit-input"},null,512)),[[k,A.value.analysis_period]]):(w(),i("span",o4,v(_.value.analysis_period||"—"),1))])])])])]),s("div",s4,[s("div",l4,[t[53]||(t[53]=s("div",{class:"card-header"},[s("h3",null,"Рейтинг эмиссии")],-1)),_.value.ratings?.issue?.length?(w(),i("div",c4,[(w(!0),i(p,null,f(_.value.ratings.issue,(e,t)=>(w(),i("div",{key:t,class:"rating-item"},[s("span",u4,v(e.agency),1),s("span",d4,v(e.rating),1),s("span",h4,v(X(e.date)),1)]))),128))])):(w(),i("p",p4,"Нет данных"))]),s("div",f4,[t[54]||(t[54]=s("div",{class:"card-header"},[s("h3",null,"Рейтинг эмитента")],-1)),_.value.ratings?.issuer?.length?(w(),i("div",m4,[(w(!0),i(p,null,f(_.value.ratings.issuer,(e,t)=>(w(),i("div",{key:t,class:"rating-item"},[s("span",v4,v(e.agency),1),s("div",g4,[s("span",y4,v(e.rating),1),e.outlook?(w(),i("span",b4,v(e.outlook),1)):l("",!0)]),s("span",x4,v(X(e.date)),1)]))),128))])):(w(),i("p",w4,"Нет данных"))]),s("div",_4,[t[55]||(t[55]=s("div",{class:"card-header"},[s("h3",null,"Рейтинг гаранта")],-1)),_.value.ratings?.guarantor?.length?(w(),i("div",S4,[(w(!0),i(p,null,f(_.value.ratings.guarantor,(e,t)=>(w(),i("div",{key:t,class:"rating-item"},[s("span",M4,v(e.agency),1),s("span",T4,v(e.rating),1),s("span",k4,v(X(e.date)),1)]))),128))])):(w(),i("p",C4,"Нет данных"))])]),s("div",A4,[s("div",E4,[s("div",I4,[t[56]||(t[56]=s("h3",null,"Активность рынка",-1)),_.value.market_activity?.is_active?(w(),i("span",R4,"АКТИВНЫЙ")):(w(),i("span",D4,"НЕАКТИВНЫЙ"))]),s("div",P4,[s("div",L4,[t[57]||(t[57]=s("span",null,"Кол-во торговых дней",-1)),s("span",N4,v(_.value.market_activity?.trading_days??"—"),1)]),s("div",O4,[t[58]||(t[58]=s("span",null,"Кол-во сделок",-1)),s("span",F4,v(_.value.market_activity?.trades??"—"),1)]),s("div",B4,[t[59]||(t[59]=s("span",null,"Объем торгов/выпуск",-1)),s("span",U4,v(_.value.market_activity?.turnover_to_outstanding?(100*_.value.market_activity.turnover_to_outstanding).toFixed(2)+"%":"—"),1)]),s("div",z4,[t[60]||(t[60]=s("span",null,"Торги 30 дней",-1)),s("span",V4,[_.value.market_activity?.traded_last_30d?(w(),i("span",H4,"Да")):(w(),i("span",G4,"Нет"))])])])]),s("div",W4,[t[67]||(t[67]=s("div",{class:"card-header"},[s("h3",null,"Котировка и доходность")],-1)),s("div",q4,[s("div",Y4,[t[61]||(t[61]=s("span",null,"Чистая цена",-1)),s("span",j4,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[15]||(t[15]=e=>A.value.pricing.clean_price_pct=e),type:"number",step:"0.01",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.clean_price_pct,void 0,{number:!0}]]):(w(),i("span",X4,v(_.value.pricing?.clean_price_pct?.toFixed(2))+"%",1))])]),s("div",$4,[s("span",null,v(_.value.pricing?.yield_type||"YTM"),1),s("span",K4,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[16]||(t[16]=e=>A.value.pricing.ytm=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.ytm,void 0,{number:!0}]]):(w(),i("span",Z4,v(null!=_.value.pricing?.ytm_pct?_.value.pricing.ytm_pct.toFixed(2)+"%":_.value.pricing?.ytm?(100*_.value.pricing.ytm).toFixed(2)+"%":"—"),1))])]),s("div",J4,[t[62]||(t[62]=s("span",null,"DM (Discount Margin)",-1)),s("span",Q4,v(null!=_.value.dm_bps?_.value.dm_bps.toFixed(2)+" б.п.":"—"),1)]),s("div",e3,[t[63]||(t[63]=s("span",null,"QM (Quoted Margin)",-1)),s("span",t3,v(null!=_.value.qm_bps?_.value.qm_bps.toFixed(2)+" б.п.":"—"),1)]),s("div",a3,[t[64]||(t[64]=s("span",null,"G-spread",-1)),s("span",n3,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[17]||(t[17]=e=>A.value.pricing.g_spread_bps=e),type:"number",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.g_spread_bps,void 0,{number:!0}]]):(w(),i("span",r3,[m(v(_.value.pricing?.g_spread_bps??"—"),1),_.value.pricing?.g_spread_bps?(w(),i("span",i3," bps")):l("",!0)]))])]),s("div",o3,[t[65]||(t[65]=s("span",null,"G-curve",-1)),s("span",s3,[C.value&&A.value?.pricing?T((w(),i("input",{key:0,"onUpdate:modelValue":t[18]||(t[18]=e=>A.value.pricing.g_curve_yield=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.pricing.g_curve_yield,void 0,{number:!0}]]):(w(),i("span",l3,v(null!=_.value.pricing?.g_curve_pct?_.value.pricing.g_curve_pct.toFixed(2)+"%":_.value.pricing?.g_curve_yield?(100*_.value.pricing.g_curve_yield).toFixed(2)+"%":"—"),1))])]),s("div",c3,[t[66]||(t[66]=s("span",null,"НКД",-1)),s("span",u3,v(null!=_.value.nkd?_.value.nkd.toFixed(2):"—"),1)])]),t[68]||(t[68]=s("p",{class:"note-text"},"* Доходность, дюрация и следующий купон рассчитаны на основе рыночных значений форвардной кривой к ключевой ставке ЦБ РФ",-1))]),s("div",d3,[t[73]||(t[73]=s("div",{class:"card-header"},[s("h3",null,"Риск-метрики")],-1)),s("div",h3,[s("div",p3,[t[69]||(t[69]=s("span",null,"Мод. дюрация",-1)),s("span",f3,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[19]||(t[19]=e=>A.value.risk_indicators.mod_duration=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.mod_duration,void 0,{number:!0}]]):(w(),i("span",m3,v(_.value.risk_indicators?.mod_duration?.toFixed(4)||_.value.risk_indicators?.duration?.toFixed(4)||"—"),1))])]),s("div",v3,[t[70]||(t[70]=s("span",null,"Дюрация",-1)),s("span",g3,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[20]||(t[20]=e=>A.value.risk_indicators.duration=e),type:"number",step:"0.0001",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.duration,void 0,{number:!0}]]):(w(),i("span",y3,v(_.value.risk_indicators?.duration?.toFixed(4)||"—"),1))])]),s("div",b3,[t[71]||(t[71]=s("span",null,"Выпуклость",-1)),s("span",x3,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[21]||(t[21]=e=>A.value.risk_indicators.convexity=e),type:"number",step:"0.01",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.convexity,void 0,{number:!0}]]):(w(),i("span",w3,v(_.value.risk_indicators?.convexity?.toFixed(2)||"—"),1))])]),s("div",_3,[t[72]||(t[72]=s("span",null,"DV01",-1)),s("span",S3,[C.value&&A.value?.risk_indicators?T((w(),i("input",{key:0,"onUpdate:modelValue":t[22]||(t[22]=e=>A.value.risk_indicators.dv01=e),type:"number",step:"0.01",class:"edit-input-inline"},null,512)),[[k,A.value.risk_indicators.dv01,void 0,{number:!0}]]):(w(),i("span",M3,v($(_.value.risk_indicators?.dv01)),1))])])])])]),s("div",T3,[s("div",k3,[t[74]||(t[74]=s("h3",null,"Динамика цен",-1)),s("button",{class:"btn-export",onClick:t[23]||(t[23]=e=>J("price"))},"💾 PNG")]),s("div",C3,[s("canvas",{ref_key:"priceHistoryRef",ref:P},null,512)])]),s("div",A3,[s("div",E3,[t[75]||(t[75]=s("h3",null,"Динамика дисконтной маржи (DM) и фиксированной маржи (QM)",-1)),s("button",{class:"btn-export",onClick:t[24]||(t[24]=e=>J("margin"))},"💾 PNG")]),s("div",I3,[s("canvas",{ref_key:"marginDynamicsRef",ref:L},null,512)])]),s("div",R3,[t[82]||(t[82]=s("div",{class:"card-header"},[s("h3",null,"Сравнение с индексами корпоративных облигаций Московской биржи")],-1)),s("div",D3,[s("table",P3,[t[81]||(t[81]=s("thead",null,[s("tr",null,[s("th",null,"Индекс"),s("th",null,"Доходность, %")])],-1)),s("tbody",null,[s("tr",null,[t[76]||(t[76]=s("td",null,"Доходность индекса государственных облигаций",-1)),s("td",L3,v(null!=d.value?(100*d.value).toFixed(2)+"%":"—"),1)]),s("tr",null,[t[77]||(t[77]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом ААА",-1)),s("td",N3,v(null!=_.value.indices?.corp_aaa?(100*_.value.indices.corp_aaa).toFixed(2)+"%":"—"),1)]),s("tr",null,[t[78]||(t[78]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом АА",-1)),s("td",O3,v(null!=_.value.indices?.corp_aa?(100*_.value.indices.corp_aa).toFixed(2)+"%":"—"),1)]),s("tr",F3,[s("td",null,[s("strong",null,"Оцениваемая облигация ("+v(_.value.pricing?.yield_type||"YTM")+")",1)]),s("td",B3,[s("strong",null,v(null!=_.value.pricing?.ytm_pct?_.value.pricing.ytm_pct.toFixed(2)+"%":_.value.pricing?.ytm?(100*_.value.pricing.ytm).toFixed(2)+"%":"—"),1)])]),s("tr",null,[t[79]||(t[79]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом А",-1)),s("td",U3,v(null!=_.value.indices?.corp_a?(100*_.value.indices.corp_a).toFixed(2)+"%":"—"),1)]),s("tr",null,[t[80]||(t[80]=s("td",null,"Доходность индекса корпоративных облигаций с рейтингом ВВВ",-1)),s("td",z3,v(null!=_.value.indices?.corp_bbb?(100*_.value.indices.corp_bbb).toFixed(2)+"%":"—"),1)])])]),s("div",V3,[s("canvas",{ref_key:"indicesComparisonRef",ref:N},null,512)])])]),s("div",H3,[t[84]||(t[84]=s("div",{class:"card-header"},[s("h3",null,"Сравнение с облигациями-аналогами")],-1)),s("div",G3,[s("div",W3,[t[83]||(t[83]=s("label",{class:"lbl-mini"},"ISIN аналога:",-1)),T(s("input",{"onUpdate:modelValue":t[25]||(t[25]=e=>E.value=e),type:"text",class:"search-input",placeholder:"RU000A10XXXX",onKeyup:U(Z,["enter"])},null,544),[[k,E.value]]),s("button",{class:"btn-search",onClick:Z,disabled:!E.value||I.value},"➕",8,q3)]),R.value.length>0?(w(),i("div",Y3,[(w(!0),i(p,null,f(R.value,(e,t)=>(w(),i("div",{key:t,class:"analog-item"},[s("span",j3,v(e.isin),1),s("span",X3,v(e.name||"Загрузка..."),1),s("button",{class:"btn-remove",onClick:e=>(e=>{R.value.splice(e,1),_.value&&(_.value.analogous_bonds=R.value.filter(e=>void 0!==e.duration&&void 0!==e.yield).map(e=>({name:e.name||e.isin,duration:e.duration,yield:e.yield})),setTimeout(()=>{H&&H.destroy(),K()},100))})(t),title:"Удалить"},"×",8,$3)]))),128))])):l("",!0)]),s("div",K3,[s("canvas",{ref_key:"analogousBondsRef",ref:O},null,512)]),_.value.analogous_bonds_note?(w(),i("p",Z3,v(_.value.analogous_bonds_note),1)):l("",!0)]),_.value.coupon_schedule?.length?(w(),i("div",J3,[s("div",Q3,[t[85]||(t[85]=s("h3",null,"Купонное расписание (предстоящие)",-1)),s("span",e6,v(_.value.coupon_schedule.length)+" выплат",1)]),s("div",t6,[s("table",a6,[t[86]||(t[86]=s("thead",null,[s("tr",null,[s("th",null,"Дата"),s("th",null,"Ставка, %"),s("th",null,"Сумма, руб.")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(_.value.coupon_schedule.slice(0,D.value?void 0:6),(e,t)=>(w(),i("tr",{key:t},[s("td",n6,v(X(e.date)),1),s("td",r6,v(e.valueprc?e.valueprc.toFixed(2):"—"),1),s("td",i6,v(e.value?e.value.toFixed(2):"—"),1)]))),128))])]),_.value.coupon_schedule.length>6?(w(),i("button",{key:0,class:"btn-show-more",onClick:t[26]||(t[26]=e=>D.value=!D.value)},v(D.value?"Свернуть":`Показать все (${_.value.coupon_schedule.length})`),1)):l("",!0)])])):l("",!0),_.value.amortization_schedule?.length?(w(),i("div",o6,[s("div",s6,[t[87]||(t[87]=s("h3",null,"График амортизации",-1)),s("span",l6,v(_.value.amortization_schedule.length)+" выплат",1)]),s("div",c6,[s("table",u6,[t[88]||(t[88]=s("thead",null,[s("tr",null,[s("th",null,"Дата"),s("th",null,"% от номинала"),s("th",null,"Сумма, руб.")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(_.value.amortization_schedule,(e,t)=>(w(),i("tr",{key:t},[s("td",d6,v(X(e.date)),1),s("td",h6,v(e.valueprc?e.valueprc.toFixed(2)+"%":"—"),1),s("td",p6,v(e.value?e.value.toFixed(2):"—"),1)]))),128))])])])])):l("",!0),s("div",f6,[t[89]||(t[89]=s("div",{class:"card-header"},[s("h3",null,"Корпоративные события")],-1)),_.value.corporate_events?.length?(w(),i("div",m6,[(w(!0),i(p,null,f(_.value.corporate_events,(e,t)=>(w(),i("div",{key:t,class:"event-item"},[s("span",v6,v(X(e.date)),1),s("span",g6,v(e.description),1)]))),128))])):(w(),i("p",y6,"Нет данных о корпоративных событиях"))])])):(w(),i("section",y5,[...t[32]||(t[32]=[s("div",{class:"glass-card"},"Введите ISIN для генерации отчёта",-1)])]))]))}}),x6=xe(b6,[["__scopeId","data-v-cbb82b13"]]),w6={class:"page-container center-content"},_6={class:"not-found-card"},S6={class:"content-wrapper"},M6={class:"actions"},T6={class:"suggestions"},k6={class:"links-row"},C6=e({__name:"NotFound",setup(e){const t=()=>{window.history.back()};return(e,a)=>{const n=d("router-link");return w(),i("div",w6,[s("div",_6,[s("div",S6,[a[6]||(a[6]=I('<div class="error-code-container" data-v-f9cd484d><span class="error-code font-anton" data-v-f9cd484d>404</span><div class="scan-line" data-v-f9cd484d></div></div><h1 class="error-title font-oswald" data-v-f9cd484d>СТРАНИЦА НЕ НАЙДЕНА</h1><p class="error-desc font-mono" data-v-f9cd484d> Похоже, вы вышли за пределы известной вселенной или доступных данных. </p>',3)),s("div",M6,[u(n,{to:"/",class:"btn btn-primary"},{default:h(()=>[...a[0]||(a[0]=[s("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),m(" Вернуться на Дашборд ",-1)])]),_:1}),s("button",{onClick:t,class:"btn btn-secondary"},[...a[1]||(a[1]=[s("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),m(" Назад ",-1)])])]),a[7]||(a[7]=s("div",{class:"divider"},null,-1)),s("div",T6,[a[5]||(a[5]=s("span",{class:"suggestions-lbl font-mono"},"БЫСТРЫЙ ПЕРЕХОД:",-1)),s("div",k6,[u(n,{to:"/risk-metrics",class:"link-pill"},{default:h(()=>[...a[2]||(a[2]=[m("Риск-метрики",-1)])]),_:1}),u(n,{to:"/monte-carlo",class:"link-pill"},{default:h(()=>[...a[3]||(a[3]=[m("Монте-Карло",-1)])]),_:1}),u(n,{to:"/stress-testing",class:"link-pill"},{default:h(()=>[...a[4]||(a[4]=[m("Стресс-тесты",-1)])]),_:1})])])])])])}}}),A6=xe(C6,[["__scopeId","data-v-f9cd484d"]]),E6=async(e,t="option")=>{try{const a=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/database/export/registry/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registry_type:t,data:e})});if(!a.ok){const e=await a.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${a.status}`)}return await a.json()}catch(QXe){throw console.error("Save Registry to Parquet Failed:",QXe),QXe}},I6={class:"page-container custom-scroll"},R6={class:"section-header"},D6={class:"header-actions"},P6={class:"header-controls"},L6={class:"control-group"},N6={class:"glass-pill status-pill"},O6={class:"status-label"},F6={class:"text-white"},B6={key:0,class:"glass-card full-width",style:{"margin-bottom":"24px",background:"rgba(239, 68, 68, 0.1)","border-color":"rgba(239, 68, 68, 0.3)"}},U6={style:{padding:"12px",color:"rgba(239, 68, 68, 0.9)","font-size":"13px"}},z6={key:1,class:"glass-card full-width",style:{"margin-bottom":"24px"}},V6={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},H6={class:"card-subtitle"},G6={style:{display:"flex",gap:"8px"}},W6=["disabled"],q6={key:0},Y6={key:1},j6=["disabled"],X6=["disabled"],$6={key:0},K6={key:1},Z6={class:"scenario-table-container"},J6={class:"scenario-table"},Q6={key:0},e8={key:1},t8=["onClick"],a8={class:"mono"},n8={class:"mono"},r8={class:"mono"},i8={class:"mono"},o8={class:"mono"},s8={class:"mono"},l8={key:0,class:"mono accent"},c8={key:1,class:"mono"},u8=["onClick"],d8={class:"dashboard-grid"},h8={class:"left-panel"},p8={class:"glass-card panel"},f8={class:"controls-form"},m8={class:"input-group"},v8={class:"select-selected"},g8={class:"select-icon icon-asset"},y8={class:"select-text"},b8={key:0,class:"select-options"},x8=["onClick"],w8={class:"option-icon icon-asset"},_8={style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},S8={class:"option-text"},M8={key:0,class:"option-subtext"},T8={key:0,class:"option-badge"},k8={class:"input-group"},C8={class:"input-group"},A8={class:"input-group"},E8={class:"input-group"},I8={class:"input-group"},R8={class:"input-group"},D8={class:"input-group"},P8={class:"input-group"},L8={class:"input-group"},N8={class:"select-selected"},O8={class:"select-text"},F8={key:0,class:"select-options"},B8=["onClick"],U8={style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},z8={class:"option-text"},V8={class:"option-subtext"},H8={key:0,class:"option-badge"},G8={class:"input-group"},W8={class:"select-selected"},q8={class:"select-text"},Y8={key:0,class:"select-options"},j8={key:0,class:"option-badge"},X8={key:0,class:"option-badge"},$8={class:"input-group"},K8={class:"select-selected"},Z8={class:"select-text"},J8={key:0,class:"select-options"},Q8={key:0,class:"option-badge"},e7={key:0,class:"option-badge"},t7={key:0,class:"option-badge"},a7={key:0,class:"option-badge"},n7={key:0,class:"option-badge"},r7={key:0,class:"option-badge"},i7={class:"main-panel"},o7={key:0,class:"glass-card chart-card"},s7={class:"stats-list"},l7={class:"stat-item price-highlight"},c7={class:"val mono",style:{"font-size":"16px",color:"#3b82f6"}},u7={class:"stat-item"},d7={class:"val mono"},h7={class:"stat-item"},p7={class:"val mono"},f7={class:"stat-item"},m7={class:"val mono"},v7={class:"stat-item"},g7={class:"stat-item"},y7={class:"val mono"},b7={class:"glass-card chart-card"},x7={key:0,class:"decomposition-grid"},w7={class:"decomp-item"},_7={class:"decomp-value"},S7={class:"decomp-percent"},M7={class:"decomp-item"},T7={class:"decomp-value"},k7={class:"decomp-percent"},C7={class:"decomp-item"},A7={class:"decomp-value"},E7={key:1,class:"empty-state"},I7={class:"glass-card chart-card mt-4"},R7={key:0,class:"sensitivity-table"},D7={class:"data-table"},P7={class:"row-header"},L7={key:1,class:"empty-state"},N7={class:"glass-card chart-card mt-4"},O7={class:"chart-container"},F7={key:0,viewBox:"0 0 800 300",preserveAspectRatio:"none",class:"payoff-svg"},B7=["x1","x2"],U7=["x1","x2"],z7=["points"],V7=["cx","cy"],H7={key:1,class:"empty-state"},G7={class:"help-modal-header"},W7=e({__name:"OptionPricing",setup(e){const r=a({S:100,K:100,r:5,sigma:20,T:.25,q:0,optionType:"call",model:"bsm",exerciseStyle:"european",asset:"stock",valuationDate:(new Date).toISOString().split("T")[0],expirationDate:new Date(Date.now()+7776e6).toISOString().split("T")[0]}),o=t(null),d=t([]),g=t(null),y=t([]),b=t(!1),x=t(!1),_=t(""),C=t(!1),A=t(!1),I=t(!1),R=t(!1),D=t(!1),P=[{value:"stock",label:"Акция",icon:"S",description:"Обыкновенная акция"},{value:"index",label:"Индекс",icon:"I",description:"Индексный опцион"},{value:"currency",label:"Валюта",icon:"FX",description:"Валютная пара"},{value:"commodity",label:"Товар",icon:"C",description:"Сырьевой товар"},{value:"crypto",label:"Криптовалюта",icon:"CR",description:"Криптоактив"},{value:"bond",label:"Облигация",icon:"B",description:"Облигационный опцион"}],L=e=>{const t=P.find(t=>t.value===e);return t?.icon||"S"},N=e=>{const t=P.find(t=>t.value===e);return t?.label||"Акция"},O=[{value:"european",label:"Европейский",icon:"EU",iconClass:"icon-european",description:"Исполнение только в дату экспирации"},{value:"american",label:"Американский",icon:"US",iconClass:"icon-american",description:"Исполнение в любой момент до экспирации"},{value:"bermudan",label:"Бермудский",icon:"BM",iconClass:"icon-bermudan",description:"Исполнение в определенные даты до экспирации"},{value:"asian",label:"Азиатский",icon:"AS",iconClass:"icon-asian",description:"Цена основана на средней цене актива"},{value:"barrier",label:"Барьерный",icon:"BR",iconClass:"icon-barrier",description:"Опцион с триггерами активации/деактивации"},{value:"digital",label:"Дигитальный",icon:"DG",iconClass:"icon-digital",description:"Фиксированная выплата при исполнении"},{value:"lookback",label:"Lookback",icon:"LB",iconClass:"icon-lookback",description:"Исполнение по лучшей цене за период"},{value:"knockout",label:"Knock-out",icon:"KO",iconClass:"icon-knockout",description:"Аннулируется при достижении барьера"}],F=e=>{const t=O.find(t=>t.value===e);return t?.label||"Европейский"},B=e=>{const t=O.find(t=>t.value===e);return t?.icon||"EU"},U=e=>{const t=O.find(t=>t.value===e);return t?.iconClass||"icon-european"},V=a({price:null,delta:null,gamma:null,vega:null,theta:null,rho:null,intrinsicValue:null,timeValue:null}),H=t([]),G=t([]),W=e=>Math.exp(-.5*e*e)/Math.sqrt(2*Math.PI),q=e=>{const t=e<0?-1:1,a=Math.abs(e)/Math.sqrt(2),n=1/(1+.3275911*a);return.5*(1+t*(1-(1.061405429*Math.pow(n,5)+-1.453152027*Math.pow(n,4)+1.421413741*Math.pow(n,3)+-.284496736*Math.pow(n,2)+.254829592*n)*Math.exp(-a*a)))},Y=(e,t,a,n,r,i,o)=>{if(n<=0||r<=0)return 0;const s=(Math.log(e/t)+(a-i+.5*n*n)*r)/(n*Math.sqrt(r)),l=s-n*Math.sqrt(r);return"call"===o?e*Math.exp(-i*r)*q(s)-t*Math.exp(-a*r)*q(l):t*Math.exp(-a*r)*q(-l)-e*Math.exp(-i*r)*q(-s)},j=()=>{const e=r.S,t=r.K,a=r.r/100,n=r.sigma/100,i=r.T,o=r.q/100;if(e<=0||t<=0||i<=0||n<=0)return V.price=null,V.delta=null,V.gamma=null,V.vega=null,V.theta=null,V.rho=null,H.value=[],void(G.value=[]);const s=(Math.log(e/t)+(a-o+.5*n*n)*i)/(n*Math.sqrt(i)),l=s-n*Math.sqrt(i),c=q(s),u=q(l),d=q(-s),h=q(-l),p=W(s);let f;"call"===r.optionType?(f=e*Math.exp(-o*i)*c-t*Math.exp(-a*i)*u,V.delta=Math.exp(-o*i)*c):(f=t*Math.exp(-a*i)*h-e*Math.exp(-o*i)*d,V.delta=-Math.exp(-o*i)*d),V.gamma=Math.exp(-o*i)*p/(e*n*Math.sqrt(i)),V.vega=e*Math.exp(-o*i)*p*Math.sqrt(i)/100,V.rho=("call"===r.optionType?t*i*Math.exp(-a*i)*u:-t*i*Math.exp(-a*i)*h)/100,"call"===r.optionType?V.theta=(-e*Math.exp(-o*i)*p*n/(2*Math.sqrt(i))+o*e*Math.exp(-o*i)*c-a*t*Math.exp(-a*i)*u)/365:V.theta=(-e*Math.exp(-o*i)*p*n/(2*Math.sqrt(i))-o*e*Math.exp(-o*i)*d+a*t*Math.exp(-a*i)*h)/365,V.price=f,"call"===r.optionType?V.intrinsicValue=Math.max(e-t,0):V.intrinsicValue=Math.max(t-e,0),V.timeValue=Math.max(f-V.intrinsicValue,0);const m=[-5,-2.5,0,2.5,5];H.value=[-20,-10,0,10,20].map(s=>m.map(l=>Y(e*(1+s/100),t,a,n+l/100,i,o,r.optionType))),G.value=[];const v=.5*t,g=1.5*t;for(let y=v;y<=g;y+=(g-v)/50){let e=0;e="call"===r.optionType?Math.max(y-t,0):Math.max(t-y,0),G.value.push(e)}},X=S(()=>{if(!G.value.length)return"";r.K,r.K;const e=Math.max(...G.value);return G.value.map((t,a)=>`${a/G.value.length*800},${300-t/(e||1)*250-25}`).join(" ")}),$=S(()=>{const e=.5*r.K,t=1.5*r.K;return(r.K-e)/(t-e)*800}),K=S(()=>{const e=.5*r.K,t=1.5*r.K;return(r.S-e)/(t-e)*800}),Z=S(()=>{if(!G.value.length)return 0;const e=Math.max(...G.value);let t=0;return t="call"===r.optionType?Math.max(r.S-r.K,0):Math.max(r.K-r.S,0),300-t/(e||1)*250-25}),J=()=>{if(r.valuationDate&&r.expirationDate){const e=new Date(r.valuationDate),t=(new Date(r.expirationDate).getTime()-e.getTime())/864e5;r.T=t/365,r.T>0&&j()}},Q=async e=>{const t=e.target,a=t.files?.[0];if(a)try{const e=pj(await a.arrayBuffer(),{type:"array"}),t=e.SheetNames[0],n=e.Sheets[t],i=Rj.sheet_to_json(n,{raw:!1}),o=[];for(const a of i){const e={S:parseFloat(a.Spot||a.S||a.s||a["Спот"]||"0"),K:parseFloat(a.Strike||a.K||a.k||a["Страйк"]||"0"),r:parseFloat(a.Rate||a.r||a["Ставка"]||a["Безрисковая ставка"]||"5"),sigma:parseFloat(a.Volatility||a.Vol||a.sigma||a["Волатильность"]||a["σ"]||"20"),q:parseFloat(a.Dividend||a.q||a["Дивиденды"]||a["Див. доходность"]||"0"),optionType:(a.Type||a.type||a["Тип"]||"call").toLowerCase(),model:(a.Model||a.model||a["Модель"]||"bsm").toLowerCase()};if(e.valuationDate=a["Valuation Date"]||a.valuation_date||a["Дата оценки"]||r.valuationDate,e.expirationDate=a["Expiration Date"]||a.expiration_date||a["Дата экспирации"]||a.Expiry||"",e.expirationDate&&e.valuationDate){const t=new Date(e.valuationDate),a=(new Date(e.expirationDate).getTime()-t.getTime())/864e5;e.T=a/365}else e.T=parseFloat(a.Time||a.T||a.t||a["Время"]||a["Time to Maturity"]||"0.25");"call"!==e.optionType&&"put"!==e.optionType&&(e.optionType=e.optionType.includes("call")||e.optionType.includes("колл")?"call":"put"),"bsm"!==e.model&&"heston"!==e.model&&(e.model=e.model.includes("bs")||e.model.includes("black")?"bsm":"heston"),e.S>0&&e.K>0&&e.T>0&&o.push(e)}d.value=o,g.value=null,y.value=[]}catch(n){console.error("Excel parsing error:",n),alert(`Ошибка при загрузке файла: ${n.message}`)}},ee=async()=>{b.value=!0,y.value=[];try{for(let t=0;t<d.value.length;t++){const a=d.value[t],n=a.S,r=a.K,i=a.r/100,o=a.sigma/100,s=a.T,l=a.q/100,c=a.optionType;try{const e=Y(n,r,i,o,s,l,c),t=(Math.log(n/r)+(i-l+.5*o*o)*s)/(o*Math.sqrt(s)),a=t-o*Math.sqrt(s),u=q(t),d=q(a),h=q(-t),p=q(-a),f=W(t);let m,v,g;"call"===c?(m=Math.exp(-l*s)*u,v=(-n*Math.exp(-l*s)*f*o/(2*Math.sqrt(s))+l*n*Math.exp(-l*s)*u-i*r*Math.exp(-i*s)*d)/365,g=r*s*Math.exp(-i*s)*d/100):(m=-Math.exp(-l*s)*h,v=(-n*Math.exp(-l*s)*f*o/(2*Math.sqrt(s))-l*n*Math.exp(-l*s)*h+i*r*Math.exp(-i*s)*p)/365,g=-r*s*Math.exp(-i*s)*p/100),y.value.push({price:e,delta:m,gamma:Math.exp(-l*s)*f/(n*o*Math.sqrt(s)),vega:n*Math.exp(-l*s)*f*Math.sqrt(s)/100,theta:v,rho:g})}catch(e){y.value.push({price:0,delta:0,gamma:0,vega:0}),console.error(`Error calculating option ${t+1}:`,e)}}}catch(e){console.error("Error calculating options:",e),alert(`Ошибка при расчете опционов: ${e.message}`)}finally{b.value=!1}},te=()=>{if(0===d.value.length)return void alert("Нет данных для экспорта. Загрузите реестр опционов.");if(!(y.value.length>0&&y.value.some(e=>e&&null!==e.price&&void 0!==e.price))){if(!confirm("Опционы еще не рассчитаны. Экспортировать только входные параметры?"))return}const e=d.value.map((e,t)=>{const a=y.value[t],n=e.S||0,r=e.K||0,i=a?.price||null,o=n>0&&r>0?n/r:null,s=null!==i?"call"===e.optionType?Math.max(n-r,0):Math.max(r-n,0):null,l=null!==i&&null!==s?Math.max(i-s,0):null;return{"№":t+1,"Тип":"call"===e.optionType?"Call":"Put","Модель":"bsm"===e.model?"Black-Scholes":"heston"===e.model?"Heston":"merton"===e.model?"Merton":"bates"===e.model?"Bates":"sabr"===e.model?"SABR":"vg"===e.model?"Variance Gamma":e.model,"Spot (S)":n,"Strike (K)":r,"Moneyness (S/K)":null!==o?o.toFixed(4):"","Статус":null!==o?o>1?"ITM":o<1?"OTM":"ATM":"","Волатильность (σ, %)":e.sigma||0,"Безрисковая ставка (r, %)":e.r||0,"Дивидендная доходность (q, %)":e.q||0,"Время до экспирации (T, лет)":e.T||0,"Дата оценки":e.valuationDate||"","Дата экспирации":e.expirationDate||"","Цена опциона":null!==i?i.toFixed(6):"","Внутренняя стоимость":null!==s?s.toFixed(6):"","Временная стоимость":null!==l?l.toFixed(6):"","Дельта (Δ)":null!=a?.delta?a.delta.toFixed(6):"","Гамма (Γ)":null!=a?.gamma?a.gamma.toFixed(6):"","Вега (ν)":null!=a?.vega?a.vega.toFixed(6):"","Тета (Θ)":null!=a?.theta?a.theta.toFixed(6):"","Ро (ρ)":null!=a?.rho?a.rho.toFixed(6):""}}),t=Rj.json_to_sheet(e);t["!cols"]=[{wch:5},{wch:8},{wch:15},{wch:12},{wch:12},{wch:12},{wch:8},{wch:18},{wch:20},{wch:22},{wch:22},{wch:12},{wch:18},{wch:15},{wch:20},{wch:20},{wch:12},{wch:12},{wch:12},{wch:12},{wch:12}];const a=Rj.book_new();Rj.book_append_sheet(a,t,"Реестр опционов");const n=new Date,r=`реестр_опционов_${n.toISOString().split("T")[0]}_${n.toTimeString().split(" ")[0].replace(/:/g,"-")}.xlsx`;try{bj(a,r),alert(`Реестр успешно экспортирован: ${r}`)}catch(i){console.error("Ошибка при экспорте:",i),alert(`Ошибка при экспорте файла: ${i.message}`)}},ae=async()=>{if(0!==d.value.length){x.value=!0,_.value="";try{const e=await E6(d.value);e.success&&(_.value=`Реестр успешно сохранен: ${e.data.file_name}`,setTimeout(()=>{_.value=""},5e3))}catch(e){console.error("Error saving registry to parquet:",e),_.value=`Ошибка при сохранении реестра: ${e.message}`}finally{x.value=!1}}},ne=()=>{d.value=[],g.value=null,y.value=[],o.value&&(o.value.value="")},re=()=>{C.value=!C.value,C.value&&(A.value=!1,I.value=!1,R.value=!1)},ie=()=>{A.value=!A.value,A.value&&(C.value=!1,I.value=!1,R.value=!1)},oe=()=>{I.value=!I.value,I.value&&(C.value=!1,A.value=!1,R.value=!1)},se=()=>{R.value=!R.value,R.value&&(C.value=!1,A.value=!1,I.value=!1)},le=e=>{r.optionType=e,C.value=!1,j()},ce=e=>{r.model=e,A.value=!1,j()},ue=e=>{e.target.closest(".custom-select-wrapper")||(C.value=!1,A.value=!1,I.value=!1,R.value=!1)};return n(()=>{J(),j(),document.addEventListener("click",ue)}),z(()=>{document.removeEventListener("click",ue)}),(e,t)=>(w(),i("div",I6,[s("div",R6,[t[23]||(t[23]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Справедливая стоимость опционов"),s("p",{class:"section-subtitle"},"Black-Scholes, модель Хестона, процессы Леви, FFT-ценообразование")],-1)),s("div",D6,[s("div",P6,[s("div",L6,[t[21]||(t[21]=s("label",{class:"control-label"},"Реестр:",-1)),s("input",{type:"file",ref_key:"fileInputRef",ref:o,onChange:Q,accept:".xlsx,.xls",style:{display:"none"},id:"excel-upload"},null,544),s("button",{onClick:t[0]||(t[0]=()=>{o.value&&o.value.click()}),class:"btn-secondary",title:"Загрузить реестр опционов из Excel"}," Загрузить Excel ")])]),s("div",N6,[s("span",{class:c(["dot","call"===r.optionType?"bg-green":"bg-red"])},null,2),s("span",O6,[t[22]||(t[22]=m("Модель: ",-1)),s("b",F6,v("bsm"===r.model?"Black-Scholes":"Heston"),1)])]),s("button",{onClick:t[1]||(t[1]=e=>D.value=!0),class:"btn-secondary",style:{"font-size":"11px",padding:"6px 12px"},title:"Справка по моделям ценообразования"}," 📖 Справка ")])]),_.value?(w(),i("div",B6,[s("div",U6,v(_.value),1)])):l("",!0),d.value.length>0?(w(),i("div",z6,[s("div",V6,[s("div",null,[t[24]||(t[24]=s("h3",null,"Реестр опционов",-1)),s("span",H6,"Загружено опционов: "+v(d.value.length),1)]),s("div",G6,[s("button",{onClick:ee,class:"btn-secondary",disabled:b.value,style:{"font-size":"11px",padding:"6px 12px"}},[b.value?(w(),i("span",Y6,"↺ Считаю...")):(w(),i("span",q6,"Рассчитать все"))],8,W6),s("button",{onClick:te,class:"btn-secondary",disabled:0===d.value.length,style:{"font-size":"11px",padding:"6px 12px"},title:"Выгрузить реестр в Excel (включая все греки и расчеты)"}," 📥 Выгрузить Excel ",8,j6),s("button",{onClick:ae,class:"btn-secondary",disabled:0===d.value.length||x.value,style:{"font-size":"11px",padding:"6px 12px"},title:"Сохранить реестр в Parquet"},[x.value?(w(),i("span",K6,"↺ Сохранение...")):(w(),i("span",$6,"💾 Сохранить в DB"))],8,X6),s("button",{onClick:ne,class:"btn-secondary",style:{"font-size":"11px",padding:"6px 12px",background:"rgba(239, 68, 68, 0.2)","border-color":"rgba(239, 68, 68, 0.3)"}}," ✕ Очистить ")])]),s("div",Z6,[s("table",J6,[s("thead",null,[s("tr",null,[t[25]||(t[25]=s("th",null,"№",-1)),t[26]||(t[26]=s("th",null,"Тип",-1)),t[27]||(t[27]=s("th",null,"Spot (S)",-1)),t[28]||(t[28]=s("th",null,"Strike (K)",-1)),t[29]||(t[29]=s("th",null,"Волатильность (σ)",-1)),t[30]||(t[30]=s("th",null,"Ставка (r)",-1)),t[31]||(t[31]=s("th",null,"Время (T)",-1)),t[32]||(t[32]=s("th",null,"Дата экспирации",-1)),y.value.length>0?(w(),i("th",Q6,"Цена")):l("",!0),y.value.length>0?(w(),i("th",e8,"Дельта")):l("",!0),t[33]||(t[33]=s("th",null,"Действие",-1))])]),s("tbody",null,[(w(!0),i(p,null,f(d.value,(e,t)=>(w(),i("tr",{key:t,class:c({selected:g.value===t}),onClick:e=>(e=>{g.value=e})(t)},[s("td",null,v(t+1),1),s("td",null,v("call"===e.optionType?"Call":"Put"),1),s("td",a8,v(e.S?e.S.toFixed(2):"-"),1),s("td",n8,v(e.K?e.K.toFixed(2):"-"),1),s("td",r8,v(e.sigma?e.sigma.toFixed(2)+"%":"-"),1),s("td",i8,v(e.r?e.r.toFixed(2)+"%":"-"),1),s("td",o8,v(e.T?e.T.toFixed(4):"-"),1),s("td",s8,v(e.expirationDate||"-"),1),y.value.length>0&&y.value[t]?(w(),i("td",l8,v(y.value[t]?.price?y.value[t].price.toFixed(4):"-"),1)):l("",!0),y.value.length>0&&y.value[t]?(w(),i("td",c8,v(y.value[t]?.delta?y.value[t].delta.toFixed(4):"-"),1)):l("",!0),s("td",null,[s("button",{onClick:E(e=>(e=>{const t=d.value[e];t&&(r.S=t.S||r.S,r.K=t.K||r.K,r.r=t.r||r.r,r.sigma=t.sigma||r.sigma,r.T=t.T||r.T,r.q=t.q||r.q,r.optionType=t.optionType||r.optionType,r.model=t.model||r.model,r.valuationDate=t.valuationDate||r.valuationDate,r.expirationDate=t.expirationDate||r.expirationDate,setTimeout(()=>{j()},100))})(t),["stop"]),class:"btn-small",title:"Загрузить в форму"}," Загрузить ",8,u8)])],10,t8))),128))])])])])):l("",!0),s("div",d8,[s("aside",h8,[s("div",p8,[t[66]||(t[66]=s("div",{class:"panel-header"},[s("h3",null,"Входные параметры")],-1)),s("div",f8,[s("div",m8,[t[35]||(t[35]=s("label",{class:"lbl"},"Актив",-1)),s("div",{class:"custom-select-wrapper",onClick:oe},[s("div",{class:c(["custom-select",{open:I.value}])},[s("div",v8,[s("span",g8,v(L(r.asset)),1),s("span",y8,v(N(r.asset)),1),t[34]||(t[34]=s("svg",{class:"select-arrow",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"6 9 12 15 18 9"})],-1))]),u(M,{name:"dropdown"},{default:h(()=>[I.value?(w(),i("div",b8,[(w(),i(p,null,f(P,e=>s("div",{key:e.value,class:c(["select-option",{selected:r.asset===e.value}]),onClick:E(t=>(e=>{r.asset=e,I.value=!1,j()})(e.value),["stop"])},[s("span",w8,v(e.icon),1),s("div",_8,[s("span",S8,v(e.label),1),e.description?(w(),i("span",M8,v(e.description),1)):l("",!0)]),r.asset===e.value?(w(),i("span",T8,"✓")):l("",!0)],10,x8)),64))])):l("",!0)]),_:1})],2)])]),s("div",k8,[t[36]||(t[36]=s("label",{class:"lbl"},"S (Spot)",-1)),T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.S=e),type:"number",step:"0.01",class:"glass-input",onChange:j},null,544),[[k,r.S,void 0,{number:!0}]])]),s("div",C8,[t[37]||(t[37]=s("label",{class:"lbl"},"K (Strike)",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.K=e),type:"number",step:"0.01",class:"glass-input",onChange:j},null,544),[[k,r.K,void 0,{number:!0}]])]),s("div",A8,[t[38]||(t[38]=s("label",{class:"lbl"},"r (Rate), %",-1)),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.r=e),type:"number",step:"0.01",class:"glass-input",onChange:j},null,544),[[k,r.r,void 0,{number:!0}]])]),s("div",E8,[t[39]||(t[39]=s("label",{class:"lbl"},"σ (Vol), %",-1)),T(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.sigma=e),type:"number",step:"0.01",class:"glass-input",onChange:j},null,544),[[k,r.sigma,void 0,{number:!0}]])]),s("div",I8,[t[40]||(t[40]=s("label",{class:"lbl"},"Дата оценки",-1)),T(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>r.valuationDate=e),type:"date",class:"glass-input",onChange:J},null,544),[[k,r.valuationDate]])]),s("div",R8,[t[41]||(t[41]=s("label",{class:"lbl"},"Дата экспирации",-1)),T(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>r.expirationDate=e),type:"date",class:"glass-input",onChange:J},null,544),[[k,r.expirationDate]])]),s("div",D8,[t[42]||(t[42]=s("label",{class:"lbl"},"T (Time), лет",-1)),T(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>r.T=e),type:"number",step:"0.01",min:"0.001",class:"glass-input",onChange:j},null,544),[[k,r.T,void 0,{number:!0}]])]),s("div",P8,[t[43]||(t[43]=s("label",{class:"lbl"},"q (Див. доходность), %",-1)),T(s("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>r.q=e),type:"number",step:"0.01",class:"glass-input",onChange:j},null,544),[[k,r.q,void 0,{number:!0}]])]),s("div",L8,[t[45]||(t[45]=s("label",{class:"lbl"},"Стиль исполнения",-1)),s("div",{class:"custom-select-wrapper",onClick:se},[s("div",{class:c(["custom-select",{open:R.value}])},[s("div",N8,[s("span",{class:c(["select-icon",U(r.exerciseStyle)])},v(B(r.exerciseStyle)),3),s("span",O8,v(F(r.exerciseStyle)),1),t[44]||(t[44]=s("svg",{class:"select-arrow",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"6 9 12 15 18 9"})],-1))]),u(M,{name:"dropdown"},{default:h(()=>[R.value?(w(),i("div",F8,[(w(),i(p,null,f(O,e=>s("div",{key:e.value,class:c(["select-option",{selected:r.exerciseStyle===e.value}]),onClick:E(t=>(e=>{r.exerciseStyle=e,R.value=!1,j()})(e.value),["stop"])},[s("span",{class:c(["option-icon",e.iconClass])},v(e.icon),3),s("div",U8,[s("span",z8,v(e.label),1),s("span",V8,v(e.description),1)]),r.exerciseStyle===e.value?(w(),i("span",H8,"✓")):l("",!0)],10,B8)),64))])):l("",!0)]),_:1})],2)])]),s("div",G8,[t[51]||(t[51]=s("label",{class:"lbl"},"Тип опциона",-1)),s("div",{class:"custom-select-wrapper",onClick:re},[s("div",{class:c(["custom-select",{open:C.value}])},[s("div",W8,[s("span",{class:c(["select-icon","call"===r.optionType?"icon-call":"icon-put"])},v("call"===r.optionType?"↑":"↓"),3),s("span",q8,v("call"===r.optionType?"Call":"Put"),1),t[46]||(t[46]=s("svg",{class:"select-arrow",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"6 9 12 15 18 9"})],-1))]),u(M,{name:"dropdown"},{default:h(()=>[C.value?(w(),i("div",Y8,[s("div",{class:c(["select-option",{selected:"call"===r.optionType}]),onClick:t[10]||(t[10]=E(e=>le("call"),["stop"]))},[t[47]||(t[47]=s("span",{class:"option-icon icon-call"},"↑",-1)),t[48]||(t[48]=s("span",{class:"option-text"},"Call",-1)),"call"===r.optionType?(w(),i("span",j8,"✓")):l("",!0)],2),s("div",{class:c(["select-option",{selected:"put"===r.optionType}]),onClick:t[11]||(t[11]=E(e=>le("put"),["stop"]))},[t[49]||(t[49]=s("span",{class:"option-icon icon-put"},"↓",-1)),t[50]||(t[50]=s("span",{class:"option-text"},"Put",-1)),"put"===r.optionType?(w(),i("span",X8,"✓")):l("",!0)],2)])):l("",!0)]),_:1})],2)])]),s("div",$8,[t[65]||(t[65]=s("label",{class:"lbl"},"Модель",-1)),s("div",{class:"custom-select-wrapper",onClick:ie},[s("div",{class:c(["custom-select",{open:A.value}])},[s("div",K8,[s("span",{class:c(["select-icon","bsm"===r.model?"icon-bsm":"icon-heston"])},v("bsm"===r.model?"BS":"H"),3),s("span",Z8,v("bsm"===r.model?"Black-Scholes":"Heston"),1),t[52]||(t[52]=s("svg",{class:"select-arrow",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"6 9 12 15 18 9"})],-1))]),u(M,{name:"dropdown"},{default:h(()=>[A.value?(w(),i("div",J8,[s("div",{class:c(["select-option",{selected:"bsm"===r.model}]),onClick:t[12]||(t[12]=E(e=>ce("bsm"),["stop"]))},[t[53]||(t[53]=s("span",{class:"option-icon icon-bsm"},"BS",-1)),t[54]||(t[54]=s("div",{style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},[s("span",{class:"option-text"},"Black-Scholes"),s("span",{class:"option-subtext"},"BSM")],-1)),"bsm"===r.model?(w(),i("span",Q8,"✓")):l("",!0)],2),s("div",{class:c(["select-option",{selected:"heston"===r.model}]),onClick:t[13]||(t[13]=E(e=>ce("heston"),["stop"]))},[t[55]||(t[55]=s("span",{class:"option-icon icon-heston"},"H",-1)),t[56]||(t[56]=s("div",{style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},[s("span",{class:"option-text"},"Heston"),s("span",{class:"option-subtext"},"Stochastic Volatility")],-1)),"heston"===r.model?(w(),i("span",e7,"✓")):l("",!0)],2),s("div",{class:c(["select-option",{selected:"merton"===r.model}]),onClick:t[14]||(t[14]=E(e=>ce("merton"),["stop"]))},[t[57]||(t[57]=s("span",{class:"option-icon icon-merton"},"M",-1)),t[58]||(t[58]=s("div",{style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},[s("span",{class:"option-text"},"Merton"),s("span",{class:"option-subtext"},"Jump Diffusion")],-1)),"merton"===r.model?(w(),i("span",t7,"✓")):l("",!0)],2),s("div",{class:c(["select-option",{selected:"bates"===r.model}]),onClick:t[15]||(t[15]=E(e=>ce("bates"),["stop"]))},[t[59]||(t[59]=s("span",{class:"option-icon icon-bates"},"B",-1)),t[60]||(t[60]=s("div",{style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},[s("span",{class:"option-text"},"Bates"),s("span",{class:"option-subtext"},"Heston + Jumps")],-1)),"bates"===r.model?(w(),i("span",a7,"✓")):l("",!0)],2),s("div",{class:c(["select-option",{selected:"sabr"===r.model}]),onClick:t[16]||(t[16]=E(e=>ce("sabr"),["stop"]))},[t[61]||(t[61]=s("span",{class:"option-icon icon-sabr"},"S",-1)),t[62]||(t[62]=s("div",{style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},[s("span",{class:"option-text"},"SABR"),s("span",{class:"option-subtext"},"Stochastic Alpha Beta Rho")],-1)),"sabr"===r.model?(w(),i("span",n7,"✓")):l("",!0)],2),s("div",{class:c(["select-option",{selected:"vg"===r.model}]),onClick:t[17]||(t[17]=E(e=>ce("vg"),["stop"]))},[t[63]||(t[63]=s("span",{class:"option-icon icon-vg"},"VG",-1)),t[64]||(t[64]=s("div",{style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},[s("span",{class:"option-text"},"Variance Gamma"),s("span",{class:"option-subtext"},"VG Process")],-1)),"vg"===r.model?(w(),i("span",r7,"✓")):l("",!0)],2)])):l("",!0)]),_:1})],2)])])])])]),s("main",i7,[u(M,{name:"fade"},{default:h(()=>[null!==V.price?(w(),i("div",o7,[t[74]||(t[74]=s("div",{class:"chart-header"},[s("h3",null,"Цена и греки")],-1)),s("div",s7,[s("div",l7,[t[67]||(t[67]=s("div",{class:"stat-head"},[s("span",{class:"stat-icon"}),s("span",{class:"s-name"},"Цена опциона")],-1)),s("span",c7,v(V.price.toFixed(4)),1)]),t[73]||(t[73]=s("div",{class:"divider"},null,-1)),s("div",u7,[t[68]||(t[68]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"Δ"),s("span",{class:"s-name"},"Дельта")],-1)),s("span",d7,v(V.delta?.toFixed(4)),1)]),s("div",h7,[t[69]||(t[69]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"Γ"),s("span",{class:"s-name"},"Гамма")],-1)),s("span",p7,v(V.gamma?.toFixed(6)),1)]),s("div",f7,[t[70]||(t[70]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"ν"),s("span",{class:"s-name"},"Вега")],-1)),s("span",m7,v(V.vega?.toFixed(4)),1)]),s("div",v7,[t[71]||(t[71]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"Θ"),s("span",{class:"s-name"},"Тета")],-1)),s("span",{class:c(["val mono",(V.theta||0)<0?"text-red":"text-green"])},v(V.theta?.toFixed(4)||"0.0000"),3)]),s("div",g7,[t[72]||(t[72]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"ρ"),s("span",{class:"s-name"},"Ро")],-1)),s("span",y7,v(V.rho?.toFixed(4)),1)])])])):l("",!0)]),_:1}),s("div",b7,[t[79]||(t[79]=s("div",{class:"chart-header"},[s("h3",null,"Декомпозиция стоимости")],-1)),null!==V.price?(w(),i("div",x7,[s("div",w7,[t[75]||(t[75]=s("div",{class:"decomp-label"},"Внутренняя стоимость",-1)),s("div",_7,v(V.intrinsicValue?.toFixed(4)||"0.0000"),1),s("div",S7,v(V.price?((V.intrinsicValue||0)/V.price*100).toFixed(1):"0.0")+"%",1)]),s("div",M7,[t[76]||(t[76]=s("div",{class:"decomp-label"},"Временная стоимость",-1)),s("div",T7,v(V.timeValue?.toFixed(4)||"0.0000"),1),s("div",k7,v(V.price?((V.timeValue||0)/V.price*100).toFixed(1):"0.0")+"%",1)]),s("div",C7,[t[77]||(t[77]=s("div",{class:"decomp-label"},"Moneyness",-1)),s("div",A7,v((r.S/r.K).toFixed(4)),1),s("div",{class:c(["decomp-percent",r.S/r.K>1?"text-green":r.S/r.K<1?"text-red":""])},v(r.S>r.K?"ITM":r.S<r.K?"OTM":"ATM"),3)])])):(w(),i("div",E7,[...t[78]||(t[78]=[s("span",null,"Рассчитайте стоимость для анализа",-1)])]))]),s("div",I7,[t[82]||(t[82]=s("div",{class:"chart-header"},[s("h3",null,"Матрица чувствительности (S × σ)")],-1)),H.value.length?(w(),i("div",R7,[s("table",D7,[t[80]||(t[80]=s("thead",null,[s("tr",null,[s("th",null,"S \\ σ"),s("th",null,"σ - 5%"),s("th",null,"σ - 2.5%"),s("th",null,"σ базовое"),s("th",null,"σ + 2.5%"),s("th",null,"σ + 5%")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(H.value,(e,t)=>(w(),i("tr",{key:t},[s("td",P7,v([-20,-10,0,10,20][t])+"%",1),(w(!0),i(p,null,f(e,(e,t)=>(w(),i("td",{key:t,class:c({positive:null!==V.price&&e>V.price,negative:null!==V.price&&e<V.price})},v(e.toFixed(3)),3))),128))]))),128))])])])):(w(),i("div",L7,[...t[81]||(t[81]=[s("span",null,"Матрица будет заполнена после расчёта",-1)])]))]),s("div",N7,[t[85]||(t[85]=s("div",{class:"chart-header"},[s("h3",null,"Payoff диаграмма")],-1)),s("div",O7,[G.value.length?(w(),i("svg",F7,[t[83]||(t[83]=s("line",{x1:"0",y1:"150",x2:"800",y2:"150",stroke:"rgba(255,255,255,0.1)","stroke-dasharray":"2"},null,-1)),(w(),i(p,null,f([0,200,400,600,800],e=>s("line",{key:e,x1:e,y1:"140",x2:e,y2:"160",stroke:"rgba(255,255,255,0.2)"},null,8,B7)),64)),s("line",{x1:$.value,y1:"0",x2:$.value,y2:"300",stroke:"rgba(148, 163, 184, 0.3)","stroke-dasharray":"4"},null,8,U7),s("polyline",{points:X.value,fill:"none",stroke:"#3b82f6","stroke-width":"3","stroke-linejoin":"round"},null,8,z7),s("circle",{cx:K.value,cy:Z.value,r:"5",fill:"#ef4444"},null,8,V7)])):(w(),i("div",H7,[...t[84]||(t[84]=[s("span",null,"График будет построен после расчёта",-1)])]))])])])]),u(M,{name:"modal-fade"},{default:h(()=>[D.value?(w(),i("div",{key:0,class:"modal-overlay",onClick:t[20]||(t[20]=e=>D.value=!1)},[s("div",{class:"help-modal-container",onClick:t[19]||(t[19]=E(()=>{},["stop"]))},[s("div",G7,[t[87]||(t[87]=s("h2",null,"Справка: Модели ценообразования опционов",-1)),s("button",{class:"modal-close",onClick:t[18]||(t[18]=e=>D.value=!1)},[...t[86]||(t[86]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),t[88]||(t[88]=s("div",{class:"help-modal-body custom-scroll"},[s("div",{class:"help-section"},[s("h3",{class:"help-section-title"},"Совместимость моделей с типами опционов"),s("div",{class:"compatibility-table-wrapper"},[s("table",{class:"compatibility-table"},[s("thead",null,[s("tr",null,[s("th",null,"Модель"),s("th",null,"European"),s("th",null,"American"),s("th",null,"Bermudan"),s("th",null,"Asian"),s("th",null,"Barrier"),s("th",null,"Digital"),s("th",null,"Lookback"),s("th",null,"Knockout")])]),s("tbody",null,[s("tr",null,[s("td",{class:"model-name"},[s("strong",null,"Black-Scholes")]),s("td",{class:"compatible"},"✓ Отлично"),s("td",{class:"limited"},"⚠ Только приближенно"),s("td",{class:"limited"},"⚠ Только приближенно"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"compatible"},"✓ Да"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"not-compatible"},"✗ Не подходит")]),s("tr",null,[s("td",{class:"model-name"},[s("strong",null,"Heston")]),s("td",{class:"compatible"},"✓ Отлично"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"compatible"},"✓ Да"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"limited"},"⚠ Частично")]),s("tr",null,[s("td",{class:"model-name"},[s("strong",null,"Merton")]),s("td",{class:"compatible"},"✓ Отлично"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"compatible"},"✓ Да"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"not-compatible"},"✗ Не подходит")]),s("tr",null,[s("td",{class:"model-name"},[s("strong",null,"Bates")]),s("td",{class:"compatible"},"✓ Отлично"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"compatible"},"✓ Да"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"limited"},"⚠ Частично")]),s("tr",null,[s("td",{class:"model-name"},[s("strong",null,"SABR")]),s("td",{class:"compatible"},"✓ Отлично"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"compatible"},"✓ Да"),s("td",{class:"not-compatible"},"✗ Не подходит"),s("td",{class:"not-compatible"},"✗ Не подходит")]),s("tr",null,[s("td",{class:"model-name"},[s("strong",null,"Variance Gamma")]),s("td",{class:"compatible"},"✓ Отлично"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Численные методы"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"compatible"},"✓ Да"),s("td",{class:"limited"},"⚠ Частично"),s("td",{class:"limited"},"⚠ Частично")])])])])]),s("div",{class:"help-section"},[s("h3",{class:"help-section-title"},"Описание моделей"),s("div",{class:"model-description-card"},[s("div",{class:"model-description-header"},[s("span",{class:"model-icon icon-bsm"},"BS"),s("div",null,[s("h4",null,"Black-Scholes (BSM)"),s("span",{class:"model-tag"},"Классическая модель")])]),s("div",{class:"model-description-content"},[s("p",null,[s("strong",null,"Применение:"),m(" Европейские опционы на акции, индексы, валюты. Стандарт индустрии для простых опционов.")]),s("p",null,[s("strong",null,"Преимущества:"),m(" Быстрый расчет, аналитическая формула, точность для европейских опционов.")]),s("p",null,[s("strong",null,"Ограничения:"),m(" Предполагает постоянную волатильность, не учитывает скачки цен, не подходит для американских опционов.")]),s("p",null,[s("strong",null,"Рекомендуется для:"),m(" Европейские Call/Put опционы, Digital опционы, опционы на акции с постоянной волатильностью.")])])]),s("div",{class:"model-description-card"},[s("div",{class:"model-description-header"},[s("span",{class:"model-icon icon-heston"},"H"),s("div",null,[s("h4",null,"Heston"),s("span",{class:"model-tag"},"Стохастическая волатильность")])]),s("div",{class:"model-description-content"},[s("p",null,[s("strong",null,"Применение:"),m(" Опционы с учетом изменяющейся волатильности (volatility smile/skew).")]),s("p",null,[s("strong",null,"Преимущества:"),m(" Учитывает стохастическую волатильность, корреляцию между ценой и волатильностью, лучше описывает рыночные данные.")]),s("p",null,[s("strong",null,"Ограничения:"),m(" Сложнее в калибровке, требует больше параметров.")]),s("p",null,[s("strong",null,"Рекомендуется для:"),m(" Европейские опционы с учетом volatility smile, опционы на валюты, опционы на индексы.")])])]),s("div",{class:"model-description-card"},[s("div",{class:"model-description-header"},[s("span",{class:"model-icon icon-merton"},"M"),s("div",null,[s("h4",null,"Merton"),s("span",{class:"model-tag"},"Модель скачков")])]),s("div",{class:"model-description-content"},[s("p",null,[s("strong",null,"Применение:"),m(" Опционы на активы с резкими скачками цен (новости, события).")]),s("p",null,[s("strong",null,"Преимущества:"),m(' Учитывает скачки цен, лучше описывает "толстые хвосты" распределения.')]),s("p",null,[s("strong",null,"Ограничения:"),m(" Не учитывает стохастическую волатильность.")]),s("p",null,[s("strong",null,"Рекомендуется для:"),m(" Опционы на акции с высокой волатильностью, опционы на криптовалюты, опционы в периоды нестабильности.")])])]),s("div",{class:"model-description-card"},[s("div",{class:"model-description-header"},[s("span",{class:"model-icon icon-bates"},"B"),s("div",null,[s("h4",null,"Bates"),s("span",{class:"model-tag"},"Heston + Скачки")])]),s("div",{class:"model-description-content"},[s("p",null,[s("strong",null,"Применение:"),m(" Комбинирует стохастическую волатильность и скачки цен.")]),s("p",null,[s("strong",null,"Преимущества:"),m(" Наиболее гибкая модель, учитывает и волатильность, и скачки.")]),s("p",null,[s("strong",null,"Ограничения:"),m(" Сложная калибровка, требует много параметров.")]),s("p",null,[s("strong",null,"Рекомендуется для:"),m(" Сложные опционы, опционы в периоды кризисов, опционы на волатильные активы.")])])]),s("div",{class:"model-description-card"},[s("div",{class:"model-description-header"},[s("span",{class:"model-icon icon-sabr"},"S"),s("div",null,[s("h4",null,"SABR"),s("span",{class:"model-tag"},"Процентные опционы")])]),s("div",{class:"model-description-content"},[s("p",null,[s("strong",null,"Применение:"),m(" Опционы на процентные ставки, облигации, свопы.")]),s("p",null,[s("strong",null,"Преимущества:"),m(" Специально разработана для процентных инструментов, хорошо калибруется к рынку.")]),s("p",null,[s("strong",null,"Ограничения:"),m(" Ограничена процентными инструментами.")]),s("p",null,[s("strong",null,"Рекомендуется для:"),m(" Опционы на облигации, процентные свопы, опционы на кривые доходности.")])])]),s("div",{class:"model-description-card"},[s("div",{class:"model-description-header"},[s("span",{class:"model-icon icon-vg"},"VG"),s("div",null,[s("h4",null,"Variance Gamma"),s("span",{class:"model-tag"},"Процесс Леви")])]),s("div",{class:"model-description-content"},[s("p",null,[s("strong",null,"Применение:"),m(" Экзотические опционы, опционы с не-нормальным распределением.")]),s("p",null,[s("strong",null,"Преимущества:"),m(" Гибкое распределение, учитывает асимметрию и эксцесс.")]),s("p",null,[s("strong",null,"Ограничения:"),m(" Сложная реализация, требует численных методов.")]),s("p",null,[s("strong",null,"Рекомендуется для:"),m(" Экзотические опционы, опционы с нестандартными выплатами, опционы на активы с не-нормальным распределением.")])])])]),s("div",{class:"help-section"},[s("h3",{class:"help-section-title"},"Рекомендации по стилям исполнения"),s("div",{class:"exercise-style-guide"},[s("div",{class:"guide-item"},[s("h4",null,"European (Европейский)"),s("p",null,[m("Исполнение только в дату экспирации. "),s("strong",null,"Все модели"),m(" подходят идеально. Рекомендуется: "),s("strong",null,"Black-Scholes"),m(" для простых случаев, "),s("strong",null,"Heston"),m(" для учета volatility smile.")])]),s("div",{class:"guide-item"},[s("h4",null,"American (Американский)"),s("p",null,[m("Исполнение в любой момент до экспирации. Требуются "),s("strong",null,"численные методы"),m(" (биномиальное дерево, метод конечных разностей). Black-Scholes дает приближенную оценку через Barone-Adesi Whaley.")])]),s("div",{class:"guide-item"},[s("h4",null,"Bermudan (Бермудский)"),s("p",null,[m("Исполнение в определенные даты. Требуются "),s("strong",null,"численные методы"),m(". Модели Heston, Bates, VG могут использоваться с численными методами.")])]),s("div",{class:"guide-item"},[s("h4",null,"Asian (Азиатский)"),s("p",null,[m("Цена основана на средней цене актива. Требуются "),s("strong",null,"специальные модели"),m(" или численные методы. Heston и Bates могут использоваться с модификациями.")])]),s("div",{class:"guide-item"},[s("h4",null,"Barrier (Барьерный)"),s("p",null,[m("Опцион с триггерами активации/деактивации. Требуются "),s("strong",null,"специальные модели"),m(". Heston, Bates, VG могут использоваться с модификациями.")])]),s("div",{class:"guide-item"},[s("h4",null,"Digital (Дигитальный)"),s("p",null,[m("Фиксированная выплата при исполнении. "),s("strong",null,"Все модели"),m(" подходят. Рекомендуется: "),s("strong",null,"Black-Scholes"),m(" для простоты.")])]),s("div",{class:"guide-item"},[s("h4",null,"Lookback"),s("p",null,[m("Исполнение по лучшей цене за период. Требуются "),s("strong",null,"специальные модели"),m(". Heston, Bates, VG могут использоваться с модификациями.")])]),s("div",{class:"guide-item"},[s("h4",null,"Knockout"),s("p",null,[m("Аннулируется при достижении барьера. Требуются "),s("strong",null,"специальные модели"),m(". Heston, Bates, VG могут использоваться с модификациями.")])])])]),s("div",{class:"help-section"},[s("h3",{class:"help-section-title"},"Быстрая справка"),s("div",{class:"quick-reference-grid"},[s("div",{class:"quick-ref-item"},[s("strong",null,"Простой европейский опцион на акцию"),s("span",null,"→ Black-Scholes")]),s("div",{class:"quick-ref-item"},[s("strong",null,"Опцион с учетом volatility smile"),s("span",null,"→ Heston")]),s("div",{class:"quick-ref-item"},[s("strong",null,"Опцион на актив с скачками"),s("span",null,"→ Merton или Bates")]),s("div",{class:"quick-ref-item"},[s("strong",null,"Опцион на облигацию"),s("span",null,"→ SABR")]),s("div",{class:"quick-ref-item"},[s("strong",null,"Экзотический опцион"),s("span",null,"→ Variance Gamma или Heston")]),s("div",{class:"quick-ref-item"},[s("strong",null,"Американский опцион"),s("span",null,"→ Численные методы (не аналитические)")])])])],-1))])])):l("",!0)]),_:1})]))}}),q7=xe(W7,[["__scopeId","data-v-a2946460"]]),Y7={class:"page-container custom-scroll"},j7={class:"dashboard-grid"},X7={class:"left-panel"},$7={class:"glass-card panel"},K7={class:"controls-form"},Z7={class:"input-group"},J7={class:"input-group"},Q7={class:"input-group"},e9={class:"input-group"},t9={class:"input-group"},a9={class:"input-group"},n9={class:"glass-card panel"},r9={class:"controls-form"},i9={class:"input-group"},o9={class:"input-group"},s9={class:"input-group"},l9={class:"input-group"},c9={class:"input-group"},u9={class:"glass-card panel"},d9={class:"controls-form"},h9={class:"input-group"},p9={class:"input-group"},f9={class:"input-group"},m9={class:"glass-card panel"},v9={class:"controls-form"},g9={class:"input-group"},y9={class:"input-group"},b9={class:"input-group"},x9={class:"glass-card panel"},w9={class:"controls-form"},_9={class:"input-group"},S9={class:"input-group"},M9={class:"input-group"},T9={class:"input-group"},k9={class:"glass-card panel"},C9={class:"controls-form"},A9={class:"input-group"},E9={class:"input-group"},I9={class:"input-group"},R9={class:"main-panel"},D9={class:"glass-card chart-card"},P9={class:"table-wrapper"},L9={class:"data-table"},N9={class:"value"},O9={class:"value"},F9={class:"value"},B9={class:"value"},U9={class:"value"},z9={class:"value"},V9={class:"value"},H9={class:"value"},G9={class:"value"},W9={class:"value"},q9={class:"value"},Y9={class:"value"},j9={class:"value"},X9={class:"value"},$9={class:"value"},K9={class:"value"},Z9={class:"value"},J9={class:"value"},Q9={class:"value"},eee={class:"value"},tee={class:"value"},aee={class:"value"},nee={class:"value"},ree={class:"value"},iee={class:"glass-card chart-card mt-4"},oee={class:"table-wrapper"},see={class:"data-table"},lee=e({__name:"OptionModelsComparison",setup(e){const t=a({S:100,K:100,r:5,sigma:20,T:.25,q:0}),n=a({v0:.04,kappa:3,theta:.04,sigma_v:.2,rho:-.5}),r=a({lambda:.1,mu_j:-.05,sigma_j:.15}),o=a({lambda:.1,mu_j:-.05,sigma_j:.15}),l=a({alpha:.2,beta:.5,rho:-.3,nu:.4}),u=a({theta:-.1,sigma:.2,nu:.3}),d=a({bsm:{callPrice:null,putPrice:null,callDelta:null,putDelta:null},heston:{callPrice:null,putPrice:null,callDelta:null,putDelta:null},merton:{callPrice:null,putPrice:null,callDelta:null,putDelta:null},bates:{callPrice:null,putPrice:null,callDelta:null,putDelta:null},sabr:{callPrice:null,putPrice:null,callDelta:null,putDelta:null},vg:{callPrice:null,putPrice:null,callDelta:null,putDelta:null}}),h=e=>{const t=e<0?-1:1,a=Math.abs(e)/Math.sqrt(2),n=1/(1+.3275911*a);return.5*(1+t*(1-(1.061405429*Math.pow(n,5)+-1.453152027*Math.pow(n,4)+1.421413741*Math.pow(n,3)+-.284496736*Math.pow(n,2)+.254829592*n)*Math.exp(-a*a)))},p=()=>{const e=t.S,a=t.K,i=t.r/100,s=t.sigma/100,c=t.T,p=t.q/100;if(e<=0||a<=0||c<=0||s<=0)return void Object.keys(d).forEach(e=>{d[e].callPrice=null,d[e].putPrice=null,d[e].callDelta=null,d[e].putDelta=null});const f=(Math.log(e/a)+(i-p+.5*s*s)*c)/(s*Math.sqrt(c)),m=f-s*Math.sqrt(c),v=h(f),g=h(m),y=h(-f),b=h(-m);d.bsm.callPrice=e*Math.exp(-p*c)*v-a*Math.exp(-i*c)*g,d.bsm.putPrice=a*Math.exp(-i*c)*b-e*Math.exp(-p*c)*y,d.bsm.callDelta=Math.exp(-p*c)*v,d.bsm.putDelta=-Math.exp(-p*c)*y;const x=s*(1+n.rho*n.sigma_v*.05),w=(Math.log(e/a)+(i-p+.5*x*x)*c)/(x*Math.sqrt(c)),_=w-x*Math.sqrt(c);d.heston.callPrice=e*Math.exp(-p*c)*h(w)-a*Math.exp(-i*c)*h(_),d.heston.putPrice=a*Math.exp(-i*c)*h(-_)-e*Math.exp(-p*c)*h(-w),d.heston.callDelta=Math.exp(-p*c)*h(w),d.heston.putDelta=-Math.exp(-p*c)*h(-w);const S=r.lambda*(Math.exp(r.mu_j+.5*r.sigma_j*r.sigma_j)-1),M=Math.sqrt(s*s+r.lambda*(r.mu_j*r.mu_j+r.sigma_j*r.sigma_j)),T=(Math.log(e/a)+(i-p-S+.5*M*M)*c)/(M*Math.sqrt(c)),k=T-M*Math.sqrt(c);d.merton.callPrice=e*Math.exp(-p*c)*h(T)-a*Math.exp(-i*c)*h(k),d.merton.putPrice=a*Math.exp(-i*c)*h(-k)-e*Math.exp(-p*c)*h(-T),d.merton.callDelta=Math.exp(-p*c)*h(T),d.merton.putDelta=-Math.exp(-p*c)*h(-T);const C=o.lambda*(Math.exp(o.mu_j+.5*o.sigma_j*o.sigma_j)-1),A=Math.sqrt(x*x+o.lambda*(o.mu_j*o.mu_j+o.sigma_j*o.sigma_j)),E=(Math.log(e/a)+(i-p-C+.5*A*A)*c)/(A*Math.sqrt(c)),I=E-A*Math.sqrt(c);d.bates.callPrice=e*Math.exp(-p*c)*h(E)-a*Math.exp(-i*c)*h(I),d.bates.putPrice=a*Math.exp(-i*c)*h(-I)-e*Math.exp(-p*c)*h(-E),d.bates.callDelta=Math.exp(-p*c)*h(E),d.bates.putDelta=-Math.exp(-p*c)*h(-E);const R=l.alpha*Math.pow(e/a,l.beta)*(1+l.rho*l.nu*Math.log(e/a)),D=(Math.log(e/a)+(i-p+.5*R*R)*c)/(R*Math.sqrt(c)),P=D-R*Math.sqrt(c);d.sabr.callPrice=e*Math.exp(-p*c)*h(D)-a*Math.exp(-i*c)*h(P),d.sabr.putPrice=a*Math.exp(-i*c)*h(-P)-e*Math.exp(-p*c)*h(-D),d.sabr.callDelta=Math.exp(-p*c)*h(D),d.sabr.putDelta=-Math.exp(-p*c)*h(-D);const L=u.theta+.5*u.sigma*u.sigma,N=Math.sqrt(s*s+u.sigma*u.sigma/u.nu),O=(Math.log(e/a)+(i-p+L)*c)/(N*Math.sqrt(c)),F=O-N*Math.sqrt(c);d.vg.callPrice=e*Math.exp(-p*c)*h(O)-a*Math.exp(-i*c)*h(F),d.vg.putPrice=a*Math.exp(-i*c)*h(-F)-e*Math.exp(-p*c)*h(-O),d.vg.callDelta=Math.exp(-p*c)*h(O),d.vg.putDelta=-Math.exp(-p*c)*h(-O)};return p(),(e,a)=>(w(),i("div",Y7,[a[75]||(a[75]=I('<div class="section-header" data-v-645f83eb><div class="header-left" data-v-645f83eb><h1 class="section-title" data-v-645f83eb>Сравнение моделей ценообразования</h1><p class="section-subtitle" data-v-645f83eb>Black-Scholes, Heston, Merton, Bates, SABR, Variance Gamma</p></div><div class="header-actions" data-v-645f83eb><div class="glass-pill status-pill" data-v-645f83eb><span class="dot bg-blue" data-v-645f83eb></span><span class="status-label" data-v-645f83eb>Активных моделей: <b class="text-white" data-v-645f83eb>6</b></span></div></div></div>',1)),s("div",j7,[s("aside",X7,[s("div",$7,[a[30]||(a[30]=s("div",{class:"panel-header"},[s("h3",null,"Базовые параметры")],-1)),s("div",K7,[s("div",Z7,[a[24]||(a[24]=s("label",{class:"lbl"},"S (Spot)",-1)),T(s("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>t.S=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,t.S,void 0,{number:!0}]])]),s("div",J7,[a[25]||(a[25]=s("label",{class:"lbl"},"K (Strike)",-1)),T(s("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>t.K=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,t.K,void 0,{number:!0}]])]),s("div",Q7,[a[26]||(a[26]=s("label",{class:"lbl"},"r (Rate), %",-1)),T(s("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>t.r=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,t.r,void 0,{number:!0}]])]),s("div",e9,[a[27]||(a[27]=s("label",{class:"lbl"},"σ (Vol), %",-1)),T(s("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>t.sigma=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,t.sigma,void 0,{number:!0}]])]),s("div",t9,[a[28]||(a[28]=s("label",{class:"lbl"},"T (Time), лет",-1)),T(s("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>t.T=e),type:"number",step:"0.01",min:"0.001",class:"glass-input",onChange:p},null,544),[[k,t.T,void 0,{number:!0}]])]),s("div",a9,[a[29]||(a[29]=s("label",{class:"lbl"},"q (Див. доходность), %",-1)),T(s("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>t.q=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,t.q,void 0,{number:!0}]])])])]),s("div",n9,[a[36]||(a[36]=s("div",{class:"panel-header"},[s("h3",null,"Параметры Heston")],-1)),s("div",r9,[s("div",i9,[a[31]||(a[31]=s("label",{class:"lbl"},"v0 (Начальная Vol²)",-1)),T(s("input",{"onUpdate:modelValue":a[6]||(a[6]=e=>n.v0=e),type:"number",step:"0.001",min:"0.001",class:"glass-input",onChange:p},null,544),[[k,n.v0,void 0,{number:!0}]])]),s("div",o9,[a[32]||(a[32]=s("label",{class:"lbl"},"κ (Возврат к среднему)",-1)),T(s("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>n.kappa=e),type:"number",step:"0.01",min:"0.01",class:"glass-input",onChange:p},null,544),[[k,n.kappa,void 0,{number:!0}]])]),s("div",s9,[a[33]||(a[33]=s("label",{class:"lbl"},"θ (Долгосрочная Vol²)",-1)),T(s("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>n.theta=e),type:"number",step:"0.001",min:"0.001",class:"glass-input",onChange:p},null,544),[[k,n.theta,void 0,{number:!0}]])]),s("div",l9,[a[34]||(a[34]=s("label",{class:"lbl"},"σ_v (Волатильность волатильности)",-1)),T(s("input",{"onUpdate:modelValue":a[9]||(a[9]=e=>n.sigma_v=e),type:"number",step:"0.01",min:"0.01",class:"glass-input",onChange:p},null,544),[[k,n.sigma_v,void 0,{number:!0}]])]),s("div",c9,[a[35]||(a[35]=s("label",{class:"lbl"},"ρ (Корреляция)",-1)),T(s("input",{"onUpdate:modelValue":a[10]||(a[10]=e=>n.rho=e),type:"number",step:"0.01",min:"-1",max:"1",class:"glass-input",onChange:p},null,544),[[k,n.rho,void 0,{number:!0}]])])])]),s("div",u9,[a[40]||(a[40]=s("div",{class:"panel-header"},[s("h3",null,"Параметры Merton")],-1)),s("div",d9,[s("div",h9,[a[37]||(a[37]=s("label",{class:"lbl"},"λ (Интенсивность скачков)",-1)),T(s("input",{"onUpdate:modelValue":a[11]||(a[11]=e=>r.lambda=e),type:"number",step:"0.01",min:"0",class:"glass-input",onChange:p},null,544),[[k,r.lambda,void 0,{number:!0}]])]),s("div",p9,[a[38]||(a[38]=s("label",{class:"lbl"},"μ_j (Среднее скачка)",-1)),T(s("input",{"onUpdate:modelValue":a[12]||(a[12]=e=>r.mu_j=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,r.mu_j,void 0,{number:!0}]])]),s("div",f9,[a[39]||(a[39]=s("label",{class:"lbl"},"σ_j (Волатильность скачка)",-1)),T(s("input",{"onUpdate:modelValue":a[13]||(a[13]=e=>r.sigma_j=e),type:"number",step:"0.01",min:"0.01",class:"glass-input",onChange:p},null,544),[[k,r.sigma_j,void 0,{number:!0}]])])])]),s("div",m9,[a[44]||(a[44]=s("div",{class:"panel-header"},[s("h3",null,"Параметры Bates")],-1)),s("div",v9,[s("div",g9,[a[41]||(a[41]=s("label",{class:"lbl"},"λ (Интенсивность скачков)",-1)),T(s("input",{"onUpdate:modelValue":a[14]||(a[14]=e=>o.lambda=e),type:"number",step:"0.01",min:"0",class:"glass-input",onChange:p},null,544),[[k,o.lambda,void 0,{number:!0}]])]),s("div",y9,[a[42]||(a[42]=s("label",{class:"lbl"},"μ_j (Среднее скачка)",-1)),T(s("input",{"onUpdate:modelValue":a[15]||(a[15]=e=>o.mu_j=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,o.mu_j,void 0,{number:!0}]])]),s("div",b9,[a[43]||(a[43]=s("label",{class:"lbl"},"σ_j (Волатильность скачка)",-1)),T(s("input",{"onUpdate:modelValue":a[16]||(a[16]=e=>o.sigma_j=e),type:"number",step:"0.01",min:"0.01",class:"glass-input",onChange:p},null,544),[[k,o.sigma_j,void 0,{number:!0}]])])])]),s("div",x9,[a[49]||(a[49]=s("div",{class:"panel-header"},[s("h3",null,"Параметры SABR")],-1)),s("div",w9,[s("div",_9,[a[45]||(a[45]=s("label",{class:"lbl"},"α (Начальная волатильность)",-1)),T(s("input",{"onUpdate:modelValue":a[17]||(a[17]=e=>l.alpha=e),type:"number",step:"0.001",min:"0.001",class:"glass-input",onChange:p},null,544),[[k,l.alpha,void 0,{number:!0}]])]),s("div",S9,[a[46]||(a[46]=s("label",{class:"lbl"},"β (Эластичность)",-1)),T(s("input",{"onUpdate:modelValue":a[18]||(a[18]=e=>l.beta=e),type:"number",step:"0.01",min:"0",max:"1",class:"glass-input",onChange:p},null,544),[[k,l.beta,void 0,{number:!0}]])]),s("div",M9,[a[47]||(a[47]=s("label",{class:"lbl"},"ρ (Корреляция)",-1)),T(s("input",{"onUpdate:modelValue":a[19]||(a[19]=e=>l.rho=e),type:"number",step:"0.01",min:"-1",max:"1",class:"glass-input",onChange:p},null,544),[[k,l.rho,void 0,{number:!0}]])]),s("div",T9,[a[48]||(a[48]=s("label",{class:"lbl"},"ν (Волатильность волатильности)",-1)),T(s("input",{"onUpdate:modelValue":a[20]||(a[20]=e=>l.nu=e),type:"number",step:"0.01",min:"0.01",class:"glass-input",onChange:p},null,544),[[k,l.nu,void 0,{number:!0}]])])])]),s("div",k9,[a[53]||(a[53]=s("div",{class:"panel-header"},[s("h3",null,"Параметры Variance Gamma")],-1)),s("div",C9,[s("div",A9,[a[50]||(a[50]=s("label",{class:"lbl"},"θ (Дрифт)",-1)),T(s("input",{"onUpdate:modelValue":a[21]||(a[21]=e=>u.theta=e),type:"number",step:"0.01",class:"glass-input",onChange:p},null,544),[[k,u.theta,void 0,{number:!0}]])]),s("div",E9,[a[51]||(a[51]=s("label",{class:"lbl"},"σ (Волатильность)",-1)),T(s("input",{"onUpdate:modelValue":a[22]||(a[22]=e=>u.sigma=e),type:"number",step:"0.001",min:"0.001",class:"glass-input",onChange:p},null,544),[[k,u.sigma,void 0,{number:!0}]])]),s("div",I9,[a[52]||(a[52]=s("label",{class:"lbl"},"ν (Параметр формы)",-1)),T(s("input",{"onUpdate:modelValue":a[23]||(a[23]=e=>u.nu=e),type:"number",step:"0.001",min:"0.001",class:"glass-input",onChange:p},null,544),[[k,u.nu,void 0,{number:!0}]])])])])]),s("main",R9,[s("div",D9,[a[67]||(a[67]=s("div",{class:"chart-header"},[s("h3",null,"Сравнение цен по моделям")],-1)),s("div",P9,[s("table",L9,[a[66]||(a[66]=s("thead",null,[s("tr",null,[s("th",null,"Модель"),s("th",null,"Call"),s("th",null,"Put"),s("th",null,"Call Δ"),s("th",null,"Put Δ"),s("th",null,"Примечание")])],-1)),s("tbody",null,[s("tr",null,[a[54]||(a[54]=s("td",{class:"model-name"},"Black-Scholes",-1)),s("td",N9,v(d.bsm.callPrice?.toFixed(4)||"-"),1),s("td",O9,v(d.bsm.putPrice?.toFixed(4)||"-"),1),s("td",F9,v(d.bsm.callDelta?.toFixed(4)||"-"),1),s("td",B9,v(d.bsm.putDelta?.toFixed(4)||"-"),1),a[55]||(a[55]=s("td",{class:"note"},"Базовая модель",-1))]),s("tr",null,[a[56]||(a[56]=s("td",{class:"model-name"},"Heston",-1)),s("td",U9,v(d.heston.callPrice?.toFixed(4)||"-"),1),s("td",z9,v(d.heston.putPrice?.toFixed(4)||"-"),1),s("td",V9,v(d.heston.callDelta?.toFixed(4)||"-"),1),s("td",H9,v(d.heston.putDelta?.toFixed(4)||"-"),1),a[57]||(a[57]=s("td",{class:"note"},"Стохастическая волатильность",-1))]),s("tr",null,[a[58]||(a[58]=s("td",{class:"model-name"},"Merton",-1)),s("td",G9,v(d.merton.callPrice?.toFixed(4)||"-"),1),s("td",W9,v(d.merton.putPrice?.toFixed(4)||"-"),1),s("td",q9,v(d.merton.callDelta?.toFixed(4)||"-"),1),s("td",Y9,v(d.merton.putDelta?.toFixed(4)||"-"),1),a[59]||(a[59]=s("td",{class:"note"},"Модель скачков",-1))]),s("tr",null,[a[60]||(a[60]=s("td",{class:"model-name"},"Bates",-1)),s("td",j9,v(d.bates.callPrice?.toFixed(4)||"-"),1),s("td",X9,v(d.bates.putPrice?.toFixed(4)||"-"),1),s("td",$9,v(d.bates.callDelta?.toFixed(4)||"-"),1),s("td",K9,v(d.bates.putDelta?.toFixed(4)||"-"),1),a[61]||(a[61]=s("td",{class:"note"},"Heston + Скачки",-1))]),s("tr",null,[a[62]||(a[62]=s("td",{class:"model-name"},"SABR",-1)),s("td",Z9,v(d.sabr.callPrice?.toFixed(4)||"-"),1),s("td",J9,v(d.sabr.putPrice?.toFixed(4)||"-"),1),s("td",Q9,v(d.sabr.callDelta?.toFixed(4)||"-"),1),s("td",eee,v(d.sabr.putDelta?.toFixed(4)||"-"),1),a[63]||(a[63]=s("td",{class:"note"},"Процентные опционы",-1))]),s("tr",null,[a[64]||(a[64]=s("td",{class:"model-name"},"Variance Gamma",-1)),s("td",tee,v(d.vg.callPrice?.toFixed(4)||"-"),1),s("td",aee,v(d.vg.putPrice?.toFixed(4)||"-"),1),s("td",nee,v(d.vg.callDelta?.toFixed(4)||"-"),1),s("td",ree,v(d.vg.putDelta?.toFixed(4)||"-"),1),a[65]||(a[65]=s("td",{class:"note"},"Процесс Леви",-1))])])])])]),s("div",iee,[a[74]||(a[74]=s("div",{class:"chart-header"},[s("h3",null,"Отклонения от Black-Scholes")],-1)),s("div",oee,[s("table",see,[a[73]||(a[73]=s("thead",null,[s("tr",null,[s("th",null,"Модель"),s("th",null,"Call (абс.)"),s("th",null,"Call (%)"),s("th",null,"Put (абс.)"),s("th",null,"Put (%)")])],-1)),s("tbody",null,[s("tr",null,[a[68]||(a[68]=s("td",{class:"model-name"},"Heston",-1)),s("td",{class:c({positive:(d.heston.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.heston.callPrice||0)-(d.bsm.callPrice||0)<0})},v(((d.heston.callPrice||0)-(d.bsm.callPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.heston.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.heston.callPrice||0)-(d.bsm.callPrice||0)<0})},v((((d.heston.callPrice||0)-(d.bsm.callPrice||0))/(d.bsm.callPrice||1)*100).toFixed(2))+"% ",3),s("td",{class:c({positive:(d.heston.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.heston.putPrice||0)-(d.bsm.putPrice||0)<0})},v(((d.heston.putPrice||0)-(d.bsm.putPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.heston.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.heston.putPrice||0)-(d.bsm.putPrice||0)<0})},v((((d.heston.putPrice||0)-(d.bsm.putPrice||0))/(d.bsm.putPrice||1)*100).toFixed(2))+"% ",3)]),s("tr",null,[a[69]||(a[69]=s("td",{class:"model-name"},"Merton",-1)),s("td",{class:c({positive:(d.merton.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.merton.callPrice||0)-(d.bsm.callPrice||0)<0})},v(((d.merton.callPrice||0)-(d.bsm.callPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.merton.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.merton.callPrice||0)-(d.bsm.callPrice||0)<0})},v((((d.merton.callPrice||0)-(d.bsm.callPrice||0))/(d.bsm.callPrice||1)*100).toFixed(2))+"% ",3),s("td",{class:c({positive:(d.merton.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.merton.putPrice||0)-(d.bsm.putPrice||0)<0})},v(((d.merton.putPrice||0)-(d.bsm.putPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.merton.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.merton.putPrice||0)-(d.bsm.putPrice||0)<0})},v((((d.merton.putPrice||0)-(d.bsm.putPrice||0))/(d.bsm.putPrice||1)*100).toFixed(2))+"% ",3)]),s("tr",null,[a[70]||(a[70]=s("td",{class:"model-name"},"Bates",-1)),s("td",{class:c({positive:(d.bates.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.bates.callPrice||0)-(d.bsm.callPrice||0)<0})},v(((d.bates.callPrice||0)-(d.bsm.callPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.bates.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.bates.callPrice||0)-(d.bsm.callPrice||0)<0})},v((((d.bates.callPrice||0)-(d.bsm.callPrice||0))/(d.bsm.callPrice||1)*100).toFixed(2))+"% ",3),s("td",{class:c({positive:(d.bates.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.bates.putPrice||0)-(d.bsm.putPrice||0)<0})},v(((d.bates.putPrice||0)-(d.bsm.putPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.bates.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.bates.putPrice||0)-(d.bsm.putPrice||0)<0})},v((((d.bates.putPrice||0)-(d.bsm.putPrice||0))/(d.bsm.putPrice||1)*100).toFixed(2))+"% ",3)]),s("tr",null,[a[71]||(a[71]=s("td",{class:"model-name"},"SABR",-1)),s("td",{class:c({positive:(d.sabr.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.sabr.callPrice||0)-(d.bsm.callPrice||0)<0})},v(((d.sabr.callPrice||0)-(d.bsm.callPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.sabr.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.sabr.callPrice||0)-(d.bsm.callPrice||0)<0})},v((((d.sabr.callPrice||0)-(d.bsm.callPrice||0))/(d.bsm.callPrice||1)*100).toFixed(2))+"% ",3),s("td",{class:c({positive:(d.sabr.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.sabr.putPrice||0)-(d.bsm.putPrice||0)<0})},v(((d.sabr.putPrice||0)-(d.bsm.putPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.sabr.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.sabr.putPrice||0)-(d.bsm.putPrice||0)<0})},v((((d.sabr.putPrice||0)-(d.bsm.putPrice||0))/(d.bsm.putPrice||1)*100).toFixed(2))+"% ",3)]),s("tr",null,[a[72]||(a[72]=s("td",{class:"model-name"},"Variance Gamma",-1)),s("td",{class:c({positive:(d.vg.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.vg.callPrice||0)-(d.bsm.callPrice||0)<0})},v(((d.vg.callPrice||0)-(d.bsm.callPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.vg.callPrice||0)-(d.bsm.callPrice||0)>0,negative:(d.vg.callPrice||0)-(d.bsm.callPrice||0)<0})},v((((d.vg.callPrice||0)-(d.bsm.callPrice||0))/(d.bsm.callPrice||1)*100).toFixed(2))+"% ",3),s("td",{class:c({positive:(d.vg.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.vg.putPrice||0)-(d.bsm.putPrice||0)<0})},v(((d.vg.putPrice||0)-(d.bsm.putPrice||0)).toFixed(4)),3),s("td",{class:c({positive:(d.vg.putPrice||0)-(d.bsm.putPrice||0)>0,negative:(d.vg.putPrice||0)-(d.bsm.putPrice||0)<0})},v((((d.vg.putPrice||0)-(d.bsm.putPrice||0))/(d.bsm.putPrice||1)*100).toFixed(2))+"% ",3)])])])])])])])]))}}),cee=xe(lee,[["__scopeId","data-v-645f83eb"]]),uee={class:"page-container custom-scroll"},dee={class:"section-header"},hee={class:"header-actions"},pee={class:"glass-pill status-pill"},fee={class:"status-label"},mee={class:"text-white"},vee={class:"dashboard-grid"},gee={class:"left-panel"},yee={class:"glass-card panel"},bee={class:"controls-form"},xee={class:"input-group"},wee={class:"input-group"},_ee={class:"input-group"},See={class:"input-group"},Mee={class:"input-group"},Tee={class:"input-group"},kee={class:"radio-group"},Cee={class:"radio-label"},Aee={class:"radio-label"},Eee={key:0,class:"glass-card panel"},Iee={class:"stats-list"},Ree={class:"stat-item"},Dee={class:"val mono"},Pee={class:"stat-item"},Lee={class:"val mono"},Nee={class:"stat-item"},Oee={class:"val mono"},Fee={class:"stat-item"},Bee={class:"stat-item"},Uee={class:"val mono"},zee={class:"main-panel"},Vee={class:"glass-card chart-card"},Hee={class:"scenario-controls"},Gee={class:"scenario-input"},Wee={class:"scenario-input"},qee={class:"scenario-input"},Yee={key:0,class:"pl-results"},jee={class:"pl-row"},Xee={class:"pl-value mono"},$ee={class:"pl-row"},Kee={class:"pl-value mono"},Zee={class:"pl-row"},Jee={class:"pl-value mono"},Qee={class:"pl-row"},ete={class:"pl-value mono"},tte={class:"pl-row total"},ate={key:1,class:"pl-results empty-state"},nte={class:"glass-card chart-card mt-4"},rte={key:0,class:"sensitivity-table"},ite={class:"data-table"},ote={class:"row-header"},ste={key:1,class:"pl-results empty-state"},lte=e({__name:"OptionGreeksAnalyzer",setup(e){const n=a({S:100,K:100,r:5,sigma:20,T:.25,type:"call"}),r=a({deltaS:5,deltaSigma:1,deltaT:7}),o=a({delta:null,gamma:null,vega:null,theta:null,rho:null}),d=t([]),g=e=>{const t=e<0?-1:1,a=Math.abs(e)/Math.sqrt(2),n=1/(1+.3275911*a);return.5*(1+t*(1-(1.061405429*Math.pow(n,5)+-1.453152027*Math.pow(n,4)+1.421413741*Math.pow(n,3)+-.284496736*Math.pow(n,2)+.254829592*n)*Math.exp(-a*a)))},y=(e,t,a,n,r,i)=>{if(n<=0||r<=0)return 0;const o=(Math.log(e/t)+(a+.5*n*n)*r)/(n*Math.sqrt(r)),s=o-n*Math.sqrt(r);return"call"===i?e*g(o)-t*Math.exp(-a*r)*g(s):t*Math.exp(-a*r)*g(-s)-e*g(-o)},b=()=>{const e=n.S,t=n.K,a=n.r/100,r=n.sigma/100,i=n.T;if(r<=0||i<=0)return o.delta=null,o.gamma=null,o.vega=null,o.theta=null,o.rho=null,void(d.value=[]);const s=(Math.log(e/t)+(a+.5*r*r)*i)/(r*Math.sqrt(i)),l=s-r*Math.sqrt(i),c=g(s),u=g(-s),h=(p=s,Math.exp(-.5*p*p)/Math.sqrt(2*Math.PI));var p;const f=g(l),m=g(-l);"call"===n.type?o.delta=c:o.delta=u-1,o.gamma=h/(e*r*Math.sqrt(i)),o.vega=e*h*Math.sqrt(i)/100,"call"===n.type?o.theta=(-e*h*r/(2*Math.sqrt(i))-a*t*Math.exp(-a*i)*f)/365:o.theta=(-e*h*r/(2*Math.sqrt(i))+a*t*Math.exp(-a*i)*m)/365,o.rho=("call"===n.type?t*i*Math.exp(-a*i)*f:-t*i*Math.exp(-a*i)*m)/100;const v=[-2,-1,0,1,2],b=y(e,t,a,r,i,n.type);d.value=[-10,-5,0,5,10].map(o=>v.map(s=>y(e+o,t,a,r+s/100,i,n.type)-b))},x=S(()=>(o.delta||0)*r.deltaS),_=S(()=>.5*(o.gamma||0)*Math.pow(r.deltaS,2)),C=S(()=>(o.vega||0)*r.deltaSigma),A=S(()=>(o.theta||0)*r.deltaT),E=S(()=>x.value+_.value+C.value+A.value),I=S(()=>"call"===n.type?"bg-green":"bg-red");return b(),(e,t)=>(w(),i("div",uee,[s("div",dee,[t[11]||(t[11]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Анализ чувствительности (Greeks)"),s("p",{class:"section-subtitle"},"Дельта, гамма, вега, тета, ро — риск-ориентированный анализ")],-1)),s("div",hee,[s("div",pee,[s("span",{class:c(["dot",I.value])},null,2),s("span",fee,[t[10]||(t[10]=m("Тип: ",-1)),s("b",mee,v(n.type.toUpperCase()),1)])])])]),s("div",vee,[s("aside",gee,[s("div",yee,[t[20]||(t[20]=s("div",{class:"panel-header"},[s("h3",null,"Параметры опциона")],-1)),s("div",bee,[s("div",xee,[t[12]||(t[12]=s("label",{class:"lbl"},"S (Spot)",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.S=e),type:"number",step:"0.01",class:"glass-input",onChange:b},null,544),[[k,n.S,void 0,{number:!0}]])]),s("div",wee,[t[13]||(t[13]=s("label",{class:"lbl"},"K (Strike)",-1)),T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>n.K=e),type:"number",step:"0.01",class:"glass-input",onChange:b},null,544),[[k,n.K,void 0,{number:!0}]])]),s("div",_ee,[t[14]||(t[14]=s("label",{class:"lbl"},"r (Rate), %",-1)),T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.r=e),type:"number",step:"0.01",class:"glass-input",onChange:b},null,544),[[k,n.r,void 0,{number:!0}]])]),s("div",See,[t[15]||(t[15]=s("label",{class:"lbl"},"σ (Vol), %",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>n.sigma=e),type:"number",step:"0.01",class:"glass-input",onChange:b},null,544),[[k,n.sigma,void 0,{number:!0}]])]),s("div",Mee,[t[16]||(t[16]=s("label",{class:"lbl"},"T (Time), лет",-1)),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>n.T=e),type:"number",step:"0.01",min:"0.001",class:"glass-input",onChange:b},null,544),[[k,n.T,void 0,{number:!0}]])]),s("div",Tee,[t[19]||(t[19]=s("label",{class:"lbl"},"Тип опциона",-1)),s("div",kee,[s("label",Cee,[T(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>n.type=e),type:"radio",value:"call",onChange:b},null,544),[[V,n.type]]),t[17]||(t[17]=s("span",null,"Call",-1))]),s("label",Aee,[T(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.type=e),type:"radio",value:"put",onChange:b},null,544),[[V,n.type]]),t[18]||(t[18]=s("span",null,"Put",-1))])])])])]),u(M,{name:"fade"},{default:h(()=>[null!==o.delta?(w(),i("div",Eee,[t[26]||(t[26]=s("div",{class:"panel-header"},[s("h3",null,"Риск-метрики")],-1)),s("div",Iee,[s("div",Ree,[t[21]||(t[21]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"Δ"),s("span",{class:"s-name"},"Дельта")],-1)),s("span",Dee,v(o.delta.toFixed(4)),1)]),s("div",Pee,[t[22]||(t[22]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"Γ"),s("span",{class:"s-name"},"Гамма")],-1)),s("span",Lee,v(o.gamma.toFixed(6)),1)]),s("div",Nee,[t[23]||(t[23]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"ν"),s("span",{class:"s-name"},"Вега")],-1)),s("span",Oee,v(o.vega.toFixed(4)),1)]),s("div",Fee,[t[24]||(t[24]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"Θ"),s("span",{class:"s-name"},"Тета")],-1)),s("span",{class:c(["val mono",o.theta<0?"text-red":"text-green"])},v(o.theta.toFixed(4)),3)]),s("div",Bee,[t[25]||(t[25]=s("div",{class:"stat-head"},[s("span",{class:"greek-symbol"},"ρ"),s("span",{class:"s-name"},"Ро")],-1)),s("span",Uee,v(o.rho.toFixed(4)),1)])])])):l("",!0)]),_:1})]),s("main",zee,[s("div",Vee,[t[37]||(t[37]=s("div",{class:"chart-header"},[s("h3",null,"Сценарный анализ P&L")],-1)),s("div",Hee,[s("div",Gee,[t[27]||(t[27]=s("label",null,"ΔS (руб.)",-1)),T(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>r.deltaS=e),type:"number",step:"0.1",class:"glass-input-sm"},null,512),[[k,r.deltaS,void 0,{number:!0}]])]),s("div",Wee,[t[28]||(t[28]=s("label",null,"Δσ (%)",-1)),T(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>r.deltaSigma=e),type:"number",step:"0.1",class:"glass-input-sm"},null,512),[[k,r.deltaSigma,void 0,{number:!0}]])]),s("div",qee,[t[29]||(t[29]=s("label",null,"Δt (дн.)",-1)),T(s("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>r.deltaT=e),type:"number",step:"1",class:"glass-input-sm"},null,512),[[k,r.deltaT,void 0,{number:!0}]])])]),null!==o.delta?(w(),i("div",Yee,[s("div",jee,[t[30]||(t[30]=s("span",{class:"pl-label"},"Δ компонент",-1)),s("span",Xee,v(x.value.toFixed(2)),1)]),s("div",$ee,[t[31]||(t[31]=s("span",{class:"pl-label"},"Γ компонент",-1)),s("span",Kee,v(_.value.toFixed(2)),1)]),s("div",Zee,[t[32]||(t[32]=s("span",{class:"pl-label"},"ν компонент",-1)),s("span",Jee,v(C.value.toFixed(2)),1)]),s("div",Qee,[t[33]||(t[33]=s("span",{class:"pl-label"},"Θ компонент",-1)),s("span",ete,v(A.value.toFixed(2)),1)]),t[35]||(t[35]=s("div",{class:"pl-row divider"},null,-1)),s("div",tte,[t[34]||(t[34]=s("span",{class:"pl-label"},"Всего (приблиз.)",-1)),s("span",{class:c(["pl-value mono",E.value>=0?"text-green":"text-red"])},v(E.value.toFixed(2)),3)])])):(w(),i("div",ate,[...t[36]||(t[36]=[s("span",null,"Рассчитайте греки для анализа",-1)])]))]),s("div",nte,[t[40]||(t[40]=s("div",{class:"chart-header"},[s("h3",null,"Матрица чувствительности P&L (ΔS × Δσ)")],-1)),d.value.length?(w(),i("div",rte,[s("table",ite,[t[38]||(t[38]=s("thead",null,[s("tr",null,[s("th",null,"ΔS (руб.)"),s("th",null,"σ - 2%"),s("th",null,"σ - 1%"),s("th",null,"σ базовое"),s("th",null,"σ + 1%"),s("th",null,"σ + 2%")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(d.value,(e,t)=>(w(),i("tr",{key:t},[s("td",ote,v([-10,-5,0,5,10][t]),1),(w(!0),i(p,null,f(e,(e,t)=>(w(),i("td",{key:t,class:c({positive:e>0,negative:e<0})},v(e.toFixed(2)),3))),128))]))),128))])])])):(w(),i("div",ste,[...t[39]||(t[39]=[s("span",null,"Матрица будет заполнена после расчёта",-1)])]))])])])]))}}),cte=xe(lte,[["__scopeId","data-v-56e8f3f1"]]),ute={class:"page-container custom-scroll"},dte={class:"section-header"},hte={class:"header-actions"},pte={class:"glass-pill status-pill"},fte={class:"status-label"},mte={class:"text-white"},vte={class:"dashboard-grid"},gte={class:"left-panel"},yte={class:"glass-card panel"},bte={class:"portfolio-summary"},xte={class:"summary-item"},wte={class:"summary-value"},_te={class:"summary-item"},Ste={class:"summary-value"},Mte={class:"summary-item"},Tte={class:"summary-value"},kte={class:"glass-card panel"},Cte={class:"positions-list"},Ate={class:"pos-header"},Ete={class:"pos-ticker"},Ite={class:"pos-details"},Rte={class:"pos-row"},Dte={class:"pos-row"},Pte=["onUpdate:modelValue"],Lte={class:"pos-row"},Nte={class:"pos-row"},Ote={class:"pos-sum"},Fte=["onClick"],Bte={class:"main-panel"},Ute={class:"glass-card chart-card"},zte={class:"greeks-grid"},Vte={class:"greek-card"},Hte={class:"greek-value"},Gte={class:"greek-card"},Wte={class:"greek-value"},qte={class:"greek-card"},Yte={class:"greek-value"},jte={class:"greek-card"},Xte={class:"greek-card"},$te={class:"greek-value"},Kte={class:"greek-card"},Zte={class:"greek-value"},Jte={class:"glass-card chart-card mt-4"},Qte={class:"scenarios-grid"},eae={class:"scenario-card"},tae={class:"scenario-card"},aae={class:"scenario-card"},nae={class:"scenario-card"},rae={class:"scenario-card"},iae={class:"scenario-card"},oae={class:"glass-card chart-card mt-4"},sae={class:"table-wrapper"},lae={class:"data-table"},cae={class:"row-header"},uae={class:"glass-card chart-card mt-4"},dae={class:"metrics-grid"},hae={class:"metric-item"},pae={class:"metric-value text-green"},fae={class:"metric-item"},mae={class:"metric-value text-red"},vae={class:"metric-item"},gae={class:"metric-value"},yae={class:"metric-item"},bae={class:"metric-value"},xae=e({__name:"OptionPortfolio",setup(e){const n=t([{ticker:"AAPL",type:"call",strike:150,quantity:100,price:8.52,delta:.654},{ticker:"MSFT",type:"put",strike:250,quantity:50,price:12.34,delta:-.432},{ticker:"TSLA",type:"call",strike:200,quantity:25,price:5.67,delta:.512}]),r=a({delta:0,gamma:0,vega:0,theta:0,rho:0}),o=t(0),l=t([]),u=t(0),d=t(0),h=t(0),g=()=>{r.delta=n.value.reduce((e,t)=>e+t.delta*t.quantity,0),r.gamma=n.value.reduce((e,t)=>e+.0184*t.quantity,0),r.vega=n.value.reduce((e,t)=>e+.197*t.quantity,0),r.theta=n.value.reduce((e,t)=>e+-.024*t.quantity,0),r.rho=n.value.reduce((e,t)=>e+.089*t.quantity,0),o.value=n.value.reduce((e,t)=>e+t.price*t.quantity,0);const e=[-2,-1,0,1,2];l.value=[-5,-2.5,0,2.5,5].map(t=>e.map(e=>{let a=r.delta*t;return a+=.5*r.gamma*t*t,a+=r.vega*e,a})),u.value=5*o.value,d.value=-o.value,h.value=o.value/Math.abs(r.delta||1)},y=()=>{n.value.push({ticker:"NEW",type:"call",strike:100,quantity:10,price:5,delta:.5}),g()},b=(e,t=0)=>r.delta*e+.5*r.gamma*e*e+r.vega*t;return g(),(e,t)=>(w(),i("div",ute,[s("div",dte,[t[2]||(t[2]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Портфель опционов"),s("p",{class:"section-subtitle"},"Агрегированный риск-анализ, греки портфеля, сценарное моделирование")],-1)),s("div",hte,[s("div",pte,[t[1]||(t[1]=s("span",{class:"dot bg-blue"},null,-1)),s("span",fte,[t[0]||(t[0]=m("Позиций: ",-1)),s("b",mte,v(n.value.length),1)])])])]),s("div",vte,[s("aside",gte,[s("div",yte,[t[6]||(t[6]=s("div",{class:"panel-header"},[s("h3",null,"Портфель")],-1)),s("div",bte,[s("div",xte,[t[3]||(t[3]=s("span",{class:"summary-label"},"Общая стоимость",-1)),s("span",wte,v(o.value.toFixed(2)),1)]),s("div",_te,[t[4]||(t[4]=s("span",{class:"summary-label"},"Позиций",-1)),s("span",Ste,v(n.value.length),1)]),s("div",Mte,[t[5]||(t[5]=s("span",{class:"summary-label"},"Дельта портфеля",-1)),s("span",Tte,v(r.delta.toFixed(2)),1)])]),s("button",{class:"btn-primary mt-4",onClick:y},"+ Добавить позицию")]),s("div",kte,[t[11]||(t[11]=s("div",{class:"panel-header"},[s("h3",null,"Позиции")],-1)),s("div",Cte,[(w(!0),i(p,null,f(n.value,(e,a)=>(w(),i("div",{key:a,class:"position-item"},[s("div",Ate,[s("span",Ete,v(e.ticker),1),s("span",{class:c(["pos-type",e.type])},v(e.type.toUpperCase()),3)]),s("div",Ite,[s("div",Rte,[t[7]||(t[7]=s("span",null,"K:",-1)),s("span",null,v(e.strike),1)]),s("div",Dte,[t[8]||(t[8]=s("span",null,"Кол-во:",-1)),T(s("input",{"onUpdate:modelValue":t=>e.quantity=t,type:"number",min:"0",onChange:g,class:"pos-input"},null,40,Pte),[[k,e.quantity,void 0,{number:!0}]])]),s("div",Lte,[t[9]||(t[9]=s("span",null,"Цена:",-1)),s("span",null,v(e.price.toFixed(2)),1)]),s("div",Nte,[t[10]||(t[10]=s("span",null,"Сумма:",-1)),s("span",Ote,v((e.price*e.quantity).toFixed(2)),1)])]),s("button",{class:"btn-delete-small",onClick:e=>(e=>{n.value.splice(e,1),g()})(a)},"✕",8,Fte)]))),128))])])]),s("main",Bte,[s("div",Ute,[t[30]||(t[30]=s("div",{class:"chart-header"},[s("h3",null,"Агрегированные греки")],-1)),s("div",zte,[s("div",Vte,[t[12]||(t[12]=s("div",{class:"greek-icon"},"Δ",-1)),t[13]||(t[13]=s("div",{class:"greek-title"},"Дельта",-1)),s("div",Hte,v(r.delta.toFixed(2)),1),t[14]||(t[14]=s("div",{class:"greek-info"},"Позиция в базовом активе",-1))]),s("div",Gte,[t[15]||(t[15]=s("div",{class:"greek-icon"},"Γ",-1)),t[16]||(t[16]=s("div",{class:"greek-title"},"Гамма",-1)),s("div",Wte,v(r.gamma.toFixed(6)),1),t[17]||(t[17]=s("div",{class:"greek-info"},"Кривизна портфеля",-1))]),s("div",qte,[t[18]||(t[18]=s("div",{class:"greek-icon"},"ν",-1)),t[19]||(t[19]=s("div",{class:"greek-title"},"Вега",-1)),s("div",Yte,v(r.vega.toFixed(2)),1),t[20]||(t[20]=s("div",{class:"greek-info"},"Чувствительность к vol",-1))]),s("div",jte,[t[21]||(t[21]=s("div",{class:"greek-icon"},"Θ",-1)),t[22]||(t[22]=s("div",{class:"greek-title"},"Тета",-1)),s("div",{class:c(["greek-value",r.theta<0?"text-red":"text-green"])},v(r.theta.toFixed(2)),3),t[23]||(t[23]=s("div",{class:"greek-info"},"Дневная убыль времени",-1))]),s("div",Xte,[t[24]||(t[24]=s("div",{class:"greek-icon"},"ρ",-1)),t[25]||(t[25]=s("div",{class:"greek-title"},"Ро",-1)),s("div",$te,v(r.rho.toFixed(2)),1),t[26]||(t[26]=s("div",{class:"greek-info"},"Чувствительность к ставкам",-1))]),s("div",Kte,[t[27]||(t[27]=s("div",{class:"greek-icon"},null,-1)),t[28]||(t[28]=s("div",{class:"greek-title"},"Риск",-1)),s("div",Zte,v(Math.abs(d.value).toFixed(2)),1),t[29]||(t[29]=s("div",{class:"greek-info"},"Максимальный убыток",-1))])])]),s("div",Jte,[t[37]||(t[37]=s("div",{class:"chart-header"},[s("h3",null,"Сценарный анализ P&L")],-1)),s("div",Qte,[s("div",eae,[t[31]||(t[31]=s("div",{class:"scenario-label"},"Спот +5%",-1)),s("div",{class:c(["scenario-value",b(5)>0?"text-green":"text-red"])},v(b(5).toFixed(2)),3)]),s("div",tae,[t[32]||(t[32]=s("div",{class:"scenario-label"},"Спот +2.5%",-1)),s("div",{class:c(["scenario-value",b(2.5)>0?"text-green":"text-red"])},v(b(2.5).toFixed(2)),3)]),s("div",aae,[t[33]||(t[33]=s("div",{class:"scenario-label"},"Спот без изм.",-1)),s("div",{class:c(["scenario-value",b(0)>0?"text-green":"text-red"])},v(b(0).toFixed(2)),3)]),s("div",nae,[t[34]||(t[34]=s("div",{class:"scenario-label"},"Спот -2.5%",-1)),s("div",{class:c(["scenario-value",b(-2.5)>0?"text-green":"text-red"])},v(b(-2.5).toFixed(2)),3)]),s("div",rae,[t[35]||(t[35]=s("div",{class:"scenario-label"},"Спот -5%",-1)),s("div",{class:c(["scenario-value",b(-5)>0?"text-green":"text-red"])},v(b(-5).toFixed(2)),3)]),s("div",iae,[t[36]||(t[36]=s("div",{class:"scenario-label"},"Vol +10%",-1)),s("div",{class:c(["scenario-value",b(0,10)>0?"text-green":"text-red"])},v(b(0,10).toFixed(2)),3)])])]),s("div",oae,[t[39]||(t[39]=s("div",{class:"chart-header"},[s("h3",null,"Матрица P&L (Спот vs Волатильность)")],-1)),s("div",sae,[s("table",lae,[t[38]||(t[38]=s("thead",null,[s("tr",null,[s("th",null,"Спот / Vol"),s("th",null,"Vol -2%"),s("th",null,"Vol -1%"),s("th",null,"Vol базовое"),s("th",null,"Vol +1%"),s("th",null,"Vol +2%")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(l.value,(e,t)=>(w(),i("tr",{key:t},[s("td",cae,v([-5,-2.5,0,2.5,5][t])+"%",1),(w(!0),i(p,null,f(e,(e,t)=>(w(),i("td",{key:t,class:c({positive:e>0,negative:e<0})},v(e.toFixed(2)),3))),128))]))),128))])])])]),s("div",uae,[t[48]||(t[48]=s("div",{class:"chart-header"},[s("h3",null,"Риск-метрики")],-1)),s("div",dae,[s("div",hae,[t[40]||(t[40]=s("div",{class:"metric-label"},"Макс. прибыль",-1)),s("div",pae,v(u.value.toFixed(2)),1),t[41]||(t[41]=s("div",{class:"metric-info"},"Максимальный выигрыш",-1))]),s("div",fae,[t[42]||(t[42]=s("div",{class:"metric-label"},"Макс. убыток",-1)),s("div",mae,v(d.value.toFixed(2)),1),t[43]||(t[43]=s("div",{class:"metric-info"},"Максимальный убыток",-1))]),s("div",vae,[t[44]||(t[44]=s("div",{class:"metric-label"},"Точка безубыточности",-1)),s("div",gae,v(h.value.toFixed(2)),1),t[45]||(t[45]=s("div",{class:"metric-info"},"Точка безубыточности",-1))]),s("div",yae,[t[46]||(t[46]=s("div",{class:"metric-label"},"Риск/Доходность",-1)),s("div",bae,v((Math.abs(d.value)/Math.abs(u.value)||0).toFixed(2)),1),t[47]||(t[47]=s("div",{class:"metric-info"},"Соотношение риска",-1))])])])])])]))}}),wae=xe(xae,[["__scopeId","data-v-274cfc8d"]]),_ae=_("swapRegistry",()=>{const e=t([]),a=t([]),n=t((new Date).toISOString().split("T")[0]),r=S(()=>e.value.length),i=S(()=>e.value.filter((e,t)=>null!==a.value[t]&&void 0!==a.value[t])),o=S(()=>a.value.reduce((e,t)=>e+(t?.dv01||0),0)),s=S(()=>a.value.reduce((e,t)=>e+(t?.swapValue||0),0)),l=S(()=>a.value.reduce((e,t)=>e+(t?.convexity||0),0)),c=S(()=>a.value.reduce((e,t)=>e+(t?.spreadDv01||0),0));return{registrySwaps:e,swapResults:a,valuationDate:n,totalSwaps:r,calculatedSwaps:i,totalDv01:o,totalSwapValue:s,totalConvexity:l,totalSpreadDv01:c,addSwap:function(t){const n={...t,id:t.id||`swap_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return e.value.push(n),a.value.push(null),n.id},updateSwap:function(t,a){const n=e.value.findIndex(e=>e.id===t);-1!==n&&(e.value[n]={...e.value[n],...a})},removeSwap:function(t){const n=e.value.findIndex(e=>e.id===t);-1!==n&&(e.value.splice(n,1),a.value.splice(n,1))},loadRegistry:function(t){e.value=t.map((e,t)=>({...e,id:e.id||`swap_${Date.now()}_${t}_${Math.random().toString(36).substr(2,9)}`})),a.value=new Array(t.length).fill(null)},clearRegistry:function(){e.value=[],a.value=[]},setSwapResult:function(t,n){t>=0&&t<a.value.length&&(a.value[t]=n,t<e.value.length&&(e.value[t].valuationResult=n||void 0))},setAllResults:function(t){a.value=[...t],t.forEach((t,a)=>{a<e.value.length&&(e.value[a].valuationResult=t||void 0)})},setValuationDate:function(e){n.value=e},getSwapByIndex:function(t){return e.value[t]||null},getResultByIndex:function(e){return a.value[e]||null},getSwapsByType:function(t){return e.value.filter(e=>e.swapType===t)}}}),Sae={class:"stress-swap-page"},Mae={class:"page-header"},Tae={class:"header-right"},kae={class:"control-group"},Cae={class:"multiplier-control"},Aae={class:"multiplier-display"},Eae=["disabled"],Iae={key:0},Rae={key:1},Dae={class:"filters-bar"},Pae=["onClick"],Lae={class:"filter-icon"},Nae={class:"filter-text"},Oae={class:"scenarios-container"},Fae={class:"scenarios-grid"},Bae=["onClick"],Uae={class:"tile-header"},zae={class:"tile-title"},Vae={class:"severity-indicator"},Hae={class:"tile-description"},Gae={class:"tile-metrics"},Wae={class:"metric-probability"},qae={key:0,class:"details-container"},Yae={class:"details-left"},jae={class:"card"},Xae={class:"card-header"},$ae={class:"metrics-grid"},Kae={class:"metric-box"},Zae={class:"metric-box"},Jae={class:"metric-num accent"},Qae={class:"metric-box"},ene={class:"metric-num blue"},tne={class:"metric-box"},ane={class:"metric-num"},nne={class:"card"},rne={class:"greeks-grid"},ine={class:"greek-item"},one={class:"greek-val accent"},sne={class:"greek-item"},lne={class:"greek-val blue"},cne={class:"greek-item"},une={class:"greek-val green"},dne={class:"greek-item"},hne={class:"greek-val purple"},pne={class:"card"},fne={class:"krd-bars"},mne={class:"krd-label"},vne={class:"krd-track"},gne={class:"details-right"},yne={class:"card"},bne={class:"shocks-list"},xne={class:"shock-label"},wne={class:"card"},_ne={class:"positions-list"},Sne={class:"pos-name"},Mne={class:"card info-card"},Tne={class:"info-item"},kne={class:"table-container"},Cne={class:"data-table"},Ane=["onClick"],Ene={class:"col-name"},Ine={class:"col-type"},Rne={class:"col-value accent"},Dne={class:"col-value blue"},Pne={class:"col-value accent"},Lne=e({__name:"StressTestingSwap",setup(e){const a=_ae(),n=t(!1),r=t(1),o=t("curve"),d=t([{id:"curve",name:"Сдвиг кривой",icon:""},{id:"spread",name:"Спред",icon:""},{id:"vol",name:"Волатильность",icon:""},{id:"twist",name:"Кривизна",icon:""}]),g=t([{id:1,name:"Параллельный сдвиг +200 bp",description:"Все ставки растут на 200 базисных пункта",shockType:"Curve",pnlImpact:-285e3,dv01Change:-28.5,spreadDv01:0,delta:5.2,gamma:.018,vega:-12.5,theta:1.2,duration:"1–2 дня",probability:.08,severity:"high",marketShocks:{"Key Rate (2Y)":"+200 bp","Key Rate (5Y)":"+200 bp","Key Rate (10Y)":"+200 bp",Volatility:"-5%"},keyRateDurations:{"2Y":-3.5,"5Y":-8.2,"10Y":-5.1,"30Y":-2.8},positionImpact:{"IRS Payer 5Y":-145e3,"IRS Receiver 2Y":25e3,"Bond Hold":-165e3}},{id:2,name:"Параллельный сдвиг −200 bp",description:"Все ставки падают на 200 базисных пункта",shockType:"Curve",pnlImpact:285e3,dv01Change:28.5,spreadDv01:0,delta:-5.2,gamma:.018,vega:12.5,theta:-1.2,duration:"1–2 дня",probability:.08,severity:"high",marketShocks:{"Key Rate (2Y)":"-200 bp","Key Rate (5Y)":"-200 bp","Key Rate (10Y)":"-200 bp",Volatility:"+5%"},keyRateDurations:{"2Y":3.5,"5Y":8.2,"10Y":5.1,"30Y":2.8},positionImpact:{"IRS Payer 5Y":145e3,"IRS Receiver 2Y":-25e3,"Bond Hold":165e3}},{id:3,name:"Крутизна кривой (Twist)",description:"Короткие ставки +150 bp, длинные −50 bp",shockType:"Curve",pnlImpact:-45200,dv01Change:-8.5,spreadDv01:.5,delta:2.1,gamma:.025,vega:-8.3,theta:.6,duration:"2–5 дней",probability:.18,severity:"medium",marketShocks:{"Key Rate (2Y)":"+150 bp","Key Rate (5Y)":"+50 bp","Key Rate (10Y)":"-50 bp",Slope:"−200 bp"},keyRateDurations:{"2Y":-2.8,"5Y":1.2,"10Y":3.5,"30Y":1.1},positionImpact:{"IRS Payer 5Y":-32e3,"IRS Receiver 10Y":18e3,"Curve Trade":-31200}},{id:4,name:"Бабочка (Butterfly)",description:"Середина кривой сдвигается относительно краёв",shockType:"Curve",pnlImpact:18500,dv01Change:3.2,spreadDv01:-.8,delta:1.5,gamma:.035,vega:-3.1,theta:.4,duration:"3–10 дней",probability:.25,severity:"low",marketShocks:{"Key Rate (2Y)":"+50 bp","Key Rate (5Y)":"-100 bp","Key Rate (10Y)":"+50 bp"},keyRateDurations:{"2Y":1.2,"5Y":-3.5,"10Y":1.8,"30Y":-.5},positionImpact:{"IRS Payer 5Y":28500,"Butterfly Trade":12e3,"Long Bond":-22e3}},{id:5,name:"Кредитный спред +100 bp",description:"Широкое расширение spreads (OAS +100 bp)",shockType:"Spread",pnlImpact:-125400,dv01Change:0,spreadDv01:5.2,delta:.8,gamma:.008,vega:-15.2,theta:.2,duration:"1–5 дней",probability:.12,severity:"high",marketShocks:{OAS:"+100 bp","Credit Curve":"−25 bp","Term Spread":"+75 bp",Vol:"+8%"},keyRateDurations:{"2Y":-.5,"5Y":-2.1,"10Y":-1.8,"30Y":-.9},positionImpact:{"Corporate Bonds":-85e3,"Credit Default Swaps":-40400,IRS:0}},{id:6,name:"Кредитный спред −50 bp",description:"Сжатие spreads (OAS −50 bp)",shockType:"Spread",pnlImpact:62700,dv01Change:0,spreadDv01:-2.6,delta:-.4,gamma:.008,vega:7.6,theta:-.1,duration:"2–10 дней",probability:.2,severity:"medium",marketShocks:{OAS:"−50 bp","Credit Curve":"+15 bp","Term Spread":"−35 bp",Vol:"−4%"},keyRateDurations:{"2Y":.3,"5Y":1.1,"10Y":.9,"30Y":.5},positionImpact:{"Corporate Bonds":45e3,CDS:18e3,IRS:-300}},{id:7,name:"Скачок vol ставок (Swaption)",description:"Волатильность swap rates +300 bp (ATM vol +5%)",shockType:"Vol",pnlImpact:-95300,dv01Change:2.5,spreadDv01:0,delta:1.2,gamma:.012,vega:18.5,theta:-.8,duration:"1–3 дня",probability:.06,severity:"high",marketShocks:{"Volatility (ATM)":"+5%","Implied Vol":"+500 bp",Skew:"+50 bp","Term Vol":"+3%"},keyRateDurations:{"2Y":.8,"5Y":2.3,"10Y":1.5,"30Y":.6},positionImpact:{"Swaptions (Long)":85e3,IRS:-15e3,"Vol Hedges":-165300}},{id:8,name:"Падение vol ставок",description:"Волатильность swap rates −200 bp",shockType:"Vol",pnlImpact:63500,dv01Change:-1.8,spreadDv01:0,delta:-.8,gamma:-.012,vega:-12.3,theta:.5,duration:"5–15 дней",probability:.15,severity:"medium",marketShocks:{"Volatility (ATM)":"−3.5%","Implied Vol":"−350 bp",Skew:"−30 bp","Term Vol":"−2%"},keyRateDurations:{"2Y":-.6,"5Y":-1.8,"10Y":-1.1,"30Y":-.5},positionImpact:{"Swaptions (Short)":78500,"Vol Trades":-15e3}},{id:9,name:"Шоковый сценарий",description:"Комбинация: ставки +150 bp, спред +75 bp, vol +4%",shockType:"Curve",pnlImpact:-425600,dv01Change:-32.1,spreadDv01:3.8,delta:7.5,gamma:.042,vega:-28.4,theta:.8,duration:"1–2 дня",probability:.02,severity:"critical",marketShocks:{Curve:"+150 bp",OAS:"+75 bp",Volatility:"+4%",Correlation:"+0.35"},keyRateDurations:{"2Y":-5.2,"5Y":-12.5,"10Y":-9.3,"30Y":-5.1},positionImpact:{"IRS Payer 5Y":-245e3,"Corp Bonds":-125e3,Swaptions:-55600}}]),b=t(g.value[0]),x=S(()=>{if(0===a.totalSwaps)return g.value;const e=a.totalDv01,t=a.totalSpreadDv01;return a.totalSwapValue,g.value.map(n=>{const r=0!==e?e/125e3:1,i=n.pnlImpact*r,o=n.dv01Change*r,s={};return a.registrySwaps.forEach((e,t)=>{const r=a.getResultByIndex(t);if(r){const t=`${e.swapType.toUpperCase()} ${e.tenor}Y`;s[t]=r.dv01*n.dv01Change/10}}),{...n,pnlImpact:i,dv01Change:o,spreadDv01:t*(n.spreadDv01/85e3),positionImpact:Object.keys(s).length>0?s:n.positionImpact}})}),_=S(()=>{const e={curve:"Curve",spread:"Spread",vol:"Vol",twist:"Curve"};return x.value.filter(t=>t.shockType===e[o.value])});R(()=>a.totalSwaps,()=>{x.value.length>0&&(b.value=x.value[0])});const C=e=>{b.value=e},A=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),E=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",I=e=>({"Volatility (ATM)":"Vol (ATM)","Key Rate (2Y)":"Rate 2Y","Key Rate (5Y)":"Rate 5Y","Key Rate (10Y)":"Rate 10Y",OAS:"OAS Spread"}[e]||e),D=async()=>{if(!n.value){n.value=!0;try{for(let e=0;e<=100;e+=20)await new Promise(e=>setTimeout(e,250))}catch(TQe){console.error(TQe)}finally{n.value=!1}}};return(e,t)=>(w(),i("div",Sae,[s("div",Mae,[t[2]||(t[2]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Стресс-тест СВОП портфеля"),s("p",{class:"page-subtitle"},"Анализ чувствительности к сдвигам кривой, спредам и волатильности")],-1)),s("div",Tae,[s("div",kae,[t[1]||(t[1]=s("label",{class:"control-label"},"Множитель:",-1)),s("div",Cae,[T(s("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),step:.1,min:.5,max:3,class:"range-input"},null,512),[[k,r.value,void 0,{number:!0}]]),s("span",Aae,v(r.value.toFixed(1))+"x",1)])]),s("button",{onClick:D,class:"btn-primary",disabled:n.value},[n.value?(w(),i("span",Rae,"Считаю...")):(w(),i("span",Iae,"Запустить"))],8,Eae)])]),s("div",Dae,[(w(!0),i(p,null,f(d.value,e=>(w(),i("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["filter-btn",{active:o.value===e.id}])},[s("span",Lae,v(e.icon),1),s("span",Nae,v(e.name),1)],10,Pae))),128))]),s("div",Oae,[t[3]||(t[3]=s("div",{class:"grid-header"},"Сценарии стресс-тестирования",-1)),s("div",Fae,[(w(!0),i(p,null,f(_.value,e=>{return w(),i("div",{key:e.id,onClick:t=>C(e),class:c(["scenario-tile",{active:b.value?.id===e.id}])},[s("div",Uae,[s("h3",zae,v(e.name),1),s("span",Vae,v((t=e.severity,{critical:"",high:"",medium:"",low:""}[t]||"")),1)]),s("p",Hae,v(e.description),1),s("div",Gae,[s("span",{class:c(["metric-value",e.pnlImpact<0?"loss":"gain"])},v(E(e.pnlImpact*r.value)),3),s("span",Wae,"Вер.: "+v((100*e.probability).toFixed(0))+"%",1)])],10,Bae);var t}),128))])]),u(M,{name:"expand"},{default:h(()=>[b.value?(w(),i("div",qae,[s("div",Yae,[s("div",jae,[s("div",Xae,[s("h3",null,v(b.value.name),1)]),s("div",$ae,[s("div",Kae,[t[4]||(t[4]=s("span",{class:"metric-label"},"Влияние на P&L",-1)),s("span",{class:c(["metric-num",b.value.pnlImpact<0?"loss":"gain"])},v(A(b.value.pnlImpact*r.value)),3)]),s("div",Zae,[t[5]||(t[5]=s("span",{class:"metric-label"},"DV01 Δ",-1)),s("span",Jae,v((b.value.dv01Change*r.value).toFixed(1))+"М ",1)]),s("div",Qae,[t[6]||(t[6]=s("span",{class:"metric-label"},"Spread DV01",-1)),s("span",ene,v((b.value.spreadDv01*r.value).toFixed(2))+"М ",1)]),s("div",tne,[t[7]||(t[7]=s("span",{class:"metric-label"},"Длительность",-1)),s("span",ane,v(b.value.duration),1)])])]),s("div",nne,[t[20]||(t[20]=s("div",{class:"card-header"},[s("h3",null,"Греки")],-1)),s("div",rne,[s("div",ine,[t[8]||(t[8]=s("span",{class:"greek-symbol"},"Δ",-1)),t[9]||(t[9]=s("span",{class:"greek-name"},"Delta",-1)),s("span",one,v(b.value.delta.toFixed(3)),1),t[10]||(t[10]=s("span",{class:"greek-unit"},"М/100bp",-1))]),s("div",sne,[t[11]||(t[11]=s("span",{class:"greek-symbol"},"Γ",-1)),t[12]||(t[12]=s("span",{class:"greek-name"},"Gamma",-1)),s("span",lne,v(b.value.gamma.toFixed(4)),1),t[13]||(t[13]=s("span",{class:"greek-unit"},"bp²",-1))]),s("div",cne,[t[14]||(t[14]=s("span",{class:"greek-symbol"},"V",-1)),t[15]||(t[15]=s("span",{class:"greek-name"},"Vega",-1)),s("span",une,v(b.value.vega.toFixed(2)),1),t[16]||(t[16]=s("span",{class:"greek-unit"},"М/% vol",-1))]),s("div",dne,[t[17]||(t[17]=s("span",{class:"greek-symbol"},"Θ",-1)),t[18]||(t[18]=s("span",{class:"greek-name"},"Theta",-1)),s("span",hne,v(b.value.theta.toFixed(2)),1),t[19]||(t[19]=s("span",{class:"greek-unit"},"М/день",-1))])])]),s("div",pne,[t[21]||(t[21]=s("div",{class:"card-header"},[s("h3",null,"Срочный риск (Key Rate Durations)")],-1)),s("div",fne,[(w(!0),i(p,null,f(b.value.keyRateDurations,(e,t)=>(w(),i("div",{key:t,class:"krd-row"},[s("span",mne,v(t),1),s("div",vne,[s("div",{class:c(["krd-bar",e<0?"negative":"positive"]),style:y({width:Math.min(100,Math.abs(e*r.value*8))+"%"})},null,6)]),s("span",{class:c(["krd-value",e<0?"loss":"gain"])},v(e>0?"+":"")+v((e*r.value).toFixed(2)),3)]))),128))])])]),s("div",gne,[s("div",yne,[t[22]||(t[22]=s("div",{class:"card-header"},[s("h3",null,"Параметры шока")],-1)),s("div",bne,[(w(!0),i(p,null,f(b.value.marketShocks,(e,t)=>(w(),i("div",{key:t,class:"shock-row"},[s("span",xne,v(I(t)),1),s("span",{class:c(["shock-val",e.includes("-")?"loss":"gain"])},v(e),3)]))),128))])]),s("div",wne,[t[23]||(t[23]=s("div",{class:"card-header"},[s("h3",null,"Позиции под риском")],-1)),s("div",_ne,[(w(!0),i(p,null,f(b.value.positionImpact,(e,t)=>(w(),i("div",{key:t,class:"position-row"},[s("span",Sne,v(t),1),s("span",{class:c(["pos-val",e<0?"loss":"gain"])},v(e>0?"+":"")+v(E(e*r.value)),3)]))),128))])]),s("div",Mne,[s("div",Tne,[t[24]||(t[24]=s("strong",null,"Множитель:",-1)),m(" "+v(r.value.toFixed(1))+"x ",1)]),t[25]||(t[25]=s("div",{class:"info-item"},[s("strong",null,"Расчёт:"),m(" В реальном времени ")],-1)),t[26]||(t[26]=s("div",{class:"info-item"},[s("strong",null,"Модель:"),m(" Vasicek ")],-1))])])])):l("",!0)]),_:1}),s("div",kne,[t[28]||(t[28]=s("div",{class:"table-header"},"Матрица стресс-тестов",-1)),s("table",Cne,[t[27]||(t[27]=s("thead",null,[s("tr",null,[s("th",{class:"col-name"},"Сценарий"),s("th",{class:"col-type"},"Тип"),s("th",{class:"col-value"},"P&L"),s("th",{class:"col-value"},"ΔDV01"),s("th",{class:"col-value"},"Spread DV01"),s("th",{class:"col-value"},"Вероят.")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(x.value,e=>(w(),i("tr",{key:e.id,class:c(["table-row",{active:b.value?.id===e.id}]),onClick:t=>C(e)},[s("td",Ene,v(e.name),1),s("td",Ine,v(e.shockType),1),s("td",{class:c(["col-value",e.pnlImpact<0?"loss":"gain"])},v(A(e.pnlImpact*r.value)),3),s("td",Rne,v((e.dv01Change*r.value).toFixed(1)),1),s("td",Dne,v((e.spreadDv01*r.value).toFixed(2)),1),s("td",Pne,v((100*e.probability).toFixed(0))+"%",1)],10,Ane))),128))])])]),t[29]||(t[29]=s("div",{class:"page-footer"},[s("span",null,"• Историческое моделирование Vasicek"),s("span",null,"• Пересмотр каждые 2 недели"),s("span",null,"• Коррелированные шоки между параметрами")],-1))]))}}),Nne=xe(Lne,[["__scopeId","data-v-3d4dcc79"]]),One={class:"swap-greeks-page"},Fne={class:"page-header"},Bne={class:"header-right"},Une={class:"control-group"},zne={class:"control-group"},Vne={class:"greeks-overview"},Hne={class:"greek-card dv01"},Gne={class:"greek-content"},Wne={class:"greek-value"},qne={class:"greek-bar"},Yne={class:"greek-card spread-dv01"},jne={class:"greek-content"},Xne={class:"greek-value"},$ne={class:"greek-bar"},Kne={class:"greek-card basis-risk"},Zne={class:"greek-content"},Jne={class:"greek-value"},Qne={class:"greek-bar"},ere={class:"greek-card convexity"},tre={class:"greek-content"},are={class:"greek-value"},nre={class:"greek-bar"},rre={class:"greek-card vol-exposure"},ire={class:"greek-content"},ore={class:"greek-value"},sre={class:"greek-bar"},lre={class:"card full-width"},cre={class:"krd-container"},ure={class:"krd-tenor"},dre={class:"krd-bar-container"},hre={class:"grid-2"},pre={class:"card"},fre={class:"swap-positions"},mre={class:"swap-header"},vre={class:"swap-name"},gre={class:"swap-tenor"},yre={class:"swap-metrics"},bre={class:"metric"},xre={class:"metric"},wre={class:"metric"},_re={class:"value mono"},Sre={class:"card"},Mre={class:"swap-positions"},Tre={class:"swap-header"},kre={class:"swap-name"},Cre={class:"swap-tenor"},Are={class:"swap-metrics"},Ere={class:"metric"},Ire={class:"metric"},Rre={class:"metric"},Dre={class:"value mono"},Pre={class:"grid-2"},Lre={class:"card"},Nre={class:"chart-container"},Ore={class:"card"},Fre={class:"chart-container"},Bre={class:"grid-2"},Ure={class:"card"},zre={class:"chart-container"},Vre={class:"card"},Hre={class:"chart-container"},Gre={class:"card full-width"},Wre={class:"scenario-container"},qre={class:"scenario-table"},Yre={class:"scenario-name"},jre={class:"card full-width"},Xre={class:"basis-analysis"},$re={class:"basis-item"},Kre={class:"basis-value accent"},Zre={class:"basis-item"},Jre={class:"basis-item"},Qre={class:"basis-value"},eie={class:"basis-item"},tie=e({__name:"SwapGreeksDashboard",setup(e){const a=_ae(),r=t("all"),o=t("rub3m"),l=S(()=>a.totalSwaps>0?{dv01:a.totalDv01,spreadDv01:a.totalSpreadDv01,basisRisk:.5*a.totalSpreadDv01,convexity:a.totalConvexity,volExposure:.44*a.totalDv01}:{dv01:125e3,spreadDv01:85e3,basisRisk:42e3,convexity:2.15,volExposure:55e3}),u=t({"2Y":-1.25,"3Y":-2.15,"5Y":-3.85,"7Y":-2.95,"10Y":-1.85,"15Y":-.95,"20Y":-.35,"30Y":.05}),d=S(()=>0===a.totalSwaps?[{id:1,name:"IRS Payer",tenor:"5Y",direction:"Payer",dv01:-145e3,spread:25,notional:1e8}]:a.registrySwaps.map((e,t)=>{const n=a.getResultByIndex(t),r=`${e.tenor}Y`;return{id:e.id||t,name:`${e.swapType.toUpperCase()} ${"irs"===e.swapType?"Payer":"Swap"}`,tenor:r,direction:"Payer",dv01:n?.dv01||0,spread:e.spread,notional:1e6*e.notional}}).filter(e=>e.dv01<0)),h=S(()=>0===a.totalSwaps?[{id:4,name:"IRS Receiver",tenor:"2Y",direction:"Receiver",dv01:45e3,spread:15,notional:75e6}]:a.registrySwaps.map((e,t)=>{const n=a.getResultByIndex(t),r=`${e.tenor}Y`;return{id:e.id||t,name:`${e.swapType.toUpperCase()} Receiver`,tenor:r,direction:"Receiver",dv01:n?.dv01||0,spread:e.spread,notional:1e6*e.notional}}).filter(e=>e.dv01>0)),m=t([{name:"Bear (Rates Up)",rate50:-62500,rate100:-125e3,rateNeg50:62500,rateNeg100:125e3,spread50:-42500,spreadNeg50:42500},{name:"Bull (Rates Down)",rate50:62500,rate100:125e3,rateNeg50:-62500,rateNeg100:-125e3,spread50:42500,spreadNeg50:-42500},{name:"Steepening",rate50:35e3,rate100:52e3,rateNeg50:-35e3,rateNeg100:-52e3,spread50:15e3,spreadNeg50:-15e3},{name:"Flattening",rate50:-28e3,rate100:-45e3,rateNeg50:28e3,rateNeg100:45e3,spread50:-12e3,spreadNeg50:12e3}]),g=t({currentSpread:18,basisDv01:42e3,basVol:8.5,pnlSpread25:-10500}),b=t(null),x=t(null),_=t(null),M=t(null);let k=null,C=null,A=null,E=null;const R=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),P=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",L=e=>e>0?"pnl-positive":e<0?"pnl-negative":"pnl-neutral";return n(()=>{setTimeout(()=>(k&&k.destroy(),C&&C.destroy(),A&&A.destroy(),E&&E.destroy(),b.value?.getContext("2d")&&(k=new re(b.value.getContext("2d"),{type:"line",data:{labels:["2Y","3Y","5Y","7Y","10Y","15Y","20Y","30Y"],datasets:[{label:"Par Curve",data:[4.85,4.75,4.65,4.58,4.42,4.35,4.32,4.28],borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!1,tension:.4,pointRadius:4,borderWidth:2},{label:"Spot Curve",data:[4.78,4.68,4.55,4.48,4.32,4.25,4.22,4.18],borderColor:"#38bdf8",backgroundColor:"rgba(56, 189, 248, 0.08)",fill:!1,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),x.value?.getContext("2d")&&(C=new re(x.value.getContext("2d"),{type:"bar",data:{labels:["2Y","3Y","5Y","7Y","10Y","15Y","20Y","30Y"],datasets:[{label:"Par - Spot (bp)",data:[7,7,10,10,10,10,10,10],backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),_.value?.getContext("2d")&&(A=new re(_.value.getContext("2d"),{type:"line",data:{labels:["-100bp","-50bp","0bp","+50bp","+100bp","+150bp","+200bp"],datasets:[{label:"Portfolio P&L",data:[25e4,125e3,0,-125e3,-25e4,-375e3,-5e5],borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),void(M.value?.getContext("2d")&&(E=new re(M.value.getContext("2d"),{type:"line",data:{labels:["-50bp","-25bp","0bp","+25bp","+50bp","+75bp","+100bp"],datasets:[{label:"Portfolio P&L",data:[212500,106250,0,-106250,-212500,-318750,-425e3],borderColor:"#38bdf8",backgroundColor:"rgba(56, 189, 248, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})))),100)}),z(()=>{k&&k.destroy(),C&&C.destroy(),A&&A.destroy(),E&&E.destroy()}),(e,t)=>(w(),i("div",One,[s("div",Fne,[t[6]||(t[6]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Панель греков свопов"),s("p",{class:"page-subtitle"},"Анализ чувствительности swap-портфеля к рыночным факторам")],-1)),s("div",Bne,[s("div",Une,[t[3]||(t[3]=s("label",{class:"control-label"},"Тип свопа:",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),class:"swap-select"},[...t[2]||(t[2]=[I('<option value="all" data-v-1078cd08>Все свопы</option><option value="irs" data-v-1078cd08>Interest Rate Swaps</option><option value="cds" data-v-1078cd08>Credit Default Swaps</option><option value="basis" data-v-1078cd08>Basis Swaps</option><option value="cross-currency" data-v-1078cd08>Cross-Currency Swaps</option>',5)])],512),[[D,r.value]])]),s("div",zne,[t[5]||(t[5]=s("label",{class:"control-label"},"Индекс:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),class:"index-select"},[...t[4]||(t[4]=[s("option",{value:"rub3m"},"RUB 3M RUONIA",-1),s("option",{value:"rub6m"},"RUB 6M RUONIA",-1),s("option",{value:"eur3m"},"EUR 3M EURIBOR",-1),s("option",{value:"gbp6m"},"GBP 6M SONIA",-1)])],512),[[D,o.value]])])])]),s("div",Vne,[s("div",Hne,[t[8]||(t[8]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"ΔV01"),s("span",{class:"greek-name"},"DV01")],-1)),s("div",Gne,[s("div",Wne,v(R(l.value.dv01)),1),t[7]||(t[7]=s("div",{class:"greek-unit"},"М / 1bp",-1)),s("div",{class:c(["greek-change",l.value.dv01>=0?"positive":"negative"])},v(l.value.dv01>=0?"+":"")+v(P(l.value.dv01)),3)]),s("div",qne,[s("div",{class:"bar-fill",style:y({width:Math.min(100,Math.abs(l.value.dv01/5e4))+"%"})},null,4)])]),s("div",Yne,[t[10]||(t[10]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"Δ Spread"),s("span",{class:"greek-name"},"Spread DV01")],-1)),s("div",jne,[s("div",Xne,v(R(l.value.spreadDv01)),1),t[9]||(t[9]=s("div",{class:"greek-unit"},"М / 1bp",-1)),s("div",{class:c(["greek-change",l.value.spreadDv01>=0?"positive":"negative"])},v(l.value.spreadDv01>=0?"+":"")+v(P(l.value.spreadDv01)),3)]),s("div",$ne,[s("div",{class:"bar-fill",style:y({width:Math.min(100,Math.abs(l.value.spreadDv01/3e4))+"%"})},null,4)])]),s("div",Kne,[t[12]||(t[12]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"Δ Basis"),s("span",{class:"greek-name"},"Basis Risk")],-1)),s("div",Zne,[s("div",Jne,v(R(l.value.basisRisk)),1),t[11]||(t[11]=s("div",{class:"greek-unit"},"М / 1bp",-1)),s("div",{class:c(["greek-change",l.value.basisRisk>=0?"positive":"negative"])},v(l.value.basisRisk>=0?"+":"")+v(P(l.value.basisRisk)),3)]),s("div",Qne,[s("div",{class:"bar-fill",style:y({width:Math.min(100,Math.abs(l.value.basisRisk/2e4))+"%"})},null,4)])]),s("div",ere,[t[14]||(t[14]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"Γ"),s("span",{class:"greek-name"},"Convexity")],-1)),s("div",tre,[s("div",are,v(l.value.convexity.toFixed(2)),1),t[13]||(t[13]=s("div",{class:"greek-unit"},"М / bp²",-1)),s("div",{class:c(["greek-change",l.value.convexity>=0?"positive":"negative"])},v(l.value.convexity>=0?"+":"")+v(l.value.convexity.toFixed(2)),3)]),s("div",nre,[s("div",{class:"bar-fill",style:y({width:Math.min(100,Math.abs(20*l.value.convexity))+"%"})},null,4)])]),s("div",rre,[t[16]||(t[16]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"V"),s("span",{class:"greek-name"},"Vol Exposure")],-1)),s("div",ire,[s("div",ore,v(R(l.value.volExposure)),1),t[15]||(t[15]=s("div",{class:"greek-unit"},"М / 1% vol",-1)),s("div",{class:c(["greek-change",l.value.volExposure>=0?"positive":"negative"])},v(l.value.volExposure>=0?"+":"")+v(P(l.value.volExposure)),3)]),s("div",sre,[s("div",{class:"bar-fill",style:y({width:Math.min(100,Math.abs(l.value.volExposure/4e4))+"%"})},null,4)])])]),s("div",lre,[t[17]||(t[17]=s("div",{class:"card-header"},[s("h3",null,"Key Rate Durations (КРД)"),s("span",{class:"card-subtitle"},"Чувствительность по сроках кривой")],-1)),s("div",cre,[(w(!0),i(p,null,f(u.value,(e,t)=>(w(),i("div",{key:t,class:"krd-item"},[s("span",ure,v(t),1),s("div",dre,[s("div",{class:c(["krd-bar",e>=0?"positive":"negative"]),style:y({width:Math.min(100,Math.abs(15*e))+"%"})},null,6)]),s("span",{class:c(["krd-value",e>=0?"positive":"negative"])},v(e>=0?"+":"")+v(e.toFixed(2)),3)]))),128))])]),s("div",hre,[s("div",pre,[t[21]||(t[21]=s("div",{class:"card-header"},[s("h3",null,"Long позиции (Payer)")],-1)),s("div",fre,[(w(!0),i(p,null,f(d.value,e=>(w(),i("div",{key:e.id,class:"swap-item"},[s("div",mre,[s("span",vre,v(e.name),1),s("span",gre,v(e.tenor),1),s("span",{class:c(["swap-status",e.direction.toLowerCase()])},v(e.direction),3)]),s("div",yre,[s("div",bre,[t[18]||(t[18]=s("span",{class:"label"},"DV01",-1)),s("span",{class:c(["value",e.dv01>=0?"positive":"negative"])},v(P(e.dv01)),3)]),s("div",xre,[t[19]||(t[19]=s("span",{class:"label"},"Spread",-1)),s("span",{class:c(["value",e.spread>=0?"positive":"negative"])},v(e.spread>=0?"+":"")+v(e.spread)+" bp ",3)]),s("div",wre,[t[20]||(t[20]=s("span",{class:"label"},"Notional",-1)),s("span",_re,v(R(e.notional)),1)])])]))),128))])]),s("div",Sre,[t[25]||(t[25]=s("div",{class:"card-header"},[s("h3",null,"Short позиции (Receiver)")],-1)),s("div",Mre,[(w(!0),i(p,null,f(h.value,e=>(w(),i("div",{key:e.id,class:"swap-item"},[s("div",Tre,[s("span",kre,v(e.name),1),s("span",Cre,v(e.tenor),1),s("span",{class:c(["swap-status",e.direction.toLowerCase()])},v(e.direction),3)]),s("div",Are,[s("div",Ere,[t[22]||(t[22]=s("span",{class:"label"},"DV01",-1)),s("span",{class:c(["value",e.dv01>=0?"positive":"negative"])},v(P(e.dv01)),3)]),s("div",Ire,[t[23]||(t[23]=s("span",{class:"label"},"Spread",-1)),s("span",{class:c(["value",e.spread>=0?"positive":"negative"])},v(e.spread>=0?"+":"")+v(e.spread)+" bp ",3)]),s("div",Rre,[t[24]||(t[24]=s("span",{class:"label"},"Notional",-1)),s("span",Dre,v(R(e.notional)),1)])])]))),128))])])]),s("div",Pre,[s("div",Lre,[t[26]||(t[26]=s("div",{class:"chart-header"},[s("h3",null,"Кривая свопов")],-1)),s("div",Nre,[s("canvas",{ref_key:"curveChartRef",ref:b},null,512)])]),s("div",Ore,[t[27]||(t[27]=s("div",{class:"chart-header"},[s("h3",null,"Кривая спреда (Par - Spot)")],-1)),s("div",Fre,[s("canvas",{ref_key:"spreadChartRef",ref:x},null,512)])])]),s("div",Bre,[s("div",Ure,[t[28]||(t[28]=s("div",{class:"chart-header"},[s("h3",null,"Чувствительность DV01 (Rate Shock)")],-1)),s("div",zre,[s("canvas",{ref_key:"rateSensitivityRef",ref:_},null,512)])]),s("div",Vre,[t[29]||(t[29]=s("div",{class:"chart-header"},[s("h3",null,"Чувствительность спреда (Spread Shock)")],-1)),s("div",Hre,[s("canvas",{ref_key:"spreadSensitivityRef",ref:M},null,512)])])]),s("div",Gre,[t[31]||(t[31]=s("div",{class:"card-header"},[s("h3",null,"Матрица сценариев (P&L)"),s("span",{class:"card-subtitle"},"Чувствительность к комбинированным шокам")],-1)),s("div",Wre,[s("table",qre,[t[30]||(t[30]=s("thead",null,[s("tr",null,[s("th",null,"Сценарий"),s("th",null,"Rate +50bp"),s("th",null,"Rate +100bp"),s("th",null,"Rate -50bp"),s("th",null,"Rate -100bp"),s("th",null,"Spread +50bp"),s("th",null,"Spread -50bp")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(m.value,e=>(w(),i("tr",{key:e.name},[s("td",Yre,v(e.name),1),s("td",{class:c(L(e.rate50))},v(R(e.rate50)),3),s("td",{class:c(L(e.rate100))},v(R(e.rate100)),3),s("td",{class:c(L(e.rateNeg50))},v(R(e.rateNeg50)),3),s("td",{class:c(L(e.rateNeg100))},v(R(e.rateNeg100)),3),s("td",{class:c(L(e.spread50))},v(R(e.spread50)),3),s("td",{class:c(L(e.spreadNeg50))},v(R(e.spreadNeg50)),3)]))),128))])])])]),s("div",jre,[t[36]||(t[36]=s("div",{class:"card-header"},[s("h3",null,"Риск базиса (3M vs 6M LIBOR)"),s("span",{class:"card-subtitle"},"Риск от расходимости между индексами")],-1)),s("div",Xre,[s("div",$re,[t[32]||(t[32]=s("span",{class:"basis-label"},"Текущий спред базиса",-1)),s("span",Kre,v(g.value.currentSpread)+" bp",1)]),s("div",Zre,[t[33]||(t[33]=s("span",{class:"basis-label"},"Basis DV01",-1)),s("span",{class:c(["basis-value",g.value.basisDv01>=0?"positive":"negative"])},v(P(g.value.basisDv01)),3)]),s("div",Jre,[t[34]||(t[34]=s("span",{class:"basis-label"},"Волатильность базиса",-1)),s("span",Qre,v(g.value.basVol)+"%",1)]),s("div",eie,[t[35]||(t[35]=s("span",{class:"basis-label"},"P&L (Spread +25bp)",-1)),s("span",{class:c(["basis-value",g.value.pnlSpread25>=0?"positive":"negative"])},v(R(g.value.pnlSpread25)),3)])])]),t[37]||(t[37]=s("div",{class:"page-footer"},[s("span",null,"• DV01 — стоимость 1 базисного пункта в долларах"),s("span",null,"• Spread DV01 — чувствительность к спредам"),s("span",null,"• Обновление каждые 5 минут")],-1))]))}}),aie=xe(tie,[["__scopeId","data-v-1078cd08"]]),nie="   https://stochastic-dashbord-v1-production.up.railway.app",rie=async e=>{try{const t=await fetch(`${nie}/api/swap/valuate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Swap Valuation Failed:",QXe),QXe}},iie={class:"swap-valuation-page"},oie={class:"page-header"},sie={class:"header-right"},lie={class:"control-group"},cie={class:"control-group"},uie={class:"control-group"},die=["disabled"],hie={key:0},pie={key:1},fie={key:0,class:"error-message"},mie={key:1,class:"card full-width",style:{"margin-bottom":"24px"}},vie={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},gie={class:"card-subtitle"},yie={style:{display:"flex",gap:"8px"}},bie=["disabled"],xie=["disabled"],wie={key:0},_ie={key:1},Sie=["disabled"],Mie={key:0},Tie={key:1},kie={class:"scenario-table-container"},Cie={class:"scenario-table"},Aie={key:0},Eie={key:1},Iie=["onClick"],Rie={class:"mono"},Die={class:"mono"},Pie={class:"mono"},Lie={class:"mono"},Nie={key:1,class:"mono accent"},Oie=["onClick"],Fie={class:"grid-2"},Bie={class:"card"},Uie={class:"parameter-group"},zie={class:"param-row"},Vie={class:"param-row"},Hie={class:"param-row"},Gie={class:"param-row"},Wie={class:"card"},qie={class:"parameter-group"},Yie={class:"param-row"},jie={class:"param-row"},Xie={class:"param-row"},$ie={class:"param-row"},Kie={class:"grid-3"},Zie={class:"metric-card"},Jie={class:"metric-value accent"},Qie={class:"metric-detail"},eoe={class:"detail-value"},toe={class:"metric-card"},aoe={class:"metric-value blue"},noe={class:"metric-detail"},roe={class:"detail-value"},ioe={class:"metric-card"},ooe={class:"metric-detail"},soe={class:"detail-value"},loe={class:"grid-3"},coe={class:"card"},uoe={class:"metrics-list"},doe={class:"metric-item"},hoe={class:"value"},poe={class:"metric-item"},foe={class:"metric-item"},moe={class:"value mono"},voe={class:"card"},goe={class:"metrics-list"},yoe={class:"metric-item"},boe={class:"value"},xoe={class:"metric-item"},woe={class:"value"},_oe={class:"card"},Soe={class:"metrics-list"},Moe={class:"metric-item"},Toe={class:"value mono"},koe={class:"metric-item"},Coe={class:"value"},Aoe={class:"metric-item"},Eoe={class:"value"},Ioe={class:"card full-width"},Roe={class:"cashflow-table-container"},Doe={class:"cashflow-table"},Poe={class:"col-period"},Loe={class:"col-date mono"},Noe={class:"col-amount accent"},Ooe={class:"col-amount blue"},Foe={class:"col-pv mono"},Boe={class:"grid-2"},Uoe={class:"card"},zoe={class:"chart-container"},Voe={class:"card"},Hoe={class:"chart-container"},Goe={class:"card full-width"},Woe={class:"scenario-container"},qoe={class:"scenario-table"},Yoe={class:"scenario-name"},joe={class:"mono"},Xoe={class:"mono"},$oe={class:"accent"},Koe={class:"blue"},Zoe={class:"grid-3"},Joe={class:"risk-card risk-high"},Qoe={class:"risk-value"},ese={class:"risk-detail"},tse={class:"risk-card risk-medium"},ase={class:"risk-value"},nse={class:"risk-detail"},rse={class:"risk-card risk-low"},ise={class:"risk-value"},ose=e({__name:"SwapValuation",setup(e){const a=_ae(),r=t("irs"),o=t(!1),u=t(""),d=t(null),h=t(null),m=t(!1),g=t(!1),y=S(()=>a.registrySwaps),b=S(()=>a.swapResults),x=S({get:()=>a.valuationDate,set:e=>a.setValuationDate(e)}),_=t({notional:100,tenor:5,fixedRate:4.25,floatingRate:4.15,spread:15,couponsPerYear:2,discountRate:4.2,volatility:12}),M=t({pvFixedLeg:0,pvFloatingLeg:0,swapValue:0,duration:0,dv01:0,spreadDv01:0,convexity:0,cashflows:[],scenarios:[]}),C=S(()=>M.value.scenarios||[]),A=t(null),I=t(null);let R=null,P=null;const L=e=>Math.abs(e)>=1?(e>=0?"+":"")+e.toFixed(2):(e>=0?"+":"")+(1e6*e).toFixed(0),N=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",O=e=>{try{return new Date(e).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return e}},F=()=>{U()},B=async()=>{o.value=!0,u.value="";try{const e=await rie({notional:_.value.notional,tenor:_.value.tenor,fixedRate:_.value.fixedRate,floatingRate:_.value.floatingRate,spread:_.value.spread,couponsPerYear:_.value.couponsPerYear,discountRate:_.value.discountRate,volatility:_.value.volatility,swapType:r.value});M.value=e,F()}catch(e){u.value=e.message||"Ошибка при расчете свопа",console.error("Swap valuation error:",e)}finally{o.value=!1}},U=()=>{R&&R.destroy(),P&&P.destroy(),A.value?.getContext("2d")&&(R=new re(A.value.getContext("2d"),{type:"line",data:{labels:["3.25%","3.75%","4.25%","4.75%","5.25%"],datasets:[{label:"Swap Value",data:[5.8,4.2,2.45,.95,-.5],borderColor:"#38bdf8",backgroundColor:"rgba(56, 189, 248, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),I.value?.getContext("2d")&&(P=new re(I.value.getContext("2d"),{type:"bar",data:{labels:["2Y","3Y","5Y","7Y","10Y"],datasets:[{label:"DV01 (RUB)",data:[28e3,35e3,42500,48e3,52e3],backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}}))},V=async e=>{const t=e.target,n=t.files?.[0];if(n)try{const e=pj(await n.arrayBuffer(),{type:"array"}),t=e.SheetNames[0],r=e.Sheets[t],i=Rj.sheet_to_json(r,{raw:!1}),o=[];for(const a of i){const e={notional:parseFloat(a.Notional||a.notional||a["Номинал"]||a["Номинал (млн)"]||"100"),tenor:parseFloat(a.Tenor||a.tenor||a["Срок"]||a["Срок (лет)"]||a["Срок (годы)"]||"5"),fixedRate:parseFloat(a["Fixed Rate"]||a.fixedRate||a["Фиксированная ставка"]||a["Фикс. ставка"]||a.Fixed||"4.25"),floatingRate:parseFloat(a["Floating Rate"]||a.floatingRate||a["Плавающая ставка"]||a.Floating||a.Index||"4.15"),spread:parseFloat(a.Spread||a.spread||a["Спред"]||a["Спред (bp)"]||"15"),couponsPerYear:parseFloat(a["Coupons Per Year"]||a.couponsPerYear||a["Купонов в год"]||a.Frequency||"2"),discountRate:parseFloat(a["Discount Rate"]||a.discountRate||a["Дисконт кривая"]||a["Базовая ставка"]||"4.2"),volatility:parseFloat(a.Volatility||a.volatility||a["Волатильность"]||a.Vol||"12"),swapType:(a.Type||a["Swap Type"]||a.type||a["Тип"]||a["Тип свопа"]||"irs").toLowerCase()};if(e.swapType&&!["irs","cds","basis","xccy"].includes(e.swapType)){const t={"interest rate swap":"irs","credit default swap":"cds","basis swap":"basis","cross currency":"xccy","cross-currency":"xccy","процентный":"irs","кредитный":"cds","базисный":"basis","валютный":"xccy"};e.swapType=t[e.swapType.toLowerCase()]||"irs"}e.notional>0&&e.tenor>0&&o.push(e)}a.loadRegistry(o),h.value=null}catch(r){console.error("Excel parsing error:",r),u.value=`Ошибка при загрузке файла: ${r.message}`}},H=async()=>{m.value=!0,u.value="";try{const t=[];for(let n=0;n<a.registrySwaps.length;n++){const r=a.registrySwaps[n];try{const e=await rie({notional:r.notional,tenor:r.tenor,fixedRate:r.fixedRate,floatingRate:r.floatingRate,spread:r.spread,couponsPerYear:r.couponsPerYear,discountRate:r.discountRate,volatility:r.volatility,swapType:r.swapType||"irs"});t.push(e),a.setSwapResult(n,e)}catch(e){t.push(null),a.setSwapResult(n,null),console.error(`Error calculating swap ${n+1}:`,e)}}a.setAllResults(t)}catch(e){console.error("Error calculating swaps:",e),u.value=`Ошибка при расчете свопов: ${e.message}`}finally{m.value=!1}},G=()=>{if(0===a.registrySwaps.length)return void alert("Нет данных для экспорта. Загрузите реестр свопов.");const e=a.swapResults.length>0&&a.swapResults.some(e=>e&&null!==e.swapValue&&void 0!==e.swapValue);if(!e){if(!confirm("Свопы еще не рассчитаны. Экспортировать только входные параметры?"))return}const t=a.registrySwaps.map((e,t)=>{const n=a.getResultByIndex(t),r=n?.cashflows?.length||0,i=n?.cashflows?.reduce((e,t)=>e+t.pv,0)||0;return{"№":t+1,"Тип":e.swapType?.toUpperCase()||"IRS","Номинал (млн)":e.notional||0,"Срок (лет)":e.tenor||0,"Фиксированная ставка (%)":e.fixedRate||0,"Плавающая ставка (%)":e.floatingRate||0,"Спред (bp)":e.spread||0,"Купонов в год":e.couponsPerYear||2,"Дисконт кривая (%)":e.discountRate||0,"Волатильность (%)":e.volatility||0,"PV фиксированной ноги (млн)":null!=n?.pvFixedLeg?n.pvFixedLeg.toFixed(6):"","PV плавающей ноги (млн)":null!=n?.pvFloatingLeg?n.pvFloatingLeg.toFixed(6):"","Swap Value (млн)":null!=n?.swapValue?n.swapValue.toFixed(6):"","Swap Value (% номинала)":null!=n?.swapValue&&e.notional>0?(n.swapValue/e.notional*100).toFixed(4)+"%":"","Duration (лет)":null!=n?.duration?n.duration.toFixed(4):"","DV01 (млн/bp)":null!=n?.dv01?(n.dv01/1e6).toFixed(6):"","Spread DV01 (млн/bp)":null!=n?.spreadDv01?(n.spreadDv01/1e6).toFixed(6):"",Convexity:null!=n?.convexity?n.convexity.toFixed(4):"","Количество денежных потоков":r,"Суммарный PV потоков (млн)":0!==i?(i/1e6).toFixed(6):"","Статус расчета":n?"Рассчитан":"Не рассчитан"}}),n=Rj.book_new(),r=Rj.json_to_sheet(t);if(r["!cols"]=[{wch:5},{wch:8},{wch:15},{wch:12},{wch:20},{wch:20},{wch:12},{wch:12},{wch:18},{wch:15},{wch:22},{wch:22},{wch:18},{wch:20},{wch:15},{wch:15},{wch:18},{wch:12},{wch:22},{wch:22},{wch:15}],Rj.book_append_sheet(n,r,"Реестр свопов"),e){const e=[];if(a.registrySwaps.forEach((t,n)=>{const r=a.getResultByIndex(n);r&&r.cashflows&&r.cashflows.length>0&&r.cashflows.forEach((a,r)=>{e.push({"№ свопа":n+1,"Тип":t.swapType?.toUpperCase()||"IRS","Период":r+1,"Дата платежа":O(a.date),"Fixed Leg (млн)":(a.fixedLeg/1e6).toFixed(6),"Floating Leg (млн)":(a.floatingLeg/1e6).toFixed(6),"Net (млн)":(a.net/1e6).toFixed(6),"PV (млн)":(a.pv/1e6).toFixed(6)})})}),e.length>0){const t=Rj.json_to_sheet(e),a=[{wch:8},{wch:8},{wch:8},{wch:12},{wch:18},{wch:18},{wch:15},{wch:15}];t["!cols"]=a,Rj.book_append_sheet(n,t,"Денежные потоки")}}const i=new Date,o=`реестр_свопов_${i.toISOString().split("T")[0]}_${i.toTimeString().split(" ")[0].replace(/:/g,"-")}.xlsx`;try{bj(n,o),alert(`Реестр успешно экспортирован: ${o}\n${e?"Включая все расчеты и денежные потоки.":"Только входные параметры (свопы не рассчитаны)."}`)}catch(s){console.error("Ошибка при экспорте:",s),alert(`Ошибка при экспорте файла: ${s.message}`)}},W=async()=>{if(0!==a.registrySwaps.length){g.value=!0,u.value="";try{const e=await(async e=>{try{const t=await fetch(`${nie}/api/database/export/registry/parquet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registry_type:"swap",data:e})});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(u){throw console.error("Save Registry to Parquet Failed:",u),u}})(a.registrySwaps);e.success&&(u.value=`Реестр успешно сохранен: ${e.data.file_name}`,setTimeout(()=>{u.value=""},5e3))}catch(e){console.error("Error saving registry to parquet:",e),u.value=`Ошибка при сохранении реестра: ${e.message}`}finally{g.value=!1}}},q=()=>{a.clearRegistry(),h.value=null,d.value&&(d.value.value="")},Y=()=>{const e={notional:_.value.notional,tenor:_.value.tenor,fixedRate:_.value.fixedRate,floatingRate:_.value.floatingRate,spread:_.value.spread,couponsPerYear:_.value.couponsPerYear,discountRate:_.value.discountRate,volatility:_.value.volatility,swapType:r.value};a.addSwap(e)};return n(()=>{B()}),z(()=>{R&&R.destroy(),P&&P.destroy()}),(e,t)=>(w(),i("div",iie,[s("div",oie,[t[15]||(t[15]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Оценка свопов"),s("p",{class:"page-subtitle"},"Справедливая стоимость и анализ IRS, CDS, Basis Swaps")],-1)),s("div",sie,[s("div",lie,[t[11]||(t[11]=s("label",{class:"control-label"},"Дата оценки:",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.value=e),type:"date",class:"date-input",onChange:F},null,544),[[k,x.value]])]),s("div",cie,[t[12]||(t[12]=s("label",{class:"control-label"},"Реестр:",-1)),s("input",{type:"file",ref_key:"fileInputRef",ref:d,onChange:V,accept:".xlsx,.xls",style:{display:"none"},id:"excel-upload"},null,544),s("button",{onClick:t[1]||(t[1]=()=>{d.value&&d.value.click()}),class:"btn-secondary",title:"Загрузить реестр свопов из Excel"}," Загрузить Excel ")]),s("div",uie,[t[14]||(t[14]=s("label",{class:"control-label"},"Тип свопа:",-1)),T(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),class:"swap-type-select",onChange:F},[...t[13]||(t[13]=[s("option",{value:"irs"},"Interest Rate Swap (IRS)",-1),s("option",{value:"cds"},"Credit Default Swap (CDS)",-1),s("option",{value:"basis"},"Basis Swap",-1),s("option",{value:"xccy"},"Cross-Currency Swap",-1)])],544),[[D,r.value]])]),s("button",{onClick:Y,class:"btn-secondary",title:"Добавить текущий своп в реестр"}," ➕ Добавить в реестр "),s("button",{onClick:B,class:"btn-primary",disabled:o.value},[o.value?(w(),i("span",pie,"↺ Считаю...")):(w(),i("span",hie,"Пересчитать"))],8,die)])]),u.value?(w(),i("div",fie," ⚠️ "+v(u.value),1)):l("",!0),y.value.length>0?(w(),i("div",mie,[s("div",vie,[s("div",null,[t[16]||(t[16]=s("h3",null,"Реестр свопов",-1)),s("span",gie,"Загружено свопов: "+v(y.value.length),1)]),s("div",yie,[s("button",{onClick:G,class:"btn-secondary",disabled:0===y.value.length,style:{"font-size":"11px",padding:"6px 12px"},title:"Выгрузить реестр в Excel"}," 📥 Выгрузить Excel ",8,bie),s("button",{onClick:W,class:"btn-secondary",disabled:0===y.value.length||g.value,style:{"font-size":"11px",padding:"6px 12px"},title:"Сохранить реестр в Supabase (parquet)"},[g.value?(w(),i("span",_ie,"↺ Сохранение...")):(w(),i("span",wie,"💾 Сохранить в БД"))],8,xie),s("button",{onClick:H,class:"btn-secondary",disabled:m.value,style:{"font-size":"11px",padding:"6px 12px"}},[m.value?(w(),i("span",Tie,"↺ Считаю...")):(w(),i("span",Mie,"Рассчитать все"))],8,Sie),s("button",{onClick:q,class:"btn-secondary",style:{"font-size":"11px",padding:"6px 12px",background:"rgba(239, 68, 68, 0.2)","border-color":"rgba(239, 68, 68, 0.3)"}}," ✕ Очистить ")])]),s("div",kie,[s("table",Cie,[s("thead",null,[s("tr",null,[t[17]||(t[17]=s("th",null,"№",-1)),t[18]||(t[18]=s("th",null,"Тип",-1)),t[19]||(t[19]=s("th",null,"Номинал (млн)",-1)),t[20]||(t[20]=s("th",null,"Срок (лет)",-1)),t[21]||(t[21]=s("th",null,"Фикс. ставка (%)",-1)),t[22]||(t[22]=s("th",null,"Плавающая (%)",-1)),b.value.length>0?(w(),i("th",Aie,"Swap Value")):l("",!0),b.value.length>0?(w(),i("th",Eie,"DV01")):l("",!0),t[23]||(t[23]=s("th",null,"Действие",-1))])]),s("tbody",null,[(w(!0),i(p,null,f(y.value,(e,t)=>(w(),i("tr",{key:t,class:c({selected:h.value===t}),onClick:e=>(e=>{h.value=e})(t)},[s("td",null,v(t+1),1),s("td",null,v(e.swapType?.toUpperCase()||"IRS"),1),s("td",Rie,v(e.notional?e.notional.toFixed(2):"-"),1),s("td",Die,v(e.tenor?e.tenor.toFixed(2):"-"),1),s("td",Pie,v(e.fixedRate?e.fixedRate.toFixed(2)+"%":"-"),1),s("td",Lie,v(e.floatingRate?e.floatingRate.toFixed(2)+"%":"-"),1),b.value.length>0&&b.value[t]?(w(),i("td",{key:0,class:c(["mono",b.value[t]?.swapValue>=0?"positive":"negative"])},v(b.value[t]?.swapValue?L(b.value[t].swapValue):"-"),3)):l("",!0),b.value.length>0&&b.value[t]?(w(),i("td",Nie,v(b.value[t]?.dv01?N(b.value[t].dv01):"-"),1)):l("",!0),s("td",null,[s("button",{onClick:E(e=>(e=>{const t=a.getSwapByIndex(e);t&&(_.value.notional=t.notional||_.value.notional,_.value.tenor=t.tenor||_.value.tenor,_.value.fixedRate=t.fixedRate||_.value.fixedRate,_.value.floatingRate=t.floatingRate||_.value.floatingRate,_.value.spread=t.spread||_.value.spread,_.value.couponsPerYear=t.couponsPerYear||_.value.couponsPerYear,_.value.discountRate=t.discountRate||_.value.discountRate,_.value.volatility=t.volatility||_.value.volatility,r.value=t.swapType||r.value,setTimeout(()=>{B()},100))})(t),["stop"]),class:"btn-small",title:"Загрузить в форму"}," Загрузить ",8,Oie)])],10,Iie))),128))])])])])):l("",!0),s("div",Fie,[s("div",Bie,[t[29]||(t[29]=s("div",{class:"card-header"},[s("h3",null,"Параметры свопа")],-1)),s("div",Uie,[s("div",zie,[t[24]||(t[24]=s("label",null,"Номинал (млн)",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>_.value.notional=e),type:"number",class:"param-input",onChange:F},null,544),[[k,_.value.notional,void 0,{number:!0}]])]),s("div",Vie,[t[25]||(t[25]=s("label",null,"Срок (годы)",-1)),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>_.value.tenor=e),type:"number",class:"param-input",step:"0.5",onChange:F},null,544),[[k,_.value.tenor,void 0,{number:!0}]])]),s("div",Hie,[t[26]||(t[26]=s("label",null,"Фиксированная ставка (%)",-1)),T(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>_.value.fixedRate=e),type:"number",class:"param-input",step:"0.01",onChange:F},null,544),[[k,_.value.fixedRate,void 0,{number:!0}]])]),s("div",Gie,[t[28]||(t[28]=s("label",null,"Купонов в год",-1)),T(s("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>_.value.couponsPerYear=e),class:"param-input",onChange:F},[...t[27]||(t[27]=[s("option",{value:"1"},"1",-1),s("option",{value:"2"},"2 (Раз в полгода)",-1),s("option",{value:"4"},"4 (Ежеквартально)",-1)])],544),[[D,_.value.couponsPerYear,void 0,{number:!0}]])])])]),s("div",Wie,[t[34]||(t[34]=s("div",{class:"card-header"},[s("h3",null,"Рыночные условия")],-1)),s("div",qie,[s("div",Yie,[t[30]||(t[30]=s("label",null,"Индекс плавающей ставки (%)",-1)),T(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>_.value.floatingRate=e),type:"number",class:"param-input",step:"0.01",onChange:F},null,544),[[k,_.value.floatingRate,void 0,{number:!0}]])]),s("div",jie,[t[31]||(t[31]=s("label",null,"Спред (bp)",-1)),T(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>_.value.spread=e),type:"number",class:"param-input",step:"1",onChange:F},null,544),[[k,_.value.spread,void 0,{number:!0}]])]),s("div",Xie,[t[32]||(t[32]=s("label",null,"Дисконт кривая (базовая ставка, %)",-1)),T(s("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>_.value.discountRate=e),type:"number",class:"param-input",step:"0.01",onChange:F},null,544),[[k,_.value.discountRate,void 0,{number:!0}]])]),s("div",$ie,[t[33]||(t[33]=s("label",null,"Волатильность (%)",-1)),T(s("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>_.value.volatility=e),type:"number",class:"param-input",step:"0.1",onChange:F},null,544),[[k,_.value.volatility,void 0,{number:!0}]])])])])]),s("div",Kie,[s("div",Zie,[t[36]||(t[36]=s("div",{class:"metric-header"},[s("h3",null,"PV фиксированной ноги"),s("span",{class:"metric-unit"},"млн RUB")],-1)),s("div",Jie,v(L(M.value.pvFixedLeg)),1),s("div",Qie,[t[35]||(t[35]=s("span",{class:"detail-label"},"Купоны:",-1)),s("span",eoe,v(_.value.couponsPerYear*_.value.tenor)+" шт.",1)])]),s("div",toe,[t[38]||(t[38]=s("div",{class:"metric-header"},[s("h3",null,"PV плавающей ноги"),s("span",{class:"metric-unit"},"млн RUB")],-1)),s("div",aoe,v(L(M.value.pvFloatingLeg)),1),s("div",noe,[t[37]||(t[37]=s("span",{class:"detail-label"},"Forward Rate:",-1)),s("span",roe,v((_.value.floatingRate+_.value.spread/100).toFixed(2))+"%",1)])]),s("div",ioe,[t[40]||(t[40]=s("div",{class:"metric-header"},[s("h3",null,"Стоимость свопа (Payer)"),s("span",{class:"metric-unit"},"млн RUB")],-1)),s("div",{class:c(["metric-value",M.value.swapValue>=0?"positive":"negative"])},v(L(M.value.swapValue)),3),s("div",ooe,[t[39]||(t[39]=s("span",{class:"detail-label"},"В % номинала:",-1)),s("span",soe,v((M.value.swapValue/_.value.notional*100).toFixed(2))+"%",1)])])]),s("div",loe,[s("div",coe,[t[44]||(t[44]=s("div",{class:"card-header"},[s("h3",null,"Анализ Duration")],-1)),s("div",uoe,[s("div",doe,[t[41]||(t[41]=s("span",{class:"label"},"Modified Duration",-1)),s("span",hoe,v(M.value.duration.toFixed(2)),1)]),s("div",poe,[t[42]||(t[42]=s("span",{class:"label"},"DV01 (М/bp)",-1)),s("span",{class:c(["value",M.value.dv01>=0?"positive":"negative"])},v(N(M.value.dv01)),3)]),s("div",foe,[t[43]||(t[43]=s("span",{class:"label"},"BPV (М)",-1)),s("span",moe,v((M.value.dv01/1e4).toFixed(4)),1)])])]),s("div",voe,[t[48]||(t[48]=s("div",{class:"card-header"},[s("h3",null,"Выпуклость")],-1)),s("div",goe,[s("div",yoe,[t[45]||(t[45]=s("span",{class:"label"},"Convexity",-1)),s("span",boe,v(M.value.convexity.toFixed(2)),1)]),s("div",xoe,[t[46]||(t[46]=s("span",{class:"label"},"Gamma (М/bp²)",-1)),s("span",woe,v((M.value.convexity/100).toFixed(4)),1)]),t[47]||(t[47]=s("div",{class:"metric-item"},[s("span",{class:"label"},"Уровень гарантирован"),s("span",{class:"value"},"Низкий")],-1))])]),s("div",_oe,[t[52]||(t[52]=s("div",{class:"card-header"},[s("h3",null,"Спред-метрики")],-1)),s("div",Soe,[s("div",Moe,[t[49]||(t[49]=s("span",{class:"label"},"Spread DV01 (М/bp)",-1)),s("span",Toe,v(N(M.value.spreadDv01)),1)]),s("div",koe,[t[50]||(t[50]=s("span",{class:"label"},"ASW (All-in Swap)",-1)),s("span",Coe,v(_.value.spread)+" bp",1)]),s("div",Aoe,[t[51]||(t[51]=s("span",{class:"label"},"Z-spread",-1)),s("span",Eoe,v((1.05*_.value.spread).toFixed(0))+" bp",1)])])])]),s("div",Ioe,[t[54]||(t[54]=s("div",{class:"card-header"},[s("h3",null,"График денежных потоков"),s("span",{class:"card-subtitle"},"Сравнение фиксированной и плавающей ног")],-1)),s("div",Roe,[s("table",Doe,[t[53]||(t[53]=s("thead",null,[s("tr",null,[s("th",{class:"col-period"},"Период"),s("th",{class:"col-date"},"Дата платежа"),s("th",{class:"col-amount"},"Fixed Leg (М)"),s("th",{class:"col-amount"},"Floating Leg (М)"),s("th",{class:"col-amount"},"Net (М)"),s("th",{class:"col-pv"},"PV (М)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(M.value.cashflows,(e,t)=>(w(),i("tr",{key:t},[s("td",Poe,v(t+1),1),s("td",Loe,v(O(e.date)),1),s("td",Noe,v(L(e.fixedLeg)),1),s("td",Ooe,v(L(e.floatingLeg)),1),s("td",{class:c(["col-amount",e.net>=0?"positive":"negative"])},v(e.net>=0?"+":"")+v(L(e.net)),3),s("td",Foe,v(L(e.pv)),1)]))),128))])])])]),s("div",Boe,[s("div",Uoe,[t[55]||(t[55]=s("div",{class:"chart-header"},[s("h3",null,"Стоимость свопа vs Фиксированная ставка"),s("span",{class:"chart-subtitle"},"Чувствительность к изменению фиксированной ставки")],-1)),s("div",zoe,[s("canvas",{ref_key:"pvProfileRef",ref:A},null,512)])]),s("div",Voe,[t[56]||(t[56]=s("div",{class:"chart-header"},[s("h3",null,"DV01 vs Срок"),s("span",{class:"chart-subtitle"},"Риск по различным срокам")],-1)),s("div",Hoe,[s("canvas",{ref_key:"dv01ProfileRef",ref:I},null,512)])])]),s("div",Goe,[t[58]||(t[58]=s("div",{class:"card-header"},[s("h3",null,"Анализ сценариев"),s("span",{class:"card-subtitle"},"Swap Value при различных уровнях ставок")],-1)),s("div",Woe,[s("table",qoe,[t[57]||(t[57]=s("thead",null,[s("tr",null,[s("th",null,"Сценарий"),s("th",null,"Fixed Rate"),s("th",null,"Floating Rate"),s("th",null,"PV Fixed Leg"),s("th",null,"PV Floating Leg"),s("th",null,"Swap Value (М)"),s("th",null,"PnL (М)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(C.value,e=>(w(),i("tr",{key:e.name,class:c(e.isBase?"base":"")},[s("td",Yoe,v(e.name),1),s("td",joe,v(e.fixedRate.toFixed(2))+"%",1),s("td",Xoe,v(e.floatingRate.toFixed(2))+"%",1),s("td",$oe,v(L(e.pvFixed)),1),s("td",Koe,v(L(e.pvFloating)),1),s("td",{class:c(["mono",e.swapValue>=0?"positive":"negative"])},v(e.swapValue>=0?"+":"")+v(L(e.swapValue)),3),s("td",{class:c(["mono",e.pnl>=0?"positive":"negative"])},v(e.pnl>=0?"+":"")+v(L(e.pnl)),3)],2))),128))])])])]),s("div",Zoe,[s("div",Joe,[t[59]||(t[59]=s("div",{class:"risk-header"},[s("span",{class:"risk-icon"}),s("h3",null,"Риск Duration")],-1)),s("div",Qoe,v(M.value.duration.toFixed(2))+" y",1),s("div",ese,"ΔPV / 100bp: "+v(N(M.value.dv01)),1)]),s("div",tse,[t[60]||(t[60]=s("div",{class:"risk-header"},[s("span",{class:"risk-icon"}),s("h3",null,"Риск спреда")],-1)),s("div",ase,v(_.value.spread)+" bp",1),s("div",nse,"Spread DV01: "+v(N(M.value.spreadDv01)),1)]),s("div",rse,[t[61]||(t[61]=s("div",{class:"risk-header"},[s("span",{class:"risk-icon"}),s("h3",null,"Риск Convexity")],-1)),s("div",ise,v(M.value.convexity.toFixed(2)),1),t[62]||(t[62]=s("div",{class:"risk-detail"},"Низкий риск для vanilla",-1))])]),t[63]||(t[63]=s("div",{class:"page-footer"},[s("span",null,"• Модель: Discounted Cash Flow (DCF)"),s("span",null,"• Метод: Bootstrap yield curve"),s("span",null,"• Расчёт в реальном времени")],-1))]))}}),sse=xe(ose,[["__scopeId","data-v-978ace7b"]]),lse={class:"pnl-attribution-page"},cse={class:"page-header"},use={class:"header-right"},dse={class:"control-group"},hse={class:"control-group"},pse={class:"pnl-summary"},fse={class:"summary-card total"},mse={class:"summary-change"},vse={class:"summary-card"},gse={class:"summary-value accent"},yse={class:"summary-change"},bse={class:"summary-card"},xse={class:"summary-change"},wse={class:"summary-card"},_se={class:"summary-change"},Sse={class:"summary-card"},Mse={class:"summary-change"},Tse={class:"grid-2"},kse={class:"card"},Cse={class:"chart-container"},Ase={class:"card"},Ese={class:"chart-container"},Ise={class:"card full-width"},Rse={class:"table-container"},Dse={class:"attribution-table"},Pse={class:"col-component"},Lse={class:"col-percent mono"},Nse={class:"col-description"},Ose={class:"col-bucket"},Fse={class:"total-row"},Bse={class:"grid-3"},Use={class:"card"},zse={class:"greek-breakdown"},Vse={class:"breakdown-item"},Hse={class:"breakdown-item"},Gse={class:"breakdown-item"},Wse={class:"breakdown-item total"},qse={class:"value accent"},Yse={class:"card"},jse={class:"greek-breakdown"},Xse={class:"breakdown-item"},$se={class:"breakdown-item"},Kse={class:"breakdown-item"},Zse={class:"breakdown-item total"},Jse={class:"value blue"},Qse={class:"card"},ele={class:"greek-breakdown"},tle={class:"breakdown-item"},ale={class:"breakdown-item"},nle={class:"breakdown-item"},rle={class:"breakdown-item total"},ile={class:"value cyan"},ole={class:"card full-width"},sle={class:"chart-container tall"},lle={class:"card full-width"},cle={class:"table-container"},ule={class:"risk-factor-table"},dle={class:"factor-name"},hle={class:"exposure mono"},ple={class:"explained mono"},fle={class:"grid-2"},mle={class:"card"},vle={class:"unexplained-metrics"},gle={class:"metric-item"},yle={class:"metric-item"},ble={class:"value mono"},xle={class:"card"},wle={class:"top-positions"},_le={class:"position-rank"},Sle={class:"position-info"},Mle={class:"position-name"},Tle={class:"position-detail"},kle=e({__name:"PnLAttribution",setup(e){const a=t("day"),r=t("greeks"),o=t({market:125400,gamma:28500,theta:-12300,vega:18200,other:-5200}),l=S(()=>Object.values(o.value).reduce((e,t)=>e+t,0)),u=S(()=>l.value/1e6*100),d=t({delta:{rates:85e3,curve:32e3,twist:8400},gamma:{price:22e3,vol:5500,cross:1e3},vega:18200,rho:8500,other:-5200}),h=t([{id:1,component:"Δ - Rate Moves (parallel shift)",amount:85e3,percentage:32.5,description:"Sensitivity to parallel shift in yield curve",category:"Directional",type:"delta"},{id:2,component:"Δ - Curve Shift",amount:32e3,percentage:12.2,description:"Steepening/Flattening contribution",category:"Directional",type:"delta"},{id:3,component:"Δ - Curve Twist",amount:8400,percentage:3.2,description:"Butterfly and higher order effects",category:"Directional",type:"delta"},{id:4,component:"Γ - Price Gamma",amount:22e3,percentage:8.4,description:"Rebalancing/convexity gains from rate moves",category:"Convexity",type:"gamma"},{id:5,component:"Γ - Vol Gamma",amount:5500,percentage:2.1,description:"Vol-related second order effects",category:"Convexity",type:"gamma"},{id:6,component:"Θ - Theta Decay",amount:-12300,percentage:-4.7,description:"Time value decay (daily)",category:"Time Value",type:"theta"},{id:7,component:"V - Vega",amount:18200,percentage:6.9,description:"Volatility level changes",category:"Vol",type:"vega"},{id:8,component:"ρ - Rho",amount:8500,percentage:3.2,description:"Credit spread and rate correlation moves",category:"Spread",type:"rho"},{id:9,component:"Other/FX",amount:-5200,percentage:-2,description:"FX moves, dividends, other factors",category:"Other",type:"other"}]),m=t([{id:1,name:"Yield Curve (2Y-10Y)",move:15,exposure:4.25,impliedPnL:63750,actualPnL:68200,explained:96.3},{id:2,name:"Volatility (Swaption)",move:2.5,exposure:7200,impliedPnL:18e3,actualPnL:16800,explained:93.3},{id:3,name:"Credit Spread (IG)",move:-8,exposure:-2150,impliedPnL:-17200,actualPnL:-15600,explained:90.7},{id:4,name:"EUR/USD FX",move:.5,exposure:12e3,impliedPnL:6e3,actualPnL:5800,explained:96.7},{id:5,name:"Equity Index",move:1.2,exposure:800,impliedPnL:960,actualPnL:850,explained:88.5}]),g=S(()=>{const e=m.value.reduce((e,t)=>e+t.actualPnL,0);return l.value-e}),y=t([{name:"Long IRS 5Y",asset:"RUB RUONIA",pnl:85400},{name:"Short Bonds",asset:"ОФЗ",pnl:42300},{name:"Long Swaptions",asset:"Payer Swaption 2Yx5Y",pnl:28500},{name:"CDS Protection",asset:"IG Index",pnl:18200},{name:"Basis Swap",asset:"3M vs 6M",pnl:12e3}]),b=t(null),x=t(null),_=t(null);let M=null,k=null,C=null;const A=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),E=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",R=()=>{L()},P=()=>{const e=[["P&L Attribution Report",a.value],[""],["Component","Amount","% of Total"],...h.value.map(e=>[e.component,e.amount,e.percentage]),["TOTAL",l.value,"100.0"]].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=`pnl-attribution-${(new Date).toISOString()}.csv`,r.click()},L=()=>{M&&M.destroy(),k&&k.destroy(),C&&C.destroy(),b.value?.getContext("2d")&&(M=new re(b.value.getContext("2d"),{type:"doughnut",data:{labels:["Market P&L","Gamma","Vega","Theta","Other"],datasets:[{data:[o.value.market,o.value.gamma,o.value.vega,Math.abs(o.value.theta),Math.abs(o.value.other)],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(34, 197, 94, 0.8)","rgba(56, 189, 248, 0.8)","rgba(168, 85, 247, 0.8)","rgba(248, 113, 113, 0.8)"],borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"},position:"right"}}}})),x.value?.getContext("2d")&&(k=new re(x.value.getContext("2d"),{type:"bar",data:{labels:["Mon","Tue","Wed","Thu","Fri"],datasets:[{label:"Delta",data:[85,92,78,101,95],backgroundColor:"rgba(59, 130, 246, 0.6)"},{label:"Gamma",data:[22,18,24,32,28],backgroundColor:"rgba(34, 197, 94, 0.6)"},{label:"Vega",data:[15,12,18,16,20],backgroundColor:"rgba(56, 189, 248, 0.6)"},{label:"Theta",data:[-12,-12,-12,-12,-12],backgroundColor:"rgba(168, 85, 247, 0.6)"}]},options:{responsive:!0,maintainAspectRatio:!1,indexAxis:void 0,scales:{x:{stacked:!1,grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{stacked:!1,grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}},plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}}}})),_.value?.getContext("2d")&&(C=new re(_.value.getContext("2d"),{type:"bar",data:{labels:["Start","Delta","Gamma","Vega","Theta","Other","End"],datasets:[{label:"Cumulative P&L",data:[0,85e3,28500,18200,-12300,-5200,114200],backgroundColor:["rgba(255,255,255,0.1)","rgba(34, 197, 94, 0.6)","rgba(34, 197, 94, 0.6)","rgba(34, 197, 94, 0.6)","rgba(248, 113, 113, 0.6)","rgba(248, 113, 113, 0.6)","rgba(59, 130, 246, 0.8)"],borderColor:"rgba(255, 255, 255, 0.2)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}},plugins:{legend:{display:!1}}}}))};return n(()=>{L()}),z(()=>{M&&M.destroy(),k&&k.destroy(),C&&C.destroy()}),(e,t)=>(w(),i("div",lse,[s("div",cse,[t[6]||(t[6]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Разложение P&L"),s("p",{class:"page-subtitle"},"Разложение прибыли по источникам и факторам риска")],-1)),s("div",use,[s("div",dse,[t[3]||(t[3]=s("label",{class:"control-label"},"Период:",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:"period-select",onChange:R},[...t[2]||(t[2]=[I('<option value="day" data-v-5db96ab4>Сегодня</option><option value="week" data-v-5db96ab4>Неделя</option><option value="month" data-v-5db96ab4>Месяц</option><option value="ytd" data-v-5db96ab4>YTD</option><option value="year" data-v-5db96ab4>Год</option>',5)])],544),[[D,a.value]])]),s("div",hse,[t[5]||(t[5]=s("label",{class:"control-label"},"Метод:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),class:"method-select",onChange:R},[...t[4]||(t[4]=[s("option",{value:"greeks"},"Разложение по грекам",-1),s("option",{value:"riskfactors"},"Факторы риска",-1),s("option",{value:"positions"},"По позициям",-1)])],544),[[D,r.value]])]),s("button",{onClick:P,class:"btn-secondary"}," Экспортировать ")])]),s("div",pse,[s("div",fse,[t[7]||(t[7]=s("div",{class:"summary-label"},"Общий P&L",-1)),s("div",{class:c(["summary-value",l.value>=0?"positive":"negative"])},v(A(l.value)),3),s("div",mse,v(l.value/Math.abs(l.value||1)>0?"↑":"↓")+" "+v(Math.abs(u.value).toFixed(2))+"% ",1)]),s("div",vse,[t[8]||(t[8]=s("div",{class:"summary-label"},"Рыночный P&L",-1)),s("div",gse,v(A(o.value.market)),1),s("div",yse,v((o.value.market/l.value*100).toFixed(1))+"% от общего ",1)]),s("div",bse,[t[9]||(t[9]=s("div",{class:"summary-label"},"Theta (убыль времени)",-1)),s("div",{class:c(["summary-value",o.value.theta>=0?"positive":"negative"])},v(A(o.value.theta)),3),s("div",xse,v((o.value.theta/l.value*100).toFixed(1))+"% от общего ",1)]),s("div",wse,[t[10]||(t[10]=s("div",{class:"summary-label"},"Gamma P&L",-1)),s("div",{class:c(["summary-value",o.value.gamma>=0?"positive":"negative"])},v(A(o.value.gamma)),3),s("div",_se,v((o.value.gamma/l.value*100).toFixed(1))+"% от общего ",1)]),s("div",Sse,[t[11]||(t[11]=s("div",{class:"summary-label"},"Vega P&L",-1)),s("div",{class:c(["summary-value",o.value.vega>=0?"positive":"negative"])},v(A(o.value.vega)),3),s("div",Mse,v((o.value.vega/l.value*100).toFixed(1))+"% от общего ",1)])]),s("div",Tse,[s("div",kse,[t[12]||(t[12]=s("div",{class:"chart-header"},[s("h3",null,"Состав P&L"),s("span",{class:"chart-subtitle"},"Доля каждого компонента")],-1)),s("div",Cse,[s("canvas",{ref_key:"compositionChartRef",ref:b},null,512)])]),s("div",Ase,[t[13]||(t[13]=s("div",{class:"chart-header"},[s("h3",null,"Разложение P&L по дням"),s("span",{class:"chart-subtitle"},"Разложение по дням")],-1)),s("div",Ese,[s("canvas",{ref_key:"dailyAttributionRef",ref:x},null,512)])])]),s("div",Ise,[t[18]||(t[18]=s("div",{class:"card-header"},[s("h3",null,"Детальное разложение P&L"),s("span",{class:"card-subtitle"},"Разложение по грекам и факторам риска")],-1)),s("div",Rse,[s("table",Dse,[t[17]||(t[17]=s("thead",null,[s("tr",null,[s("th",{class:"col-component"},"Компонент"),s("th",{class:"col-amount"},"Сумма (М RUB)"),s("th",{class:"col-percent"},"% от общего"),s("th",{class:"col-description"},"Описание"),s("th",{class:"col-bucket"},"Категория")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(h.value,e=>(w(),i("tr",{key:e.id,class:c(e.type)},[s("td",Pse,v(e.component),1),s("td",{class:c(["col-amount",e.amount>=0?"positive":"negative"])},v(e.amount>=0?"+":"")+v(E(e.amount)),3),s("td",Lse,v(e.percentage.toFixed(1))+"%",1),s("td",Nse,v(e.description),1),s("td",Ose,v(e.category),1)],2))),128))]),s("tfoot",null,[s("tr",Fse,[t[14]||(t[14]=s("td",{class:"col-component"},[s("strong",null,"TOTAL")],-1)),s("td",{class:c(["col-amount",l.value>=0?"positive":"negative"])},[s("strong",null,v(l.value>=0?"+":"")+v(E(l.value)),1)],2),t[15]||(t[15]=s("td",{class:"col-percent mono"},[s("strong",null,"100.0%")],-1)),t[16]||(t[16]=s("td",{colspan:"2"},null,-1))])])])])]),s("div",Bse,[s("div",Use,[t[23]||(t[23]=s("div",{class:"card-header"},[s("h3",null,"Δ (Delta) P&L"),s("span",{class:"card-subtitle"},"Directional risk exposure")],-1)),s("div",zse,[s("div",Vse,[t[19]||(t[19]=s("span",{class:"label"},"Движения ставок",-1)),s("span",{class:c(["value",d.value.delta.rates>=0?"positive":"negative"])},v(d.value.delta.rates>=0?"+":"")+v(E(d.value.delta.rates)),3)]),s("div",Hse,[t[20]||(t[20]=s("span",{class:"label"},"Сдвиг кривой",-1)),s("span",{class:c(["value",d.value.delta.curve>=0?"positive":"negative"])},v(d.value.delta.curve>=0?"+":"")+v(E(d.value.delta.curve)),3)]),s("div",Gse,[t[21]||(t[21]=s("span",{class:"label"},"Скручивание кривой",-1)),s("span",{class:c(["value",d.value.delta.twist>=0?"positive":"negative"])},v(d.value.delta.twist>=0?"+":"")+v(E(d.value.delta.twist)),3)]),s("div",Wse,[t[22]||(t[22]=s("span",{class:"label"},"Δ Total",-1)),s("span",qse,v(d.value.delta.rates+d.value.delta.curve+d.value.delta.twist>=0?"+":"")+" "+v(E(d.value.delta.rates+d.value.delta.curve+d.value.delta.twist)),1)])])]),s("div",Yse,[t[28]||(t[28]=s("div",{class:"card-header"},[s("h3",null,"Γ (Gamma) P&L"),s("span",{class:"card-subtitle"},"Прибыли/убытки от конвергентности")],-1)),s("div",jse,[s("div",Xse,[t[24]||(t[24]=s("span",{class:"label"},"Gamma цены",-1)),s("span",{class:c(["value",d.value.gamma.price>=0?"positive":"negative"])},v(d.value.gamma.price>=0?"+":"")+v(E(d.value.gamma.price)),3)]),s("div",$se,[t[25]||(t[25]=s("span",{class:"label"},"Gamma волатильности",-1)),s("span",{class:c(["value",d.value.gamma.vol>=0?"positive":"negative"])},v(d.value.gamma.vol>=0?"+":"")+v(E(d.value.gamma.vol)),3)]),s("div",Kse,[t[26]||(t[26]=s("span",{class:"label"},"Перекрёстная gamma",-1)),s("span",{class:c(["value",d.value.gamma.cross>=0?"positive":"negative"])},v(d.value.gamma.cross>=0?"+":"")+v(E(d.value.gamma.cross)),3)]),s("div",Zse,[t[27]||(t[27]=s("span",{class:"label"},"Γ Total",-1)),s("span",Jse,v(d.value.gamma.price+d.value.gamma.vol+d.value.gamma.cross>=0?"+":"")+" "+v(E(d.value.gamma.price+d.value.gamma.vol+d.value.gamma.cross)),1)])])]),s("div",Qse,[t[33]||(t[33]=s("div",{class:"card-header"},[s("h3",null,"V (Vega) & Other"),s("span",{class:"card-subtitle"},"Волатильность и остаточные")],-1)),s("div",ele,[s("div",tle,[t[29]||(t[29]=s("span",{class:"label"},"Vega (движения vol)",-1)),s("span",{class:c(["value",d.value.vega>=0?"positive":"negative"])},v(d.value.vega>=0?"+":"")+v(E(d.value.vega)),3)]),s("div",ale,[t[30]||(t[30]=s("span",{class:"label"},"Rho (ставка/кредит)",-1)),s("span",{class:c(["value",d.value.rho>=0?"positive":"negative"])},v(d.value.rho>=0?"+":"")+v(E(d.value.rho)),3)]),s("div",nle,[t[31]||(t[31]=s("span",{class:"label"},"Other/FX",-1)),s("span",{class:c(["value",d.value.other>=0?"positive":"negative"])},v(d.value.other>=0?"+":"")+v(E(d.value.other)),3)]),s("div",rle,[t[32]||(t[32]=s("span",{class:"label"},"V Total",-1)),s("span",ile,v(d.value.vega+d.value.rho+d.value.other>=0?"+":"")+" "+v(E(d.value.vega+d.value.rho+d.value.other)),1)])])])]),s("div",ole,[t[34]||(t[34]=s("div",{class:"chart-header"},[s("h3",null,"Водопад P&L"),s("span",{class:"chart-subtitle"},"Траектория накопления P&L с начала периода")],-1)),s("div",sle,[s("canvas",{ref_key:"waterfallChartRef",ref:_},null,512)])]),s("div",lle,[t[37]||(t[37]=s("div",{class:"card-header"},[s("h3",null,"Разложение по факторам риска"),s("span",{class:"card-subtitle"},"P&L по экономическим факторам")],-1)),s("div",cle,[s("table",ule,[t[35]||(t[35]=s("thead",null,[s("tr",null,[s("th",null,"Фактор риска"),s("th",null,"Движение рынка"),s("th",null,"Экспозиция позиции"),s("th",null,"Подразумеваемый P&L"),s("th",null,"Фактический P&L"),s("th",null,"Объяснено %")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(m.value,e=>(w(),i("tr",{key:e.id},[s("td",dle,v(e.name),1),s("td",{class:c(["move",e.move>=0?"positive":"negative"])},v(e.move>=0?"+":"")+v(e.move.toFixed(2)),3),s("td",hle,v(e.exposure.toFixed(1)),1),s("td",{class:c(["pnl",e.impliedPnL>=0?"positive":"negative"])},v(e.impliedPnL>=0?"+":"")+v(E(e.impliedPnL)),3),s("td",{class:c(["pnl",e.actualPnL>=0?"positive":"negative"])},v(e.actualPnL>=0?"+":"")+v(E(e.actualPnL)),3),s("td",ple,v(e.explained.toFixed(1))+"%",1)]))),128))]),t[36]||(t[36]=s("tfoot",null,[s("tr",{class:"total-row"},[s("td",null,[s("strong",null,"TOTAL")]),s("td",{colspan:"5"})])],-1))])])]),s("div",fle,[s("div",mle,[t[41]||(t[41]=s("div",{class:"card-header"},[s("h3",null,"Необъяснённый P&L"),s("span",{class:"card-subtitle"},"P&L не объяснённый факторами")],-1)),s("div",vle,[s("div",gle,[t[38]||(t[38]=s("span",{class:"label"},"Всего необъяснённого",-1)),s("span",{class:c(["value",g.value>=0?"positive":"negative"])},v(g.value>=0?"+":"")+v(E(g.value)),3)]),s("div",yle,[t[39]||(t[39]=s("span",{class:"label"},"% от общего P&L",-1)),s("span",ble,v((Math.abs(g.value)/Math.abs(l.value)*100).toFixed(1))+"%",1)]),t[40]||(t[40]=s("div",{class:"metric-item"},[s("span",{class:"label"},"Вероятные причины"),s("ul",{class:"causes-list"},[s("li",null,"• Проскальзывание спреда bid-ask"),s("li",null,"• Время исполнения"),s("li",null,"• Изменения корреляции"),s("li",null,"• Начисление дивидендов/купонов")])],-1))])]),s("div",xle,[t[42]||(t[42]=s("div",{class:"card-header"},[s("h3",null,"Топ вкладчиков в P&L"),s("span",{class:"card-subtitle"},"5 позиций с максимальным вкладом")],-1)),s("div",wle,[(w(!0),i(p,null,f(y.value,(e,t)=>(w(),i("div",{key:t,class:"position-item"},[s("div",_le,v(t+1),1),s("div",Sle,[s("span",Mle,v(e.name),1),s("span",Tle,v(e.asset),1)]),s("div",{class:c(["position-pnl",e.pnl>=0?"positive":"negative"])},v(e.pnl>=0?"+":"")+v(E(e.pnl)),3)]))),128))])])]),t[43]||(t[43]=s("div",{class:"page-footer"},[s("span",null,"• Метод: Greeks Decomposition (DCF-based)"),s("span",null,"• Обновление: В реальном времени"),s("span",null,"• Базовая валюта: RUB")],-1))]))}}),Cle=xe(kle,[["__scopeId","data-v-5db96ab4"]]),Ale={class:"hedging-assistant-page"},Ele={class:"page-header"},Ile={class:"header-right"},Rle={class:"control-group"},Dle={class:"control-group"},Ple=["disabled"],Lle={key:0},Nle={key:1},Ole={class:"grid-3"},Fle={class:"overview-card"},Ble={class:"overview-metrics"},Ule={class:"metric"},zle={class:"value"},Vle={class:"metric"},Hle={class:"value mono"},Gle={class:"metric"},Wle={class:"value mono"},qle={class:"metric"},Yle={class:"value accent mono"},jle={class:"overview-card"},Xle={class:"overview-metrics"},$le={class:"metric"},Kle={class:"metric"},Zle={class:"metric"},Jle={class:"value mono"},Qle={class:"metric"},ece={class:"value negative"},tce={class:"overview-card"},ace={class:"overview-metrics"},nce={class:"metric"},rce={class:"value cyan mono"},ice={class:"metric"},oce={class:"value blue mono"},sce={class:"metric"},lce={class:"value mono"},cce={class:"metric"},uce={class:"value green mono"},dce={class:"card full-width"},hce={class:"instruments-grid"},pce=["onClick"],fce={class:"instrument-header"},mce={class:"instrument-name"},vce={class:"instrument-type"},gce={class:"instrument-metrics"},yce={class:"metric-row"},bce={class:"value"},xce={class:"metric-row"},wce={class:"value"},_ce={class:"metric-row"},Sce={class:"value"},Mce={class:"metric-row"},Tce={class:"value"},kce={class:"card full-width"},Cce={class:"hedge-table-container"},Ace={class:"hedge-table"},Ece={class:"col-instrument"},Ice={class:"col-quantity mono"},Rce={class:"col-size accent"},Dce={class:"col-cost mono"},Pce={class:"col-action"},Lce=["onClick"],Nce={class:"total-row"},Oce={class:"accent"},Fce={class:"positive"},Bce={class:"blue"},Uce={class:"mono"},zce={class:"grid-2"},Vce={class:"card"},Hce={class:"comparison-table-container"},Gce={class:"comparison-table"},Wce={class:"value accent"},qce={class:"value cyan"},Yce={class:"value green"},jce={class:"value accent"},Xce={class:"value cyan"},$ce={class:"value green"},Kce={class:"value negative"},Zce={class:"value cyan"},Jce={class:"value blue mono"},Qce={class:"value green"},eue={class:"grid-2"},tue={class:"card"},aue={class:"cost-breakdown"},nue={class:"instrument-name"},rue={class:"cost-bar-container"},iue={class:"cost-value mono"},oue={class:"cost-item total"},sue={class:"cost-value total-value mono"},lue={class:"card"},cue={class:"regression-info"},uue={class:"regression-item"},due={class:"value mono"},hue={class:"regression-item"},pue={class:"value mono"},fue={class:"regression-item"},mue={class:"value mono"},vue={class:"regression-item"},gue={class:"value mono"},yue={class:"regression-item"},bue={class:"value mono"},xue={class:"card full-width"},wue={class:"scenario-table-container"},_ue={class:"scenario-table"},Sue={class:"scenario-name"},Mue={class:"effectiveness mono"},Tue={class:"card full-width"},kue={class:"execution-status"},Cue={class:"execution-header"},Aue={class:"quantity"},Eue={class:"execution-detail"},Iue={key:0},Rue=e({__name:"HedgingAssistant",setup(e){const a=t("long-bond"),r=t("optimal"),o=t(!1),u=t([1,2,3]),d=t({name:"US Treasury 10Y Bond",size:100,duration:8.5,exposure:85e4,dv01:85e3,vega:18200,gamma:.0025,maxLoss:-425e3}),h=t({targetDv01:0,targetVega:0,correlation:.95,efficiency:.92}),m=t([{id:1,name:"US Treasury 2Y",type:"Bond",dv01:19500,vega:3200,correlation:.98,cost:2},{id:2,name:"US Treasury 5Y",type:"Bond",dv01:48e3,vega:8500,correlation:.97,cost:2},{id:3,name:"IRS Receiver 10Y",type:"Swap",dv01:82e3,vega:17800,correlation:.99,cost:3},{id:4,name:"Treasury Futures",type:"Futures",dv01:28500,vega:4200,correlation:.96,cost:1},{id:5,name:"Payer Swaption 5Y2Y",type:"Option",dv01:12e3,vega:45e3,correlation:.85,cost:25}]),g=t([{id:1,instrument:"US Treasury 5Y",type:"bond",quantity:1.75,size:84e3,direction:"Short",dv01Contribution:-84e3,vegaContribution:-14875,cost:3.5,executed:!0,price:"98.45",executionTime:"10:15 AM"},{id:2,instrument:"IRS Receiver 10Y",type:"swap",quantity:1.04,size:104e3,direction:"Receiver",dv01Contribution:-85280,vegaContribution:-18512,cost:3.12,executed:!0,price:"Par",executionTime:"10:22 AM"}]),b=S(()=>g.value.reduce((e,t)=>e+t.size,0)),x=S(()=>g.value.reduce((e,t)=>e+t.dv01Contribution,0)),_=S(()=>g.value.reduce((e,t)=>e+t.vegaContribution,0)),M=S(()=>g.value.reduce((e,t)=>e+t.cost,0)),k=S(()=>.94),C=t({beta:1.002,alpha:.0015,rSquared:.9487,stdError:.0025,rmse:42.35}),A=t([{id:1,name:"Bear (-200bp)",move:-200,originalPnL:-17e5,hedgePnL:168e4,netPnL:-2e4,effectiveness:.988},{id:2,name:"Bear (-100bp)",move:-100,originalPnL:-85e4,hedgePnL:84e4,netPnL:-1e4,effectiveness:.988},{id:3,name:"Base Case",move:0,originalPnL:0,hedgePnL:0,netPnL:0,effectiveness:1},{id:4,name:"Bull (+100bp)",move:100,originalPnL:85e4,hedgePnL:-84e4,netPnL:1e4,effectiveness:.988},{id:5,name:"Bull (+200bp)",move:200,originalPnL:17e5,hedgePnL:-168e4,netPnL:2e4,effectiveness:.988}]),E=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",R=()=>{},P=async()=>{o.value=!0;try{await new Promise(e=>setTimeout(e,1500))}finally{o.value=!1}};return n(()=>{}),(e,t)=>{return w(),i("div",Ale,[s("div",Ele,[t[6]||(t[6]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Помощник по хеджированию"),s("p",{class:"page-subtitle"},"Репликация и хеджирование портфеля инструментами")],-1)),s("div",Ile,[s("div",Rle,[t[3]||(t[3]=s("label",{class:"control-label"},"Позиция:",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:"position-select",onChange:R},[...t[2]||(t[2]=[s("option",{value:"long-bond"},"Long позиция в облигациях",-1),s("option",{value:"long-stock"},"Long позиция в акциях",-1),s("option",{value:"long-swap"},"Long Interest Rate Swap",-1),s("option",{value:"long-credit"},"Long кредитная экспозиция",-1)])],544),[[D,a.value]])]),s("div",Dle,[t[5]||(t[5]=s("label",{class:"control-label"},"Стратегия:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),class:"strategy-select",onChange:R},[...t[4]||(t[4]=[s("option",{value:"delta"},"Delta хедж",-1),s("option",{value:"duration"},"Совпадение Duration",-1),s("option",{value:"regression"},"Регрессионный хедж",-1),s("option",{value:"optimal"},"Оптимальная репликация",-1)])],544),[[D,r.value]])]),s("button",{onClick:P,class:"btn-primary",disabled:o.value},[o.value?(w(),i("span",Nle,"↺ Считаю...")):(w(),i("span",Lle,"Пересчитать хедж"))],8,Ple)])]),s("div",Ole,[s("div",Fle,[t[11]||(t[11]=s("div",{class:"card-header"},[s("h3",null,"Исходная позиция")],-1)),s("div",Ble,[s("div",Ule,[t[7]||(t[7]=s("span",{class:"label"},"Инструмент",-1)),s("span",zle,v(d.value.name),1)]),s("div",Vle,[t[8]||(t[8]=s("span",{class:"label"},"Размер",-1)),s("span",Hle,v((n=d.value.size,new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(n))),1)]),s("div",Gle,[t[9]||(t[9]=s("span",{class:"label"},"Duration",-1)),s("span",Wle,v(d.value.duration.toFixed(2)),1)]),s("div",qle,[t[10]||(t[10]=s("span",{class:"label"},"Экспозиция",-1)),s("span",Yle,v(E(d.value.exposure)),1)])])]),s("div",jle,[t[16]||(t[16]=s("div",{class:"card-header"},[s("h3",null,"Риск позиции")],-1)),s("div",Xle,[s("div",$le,[t[12]||(t[12]=s("span",{class:"label"},"DV01",-1)),s("span",{class:c(["value",d.value.dv01>=0?"positive":"negative"])},v(E(d.value.dv01)),3)]),s("div",Kle,[t[13]||(t[13]=s("span",{class:"label"},"Vega (Vol)",-1)),s("span",{class:c(["value",d.value.vega>=0?"positive":"negative"])},v(E(d.value.vega)),3)]),s("div",Zle,[t[14]||(t[14]=s("span",{class:"label"},"Gamma",-1)),s("span",Jle,v(d.value.gamma.toFixed(4)),1)]),s("div",Qle,[t[15]||(t[15]=s("span",{class:"label"},"Max Loss (1σ)",-1)),s("span",ece,v(E(d.value.maxLoss)),1)])])]),s("div",tce,[t[21]||(t[21]=s("div",{class:"card-header"},[s("h3",null,"Хедж требования")],-1)),s("div",ace,[s("div",nce,[t[17]||(t[17]=s("span",{class:"label"},"Целевой DV01",-1)),s("span",rce,v(E(h.value.targetDv01)),1)]),s("div",ice,[t[18]||(t[18]=s("span",{class:"label"},"Целевая Vega",-1)),s("span",oce,v(E(h.value.targetVega)),1)]),s("div",sce,[t[19]||(t[19]=s("span",{class:"label"},"Корреляция цели",-1)),s("span",lce,v((100*h.value.correlation).toFixed(1))+"%",1)]),s("div",cce,[t[20]||(t[20]=s("span",{class:"label"},"Эффективность",-1)),s("span",uce,v((100*h.value.efficiency).toFixed(1))+"%",1)])])])]),s("div",dce,[t[26]||(t[26]=s("div",{class:"card-header"},[s("h3",null,"Доступные инструменты для хеджирования"),s("span",{class:"card-subtitle"},"Выберите инструменты для репликации позиции")],-1)),s("div",hce,[(w(!0),i(p,null,f(m.value,e=>(w(),i("div",{key:e.id,class:c(["instrument-card",{selected:u.value.includes(e.id)}]),onClick:t=>(e=>{const t=u.value.indexOf(e);t>-1?u.value.splice(t,1):u.value.push(e)})(e.id)},[s("div",fce,[s("span",mce,v(e.name),1),s("span",vce,v(e.type),1)]),s("div",gce,[s("div",yce,[t[22]||(t[22]=s("span",{class:"label"},"DV01",-1)),s("span",bce,v(e.dv01.toFixed(0)),1)]),s("div",xce,[t[23]||(t[23]=s("span",{class:"label"},"Vega",-1)),s("span",wce,v(e.vega.toFixed(0)),1)]),s("div",_ce,[t[24]||(t[24]=s("span",{class:"label"},"Корр",-1)),s("span",Sce,v((100*e.correlation).toFixed(0))+"%",1)]),s("div",Mce,[t[25]||(t[25]=s("span",{class:"label"},"Стоимость",-1)),s("span",Tce,v(e.cost)+"bp",1)])])],10,pce))),128))])]),s("div",kce,[t[30]||(t[30]=s("div",{class:"card-header"},[s("h3",null,"Портфель хеджирования"),s("span",{class:"card-subtitle"},"Рекомендуемые размеры позиций")],-1)),s("div",Cce,[s("table",Ace,[t[29]||(t[29]=s("thead",null,[s("tr",null,[s("th",{class:"col-instrument"},"Инструмент"),s("th",{class:"col-quantity"},"Количество"),s("th",{class:"col-size"},"Размер (М)"),s("th",{class:"col-dv01"},"DV01 вклад"),s("th",{class:"col-vega"},"Vega вклад"),s("th",{class:"col-cost"},"Стоимость (bp)"),s("th",{class:"col-action"},"Действие")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(g.value,e=>(w(),i("tr",{key:e.id,class:c(e.direction.toLowerCase())},[s("td",Ece,[s("span",{class:c(["instrument-badge",e.type])},v(e.instrument),3)]),s("td",Ice,v(e.quantity.toFixed(2)),1),s("td",Rce,v(E(e.size)),1),s("td",{class:c(["col-dv01",e.dv01Contribution>=0?"positive":"negative"])},v(e.dv01Contribution>=0?"+":"")+v(E(e.dv01Contribution)),3),s("td",{class:c(["col-vega",e.vegaContribution>=0?"positive":"negative"])},v(e.vegaContribution>=0?"+":"")+v(E(e.vegaContribution)),3),s("td",Dce,v(e.cost),1),s("td",Pce,[s("button",{onClick:t=>(e=>{const t=g.value.find(t=>t.id===e);t&&(t.executed=!0,t.executionTime=(new Date).toLocaleTimeString())})(e.id),class:"btn-action"},v(e.executed?"✓":"↓"),9,Lce)])],2))),128))]),s("tfoot",null,[s("tr",Nce,[t[27]||(t[27]=s("td",{colspan:"2"},[s("strong",null,"ИТОГО ХЕДЖ")],-1)),s("td",Oce,[s("strong",null,v(E(b.value)),1)]),s("td",Fce,[s("strong",null,v(E(x.value)),1)]),s("td",Bce,[s("strong",null,v(E(_.value)),1)]),s("td",Uce,[s("strong",null,v(M.value.toFixed(1))+"bp",1)]),t[28]||(t[28]=s("td",null,null,-1))])])])])]),s("div",zce,[s("div",Vce,[t[38]||(t[38]=s("div",{class:"card-header"},[s("h3",null,"Сравнение: До/После хеджирования")],-1)),s("div",Hce,[s("table",Gce,[t[37]||(t[37]=s("thead",null,[s("tr",null,[s("th",null,"Метрика"),s("th",null,"До хеджа"),s("th",null,"После хеджа"),s("th",null,"Снижение")])],-1)),s("tbody",null,[s("tr",null,[t[31]||(t[31]=s("td",{class:"metric-name"},"DV01 (М/bp)",-1)),s("td",Wce,v(E(d.value.dv01)),1),s("td",qce,v(E(d.value.dv01-x.value)),1),s("td",Yce,v((x.value/d.value.dv01*100).toFixed(1))+"%",1)]),s("tr",null,[t[32]||(t[32]=s("td",{class:"metric-name"},"Vega (М/1%)",-1)),s("td",jce,v(E(d.value.vega)),1),s("td",Xce,v(E(d.value.vega-_.value)),1),s("td",$ce,v((_.value/d.value.vega*100).toFixed(1))+"%",1)]),s("tr",null,[t[33]||(t[33]=s("td",{class:"metric-name"},"Max Loss (1σ)",-1)),s("td",Kce,v(E(d.value.maxLoss)),1),s("td",Zce,v(E(.15*d.value.maxLoss)),1),t[34]||(t[34]=s("td",{class:"value green"},v(85)+"%",-1))]),s("tr",null,[t[35]||(t[35]=s("td",{class:"metric-name"},"Correlation",-1)),t[36]||(t[36]=s("td",{class:"value"},"-",-1)),s("td",Jce,v((100*k.value).toFixed(1))+"%",1),s("td",Qce,v((100*k.value).toFixed(1))+"%",1)])])])])]),t[39]||(t[39]=I('<div class="card" data-v-a8790ded><div class="card-header" data-v-a8790ded><h3 data-v-a8790ded>Снижение риска</h3></div><div class="risk-reduction" data-v-a8790ded><div class="reduction-item" data-v-a8790ded><span class="risk-type" data-v-a8790ded>Направленный риск</span><div class="bar-container" data-v-a8790ded><div class="bar-before" style="width:100%;height:8px;background:rgba(248, 113, 113, 0.4);" data-v-a8790ded></div><div class="bar-after" style="width:5%;height:8px;background:rgba(74, 222, 128, 0.6);position:relative;top:-8px;" data-v-a8790ded></div></div><span class="reduction-text" data-v-a8790ded>95% снижено</span></div><div class="reduction-item" data-v-a8790ded><span class="risk-type" data-v-a8790ded>Риск Duration</span><div class="bar-container" data-v-a8790ded><div class="bar-before" style="width:100%;height:8px;background:rgba(248, 113, 113, 0.4);" data-v-a8790ded></div><div class="bar-after" style="width:8%;height:8px;background:rgba(74, 222, 128, 0.6);position:relative;top:-8px;" data-v-a8790ded></div></div><span class="reduction-text" data-v-a8790ded>92% снижено</span></div><div class="reduction-item" data-v-a8790ded><span class="risk-type" data-v-a8790ded>Риск Vol</span><div class="bar-container" data-v-a8790ded><div class="bar-before" style="width:100%;height:8px;background:rgba(248, 113, 113, 0.4);" data-v-a8790ded></div><div class="bar-after" style="width:15%;height:8px;background:rgba(74, 222, 128, 0.6);position:relative;top:-8px;" data-v-a8790ded></div></div><span class="reduction-text" data-v-a8790ded>85% снижено</span></div></div></div>',1))]),s("div",eue,[s("div",tue,[t[42]||(t[42]=s("div",{class:"chart-header"},[s("h3",null,"Стоимость хеджирования"),s("span",{class:"chart-subtitle"},"Разложение по инструментам")],-1)),s("div",aue,[(w(!0),i(p,null,f(g.value,e=>(w(),i("div",{key:e.id,class:"cost-item"},[s("span",nue,v(e.instrument),1),s("div",rue,[s("div",{class:"cost-bar",style:y({width:Math.min(100,Math.max(2,Math.abs(e.cost)/Math.max(M.value,1)*100))+"%"})},null,4)]),s("span",iue,v(e.cost.toFixed(1))+"bp",1)]))),128)),s("div",oue,[t[40]||(t[40]=s("span",{class:"instrument-name"},[s("strong",null,"ОБЩАЯ СТОИМОСТЬ")],-1)),t[41]||(t[41]=s("div",{class:"cost-bar-container total-bar-container"},[s("div",{class:"cost-bar total-bar",style:{width:"100%"}})],-1)),s("span",sue,[s("strong",null,v(M.value.toFixed(1))+"bp",1)])])])]),s("div",lue,[t[48]||(t[48]=s("div",{class:"chart-header"},[s("h3",null,"Оптимальная репликация"),s("span",{class:"chart-subtitle"},"Коэффициенты регрессии")],-1)),s("div",cue,[s("div",uue,[t[43]||(t[43]=s("span",{class:"variable"},"β (Beta)",-1)),s("span",due,v(C.value.beta.toFixed(3)),1)]),s("div",hue,[t[44]||(t[44]=s("span",{class:"variable"},"α (Alpha)",-1)),s("span",pue,v(C.value.alpha.toFixed(4)),1)]),s("div",fue,[t[45]||(t[45]=s("span",{class:"variable"},"R² (Adjusted)",-1)),s("span",mue,v((100*C.value.rSquared).toFixed(2))+"%",1)]),s("div",vue,[t[46]||(t[46]=s("span",{class:"variable"},"Станд. ошибка",-1)),s("span",gue,v(C.value.stdError.toFixed(4)),1)]),s("div",yue,[t[47]||(t[47]=s("span",{class:"variable"},"RMSE",-1)),s("span",bue,v(C.value.rmse.toFixed(2)),1)])])])]),s("div",xue,[t[50]||(t[50]=s("div",{class:"card-header"},[s("h3",null,"Анализ сценариев: Эффективность хеджа"),s("span",{class:"card-subtitle"},"P&L позиции с хеджем в различных сценариях")],-1)),s("div",wue,[s("table",_ue,[t[49]||(t[49]=s("thead",null,[s("tr",null,[s("th",null,"Сценарий"),s("th",null,"Движение рынка"),s("th",null,"Исходный P&L"),s("th",null,"P&L хеджа"),s("th",null,"Чистый P&L"),s("th",null,"Эффективность хеджа")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(A.value,e=>(w(),i("tr",{key:e.id,class:c(3===e.id?"base":"")},[s("td",Sue,v(e.name),1),s("td",{class:c(["market-move",e.move>=0?"positive":"negative"])},v(e.move>=0?"+":"")+v(e.move.toFixed(0))+"bp ",3),s("td",{class:c(["pnl",e.originalPnL>=0?"positive":"negative"])},v(e.originalPnL>=0?"+":"")+v(E(e.originalPnL)),3),s("td",{class:c(["pnl",e.hedgePnL>=0?"positive":"negative"])},v(e.hedgePnL>=0?"+":"")+v(E(e.hedgePnL)),3),s("td",{class:c(["pnl",e.netPnL>=0?"positive":"negative"])},v(e.netPnL>=0?"+":"")+v(E(e.netPnL)),3),s("td",Mue,v((100*e.effectiveness).toFixed(1))+"%",1)],2))),128))])])])]),s("div",Tue,[t[51]||(t[51]=s("div",{class:"card-header"},[s("h3",null,"Статус выполнения"),s("span",{class:"card-subtitle"},"Ордера и исполнение")],-1)),s("div",kue,[(w(!0),i(p,null,f(g.value,e=>(w(),i("div",{key:e.id,class:"execution-item"},[s("div",Cue,[s("span",{class:c(["instrument-badge",e.type])},v(e.instrument),3),s("span",Aue,v(e.quantity.toFixed(2))+" контрактов",1),s("span",{class:c(["status",e.executed?"executed":"pending"])},v(e.executed?"✓ Исполнено":"Ожидание"),3)]),s("div",Eue,[s("span",null,"Размер: "+v(E(e.size)),1),s("span",null,"Направление: "+v(e.direction),1),s("span",null,"Цена: "+v(e.price),1),e.executed?(w(),i("span",Iue,"Время: "+v(e.executionTime),1)):l("",!0)])]))),128))])]),t[52]||(t[52]=s("div",{class:"page-footer"},[s("span",null,"• Метод: Регрессионное оптимальное хеджирование"),s("span",null,"• Обновление: В реальном времени"),s("span",null,"• Запас прочности: 10% (buffer)")],-1))]);var n}}}),Due=xe(Rue,[["__scopeId","data-v-a8790ded"]]),Pue="   https://stochastic-dashbord-v1-production.up.railway.app",Lue=async e=>{try{const t=await fetch(`${Pue}/api/forward/valuate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Forward Valuation Failed:",QXe),QXe}},Nue=_("forwardRegistry",()=>{const e=t([]),a=t([]),n=t((new Date).toISOString().split("T")[0]),r=S(()=>e.value.length),i=S(()=>e.value.filter((e,t)=>null!==a.value[t]&&void 0!==a.value[t])),o=S(()=>a.value.reduce((t,a,n)=>{if(a&&e.value[n]){const r=e.value[n].contractSize||1e6;return t+(a.forwardValue*r||0)}return t},0)),s=S(()=>a.value.reduce((t,a,n)=>{if(a&&e.value[n]){const r=e.value[n].contractSize||1e6;return t+(a.delta*r||0)}return t},0)),l=S(()=>a.value.reduce((t,a,n)=>{if(a&&e.value[n]){const r=e.value[n].contractSize||1e6;return t+(a.rho*r||0)}return t},0)),c=S(()=>a.value.reduce((t,a,n)=>{if(a&&a.dv01&&e.value[n]){const r=e.value[n].contractSize||1e6,i=e.value[n].faceValue||100;return t+(a.dv01*r*i/100||0)}return t},0));return{registryForwards:e,forwardResults:a,valuationDate:n,totalForwards:r,calculatedForwards:i,totalForwardValue:o,totalDelta:s,totalRho:l,totalDv01:c,addForward:function(t){const n={...t,id:t.id||`forward_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return e.value.push(n),a.value.push(null),n.id},updateForward:function(t,a){const n=e.value.findIndex(e=>e.id===t);-1!==n&&(e.value[n]={...e.value[n],...a})},removeForward:function(t){const n=e.value.findIndex(e=>e.id===t);-1!==n&&(e.value.splice(n,1),a.value.splice(n,1))},loadRegistry:function(t){e.value=t.map((e,t)=>({...e,id:e.id||`forward_${Date.now()}_${t}_${Math.random().toString(36).substr(2,9)}`})),a.value=new Array(t.length).fill(null)},clearRegistry:function(){e.value=[],a.value=[]},setForwardResult:function(t,n){t>=0&&t<a.value.length&&(a.value[t]=n,t<e.value.length&&(e.value[t].valuationResult=n||void 0))},setAllResults:function(t){a.value=[...t],t.forEach((t,a)=>{a<e.value.length&&(e.value[a].valuationResult=t||void 0)})},setValuationDate:function(e){n.value=e},getForwardByIndex:function(t){return e.value[t]||null},getResultByIndex:function(e){return a.value[e]||null},getForwardsByType:function(t){return e.value.filter(e=>e.forwardType===t)},getForwardsByTypeWithResults:function(t){return e.value.map((e,t)=>({forward:e,result:a.value[t]||null})).filter(e=>e.forward.forwardType===t)}}}),Oue={class:"forward-valuation-page"},Fue={class:"page-header"},Bue={class:"header-right"},Uue={class:"control-group"},zue={class:"control-group"},Vue=["disabled"],Hue={key:0},Gue={key:1},Wue={key:0,class:"error-message"},que={key:1,class:"card full-width",style:{"margin-bottom":"24px"}},Yue={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},jue={class:"card-subtitle"},Xue={style:{display:"flex",gap:"8px"}},$ue=["disabled"],Kue=["disabled"],Zue={key:0},Jue={key:1},Que=["disabled"],ede={key:0},tde={key:1},ade={class:"scenario-table-container"},nde={class:"scenario-table"},rde={key:0},ide={key:1},ode={key:2},sde={key:3},lde={key:4},cde={key:5},ude={key:6},dde=["onClick"],hde={key:0},pde={key:1},fde={key:2,class:"mono"},mde={key:3,class:"mono"},vde={key:4,class:"mono"},gde={class:"mono"},yde={class:"mono"},bde={class:"mono"},xde={key:5,class:"mono accent"},wde=["onClick"],_de={class:"grid-2"},Sde={class:"card"},Mde={class:"parameter-group"},Tde={class:"param-row"},kde={class:"param-row"},Cde={class:"param-row"},Ade={class:"card"},Ede={class:"parameter-group"},Ide={class:"param-row"},Rde={class:"param-row"},Dde={class:"param-row"},Pde={class:"card full-width"},Lde={class:"parameter-group"},Nde={class:"param-row"},Ode={class:"param-row"},Fde={class:"param-row"},Bde={class:"param-row"},Ude={class:"param-row"},zde={class:"card"},Vde={class:"parameter-group"},Hde={class:"param-row"},Gde={class:"param-row"},Wde={class:"param-row"},qde={class:"param-row"},Yde={class:"param-row"},jde={class:"param-row"},Xde={class:"param-row"},$de={class:"param-row"},Kde={class:"param-row"},Zde={class:"card"},Jde={class:"parameter-group"},Qde={class:"param-row"},ehe={class:"param-row"},the={class:"param-row"},ahe={class:"param-row"},nhe={class:"param-row"},rhe={class:"param-row"},ihe={class:"param-row"},ohe={class:"card full-width"},she={class:"parameter-group"},lhe={class:"param-row"},che={key:0,class:"yield-curve-inputs"},uhe=["onUpdate:modelValue"],dhe={class:"card"},hhe={class:"parameter-group"},phe={class:"param-row"},fhe={key:0,class:"param-row"},mhe={key:1,class:"param-row"},vhe={key:2,class:"param-row"},ghe={class:"card"},yhe={class:"parameter-group"},bhe={class:"param-row"},xhe={class:"param-row"},whe={class:"param-row"},_he={class:"grid-3"},She={class:"metric-card"},Mhe={class:"metric-value accent"},The={class:"metric-detail"},khe={class:"detail-value"},Che={class:"metric-card"},Ahe={class:"metric-value blue"},Ehe={class:"metric-card"},Ihe={class:"metric-detail"},Rhe={key:0,class:"detail-value"},Dhe={key:1,class:"detail-value"},Phe={key:2,class:"card full-width"},Lhe={class:"grid-3"},Nhe={class:"metric-card"},Ohe={class:"metric-value accent"},Fhe={class:"metric-card"},Bhe={class:"metric-value blue"},Uhe={class:"metric-card"},zhe={class:"metric-value blue"},Vhe={class:"grid-2",style:{"margin-top":"20px"}},Hhe={class:"card"},Ghe={class:"parameter-group"},Whe={class:"param-row"},qhe={class:"param-value"},Yhe={class:"param-row"},jhe={class:"param-value"},Xhe={class:"card"},$he={class:"parameter-group"},Khe={class:"param-row"},Zhe={class:"param-value"},Jhe={class:"param-row"},Qhe={class:"param-value"},epe={key:0,class:"param-row"},tpe={key:3,class:"card full-width"},ape={class:"carry-breakdown"},npe={class:"carry-item"},rpe={class:"carry-value accent"},ipe={class:"carry-item"},ope={class:"carry-value"},spe={class:"carry-item"},lpe={class:"carry-value"},cpe={class:"carry-item"},upe={class:"carry-value negative"},dpe={class:"carry-item"},hpe={class:"carry-value negative"},ppe={class:"carry-item total"},fpe={class:"carry-value cyan"},mpe={class:"carry-item final"},vpe={key:4,class:"grid-3"},gpe={class:"card"},ype={class:"value-breakdown"},bpe={class:"item"},xpe={class:"value accent"},wpe={class:"item"},_pe={class:"value blue"},Spe={class:"item total"},Mpe={class:"card"},Tpe={class:"value-breakdown"},kpe={class:"item"},Cpe={class:"value accent"},Ape={class:"item"},Epe={class:"value blue"},Ipe={class:"item total"},Rpe={class:"card"},Dpe={class:"value-breakdown"},Ppe={class:"item"},Lpe={class:"item"},Npe={class:"item total"},Ope={class:"value accent"},Fpe={class:"card full-width"},Bpe={class:"scenario-table-container"},Upe={class:"scenario-table"},zpe={class:"mono"},Vpe={class:"mono"},Hpe={class:"mono"},Gpe={class:"mono"},Wpe={class:"mono"},qpe={class:"mono positive"},Ype={class:"base"},jpe={class:"mono accent",style:{"font-weight":"700"}},Xpe={key:0,class:"card full-width"},$pe={class:"parameter-group"},Kpe={class:"param-row"},Zpe={class:"param-value"},Jpe={class:"param-row"},Qpe={class:"param-value"},efe={class:"param-row"},tfe={class:"param-value accent"},afe={class:"param-row"},nfe={class:"param-value"},rfe={class:"param-row"},ife={class:"param-value"},ofe={class:"param-row"},sfe={class:"param-value"},lfe={class:"param-row"},cfe={class:"param-value negative"},ufe={class:"param-row total"},dfe={class:"param-value accent"},hfe={class:"param-row"},pfe={class:"param-value negative"},ffe={class:"param-row final"},mfe={class:"param-value accent",style:{"font-size":"16px","font-weight":"700"}},vfe={key:1,class:"grid-3"},gfe={class:"card"},yfe={class:"metric-value accent"},bfe={class:"metric-detail"},xfe={class:"detail-value"},wfe={class:"card"},_fe={class:"metric-value blue"},Sfe={class:"metric-detail"},Mfe={class:"detail-value"},Tfe={class:"card"},kfe={class:"metric-detail"},Cfe={class:"detail-value"},Afe={class:"grid-2"},Efe={class:"card"},Ife={class:"chart-header"},Rfe={class:"chart-subtitle"},Dfe={class:"chart-container"},Pfe={class:"card"},Lfe={class:"chart-header"},Nfe={class:"chart-subtitle"},Ofe={class:"chart-container"},Ffe={class:"card full-width"},Bfe={class:"scenario-table-container"},Ufe={class:"scenario-table"},zfe={class:"scenario-name"},Vfe={class:"spot-price mono"},Hfe={key:6,class:"grid-2"},Gfe={class:"card"},Wfe={class:"sensitivity-metrics"},qfe={class:"sens-item"},Yfe={class:"value accent"},jfe={class:"sens-item"},Xfe={class:"value blue"},$fe={class:"sens-item"},Kfe={class:"value cyan"},Zfe={class:"card"},Jfe={class:"sensitivity-metrics"},Qfe={class:"sens-item"},eme={class:"value accent"},tme={class:"sens-item"},ame={class:"value blue"},nme={class:"sens-item"},rme={class:"value cyan"},ime={class:"page-footer"},ome={key:0},sme={key:1},lme={key:2},cme=e({__name:"ForwardValuation",setup(e){const a=Nue(),r=t("fx"),o=t(!1),u=t(!1),d=t(""),h=t(null),g=t(null),y=t(!1),b=S(()=>a.registryForwards),x=S(()=>a.forwardResults),_=t({spotPrice:100,timeToMaturity:.25,marketForwardPrice:101.5,contractSize:1e6,dividendYield:2.5,carryingCost:.5,convenienceYield:0,riskFreeRate:4.25,repoRate:4.2,accruedInterest:.5,couponRate:7.5,couponFrequency:2,faceValue:100,lastCouponDate:"",maturityDate:"",dayCountConvention:"ACT/365",autoCalculateAI:!0,bondValuationDate:(new Date).toISOString().split("T")[0],bondExpirationDate:new Date(Date.now()+7776e6).toISOString().split("T")[0],useYieldCurve:!1,yieldCurvePoints:[{tenor:1,rate:4},{tenor:3,rate:4.2},{tenor:6,rate:4.5},{tenor:12,rate:4.8},{tenor:24,rate:5},{tenor:36,rate:5.2}],fxBuyCurrency:"RUB",fxSellCurrency:"CNY",fxBuyAmount:40716e4,fxSellAmount:3e7,fxDealDate:(new Date).toISOString().split("T")[0],fxValuationDate:(new Date).toISOString().split("T")[0],fxExpirationDate:new Date(Date.now()+7776e6).toISOString().split("T")[0],settlementCurrency:"RUB",fxInternalRate:15,fxExternalRate:1.7}),M=t({fairForwardPrice:0,forwardValue:0,intrinsicValue:0,timeValue:0,totalValue:0,delta:0,rho:0,netCarry:0,scenarios:[]}),C=S(()=>M.value.scenarios||[]),A=t(null),P=t(null);let N=null,O=null;const F=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:3,maximumFractionDigits:3}).format(e),B=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(3)+"М":"₽"+(e/1e3).toFixed(3)+"K",U=e=>{if(!e)return"";return new Date(e).toLocaleDateString("ru-RU")},V=()=>{setTimeout(()=>{G()},100)},H=async()=>{o.value=!0,d.value="";try{const e={forwardType:r.value,spotPrice:_.value.spotPrice,timeToMaturity:_.value.timeToMaturity,marketForwardPrice:_.value.marketForwardPrice,contractSize:_.value.contractSize};"fx"===r.value?(e.buyCurrency=_.value.fxBuyCurrency,e.sellCurrency=_.value.fxSellCurrency,e.buyAmount=_.value.fxBuyAmount,e.sellAmount=_.value.fxSellAmount,e.dealDate=_.value.fxDealDate,e.valuationDate=_.value.fxValuationDate,e.expirationDate=_.value.fxExpirationDate,e.settlementCurrency=_.value.settlementCurrency||"RUB",e.internalRate=_.value.fxInternalRate,e.externalRate=_.value.fxExternalRate):"bond"===r.value?(e.accruedInterest=_.value.accruedInterest,e.couponRate=_.value.couponRate,e.couponFrequency=_.value.couponFrequency,e.faceValue=_.value.faceValue,e.riskFreeRate=_.value.riskFreeRate,e.repoRate=_.value.repoRate,e.lastCouponDate=_.value.lastCouponDate||null,e.maturityDate=_.value.maturityDate||null,e.dayCountConvention=_.value.dayCountConvention||"ACT/365",e.autoCalculateAI=!1!==_.value.autoCalculateAI,e.valuationDate=_.value.bondValuationDate||null,e.expirationDate=_.value.bondExpirationDate||null,_.value.useYieldCurve&&_.value.yieldCurvePoints&&(e.yieldCurveTenors=_.value.yieldCurvePoints.map(e=>e.tenor/12),e.yieldCurveRates=_.value.yieldCurvePoints.map(e=>e.rate))):(e.dividendYield=_.value.dividendYield,e.carryingCost=_.value.carryingCost,e.convenienceYield=_.value.convenienceYield,e.riskFreeRate=_.value.riskFreeRate,_.value.repoRate&&(e.repoRate=_.value.repoRate));const t=await Lue(e);M.value=t,V()}catch(e){d.value=e.message||"Ошибка при расчете форварда",console.error("Forward valuation error:",e)}finally{o.value=!1}},G=()=>{if(N&&N.destroy(),O&&O.destroy(),A.value?.getContext("2d")){const e=[],t=[],a=[];if("fx"===r.value){const n=_.value.spotPrice,r=(_.value.fxInternalRate||4.2)/100,i=(_.value.fxExternalRate||11.7)/100,o=_.value.timeToMaturity,s=_.value.marketForwardPrice;for(let l=.7;l<=1.3;l+=.05){const c=n*l;e.push(c);const u=c*(1+i*o)/(1+r*o);t.push(u),a.push(s)}}else for(let n=.7;n<=1.3;n+=.05){const r=_.value.spotPrice*n;e.push(r);const i=_.value.riskFreeRate/100,o=_.value.dividendYield/100,s=_.value.carryingCost/100,l=_.value.convenienceYield/100,c=_.value.timeToMaturity,u=r*Math.exp((i+s-o-l)*c);t.push(u),a.push(_.value.marketForwardPrice)}N=new re(A.value.getContext("2d"),{type:"line",data:{labels:e.map(e=>e.toFixed(2)),datasets:[{label:"Fair Forward Price",data:t,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:2,borderWidth:2},{label:"Market Price",data:a,borderColor:"#f59e0b",backgroundColor:"transparent",fill:!1,tension:0,borderDash:[5,5],pointRadius:0,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{title:{display:!0,text:"Spot Price",color:"rgba(255,255,255,0.5)"},grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{title:{display:!0,text:"Forward Price",color:"rgba(255,255,255,0.5)"},grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(P.value?.getContext("2d")){const e=[],t=[];if("fx"===r.value){const a=_.value.spotPrice,n=_.value.marketForwardPrice,r=(_.value.fxInternalRate||4.2)/100,i=(_.value.fxExternalRate||11.7)/100,o=_.value.fxBuyAmount||1e6;let s=_.value.timeToMaturity;if(_.value.fxValuationDate&&_.value.fxExpirationDate){const e=new Date(_.value.fxValuationDate);s=(new Date(_.value.fxExpirationDate).getTime()-e.getTime())/864e5/365}for(let l=0;l<=12;l++){const c=s*l/12,u=s-c;if(u>0){const e=(n-a*(1+i*u)/(1+r*u))*o/(1+i*u);t.push(e)}else t.push(0);e.push((12*c).toFixed(0))}}else for(let a=0;a<=_.value.timeToMaturity;a+=_.value.timeToMaturity/12){const n=_.value.riskFreeRate/100,r=(_.value.spotPrice-_.value.marketForwardPrice)/Math.exp(n*a);e.push((12*a).toFixed(0)),t.push(r)}O=new re(P.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"fx"===r.value?"NPV Contract (RUB)":"Forward Value",data:t,borderColor:"#38bdf8",backgroundColor:"rgba(56, 189, 248, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{title:{display:!0,text:"Months to Maturity",color:"rgba(255,255,255,0.5)"},grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{title:{display:!0,text:"fx"===r.value?"NPV (RUB)":"Value",color:"rgba(255,255,255,0.5)"},grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}};R(r,()=>{setTimeout(()=>{G()},100)});let W=null;R(()=>[_.value.spotPrice,_.value.marketForwardPrice,_.value.timeToMaturity,_.value.fxInternalRate,_.value.fxExternalRate,_.value.fxBuyAmount,_.value.riskFreeRate,_.value.dividendYield],()=>{W&&clearTimeout(W),W=setTimeout(()=>{A.value&&P.value&&G()},300)},{deep:!0});const q=async e=>{const t=e.target,n=t.files?.[0];if(n)try{const e=pj(await n.arrayBuffer(),{type:"array"}),t=e.SheetNames[0],i=e.Sheets[t],o=Rj.sheet_to_json(i,{raw:!1}),s=[];for(const a of o){const e={forwardType:a["Тип"]||a.Type||a.type||r.value};"fx"===e.forwardType||"fx"===r.value?(e.fxSellCurrency=a["Валюта продажи"]||a["Sell Currency"]||a.sell_currency||"CNY",e.fxBuyCurrency=a["Валюта покупки"]||a["Buy Currency"]||a.buy_currency||"RUB",e.fxSellAmount=parseFloat(a["Сумма продажи"]||a["Sell Amount"]||a.sell_amount||"0"),e.fxBuyAmount=parseFloat(a["Сумма покупки"]||a["Buy Amount"]||a.buy_amount||"0"),e.fxInternalRate=parseFloat(a["Ставка покупки"]||a["Internal Rate"]||a.internal_rate||"15.0"),e.fxExternalRate=parseFloat(a["Ставка продажи"]||a["External Rate"]||a.external_rate||"1.7"),e.spotPrice=parseFloat(a["Спот курс"]||a["Spot Rate"]||a.spot_rate||a.Spot||"0"),e.marketForwardPrice=parseFloat(a["Курс сделки"]||a["Forward Rate"]||a.forward_rate||a["Market Forward"]||"0")):(e.spotPrice=parseFloat(a["Спот цена"]||a["Spot Price"]||a.spot_price||a.Spot||"0"),e.marketForwardPrice=parseFloat(a["Рыночная цена"]||a["Market Forward"]||a.market_forward||a.Forward||"0"),e.riskFreeRate=parseFloat(a["Безрисковая ставка"]||a["Risk Free Rate"]||a.risk_free_rate||"4.25"),e.timeToMaturity=parseFloat(a["Время до экспирации"]||a["Time to Maturity"]||a.time_to_maturity||"0.25"),"bond"!==e.forwardType&&"bond"!==r.value||(e.couponRate=parseFloat(a["Купонная ставка"]||a["Coupon Rate"]||a.coupon_rate||"7.5"),e.faceValue=parseFloat(a["Номинал"]||a["Face Value"]||a.face_value||"100"),e.repoRate=parseFloat(a["Репо ставка"]||a["Repo Rate"]||a.repo_rate||"4.2"))),e.valuationDate=a["Дата оценки"]||a["Valuation Date"]||a.valuation_date||(new Date).toISOString().split("T")[0],e.expirationDate=a["Дата экспирации"]||a["Expiration Date"]||a.expiration_date||new Date(Date.now()+7776e6).toISOString().split("T")[0],e.contractSize=parseFloat(a["Размер контракта"]||a["Contract Size"]||a.contract_size||"1000000"),(e.spotPrice>0||e.fxSellAmount>0)&&s.push(e)}a.loadRegistry(s),g.value=null,d.value=""}catch(i){d.value=`Ошибка при загрузке файла: ${i.message}`,console.error("Excel parsing error:",i)}},Y=async()=>{u.value=!0,d.value="";try{const t=[];for(let n=0;n<a.registryForwards.length;n++){const i=a.registryForwards[n],o={forwardType:i.forwardType||r.value,spotPrice:i.spotPrice||0,timeToMaturity:i.timeToMaturity||.25,marketForwardPrice:i.marketForwardPrice||0,contractSize:i.contractSize||1e6};"fx"===i.forwardType||"fx"===r.value?(o.buyCurrency=i.fxBuyCurrency,o.sellCurrency=i.fxSellCurrency,o.buyAmount=i.fxBuyAmount,o.sellAmount=i.fxSellAmount,o.valuationDate=i.valuationDate,o.expirationDate=i.expirationDate,o.internalRate=i.fxInternalRate,o.externalRate=i.fxExternalRate):"bond"===i.forwardType||"bond"===r.value?(o.couponRate=i.couponRate,o.faceValue=i.faceValue,o.repoRate=i.repoRate,o.riskFreeRate=i.riskFreeRate,o.valuationDate=i.valuationDate,o.expirationDate=i.expirationDate):o.riskFreeRate=i.riskFreeRate;try{const e=await Lue(o);t.push(e),a.setForwardResult(n,e)}catch(e){const r={fairForwardPrice:0,forwardValue:0,intrinsicValue:0,timeValue:0,totalValue:0,delta:0,rho:0,netCarry:0,scenarios:[]};t.push(r),a.setForwardResult(n,r),console.error(`Error calculating contract ${n+1}:`,e)}}a.setAllResults(t)}catch(e){d.value=`Ошибка при расчете контрактов: ${e.message}`}finally{u.value=!1}},j=()=>{if(0===a.registryForwards.length)return void alert("Нет данных для экспорта. Загрузите реестр форвардов.");const e=a.forwardResults.length>0&&a.forwardResults.some(e=>e&&null!==e.fairForwardPrice&&void 0!==e.fairForwardPrice);if(!e){if(!confirm("Контракты еще не рассчитаны. Экспортировать только входные параметры?"))return}const t=a.registryForwards.map((e,t)=>{const n=a.getResultByIndex(t),i=e.forwardType||r.value,o={"№":t+1,"Тип":i.toUpperCase(),"Дата оценки":e.valuationDate||"","Дата экспирации":e.expirationDate||"","Рыночная цена":e.marketForwardPrice||0,"Размер контракта":e.contractSize||1e6};return"fx"===i||"fx"===r.value?(o["Валюта продажи"]=e.fxSellCurrency||"",o["Валюта покупки"]=e.fxBuyCurrency||"",o["Сумма продажи"]=e.fxSellAmount||0,o["Сумма покупки"]=e.fxBuyAmount||0,o["Спот курс"]=e.spotPrice||0,o["Ставка покупки (%)"]=e.fxInternalRate||0,o["Ставка продажи (%)"]=e.fxExternalRate||0):(o["Спот цена"]=e.spotPrice||0,o["Время до экспирации (лет)"]=e.timeToMaturity||0,o["Безрисковая ставка (%)"]=e.riskFreeRate||0,"bond"===i||"bond"===r.value?(o["Купонная ставка (%)"]=e.couponRate||0,o["Номинал"]=e.faceValue||0,o["Репо ставка (%)"]=e.repoRate||0,o["Частота купонов"]=e.couponFrequency||2,o["НКД"]=e.accruedInterest||0):"equity"===i?o["Дивиденды (%)"]=e.dividendYield||0:"commodity"===i&&(o["Стоимость хранения (%)"]=e.carryingCost||0,o["Удобство владения (%)"]=e.convenienceYield||0)),n?(o["Справедливая цена"]=null!==n.fairForwardPrice&&void 0!==n.fairForwardPrice?n.fairForwardPrice.toFixed(6):"",o["Стоимость (на единицу)"]=null!==n.forwardValue&&void 0!==n.forwardValue?n.forwardValue.toFixed(6):"",o["Стоимость (на контракт)"]=null!==n.forwardValue&&void 0!==n.forwardValue?(n.forwardValue*(e.contractSize||1e6)).toFixed(2):"",o["Внутренняя стоимость"]=null!==n.intrinsicValue&&void 0!==n.intrinsicValue?n.intrinsicValue.toFixed(6):"",o["Временная стоимость"]=null!==n.timeValue&&void 0!==n.timeValue?n.timeValue.toFixed(6):"",o["Общая стоимость"]=null!==n.totalValue&&void 0!==n.totalValue?n.totalValue.toFixed(6):"",o["Delta (Δ)"]=null!==n.delta&&void 0!==n.delta?n.delta.toFixed(6):"",o["Rho (ρ)"]=null!==n.rho&&void 0!==n.rho?n.rho.toFixed(6):"",o["Net Carry"]=null!==n.netCarry&&void 0!==n.netCarry?(100*n.netCarry).toFixed(4)+"%":"","fx"!==i&&"fx"!==r.value||(o["Валютная пара"]=n.currencyPair||"",o["Форвардный курс (мин)"]=null!==n.forwardRateMin&&void 0!==n.forwardRateMin?n.forwardRateMin.toFixed(6):"",o["Форвардный курс (макс)"]=null!==n.forwardRateMax&&void 0!==n.forwardRateMax?n.forwardRateMax.toFixed(6):"",o["Дисконт-фактор (внутр.)"]=null!==n.discountFactorInternal&&void 0!==n.discountFactorInternal?n.discountFactorInternal.toFixed(6):"",o["Дисконт-фактор (внешн.)"]=null!==n.discountFactorExternal&&void 0!==n.discountFactorExternal?n.discountFactorExternal.toFixed(6):"",o["Справедливая стоимость (мин)"]=null!==n.fairValueMin&&void 0!==n.fairValueMin?n.fairValueMin.toFixed(2):"",o["Справедливая стоимость (макс)"]=null!==n.fairValueMax&&void 0!==n.fairValueMax?n.fairValueMax.toFixed(2):"",void 0!==n.forwardDiff&&(o["Расхождение с курсом сделки"]="string"==typeof n.forwardDiff?n.forwardDiff:n.forwardDiff.toFixed(6))),"bond"!==i&&"bond"!==r.value||(o.DV01=null!==n.dv01&&void 0!==n.dv01?n.dv01.toFixed(6):"",o.Convexity=null!==n.convexity&&void 0!==n.convexity?n.convexity.toFixed(4):"",o["Repo Sensitivity"]=null!==n.repoSensitivity&&void 0!==n.repoSensitivity?n.repoSensitivity.toFixed(6):"",o["PV купонов"]=null!==n.pvCoupons&&void 0!==n.pvCoupons?n.pvCoupons.toFixed(2):"",o["Спот цена (dirty)"]=null!==n.spotDirtyPrice&&void 0!==n.spotDirtyPrice?n.spotDirtyPrice.toFixed(6):"",o["Форвард цена (dirty)"]=null!==n.forwardDirtyPrice&&void 0!==n.forwardDirtyPrice?n.forwardDirtyPrice.toFixed(6):"",o["НКД на экспирацию"]=null!==n.aiForward&&void 0!==n.aiForward?n.aiForward.toFixed(6):"",n.formulaBreakdown&&(o["Спот цена (clean)"]=n.formulaBreakdown.spotCleanPrice.toFixed(6),o["НКД на дату оценки"]=n.formulaBreakdown.accruedInterestSpot.toFixed(6),o["Стоимость финансирования"]=n.formulaBreakdown.financingCost.toFixed(6),o["PV купонов (детально)"]=n.formulaBreakdown.totalCouponsPV.toFixed(6))),o["Статус расчета"]="Рассчитан"):o["Статус расчета"]="Не рассчитан",o}),n=Rj.book_new(),i=Rj.json_to_sheet(t),o=[],s=Math.max(...t.map(e=>Object.keys(e).length));for(let a=0;a<s;a++)o.push({wch:18});if(i["!cols"]=o,Rj.book_append_sheet(n,i,"Реестр форвардов"),e){const e=[];if(b.value.forEach((t,a)=>{const n=x.value[a];n&&n.scenarios&&n.scenarios.length>0&&n.scenarios.forEach((n,i)=>{e.push({"№ контракта":a+1,"Тип":t.forwardType||r.value,"№ сценария":i+1,"Название сценария":n.name,"Спот цена":n.spotPrice.toFixed(6),"% Изменение":(n.change>=0?"+":"")+n.change.toFixed(2)+"%","Стоимость форварда":n.forwardValue.toFixed(6),"P&L (Лонг)":n.pnlLong.toFixed(2),"P&L (Шорт)":n.pnlShort.toFixed(2),"Базовый сценарий":n.isBase?"Да":"Нет"})})}),e.length>0){const t=Rj.json_to_sheet(e),a=[{wch:10},{wch:10},{wch:10},{wch:20},{wch:15},{wch:15},{wch:18},{wch:15},{wch:15},{wch:15}];t["!cols"]=a,Rj.book_append_sheet(n,t,"Сценарии")}}if(e){const e=[];if(a.registryForwards.forEach((t,n)=>{const i=a.getResultByIndex(n);i&&i.couponSchedule&&i.couponSchedule.length>0&&i.couponSchedule.forEach(a=>{e.push({"№ контракта":n+1,"Тип":t.forwardType||r.value,"№ купона":a.couponNumber,"Дата купона":U(a.couponDate),"Дней до платежа":a.daysToPayment,"Лет до платежа":a.yearsToPayment.toFixed(4),"Сумма купона":a.couponAmount.toFixed(2),"Ставка дисконтирования (%)":a.discountRate.toFixed(3),"Дисконт-фактор":a.discountFactor.toFixed(6),"Приведенная стоимость":a.presentValue.toFixed(2)})})}),e.length>0){const t=Rj.json_to_sheet(e),a=[{wch:10},{wch:10},{wch:10},{wch:12},{wch:15},{wch:15},{wch:15},{wch:20},{wch:15},{wch:18}];t["!cols"]=a,Rj.book_append_sheet(n,t,"Расписание купонов")}}const l=new Date,c=`реестр_форвардов_${l.toISOString().split("T")[0]}_${l.toTimeString().split(" ")[0].replace(/:/g,"-")}.xlsx`;try{bj(n,c),alert(`Реестр успешно экспортирован: ${c}\n${e?"Включая все расчеты, сценарии и расписание купонов.":"Только входные параметры (контракты не рассчитаны)."}`)}catch(u){console.error("Ошибка при экспорте:",u),alert(`Ошибка при экспорте файла: ${u.message}`)}},X=async()=>{if(0!==a.registryForwards.length){y.value=!0,d.value="";try{const e=await(async e=>{try{const t=await fetch(`${Pue}/api/database/export/registry/parquet`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registry_type:"forward",data:e})});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(d){throw console.error("Save Registry to Parquet Failed:",d),d}})(a.registryForwards);e.success&&(d.value=`Реестр успешно сохранен: ${e.data.file_name}`,setTimeout(()=>{d.value=""},5e3))}catch(e){console.error("Error saving registry to parquet:",e),d.value=`Ошибка при сохранении реестра: ${e.message}`}finally{y.value=!1}}},$=()=>{a.clearRegistry(),g.value=null,h.value&&(h.value.value="")},K=()=>{const e={forwardType:r.value,spotPrice:_.value.spotPrice,timeToMaturity:_.value.timeToMaturity,marketForwardPrice:_.value.marketForwardPrice,contractSize:_.value.contractSize,riskFreeRate:_.value.riskFreeRate,valuationDate:"fx"===r.value?_.value.fxValuationDate:_.value.bondValuationDate,expirationDate:"fx"===r.value?_.value.fxExpirationDate:_.value.bondExpirationDate};"fx"===r.value?(e.fxBuyCurrency=_.value.fxBuyCurrency,e.fxSellCurrency=_.value.fxSellCurrency,e.fxBuyAmount=_.value.fxBuyAmount,e.fxSellAmount=_.value.fxSellAmount,e.fxInternalRate=_.value.fxInternalRate,e.fxExternalRate=_.value.fxExternalRate):"bond"===r.value?(e.couponRate=_.value.couponRate,e.faceValue=_.value.faceValue,e.repoRate=_.value.repoRate,e.accruedInterest=_.value.accruedInterest,e.couponFrequency=_.value.couponFrequency):(e.dividendYield=_.value.dividendYield,e.carryingCost=_.value.carryingCost,e.convenienceYield=_.value.convenienceYield),a.addForward(e)};return n(()=>{H()}),z(()=>{W&&clearTimeout(W),N&&N.destroy(),O&&O.destroy()}),(e,t)=>(w(),i("div",Oue,[s("div",Fue,[t[40]||(t[40]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Оценка форвардов"),s("p",{class:"page-subtitle"},"Справедливая стоимость и анализ форвардных контрактов")],-1)),s("div",Bue,[s("div",Uue,[t[37]||(t[37]=s("label",{class:"control-label"},"Реестр:",-1)),s("input",{type:"file",ref_key:"fileInputRef",ref:h,onChange:q,accept:".xlsx,.xls",style:{display:"none"},id:"excel-upload"},null,544),s("button",{onClick:t[0]||(t[0]=()=>{h.value&&h.value.click()}),class:"btn-secondary",title:"Загрузить реестр контрактов из Excel"}," Загрузить Excel ")]),s("div",zue,[t[39]||(t[39]=s("label",{class:"control-label"},"Тип форварда:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),class:"forward-type-select",onChange:V},[...t[38]||(t[38]=[I('<option value="bond" data-v-b51d3d57>Форвард на облигацию</option><option value="fx" data-v-b51d3d57>Валютный форвард</option><option value="commodity" data-v-b51d3d57>Форвард на товар</option><option value="equity" data-v-b51d3d57>Форвард на акцию</option><option value="rate" data-v-b51d3d57>Форвард на ставку</option>',5)])],544),[[D,r.value]])]),s("button",{onClick:K,class:"btn-secondary",title:"Добавить текущий форвард в реестр"}," ➕ Добавить в реестр "),s("button",{onClick:H,class:"btn-primary",disabled:o.value},[o.value?(w(),i("span",Gue,"↺ Считаю...")):(w(),i("span",Hue,"Пересчитать"))],8,Vue)])]),d.value?(w(),i("div",Wue," ⚠️ "+v(d.value),1)):l("",!0),b.value.length>0?(w(),i("div",que,[s("div",Yue,[s("div",null,[t[41]||(t[41]=s("h3",null,"Реестр контрактов",-1)),s("span",jue,"Загружено контрактов: "+v(b.value.length),1)]),s("div",Xue,[s("button",{onClick:j,class:"btn-secondary",disabled:0===b.value.length,style:{"font-size":"11px",padding:"6px 12px"},title:"Выгрузить реестр в Excel"}," 📥 Выгрузить Excel ",8,$ue),s("button",{onClick:X,class:"btn-secondary",disabled:0===b.value.length||y.value,style:{"font-size":"11px",padding:"6px 12px"},title:"Сохранить реестр в Supabase (parquet)"},[y.value?(w(),i("span",Jue,"↺ Сохранение...")):(w(),i("span",Zue,"💾 Сохранить в БД"))],8,Kue),s("button",{onClick:Y,class:"btn-secondary",disabled:u.value,style:{"font-size":"11px",padding:"6px 12px"}},[u.value?(w(),i("span",tde,"↺ Считаю...")):(w(),i("span",ede,"Рассчитать все"))],8,Que),s("button",{onClick:$,class:"btn-secondary",style:{"font-size":"11px",padding:"6px 12px",background:"rgba(239, 68, 68, 0.2)","border-color":"rgba(239, 68, 68, 0.3)"}}," ✕ Очистить ")])]),s("div",ade,[s("table",nde,[s("thead",null,[s("tr",null,[t[42]||(t[42]=s("th",null,"№",-1)),t[43]||(t[43]=s("th",null,"Тип",-1)),"fx"===r.value?(w(),i("th",rde,"Валюта продажи")):l("",!0),"fx"===r.value?(w(),i("th",ide,"Валюта покупки")):l("",!0),"fx"===r.value?(w(),i("th",ode,"Сумма продажи")):l("",!0),"fx"===r.value?(w(),i("th",sde,"Сумма покупки")):l("",!0),"fx"!==r.value?(w(),i("th",lde,"Спот цена")):l("",!0),t[44]||(t[44]=s("th",null,"Дата оценки",-1)),t[45]||(t[45]=s("th",null,"Дата экспирации",-1)),t[46]||(t[46]=s("th",null,"Рыночная цена",-1)),x.value.length>0?(w(),i("th",cde,"Справедливая цена")):l("",!0),x.value.length>0?(w(),i("th",ude,"Стоимость")):l("",!0),t[47]||(t[47]=s("th",null,"Действие",-1))])]),s("tbody",null,[(w(!0),i(p,null,f(b.value,(e,t)=>(w(),i("tr",{key:t,class:c({selected:g.value===t}),onClick:e=>(e=>{g.value=e})(t)},[s("td",null,v(t+1),1),s("td",null,v(e.forwardType||r.value),1),"fx"===r.value?(w(),i("td",hde,v(e.fxSellCurrency||"-"),1)):l("",!0),"fx"===r.value?(w(),i("td",pde,v(e.fxBuyCurrency||"-"),1)):l("",!0),"fx"===r.value?(w(),i("td",fde,v(e.fxSellAmount?B(e.fxSellAmount):"-"),1)):l("",!0),"fx"===r.value?(w(),i("td",mde,v(e.fxBuyAmount?B(e.fxBuyAmount):"-"),1)):l("",!0),"fx"!==r.value?(w(),i("td",vde,v(e.spotPrice?F(e.spotPrice):"-"),1)):l("",!0),s("td",gde,v(e.valuationDate||"-"),1),s("td",yde,v(e.expirationDate||"-"),1),s("td",bde,v(e.marketForwardPrice?F(e.marketForwardPrice):"-"),1),x.value.length>0&&x.value[t]?(w(),i("td",xde,v(x.value[t]?.fairForwardPrice?F(x.value[t].fairForwardPrice):"-"),1)):l("",!0),x.value.length>0&&x.value[t]?(w(),i("td",{key:6,class:c(["mono",(x.value[t]?.forwardValue||0)>=0?"positive":"negative"])},v(x.value[t]?.forwardValue?B(x.value[t].forwardValue):"-"),3)):l("",!0),s("td",null,[s("button",{onClick:E(e=>(e=>{const t=a.getForwardByIndex(e);t&&(r.value=t.forwardType||r.value,"fx"===t.forwardType||"fx"===r.value?(_.value.fxSellCurrency=t.fxSellCurrency||_.value.fxSellCurrency,_.value.fxBuyCurrency=t.fxBuyCurrency||_.value.fxBuyCurrency,_.value.fxSellAmount=t.fxSellAmount||_.value.fxSellAmount,_.value.fxBuyAmount=t.fxBuyAmount||_.value.fxBuyAmount,_.value.fxInternalRate=t.fxInternalRate||_.value.fxInternalRate,_.value.fxExternalRate=t.fxExternalRate||_.value.fxExternalRate,_.value.spotPrice=t.spotPrice||_.value.spotPrice,_.value.fxValuationDate=t.valuationDate||_.value.fxValuationDate,_.value.fxExpirationDate=t.expirationDate||_.value.fxExpirationDate):(_.value.spotPrice=t.spotPrice||_.value.spotPrice,_.value.marketForwardPrice=t.marketForwardPrice||_.value.marketForwardPrice,_.value.riskFreeRate=t.riskFreeRate||_.value.riskFreeRate,_.value.timeToMaturity=t.timeToMaturity||_.value.timeToMaturity,"bond"!==t.forwardType&&"bond"!==r.value||(_.value.couponRate=t.couponRate||_.value.couponRate,_.value.faceValue=t.faceValue||_.value.faceValue,_.value.repoRate=t.repoRate||_.value.repoRate,_.value.bondValuationDate=t.valuationDate||_.value.bondValuationDate,_.value.bondExpirationDate=t.expirationDate||_.value.bondExpirationDate)),_.value.contractSize=t.contractSize||_.value.contractSize,setTimeout(()=>{H()},100))})(t),["stop"]),class:"btn-small",title:"Загрузить в форму"}," 📝 ",8,wde)])],10,dde))),128))])])])])):l("",!0),s("div",_de,["fx"===r.value?(w(),i(p,{key:0},[s("div",Sde,[t[51]||(t[51]=s("div",{class:"card-header"},[s("h3",null,"Продаваемая валюта")],-1)),s("div",Mde,[s("div",Tde,[t[49]||(t[49]=s("label",null,"Валюта",-1)),T(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>_.value.fxSellCurrency=e),class:"param-input",onChange:V},[...t[48]||(t[48]=[I('<option value="CNY" data-v-b51d3d57>CNY</option><option value="RUB" data-v-b51d3d57>RUB</option><option value="EUR" data-v-b51d3d57>EUR</option><option value="GBP" data-v-b51d3d57>GBP</option><option value="JPY" data-v-b51d3d57>JPY</option>',5)])],544),[[D,_.value.fxSellCurrency]])]),s("div",kde,[t[50]||(t[50]=s("label",null,"Сумма продажи",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>_.value.fxSellAmount=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.fxSellAmount,void 0,{number:!0}]])]),s("div",Cde,[s("label",null,"Ставка для "+v(_.value.fxSellCurrency)+" (%)",1),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>_.value.fxExternalRate=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.fxExternalRate,void 0,{number:!0}]])])])]),s("div",Ade,[t[55]||(t[55]=s("div",{class:"card-header"},[s("h3",null,"Покупаемая валюта")],-1)),s("div",Ede,[s("div",Ide,[t[53]||(t[53]=s("label",null,"Валюта",-1)),T(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>_.value.fxBuyCurrency=e),class:"param-input",onChange:V},[...t[52]||(t[52]=[I('<option value="RUB" data-v-b51d3d57>RUB</option><option value="EUR" data-v-b51d3d57>EUR</option><option value="CNY" data-v-b51d3d57>CNY</option><option value="GBP" data-v-b51d3d57>GBP</option><option value="JPY" data-v-b51d3d57>JPY</option>',5)])],544),[[D,_.value.fxBuyCurrency]])]),s("div",Rde,[t[54]||(t[54]=s("label",null,"Сумма покупки",-1)),T(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>_.value.fxBuyAmount=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.fxBuyAmount,void 0,{number:!0}]])]),s("div",Dde,[s("label",null,"Ставка для "+v(_.value.fxBuyCurrency)+" (%)",1),T(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>_.value.fxInternalRate=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.fxInternalRate,void 0,{number:!0}]])])])]),s("div",Pde,[t[61]||(t[61]=s("div",{class:"card-header"},[s("h3",null,"Даты и курсы")],-1)),s("div",Lde,[s("div",Nde,[t[56]||(t[56]=s("label",null,"Дата сделки",-1)),T(s("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>_.value.fxDealDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.fxDealDate]])]),s("div",Ode,[t[57]||(t[57]=s("label",null,"Дата оценки",-1)),T(s("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>_.value.fxValuationDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.fxValuationDate]])]),s("div",Fde,[t[58]||(t[58]=s("label",null,"Дата экспирации",-1)),T(s("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>_.value.fxExpirationDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.fxExpirationDate]])]),s("div",Bde,[t[59]||(t[59]=s("label",null,"Спот курс",-1)),T(s("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>_.value.spotPrice=e),type:"number",class:"param-input",step:"0.0001",onChange:V},null,544),[[k,_.value.spotPrice,void 0,{number:!0}]])]),s("div",Ude,[t[60]||(t[60]=s("label",null,"Курс сделки (форвард)",-1)),T(s("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>_.value.marketForwardPrice=e),type:"number",class:"param-input",step:"0.0001",onChange:V},null,544),[[k,_.value.marketForwardPrice,void 0,{number:!0}]])])])])],64)):l("",!0),"bond"===r.value?(w(),i(p,{key:1},[s("div",zde,[t[73]||(t[73]=s("div",{class:"card-header"},[s("h3",null,"Параметры облигации")],-1)),s("div",Vde,[s("div",Hde,[t[62]||(t[62]=s("label",null,"Спот цена (clean, %)",-1)),T(s("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>_.value.spotPrice=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.spotPrice,void 0,{number:!0}]])]),s("div",Gde,[t[63]||(t[63]=s("label",null,"Номинал",-1)),T(s("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>_.value.faceValue=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.faceValue,void 0,{number:!0}]])]),s("div",Wde,[t[64]||(t[64]=s("label",null,"Купонная ставка (%)",-1)),T(s("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>_.value.couponRate=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.couponRate,void 0,{number:!0}]])]),s("div",qde,[t[66]||(t[66]=s("label",null,"Частота купонов (раз/год)",-1)),T(s("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>_.value.couponFrequency=e),class:"param-input",onChange:V},[...t[65]||(t[65]=[s("option",{value:1},"1 (ежегодно)",-1),s("option",{value:2},"2 (раз в полгода)",-1),s("option",{value:4},"4 (ежеквартально)",-1),s("option",{value:12},"12 (ежемесячно)",-1)])],544),[[D,_.value.couponFrequency,void 0,{number:!0}]])]),s("div",Yde,[t[67]||(t[67]=s("label",null,"Накопленный купонный доход (НКД)",-1)),T(s("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>_.value.accruedInterest=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.accruedInterest,void 0,{number:!0}]])]),s("div",jde,[t[68]||(t[68]=s("label",null,"Дата последнего купона",-1)),T(s("input",{"onUpdate:modelValue":t[18]||(t[18]=e=>_.value.lastCouponDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.lastCouponDate]])]),s("div",Xde,[t[69]||(t[69]=s("label",null,"Дата погашения",-1)),T(s("input",{"onUpdate:modelValue":t[19]||(t[19]=e=>_.value.maturityDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.maturityDate]])]),s("div",$de,[t[71]||(t[71]=s("label",null,"Конвенция подсчета дней",-1)),T(s("select",{"onUpdate:modelValue":t[20]||(t[20]=e=>_.value.dayCountConvention=e),class:"param-input",onChange:V},[...t[70]||(t[70]=[s("option",{value:"ACT/ACT"},"ACT/ACT (ISDA)",-1),s("option",{value:"ACT/365"},"ACT/365",-1),s("option",{value:"ACT/360"},"ACT/360",-1),s("option",{value:"30/360"},"30/360",-1)])],544),[[D,_.value.dayCountConvention]])]),s("div",Kde,[s("label",null,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[21]||(t[21]=e=>_.value.autoCalculateAI=e),onChange:V},null,544),[[L,_.value.autoCalculateAI]]),t[72]||(t[72]=m(" Автоматически рассчитывать НКД ",-1))])])])]),s("div",Zde,[t[81]||(t[81]=s("div",{class:"card-header"},[s("h3",null,"Параметры форварда")],-1)),s("div",Jde,[s("div",Qde,[t[74]||(t[74]=s("label",null,"Дата оценки",-1)),T(s("input",{"onUpdate:modelValue":t[22]||(t[22]=e=>_.value.bondValuationDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.bondValuationDate]])]),s("div",ehe,[t[75]||(t[75]=s("label",null,"Дата экспирации",-1)),T(s("input",{"onUpdate:modelValue":t[23]||(t[23]=e=>_.value.bondExpirationDate=e),type:"date",class:"param-input",onChange:V},null,544),[[k,_.value.bondExpirationDate]])]),s("div",the,[t[76]||(t[76]=s("label",null,"Время до экспирации (лет)",-1)),T(s("input",{"onUpdate:modelValue":t[24]||(t[24]=e=>_.value.timeToMaturity=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.timeToMaturity,void 0,{number:!0}]])]),s("div",ahe,[t[77]||(t[77]=s("label",null,"Репо ставка (%)",-1)),T(s("input",{"onUpdate:modelValue":t[25]||(t[25]=e=>_.value.repoRate=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.repoRate,void 0,{number:!0}]])]),s("div",nhe,[t[78]||(t[78]=s("label",null,"Безрисковая ставка (%)",-1)),T(s("input",{"onUpdate:modelValue":t[26]||(t[26]=e=>_.value.riskFreeRate=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.riskFreeRate,void 0,{number:!0}]])]),s("div",rhe,[t[79]||(t[79]=s("label",null,"Рыночная цена форварда (clean, %)",-1)),T(s("input",{"onUpdate:modelValue":t[27]||(t[27]=e=>_.value.marketForwardPrice=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.marketForwardPrice,void 0,{number:!0}]])]),s("div",ihe,[t[80]||(t[80]=s("label",null,"Размер контракта (шт.)",-1)),T(s("input",{"onUpdate:modelValue":t[28]||(t[28]=e=>_.value.contractSize=e),type:"number",class:"param-input",step:"1",onChange:V},null,544),[[k,_.value.contractSize,void 0,{number:!0}]])])])]),s("div",ohe,[t[84]||(t[84]=s("div",{class:"card-header"},[s("h3",null,"Кривая доходности"),s("span",{class:"card-subtitle"},"Используйте кривую доходности или плоскую ставку (репо)")],-1)),s("div",she,[s("div",lhe,[s("label",null,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=e=>_.value.useYieldCurve=e),onChange:V},null,544),[[L,_.value.useYieldCurve]]),t[82]||(t[82]=m(" Использовать кривую доходности ",-1))])]),_.value.useYieldCurve?(w(),i("div",che,[(w(!0),i(p,null,f(_.value.yieldCurvePoints,(e,a)=>(w(),i("div",{class:"param-row",key:a},[s("label",null,v(e.tenor)+" мес.",1),T(s("input",{"onUpdate:modelValue":t=>e.rate=t,type:"number",class:"param-input",step:"0.01",onChange:V},null,40,uhe),[[k,e.rate,void 0,{number:!0}]]),t[83]||(t[83]=s("span",{style:{color:"rgba(255,255,255,0.5)","margin-left":"8px"}},"%",-1))]))),128))])):l("",!0)])])],64)):"fx"!==r.value?(w(),i(p,{key:2},[s("div",dhe,[t[89]||(t[89]=s("div",{class:"card-header"},[s("h3",null,"Параметры базового актива")],-1)),s("div",hhe,[s("div",phe,[t[85]||(t[85]=s("label",null,"Спот цена (S₀)",-1)),T(s("input",{"onUpdate:modelValue":t[30]||(t[30]=e=>_.value.spotPrice=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.spotPrice,void 0,{number:!0}]])]),"equity"===r.value?(w(),i("div",fhe,[t[86]||(t[86]=s("label",null,"Дивиденды (%)",-1)),T(s("input",{"onUpdate:modelValue":t[31]||(t[31]=e=>_.value.dividendYield=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.dividendYield,void 0,{number:!0}]])])):l("",!0),"commodity"===r.value?(w(),i("div",mhe,[t[87]||(t[87]=s("label",null,"Стоимость хранения (%)",-1)),T(s("input",{"onUpdate:modelValue":t[32]||(t[32]=e=>_.value.carryingCost=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.carryingCost,void 0,{number:!0}]])])):l("",!0),"commodity"===r.value?(w(),i("div",vhe,[t[88]||(t[88]=s("label",null,"Удобство владения (Convenience Yield, %)",-1)),T(s("input",{"onUpdate:modelValue":t[33]||(t[33]=e=>_.value.convenienceYield=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.convenienceYield,void 0,{number:!0}]])])):l("",!0)])]),s("div",ghe,[t[93]||(t[93]=s("div",{class:"card-header"},[s("h3",null,"Параметры форварда")],-1)),s("div",yhe,[s("div",bhe,[t[90]||(t[90]=s("label",null,"Время до экспирации (лет)",-1)),T(s("input",{"onUpdate:modelValue":t[34]||(t[34]=e=>_.value.timeToMaturity=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.timeToMaturity,void 0,{number:!0}]])]),s("div",xhe,[t[91]||(t[91]=s("label",null,"Безрисковая ставка (%)",-1)),T(s("input",{"onUpdate:modelValue":t[35]||(t[35]=e=>_.value.riskFreeRate=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.riskFreeRate,void 0,{number:!0}]])]),s("div",whe,[t[92]||(t[92]=s("label",null,"Рыночная цена форварда",-1)),T(s("input",{"onUpdate:modelValue":t[36]||(t[36]=e=>_.value.marketForwardPrice=e),type:"number",class:"param-input",step:"0.01",onChange:V},null,544),[[k,_.value.marketForwardPrice,void 0,{number:!0}]])])])])],64)):l("",!0)]),s("div",_he,[s("div",She,[t[95]||(t[95]=s("div",{class:"metric-header"},[s("h3",null,"Справедливая стоимость форвардного контракта"),s("span",{class:"metric-unit"},"Справедливая цена")],-1)),s("div",Mhe,v(F(M.value.fairForwardPrice)),1),s("div",The,[t[94]||(t[94]=s("span",{class:"detail-label"},"Модель:",-1)),s("span",khe,v("fx"===r.value?"Валютный форвард":"Cost-of-Carry"),1)])]),s("div",Che,[t[96]||(t[96]=s("div",{class:"metric-header"},[s("h3",null,"Рыночная цена форвардного контракта"),s("span",{class:"metric-unit"},"Рыночная цена")],-1)),s("div",Ahe,v(F(_.value.marketForwardPrice)),1),t[97]||(t[97]=s("div",{class:"metric-detail"},[s("span",{class:"detail-label"},"Источник:"),s("span",{class:"detail-value"},"Рыночные данные")],-1))]),s("div",Ehe,[t[99]||(t[99]=s("div",{class:"metric-header"},[s("h3",null,"Стоимость форвардного контракта"),s("span",{class:"metric-unit"},"По единице")],-1)),s("div",{class:c(["metric-value",M.value.forwardValue>=0?"positive":"negative"])},v(F(M.value.forwardValue)),3),s("div",Ihe,[t[98]||(t[98]=s("span",{class:"detail-label"},"За контракт:",-1)),"fx"===r.value?(w(),i("span",Rhe,v(B(M.value.forwardValue)),1)):(w(),i("span",Dhe,v(B(M.value.forwardValue*_.value.contractSize)),1))])])]),"fx"===r.value&&M.value.currencyPair?(w(),i("div",Phe,[t[106]||(t[106]=s("div",{class:"card-header"},[s("h3",null,"Детали валютного форварда")],-1)),s("div",Lhe,[s("div",Nhe,[t[100]||(t[100]=s("div",{class:"metric-header"},[s("h3",null,"Валютная пара")],-1)),s("div",Ohe,v(M.value.currencyPair),1)]),s("div",Fhe,[t[101]||(t[101]=s("div",{class:"metric-header"},[s("h3",null,"Форвардный курс (мин)")],-1)),s("div",Bhe,v(M.value.forwardRateMin?.toFixed(3)||"N/A"),1)]),s("div",Uhe,[t[102]||(t[102]=s("div",{class:"metric-header"},[s("h3",null,"Форвардный курс (макс)")],-1)),s("div",zhe,v(M.value.forwardRateMax?.toFixed(3)||"N/A"),1)])]),s("div",Vhe,[s("div",Hhe,[t[103]||(t[103]=s("div",{class:"card-header"},[s("h3",null,"Дисконт-факторы")],-1)),s("div",Ghe,[s("div",Whe,[s("label",null,"Внутренняя валюта ("+v(_.value.fxBuyCurrency)+")",1),s("span",qhe,v(M.value.discountFactorInternal?.toFixed(3)||"N/A"),1)]),s("div",Yhe,[s("label",null,"Внешняя валюта ("+v(_.value.fxSellCurrency)+")",1),s("span",jhe,v(M.value.discountFactorExternal?.toFixed(3)||"N/A"),1)])])]),s("div",Xhe,[t[105]||(t[105]=s("div",{class:"card-header"},[s("h3",null,"Справедливая стоимость")],-1)),s("div",$he,[s("div",Khe,[s("label",null,"Минимальная (тыс. "+v(_.value.settlementCurrency||"RUB")+")",1),s("span",Zhe,v(M.value.fairValueMin?.toFixed(3)||"N/A"),1)]),s("div",Jhe,[s("label",null,"Максимальная (тыс. "+v(_.value.settlementCurrency||"RUB")+")",1),s("span",Qhe,v(M.value.fairValueMax?.toFixed(3)||"N/A"),1)]),void 0!==M.value.forwardDiff?(w(),i("div",epe,[t[104]||(t[104]=s("label",null,"Расхождение с курсом сделки",-1)),s("span",{class:c(["param-value","string"==typeof M.value.forwardDiff?"":M.value.forwardDiff>=0?"positive":"negative"])},v("string"==typeof M.value.forwardDiff?M.value.forwardDiff:M.value.forwardDiff.toFixed(3)),3)])):l("",!0)])])])])):l("",!0),"fx"!==r.value?(w(),i("div",tpe,[t[114]||(t[114]=s("div",{class:"card-header"},[s("h3",null,"Модель Cost-of-Carry")],-1)),s("div",ape,[s("div",npe,[t[107]||(t[107]=s("span",{class:"carry-label"},"Спот цена актива (S₀)",-1)),s("span",rpe,v(F(_.value.spotPrice)),1)]),s("div",ipe,[t[108]||(t[108]=s("span",{class:"carry-label"},"+ Безрисковая ставка (r)",-1)),s("span",ope,v(_.value.riskFreeRate.toFixed(3))+"%",1)]),s("div",spe,[t[109]||(t[109]=s("span",{class:"carry-label"},"+ Стоимость хранения (c)",-1)),s("span",lpe,v(_.value.carryingCost.toFixed(3))+"%",1)]),s("div",cpe,[t[110]||(t[110]=s("span",{class:"carry-label"},"- Дивиденды/Купоны (d)",-1)),s("span",upe,v(_.value.dividendYield.toFixed(3))+"%",1)]),s("div",dpe,[t[111]||(t[111]=s("span",{class:"carry-label"},"- Удобство владения (y)",-1)),s("span",hpe,v(_.value.convenienceYield.toFixed(3))+"%",1)]),s("div",ppe,[t[112]||(t[112]=s("span",{class:"carry-label"},"= Чистый Carry",-1)),s("span",fpe,v((_.value.riskFreeRate+_.value.carryingCost-_.value.dividendYield-_.value.convenienceYield).toFixed(3))+"% ",1)]),s("div",mpe,[t[113]||(t[113]=s("span",{class:"carry-label"},"= Справедливая стоимость форварда F",-1)),s("span",{class:c(["carry-value",M.value.fairForwardPrice>=_.value.spotPrice?"positive":"negative"])},v(F(M.value.fairForwardPrice)),3)])])])):l("",!0),"fx"!==r.value?(w(),i("div",vpe,[s("div",gpe,[t[118]||(t[118]=s("div",{class:"card-header"},[s("h3",null,"Внутренняя стоимость"),s("span",{class:"card-subtitle"},"Текущая стоимость позиции")],-1)),s("div",ype,[s("div",bpe,[t[115]||(t[115]=s("span",{class:"label"},"Спот цена",-1)),s("span",xpe,v(F(_.value.spotPrice)),1)]),s("div",wpe,[t[116]||(t[116]=s("span",{class:"label"},"Цена исполнения",-1)),s("span",_pe,v(F(_.value.marketForwardPrice)),1)]),s("div",Spe,[t[117]||(t[117]=s("span",{class:"label"},"Внутренняя стоимость",-1)),s("span",{class:c(["value",M.value.intrinsicValue>=0?"positive":"negative"])},v(M.value.intrinsicValue>=0?"+":"")+v(F(M.value.intrinsicValue)),3)])])]),s("div",Mpe,[t[122]||(t[122]=s("div",{class:"card-header"},[s("h3",null,"Временная стоимость"),s("span",{class:"card-subtitle"},"Временная стоимость")],-1)),s("div",Tpe,[s("div",kpe,[t[119]||(t[119]=s("span",{class:"label"},"Справедливая форвардная цена",-1)),s("span",Cpe,v(F(M.value.fairForwardPrice)),1)]),s("div",Ape,[t[120]||(t[120]=s("span",{class:"label"},"Цена исполнения",-1)),s("span",Epe,v(F(_.value.marketForwardPrice)),1)]),s("div",Ipe,[t[121]||(t[121]=s("span",{class:"label"},"Временная стоимость",-1)),s("span",{class:c(["value",M.value.timeValue>=0?"positive":"negative"])},v(M.value.timeValue>=0?"+":"")+v(F(M.value.timeValue)),3)])])]),s("div",Rpe,[t[126]||(t[126]=s("div",{class:"card-header"},[s("h3",null,"Общая стоимость форварда"),s("span",{class:"card-subtitle"},"Справедливая стоимость позиции")],-1)),s("div",Dpe,[s("div",Ppe,[t[123]||(t[123]=s("span",{class:"label"},"Внутренняя стоимость",-1)),s("span",{class:c(["value",M.value.intrinsicValue>=0?"positive":"negative"])},v(M.value.intrinsicValue>=0?"+":"")+v(F(M.value.intrinsicValue)),3)]),s("div",Lpe,[t[124]||(t[124]=s("span",{class:"label"},"Временная стоимость",-1)),s("span",{class:c(["value",M.value.timeValue>=0?"positive":"negative"])},v(M.value.timeValue>=0?"+":"")+v(F(M.value.timeValue)),3)]),s("div",Npe,[t[125]||(t[125]=s("span",{class:"label"},"Общая стоимость",-1)),s("span",Ope,v(M.value.totalValue>=0?"+":"")+v(F(M.value.totalValue)),1)])])])])):l("",!0),"bond"===r.value&&M.value.couponSchedule?(w(),i(p,{key:5},[s("div",Fpe,[t[129]||(t[129]=s("div",{class:"card-header"},[s("h3",null,"Расписание купонных платежей"),s("span",{class:"card-subtitle"},"Купоны между датой оценки и экспирацией")],-1)),s("div",Bpe,[s("table",Upe,[t[128]||(t[128]=s("thead",null,[s("tr",null,[s("th",null,"№"),s("th",null,"Дата купона"),s("th",null,"Дней до платежа"),s("th",null,"Лет до платежа"),s("th",null,"Сумма купона"),s("th",null,"Ставка дисконтирования (%)"),s("th",null,"Дисконт-фактор"),s("th",null,"Приведенная стоимость")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(M.value.couponSchedule,e=>(w(),i("tr",{key:e.couponNumber},[s("td",null,v(e.couponNumber),1),s("td",null,v(U(e.couponDate)),1),s("td",zpe,v(e.daysToPayment),1),s("td",Vpe,v(e.yearsToPayment.toFixed(4)),1),s("td",Hpe,v(F(e.couponAmount)),1),s("td",Gpe,v(e.discountRate.toFixed(3))+"%",1),s("td",Wpe,v(e.discountFactor.toFixed(6)),1),s("td",qpe,v(F(e.presentValue)),1)]))),128)),s("tr",Ype,[t[127]||(t[127]=s("td",{colspan:"7",style:{"text-align":"right","font-weight":"600"}},"Итого PV купонов:",-1)),s("td",jpe,v(F(M.value.pvCoupons||0)),1)])])])])]),M.value.formulaBreakdown?(w(),i("div",Xpe,[t[140]||(t[140]=s("div",{class:"card-header"},[s("h3",null,"Детальный разбор формулы"),s("span",{class:"card-subtitle"},"F = [(S₀ + AI₀) × (1 + r_repo × T) - Σ(Cᵢ × DFᵢ)] / DF(T) - AI_T")],-1)),s("div",$pe,[s("div",Kpe,[t[130]||(t[130]=s("label",null,"Спот цена (clean, S₀)",-1)),s("span",Zpe,v(F(M.value.formulaBreakdown.spotCleanPrice)),1)]),s("div",Jpe,[t[131]||(t[131]=s("label",null,"НКД на дату оценки (AI₀)",-1)),s("span",Qpe,v(F(M.value.formulaBreakdown.accruedInterestSpot)),1)]),s("div",efe,[t[132]||(t[132]=s("label",null,"Спот цена (dirty, S₀ + AI₀)",-1)),s("span",tfe,v(F(M.value.formulaBreakdown.spotDirtyPrice)),1)]),s("div",afe,[t[133]||(t[133]=s("label",null,"Репо ставка (r_repo)",-1)),s("span",nfe,v(M.value.formulaBreakdown.repoRate.toFixed(3))+"%",1)]),s("div",rfe,[t[134]||(t[134]=s("label",null,"Время до экспирации (T)",-1)),s("span",ife,v(M.value.formulaBreakdown.timeToMaturity.toFixed(4))+" лет",1)]),s("div",ofe,[t[135]||(t[135]=s("label",null,"Стоимость финансирования (S × r × T)",-1)),s("span",sfe,v(F(M.value.formulaBreakdown.financingCost)),1)]),s("div",lfe,[t[136]||(t[136]=s("label",null,"PV купонов (Σ(Cᵢ × DFᵢ))",-1)),s("span",cfe,"-"+v(F(M.value.formulaBreakdown.totalCouponsPV)),1)]),s("div",ufe,[t[137]||(t[137]=s("label",null,"Форвард цена (dirty, до вычета НКД)",-1)),s("span",dfe,v(F(M.value.formulaBreakdown.forwardDirtyPriceBeforeAI)),1)]),s("div",hfe,[t[138]||(t[138]=s("label",null,"НКД на дату экспирации (AI_T)",-1)),s("span",pfe,"-"+v(F(M.value.formulaBreakdown.accruedInterestForward)),1)]),s("div",ffe,[t[139]||(t[139]=s("label",null,"Справедливая форвардная цена (clean, F)",-1)),s("span",mfe,v(F(M.value.formulaBreakdown.forwardCleanPrice)),1)])])])):l("",!0),void 0!==M.value.dv01?(w(),i("div",vfe,[s("div",gfe,[t[142]||(t[142]=s("div",{class:"card-header"},[s("h3",null,"DV01"),s("span",{class:"card-subtitle"},"Изменение цены на 1 bp")],-1)),s("div",yfe,v(M.value.dv01.toFixed(6)),1),s("div",bfe,[t[141]||(t[141]=s("span",{class:"detail-label"},"На контракт:",-1)),s("span",xfe,v(B(M.value.dv01*_.value.contractSize*_.value.faceValue/100)),1)])]),s("div",wfe,[t[144]||(t[144]=s("div",{class:"card-header"},[s("h3",null,"Convexity"),s("span",{class:"card-subtitle"},"Вторая производная")],-1)),s("div",_fe,v(M.value.convexity?.toFixed(2)||"N/A"),1),s("div",Sfe,[t[143]||(t[143]=s("span",{class:"detail-label"},"Нелинейность:",-1)),s("span",Mfe,v((M.value.convexity||0)>0?"Положительная":"Отрицательная"),1)])]),s("div",Tfe,[t[146]||(t[146]=s("div",{class:"card-header"},[s("h3",null,"Repo Sensitivity"),s("span",{class:"card-subtitle"},"Чувствительность к репо (1 bp)")],-1)),s("div",{class:c(["metric-value",(M.value.repoSensitivity||0)>=0?"positive":"negative"])},v(M.value.repoSensitivity?.toFixed(6)||"N/A"),3),s("div",kfe,[t[145]||(t[145]=s("span",{class:"detail-label"},"На контракт:",-1)),s("span",Cfe,v(B((M.value.repoSensitivity||0)*_.value.contractSize*_.value.faceValue/100)),1)])])])):l("",!0)],64)):l("",!0),s("div",Afe,[s("div",Efe,[s("div",Ife,[s("h3",null,v("fx"===r.value?"Профиль форвардного курса":"Профиль форвардной цены"),1),s("span",Rfe,v("fx"===r.value?"Зависимость форвардного курса от спот курса":"F(S) зависимость от спот цены"),1)]),s("div",Dfe,[s("canvas",{ref_key:"priceProfileRef",ref:A},null,512)])]),s("div",Pfe,[s("div",Lfe,[s("h3",null,v("fx"===r.value?"NPV контракта vs Время":"Стоимость форварда vs Время"),1),s("span",Nfe,v("fx"===r.value?"Эволюция NPV по времени до экспирации":"Эволюция стоимости по времени"),1)]),s("div",Ofe,[s("canvas",{ref_key:"valueVsTimeRef",ref:P},null,512)])])]),s("div",Ffe,[t[148]||(t[148]=s("div",{class:"card-header"},[s("h3",null,"Анализ сценариев"),s("span",{class:"card-subtitle"},"Стоимость форварда при различных движениях спота")],-1)),s("div",Bfe,[s("table",Ufe,[t[147]||(t[147]=s("thead",null,[s("tr",null,[s("th",null,"Сценарий"),s("th",null,"Спот цена"),s("th",null,"% Изменение"),s("th",null,"Стоимость форварда"),s("th",null,"P&L (Лонг)"),s("th",null,"P&L (Шорт)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(C.value,e=>(w(),i("tr",{key:e.id,class:c(e.isBase?"base":"")},[s("td",zfe,v(e.name),1),s("td",Vfe,v(F(e.spotPrice)),1),s("td",{class:c(["change mono",e.change>=0?"positive":"negative"])},v(e.change>=0?"+":"")+v(e.change.toFixed(1))+"% ",3),s("td",{class:c(["forward-value mono",e.forwardValue>=0?"positive":"negative"])},v(e.forwardValue>=0?"+":"")+v(F(e.forwardValue)),3),s("td",{class:c(["pnl mono",e.pnlLong>=0?"positive":"negative"])},v(e.pnlLong>=0?"+":"")+v(B(e.pnlLong)),3),s("td",{class:c(["pnl mono",e.pnlShort>=0?"positive":"negative"])},v(e.pnlShort>=0?"+":"")+v(B(e.pnlShort)),3)],2))),128))])])])]),"fx"!==r.value?(w(),i("div",Hfe,[s("div",Gfe,[t[152]||(t[152]=s("div",{class:"chart-header"},[s("h3",null,"Delta (∂F/∂S)"),s("span",{class:"chart-subtitle"},"Чувствительность к спот цене")],-1)),s("div",Wfe,[s("div",qfe,[t[149]||(t[149]=s("span",{class:"label"},"Дельта (Delta)",-1)),s("span",Yfe,v(M.value.delta.toFixed(3)),1)]),s("div",jfe,[t[150]||(t[150]=s("span",{class:"label"},"P&L на 1% спота",-1)),s("span",Xfe,v(B(_.value.spotPrice*_.value.contractSize*.01*M.value.delta)),1)]),s("div",$fe,[t[151]||(t[151]=s("span",{class:"label"},"Цена безубыточности",-1)),s("span",Kfe,v(F(_.value.marketForwardPrice)),1)])])]),s("div",Zfe,[t[156]||(t[156]=s("div",{class:"chart-header"},[s("h3",null,"Rho (∂F/∂r)"),s("span",{class:"chart-subtitle"},"Чувствительность к ставкам")],-1)),s("div",Jfe,[s("div",Qfe,[t[153]||(t[153]=s("span",{class:"label"},"Rho (Rho)",-1)),s("span",eme,v(M.value.rho.toFixed(3)),1)]),s("div",tme,[t[154]||(t[154]=s("span",{class:"label"},"P&L на 1% ставки",-1)),s("span",ame,v(B(M.value.rho*_.value.contractSize*.01)),1)]),s("div",nme,[t[155]||(t[155]=s("span",{class:"label"},"Текущая ставка",-1)),s("span",rme,v(_.value.riskFreeRate.toFixed(3))+"%",1)])])])])):l("",!0),s("div",ime,["fx"===r.value?(w(),i("span",ome,"• Модель: Валютный форвард (дисконт-факторы)")):"bond"===r.value?(w(),i("span",sme,"• Модель: Форвард на облигацию (репо ставка)")):(w(),i("span",lme,"• Модель: Cost-of-Carry (без арбитража)")),s("span",null,"• Метод: "+v("fx"===r.value?"Дисконтирование денежных потоков":"bond"===r.value?"Репо финансирование":"Непрерывное начисление"),1),t[157]||(t[157]=s("span",null,"• Обновление: В реальном времени",-1))])]))}}),ume=xe(cme,[["__scopeId","data-v-b51d3d57"]]),dme={class:"forward-curve-page"},hme={class:"page-header"},pme={class:"header-right"},fme={class:"control-group"},mme={class:"control-group"},vme={class:"card full-width"},gme={class:"market-data-container"},yme={class:"data-table-wrapper"},bme={class:"market-data-table"},xme={class:"col-tenor"},wme={class:"col-price"},_me=["onUpdate:modelValue"],Sme={class:"col-yield"},Mme=["onUpdate:modelValue"],Tme={class:"col-forward mono"},kme={class:"col-action"},Cme=["onClick"],Ame={class:"grid-2"},Eme={class:"card"},Ime={class:"chart-container"},Rme={class:"card"},Dme={class:"chart-container"},Pme={class:"grid-3"},Lme={class:"metric-card"},Nme={class:"metric-detail"},Ome={class:"detail-value"},Fme={class:"metric-card"},Bme={class:"metric-value accent"},Ume={class:"metric-detail"},zme={class:"detail-value"},Vme={class:"metric-card"},Hme={class:"metric-value blue"},Gme={class:"metric-detail"},Wme={class:"detail-value"},qme={class:"card full-width"},Yme={class:"forward-rates-table-container"},jme={class:"forward-rates-table"},Xme={class:"period-name"},$me={class:"rate-value mono"},Kme={class:"rate-value mono"},Zme={class:"rate-value cyan mono"},Jme={class:"rate-value blue mono"},Qme={class:"grid-2"},eve={class:"card"},tve={class:"interpolation-options"},ave=["id","value"],nve=["for"],rve={class:"method-name"},ive={class:"method-desc"},ove={class:"card"},sve={class:"parameters-list"},lve={class:"param-item"},cve={class:"param-item"},uve={class:"param-item"},dve={class:"param-item"},hve={class:"grid-2"},pve={class:"card"},fve={class:"butterfly-metrics"},mve={class:"butterfly-item"},vve={class:"value accent"},gve={class:"butterfly-item"},yve={class:"value accent"},bve={class:"butterfly-item"},xve={class:"value blue"},wve={class:"butterfly-item"},_ve={class:"card full-width"},Sve={class:"fitting-stats"},Mve={class:"stat-item"},Tve={class:"stat-value"},kve={class:"quality-bar"},Cve={class:"stat-item"},Ave={class:"stat-value"},Eve={class:"stat-item"},Ive={class:"stat-value"},Rve={class:"stat-item"},Dve={class:"stat-value"},Pve={class:"card full-width"},Lve={class:"chart-container tall"},Nve={class:"card full-width"},Ove={class:"detailed-stats-container"},Fve={class:"detailed-stats-table"},Bve={class:"tenor"},Uve={class:"rate mono"},zve={class:"rate mono"},Vve={class:"rate mono"},Hve={class:"rate mono"},Gve={class:"rate mono"},Wve={class:"rate mono"},qve={class:"page-footer"},Yve=e({__name:"ForwardCurveBuilder",setup(e){const a=t("bonds"),r=t("forward"),o=t("cubic-spline"),l=t([{tenor:"3M",price:98.5,yield:4.2,forwardRate:4.25},{tenor:"6M",price:97.8,yield:4.35,forwardRate:4.45},{tenor:"1Y",price:96.2,yield:4.4,forwardRate:4.5},{tenor:"2Y",price:93.5,yield:4.5,forwardRate:4.6},{tenor:"3Y",price:90.2,yield:4.55,forwardRate:4.65},{tenor:"5Y",price:84.5,yield:4.65,forwardRate:4.75},{tenor:"10Y",price:72.3,yield:4.75,forwardRate:4.85}]),u=t({baseRate:4.2,longTermRate:4.8,volatility:12.5,meanReversionSpeed:.15}),d=t([{id:"linear",name:"Linear Interpolation",description:"Простая линейная интерполяция"},{id:"cubic-spline",name:"Cubic Spline",description:"Кубические сплайны (гладкая кривая)"},{id:"nelson-siegel",name:"Nelson-Siegel",description:"Параметрическая модель"},{id:"vasicek",name:"Vasicek Model",description:"Стохастическая модель"}]),h=S(()=>{const e=l.value.map(e=>e.forwardRate),t=Math.min(...e),a=Math.max(...e),n=e.reduce((e,t)=>e+t)/e.length,r=(e[e.length-1]-e[0])/(e.length-1),i=l.value.find(e=>"2Y"===e.tenor)?.forwardRate||0,o=100*((l.value.find(e=>"10Y"===e.tenor)?.forwardRate||0)-i);let s=0;for(let l=1;l<e.length-1;l++)s+=e[l+1]-2*e[l]+e[l-1];return s/=e.length-2,{slope:r,avgForwardRate:n,minRate:t,maxRate:a,spread2y10y:o,convexity:s}}),m=S(()=>{const e=[];for(let t=0;t<l.value.length-1;t++){const a=l.value[t],n=l.value[t+1],r=a.yield,i=(a.yield+n.yield)/2,o=n.yield+.5*(n.yield-a.yield),s=n.yield,c=100*(s-o);e.push({period:`${a.tenor} - ${n.tenor}`,spotRate:r,zcYield:i,forwardRate:o,impliedRate:s,spread:c,outlier:Math.abs(c)>5})}return e}),g=S(()=>{const e=l.value.find(e=>"2Y"===e.tenor)?.forwardRate||0,t=l.value.find(e=>"5Y"===e.tenor)?.forwardRate||0,a=l.value.find(e=>"10Y"===e.tenor)?.forwardRate||0;return{fly25:(e+t)/2-e,fly510:(t+a)/2-t,butterfly:t-(e+a)/2,convexity:100*(e-2*t+a)}}),b=t({rSquared:.9876,rmse:.0032,mae:.0024,maxError:.0085}),x=S(()=>l.value.map((e,t)=>{const a=e.yield/100,n=t,r=Math.exp(-a*n),i=n*r,o=n*n*r;return{tenor:e.tenor,spotRate:e.yield,forwardRate:e.forwardRate,yieldCurve:(e.yield+e.forwardRate)/2,discountFactor:r,duration:i,convexity:o}})),_=t(null),M=t(null),C=t(null);let A=null,E=null,R=null;const P=()=>{const e=h.value.slope;return e>.5?"Крутая":e>.1?"Умеренно крутая":e>-.1?"Плоская":"Инвертированная"},L=()=>{l.value.push({tenor:1.5*l.value.length+"M",price:95,yield:4.5,forwardRate:4.55}),N()},N=()=>{F()},O=()=>{const e=[["Forward Curve Export",(new Date).toISOString()],[""],["Tenor","Spot Rate","Forward Rate","Yield"],...l.value.map(e=>[e.tenor,e.price,e.forwardRate,e.yield])].map(e=>e.join(",")).join("\n"),t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=`forward-curve-${(new Date).toISOString()}.csv`,n.click()},F=()=>{A&&A.destroy(),E&&E.destroy(),R&&R.destroy();const e=l.value.map(e=>e.tenor),t=l.value.map(e=>e.forwardRate),a=l.value.map(e=>e.yield);if(_.value?.getContext("2d")&&(A=new re(_.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Forward Curve",data:t,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:5,pointBackgroundColor:"#60a5fa",pointBorderColor:"#fff",borderWidth:2},{label:"Spot Curve",data:a,borderColor:"#38bdf8",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:4,borderDash:[5,5],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),M.value?.getContext("2d")){const n=t.map((e,t)=>100*(e-a[t]));E=new re(M.value.getContext("2d"),{type:"bar",data:{labels:e,datasets:[{label:"Forward - Spot (bp)",data:n,backgroundColor:n.map(e=>e>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)"),borderColor:n.map(e=>e>=0?"#4ade80":"#f87171"),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(C.value?.getContext("2d")){const a=t.map(e=>e+1),n=t.map((e,t)=>e+.15*t),r=t.map((e,t)=>e-.08*t);R=new re(C.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Current Curve",data:t,borderColor:"#60a5fa",backgroundColor:"transparent",tension:.4,pointRadius:3,borderWidth:2},{label:"Bulk +100bp",data:a,borderColor:"#4ade80",backgroundColor:"transparent",tension:.4,pointRadius:0,borderDash:[5,5],borderWidth:1.5},{label:"Steepening",data:n,borderColor:"#f59e0b",backgroundColor:"transparent",tension:.4,pointRadius:0,borderDash:[5,5],borderWidth:1.5},{label:"Flattening",data:r,borderColor:"#f87171",backgroundColor:"transparent",tension:.4,pointRadius:0,borderDash:[5,5],borderWidth:1.5}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}};return n(()=>{F()}),z(()=>{A&&A.destroy(),E&&E.destroy(),R&&R.destroy()}),(e,t)=>(w(),i("div",dme,[s("div",hme,[t[11]||(t[11]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Построение форвардной кривой"),s("p",{class:"page-subtitle"},"Построение форвардной кривой и анализ структуры сроков")],-1)),s("div",pme,[s("div",fme,[t[8]||(t[8]=s("label",{class:"control-label"},"Инструмент:",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:"instrument-select",onChange:N},[...t[7]||(t[7]=[I('<option value="bonds" data-v-f1815dae>Кривая по форварду на облигацию</option><option value="fx" data-v-f1815dae>Валютная форвардная кривая</option><option value="rates" data-v-f1815dae>Кривая форварда на процентную ставку</option><option value="commodities" data-v-f1815dae>Форвардная кривая на товар</option><option value="equity" data-v-f1815dae>Кривая форварда на акцию</option>',5)])],544),[[D,a.value]])]),s("div",mme,[t[10]||(t[10]=s("label",{class:"control-label"},"Тип кривой:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),class:"curve-type-select",onChange:N},[...t[9]||(t[9]=[s("option",{value:"spot"},"Спот-кривая",-1),s("option",{value:"forward"},"Форвардная кривая",-1),s("option",{value:"implicit"},"Неявная форвардная кривая",-1)])],544),[[D,r.value]])]),s("button",{onClick:O,class:"btn-secondary"}," Экспортировать ")])]),s("div",vme,[t[13]||(t[13]=s("div",{class:"card-header"},[s("h3",null,"Рыночные данные для кривой"),s("span",{class:"card-subtitle"},"Введите спот и форвардные цены или ставки")],-1)),s("div",gme,[s("div",yme,[s("table",bme,[t[12]||(t[12]=s("thead",null,[s("tr",null,[s("th",{class:"col-tenor"},"Tenor"),s("th",{class:"col-price"},"Спот / Цена"),s("th",{class:"col-yield"},"Доходность (%)"),s("th",{class:"col-forward"},"Форвардная ставка")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(l.value,(e,t)=>(w(),i("tr",{key:t},[s("td",xme,v(e.tenor),1),s("td",wme,[T(s("input",{"onUpdate:modelValue":t=>e.price=t,type:"number",class:"input-small",step:"0.01",onChange:N},null,40,_me),[[k,e.price,void 0,{number:!0}]])]),s("td",Sme,[T(s("input",{"onUpdate:modelValue":t=>e.yield=t,type:"number",class:"input-small",step:"0.01",onChange:N},null,40,Mme),[[k,e.yield,void 0,{number:!0}]])]),s("td",Tme,v(e.forwardRate.toFixed(3))+"%",1),s("td",kme,[s("button",{onClick:e=>(e=>{l.value.splice(e,1),N()})(t),class:"btn-remove"},"×",8,Cme)])]))),128))])])]),s("button",{onClick:L,class:"btn-add-point"},"+ Добавить точку")])]),s("div",Ame,[s("div",Eme,[t[14]||(t[14]=s("div",{class:"chart-header"},[s("h3",null,"Форвардная кривая"),s("span",{class:"chart-subtitle"},"Структура сроков")],-1)),s("div",Ime,[s("canvas",{ref_key:"forwardCurveRef",ref:_},null,512)])]),s("div",Rme,[t[15]||(t[15]=s("div",{class:"chart-header"},[s("h3",null,"Форвардные ставки vs спот")],-1)),s("div",Dme,[s("canvas",{ref_key:"spreadChartRef",ref:M},null,512)])])]),s("div",Pme,[s("div",Lme,[t[17]||(t[17]=s("div",{class:"metric-header"},[s("h3",null,"Наклон кривой"),s("span",{class:"metric-unit"},"Наклон кривой")],-1)),s("div",{class:c(["metric-value",h.value.slope>=0?"positive":"negative"])},v(h.value.slope>=0?"+":"")+v(h.value.slope.toFixed(3))+"% ",3),s("div",Nme,[t[16]||(t[16]=s("span",{class:"detail-label"},"2Y-10Y спред:",-1)),s("span",Ome,v(h.value.spread2y10y.toFixed(2))+"bp",1)])]),s("div",Fme,[t[19]||(t[19]=s("div",{class:"metric-header"},[s("h3",null,"Средняя форвардная ставка"),s("span",{class:"metric-unit"},"Средняя ставка")],-1)),s("div",Bme,v(h.value.avgForwardRate.toFixed(3))+"% ",1),s("div",Ume,[t[18]||(t[18]=s("span",{class:"detail-label"},"Диапазон:",-1)),s("span",zme,v(h.value.minRate.toFixed(3))+"% - "+v(h.value.maxRate.toFixed(3))+"%",1)])]),s("div",Vme,[t[21]||(t[21]=s("div",{class:"metric-header"},[s("h3",null,"Выпуклость кривой"),s("span",{class:"metric-unit"},"Выпуклость")],-1)),s("div",Hme,v(h.value.convexity.toFixed(4)),1),s("div",Gme,[t[20]||(t[20]=s("span",{class:"detail-label"},"Форма:",-1)),s("span",Wme,v(P()),1)])])]),s("div",qme,[t[23]||(t[23]=s("div",{class:"card-header"},[s("h3",null,"Форвардные ставки по срокам"),s("span",{class:"card-subtitle"},"Расчётные форвардные ставки между периодами")],-1)),s("div",Yme,[s("table",jme,[t[22]||(t[22]=s("thead",null,[s("tr",null,[s("th",null,"Период"),s("th",null,"Спот ставка"),s("th",null,"Yield (ZC)"),s("th",null,"Forward Rate (t, t+1)"),s("th",null,"Подразумеваемая ставка"),s("th",null,"Спред (bp)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(m.value,(e,t)=>(w(),i("tr",{key:t,class:c(e.outlier?"outlier":"")},[s("td",Xme,v(e.period),1),s("td",$me,v(e.spotRate.toFixed(3))+"%",1),s("td",Kme,v(e.zcYield.toFixed(3))+"%",1),s("td",Zme,v(e.forwardRate.toFixed(3))+"%",1),s("td",Jme,v(e.impliedRate.toFixed(3))+"%",1),s("td",{class:c(["rate-value",e.spread>=0?"positive":"negative"])},v(e.spread>=0?"+":"")+v(e.spread.toFixed(1))+"bp ",3)],2))),128))])])])]),s("div",Qme,[s("div",eve,[t[24]||(t[24]=s("div",{class:"card-header"},[s("h3",null,"Методы интерполяции")],-1)),s("div",tve,[(w(!0),i(p,null,f(d.value,e=>(w(),i("div",{key:e.id,class:"option-item"},[T(s("input",{type:"radio",id:"method-"+e.id,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e),value:e.id,onChange:N,class:"radio-input"},null,40,ave),[[V,o.value]]),s("label",{for:"method-"+e.id,class:"option-label"},[s("span",rve,v(e.name),1),s("span",ive,v(e.description),1)],8,nve)]))),128))])]),s("div",ove,[t[29]||(t[29]=s("div",{class:"card-header"},[s("h3",null,"Параметры кривой")],-1)),s("div",sve,[s("div",lve,[t[25]||(t[25]=s("span",{class:"label"},"Базовая ставка",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>u.value.baseRate=e),type:"number",class:"param-input",step:"0.01",onChange:N},null,544),[[k,u.value.baseRate,void 0,{number:!0}]])]),s("div",cve,[t[26]||(t[26]=s("span",{class:"label"},"Долгосрочная ставка",-1)),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>u.value.longTermRate=e),type:"number",class:"param-input",step:"0.01",onChange:N},null,544),[[k,u.value.longTermRate,void 0,{number:!0}]])]),s("div",uve,[t[27]||(t[27]=s("span",{class:"label"},"Волатильность",-1)),T(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>u.value.volatility=e),type:"number",class:"param-input",step:"0.1",onChange:N},null,544),[[k,u.value.volatility,void 0,{number:!0}]])]),s("div",dve,[t[28]||(t[28]=s("span",{class:"label"},"Скорость возврата к среднему",-1)),T(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>u.value.meanReversionSpeed=e),type:"number",class:"param-input",step:"0.01",onChange:N},null,544),[[k,u.value.meanReversionSpeed,void 0,{number:!0}]])])])])]),s("div",hve,[t[35]||(t[35]=I('<div class="card" data-v-f1815dae><div class="chart-header" data-v-f1815dae><h3 data-v-f1815dae>PCA разложение</h3><span class="chart-subtitle" data-v-f1815dae>Анализ главных компонент</span></div><div class="pca-analysis" data-v-f1815dae><div class="pca-component" data-v-f1815dae><span class="component-label" data-v-f1815dae>Level (PC1)</span><div class="contribution-bar" data-v-f1815dae><div class="bar" style="width:78%;" data-v-f1815dae></div></div><span class="contribution-value" data-v-f1815dae>78%</span></div><div class="pca-component" data-v-f1815dae><span class="component-label" data-v-f1815dae>Slope (PC2)</span><div class="contribution-bar" data-v-f1815dae><div class="bar" style="width:18%;" data-v-f1815dae></div></div><span class="contribution-value" data-v-f1815dae>18%</span></div><div class="pca-component" data-v-f1815dae><span class="component-label" data-v-f1815dae>Curve (PC3)</span><div class="contribution-bar" data-v-f1815dae><div class="bar" style="width:4%;" data-v-f1815dae></div></div><span class="contribution-value" data-v-f1815dae>4%</span></div></div></div>',1)),s("div",pve,[t[34]||(t[34]=s("div",{class:"chart-header"},[s("h3",null,"Анализ Butterfly"),s("span",{class:"chart-subtitle"},"2Y-5Y-10Y структура")],-1)),s("div",fve,[s("div",mve,[t[30]||(t[30]=s("span",{class:"label"},"Fly (2Y-5Y)",-1)),s("span",vve,v(g.value.fly25.toFixed(1))+"bp",1)]),s("div",gve,[t[31]||(t[31]=s("span",{class:"label"},"Fly (5Y-10Y)",-1)),s("span",yve,v(g.value.fly510.toFixed(1))+"bp",1)]),s("div",bve,[t[32]||(t[32]=s("span",{class:"label"},"Steep (2Y-10Y)",-1)),s("span",xve,v(g.value.butterfly.toFixed(1))+"bp",1)]),s("div",wve,[t[33]||(t[33]=s("span",{class:"label"},"Кривизна",-1)),s("span",{class:c(["value",g.value.convexity>=0?"positive":"negative"])},v(g.value.convexity>=0?"+":"")+v(g.value.convexity.toFixed(1))+"bp ",3)])])])]),s("div",_ve,[t[40]||(t[40]=s("div",{class:"card-header"},[s("h3",null,"Качество подгонки кривой"),s("span",{class:"card-subtitle"},"Ошибки интерполяции и статистика")],-1)),s("div",Sve,[s("div",Mve,[t[36]||(t[36]=s("span",{class:"stat-label"},"R² (Goodness of Fit)",-1)),s("span",Tve,v((100*b.value.rSquared).toFixed(2))+"%",1),s("div",kve,[s("div",{class:"quality-fill",style:y({width:100*b.value.rSquared+"%"})},null,4)])]),s("div",Cve,[t[37]||(t[37]=s("span",{class:"stat-label"},"RMSE (Root Mean Sq Error)",-1)),s("span",Ave,v(b.value.rmse.toFixed(4)),1)]),s("div",Eve,[t[38]||(t[38]=s("span",{class:"stat-label"},"MAE (Mean Absolute Error)",-1)),s("span",Ive,v(b.value.mae.toFixed(4)),1)]),s("div",Rve,[t[39]||(t[39]=s("span",{class:"stat-label"},"Макс. ошибка",-1)),s("span",Dve,v(b.value.maxError.toFixed(4)),1)])])]),s("div",Pve,[t[41]||(t[41]=s("div",{class:"chart-header"},[s("h3",null,"Сценарии кривой"),s("span",{class:"chart-subtitle"},"Кривые форварда при различных сценариях")],-1)),s("div",Lve,[s("canvas",{ref_key:"scenarioCurvesRef",ref:C},null,512)])]),s("div",Nve,[t[43]||(t[43]=s("div",{class:"card-header"},[s("h3",null,"Детальная статистика по срокам")],-1)),s("div",Ove,[s("table",Fve,[t[42]||(t[42]=s("thead",null,[s("tr",null,[s("th",null,"Tenor"),s("th",null,"Spot Rate"),s("th",null,"Forward Rate"),s("th",null,"Yield Curve"),s("th",null,"Discount Factor"),s("th",null,"Duration"),s("th",null,"Convexity")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(x.value,(e,t)=>(w(),i("tr",{key:t},[s("td",Bve,v(e.tenor),1),s("td",Uve,v(e.spotRate.toFixed(4)),1),s("td",zve,v(e.forwardRate.toFixed(4)),1),s("td",Vve,v(e.yieldCurve.toFixed(4)),1),s("td",Hve,v(e.discountFactor.toFixed(6)),1),s("td",Gve,v(e.duration.toFixed(4)),1),s("td",Wve,v(e.convexity.toFixed(6)),1)]))),128))])])])]),s("div",qve,[s("span",null,"• Интерполяция: "+v(d.value.find(e=>e.id===o.value)?.name),1),t[44]||(t[44]=s("span",null,"• Данные: Рыночные данные в реальном времени",-1)),t[45]||(t[45]=s("span",null,"• Обновление: Каждую минуту",-1))])]))}}),jve=xe(Yve,[["__scopeId","data-v-f1815dae"]]),Xve={class:"greeks-dashboard-page"},$ve={class:"page-header"},Kve={class:"header-left"},Zve={class:"page-subtitle"},Jve={key:0,style:{"margin-left":"12px",color:"rgba(255,255,255,0.6)"}},Qve={key:0},ege={class:"header-right"},tge={class:"control-group"},age={class:"control-group"},nge=["disabled"],rge={key:0},ige={key:1},oge={class:"greeks-summary"},sge={class:"greek-card delta-card"},lge={class:"greek-value positive"},cge={class:"greek-details"},uge={class:"detail"},dge={class:"value"},hge={class:"detail"},pge={class:"greek-card vega-card"},fge={class:"greek-value blue"},mge={class:"greek-details"},vge={class:"detail"},gge={class:"value"},yge={class:"detail"},bge={class:"greek-card theta-card"},xge={class:"greek-details"},wge={class:"detail"},_ge={class:"value"},Sge={class:"detail"},Mge={class:"value"},Tge={class:"greek-card rho-card"},kge={class:"greek-value cyan"},Cge={class:"greek-details"},Age={class:"detail"},Ege={class:"value"},Ige={class:"detail"},Rge={class:"grid-2"},Dge={class:"card"},Pge={class:"chart-container"},Lge={class:"card"},Nge={class:"chart-container"},Oge={class:"grid-2"},Fge={class:"card"},Bge={class:"chart-container"},Uge={class:"card"},zge={class:"chart-container"},Vge={class:"grid-2"},Hge={class:"card"},Gge={class:"chart-container"},Wge={class:"card"},qge={class:"chart-container"},Yge={class:"card full-width"},jge={class:"greeks-table-container"},Xge={class:"greeks-table"},$ge={class:"value mono positive"},Kge={class:"impact mono"},Zge={class:"value mono blue"},Jge={class:"impact mono"},Qge={class:"impact mono"},eye={class:"value mono cyan"},tye={class:"impact mono"},aye={class:"impact mono"},nye={class:"impact mono"},rye={class:"impact mono"},iye={class:"impact mono"},oye={class:"impact mono"},sye={class:"card full-width"},lye={class:"heatmap-container"},cye={class:"grid-2"},uye={class:"card"},dye={class:"chart-container"},hye={class:"card"},pye={class:"greeks-pnl-summary"},fye={class:"pnl-item"},mye={class:"pnl-item"},vye={class:"pnl-item"},gye={class:"pnl-item"},yye={class:"pnl-item"},bye={class:"pnl-item total"},xye={class:"factor-value accent"},wye={class:"card full-width"},_ye={class:"risk-limits-table-container"},Sye={class:"risk-limits-table"},Mye={class:"greeks-name"},Tye={class:"current mono"},kye={class:"limit mono"},Cye={class:"utilization"},Aye={class:"util-bar"},Eye={class:"util-text"},Iye={class:"action"},Rye={key:0,class:"btn-action warning"},Dye={key:1,class:"btn-action critical"},Pye={key:2,class:"btn-action ok"},Lye={class:"card full-width"},Nye={class:"chart-container tall"},Oye=e({__name:"ForwardsGreeksDashboard",setup(e){const a=Nue(),r=t("long-bond"),o=t("summary"),u=t(!1),d=t({spotPrice:100,strikePrice:100,timeToMaturity:.25,volatility:12.5,riskFreeRate:4.25,dividendYield:2.5,contractSize:1e6}),h=S(()=>{let e=0,t=0,n=0,r=0,i=0;return a.registryForwards.forEach((o,s)=>{const l=a.getResultByIndex(s);if(l){const a=o.contractSize||1e6;if(e+=(l.delta||0)*a,t+=(l.rho||0)*a,i+=(l.forwardValue||0)*a,"bond"===o.forwardType&&l.dv01){const e=o.faceValue||100;n+=l.dv01*a*e/100,r+=(l.convexity||0)*a}}}),{delta:e,rho:t,dv01:n,convexity:r,totalValue:i}}),g=S(()=>{if(a.registryForwards.length>0&&a.calculatedForwards.length>0){const e=h.value,t=a.registryForwards.reduce((e,t)=>e+(t.contractSize||1e6),0);return{delta:t>0?e.delta/t:0,rho:t>0?e.rho/t:0,gamma:0,vega:0,theta:0,volga:0,vanna:0,charm:0,rogas:0}}const e=d.value.spotPrice,t=d.value.strikePrice,n=d.value.timeToMaturity,r=d.value.riskFreeRate/100,i=d.value.dividendYield/100,o=d.value.volatility/100,s=Math.exp((r-i)*n),l=Math.exp((r-i)*n)/(e*o*Math.sqrt(n)),c=e*Math.exp((r-i)*n)*Math.sqrt(n)/100,u=-e*o*Math.exp((r-i)*n)/(2*Math.sqrt(n))/365,p=t*n*Math.exp(-r*n)/100;return{delta:s,gamma:l,vega:c,theta:u,rho:p,volga:c*(Math.log(e/t)/(o*o*n)-1)/o,vanna:-Math.exp((r-i)*n)*Math.log(e/t)/(o*o*n),charm:(r-i)*s-l*e*o,rogas:p*n/100}}),b=S(()=>{const e=g.value,t=d.value.contractSize,a=e.delta*d.value.spotPrice*.01*t,n=e.vega*t,r=e.rho*t,i=e.theta*t,o=.02*e.delta*d.value.spotPrice*t,s=.5*e.gamma*Math.pow(.02*d.value.spotPrice,2)*t,l=.02*e.vega*t,c=e.theta*(1/365)*t,u=.01*e.rho*t;return{deltaP1pct:a,vegaP1pct:n,rhoP1pct:r,thetaPerDay:i,deltaPnL:o,gammaPnL:s,vegaPnL:l,thetaPnL:c,rhoPnL:u,totalPnL:o+s+l+c+u}}),x=S(()=>{const e=h.value,t=a.registryForwards.reduce((e,t)=>e+(t.contractSize||1e6),0),n=t>0?Math.abs(e.delta/t):0,r=t>0?Math.abs(e.rho/t):0,i=e.dv01/1e6;return[{greeks:"Delta",current:n,limit:2,utilization:n/2,status:n/2>.8?"Warning":"OK"},{greeks:"Rho",current:r,limit:200,utilization:r/200,status:r/200>.8?"Warning":"OK"},{greeks:"DV01",current:i,limit:10,utilization:i/10,status:i/10>.8?"Warning":"OK"},{greeks:"Convexity",current:e.convexity/1e6,limit:5,utilization:e.convexity/1e6/5,status:e.convexity/1e6/5>.8?"Warning":"OK"},{greeks:"Total Value",current:e.totalValue/1e6,limit:100,utilization:Math.abs(e.totalValue/1e6)/100,status:Math.abs(e.totalValue/1e6)/100>.8?"Warning":"OK"}]}),_=t(null),M=t(null),k=t(null),C=t(null),A=t(null),E=t(null),R=t(null),P=t(null),L=t(null);let N={};const F=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",B=()=>{U()},U=()=>{if(Object.values(N).forEach(e=>{e&&e.destroy()}),N={},d.value.spotPrice,d.value.volatility,_.value?.getContext("2d")){const e=[],t=[];for(let a=.7;a<=1.3;a+=.05)e.push((100*a).toFixed(0)),t.push(g.value.delta);N.delta=new re(_.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Delta (∂F/∂S)",data:t,borderColor:"#4ade80",backgroundColor:"rgba(74, 222, 128, 0.08)",fill:!0,tension:.4,pointRadius:3,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(M.value?.getContext("2d")){const e=[],t=[];for(let a=.7;a<=1.3;a+=.05)e.push((100*a).toFixed(0)),t.push(g.value.gamma);N.gamma=new re(M.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Gamma (∂²F/∂S²)",data:t,borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.08)",fill:!0,tension:.4,pointRadius:3,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(k.value?.getContext("2d")){const e=[],t=[];for(let a=5;a<=25;a+=2)e.push(a.toString()),t.push(g.value.vega);N.vega=new re(k.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Vega (∂F/∂σ)",data:t,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:3,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(C.value?.getContext("2d")&&(N.vegaDecomp=new re(C.value.getContext("2d"),{type:"bar",data:{labels:["1M","3M","6M","1Y","2Y","5Y","10Y"],datasets:[{label:"Vega by Tenor",data:[120,180,240,290,350,280,150],backgroundColor:["#60a5fa","#3b82f6","#2563eb","#1d4ed8","#1e40af","#1e3a8a","#172554"],borderColor:"#0f172a",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),A.value?.getContext("2d")){const e=[],t=[];for(let a=90;a>=1;a-=10)e.push(a.toString()),t.push(-a/10*2);N.theta=new re(A.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Theta (∂F/∂t)",data:t,borderColor:"#f87171",backgroundColor:"rgba(248, 113, 113, 0.08)",fill:!0,tension:.4,pointRadius:3,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(E.value?.getContext("2d")&&(N.crossGamma=new re(E.value.getContext("2d"),{type:"bubble",data:{datasets:[{label:"Vanna (∂²F/∂S∂σ)",data:[{x:95,y:8,r:10},{x:98,y:12,r:15},{x:100,y:15,r:20},{x:102,y:12,r:15},{x:105,y:8,r:10}],backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),P.value?.getContext("2d")){const e=b.value;N.pnlAttr=new re(P.value.getContext("2d"),{type:"bar",data:{labels:["Delta","Gamma","Vega","Theta","Rho"],datasets:[{label:"P&L Contribution",data:[e.deltaPnL,e.gammaPnL,e.vegaPnL,e.thetaPnL,e.rhoPnL],backgroundColor:[e.deltaPnL>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)",e.gammaPnL>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)",e.vegaPnL>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)",e.thetaPnL>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)",e.rhoPnL>=0?"rgba(74, 222, 128, 0.6)":"rgba(248, 113, 113, 0.6)"],borderColor:["#4ade80","#4ade80","#4ade80","#4ade80","#4ade80"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}L.value?.getContext("2d")&&(N.scenarios=new re(L.value.getContext("2d"),{type:"line",data:{labels:["-2% Spot","-1.5% Spot","-1% Spot","Base","+1% Spot","+1.5% Spot","+2% Spot"],datasets:[{label:"No Vol Change",data:[-25e3,-18e3,-12e3,0,12e3,18e3,25e3],borderColor:"#60a5fa",tension:.4},{label:"Vol +5%",data:[-2e4,-13e3,-7e3,5e3,17e3,23e3,3e4],borderColor:"#4ade80",tension:.4},{label:"Vol -5%",data:[-3e4,-23e3,-17e3,-5e3,7e3,13e3,2e4],borderColor:"#f87171",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}}))};return n(()=>{U()}),z(()=>{Object.values(N).forEach(e=>{e&&e.destroy()})}),(e,t)=>(w(),i("div",Xve,[s("div",$ve,[s("div",Kve,[t[3]||(t[3]=s("h1",{class:"page-title"},"Панель греков",-1)),s("p",Zve,[t[2]||(t[2]=m(" Анализ чувствительности форвардных позиций ",-1)),O(a).registryForwards.length>0?(w(),i("span",Jve,[m(" • Портфель: "+v(O(a).registryForwards.length)+" форвардов ",1),O(a).calculatedForwards.length>0?(w(),i("span",Qve," ("+v(O(a).calculatedForwards.length)+" рассчитано) ",1)):l("",!0)])):l("",!0)])]),s("div",ege,[s("div",tge,[t[5]||(t[5]=s("label",{class:"control-label"},"Позиция:",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),class:"position-select",onChange:B},[...t[4]||(t[4]=[I('<option value="long-bond" data-v-68bf797b>Long форвард на облигацию</option><option value="short-bond" data-v-68bf797b>Short форвард на облигацию</option><option value="long-fx" data-v-68bf797b>Long валютный форвард</option><option value="short-fx" data-v-68bf797b>Short валютный форвард</option><option value="long-commodity" data-v-68bf797b>Long форвард на товар</option>',5)])],544),[[D,r.value]])]),s("div",age,[t[7]||(t[7]=s("label",{class:"control-label"},"Вид:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),class:"view-select",onChange:B},[...t[6]||(t[6]=[s("option",{value:"summary"},"Резюме",-1),s("option",{value:"detailed"},"Детальные греки",-1),s("option",{value:"sensitivity"},"Графики чувствительности",-1)])],544),[[D,o.value]])]),s("button",{onClick:B,class:"btn-primary",disabled:u.value},[u.value?(w(),i("span",ige,"↺ Считаю...")):(w(),i("span",rge,"Обновить"))],8,nge)])]),s("div",oge,[s("div",sge,[t[10]||(t[10]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"Δ (Delta)"),s("span",{class:"greek-name"},"Чувствительность к спот цене")],-1)),s("div",lge,v(g.value.delta.toFixed(4)),1),s("div",cge,[s("div",uge,[t[8]||(t[8]=s("span",{class:"label"},"P&L / 1% спота",-1)),s("span",dge,v(F(b.value.deltaP1pct)),1)]),s("div",hge,[t[9]||(t[9]=s("span",{class:"label"},"Gamma (рост дельты)",-1)),s("span",{class:c(["value",g.value.gamma>=0?"positive":"negative"])},v(g.value.gamma>=0?"+":"")+v(g.value.gamma.toFixed(6)),3)])])]),s("div",pge,[t[13]||(t[13]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"ν (Vega)"),s("span",{class:"greek-name"},"Чувствительность к волатильности")],-1)),s("div",fge,v(g.value.vega.toFixed(4)),1),s("div",mge,[s("div",vge,[t[11]||(t[11]=s("span",{class:"label"},"P&L / 1% vol",-1)),s("span",gge,v(F(b.value.vegaP1pct)),1)]),s("div",yge,[t[12]||(t[12]=s("span",{class:"label"},"Volga (кривизна)",-1)),s("span",{class:c(["value",g.value.volga>=0?"positive":"negative"])},v(g.value.volga>=0?"+":"")+v(g.value.volga.toFixed(6)),3)])])]),s("div",bge,[t[16]||(t[16]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"Θ (Theta)"),s("span",{class:"greek-name"},"Временное затухание (P&L от времени)")],-1)),s("div",{class:c(["greek-value",g.value.theta>=0?"positive":"negative"])},v(g.value.theta>=0?"+":"")+v(g.value.theta.toFixed(4)),3),s("div",xge,[s("div",wge,[t[14]||(t[14]=s("span",{class:"label"},"P&L / день",-1)),s("span",_ge,v(F(b.value.thetaPerDay)),1)]),s("div",Sge,[t[15]||(t[15]=s("span",{class:"label"},"Годовая",-1)),s("span",Mge,v((252*g.value.theta).toFixed(2))+"/год",1)])])]),s("div",Tge,[t[19]||(t[19]=s("div",{class:"greek-header"},[s("span",{class:"greek-symbol"},"ρ (Rho)"),s("span",{class:"greek-name"},"Чувствительность к ставкам")],-1)),s("div",kge,v(g.value.rho.toFixed(4)),1),s("div",Cge,[s("div",Age,[t[17]||(t[17]=s("span",{class:"label"},"P&L / 1% ставки",-1)),s("span",Ege,v(F(b.value.rhoP1pct)),1)]),s("div",Ige,[t[18]||(t[18]=s("span",{class:"label"},"Rogas (кривизна)",-1)),s("span",{class:c(["value",g.value.rogas>=0?"positive":"negative"])},v(g.value.rogas>=0?"+":"")+v(g.value.rogas.toFixed(6)),3)])])])]),s("div",Rge,[s("div",Dge,[t[20]||(t[20]=s("div",{class:"chart-header"},[s("h3",null,"Delta: Чувствительность к спот цене"),s("span",{class:"chart-subtitle"},"∂F/∂S — как меняется стоимость форварда")],-1)),s("div",Pge,[s("canvas",{ref_key:"deltaChartRef",ref:_},null,512)])]),s("div",Lge,[t[21]||(t[21]=s("div",{class:"chart-header"},[s("h3",null,"Gamma: Выпуклость Delta"),s("span",{class:"chart-subtitle"},"∂²F/∂S² — как меняется дельта")],-1)),s("div",Nge,[s("canvas",{ref_key:"gammaChartRef",ref:M},null,512)])])]),s("div",Oge,[s("div",Fge,[t[22]||(t[22]=s("div",{class:"chart-header"},[s("h3",null,"Vega: Чувствительность к волатильности"),s("span",{class:"chart-subtitle"},"∂F/∂σ — как меняется стоимость с волатильностью")],-1)),s("div",Bge,[s("canvas",{ref_key:"vegaChartRef",ref:k},null,512)])]),s("div",Uge,[t[23]||(t[23]=s("div",{class:"chart-header"},[s("h3",null,"Разложение Vega по срокам"),s("span",{class:"chart-subtitle"},"Вклад каждого срока в итоговый vega")],-1)),s("div",zge,[s("canvas",{ref_key:"vegaDecompRef",ref:C},null,512)])])]),s("div",Vge,[s("div",Hge,[t[24]||(t[24]=s("div",{class:"chart-header"},[s("h3",null,"Theta: Временное затухание"),s("span",{class:"chart-subtitle"},"∂F/∂t — P&L от изменения времени")],-1)),s("div",Gge,[s("canvas",{ref_key:"thetaChartRef",ref:A},null,512)])]),s("div",Wge,[t[25]||(t[25]=s("div",{class:"chart-header"},[s("h3",null,"Cross Gamma: Спот × Vol"),s("span",{class:"chart-subtitle"},"∂²F/∂S∂σ — взаимодействие факторов")],-1)),s("div",qge,[s("canvas",{ref_key:"crossGammaChartRef",ref:E},null,512)])])]),s("div",Yge,[t[65]||(t[65]=s("div",{class:"card-header"},[s("h3",null,"Детальная таблица греков"),s("span",{class:"card-subtitle"},"Первые, вторые и смешанные производные")],-1)),s("div",jge,[s("table",Xge,[t[64]||(t[64]=s("thead",null,[s("tr",null,[s("th",{class:"col-name"},"Greeks"),s("th",{class:"col-symbol"},"Символ"),s("th",{class:"col-value"},"Значение"),s("th",{class:"col-meaning"},"Интерпретация"),s("th",{class:"col-impact"},"Влияние @ 1%"),s("th",{class:"col-order"},"Порядок")])],-1)),s("tbody",null,[t[62]||(t[62]=s("tr",{class:"section-header"},[s("td",{colspan:"6"},"ГРЕКИ ПЕРВОГО ПОРЯДКА")],-1)),s("tr",null,[t[26]||(t[26]=s("td",{class:"greek-name"},"Delta",-1)),t[27]||(t[27]=s("td",{class:"symbol"},"Δ = ∂F/∂S",-1)),s("td",$ge,v(g.value.delta.toFixed(4)),1),t[28]||(t[28]=s("td",{class:"meaning"},"Forward при изменении спота",-1)),s("td",Kge,v(F(b.value.deltaP1pct)),1),t[29]||(t[29]=s("td",{class:"order"},"1st",-1))]),s("tr",null,[t[30]||(t[30]=s("td",{class:"greek-name"},"Vega",-1)),t[31]||(t[31]=s("td",{class:"symbol"},"ν = ∂F/∂σ",-1)),s("td",Zge,v(g.value.vega.toFixed(4)),1),t[32]||(t[32]=s("td",{class:"meaning"},"Forward при изменении волатильности",-1)),s("td",Jge,v(F(b.value.vegaP1pct)),1),t[33]||(t[33]=s("td",{class:"order"},"1st",-1))]),s("tr",null,[t[34]||(t[34]=s("td",{class:"greek-name"},"Theta",-1)),t[35]||(t[35]=s("td",{class:"symbol"},"Θ = ∂F/∂t",-1)),s("td",{class:c(["value mono",g.value.theta>=0?"positive":"negative"])},v(g.value.theta>=0?"+":"")+v(g.value.theta.toFixed(4)),3),t[36]||(t[36]=s("td",{class:"meaning"},"Forward при изменении времени",-1)),s("td",Qge,v(F(b.value.thetaPerDay))+"/day",1),t[37]||(t[37]=s("td",{class:"order"},"1st",-1))]),s("tr",null,[t[38]||(t[38]=s("td",{class:"greek-name"},"Rho",-1)),t[39]||(t[39]=s("td",{class:"symbol"},"ρ = ∂F/∂r",-1)),s("td",eye,v(g.value.rho.toFixed(4)),1),t[40]||(t[40]=s("td",{class:"meaning"},"Forward при изменении ставки",-1)),s("td",tye,v(F(b.value.rhoP1pct)),1),t[41]||(t[41]=s("td",{class:"order"},"1st",-1))]),t[63]||(t[63]=s("tr",{class:"section-header"},[s("td",{colspan:"6"},"ГРЕКИ ВТОРОГО ПОРЯДКА")],-1)),s("tr",null,[t[42]||(t[42]=s("td",{class:"greek-name"},"Gamma",-1)),t[43]||(t[43]=s("td",{class:"symbol"},"Γ = ∂²F/∂S²",-1)),s("td",{class:c(["value mono",g.value.gamma>=0?"positive":"negative"])},v(g.value.gamma>=0?"+":"")+v(g.value.gamma.toFixed(6)),3),t[44]||(t[44]=s("td",{class:"meaning"},"Как меняется дельта при изменении спота",-1)),s("td",aye,v(g.value.gamma.toFixed(6)),1),t[45]||(t[45]=s("td",{class:"order"},"2nd",-1))]),s("tr",null,[t[46]||(t[46]=s("td",{class:"greek-name"},"Volga",-1)),t[47]||(t[47]=s("td",{class:"symbol"},"ϝ = ∂²F/∂σ²",-1)),s("td",{class:c(["value mono",g.value.volga>=0?"positive":"negative"])},v(g.value.volga>=0?"+":"")+v(g.value.volga.toFixed(6)),3),t[48]||(t[48]=s("td",{class:"meaning"},"Как меняется vega при изменении волатильности",-1)),s("td",nye,v(g.value.volga.toFixed(6)),1),t[49]||(t[49]=s("td",{class:"order"},"2nd",-1))]),s("tr",null,[t[50]||(t[50]=s("td",{class:"greek-name"},"Vanna",-1)),t[51]||(t[51]=s("td",{class:"symbol"},"χ = ∂²F/∂S∂σ",-1)),s("td",{class:c(["value mono",g.value.vanna>=0?"positive":"negative"])},v(g.value.vanna>=0?"+":"")+v(g.value.vanna.toFixed(6)),3),t[52]||(t[52]=s("td",{class:"meaning"},"Взаимодействие спота и волатильности",-1)),s("td",rye,v(g.value.vanna.toFixed(6)),1),t[53]||(t[53]=s("td",{class:"order"},"2nd",-1))]),s("tr",null,[t[54]||(t[54]=s("td",{class:"greek-name"},"Charm",-1)),t[55]||(t[55]=s("td",{class:"symbol"},"χ = ∂²F/∂t∂S",-1)),s("td",{class:c(["value mono",g.value.charm>=0?"positive":"negative"])},v(g.value.charm>=0?"+":"")+v(g.value.charm.toFixed(6)),3),t[56]||(t[56]=s("td",{class:"meaning"},"Как меняется дельта при изменении времени",-1)),s("td",iye,v(g.value.charm.toFixed(6)),1),t[57]||(t[57]=s("td",{class:"order"},"2nd",-1))]),s("tr",null,[t[58]||(t[58]=s("td",{class:"greek-name"},"Rogas",-1)),t[59]||(t[59]=s("td",{class:"symbol"},"ρρ = ∂²F/∂r²",-1)),s("td",{class:c(["value mono",g.value.rogas>=0?"positive":"negative"])},v(g.value.rogas>=0?"+":"")+v(g.value.rogas.toFixed(6)),3),t[60]||(t[60]=s("td",{class:"meaning"},"Как меняется rho при изменении ставки",-1)),s("td",oye,v(g.value.rogas.toFixed(6)),1),t[61]||(t[61]=s("td",{class:"order"},"2nd",-1))])])])])]),s("div",sye,[t[66]||(t[66]=s("div",{class:"card-header"},[s("h3",null,"Тепловая карта риска греков"),s("span",{class:"card-subtitle"},"Тепловая карта по движениям рынка")],-1)),s("div",lye,[s("canvas",{ref_key:"heatmapRef",ref:R},null,512)])]),s("div",cye,[s("div",uye,[t[67]||(t[67]=s("div",{class:"chart-header"},[s("h3",null,"Атрибуция P&L по грекам"),s("span",{class:"chart-subtitle"},"Вклад каждого грека в общий P&L")],-1)),s("div",dye,[s("canvas",{ref_key:"pnlAttributionRef",ref:P},null,512)])]),s("div",hye,[t[74]||(t[74]=s("div",{class:"chart-header"},[s("h3",null,"Резюме P&L греков"),s("span",{class:"chart-subtitle"},"Эффект каждого фактора")],-1)),s("div",pye,[s("div",fye,[t[68]||(t[68]=s("span",{class:"factor-label"},"Delta P&L (Движение спота)",-1)),s("span",{class:c(["factor-value",g.value.delta>=0?"positive":"negative"])},v(g.value.delta>=0?"+":"")+v(F(b.value.deltaPnL)),3)]),s("div",mye,[t[69]||(t[69]=s("span",{class:"factor-label"},"Gamma P&L (Выпуклость)",-1)),s("span",{class:c(["factor-value",g.value.gamma>=0?"positive":"negative"])},v(g.value.gamma>=0?"+":"")+v(F(b.value.gammaPnL)),3)]),s("div",vye,[t[70]||(t[70]=s("span",{class:"factor-label"},"Vega P&L (Движение Vol)",-1)),s("span",{class:c(["factor-value",g.value.vega>=0?"positive":"negative"])},v(g.value.vega>=0?"+":"")+v(F(b.value.vegaPnL)),3)]),s("div",gye,[t[71]||(t[71]=s("span",{class:"factor-label"},"Theta P&L (Временное затухание)",-1)),s("span",{class:c(["factor-value",g.value.theta>=0?"positive":"negative"])},v(g.value.theta>=0?"+":"")+v(F(b.value.thetaPnL)),3)]),s("div",yye,[t[72]||(t[72]=s("span",{class:"factor-label"},"Rho P&L (Движение ставки)",-1)),s("span",{class:c(["factor-value",g.value.rho>=0?"positive":"negative"])},v(g.value.rho>=0?"+":"")+v(F(b.value.rhoPnL)),3)]),s("div",bye,[t[73]||(t[73]=s("span",{class:"factor-label"},[s("strong",null,"Общий P&L")],-1)),s("span",xye,[s("strong",null,v(F(b.value.totalPnL)),1)])])])])]),s("div",wye,[t[76]||(t[76]=s("div",{class:"card-header"},[s("h3",null,"Risk Limits & Monitoring"),s("span",{class:"card-subtitle"},"Проверка лимитов греков и alerts")],-1)),s("div",_ye,[s("table",Sye,[t[75]||(t[75]=s("thead",null,[s("tr",null,[s("th",null,"Greeks"),s("th",null,"Текущее"),s("th",null,"Лимит"),s("th",null,"Использование"),s("th",null,"Статус"),s("th",null,"Действие")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(x.value,e=>(w(),i("tr",{key:e.greeks,class:c(e.status.toLowerCase())},[s("td",Mye,v(e.greeks),1),s("td",Tye,v(e.current.toFixed(4)),1),s("td",kye,v(e.limit),1),s("td",Cye,[s("div",Aye,[s("div",{class:"util-fill",style:y({width:100*e.utilization+"%"})},null,4)]),s("span",Eye,v((100*e.utilization).toFixed(0))+"%",1)]),s("td",{class:c(["status",e.status.toLowerCase()])},v(e.status),3),s("td",Iye,["Warning"===e.status?(w(),i("button",Rye,"Уменьшить")):"Critical"===e.status?(w(),i("button",Dye,"Хеджировать!")):(w(),i("span",Pye,"OK"))])],2))),128))])])])]),s("div",Lye,[t[77]||(t[77]=s("div",{class:"chart-header"},[s("h3",null,"P&L в рыночных сценариях"),s("span",{class:"chart-subtitle"},"Как меняется P&L при различных комбинациях движений")],-1)),s("div",Nye,[s("canvas",{ref_key:"scenariosRef",ref:L},null,512)])]),t[78]||(t[78]=s("div",{class:"page-footer"},[s("span",null,"• Модель: Black-Scholes (для форвардов)"),s("span",null,"• Частота: Непрерывная"),s("span",null,"• Обновление: В реальном времени")],-1))]))}}),Fye=xe(Oye,[["__scopeId","data-v-68bf797b"]]),Bye={class:"basis-analysis-page"},Uye={class:"page-header"},zye={class:"header-right"},Vye={class:"control-group"},Hye={class:"control-group"},Gye=["disabled"],Wye={key:0},qye={key:1},Yye={class:"grid-4"},jye={class:"metric-card"},Xye={class:"metric-value accent"},$ye={class:"metric-detail"},Kye={class:"metric-card"},Zye={class:"metric-value blue"},Jye={class:"metric-detail"},Qye={class:"value"},ebe={class:"metric-card"},tbe={class:"metric-value cyan"},abe={class:"metric-detail"},nbe={class:"value"},rbe={class:"metric-card"},ibe={class:"metric-detail"},obe={class:"value"},sbe={class:"grid-2"},lbe={class:"card"},cbe={class:"carry-breakdown"},ube={class:"carry-item"},dbe={class:"value positive"},hbe={class:"carry-item"},pbe={class:"value positive"},fbe={class:"carry-item"},mbe={class:"value positive"},vbe={class:"carry-item"},gbe={class:"value negative"},ybe={class:"carry-item"},bbe={class:"value negative"},xbe={class:"carry-item total"},wbe={class:"value cyan"},_be={class:"card"},Sbe={class:"chart-container"},Mbe={class:"card full-width"},Tbe={class:"chart-container tall"},kbe={class:"card full-width"},Cbe={class:"basis-table-container"},Abe={class:"basis-table"},Ebe={class:"tenor-name"},Ibe={class:"price mono"},Rbe={class:"price mono"},Dbe={class:"basis mono"},Pbe={class:"basis-pct mono"},Lbe={class:"fair mono"},Nbe={class:"carry mono"},Obe={class:"grid-2"},Fbe={class:"card"},Bbe={class:"roll-analysis"},Ube={class:"roll-item"},zbe={class:"value"},Vbe={class:"roll-item"},Hbe={class:"value"},Gbe={class:"roll-item"},Wbe={class:"value cyan mono"},qbe={class:"roll-item"},Ybe={class:"roll-item total"},jbe={class:"value accent"},Xbe={class:"card"},$be={class:"strategy-analysis"},Kbe={class:"strategy-item"},Zbe={class:"value"},Jbe={class:"strategy-item"},Qbe={class:"value"},exe={class:"strategy-item"},txe={class:"value"},axe={class:"strategy-item"},nxe={class:"value"},rxe={class:"strategy-item total"},ixe={class:"value positive"},oxe={class:"grid-2"},sxe={class:"card"},lxe={class:"chart-container"},cxe={class:"card"},uxe={class:"volatility-metrics"},dxe={class:"vol-item"},hxe={class:"value accent"},pxe={class:"vol-item"},fxe={class:"value blue"},mxe={class:"vol-item"},vxe={class:"value"},gxe={class:"vol-item"},yxe={class:"value"},bxe={class:"vol-item total"},xxe={class:"value cyan"},wxe={class:"card full-width"},_xe={class:"chart-container tall"},Sxe={class:"grid-2"},Mxe={class:"card"},Txe={class:"drivers-list"},kxe={class:"driver-name"},Cxe={class:"driver-value"},Axe={class:"card"},Exe={class:"forecast-metrics"},Ixe={class:"forecast-item"},Rxe={class:"value"},Dxe={class:"forecast-item"},Pxe={class:"value cyan"},Lxe={class:"forecast-item"},Nxe={class:"value cyan"},Oxe={class:"forecast-item"},Fxe={class:"value cyan"},Bxe={class:"forecast-item total"},Uxe={class:"value positive"},zxe={class:"card full-width"},Vxe={class:"opportunities-table-container"},Hxe={class:"opportunities-table"},Gxe={class:"tenor"},Wxe={class:"price mono"},qxe={class:"price mono"},Yxe={class:"basis mono"},jxe={class:"basis mono"},Xxe={class:"profit mono positive"},$xe={class:"card full-width"},Kxe={class:"risk-summary"},Zxe={class:"risk-item"},Jxe={class:"risk-metric"},Qxe={class:"value negative"},ewe={class:"risk-item"},twe={class:"risk-metric"},awe={class:"risk-item"},nwe={class:"risk-metric"},rwe={class:"value negative"},iwe=e({__name:"BasisAnalysis",setup(e){const a=t("bonds"),r=t("3m"),o=t(!1),l=t({spotPrice:100,forwardPrice:101.25,basis:1.25,annualizedCarry:5.2,termLength:3,spotChange:.45,currentTenor:"3M",nextTenor:"6M",rollYield:-.15,rollYieldAnnual:-2,totalReturn:3.2,arbitrageProfit:12500,contractSize:1e5,carryComponents:{riskFreeRate:4.25,storageCost:.25,financingCost:.75,dividendYield:2.5,convenienceYield:.5},basisVolatility:{current:8.5,vol20d:7.2,vol60d:8.1,vol1y:9.3,minBasis:.8,maxBasis:2.1}}),u=t([{tenor:"1M",spotPrice:100,forwardPrice:100.35,basis:.35,basisPct:.35,fairBasis:.42,variance:-.07,carryAnn:4.2,opportunity:"Underpriced"},{tenor:"3M",spotPrice:100,forwardPrice:101.25,basis:1.25,basisPct:1.25,fairBasis:1.32,variance:-.07,carryAnn:5.2,opportunity:"Underpriced"},{tenor:"6M",spotPrice:100,forwardPrice:102.65,basis:2.65,basisPct:2.65,fairBasis:2.58,variance:.07,carryAnn:5.3,opportunity:"Overpriced"},{tenor:"1Y",spotPrice:100,forwardPrice:105.4,basis:5.4,basisPct:5.4,fairBasis:5.25,variance:.15,carryAnn:5.4,opportunity:"Overpriced"},{tenor:"2Y",spotPrice:100,forwardPrice:110.8,basis:10.8,basisPct:10.8,fairBasis:10.95,variance:-.15,carryAnn:5.4,opportunity:"Neutral"}]),d=t([{name:"Risk-free Rate",impact:"Positive",value:"+4.25%"},{name:"Dividend Yield",impact:"Negative",value:"-2.50%"},{name:"Storage Cost",impact:"Positive",value:"+0.25%"},{name:"Convenience Yield",impact:"Negative",value:"-0.50%"},{name:"Financing Cost",impact:"Positive",value:"+0.75%"}]),h=S(()=>u.value.map(e=>({tenor:e.tenor,spotPrice:e.spotPrice,forwardPrice:e.forwardPrice,fairBasis:e.fairBasis,marketBasis:e.basis,mispricing:e.variance,strategy:"Underpriced"===e.opportunity?"Buy Spot + Sell Forward":"Overpriced"===e.opportunity?"Short Spot + Buy Forward":"Neutral",profitPotential:Math.abs(e.variance)*l.value.contractSize/100}))),m=t(null),g=t(null),y=t(null),b=t(null);let x={};const _=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),M=e=>Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"М":"$"+(e/1e3).toFixed(0)+"K",k=()=>{C()},C=()=>{Object.values(x).forEach(e=>{e&&e.destroy()}),x={};const e=u.value.map(e=>e.tenor),t=u.value.map(e=>e.basis),a=u.value.map(e=>e.fairBasis);if(m.value?.getContext("2d")&&(x.basis=new re(m.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Actual Basis",data:t,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2},{label:"Fair Basis (Cost-of-Carry)",data:a,borderColor:"#4ade80",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:3,borderDash:[5,5],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),g.value?.getContext("2d")){const a=u.value.map(e=>e.carryAnn);x.termStruct=new re(g.value.getContext("2d"),{type:"bar",data:{labels:e,datasets:[{label:"Basis (Points)",data:t,backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa",yAxisID:"y"},{label:"Annualized Carry (%)",data:a,backgroundColor:"rgba(74, 222, 128, 0.6)",borderColor:"#4ade80",yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{type:"linear",display:!0,position:"left",grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"},title:{display:!0,text:"Basis (Pts)"}},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1},ticks:{color:"rgba(255,255,255,0.3)"},title:{display:!0,text:"Carry (%)"}}}}})}if(y.value?.getContext("2d")){const e=[.9,1.4,1.75,2.55,3.2];x.spread=new re(y.value.getContext("2d"),{type:"line",data:{labels:["1M-3M","3M-6M","6M-1Y","1Y-2Y","Avg"],datasets:[{label:"Roll Spread",data:e,borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}if(b.value?.getContext("2d")){const e=["1M ago","3W ago","2W ago","1W ago","3D ago","Today"],t=[1.5,1.45,1.35,1.28,1.26,1.25],a=[5.8,5.7,5.5,5.4,5.3,5.2];x.historical=new re(b.value.getContext("2d"),{type:"line",data:{labels:e,datasets:[{label:"Basis",data:t,borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2,yAxisID:"y"},{label:"Annualized Carry (%)",data:a,borderColor:"#4ade80",backgroundColor:"transparent",fill:!1,tension:.4,pointRadius:3,borderWidth:2,yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{type:"linear",display:!0,position:"left",grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}},y1:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1},ticks:{color:"rgba(255,255,255,0.3)"}}}}})}};return n(()=>{C()}),z(()=>{Object.values(x).forEach(e=>{e&&e.destroy()})}),(e,t)=>(w(),i("div",Bye,[s("div",Uye,[t[6]||(t[6]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Анализ базиса"),s("p",{class:"page-subtitle"},"Анализ спот-форвард базиса и стоимости переноса позиций")],-1)),s("div",zye,[s("div",Vye,[t[3]||(t[3]=s("label",{class:"control-label"},"Инструмент:",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:"instrument-select",onChange:k},[...t[2]||(t[2]=[s("option",{value:"bonds"},"Базис облигаций",-1),s("option",{value:"fx"},"Валютный базис",-1),s("option",{value:"equity"},"Базис акций",-1),s("option",{value:"commodities"},"Базис товаров",-1)])],544),[[D,a.value]])]),s("div",Hye,[t[5]||(t[5]=s("label",{class:"control-label"},"Период:",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),class:"period-select",onChange:k},[...t[4]||(t[4]=[I('<option value="1m" data-v-367ebc1e>1 месяц</option><option value="3m" data-v-367ebc1e>3 месяца</option><option value="6m" data-v-367ebc1e>6 месяцев</option><option value="1y" data-v-367ebc1e>1 год</option><option value="2y" data-v-367ebc1e>2 года</option>',5)])],544),[[D,r.value]])]),s("button",{onClick:k,class:"btn-primary",disabled:o.value},[o.value?(w(),i("span",qye,"↺ Считаю...")):(w(),i("span",Wye,"Обновить"))],8,Gye)])]),s("div",Yye,[s("div",jye,[t[8]||(t[8]=s("div",{class:"metric-header"},[s("h3",null,"Спот цена"),s("span",{class:"metric-unit"},"Текущая цена")],-1)),s("div",Xye,v(_(l.value.spotPrice)),1),s("div",$ye,[t[7]||(t[7]=s("span",{class:"label"},"Изменение (1Д)",-1)),s("span",{class:c(["value",l.value.spotChange>=0?"positive":"negative"])},v(l.value.spotChange>=0?"+":"")+v(l.value.spotChange.toFixed(3))+"% ",3)])]),s("div",Kye,[t[10]||(t[10]=s("div",{class:"metric-header"},[s("h3",null,"Форвардная цена"),s("span",{class:"metric-unit"},"Форвардная цена")],-1)),s("div",Zye,v(_(l.value.forwardPrice)),1),s("div",Jye,[t[9]||(t[9]=s("span",{class:"label"},"Tenor",-1)),s("span",Qye,v(r.value),1)])]),s("div",ebe,[t[12]||(t[12]=s("div",{class:"metric-header"},[s("h3",null,"Базис (пункты)"),s("span",{class:"metric-unit"},"F - S")],-1)),s("div",tbe,v(l.value.basis.toFixed(4)),1),s("div",abe,[t[11]||(t[11]=s("span",{class:"label"},"% от спота",-1)),s("span",nbe,v((l.value.basis/l.value.spotPrice*100).toFixed(3))+"%",1)])]),s("div",rbe,[t[14]||(t[14]=s("div",{class:"metric-header"},[s("h3",null,"Годовая стоимость переноса"),s("span",{class:"metric-unit"},"Годовая стоимость")],-1)),s("div",{class:c(["metric-value",l.value.annualizedCarry>=0?"positive":"negative"])},v(l.value.annualizedCarry>=0?"+":"")+v(l.value.annualizedCarry.toFixed(2))+"% ",3),s("div",ibe,[t[13]||(t[13]=s("span",{class:"label"},"Срок",-1)),s("span",obe,v(l.value.termLength.toFixed(2))+"M",1)])])]),s("div",sbe,[s("div",lbe,[t[21]||(t[21]=s("div",{class:"card-header"},[s("h3",null,"Разложение стоимости переноса"),s("span",{class:"card-subtitle"},"Что составляет базис")],-1)),s("div",cbe,[s("div",ube,[t[15]||(t[15]=s("span",{class:"label"},"Безрисковая ставка (r)",-1)),s("span",dbe,v(l.value.carryComponents.riskFreeRate.toFixed(3))+"%",1)]),s("div",hbe,[t[16]||(t[16]=s("span",{class:"label"},"Стоимость хранения (u)",-1)),s("span",pbe,v(l.value.carryComponents.storageCost.toFixed(3))+"%",1)]),s("div",fbe,[t[17]||(t[17]=s("span",{class:"label"},"Стоимость финансирования (f)",-1)),s("span",mbe,v(l.value.carryComponents.financingCost.toFixed(3))+"%",1)]),s("div",vbe,[t[18]||(t[18]=s("span",{class:"label"},"- Дивидендная доходность (d)",-1)),s("span",gbe,v(l.value.carryComponents.dividendYield.toFixed(3))+"%",1)]),s("div",ybe,[t[19]||(t[19]=s("span",{class:"label"},"- Удобство владения (y)",-1)),s("span",bbe,v(l.value.carryComponents.convenienceYield.toFixed(3))+"%",1)]),s("div",xbe,[t[20]||(t[20]=s("span",{class:"label"},"= Чистый Carry (Базис)",-1)),s("span",wbe,v(l.value.annualizedCarry.toFixed(3))+"%",1)])])]),s("div",_be,[t[22]||(t[22]=s("div",{class:"chart-header"},[s("h3",null,"Теоретический vs фактический базис"),s("span",{class:"chart-subtitle"},"F_fair vs F_market")],-1)),s("div",Sbe,[s("canvas",{ref_key:"basisChartRef",ref:m},null,512)])])]),s("div",Mbe,[t[23]||(t[23]=s("div",{class:"chart-header"},[s("h3",null,"Структура базиса по срокам"),s("span",{class:"chart-subtitle"},"Как базис меняется по срокам")],-1)),s("div",Tbe,[s("canvas",{ref_key:"termStructureRef",ref:g},null,512)])]),s("div",kbe,[t[25]||(t[25]=s("div",{class:"card-header"},[s("h3",null,"Basis по срокам"),s("span",{class:"card-subtitle"},"Детальный анализ базиса для каждого tenor")],-1)),s("div",Cbe,[s("table",Abe,[t[24]||(t[24]=s("thead",null,[s("tr",null,[s("th",null,"Tenor"),s("th",null,"Спот цена"),s("th",null,"Форвардная цена"),s("th",null,"Базис (пт)"),s("th",null,"Базис (%)"),s("th",null,"Справедливый базис"),s("th",null,"Отклонение базиса"),s("th",null,"Carry (год.)"),s("th",null,"Возможность")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(u.value,e=>(w(),i("tr",{key:e.tenor,class:c("Neutral"!==e.opportunity?e.opportunity.toLowerCase():"")},[s("td",Ebe,v(e.tenor),1),s("td",Ibe,v(_(e.spotPrice)),1),s("td",Rbe,v(_(e.forwardPrice)),1),s("td",Dbe,v(e.basis.toFixed(4)),1),s("td",Pbe,v(e.basisPct.toFixed(3))+"%",1),s("td",Lbe,v(e.fairBasis.toFixed(4)),1),s("td",{class:c(["variance mono",Math.abs(e.variance)>.01?"outlier":""])},v(e.variance>=0?"+":"")+v(e.variance.toFixed(4)),3),s("td",Nbe,v(e.carryAnn.toFixed(2))+"%",1),s("td",{class:c(["opportunity",e.opportunity.toLowerCase()])},v(e.opportunity),3)],2))),128))])])])]),s("div",Obe,[s("div",Fbe,[t[31]||(t[31]=s("div",{class:"chart-header"},[s("h3",null,"Roll Yield Analysis"),s("span",{class:"chart-subtitle"},"Доход от переноса позиции на следующий контракт")],-1)),s("div",Bbe,[s("div",Ube,[t[26]||(t[26]=s("span",{class:"label"},"Текущий контракт",-1)),s("span",zbe,v(l.value.currentTenor),1)]),s("div",Vbe,[t[27]||(t[27]=s("span",{class:"label"},"Следующий контракт",-1)),s("span",Hbe,v(l.value.nextTenor),1)]),s("div",Gbe,[t[28]||(t[28]=s("span",{class:"label"},"Изменение базиса",-1)),s("span",Wbe,v(l.value.rollYield>=0?"+":"")+v(l.value.rollYield.toFixed(4)),1)]),s("div",qbe,[t[29]||(t[29]=s("span",{class:"label"},"Roll Yield (год.)",-1)),s("span",{class:c(["value",l.value.rollYieldAnnual>=0?"positive":"negative"])},v(l.value.rollYieldAnnual>=0?"+":"")+v(l.value.rollYieldAnnual.toFixed(2))+"% ",3)]),s("div",Ybe,[t[30]||(t[30]=s("span",{class:"label"},"Общая доходность",-1)),s("span",jbe,v(l.value.totalReturn>=0?"+":"")+v(l.value.totalReturn.toFixed(2))+"% ",1)])])]),s("div",Xbe,[t[37]||(t[37]=s("div",{class:"chart-header"},[s("h3",null,"Стратегия Carry Roll"),s("span",{class:"chart-subtitle"},'Стратегия "buy and carry"')],-1)),s("div",$be,[s("div",Kbe,[t[32]||(t[32]=s("span",{class:"label"},"Buy Spot @ ",-1)),s("span",Zbe,v(_(l.value.spotPrice)),1)]),s("div",Jbe,[t[33]||(t[33]=s("span",{class:"label"},"Финансировать @ ",-1)),s("span",Qbe,v(l.value.carryComponents.riskFreeRate.toFixed(2))+"%",1)]),s("div",exe,[t[34]||(t[34]=s("span",{class:"label"},"Стоимость удержания @ ",-1)),s("span",txe,v((l.value.carryComponents.storageCost+l.value.carryComponents.financingCost).toFixed(2))+"%",1)]),s("div",axe,[t[35]||(t[35]=s("span",{class:"label"},"Продать форвард @ ",-1)),s("span",nxe,v(_(l.value.forwardPrice)),1)]),s("div",rxe,[t[36]||(t[36]=s("span",{class:"label"},"Арбитражная прибыль",-1)),s("span",ixe,v(M(l.value.arbitrageProfit)),1)])])])]),s("div",oxe,[s("div",sxe,[t[38]||(t[38]=s("div",{class:"chart-header"},[s("h3",null,"Calendar Spread (Roll Spread)"),s("span",{class:"chart-subtitle"},"Разница в базисе между контрактами")],-1)),s("div",lxe,[s("canvas",{ref_key:"spreadChartRef",ref:y},null,512)])]),s("div",cxe,[t[44]||(t[44]=s("div",{class:"chart-header"},[s("h3",null,"Волатильность базиса"),s("span",{class:"chart-subtitle"},"Историческая волатильность базиса")],-1)),s("div",uxe,[s("div",dxe,[t[39]||(t[39]=s("span",{class:"label"},"Текущая волатильность базиса",-1)),s("span",hxe,v(l.value.basisVolatility.current.toFixed(2))+"%",1)]),s("div",pxe,[t[40]||(t[40]=s("span",{class:"label"},"20Д историческая",-1)),s("span",fxe,v(l.value.basisVolatility.vol20d.toFixed(2))+"%",1)]),s("div",mxe,[t[41]||(t[41]=s("span",{class:"label"},"60Д историческая",-1)),s("span",vxe,v(l.value.basisVolatility.vol60d.toFixed(2))+"%",1)]),s("div",gxe,[t[42]||(t[42]=s("span",{class:"label"},"1Г историческая",-1)),s("span",yxe,v(l.value.basisVolatility.vol1y.toFixed(2))+"%",1)]),s("div",bxe,[t[43]||(t[43]=s("span",{class:"label"},"Диапазон базиса (1Г)",-1)),s("span",xxe,v(l.value.basisVolatility.minBasis.toFixed(4))+" - "+v(l.value.basisVolatility.maxBasis.toFixed(4)),1)])])])]),s("div",wxe,[t[45]||(t[45]=s("div",{class:"chart-header"},[s("h3",null,"Историческая динамика базиса"),s("span",{class:"chart-subtitle"},"Изменение базиса и carry за последний год")],-1)),s("div",_xe,[s("canvas",{ref_key:"historicalBasisRef",ref:b},null,512)])]),s("div",Sxe,[s("div",Mxe,[t[46]||(t[46]=s("div",{class:"card-header"},[s("h3",null,"Ключевые драйверы базиса")],-1)),s("div",Txe,[(w(!0),i(p,null,f(d.value,e=>(w(),i("div",{key:e.name,class:"driver-item"},[s("span",kxe,v(e.name),1),s("div",{class:c(["driver-impact",e.impact.toLowerCase()])},v(e.impact),3),s("span",Cxe,v(e.value),1)]))),128))])]),s("div",Axe,[t[52]||(t[52]=s("div",{class:"card-header"},[s("h3",null,"Прогноз базиса (90Д)")],-1)),s("div",Exe,[s("div",Ixe,[t[47]||(t[47]=s("span",{class:"label"},"Текущий базис",-1)),s("span",Rxe,v(l.value.basis.toFixed(4)),1)]),s("div",Dxe,[t[48]||(t[48]=s("span",{class:"label"},"Прогноз базиса (30Д)",-1)),s("span",Pxe,v((.85*l.value.basis).toFixed(4)),1)]),s("div",Lxe,[t[49]||(t[49]=s("span",{class:"label"},"Прогноз базиса (60Д)",-1)),s("span",Nxe,v((.65*l.value.basis).toFixed(4)),1)]),s("div",Oxe,[t[50]||(t[50]=s("span",{class:"label"},"Прогноз базиса (90Д)",-1)),s("span",Fxe,v((.4*l.value.basis).toFixed(4)),1)]),s("div",Bxe,[t[51]||(t[51]=s("span",{class:"label"},"Ожидаемый Carry",-1)),s("span",Uxe,v((.75*l.value.annualizedCarry).toFixed(2))+"% ",1)])])])]),s("div",zxe,[t[54]||(t[54]=s("div",{class:"card-header"},[s("h3",null,"Арбитражные возможности Cash-and-Carry"),s("span",{class:"card-subtitle"},"Прибыльные позиции при отклонении от справедливого базиса")],-1)),s("div",Vxe,[s("table",Hxe,[t[53]||(t[53]=s("thead",null,[s("tr",null,[s("th",null,"Tenor"),s("th",null,"Спот цена"),s("th",null,"Форвардная цена"),s("th",null,"Справедливый базис"),s("th",null,"Рыночный базис"),s("th",null,"Неправильная оценка"),s("th",null,"Стратегия"),s("th",null,"Потенциальная прибыль")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(h.value,e=>(w(),i("tr",{key:e.tenor,class:c(e.strategy.toLowerCase())},[s("td",Gxe,v(e.tenor),1),s("td",Wxe,v(_(e.spotPrice)),1),s("td",qxe,v(_(e.forwardPrice)),1),s("td",Yxe,v(e.fairBasis.toFixed(4)),1),s("td",jxe,v(e.marketBasis.toFixed(4)),1),s("td",{class:c(["mispricing mono",Math.abs(e.mispricing)>.001?"significant":""])},v(e.mispricing>=0?"+":"")+v(e.mispricing.toFixed(4)),3),s("td",{class:c(["strategy",e.strategy.toLowerCase()])},v(e.strategy),3),s("td",Xxe,v(M(e.profitPotential)),1)],2))),128))])])])]),s("div",$xe,[t[64]||(t[64]=s("div",{class:"card-header"},[s("h3",null,"Резюме рисков базиса"),s("span",{class:"card-subtitle"},"Риски, связанные с движением базиса")],-1)),s("div",Kxe,[s("div",Zxe,[t[56]||(t[56]=s("div",{class:"risk-header"},[s("span",{class:"risk-type"},"Convergence Risk"),s("span",{class:"risk-level high"},"HIGH")],-1)),t[57]||(t[57]=s("div",{class:"risk-description"}," Базис конвергирует к нулю при экспирации форварда. Если вы позиционированы против конвергенции, вы потеряете на сходимости. ",-1)),s("div",Jxe,[t[55]||(t[55]=s("span",null,"Convergence P&L @ Expiry:",-1)),s("span",Qxe,v(M(-l.value.basis*l.value.contractSize/100)),1)])]),s("div",ewe,[t[59]||(t[59]=s("div",{class:"risk-header"},[s("span",{class:"risk-type"},"Риск Carry Roll"),s("span",{class:"risk-level medium"},"СРЕДНИЙ")],-1)),t[60]||(t[60]=s("div",{class:"risk-description"}," Базис следующего контракта может отличаться. Roll yield может быть хуже ожиданий. ",-1)),s("div",twe,[t[58]||(t[58]=s("span",null,"1M Roll Impact:",-1)),s("span",{class:c(["value",l.value.rollYield>=0?"positive":"negative"])},v(l.value.rollYield>=0?"+":"")+v(M(l.value.rollYield*l.value.contractSize/100)),3)])]),s("div",awe,[t[62]||(t[62]=s("div",{class:"risk-header"},[s("span",{class:"risk-type"},"Риск стоимости финансирования"),s("span",{class:"risk-level medium"},"СРЕДНИЙ")],-1)),t[63]||(t[63]=s("div",{class:"risk-description"}," Стоимость финансирования может вырасти, уменьшив доходность carry стратегии. ",-1)),s("div",nwe,[t[61]||(t[61]=s("span",null,"Влияние ставки +50bp:",-1)),s("span",rwe,v(M(-l.value.contractSize*l.value.termLength*50/365/1e4)),1)])])])]),t[65]||(t[65]=s("div",{class:"page-footer"},[s("span",null,"• Модель: Cost-of-Carry with convenience yield"),s("span",null,"• Частота: Ежедневно"),s("span",null,"• Обновление: Конец дня")],-1))]))}}),owe=xe(iwe,[["__scopeId","data-v-367ebc1e"]]),swe={class:"volatility-surface-page"},lwe={class:"page-header"},cwe={class:"header-right"},uwe={class:"control-group"},dwe={class:"control-group"},hwe={class:"control-group checkbox"},pwe={class:"control-group checkbox"},fwe={class:"control-group"},mwe={class:"select-selected"},vwe={class:"select-text"},gwe={key:0,class:"select-options"},ywe=["onClick"],bwe={style:{flex:"1",display:"flex","flex-direction":"column",gap:"2px"}},xwe={class:"option-text"},wwe={class:"option-subtext"},_we={key:0,class:"option-badge"},Swe={key:0,class:"card full-width",style:{"margin-bottom":"24px",background:"rgba(239, 68, 68, 0.1)","border-color":"rgba(239, 68, 68, 0.3)"}},Mwe={style:{padding:"12px",color:"rgba(239, 68, 68, 0.9)","font-size":"13px"}},Twe={key:1,class:"card full-width",style:{"margin-bottom":"24px"}},kwe={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},Cwe={class:"card-subtitle"},Awe={style:{display:"flex",gap:"8px"}},Ewe=["disabled"],Iwe={key:0},Rwe={key:1},Dwe=["disabled"],Pwe=["disabled"],Lwe={key:0},Nwe={key:1},Owe={class:"scenario-table-container"},Fwe={class:"scenario-table"},Bwe=["onClick"],Uwe={class:"mono"},zwe={class:"mono"},Vwe={class:"mono accent"},Hwe=["onClick"],Gwe={class:"three-d-container"},Wwe={class:"grid-4"},qwe={class:"stat-card"},Ywe={class:"stat-value accent"},jwe={class:"stat-detail"},Xwe={class:"value"},$we={class:"stat-card"},Kwe={class:"stat-detail"},Zwe={class:"value"},Jwe={class:"stat-card"},Qwe={class:"stat-value cyan"},e_e={class:"stat-detail"},t_e={class:"value"},a_e={class:"stat-card"},n_e={class:"stat-value green"},r_e={class:"stat-detail"},i_e={class:"value"},o_e={class:"card full-width"},s_e={class:"surface-matrix-container"},l_e={class:"surface-matrix-table"},c_e={class:"strike-label"},u_e={class:"vol-value"},d_e={class:"grid-2"},h_e={class:"card"},p_e={class:"chart-container"},f_e={class:"card"},m_e={class:"chart-container"},v_e={class:"card full-width"},g_e={class:"chart-container tall"},y_e={class:"grid-2"},b_e={class:"card"},x_e={class:"chart-container"},w_e={class:"card"},__e={class:"chart-container"},S_e={class:"card full-width"},M_e={class:"info-grid"},T_e={class:"info-item"},k_e={class:"value"},C_e={class:"info-item"},A_e={class:"value"},E_e={class:"info-item"},I_e={class:"value mono"},R_e={class:"info-item"},D_e={class:"value mono"},P_e={class:"info-item"},L_e={class:"value mono"},N_e={class:"info-item"},O_e={class:"value mono"},F_e={class:"info-item"},B_e={class:"value"},U_e=e({__name:"VolatilitySurface",setup(e){const a=t("spy"),r=t("sabr"),o=t(!1),d=t(!0),m=t(!1),g=t(!1),b=t((new Date).toISOString().split("T")[0]),x=t(null),_=t([]),S=t(null),C=t(!1),I=t(!1),R=t(""),D=[{value:"bsm",label:"Black-Scholes",icon:"BS",iconClass:"icon-bsm",description:"Классическая модель"},{value:"heston",label:"Heston",icon:"H",iconClass:"icon-heston",description:"Стохастическая волатильность"},{value:"merton",label:"Merton",icon:"M",iconClass:"icon-merton",description:"Модель скачков"},{value:"bates",label:"Bates",icon:"B",iconClass:"icon-bates",description:"Heston + Скачки"},{value:"sabr",label:"SABR",icon:"S",iconClass:"icon-sabr",description:"Stochastic Alpha Beta Rho"},{value:"vg",label:"Variance Gamma",icon:"VG",iconClass:"icon-vg",description:"VG Process"}],P=e=>{const t=D.find(t=>t.value===e);return t?.label||"SABR"},N=e=>{const t=D.find(t=>t.value===e);return t?.icon||"S"},O=e=>{const t=D.find(t=>t.value===e);return t?.iconClass||"icon-sabr"},F=()=>{o.value=!o.value},B=e=>{e.target.closest(".custom-select-wrapper")||(o.value=!1)},U=t(null);let V=null,H=null,G=null,W=null,q=null;const Y=["1M","3M","6M","1Y","2Y","3Y"],j=[.7,.8,.9,.95,1,1.05,1.1,1.2,1.3],X=t("4850.25"),$=t(.158),K=t(.162),Z=t(-.035),J=t(-.025),Q=t(.008),ee=t("Upward"),te=t(.068),ae=t(.045),ne=t(.0425),ie=t(.018),oe=t(.041),se=t("14:35:22 UTC"),le=t("LIVE"),ce=t(null),ue=t(null),de=t(null),he=t(null),pe=t(null);let fe={};const me=(e,t="sabr")=>{const a=[];let n=.15,r=.8,i=-.3,o=.04,s=-.05;"eur"===e?(n=.08,i=-.15,o=.02):"brent"===e?(n=.35,i=.1,o=.06):"rates"===e&&(n=.012,r=.5,i=-.5,o=.01);for(let l=0;l<j.length;l++){const e=[],c=j[l],u=Math.log(c);for(let a=0;a<Y.length;a++){const l=[1/12,.25,.5,1,2,3][a],c=Math.sqrt(l),d=1;let h=.15;if("bsm"===t){h=n*(u<0?1+-.3*u:1+-.15*u)*(1+.03*(1-l))}else if("heston"===t){const e=o+(.04-o)*(1-Math.exp(-3*l)),t=u<0?1+-.4*u*(1+.5*i):1+-.2*u*(1+.5*i);h=Math.sqrt(e)*t}else if("merton"===t){const e=.1*(Math.exp(s+.01125)-1);h=Math.sqrt(n*n+.1*.025)*(u<0?1+-.5*u:1+-.25*u)*(1+e*l)}else if("bates"===t){const e=o+(.04-o)*(1-Math.exp(-3*l)),t=.1*(Math.exp(s+.01125)-1),a=u<0?1+-.45*u*(1+.5*i):1+-.25*u*(1+.5*i);h=Math.sqrt(e)*a*(1+t*l*.5)}else if("sabr"===t){h=n*Math.pow(d,r-1)*(u<0?1+-.4*u:1+-.2*u)*(1+.05*(1-l))*(1+.15*Math.abs(u))/c}else if("vg"===t){const e=-.08;h=Math.sqrt(n*n+.13333333333333336)*(u<0?1+-.35*u*1.3:1+-.18*u*1.3)*(1+.04*(1-l))*(1+e*l)}e.push(Math.max(.05,Math.min(1,h)))}a.push(e)}return a};let ve=me("spy","sabr");const ge=(e,t)=>{const a=j.indexOf(e),n=Y.indexOf(t);return a>=0&&n>=0?ve[a][n]:.15};let ye=null;const be=()=>{if(!V)return;ye&&V.remove(ye),ye=new VS,ye.name="sceneContainer";const e=new hS,t=[],a=[],n=[];for(let i=0;i<j.length;i++)for(let e=0;e<Y.length;e++){const a=10*(i/j.length-.5),r=15*ve[i][e],o=8*(e/Y.length-.5);t.push(a,r,o);const s=ve[i][e];s<.1?n.push(.29,.87,.5):s<.15?n.push(.38,.65,1):s<.2?n.push(.96,.62,.04):n.push(.97,.44,.44)}for(let i=0;i<j.length-1;i++)for(let e=0;e<Y.length-1;e++){const t=i*Y.length+e,n=t+1,r=(i+1)*Y.length+e,o=r+1;a.push(t,n,r),a.push(n,o,r)}e.setAttribute("position",new tS(new Float32Array(t),3)),e.setAttribute("color",new tS(new Float32Array(n),3)),e.setIndex(new tS(new Uint32Array(a),1)),e.computeVertexNormals();const r=new lT({vertexColors:!0,wireframe:m.value,flatShading:!1,emissive:1710618,shininess:30});if(W=new MS(e,r),ye.add(W),d.value){const e=new AT(12,12,4473924,2236962);e.position.y=-.5,e.rotation.x=0,ye.add(e);const t=new AT(12,12,4473924,2236962);t.position.z=-6,t.rotation.x=Math.PI/2,ye.add(t);const a=new AT(12,12,4473924,2236962);a.position.x=-6,a.rotation.z=Math.PI/2,ye.add(a)}xe(ye),V.add(ye)},xe=e=>{const t=new VS;t.name="axesGroup";const a=new rw(-6,0,-6);t.position.copy(a);const n=12,r=.3,i=.2,o=16777215,s=new xM({color:o,linewidth:3}),l=new xM({color:o,linewidth:1}),c=(e,t)=>{const a=document.createElement("canvas");a.width=1024,a.height=512;const n=a.getContext("2d");n.fillStyle="#ffffff",n.font="bold 72px Arial",n.textAlign="center",n.textBaseline="middle",n.fillText(e,512,256);const r=new zM(a),i=new $S({map:r}),o=new cM(i);return o.scale.set(5,2.5,1),o.position.copy(t),o},u=(e,t)=>{const a=document.createElement("canvas");a.width=1024,a.height=512;const n=a.getContext("2d");n.fillStyle="#ffffff",n.font="bold 96px Arial",n.textAlign="center",n.textBaseline="middle",n.fillText(e,512,256);const r=new zM(a),i=new $S({map:r}),o=new cM(i);return o.scale.set(7,3.5,1),o.position.copy(t),o},d=new hS;d.setAttribute("position",new tS(new Float32Array([0,0,0,n,0,0]),3));const h=new AM(d,s);t.add(h);const p=new qM(.105,r,8),f=new Z_({color:o}),m=new MS(p,f);m.position.set(12.15,0,0),m.rotation.z=-Math.PI/2,t.add(m);for(let P=0;P<=6;P++){const e=P/6*n,a=new hS;a.setAttribute("position",new tS(new Float32Array([e,-.2,0,e,i,0]),3));const r=new AM(a,l);t.add(r);const o=c((100*(j[Math.floor(P/6*(j.length-1))]-1)).toFixed(0)+"%",new rw(e,-.8,0));t.add(o)}const v=u("Strike (%)",new rw(6,-2.5,0));t.add(v);const g=new hS;g.setAttribute("position",new tS(new Float32Array([0,0,0,0,n,0]),3));const y=new AM(g,s);t.add(y);const b=new qM(.105,r,8),x=new Z_({color:o}),w=new MS(b,x);w.position.set(0,12.15,0),t.add(w);const _=100*Math.max(...ve.flat());for(let P=0;P<=6;P++){const e=P/6*n,a=new hS;a.setAttribute("position",new tS(new Float32Array([-.2,e,0,i,e,0]),3));const r=new AM(a,l);t.add(r);const o=c((e/n*_).toFixed(1)+"%",new rw(-.8,e,0));t.add(o)}const S=u("IV (%)",new rw(-2.5,6,0));t.add(S);const M=new hS;M.setAttribute("position",new tS(new Float32Array([0,0,0,0,0,n]),3));const T=new AM(M,s);t.add(T);const k=new qM(.105,r,8),C=new Z_({color:o}),A=new MS(k,C);A.position.set(0,0,11.85),A.rotation.x=Math.PI/2,t.add(A);for(let P=0;P<=6;P++){const e=P/6*n,a=new hS;a.setAttribute("position",new tS(new Float32Array([-.2,0,e,i,0,e]),3));const r=new AM(a,l);t.add(r);const o=Math.floor(P/6*(Y.length-1)),s=c(Y[o],new rw(0,-.8,e));t.add(s)}const E=u("Tenor",new rw(0,-2.5,6));t.add(E);const I=new oT(.12,12,12),R=new Z_({color:o}),D=new MS(I,R);t.add(D),e.add(t)},we=()=>{if(!U.value||!H||!ye)return;let e=!1,t=!1,a={x:0,y:0};const n=new rw(0,0,0);U.value.addEventListener("mousedown",n=>{0===n.button?(e=!0,a={x:n.clientX,y:n.clientY},U.value.style.cursor="grabbing"):2===n.button&&(t=!0,a={x:n.clientX,y:n.clientY},U.value.style.cursor="move")}),U.value.addEventListener("mousemove",r=>{if(e&&H){((e,t)=>{if(!H)return;const a=new CT;a.setFromVector3(H.position.clone().sub(n)),a.theta-=.01*e,a.phi+=.01*t,a.phi=Math.max(.1,Math.min(Math.PI-.1,a.phi));const r=new rw;r.setFromSpherical(a),r.add(n),H.position.copy(r),H.lookAt(n)})(r.clientX-a.x,r.clientY-a.y),a={x:r.clientX,y:r.clientY}}else if(t&&H){((e,t)=>{if(!H)return;const a=new rw;H.getWorldDirection(a);const r=new rw;r.crossVectors(a,H.up).normalize();const i=new rw;i.crossVectors(r,a).normalize();const o=.01*H.position.distanceTo(n);n.add(r.multiplyScalar(-e*o)),n.add(i.multiplyScalar(t*o)),H.position.add(r.multiplyScalar(-e*o)),H.position.add(i.multiplyScalar(t*o)),H.lookAt(n)})(r.clientX-a.x,r.clientY-a.y),a={x:r.clientX,y:r.clientY}}}),U.value.addEventListener("mouseup",()=>{e=!1,t=!1,U.value.style.cursor="default"}),U.value.addEventListener("mouseleave",()=>{e=!1,t=!1,U.value.style.cursor="default"}),U.value.addEventListener("contextmenu",e=>{e.preventDefault()}),U.value.addEventListener("wheel",e=>{e.preventDefault();(e=>{if(!H)return;const t=new rw;t.subVectors(H.position,n).normalize();const a=H.position.distanceTo(n),r=a+.1*e*a;r>=5&&r<=50&&(H.position.add(t.multiplyScalar(.1*e*a)),H.lookAt(n))})(e.deltaY>0?1:-1)})},_e=()=>{ve=me(a.value,r.value),be(),ke()},Se=()=>{be()},Me=()=>{H&&ye&&(H.position.set(12,12,12),H.lookAt(0,0,0),ye&&ye.rotation.set(0,0,0))},Te=()=>{g.value=!g.value},ke=()=>{Ce(),Ae(),Ee(),Ie(),Re()},Ce=()=>{if(!ce.value)return;const e=ce.value.getContext("2d");if(!e)return;fe.smile?.destroy();const t=j.map(e=>(100*(e-1)).toFixed(0)+"%"),a=[{label:"1M",data:ve.map(e=>100*e[0]),borderColor:"#60a5fa",backgroundColor:"rgba(96,165,250,0.1)",tension:.4},{label:"6M",data:ve.map(e=>100*e[2]),borderColor:"#f59e0b",backgroundColor:"rgba(245,158,11,0.1)",tension:.4},{label:"2Y",data:ve.map(e=>100*e[4]),borderColor:"#ec4899",backgroundColor:"rgba(236,72,153,0.1)",tension:.4}];fe.smile=new re(e,{type:"line",data:{labels:t,datasets:a},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}},title:{display:!0,text:"Volatility Smile (by Tenor)",color:"rgba(255,255,255,0.6)",font:{size:12,weight:"bold"},padding:{bottom:10}}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"Strike (%)",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"IV (%)",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}}}}})},Ae=()=>{if(!ue.value)return;const e=ue.value.getContext("2d");if(!e)return;fe.term?.destroy();const t=[{label:"ITM 80%",data:ve[1].map(e=>100*e),borderColor:"#4ade80",tension:.3},{label:"ATM",data:ve[4].map(e=>100*e),borderColor:"#fbbf24",tension:.3},{label:"OTM 120%",data:ve[7].map(e=>100*e),borderColor:"#f87171",tension:.3}];fe.term=new re(e,{type:"line",data:{labels:Y,datasets:t},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255,255,255,0.6)"}},title:{display:!0,text:"Term Structure (by Moneyness)",color:"rgba(255,255,255,0.6)",font:{size:12,weight:"bold"},padding:{bottom:10}}},scales:{x:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"Tenor",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"IV (%)",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}}}}})},Ee=()=>{if(!de.value)return;const e=de.value.getContext("2d");if(!e)return;fe.heatmap?.destroy();const t=[];for(let a=0;a<j.length;a++)for(let e=0;e<Y.length;e++)t.push({x:e,y:a,v:100*ve[a][e]});fe.heatmap=new re(e,{type:"bubble",data:{datasets:[{label:"IV",data:t.map(e=>({x:e.x,y:e.y,r:e.v/2})),backgroundColor:t.map(e=>{const t=e.v;return t<10?"rgba(74,222,128,0.8)":t<15?"rgba(96,165,250,0.8)":t<20?"rgba(245,158,11,0.8)":"rgba(248,113,113,0.8)"})}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"2D Heatmap: Strike × Tenor",color:"rgba(255,255,255,0.6)",font:{size:12,weight:"bold"},padding:{bottom:10}}},scales:{x:{min:-.5,max:5.5,grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10},callback:function(e){return Y[e]||""}},title:{display:!0,text:"Tenor",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}},y:{min:-.5,max:8.5,grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10},callback:function(e){const t=Math.round(e);return t>=0&&t<j.length?(100*(j[t]-1)).toFixed(0)+"%":""}},title:{display:!0,text:"Strike (%)",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}}}}})},Ie=()=>{if(!he.value)return;const e=he.value.getContext("2d");if(!e)return;fe.vega?.destroy();const t=j.map(e=>(100*(e-1)).toFixed(0)+"%"),a=ve.map((e,t)=>{const a=j[t],n=e[2],r=(Math.log(1/a)+.5*n*n*.5)/(n*Math.sqrt(.5)),i=1/Math.sqrt(2*Math.PI)*Math.exp(-.5*r*r);return 1*Math.sqrt(.5)*i*100});fe.vega=new re(e,{type:"bar",data:{labels:t,datasets:[{label:"Vega (6M)",data:a,backgroundColor:"rgba(96,165,250,0.6)",borderColor:"#60a5fa",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Vega (by Strike & Tenor)",color:"rgba(255,255,255,0.6)",font:{size:12,weight:"bold"},padding:{bottom:10}}},scales:{x:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"Strike (%)",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"Vega",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}}}}})},Re=()=>{if(!pe.value)return;const e=pe.value.getContext("2d");if(!e)return;fe.convexity?.destroy();const t=j.map(e=>(100*(e-1)).toFixed(0)+"%"),a=ve.map((e,t)=>{const a=t>0?ve[t-1][2]:e[2],n=t<j.length-1?ve[t+1][2]:e[2];return 1e4*(a-2*e[2]+n)});fe.convexity=new re(e,{type:"line",data:{labels:t,datasets:[{label:"Convexity",data:a,borderColor:"#ec4899",backgroundColor:"rgba(236,72,153,0.1)",tension:.3,pointRadius:3}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Volatility Convexity",color:"rgba(255,255,255,0.6)",font:{size:12,weight:"bold"},padding:{bottom:10}}},scales:{x:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"Strike (%)",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)",font:{size:10}},title:{display:!0,text:"Convexity",color:"rgba(255,255,255,0.6)",font:{size:11,weight:"bold"}}}}}})},De=async e=>{const t=e.target,a=t.files?.[0];if(a)try{const e=pj(await a.arrayBuffer(),{type:"array"}),t=e.SheetNames[0],n=e.Sheets[t],r=Rj.sheet_to_json(n,{raw:!1}),i=[];for(const a of r){const e={instrument:a.Instrument||a.instrument||a["Инструмент"]||a.Symbol||a.symbol||"SPY",strike:parseFloat(a.Strike||a.strike||a["Страйк"]||a.K||"1.0"),tenor:a.Tenor||a.tenor||a["Срок"]||a.Maturity||a.maturity||"1M",iv:parseFloat(a.IV||a.iv||a.Volatility||a.volatility||a["Волатильность"]||a["σ"]||"0.15")};e.instrument&&e.strike>0&&i.push(e)}_.value=i,S.value=null}catch(n){console.error("Excel parsing error:",n),alert(`Ошибка при загрузке файла: ${n.message}`)}},Pe=async()=>{C.value=!0,setTimeout(()=>{C.value=!1},1e3)},Le=()=>{if(0===_.value.length)return;const e=_.value.map((e,t)=>({"№":t+1,"Инструмент":e.instrument||"",Strike:e.strike||0,"Срок":e.tenor||"","IV (%)":e.iv||0})),t=Rj.json_to_sheet(e),a=Rj.book_new();Rj.book_append_sheet(a,t,"Реестр контрактов");bj(a,`реестр_поверхности_волатильности_${(new Date).toISOString().split("T")[0]}.xlsx`)},Ne=async()=>{if(0!==_.value.length){I.value=!0,R.value="";try{const e=await E6(_.value,"volatility_surface");e.success&&(R.value=`Реестр успешно сохранен: ${e.data.file_name}`,setTimeout(()=>{R.value=""},5e3))}catch(e){console.error("Error saving registry to parquet:",e),R.value=`Ошибка при сохранении реестра: ${e.message}`}finally{I.value=!1}}},Oe=()=>{_.value=[],S.value=null,x.value&&(x.value.value="")};return n(async()=>{await A(),(()=>{if(!U.value)return;const e=U.value.clientWidth,t=U.value.clientHeight;V=new qS,V.background=new j_(988185),H=new OS(75,e/t,.1,1e3),H.position.set(12,12,12),H.lookAt(0,0,0),G=new AA({canvas:U.value,antialias:!0,alpha:!0}),G.setSize(e,t),G.setPixelRatio(window.devicePixelRatio);const a=new wT(16777215,.6);V.add(a);const n=new xT(16777215,.8);n.position.set(10,15,10),V.add(n),be(),we();const r=()=>{q=requestAnimationFrame(r),g.value&&W&&(W.rotation.y+=.003),G?.render(V,H)};r()})(),ke(),document.addEventListener("click",B)}),z(()=>{document.removeEventListener("click",B)}),z(()=>{q&&cancelAnimationFrame(q),Object.values(fe).forEach(e=>e?.destroy()),G?.dispose()}),(e,t)=>(w(),i("div",swe,[s("div",lwe,[t[10]||(t[10]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"Поверхность волатильности"),s("p",{class:"page-subtitle"},"3D поверхность волатильности: Moneyness × Срок × IV")],-1)),s("div",cwe,[s("div",uwe,[t[4]||(t[4]=s("label",{class:"control-label"},"Дата оценки:",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),type:"date",class:"date-input",onChange:_e},null,544),[[k,b.value]])]),s("div",dwe,[t[5]||(t[5]=s("label",{class:"control-label"},"Реестр:",-1)),s("input",{type:"file",ref_key:"fileInputRef",ref:x,onChange:De,accept:".xlsx,.xls",style:{display:"none"},id:"excel-upload"},null,544),s("button",{onClick:t[1]||(t[1]=()=>{x.value&&x.value.click()}),class:"btn-secondary",title:"Загрузить реестр из Excel"}," Загрузить Excel ")]),s("div",hwe,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e),onChange:Se,id:"grid-check"},null,544),[[L,d.value]]),t[6]||(t[6]=s("label",{for:"grid-check"},"Сетка",-1))]),s("div",pwe,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>m.value=e),onChange:Se,id:"wire-check"},null,544),[[L,m.value]]),t[7]||(t[7]=s("label",{for:"wire-check"},"Каркас",-1))]),s("button",{onClick:Te,class:"btn-primary"},v(g.value?"⏸ Стоп":"▶ Вращение"),1),s("button",{onClick:Me,class:"btn-secondary"},"↺ Сброс"),s("div",fwe,[t[9]||(t[9]=s("label",{class:"control-label"},"Модель:",-1)),s("div",{class:"custom-select-wrapper",onClick:F},[s("div",{class:c(["custom-select",{open:o.value}])},[s("div",mwe,[s("span",{class:c(["select-icon",O(r.value)])},v(N(r.value)),3),s("span",vwe,v(P(r.value)),1),t[8]||(t[8]=s("svg",{class:"select-arrow",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"6 9 12 15 18 9"})],-1))]),u(M,{name:"dropdown"},{default:h(()=>[o.value?(w(),i("div",gwe,[(w(),i(p,null,f(D,e=>s("div",{key:e.value,class:c(["select-option",{selected:r.value===e.value}]),onClick:E(t=>(e=>{r.value=e,o.value=!1,_e()})(e.value),["stop"])},[s("span",{class:c(["option-icon",e.iconClass])},v(e.icon),3),s("div",bwe,[s("span",xwe,v(e.label),1),s("span",wwe,v(e.description),1)]),r.value===e.value?(w(),i("span",_we,"✓")):l("",!0)],10,ywe)),64))])):l("",!0)]),_:1})],2)])])])]),R.value?(w(),i("div",Swe,[s("div",Mwe,v(R.value),1)])):l("",!0),_.value.length>0?(w(),i("div",Twe,[s("div",kwe,[s("div",null,[t[11]||(t[11]=s("h3",null,"Реестр контрактов",-1)),s("span",Cwe,"Загружено контрактов: "+v(_.value.length),1)]),s("div",Awe,[s("button",{onClick:Pe,class:"btn-secondary",disabled:C.value,style:{"font-size":"11px",padding:"6px 12px"}},[C.value?(w(),i("span",Rwe,"↺ Считаю...")):(w(),i("span",Iwe,"Рассчитать все"))],8,Ewe),s("button",{onClick:Le,class:"btn-secondary",disabled:0===_.value.length,style:{"font-size":"11px",padding:"6px 12px"},title:"Выгрузить реестр в Excel"}," 📥 Выгрузить Excel ",8,Dwe),s("button",{onClick:Ne,class:"btn-secondary",disabled:0===_.value.length||I.value,style:{"font-size":"11px",padding:"6px 12px"},title:"Сохранить реестр в Parquet"},[I.value?(w(),i("span",Nwe,"↺ Сохранение...")):(w(),i("span",Lwe,"💾 Сохранить в DB"))],8,Pwe),s("button",{onClick:Oe,class:"btn-secondary",style:{"font-size":"11px",padding:"6px 12px",background:"rgba(239, 68, 68, 0.2)","border-color":"rgba(239, 68, 68, 0.3)"}}," ✕ Очистить ")])]),s("div",Owe,[s("table",Fwe,[t[12]||(t[12]=s("thead",null,[s("tr",null,[s("th",null,"№"),s("th",null,"Инструмент"),s("th",null,"Strike"),s("th",null,"Срок"),s("th",null,"IV (%)"),s("th",null,"Действие")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(_.value,(e,t)=>(w(),i("tr",{key:t,class:c({selected:S.value===t}),onClick:e=>(e=>{S.value=e})(t)},[s("td",null,v(t+1),1),s("td",null,v(e.instrument||"N/A"),1),s("td",Uwe,v(e.strike?e.strike.toFixed(2):"-"),1),s("td",zwe,v(e.tenor||"-"),1),s("td",Vwe,v(e.iv?(100*e.iv).toFixed(2)+"%":"-"),1),s("td",null,[s("button",{onClick:E(e=>(e=>{const t=_.value[e];t&&(a.value=t.instrument.toLowerCase()||"spy",setTimeout(()=>{_e()},100))})(t),["stop"]),class:"btn-small",title:"Загрузить в форму"}," Загрузить ",8,Hwe)])],10,Bwe))),128))])])])])):l("",!0),s("div",Gwe,[s("canvas",{ref_key:"threeCanvas",ref:U,class:"three-canvas"},null,512),t[13]||(t[13]=s("div",{class:"controls-overlay"},[s("div",{class:"controls-hint"},[s("p",null,"Перетащите для вращения | Прокрутка для масштаба | ПКМ для перемещения")])],-1))]),s("div",Wwe,[s("div",qwe,[t[15]||(t[15]=s("div",{class:"stat-header"},[s("h3",null,"ATM Volatility"),s("span",{class:"stat-unit"},"Волатильность ATM")],-1)),s("div",Ywe,v((100*$.value).toFixed(2))+"%",1),s("div",jwe,[t[14]||(t[14]=s("span",{class:"label"},"3M",-1)),s("span",Xwe,v((100*K.value).toFixed(2))+"%",1)])]),s("div",$we,[t[17]||(t[17]=s("div",{class:"stat-header"},[s("h3",null,"Skew (25 Delta)"),s("span",{class:"stat-unit"},"Асимметрия улыбки")],-1)),s("div",{class:c(["stat-value",Z.value>=0?"positive":"negative"])},v(Z.value>=0?"+":"")+v((100*Z.value).toFixed(2))+"% ",3),s("div",Kwe,[t[16]||(t[16]=s("span",{class:"label"},"Put - Call",-1)),s("span",Zwe,v(J.value>=0?"+":"")+v((100*J.value).toFixed(1))+"%",1)])]),s("div",Jwe,[t[19]||(t[19]=s("div",{class:"stat-header"},[s("h3",null,"Term Structure"),s("span",{class:"stat-unit"},"Структура по срокам")],-1)),s("div",Qwe,v((100*Q.value).toFixed(2))+"% ",1),s("div",e_e,[t[18]||(t[18]=s("span",{class:"label"},"1M vs 12M",-1)),s("span",t_e,v(ee.value),1)])]),s("div",a_e,[t[21]||(t[21]=s("div",{class:"stat-header"},[s("h3",null,"Vol of Vol"),s("span",{class:"stat-unit"},"Волатильность волатильности")],-1)),s("div",n_e,v((100*te.value).toFixed(2))+"%",1),s("div",r_e,[t[20]||(t[20]=s("span",{class:"label"},"Реализованная",-1)),s("span",i_e,v((100*ae.value).toFixed(2))+"%",1)])])]),s("div",o_e,[t[23]||(t[23]=s("div",{class:"card-header"},[s("h3",null,"Volatility Surface Matrix"),s("span",{class:"card-subtitle"},"Таблица IV по страйкам и срокам")],-1)),s("div",s_e,[s("table",l_e,[s("thead",null,[s("tr",null,[t[22]||(t[22]=s("th",{class:"header-label"},"Strike / Срок",-1)),(w(),i(p,null,f(Y,e=>s("th",{key:e},v(e),1)),64))])]),s("tbody",null,[(w(),i(p,null,f(j,e=>s("tr",{key:e},[s("td",c_e,v((100*(e-1)).toFixed(0))+"%",1),(w(),i(p,null,f(Y,t=>{return s("td",{key:t,class:"vol-cell",style:y({backgroundColor:(a=ge(e,t),a<.1?"rgba(74, 222, 128, 0.7)":a<.15?"rgba(96, 165, 250, 0.7)":a<.2?"rgba(245, 158, 11, 0.7)":a<.25?"rgba(248, 113, 113, 0.7)":"rgba(239, 68, 68, 0.7)")})},[s("span",u_e,v((100*ge(e,t)).toFixed(1))+"%",1)],4);var a}),64))])),64))])])])]),s("div",d_e,[s("div",h_e,[t[24]||(t[24]=s("div",{class:"chart-header"},[s("h3",null,"Volatility Smile (по срокам)"),s("span",{class:"chart-subtitle"},"Кривая улыбки для разных сроков")],-1)),s("div",p_e,[s("canvas",{ref_key:"smileChartRef",ref:ce},null,512)])]),s("div",f_e,[t[25]||(t[25]=s("div",{class:"chart-header"},[s("h3",null,"Term Structure (по Moneyness)"),s("span",{class:"chart-subtitle"},"Временная структура для разных страйков")],-1)),s("div",m_e,[s("canvas",{ref_key:"termChartRef",ref:ue},null,512)])])]),s("div",v_e,[t[26]||(t[26]=s("div",{class:"chart-header"},[s("h3",null,"2D Heatmap: Strike × Срок"),s("span",{class:"chart-subtitle"},"Тепловая карта волатильности")],-1)),s("div",g_e,[s("canvas",{ref_key:"heatmapChartRef",ref:de},null,512)])]),s("div",y_e,[s("div",b_e,[t[27]||(t[27]=s("div",{class:"chart-header"},[s("h3",null,"Vega (по Strike и сроку)"),s("span",{class:"chart-subtitle"},"Чувствительность к волатильности")],-1)),s("div",x_e,[s("canvas",{ref_key:"vegaChartRef",ref:he},null,512)])]),s("div",w_e,[t[28]||(t[28]=s("div",{class:"chart-header"},[s("h3",null,"Выпуклость волатильности"),s("span",{class:"chart-subtitle"},"Кривизна поверхности")],-1)),s("div",__e,[s("canvas",{ref_key:"convexityChartRef",ref:pe},null,512)])])]),s("div",S_e,[t[37]||(t[37]=s("div",{class:"card-header"},[s("h3",null,"Рыночные параметры"),s("span",{class:"card-subtitle"},"Текущие рыночные данные")],-1)),s("div",M_e,[s("div",T_e,[t[29]||(t[29]=s("span",{class:"label"},"Последнее обновление",-1)),s("span",k_e,v(se.value),1)]),s("div",C_e,[t[30]||(t[30]=s("span",{class:"label"},"Статус рынка",-1)),s("span",A_e,v(le.value),1)]),s("div",E_e,[t[31]||(t[31]=s("span",{class:"label"},"Spot Price",-1)),s("span",I_e,v(X.value),1)]),s("div",R_e,[t[32]||(t[32]=s("span",{class:"label"},"Безрисковая ставка",-1)),s("span",D_e,v((100*ne.value).toFixed(2))+"%",1)]),s("div",P_e,[t[33]||(t[33]=s("span",{class:"label"},"Див. доходность",-1)),s("span",L_e,v((100*ie.value).toFixed(2))+"%",1)]),s("div",N_e,[t[34]||(t[34]=s("span",{class:"label"},"Repo Rate",-1)),s("span",O_e,v((100*oe.value).toFixed(2))+"%",1)]),s("div",F_e,[t[35]||(t[35]=s("span",{class:"label"},"Модель поверхности",-1)),s("span",B_e,v(P(r.value)),1)]),t[36]||(t[36]=s("div",{class:"info-item"},[s("span",{class:"label"},"Калибровка"),s("span",{class:"value"},"Least Squares + Regularization")],-1))])]),t[38]||(t[38]=s("div",{class:"page-footer"},[s("span",null,"• Источник: Bloomberg Terminal / Broker Data"),s("span",null,"• Частота: Обновления в реальном времени"),s("span",null,"• Последняя синхронизация: 15с назад")],-1))]))}}),z_e=xe(U_e,[["__scopeId","data-v-de2ad5d5"]]),V_e={class:"ccmv-page"},H_e={class:"method-selector"},G_e={class:"hero-section"},W_e={class:"hero-left"},q_e={class:"hero-meta"},Y_e={class:"glass-pill"},j_e={class:"glass-pill"},X_e={class:"glass-pill"},$_e={class:"hero-actions"},K_e=["disabled"],Z_e={key:0,width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},J_e={key:1,class:"spinner"},Q_e={class:"glass-panel hjb-params-row"},eSe={class:"panel-body params-row-body"},tSe={class:"param-group-horizontal"},aSe={class:"param-input-group"},nSe={class:"param-group-horizontal"},rSe={class:"param-input-group"},iSe={class:"param-group-horizontal"},oSe={class:"param-input-group"},sSe={class:"param-group-horizontal"},lSe={class:"param-input-group"},cSe={class:"param-group-horizontal"},uSe={class:"param-input-group"},dSe={class:"param-group-horizontal"},hSe={class:"param-input-group"},pSe={class:"dashboard-grid hjb-grid"},fSe={class:"col-portfolio-wide"},mSe={class:"glass-panel portfolio-composition-panel"},vSe={class:"panel-body weights-body"},gSe={class:"weights-comparison"},ySe={class:"weights-table-container"},bSe={class:"weights-table"},xSe={class:"asset-cell"},wSe={class:"asset-info"},_Se={class:"symbol"},SSe={class:"name"},MSe={class:"text-right mono"},TSe={class:"text-right mono"},kSe={class:"text-right mono opacity-80"},CSe={class:"text-right mono font-bold"},ASe={class:"col-3d-right"},ESe={class:"glass-panel correlation-3d-panel"},ISe={class:"panel-body correlation-3d-body"},RSe={key:0,class:"asset-tooltip-3d"},DSe={class:"tooltip-header"},PSe={class:"tooltip-symbol"},LSe={class:"tooltip-name"},NSe={class:"tooltip-details"},OSe={class:"tooltip-row"},FSe={key:0,class:"tooltip-row"},BSe={key:1,class:"tooltip-row"},USe={class:"tooltip-row"},zSe={class:"tooltip-row"},VSe={class:"tooltip-row"},HSe={key:2,class:"tooltip-row"},GSe={class:"garch-full-width"},WSe={class:"glass-panel"},qSe={class:"panel-body"},YSe={class:"garch-container-full"},jSe={class:"garch-chart-placeholder-full"},XSe={class:"garch-params-full"},$Se={class:"garch-stats"},KSe={class:"garch-stat"},ZSe={class:"stat-val"},JSe={class:"garch-stat"},QSe={class:"stat-val"},eMe={class:"garch-stat"},tMe={class:"stat-val"},aMe={class:"garch-stat"},nMe={class:"stat-val"},rMe={class:"dashboard-grid hjb-reports-grid"},iMe={class:"col-report-left"},oMe={class:"glass-panel report-panel"},sMe={class:"panel-body"},lMe={class:"filtering-report"},cMe={class:"report-summary"},uMe={class:"summary-item"},dMe={class:"summary-value"},hMe={class:"summary-item"},pMe={class:"summary-value text-green"},fMe={class:"summary-item"},mMe={class:"summary-value text-red"},vMe={class:"filtered-assets"},gMe={class:"filtered-list"},yMe={class:"asset-symbol"},bMe={class:"asset-garch"},xMe={class:"col-report-right"},wMe={class:"glass-panel report-panel"},_Me={class:"panel-body weights-body"},SMe={class:"weights-comparison"},MMe={class:"weights-table-container"},TMe={class:"weights-table"},kMe={class:"asset-cell"},CMe={class:"asset-info"},AMe={class:"symbol"},EMe={class:"name"},IMe={class:"text-right mono"},RMe={class:"text-right mono"},DMe={class:"text-right mono font-bold text-green"},PMe={class:"yield-summary"},LMe={class:"yield-summary-item"},NMe={class:"summary-value"},OMe={class:"yield-summary-item"},FMe={class:"summary-value"},BMe={class:"yield-summary-item"},UMe={class:"summary-value text-green font-bold"},zMe={class:"glass-panel trajectories-panel"},VMe={class:"panel-header"},HMe={class:"trajectories-header-left"},GMe={key:0,class:"live-badge"},WMe={key:0,class:"playback-controls"},qMe={key:0},YMe={key:1},jMe={class:"timeline-wrapper"},XMe=["max"],$Me={class:"playback-day-info"},KMe={class:"mono"},ZMe={class:"mono"},JMe={class:"panel-body"},QMe={key:0,viewBox:"0 0 1000 400",preserveAspectRatio:"none",class:"trajectories-svg"},eTe=["y1","y2"],tTe=["d"],aTe=["d"],nTe=["d"],rTe=["d"],iTe=["d"],oTe=["x1","x2"],sTe={key:1,class:"trajectories-empty-state"},lTe={class:"glass-panel trajectories-3d-panel"},cTe={class:"panel-header"},uTe={class:"trajectories-3d-header-left"},dTe={key:0,class:"live-badge"},hTe={key:0,class:"playback-controls"},pTe={key:0},fTe={key:1},mTe={class:"timeline-wrapper"},vTe=["max"],gTe={class:"playback-day-info"},yTe={class:"mono"},bTe={class:"mono"},xTe={class:"panel-body"},wTe={class:"trajectories-3d-container"},_Te={key:0,class:"glass-panel metrics-summary-panel"},STe={class:"panel-body"},MTe={class:"metrics-grid"},TTe={class:"metric-card"},kTe={class:"metric-card"},CTe={class:"metric-card"},ATe={class:"metric-card"},ETe={class:"metric-value text-red"},ITe={class:"metric-card"},RTe={class:"metric-value text-red"},DTe={class:"metric-card"},PTe={class:"metric-value text-red"},LTe={class:"hero-section"},NTe={class:"hero-left"},OTe={class:"hero-meta"},FTe={class:"glass-pill"},BTe={class:"glass-pill"},UTe={class:"glass-pill"},zTe={class:"glass-pill"},VTe={class:"hero-actions"},HTe=["disabled"],GTe={key:0,width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},WTe={key:1,class:"spinner"},qTe={class:"dashboard-grid hjb-grid"},YTe={class:"col-portfolio-wide"},jTe={class:"glass-panel portfolio-composition-panel"},XTe={class:"panel-body weights-body"},$Te={class:"weights-comparison"},KTe={class:"weights-table-container"},ZTe={class:"weights-table"},JTe={class:"asset-cell"},QTe={class:"asset-info"},eke={class:"symbol"},tke={class:"name"},ake={class:"text-right mono"},nke={class:"text-right mono"},rke={class:"text-right mono opacity-80"},ike={class:"text-right mono font-bold"},oke={class:"col-3d-right"},ske={class:"glass-panel"},lke={class:"panel-header"},cke={class:"header-tabs"},uke={class:"panel-body params-body"},dke={key:0},hke={class:"param-group"},pke={class:"param-input-group"},fke=["max"],mke={class:"param-hint"},vke={class:"param-group"},gke={class:"param-input-group"},yke={class:"param-hint"},bke={class:"param-group"},xke={class:"param-input-group"},wke={key:1},_ke={class:"param-group"},Ske={class:"radio-group"},Mke={class:"radio-item"},Tke={class:"radio-item"},kke={class:"glass-panel metrics-card"},Cke={class:"panel-body metrics-value"},Ake={class:"obj-value"},Eke={class:"value"},Ike={class:"obj-components"},Rke={class:"component"},Dke={class:"comp-value text-red"},Pke={class:"component"},Lke={class:"comp-value text-green"},Nke={class:"dashboard-grid hjb-grid"},Oke={class:"col-portfolio-wide"},Fke={class:"glass-panel"},Bke={class:"panel-header"},Uke={class:"header-tabs"},zke={class:"panel-body weights-body"},Vke={key:0,class:"weights-comparison"},Hke={class:"weights-table-container"},Gke={class:"weights-table"},Wke={class:"asset-cell"},qke={class:"asset-info"},Yke={class:"symbol"},jke={class:"name"},Xke={class:"text-right mono"},$ke={class:"text-right mono font-bold"},Kke={class:"text-right mono"},Zke={key:1,class:"weights-optimal"},Jke={class:"weight-chart"},Qke={class:"weight-bar-info"},eCe={class:"weight-bar-label"},tCe={class:"weight-bar-bg"},aCe={class:"weight-bar-value mono"},nCe={class:"col-3d-right"},rCe={class:"glass-panel"},iCe={class:"panel-body"},oCe={class:"cluster-info"},sCe={class:"info-row"},lCe={class:"value mono"},cCe={class:"info-row"},uCe={class:"value mono"},dCe={class:"clusters-list"},hCe={class:"cluster-detail"},pCe={class:"cluster-label"},fCe={class:"cluster-assets"},mCe={class:"asset-tag-symbol"},vCe={key:0,class:"asset-tag-weight"},gCe={class:"cluster-count"},yCe={class:"dashboard-grid"},bCe={class:"col-grid"},xCe={class:"glass-panel"},wCe={class:"panel-body metrics-table-body"},_Ce={class:"metrics-table"},SCe={class:"cluster-cell"},MCe={class:"mono text-right"},TCe={class:"mono text-right"},kCe={class:"mono text-right"},CCe={class:"mono text-right font-bold"},ACe={class:"mono text-right font-bold"},ECe={class:"col-grid"},ICe={class:"glass-panel"},RCe={class:"panel-body allocation-body"},DCe={class:"allocation-chart"},PCe={class:"alloc-label"},LCe={class:"allocation-details"},NCe={class:"alloc-name"},OCe={class:"alloc-pct mono"},FCe={class:"col-grid"},BCe={class:"glass-panel metrics-card"},UCe={class:"panel-body"},zCe={class:"stat-row"},VCe={class:"stat-val text-green"},HCe={class:"stat-row"},GCe={class:"stat-val"},WCe={class:"stat-row"},qCe={class:"stat-val"},YCe={class:"stat-row"},jCe={class:"stat-val mono"},XCe=e({__name:"CCMVOptimization",setup(e){let o=null,d=null;const g=Ys(),b=Ad(),x=t("hjb"),_=t(!1),C=t("comparison"),E=t("basic"),D=t({basic:null,methodology:null}),P=t({comparison:null,optimal:null}),L=S(()=>{const e=E.value,t=D.value[e];if(!t)return{width:"0px",left:"0px",opacity:0};const a=t.offsetLeft;return{width:`${t.offsetWidth}px`,left:`${a}px`,opacity:1}}),N=S(()=>{const e=C.value,t=P.value[e];if(!t)return{width:"0px",left:"0px",opacity:0};const a=t.offsetLeft;return{width:`${t.offsetWidth}px`,left:`${a}px`,opacity:1}}),O=S(()=>g.positions),F=S(()=>g.correlationMatrix),B=S(()=>g.selectedBank),U=t(null),z=t({gamma:2,horizon:1,riskFreeRate:.045,marketVol:.18,expectedReturn:.1,monteCarloTrajectories:1e4}),H=S(()=>{const{expectedReturn:e,riskFreeRate:t,gamma:a,marketVol:n}=z.value,r=(e-t)/(a*n*n);return Math.max(0,Math.min(r,2))}),G=S(()=>{const e=H.value,{expectedReturn:t,riskFreeRate:a}=z.value;return a+e*(t-a)}),W=S(()=>H.value*z.value.marketVol);S(()=>{const{expectedReturn:e,riskFreeRate:t,marketVol:a}=z.value;return(e-t)/a}),S(()=>{const{gamma:e}=z.value,t=G.value-z.value.riskFreeRate,a=W.value*W.value;return z.value.riskFreeRate+t-.5*e*a});const q=t(0),Y=t(!1);let j=null;const X=t(null),$=t(0),K=S(()=>Math.round(252*z.value.horizon)),Z=a({paths:[],displayPaths:[],medianPath:[],q05:[],q95:[],minY:0,maxY:200});R(()=>z.value.monteCarloTrajectories,()=>{if(We.value?.monte_carlo)Z.paths.length>0&&Q(),"hjb"===x.value&&Be(We.value.monte_carlo);else if(J(),"hjb"===x.value&&re.value&&se){const e={initialPrice:1e4*$.value,drift:z.value.expectedReturn,volatility:z.value.marketVol,timeSteps:K.value,numPaths:z.value.monteCarloTrajectories,dt:1/252,jumpIntensity:2,jumpMean:.05,jumpSd:.15};he.value=Re(e);const t=he.value.paths[0]?.length||0;ue.value=t,ve.value=t,de=!1,Ae(),Pe()}}),R(()=>[z.value.horizon,z.value.expectedReturn,z.value.marketVol,z.value.riskFreeRate],()=>{We.value?.monte_carlo||J()},{deep:!0});const J=()=>{const{horizon:e,expectedReturn:t,marketVol:a,riskFreeRate:n,monteCarloTrajectories:r}=z.value,i=K.value,o=1/252,s=t,l=a,c=[];for(let v=0;v<r;v++){const e=[$.value];let t=$.value;for(let a=1;a<=i;a++){const a=Ue(),n=(s-.5*l*l)*o,r=l*Math.sqrt(o)*a;t*=Math.exp(n+r),e.push(t)}c.push(e)}const u=i+1,d=[],h=[],p=[];let f=$.value,m=$.value;for(let v=0;v<u;v++){const e=c.map(e=>e[v]).sort((e,t)=>e-t),t=e[Math.floor(.5*r)],a=e[Math.floor(.05*r)],n=e[Math.floor(.95*r)];d.push(t),h.push(a),p.push(n),a<f&&(f=a),n>m&&(m=n)}Z.paths=c,Q(),Z.medianPath=d,Z.q05=h,Z.q95=p,Z.minY=.9*f,Z.maxY=1.1*m,Y.value||(q.value=i)},Q=()=>{if(!Z.paths.length)return;const e=Math.min(z.value.monteCarloTrajectories,Z.paths.length);Z.displayPaths=Z.paths.slice(0,e)},ee=()=>{Y.value?te():(q.value>=K.value&&(q.value=0),Y.value=!0,ne())},te=()=>{Y.value=!1,j&&cancelAnimationFrame(j)},ae=()=>{te(),q.value=0},ne=()=>{if(!Y.value)return;const e=K.value,t=q.value+Math.max(1,Math.floor(e/100));t>=e?(q.value=e,te()):(q.value=t,j=requestAnimationFrame(ne))},re=t(null);let ie=null,oe=null,se=null,le=null,ce=null,ue=t(0),de=!1;const he=t(null),pe=[];let fe=null;const me=t(!1),ve=t(0);let ge=null;const ye=S(()=>he.value&&he.value.paths.length?he.value.paths[0].length-1:0),be=e=>(100*e).toFixed(2)+"%",xe=()=>{if(!he.value||!he.value.paths.length)return[];const e=he.value.paths,t=[],a=e[0]?.[0]?.y||1e6;for(const n of e)if(n.length>0){const e=n[n.length-1].y/a-1;t.push(e)}return t},we=S(()=>{const e=xe();return 0===e.length?0:e.reduce((e,t)=>e+t,0)/e.length}),_e=S(()=>{const e=xe();if(0===e.length)return 0;const t=[...e].sort((e,t)=>e-t),a=Math.floor(t.length/2);return t.length%2==0?(t[a-1]+t[a])/2:t[a]}),Se=S(()=>{const e=xe();if(0===e.length)return 0;const t=we.value,a=e.reduce((e,a)=>e+Math.pow(a-t,2),0)/e.length,n=Math.sqrt(a),r=(K.value||252)/252,i=t/r,o=n/Math.sqrt(r);return 0===o?0:i/o}),Me=S(()=>{const e=xe();if(0===e.length)return 0;const t=[...e].sort((e,t)=>e-t);return t[Math.floor(.05*t.length)]||0}),Te=S(()=>{const e=xe();if(0===e.length)return 0;const t=[...e].sort((e,t)=>e-t),a=Math.floor(.05*t.length),n=t.slice(0,a+1);return 0===n.length?0:n.reduce((e,t)=>e+t,0)/n.length}),ke=S(()=>{if(!he.value||!he.value.paths.length)return 0;const e=he.value.paths,t=[];for(const a of e){if(0===a.length)continue;let e=a[0].y,n=0;for(const t of a){t.y>e&&(e=t.y);const a=(e-t.y)/e;a>n&&(n=a)}t.push(n)}return 0===t.length?0:t.reduce((e,t)=>e+t,0)/t.length}),Ce=()=>{me.value?Ae():(ve.value>=ye.value&&(ve.value=0),me.value=!0,Ie())},Ae=()=>{me.value=!1,ge&&(cancelAnimationFrame(ge),ge=null)},Ee=()=>{Ae(),ve.value=0,ue.value=0,Pe()},Ie=()=>{if(!me.value)return;const e=ye.value,t=ve.value+Math.max(1,Math.floor(e/100));t>=e?(ve.value=e,ue.value=e,Ae(),Pe()):(ve.value=t,ue.value=t,Pe(),ge=requestAnimationFrame(Ie))};R(ve,e=>{me.value||(ue.value=e,Pe())});const Re=e=>{const{initialPrice:t,drift:a,volatility:n,timeSteps:r,numPaths:i,dt:o,jumpIntensity:s,jumpMean:l,jumpSd:c}=e,u=[],d=[];let h=0,p=-1/0,f=1/0;const m=[];for(let b=0;b<i;b++){const e=[];let i=t;e.push({x:0,y:i,z:b});for(let t=1;t<=r;t++){const r=Math.random(),u=Math.random(),h=Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*u);let m=(a-.5*n*n)*o+n*Math.sqrt(o)*h,v=1,g=!1;if(Math.random()<s*o){g=!0;const e=Math.random(),t=Math.random(),a=l+c*(Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t));v=Math.exp(a)}i=i*Math.exp(m)*v;const y={x:t,y:i,z:b,isJump:g};e.push(y),g&&d.push(y),p=Math.max(p,i),f=Math.min(f,i)}u.push(e),h+=i,m.push(i)}const v=h/i,g=m.reduce((e,t)=>e+Math.pow(t-v,2),0)/i,y=Math.sqrt(g);return{paths:u,jumps:d,stats:{meanFinalPrice:v,maxPrice:p,minPrice:f,stdDev:y}}},De=async()=>{if(!re.value||"hjb"!==x.value)return void console.log("3D init skipped:",{canvas:!!re.value,method:x.value});se&&(se.dispose(),se=null),ce&&(cancelAnimationFrame(ce),ce=null),de=!1,fe=null;const e=re.value.parentElement;if(!e)return void console.error("3D container not found");const t=e.clientWidth||800,a=e.clientHeight||600;if(0===t||0===a)return console.warn("3D container has zero dimensions, retrying..."),void setTimeout(()=>{"hjb"===x.value&&re.value&&De()},500);console.log("Initializing 3D trajectories:",{width:t,height:a}),ie=new qS,ie.background=null,oe=new OS(45,t/a,.1,5e4),se=new AA({canvas:re.value,antialias:!0,alpha:!0}),se.setSize(t,a),se.setPixelRatio(window.devicePixelRatio),le=new YA(oe,se.domElement),le.enableDamping=!0,le.dampingFactor=.1,le.rotateSpeed=.5;const n=new wT(16777215,3);if(ie.add(n),We.value?.monte_carlo)Be(We.value.monte_carlo),console.log("3D visualization updated from backend:",{paths:he.value?.paths.length,stats:he.value?.stats});else{const e={initialPrice:1e4*$.value,drift:z.value.expectedReturn,volatility:z.value.marketVol,timeSteps:K.value,numPaths:z.value.monteCarloTrajectories,dt:1/252,jumpIntensity:2,jumpMean:.05,jumpSd:.15};he.value=Re(e),console.log("3D simulation generated locally:",{paths:he.value.paths.length,stats:he.value.stats,firstPathLength:he.value.paths[0]?.length});const t=he.value.paths[0]?.length||0;ue.value=t,ve.value=t,Pe()}const i=()=>{ce=requestAnimationFrame(i),le&&le.update(),se&&ie&&oe&&se.render(ie,oe)};i();const o=()=>{if(!e||!oe||!se)return;const t=e.clientWidth,a=e.clientHeight||500;oe.aspect=t/a,oe.updateProjectionMatrix(),se.setSize(t,a)};window.addEventListener("resize",o),r(()=>{window.removeEventListener("resize",o),ce&&cancelAnimationFrame(ce),se&&se.dispose()})},Pe=()=>{if(!ie||!he.value)return;pe.forEach(e=>{ie?.remove(e),e.geometry.dispose(),e.material.dispose&&e.material.dispose()}),pe.length=0;const{paths:e,stats:t}=he.value;if(!fe||fe.stats!==t){const a=3,n=8,r=300,i=t.maxPrice-t.minPrice,o=r/Math.max(i,.05*t.meanFinalPrice,1),s=e[0].length*a,l=e.length*n;fe={scaleX:a,scaleY:o,scaleZ:n,stats:t,boxWidth:s,boxDepth:l}}const{scaleX:a,scaleY:n,scaleZ:r,boxWidth:i,boxDepth:o}=fe,s=(t.maxPrice-t.minPrice)*n,l=s/2,c=i/2,u=o/2;if(oe&&le&&!de){const e=.8*Math.max(i,o,s);oe.position.set(e,l+.5*e,e),le.target.set(c,l,u),le.update(),de=!0,console.log("Camera positioned:",{position:oe.position.toArray(),target:[c,l,u],distance:e})}const d=new xM({color:61695,transparent:!0,opacity:.6,linewidth:1.5}),h=new xM({color:16777215,transparent:!0,opacity:1,linewidth:2.5});for(pe.length!==e.length&&(pe.forEach(e=>{ie?.remove(e),e.geometry.dispose()}),pe.length=0),e.forEach((i,o)=>{const s=i[i.length-1].y,l=Math.abs(s-e[0][0].y)>1.5*t.stdDev?h:d,c=Math.max(2,Math.min(i.length,ue.value)),u=i.slice(0,c);if(u.length<2)return;let p=pe[o];if(p){const o=[];u.forEach(e=>{o.push(e.x*a+0,(e.y-t.minPrice)*n,e.z*r+0)}),p.geometry.setAttribute("position",new rS(o,3)),p.geometry.setDrawRange(0,u.length);const s=i[i.length-1].y,l=Math.abs(s-e[0][0].y)>1.5*t.stdDev;p.material=l?h:d}else{const e=u.map(e=>new rw(e.x*a+0,(e.y-t.minPrice)*n,e.z*r+0)),i=(new hS).setFromPoints(e);p=new AM(i,l),ie&&(ie.add(p),pe[o]=p)}});pe.length>e.length;){const e=pe.pop();e&&ie&&(ie.remove(e),e.geometry.dispose())}Fe(t,a,n,r,i,o),se&&ie&&oe&&se.render(ie,oe)};let Le=[],Ne=[];const Oe=(e,t,a=8)=>{const n=document.createElement("canvas");n.width=6144,n.height=3072;const r=n.getContext("2d");r.fillStyle="#ffffff",r.strokeStyle="#000000",r.lineWidth=24,r.font="bold 600px Arial",r.textAlign="center",r.textBaseline="middle",r.strokeText(e,3072,1536),r.fillText(e,3072,1536);const i=new zM(n),o=new $S({map:i}),s=new cM(o);return s.scale.set(a,a/2,1),s.position.copy(t),s},Fe=(e,t,a,n,r,i)=>{if(!ie)return;if(Le.forEach(e=>{ie&&ie.remove(e),e.traverse(e=>{e instanceof MS&&(e.geometry.dispose(),e.material instanceof K_&&e.material.dispose())})}),Le.length=0,Ne.forEach(e=>{ie&&ie.remove(e),e.material instanceof $S&&(e.material.map?.dispose(),e.material.dispose())}),Ne.length=0,!ie)return;const o=(e.maxPrice-e.minPrice)*a*1.2,s=new VS,l=((e,t,a=34986,n=13124)=>{const r=new VS,i=new xM({color:a,opacity:.3,transparent:!0}),o=new xM({color:n,opacity:.5,transparent:!0});for(let s=0;s<=e;s+=50){const e=s%250==0?o:i,a=(new hS).setFromPoints([new rw(s,0,0),new rw(s,0,t)]),n=new AM(a,e);r.add(n)}for(let s=0;s<=t;s+=50){const t=s%250==0?o:i,a=(new hS).setFromPoints([new rw(0,0,s),new rw(e,0,s)]),n=new AM(a,t);r.add(n)}return r})(r,i);l.position.set(0,0,0),s.add(l);const c=((e,t,a=34986,n=13124)=>{const r=new VS,i=new xM({color:a,opacity:.3,transparent:!0}),o=new xM({color:n,opacity:.5,transparent:!0});for(let s=0;s<=e;s+=50){const e=s%250==0?o:i,a=(new hS).setFromPoints([new rw(s,0,0),new rw(s,t,0)]),n=new AM(a,e);r.add(n)}for(let s=0;s<=t;s+=50){const t=s%250==0?o:i,a=(new hS).setFromPoints([new rw(0,s,0),new rw(e,s,0)]),n=new AM(a,t);r.add(n)}return r})(r,o);c.position.set(0,0,0),s.add(c);const u=((e,t,a=34986,n=13124)=>{const r=new VS,i=new xM({color:a,opacity:.3,transparent:!0}),o=new xM({color:n,opacity:.5,transparent:!0});for(let s=0;s<=t;s+=50){const t=s%250==0?o:i,a=(new hS).setFromPoints([new rw(0,0,s),new rw(0,e,s)]),n=new AM(a,t);r.add(n)}for(let s=0;s<=e;s+=50){const e=s%250==0?o:i,a=(new hS).setFromPoints([new rw(0,s,0),new rw(0,s,t)]),n=new AM(a,e);r.add(n)}return r})(o,i);u.position.set(0,0,0),s.add(u);const d=Math.max(r,i,o),h=new xM({color:16777215,linewidth:3}),p=new xM({color:11184810,opacity:.8,transparent:!0}),f=.03*d,m=(new hS).setFromPoints([new rw(0,0,0),new rw(r,0,0)]),v=new AM(m,h);s.add(v);for(let M=0;M<=r;M+=50){const e=M%250==0,t=e?h:p,a=e?1.5*f:f,n=(new hS).setFromPoints([new rw(M,-a,0),new rw(M,a,0)]),r=new AM(n,t);s.add(r)}const g=(new hS).setFromPoints([new rw(0,0,0),new rw(0,o,0)]),y=new AM(g,h);s.add(y);for(let M=0;M<=o;M+=50){const e=M%250==0,t=e?h:p,a=e?1.5*f:f,n=(new hS).setFromPoints([new rw(-a,M,0),new rw(a,M,0)]),r=new AM(n,t);s.add(r)}const b=(new hS).setFromPoints([new rw(0,0,0),new rw(0,0,i)]),x=new AM(b,h);s.add(x);for(let M=0;M<=i;M+=50){const e=M%250==0,t=e?h:p,a=e?1.5*f:f,n=(new hS).setFromPoints([new rw(-a,0,M),new rw(a,0,M)]),r=new AM(n,t);s.add(r)}const w=Oe("ВРЕМЯ (t)",new rw(r/2,-120,0),150);Ne.push(w),ie.add(w);const _=Oe("Капитал",new rw(-150,o/2,0),150);Ne.push(_),ie.add(_);const S=Oe("ТРАЕКТОРИИ (N)",new rw(-120,-120,i/2),150);Ne.push(S),ie.add(S),ie&&(ie.add(s),Le.push(s))},Be=e=>{if(!e||!e.paths.length)return;const t=[],a=e.t_grid||e.paths[0].map((e,t)=>t),n=Math.min(z.value.monteCarloTrajectories,e.paths.length);for(let o=0;o<n;o++){const n=e.paths[o],r=[];for(let e=0;e<n.length;e++)r.push({x:a[e]||e,y:n[e],z:o});t.push(r)}const r=e.paths.map(e=>e[e.length-1]),i={meanFinalPrice:e.stats.mean_final||r.reduce((e,t)=>e+t,0)/r.length,maxPrice:e.stats.max_final||Math.max(...r),minPrice:e.stats.min_final||Math.min(...r),stdDev:e.stats.std_final||0};if(he.value={paths:t,jumps:[],stats:i},t.length>0&&t[0].length>0){const e=t[0].length-1;ue.value=e,ve.value=e,de=!1,Ae(),"hjb"===x.value&&re.value&&(se?Pe():De().then(()=>{se&&Pe()}))}};R(()=>We.value?.monte_carlo,e=>{e&&"hjb"===x.value&&Be(e)},{deep:!0}),R([Z,z],()=>{if(!We.value?.monte_carlo&&"hjb"===x.value&&re.value&&se){const e={initialPrice:1e4*$.value,drift:z.value.expectedReturn,volatility:z.value.marketVol,timeSteps:K.value,numPaths:z.value.monteCarloTrajectories,dt:1/252,jumpIntensity:2,jumpMean:.05,jumpSd:.15};he.value=Re(e);const t=he.value.paths[0]?.length||0;ue.value=t,ve.value=t,de=!1,Ae(),Pe()}},{deep:!0}),R([x,re],([e,t])=>{"hjb"===e&&t?setTimeout(()=>{const e=t.parentElement;e&&e.clientWidth>0&&e.clientHeight>0?De():setTimeout(()=>{"hjb"===x.value&&re.value&&De()},500)},200):(ce&&(cancelAnimationFrame(ce),ce=null),se&&(se.dispose(),se=null),ie=null,oe=null,le=null,pe.length=0,Le.length=0,Ne.forEach(e=>{e.material instanceof $S&&(e.material.map?.dispose(),e.material.dispose())}),Ne.length=0)},{immediate:!0});const Ue=()=>{let e=0,t=0;for(;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)},ze=e=>e/K.value*1e3,Ve=e=>{const t=Z.maxY-Z.minY;return 400-400*((e-Z.minY)/t)},He=(e,t)=>{if(!e.length)return"";return"M "+e.slice(0,t+1).map((e,t)=>`${ze(t).toFixed(1)},${Ve(e).toFixed(1)}`).join(" L ")},Ge=(e,t,a)=>{if(!e.length)return"";const n=e.slice(0,a+1),r=t.slice(0,a+1);let i="M "+n.map((e,t)=>`${ze(t).toFixed(1)},${Ve(e).toFixed(1)}`).join(" L ");for(let o=r.length-1;o>=0;o--)i+=` L ${ze(o).toFixed(1)},${Ve(r[o]).toFixed(1)}`;return i+=" Z",i},We=t(null),qe=async()=>{_.value=!0;try{const e=O.value,t=e.length,a=e.map(e=>{const t=252*(e.dayChange/100);return Math.max(.01,.05+t)}),n=F.value,r=[],i=e.map(()=>.2);for(let p=0;p<t;p++){const e=[];for(let a=0;a<t;a++){const t=(n[p]?.values[a]||(p===a?1:0))*i[p]*i[a];e.push(t)}r.push(e)}const o={initial_capital:1e6,horizon_years:z.value.horizon,n_paths:z.value.monteCarloTrajectories,n_steps:K.value,random_seed:42},s=await(async e=>{try{const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/hjb/optimize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("HJB Optimization Failed:",QXe),QXe}})({mu:a,cov_matrix:r,risk_free_rate:z.value.riskFreeRate,gamma:z.value.gamma,asset_names:e.map(e=>e.symbol),monte_carlo:o});if(We.value=s,s.monte_carlo){Z.paths=s.monte_carlo.paths,Q(),Z.medianPath=s.monte_carlo.median_path,Z.q05=s.monte_carlo.q05_path,Z.q95=s.monte_carlo.q95_path;const e=[...s.monte_carlo.q05_path,...s.monte_carlo.q95_path];Z.minY=.9*Math.min(...e),Z.maxY=1.1*Math.max(...e),q.value=K.value,Be(s.monte_carlo)}const l=24e5,c=s.portfolio_stats,u=b.calculateVaR(l,c.volatility,.95,1),d=b.calculateVaR(l,c.volatility,.99,1),h=b.calculateRiskContributions(e.map(e=>({symbol:e.symbol,allocation:e.allocation,notional:e.notional,color:e.color})),c.volatility,F.value,l);b.updateMetrics({var95:u.var,var99:d.var,cvar95:u.cvar,cvar99:d.cvar,expectedReturn:c.expected_return,volatility:c.volatility,sharpeRatio:c.sharpe_ratio,portfolioBeta:.85,riskContributions:h,maxDrawdown:s.monte_carlo?.stats?.mean_max_drawdown||ke.value||.124}),It(`HJB оптимизация завершена: Sharpe = ${s.portfolio_stats.sharpe_ratio.toFixed(2)}`,"success")}catch(QXe){console.error("HJB Optimization Error:",QXe),It(`Ошибка оптимизации: ${QXe instanceof Error?QXe.message:"Unknown error"}`,"error")}finally{_.value=!1}},Ye=S(()=>O.value.map(e=>({symbol:e.symbol,name:e.name,garchVol:15+20*Math.random(),passed:!0})).filter(e=>e.garchVol<=30).sort((e,t)=>e.garchVol-t.garchVol)),je=S(()=>Ye.value.length),Xe=S(()=>O.value.map(e=>{const t=.05+.15*Math.random(),a=.02+.08*Math.random();return{symbol:e.symbol,name:e.name,color:e.color,historicalYield:t,dividendYield:a,totalYield:t+a}}).sort((e,t)=>t.totalYield-e.totalYield)),$e=S(()=>0===Xe.value.length?0:Xe.value.reduce((e,t)=>e+t.historicalYield,0)/Xe.value.length),Ke=S(()=>0===Xe.value.length?0:Xe.value.reduce((e,t)=>e+t.dividendYield,0)/Xe.value.length),Ze=S(()=>0===Xe.value.length?0:Xe.value.reduce((e,t)=>e+t.totalYield,0)/Xe.value.length),Je=async()=>{try{if("hjb"!==x.value)return void console.log("Not HJB method, skipping 3D init");if(await(async()=>{if("undefined"!=typeof window){const e=window;return e.Plotly?(o=e.Plotly,o):d||(document.querySelector('script[src*="plotly"]')?(d=new Promise(t=>{const a=setInterval(()=>{e.Plotly&&(clearInterval(a),o=e.Plotly,t(o))},100);setTimeout(()=>{clearInterval(a),t(null)},1e4)}),d):(d=new Promise(t=>{const a=document.createElement("script");a.src="https://cdn.plot.ly/plotly-2.27.0.min.js",a.async=!0,a.onload=()=>{o=e.Plotly,t(o)},a.onerror=()=>{console.error("Failed to load Plotly"),t(null)},document.head.appendChild(a)}),d))}return null})(),!o)return void console.error("Plotly not loaded");const e=document.getElementById("correlation-3d-heatmap");if(!e)return void console.error("Container correlation-3d-heatmap not found");const t=[...O.value];if(0===t.length)return;const a=F.value,n=((e,t)=>e.map(e=>{const a=e.symbol.includes("SU")||e.symbol.includes("RU000"),n=a?"#3b82f6":"#10b981",r=a?3+4*Math.random():15+20*Math.random(),i=t.findIndex(t=>t.label===e.symbol);let o=0;if(-1!==i){const e=t[i].values;o=e.reduce((e,t)=>e+t,0)/e.length}return{x:r,y:o,z:e.allocation,asset:{...e,color:n}}}))(t,a);if(0===n.length)return void console.error("No 3D positions calculated");const r=n.map(e=>e.x),i=n.map(e=>e.y),s=n.map(e=>e.z),l=Math.min(...r),c=Math.max(...r),u=Math.min(...i),h=Math.max(...i),p=Math.min(...s),f=Math.max(...s),m=(e,t,a)=>a===t?5:(e-t)/(a-t)*10,v=n.map(e=>({...e,nx:m(e.x,l,c),ny:m(e.y,u,h),nz:m(e.z,p,f)})),g=(e,t,a,n,r,i)=>{const o=[],s=[],l=[];for(let c=0;c<16;c++){const r=c/15*Math.PI;for(let i=0;i<16;i++){const c=i/15*2*Math.PI;o.push(e+n*Math.sin(r)*Math.cos(c)),s.push(t+n*Math.sin(r)*Math.sin(c)),l.push(a+n*Math.cos(r))}}return{type:"mesh3d",x:o,y:s,z:l,color:r,alphahull:0,opacity:1,flatshading:!1,lighting:{ambient:.6,diffuse:.9,specular:1,roughness:.1,fresnel:.8},lightposition:{x:10,y:10,z:20},hoverinfo:"none",customdata:i,name:i.symbol}},y=[];v.forEach(e=>{const t=e.asset,a=.3+t.allocation/25;y.push(g(e.nx,e.ny,e.nz,a,t.color,t))}),y.push({x:v.map(e=>e.nx),y:v.map(e=>e.ny),z:v.map(e=>e.nz),mode:"markers",type:"scatter3d",marker:{size:v.map(e=>Math.max(40,40*(.3+e.asset.allocation/25))),color:"rgba(255,255,255,0)",opacity:0,line:{width:0}},hoverinfo:"skip",customdata:v.map(e=>e.asset)});const b={showlegend:!1,hovermode:"closest",scene:{xaxis:{title:"РИСК (Волатильность %)",backgroundcolor:"rgba(20, 22, 28, 0.8)",gridcolor:"rgba(255,255,255,0.08)",zeroline:!1,showbackground:!0,titlefont:{color:"#ffffff",size:12,weight:"bold"},tickfont:{size:9,color:"rgba(255,255,255,0.6)"},tickvals:[0,2.5,5,7.5,10],ticktext:[l.toFixed(0)+"%",((l+c)/4*1+3*l/4).toFixed(0)+"%",((l+c)/2).toFixed(0)+"%",((l+c)/4*3+1*c/4).toFixed(0)+"%",c.toFixed(0)+"%"],showspikes:!1},yaxis:{title:"СВЯЗЬ (Корреляция)",backgroundcolor:"rgba(30, 32, 38, 0.6)",gridcolor:"rgba(255,255,255,0.08)",zeroline:!1,showbackground:!0,titlefont:{color:"#ffffff",size:12,weight:"bold"},tickfont:{size:9,color:"rgba(255,255,255,0.6)"},tickvals:[0,2.5,5,7.5,10],ticktext:[u.toFixed(2),((u+h)/4*1+3*u/4).toFixed(2),((u+h)/2).toFixed(2),((u+h)/4*3+1*h/4).toFixed(2),h.toFixed(2)],showspikes:!1},zaxis:{title:"ДОЛЯ (Вес %)",backgroundcolor:"rgba(20, 22, 28, 0.8)",gridcolor:"rgba(255,255,255,0.08)",zeroline:!1,showbackground:!0,titlefont:{color:"#ffffff",size:12,weight:"bold"},tickfont:{size:9,color:"rgba(255,255,255,0.6)"},tickvals:[0,2.5,5,7.5,10],ticktext:[p.toFixed(1)+"%",((p+f)/4*1+3*p/4).toFixed(1)+"%",((p+f)/2).toFixed(1)+"%",((p+f)/4*3+1*f/4).toFixed(1)+"%",f.toFixed(1)+"%"],showspikes:!1},bgcolor:"rgba(0,0,0,0)",camera:{eye:{x:1.8,y:1.8,z:1.2},center:{x:0,y:0,z:0},up:{x:0,y:0,z:1}},aspectmode:"cube"},paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{color:"#fff",family:"system-ui"},margin:{l:0,r:0,b:0,t:0},autosize:!0},w={responsive:!0,displayModeBar:!1,staticPlot:!1,displaylogo:!1};o.newPlot(e,y,b,w);const _=e;_.on("plotly_hover",e=>{if(e&&e.points&&e.points.length>0)for(const t of e.points){if(t.customdata){const e=Array.isArray(t.customdata)?t.customdata[0]:t.customdata;if(e)return void(U.value=e)}const e=y.length-1;if(t.curveNumber===e&&void 0!==t.pointNumber){const e=t.pointNumber;if(e>=0&&e<v.length&&v[e])return void(U.value=v[e].asset)}if(t.curveNumber<e&&t.curveNumber<v.length){const e=t.curveNumber;if(v[e])return void(U.value=v[e].asset)}}}),_.on("plotly_unhover",()=>{U.value=null})}catch(e){console.error("Error initializing 3D Correlation Heatmap:",e)}};R([O,B,x],()=>{"hjb"===x.value?(rt&&(rt.disconnect(),rt=null),O.value.length>0&&setTimeout(()=>{it(),ot()},400)):rt&&(rt.disconnect(),rt=null)},{deep:!1});const Qe=t(null),et=t(null),tt=t(null),at=t(0),nt=t(!1);let rt=null;const it=()=>{"hjb"===x.value&&setTimeout(()=>{const e=document.querySelector(".portfolio-composition-panel"),t=document.querySelector(".correlation-3d-panel");if(e&&t){const a=e.offsetHeight||e.scrollHeight,n=t.offsetHeight||t.scrollHeight,r=Math.min(Math.max(a,n,450),500);e.style.height=r+"px",t.style.height=r+"px",setTimeout(()=>{Je()},200)}const a=document.querySelectorAll(".report-panel");if(a.length>=2){const e=a[0],t=a[1];if(e&&t){const a=e.offsetHeight||e.scrollHeight,n=t.offsetHeight||t.scrollHeight,r=Math.max(a,n);e.style.height=r+"px",t.style.height=r+"px"}}},100)},ot=()=>{if("undefined"==typeof ResizeObserver)return;const e=document.querySelector(".portfolio-composition-panel"),t=document.querySelector(".correlation-3d-panel"),a=document.querySelectorAll(".report-panel");e&&t&&(rt=new ResizeObserver(()=>{it()}),rt.observe(e),rt.observe(t),a.forEach(e=>{rt?.observe(e)}))};R([E,C],async()=>{await A()},{immediate:!1});const st=()=>{L.value,N.value};R(()=>O.value,()=>{Qe.value&&ct()},{deep:!0}),n(()=>{J(),window.addEventListener("resize",st),setTimeout(()=>{if(Qe.value){ft();const e=new ResizeObserver(()=>{Qe.value&&et.value&&pt()});Qe.value.parentElement&&e.observe(Qe.value.parentElement)}it(),ot(),"hjb"===x.value&&(console.log("Initializing 3D chart for HJB method..."),setTimeout(()=>{Je()},1e3),setTimeout(()=>{re.value&&"hjb"===x.value&&(console.log("Initializing 3D trajectories visualization..."),De())},1500))},500)}),r(()=>{rt&&(rt.disconnect(),rt=null),j&&cancelAnimationFrame(j),ht(),window.removeEventListener("resize",st)});const lt=()=>{const e=O.value;if(0===e.length)return[];const t=[];for(let a=0;a<500;a++){const a=e.reduce((e,t)=>e+t.dayChange/100/252*(t.allocation||0),0),n=.02*(Math.random()-.5);t.push(a+n)}return t},ct=async()=>{try{const e=lt();if(0===e.length)return;const t=await(async e=>{try{const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/compute/garch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("GARCH Calculation Failed:",QXe),QXe}})({returns:e,omega:25e-6,alpha:.082,beta:.893});et.value=t,at.value=0,dt()}catch(QXe){console.error("Failed to load GARCH data:",QXe),ut()}},ut=()=>{const e=lt();if(0===e.length){const t=500,a=[];let n=.18;for(let e=0;e<t;e++){const e=.05*(Math.random()-.5);n=Math.max(.05,Math.min(.5,.95*n+e)),a.push(n)}et.value={result:{variances:a.map(e=>e*e),volatilities:a,residuals:e.length>0?e:Array(t).fill(0).map(()=>.3*(Math.random()-.5)),parameters:{omega:25e-6,alpha:.082,beta:.893},long_term_volatility:.182,mean_variance:.033,mean_volatility:.18},status:"success",timestamp:(new Date).toISOString()},at.value=0,dt()}},dt=()=>{nt.value||(nt.value=!0,at.value=0,pt())},ht=()=>{nt.value=!1,tt.value&&(cancelAnimationFrame(tt.value),tt.value=null)},pt=()=>{if(!nt.value||!et.value)return;const e=document.getElementById("garch-chart");if(!e)return void ht();const t=e.getContext("2d");if(!t)return void ht();const a=e.offsetWidth||1200,n=200;e.width=a,e.height=n;const r=et.value.result.volatilities,i=r.length;at.value+=2;const o=Math.min(at.value,i);if(t.fillStyle="rgba(20, 22, 28, 0.5)",t.fillRect(0,0,a,n),t.strokeStyle="rgba(255, 255, 255, 0.2)",t.lineWidth=1,t.setLineDash([5,5]),t.beginPath(),t.moveTo(0,100),t.lineTo(a,100),t.stroke(),t.setLineDash([]),o>0){const e=et.value.result.mean_volatility,s=2*(1.2*Math.max(...r.slice(0,o).map(t=>Math.abs(t-e))))||.1;t.strokeStyle="#60a5fa",t.lineWidth=2,t.beginPath();for(let n=0;n<o;n++){const o=n/(i-1)*a,l=100-160*((r[n]-e)/s);0===n?t.moveTo(o,l):t.lineTo(o,l)}if(t.stroke(),t.fillStyle="rgba(96, 165, 250, 0.15)",o>0){const e=(o-1)/(i-1)*a,n=100;t.lineTo(e,n),t.lineTo(0,n),t.closePath(),t.fill()}t.fillStyle="#60a5fa";for(let n=0;n<o;n+=10){const o=n/(i-1)*a,l=100-160*((r[n]-e)/s);t.beginPath(),t.arc(o,l,2,0,2*Math.PI),t.fill()}if(o<i){const e=(o-1)/(i-1)*a;t.strokeStyle="#fbbf24",t.lineWidth=2,t.beginPath(),t.moveTo(e,0),t.lineTo(e,n),t.stroke()}}o<i?tt.value=requestAnimationFrame(pt):setTimeout(()=>{at.value=0,tt.value=requestAnimationFrame(pt)},2e3)},ft=()=>{document.getElementById("garch-chart")&&ct()},mt=t({show:!1,message:"",type:"success"}),vt=S(()=>{if(!At.value){const e=O.value,t=e.length,a=[...e].sort((e,t)=>t.allocation-e.allocation),n=Math.ceil(a.length/3),r=[];for(let i=0;i<a.length;i+=n){const e=a.slice(i,i+n).map(e=>e.symbol);e.length>0&&r.push({assets:e})}return{numClusters:r.length||3,numAssets:t,clusters:r.length>0?r:[{assets:a.slice(0,Math.ceil(a.length/3)).map(e=>e.symbol)},{assets:a.slice(Math.ceil(a.length/3),Math.ceil(2*a.length/3)).map(e=>e.symbol)},{assets:a.slice(Math.ceil(2*a.length/3)).map(e=>e.symbol)}].filter(e=>e.assets.length>0)}}const e=At.value;return{numClusters:e.clusters.length,numAssets:e.optimal_weights.length,clusters:e.clusters.map(e=>({assets:e.assets}))}}),gt=["#3b82f6","#10b981","#f59e0b"],yt=t({Delta:3,bar_w:.25,gamma:2,method:"delta"});t({SPY:.35,QQQ:.12,TLT:.25,BND:0,GLD:.18,DXY:.15});const bt=S(()=>{if(!At.value)return[{expectedReturn:.085,volatility:.18,avgCorrelation:.75,deltaK:2,alphaK:"delta"===yt.value.method?.33:.35},{expectedReturn:.045,volatility:.08,avgCorrelation:.65,deltaK:1,alphaK:"delta"===yt.value.method?.33:.3},{expectedReturn:.055,volatility:.12,avgCorrelation:.4,deltaK:1,alphaK:"delta"===yt.value.method?.34:.35}];const e=At.value,t=F.value;return e.clusters.map(e=>{let a=0,n=0;for(let r=0;r<e.asset_indices.length;r++)for(let i=r+1;i<e.asset_indices.length;i++){const o=e.asset_indices[r],s=e.asset_indices[i];a+=t[o]?.values[s]||0,n++}a=n>0?a/n:0;return{expectedReturn:.06,volatility:.15,avgCorrelation:a,deltaK:e.delta_k,alphaK:e.alpha_k}})}),xt=S(()=>{if(!At.value){const e={};return O.value.forEach(t=>{e[t.symbol]=t.allocation/100}),{weights:e,method:yt.value.method}}const e=At.value,t={};return e.optimal_weights.forEach((e,a)=>{const n=O.value[a]?.symbol;n&&(t[n]=e)}),{weights:t,method:e.method}}),wt=S(()=>At.value?At.value.portfolio_stats.objective_value:.0185-.0625*yt.value.gamma),_t=S(()=>{if(!At.value)return{variance:.0185,return:.0625};const e=At.value.portfolio_stats;return{variance:e.volatility*e.volatility,return:e.expected_return}}),St=S(()=>{if(!At.value)return{expectedReturn:.0625,volatility:.136,sharpeRatio:.15073529411764702,numPositions:Object.values(xt.value.weights).filter(e=>e>.001).length};const e=At.value,t=e.portfolio_stats;return{expectedReturn:t.expected_return,volatility:t.volatility,sharpeRatio:t.sharpe_ratio,numPositions:e.optimal_weights.filter(e=>e>.001).length}}),Mt=S(()=>{if(!At.value){const e=bt.value.map(e=>e.alphaK);return e.map(e=>({percentage:100*e}))}return At.value.clusters.map(e=>({percentage:100*e.alpha_k}))}),Tt=e=>{const t=xt.value.weights[e];if(null!=t)return 100*t;const a=O.value.find(t=>t.symbol===e);return a?.allocation||0},kt=e=>Tt(e.symbol)-e.allocation,Ct=e=>{if(At.value){const t=O.value.findIndex(t=>t.symbol===e);if(t>=0&&t<At.value.optimal_weights.length){const e=At.value.optimal_weights[t];return e>.001?100*e:null}}const t=O.value.find(t=>t.symbol===e);return t?.allocation||null},At=t(null),Et=async()=>{_.value=!0;try{const e=O.value,t=e.length;if(0===t)throw new Error("Портфель пуст");const a=252,n=[];for(let m=0;m<a;m++){const t=[];e.forEach(e=>{const a=e.dayChange/100/252+(Math.random()-.5)*(e.dayChange/100)/10;t.push(a)}),n.push(t)}const r=e.map(e=>{const t=252*(e.dayChange/100);return Math.max(.01,.05+t)}),i=F.value,o=e.map(()=>.2),s=[];for(let m=0;m<t;m++){const e=[];for(let a=0;a<t;a++){const t=(i[m]?.values[a]||(m===a?1:0))*o[m]*o[a];e.push(t)}s.push(e)}const l=await(async e=>{try{const t=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/ccmv/optimize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("CCMV Optimization Failed:",QXe),QXe}})({R:n,mu:r,cov_matrix:s,Delta:yt.value.Delta,bar_w:yt.value.bar_w,gamma:yt.value.gamma,method:yt.value.method,asset_names:e.map(e=>e.symbol)});At.value=l;const c=24e5,u=l.portfolio_stats,d=b.calculateVaR(c,u.volatility,.95,1),h=b.calculateVaR(c,u.volatility,.99,1),p=e.map((e,t)=>{const a=l.optimal_weights[t]||0;return{symbol:e.symbol,allocation:100*a,notional:c*a,color:e.color}}),f=b.calculateRiskContributions(p,u.volatility,F.value,c);b.updateMetrics({var95:d.var,var99:h.var,cvar95:d.cvar,cvar99:h.cvar,expectedReturn:u.expected_return,volatility:u.volatility,sharpeRatio:u.sharpe_ratio,portfolioBeta:.85,riskContributions:f,maxDrawdown:.124}),It(`Оптимизация завершена (${"delta"===yt.value.method?"Δ-CCMV":"α-CCMV"}). Sharpe = ${l.portfolio_stats.sharpe_ratio.toFixed(2)}`,"success")}catch(QXe){console.error("CCMV Optimization Error:",QXe),It(`Ошибка оптимизации: ${QXe instanceof Error?QXe.message:"Unknown error"}`,"error")}finally{_.value=!1}},It=(e,t="success")=>{mt.value={show:!0,message:e,type:t},setTimeout(()=>{mt.value.show=!1},3e3)};return(e,t)=>(w(),i("div",V_e,[s("div",H_e,[s("button",{class:c(["method-tab",{active:"hjb"===x.value}]),onClick:t[0]||(t[0]=e=>x.value="hjb")},[...t[19]||(t[19]=[I('<div class="method-icon hjb" data-v-baa812ed><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-baa812ed><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" data-v-baa812ed></path></svg></div><div class="method-info" data-v-baa812ed><span class="method-title" data-v-baa812ed>HJB-стратегия</span><span class="method-subtitle" data-v-baa812ed>Стохастическое оптимизирование</span></div>',2)])],2),s("button",{class:c(["method-tab",{active:"ccmv"===x.value}]),onClick:t[1]||(t[1]=e=>x.value="ccmv")},[...t[20]||(t[20]=[I('<div class="method-icon ccmv" data-v-baa812ed><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-baa812ed><circle cx="12" cy="12" r="10" data-v-baa812ed></circle><path d="M12 6v6l4 2" data-v-baa812ed></path></svg></div><div class="method-info" data-v-baa812ed><span class="method-title" data-v-baa812ed>CCMV модель</span><span class="method-subtitle" data-v-baa812ed>Кластерная оптимизация</span></div>',2)])],2)]),"hjb"===x.value?(w(),i(p,{key:0},[s("div",G_e,[s("div",W_e,[t[25]||(t[25]=s("h1",null,"Стохастическое оптимизирование (HJB)",-1)),s("div",q_e,[t[24]||(t[24]=s("span",{class:"glass-pill"},[m("Стратегия: "),s("strong",null,"Hamilton-Jacobi-Bellman")],-1)),s("span",Y_e,[t[21]||(t[21]=m("Горизонт: ",-1)),s("strong",null,v(z.value.horizon)+" мес.",1)]),s("span",j_e,[t[22]||(t[22]=m("Банк: ",-1)),s("strong",null,v(B.value.name),1)]),s("span",X_e,[t[23]||(t[23]=m("Активов: ",-1)),s("strong",null,v(O.value.length),1)])])]),s("div",$_e,[s("button",{class:"btn-glass primary",onClick:qe,disabled:_.value},[_.value?(w(),i("span",J_e)):(w(),i("svg",Z_e,[...t[26]||(t[26]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),m(" "+v(_.value?"Расчёт...":"Запустить оптимизацию"),1)],8,K_e)])]),s("div",Q_e,[t[33]||(t[33]=s("div",{class:"panel-header"},[s("h3",null,"Параметры HJB модели")],-1)),s("div",eSe,[s("div",tSe,[t[27]||(t[27]=s("label",null,"Коэффициент неприятия риска (γ)",-1)),s("div",aSe,[T(s("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>z.value.gamma=e),min:"0.1",max:"20",step:"0.1"},null,512),[[k,z.value.gamma,void 0,{number:!0}]])])]),s("div",nSe,[t[28]||(t[28]=s("label",null,"Инвестиционный горизонт (T), лет",-1)),s("div",rSe,[T(s("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>z.value.horizon=e),min:"0.1",max:"50",step:"0.1"},null,512),[[k,z.value.horizon,void 0,{number:!0}]])])]),s("div",iSe,[t[29]||(t[29]=s("label",null,"Безрисковая ставка (r)",-1)),s("div",oSe,[T(s("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>z.value.riskFreeRate=e),min:"0",max:"0.2",step:"0.001"},null,512),[[k,z.value.riskFreeRate,void 0,{number:!0}]])])]),s("div",sSe,[t[30]||(t[30]=s("label",null,"Волатильность рынка (σ)",-1)),s("div",lSe,[T(s("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=e=>z.value.marketVol=e),min:"0.05",max:"0.8",step:"0.01"},null,512),[[k,z.value.marketVol,void 0,{number:!0}]])])]),s("div",cSe,[t[31]||(t[31]=s("label",null,"Ожидаемая доходность (μ)",-1)),s("div",uSe,[T(s("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=e=>z.value.expectedReturn=e),min:"0",max:"0.5",step:"0.01"},null,512),[[k,z.value.expectedReturn,void 0,{number:!0}]])])]),s("div",dSe,[t[32]||(t[32]=s("label",null,"Количество траекторий Монте-Карло",-1)),s("div",hSe,[T(s("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>z.value.monteCarloTrajectories=e),min:"100",max:"100000",step:"100"},null,512),[[k,z.value.monteCarloTrajectories,void 0,{number:!0}]])])])])]),s("div",pSe,[s("div",fSe,[s("div",mSe,[t[35]||(t[35]=s("div",{class:"panel-header"},[s("h3",null,"Состав портфеля")],-1)),s("div",vSe,[s("div",gSe,[s("div",ySe,[s("table",bSe,[t[34]||(t[34]=s("thead",null,[s("tr",null,[s("th",null,"Инструмент"),s("th",{class:"text-right"},"Цена"),s("th",{class:"text-right"},"День %"),s("th",{class:"text-right"},"Позиция"),s("th",{class:"text-right"},"Вес")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(O.value,e=>(w(),i("tr",{key:e.symbol},[s("td",null,[s("div",xSe,[s("div",{class:"asset-icon",style:y({background:e.color})},v(e.symbol[0]),5),s("div",wSe,[s("span",_Se,v(e.symbol),1),s("span",SSe,v(e.name),1)])])]),s("td",MSe,"₽"+v(e.price),1),s("td",TSe,[s("span",{class:c(["change-pill",e.dayChange>0?"text-green":"text-red"])},v(e.dayChange>0?"+":"")+v(e.dayChange)+"% ",3)]),s("td",kSe,"₽"+v((e.notional/1e3).toFixed(1))+"k",1),s("td",CSe,v(e.allocation)+"%",1)]))),128))])])])])])])]),s("div",ASe,[s("div",ESe,[t[44]||(t[44]=s("div",{class:"panel-header"},[s("h3",null,"3D Тепловая карта активов")],-1)),s("div",ISe,[t[43]||(t[43]=s("div",{id:"correlation-3d-heatmap",class:"static-3d-plot",style:{width:"100%",height:"500px",position:"relative","min-height":"500px",background:"transparent","border-radius":"8px"}},null,-1)),U.value?(w(),i("div",RSe,[s("div",DSe,[s("div",{class:"asset-icon",style:y({background:U.value.color})},v(U.value.symbol[0]),5),s("div",null,[s("div",PSe,v(U.value.symbol),1),s("div",LSe,v(U.value.name),1)])]),s("div",NSe,[s("div",OSe,[t[36]||(t[36]=s("span",null,"Тип:",-1)),s("strong",null,v(U.value.symbol.includes("SU")||U.value.symbol.includes("RU000")?"Облигация":"Акция"),1)]),void 0!==U.value.volatility?(w(),i("div",FSe,[t[37]||(t[37]=s("span",null,"Волатильность:",-1)),s("strong",null,v(U.value.volatility?.toFixed(1)||"N/A")+"%",1)])):l("",!0),void 0!==U.value.avgCorrelation?(w(),i("div",BSe,[t[38]||(t[38]=s("span",null,"Ср. корреляция:",-1)),s("strong",null,v(U.value.avgCorrelation?.toFixed(2)||"N/A"),1)])):l("",!0),s("div",USe,[t[39]||(t[39]=s("span",null,"Вес в портфеле:",-1)),s("strong",null,v(U.value.allocation?.toFixed(2)||U.value.allocation)+"%",1)]),s("div",zSe,[t[40]||(t[40]=s("span",null,"Цена:",-1)),s("strong",null,v(U.value.price?.toLocaleString("ru-RU")||U.value.price)+" ₽",1)]),s("div",VSe,[t[41]||(t[41]=s("span",null,"Дневное изм.:",-1)),s("strong",{class:c(U.value.dayChange>=0?"text-green":"text-red")},v(U.value.dayChange>=0?"+":"")+v(U.value.dayChange?.toFixed(2)||U.value.dayChange)+"% ",3)]),U.value.notional?(w(),i("div",HSe,[t[42]||(t[42]=s("span",null,"Позиция:",-1)),s("strong",null,"₽"+v((U.value.notional/1e3).toFixed(1))+"k",1)])):l("",!0)])])):l("",!0)])])])]),s("div",GSe,[s("div",WSe,[t[50]||(t[50]=s("div",{class:"panel-header"},[s("h3",null,"Моделирование волатильности (GARCH)")],-1)),s("div",qSe,[s("div",YSe,[s("div",jSe,[s("canvas",{ref_key:"garchChart",ref:Qe,id:"garch-chart"},null,512)]),s("div",XSe,[t[49]||(t[49]=s("div",{class:"garch-param-row"},[s("span",{class:"param-name"},"GARCH(1,1):"),s("span",{class:"param-value"},[m("σ²"),s("sub",null,"t"),m(" = ω + αε²"),s("sub",null,"t-1"),m(" + βσ²"),s("sub",null,"t-1")])],-1)),s("div",$Se,[s("div",KSe,[t[45]||(t[45]=s("span",{class:"stat-label"},"α (ARCH)",-1)),s("span",ZSe,v(et.value?.result?.parameters?.alpha?.toFixed(3)||"0.082"),1)]),s("div",JSe,[t[46]||(t[46]=s("span",{class:"stat-label"},"β (GARCH)",-1)),s("span",QSe,v(et.value?.result?.parameters?.beta?.toFixed(3)||"0.893"),1)]),s("div",eMe,[t[47]||(t[47]=s("span",{class:"stat-label"},"ω",-1)),s("span",tMe,v(et.value?.result?.parameters?.omega?.toFixed(6)||"0.000025"),1)]),s("div",aMe,[t[48]||(t[48]=s("span",{class:"stat-label"},"Long-term Vol",-1)),s("span",nMe,v(et.value?.result?.long_term_volatility?(100*et.value.result.long_term_volatility).toFixed(1)+"%":"18.2%"),1)])])])])])])]),s("div",rMe,[s("div",iMe,[s("div",oMe,[t[56]||(t[56]=s("div",{class:"panel-header"},[s("h3",null,"Фильтрация активов по GARCH")],-1)),s("div",sMe,[s("div",lMe,[s("div",cMe,[s("div",uMe,[t[51]||(t[51]=s("span",{class:"summary-label"},"Всего активов",-1)),s("span",dMe,v(O.value.length),1)]),s("div",hMe,[t[52]||(t[52]=s("span",{class:"summary-label"},"Прошли фильтр",-1)),s("span",pMe,v(je.value),1)]),s("div",fMe,[t[53]||(t[53]=s("span",{class:"summary-label"},"Отклонены",-1)),s("span",mMe,v(O.value.length-je.value),1)])]),t[55]||(t[55]=I('<div class="filtering-criteria" data-v-baa812ed><div class="criteria-title" data-v-baa812ed>Критерии фильтрации:</div><div class="criteria-list" data-v-baa812ed><div class="criteria-item" data-v-baa812ed><span class="criteria-check" data-v-baa812ed>✓</span><span data-v-baa812ed>GARCH волатильность ≤ 30%</span></div><div class="criteria-item" data-v-baa812ed><span class="criteria-check" data-v-baa812ed>✓</span><span data-v-baa812ed>Стабильность параметров (α + β &lt; 1)</span></div><div class="criteria-item" data-v-baa812ed><span class="criteria-check" data-v-baa812ed>✓</span><span data-v-baa812ed>Достаточная ликвидность</span></div></div></div>',1)),s("div",vMe,[t[54]||(t[54]=s("div",{class:"filtered-title"},"Прошедшие фильтр (топ-10):",-1)),s("div",gMe,[(w(!0),i(p,null,f(Ye.value.slice(0,10),(e,t)=>(w(),i("div",{key:t,class:"filtered-asset"},[s("span",yMe,v(e.symbol),1),s("span",bMe,v(e.garchVol)+"%",1)]))),128))])])])])])]),s("div",xMe,[s("div",wMe,[t[61]||(t[61]=s("div",{class:"panel-header"},[s("h3",null,"Историческая и дивидендная доходность")],-1)),s("div",_Me,[s("div",SMe,[s("div",MMe,[s("table",TMe,[t[57]||(t[57]=s("thead",null,[s("tr",null,[s("th",null,"Актив"),s("th",{class:"text-right"},"Историческая"),s("th",{class:"text-right"},"Дивидендная"),s("th",{class:"text-right"},"Итого")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(Xe.value.slice(0,10),(e,t)=>(w(),i("tr",{key:t},[s("td",null,[s("div",kMe,[s("div",{class:"asset-icon",style:y({background:e.color})},v(e.symbol[0]),5),s("div",CMe,[s("span",AMe,v(e.symbol),1),s("span",EMe,v(e.name),1)])])]),s("td",IMe,v((100*e.historicalYield).toFixed(2))+"%",1),s("td",RMe,v((100*e.dividendYield).toFixed(2))+"%",1),s("td",DMe,v((100*e.totalYield).toFixed(2))+"%",1)]))),128))])])])]),s("div",PMe,[s("div",LMe,[t[58]||(t[58]=s("span",{class:"summary-label"},"Средняя историческая доходность",-1)),s("span",NMe,v((100*$e.value).toFixed(2))+"%",1)]),s("div",OMe,[t[59]||(t[59]=s("span",{class:"summary-label"},"Средняя дивидендная доходность",-1)),s("span",FMe,v((100*Ke.value).toFixed(2))+"%",1)]),s("div",BMe,[t[60]||(t[60]=s("span",{class:"summary-label"},"Средняя общая доходность",-1)),s("span",UMe,v((100*Ze.value).toFixed(2))+"%",1)])])])])])]),s("div",zMe,[s("div",VMe,[s("div",HMe,[t[62]||(t[62]=s("h3",null,"Траектории симуляции методом Монте-Карло",-1)),Y.value?(w(),i("span",GMe,"● LIVE")):l("",!0)]),Z.paths.length?(w(),i("div",WMe,[s("button",{class:"icon-btn",onClick:ee,title:"Play/Pause"},[Y.value?(w(),i("span",qMe,"⏸")):(w(),i("span",YMe,"▶"))]),s("div",jMe,[T(s("input",{type:"range",min:"0",max:K.value,"onUpdate:modelValue":t[8]||(t[8]=e=>q.value=e),onInput:te,class:"timeline-slider"},null,40,XMe),[[k,q.value,void 0,{number:!0}]]),s("div",{class:"timeline-track",style:y({width:q.value/K.value*100+"%"})},null,4)]),s("div",$Me,[t[63]||(t[63]=m(" День: ",-1)),s("span",KMe,v(q.value),1),t[64]||(t[64]=m(" / ",-1)),s("span",ZMe,v(K.value),1)]),s("button",{class:"icon-btn",onClick:ae,title:"Reset"},"↺")])):l("",!0)]),s("div",JMe,[s("div",{class:"trajectories-chart-container",ref_key:"trajectoriesChartContainer",ref:X},[Z.paths.length>0?(w(),i("svg",QMe,[t[65]||(t[65]=s("line",{x1:"0",y1:"350",x2:"1000",y2:"350",stroke:"rgba(255,255,255,0.05)"},null,-1)),t[66]||(t[66]=s("line",{x1:"0",y1:"200",x2:"1000",y2:"200",stroke:"rgba(255,255,255,0.05)"},null,-1)),t[67]||(t[67]=s("line",{x1:"0",y1:"50",x2:"1000",y2:"50",stroke:"rgba(255,255,255,0.05)"},null,-1)),s("line",{x1:"0",y1:Ve($.value),x2:"1000",y2:Ve($.value),stroke:"rgba(255,255,255,0.2)","stroke-dasharray":"4"},null,8,eTe),(w(!0),i(p,null,f(Z.displayPaths,(e,t)=>(w(),i("path",{key:`trajectory-path-${t}`,d:He(e,q.value),fill:"none",stroke:"rgba(59, 130, 246, 0.2)","stroke-width":"1"},null,8,tTe))),128)),s("path",{d:Ge(Z.q05,Z.q95,q.value),fill:"rgba(59, 130, 246, 0.1)",stroke:"none"},null,8,aTe),s("path",{d:He(Z.medianPath,q.value),fill:"none",stroke:"#3b82f6","stroke-width":"2.5"},null,8,nTe),s("path",{d:He(Z.q05,q.value),fill:"none",stroke:"#f87171","stroke-width":"1.5","stroke-dasharray":"4"},null,8,rTe),s("path",{d:He(Z.q95,q.value),fill:"none",stroke:"#34d399","stroke-width":"1.5","stroke-dasharray":"4"},null,8,iTe),q.value>0?(w(),i("line",{key:0,x1:ze(q.value),y1:"0",x2:ze(q.value),y2:"400",stroke:"rgba(255,255,255,0.4)","stroke-dasharray":"2"},null,8,oTe)):l("",!0)])):(w(),i("div",sTe,[...t[68]||(t[68]=[s("span",null,"Генерация траекторий на основе параметров HJB модели",-1)])]))],512)])]),s("div",lTe,[s("div",cTe,[s("div",uTe,[t[69]||(t[69]=s("h3",null,"3D визуализация траекторий",-1)),me.value?(w(),i("span",dTe,"● LIVE")):l("",!0)]),he.value&&he.value.paths.length?(w(),i("div",hTe,[s("button",{class:"icon-btn",onClick:Ce,title:"Play/Pause"},[me.value?(w(),i("span",pTe,"⏸")):(w(),i("span",fTe,"▶"))]),s("div",mTe,[T(s("input",{type:"range",min:"0",max:ye.value,"onUpdate:modelValue":t[9]||(t[9]=e=>ve.value=e),onInput:Ae,class:"timeline-slider"},null,40,vTe),[[k,ve.value,void 0,{number:!0}]]),s("div",{class:"timeline-track",style:y({width:(ye.value>0?ve.value/ye.value*100:0)+"%"})},null,4)]),s("div",gTe,[t[70]||(t[70]=m(" Шаг: ",-1)),s("span",yTe,v(ve.value),1),t[71]||(t[71]=m(" / ",-1)),s("span",bTe,v(ye.value),1)]),s("button",{class:"icon-btn",onClick:Ee,title:"Reset"},"↺")])):l("",!0)]),s("div",xTe,[s("div",wTe,[s("canvas",{ref_key:"trajectories3DCanvas",ref:re,class:"trajectories-3d-canvas"},null,512)])])]),he.value&&he.value.paths.length?(w(),i("div",_Te,[t[78]||(t[78]=s("div",{class:"panel-header"},[s("h3",null,"Итоги симуляций")],-1)),s("div",STe,[s("div",MTe,[s("div",TTe,[t[72]||(t[72]=s("div",{class:"metric-label"},"Средняя доходность портфеля",-1)),s("div",{class:c(["metric-value",we.value>=0?"text-green":"text-red"])},v(be(we.value)),3)]),s("div",kTe,[t[73]||(t[73]=s("div",{class:"metric-label"},"Медианная доходность портфеля",-1)),s("div",{class:c(["metric-value",_e.value>=0?"text-green":"text-red"])},v(be(_e.value)),3)]),s("div",CTe,[t[74]||(t[74]=s("div",{class:"metric-label"},"Sharpe Ratio",-1)),s("div",{class:c(["metric-value",Se.value>=0?"text-green":"text-red"])},v(Se.value.toFixed(2)),3)]),s("div",ATe,[t[75]||(t[75]=s("div",{class:"metric-label"},"VaR (95%)",-1)),s("div",ETe,v(be(Me.value)),1)]),s("div",ITe,[t[76]||(t[76]=s("div",{class:"metric-label"},"CVaR (95%)",-1)),s("div",RTe,v(be(Te.value)),1)]),s("div",DTe,[t[77]||(t[77]=s("div",{class:"metric-label"},"Средний MDD",-1)),s("div",PTe,v(be(ke.value)),1)])])])])):l("",!0)],64)):(w(),i(p,{key:1},[s("div",LTe,[s("div",NTe,[t[83]||(t[83]=s("h1",null,"CCMV Optimization",-1)),s("div",OTe,[s("span",FTe,[t[79]||(t[79]=m("Метод: ",-1)),s("strong",null,v("delta"===yt.value.method?"Δ-CCMV":"α-CCMV"),1)]),s("span",BTe,[t[80]||(t[80]=m("Кластеров: ",-1)),s("strong",null,v(vt.value.numClusters),1)]),s("span",UTe,[t[81]||(t[81]=m("Банк: ",-1)),s("strong",null,v(B.value.name),1)]),s("span",zTe,[t[82]||(t[82]=m("Активов: ",-1)),s("strong",null,v(O.value.length),1)])])]),s("div",VTe,[s("button",{class:"btn-glass primary",onClick:Et,disabled:_.value},[_.value?(w(),i("span",WTe)):(w(),i("svg",GTe,[...t[84]||(t[84]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),m(" "+v(_.value?"Расчёт...":"Пересчитать"),1)],8,HTe)])]),s("div",qTe,[s("div",YTe,[s("div",jTe,[t[86]||(t[86]=s("div",{class:"panel-header"},[s("h3",null,"Состав портфеля")],-1)),s("div",XTe,[s("div",$Te,[s("div",KTe,[s("table",ZTe,[t[85]||(t[85]=s("thead",null,[s("tr",null,[s("th",null,"Инструмент"),s("th",{class:"text-right"},"Цена"),s("th",{class:"text-right"},"День %"),s("th",{class:"text-right"},"Позиция"),s("th",{class:"text-right"},"Вес")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(O.value,e=>(w(),i("tr",{key:e.symbol},[s("td",null,[s("div",JTe,[s("div",{class:"asset-icon",style:y({background:e.color})},v(e.symbol[0]),5),s("div",QTe,[s("span",eke,v(e.symbol),1),s("span",tke,v(e.name),1)])])]),s("td",ake,"₽"+v(e.price),1),s("td",nke,[s("span",{class:c(["change-pill",e.dayChange>0?"text-green":"text-red"])},v(e.dayChange>0?"+":"")+v(e.dayChange)+"% ",3)]),s("td",rke,"₽"+v((e.notional/1e3).toFixed(1))+"k",1),s("td",ike,v(e.allocation)+"%",1)]))),128))])])])])])])]),s("div",oke,[s("div",ske,[s("div",lke,[t[87]||(t[87]=s("h3",null,"Параметры оптимизации",-1)),s("div",cke,[s("div",{class:"tab-slider",style:y(L.value)},null,4),s("button",{ref:"el => paramsTabButtons.basic = el",class:c(["tab-btn",{active:"basic"===E.value}]),onClick:t[10]||(t[10]=e=>E.value="basic")}," Основные ",2),s("button",{ref:"el => paramsTabButtons.methodology = el",class:c(["tab-btn",{active:"methodology"===E.value}]),onClick:t[11]||(t[11]=e=>E.value="methodology")}," Методология ",2)])]),s("div",uke,["basic"===E.value?(w(),i("div",dke,[s("div",hke,[t[88]||(t[88]=s("label",null,"Максимум активов (Δ)",-1)),s("div",pke,[T(s("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=e=>yt.value.Delta=e),min:"1",max:vt.value.numAssets,onInput:Et},null,40,fke),[[k,yt.value.Delta,void 0,{number:!0}]]),s("span",mke,"из "+v(vt.value.numAssets),1)])]),s("div",vke,[t[89]||(t[89]=s("label",null,"Макс. вес на актив (w̄)",-1)),s("div",gke,[T(s("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=e=>yt.value.bar_w=e),min:"0.01",max:"1",step:"0.01",onInput:Et},null,544),[[k,yt.value.bar_w,void 0,{number:!0}]]),s("span",yke,v((100*yt.value.bar_w).toFixed(1))+"%",1)])]),s("div",bke,[t[91]||(t[91]=s("label",null,"Коэффициент неприятия риска (γ)",-1)),s("div",xke,[T(s("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=e=>yt.value.gamma=e),min:"0.1",max:"10",step:"0.1",onInput:Et},null,544),[[k,yt.value.gamma,void 0,{number:!0}]]),t[90]||(t[90]=s("span",{class:"param-hint"},"выше = консервативнее",-1))])])])):l("",!0),"methodology"===E.value?(w(),i("div",wke,[s("div",_ke,[t[94]||(t[94]=s("label",null,"Методология",-1)),s("div",Ske,[s("label",Mke,[T(s("input",{type:"radio","onUpdate:modelValue":t[15]||(t[15]=e=>yt.value.method=e),value:"delta",onChange:Et},null,544),[[V,yt.value.method]]),t[92]||(t[92]=s("span",null,"Δ-CCMV (по количеству активов)",-1))]),s("label",Tke,[T(s("input",{type:"radio","onUpdate:modelValue":t[16]||(t[16]=e=>yt.value.method=e),value:"alpha",onChange:Et},null,544),[[V,yt.value.method]]),t[93]||(t[93]=s("span",null,"α-CCMV (по распределению)",-1))])])])])):l("",!0)])]),s("div",kke,[t[98]||(t[98]=s("div",{class:"panel-header"},[s("h3",null,"Целевая функция")],-1)),s("div",Cke,[s("div",Ake,[t[95]||(t[95]=s("span",{class:"label"},"f*(Δ, α) =",-1)),s("span",Eke,v(wt.value.toFixed(6)),1)]),s("div",Ike,[s("div",Rke,[t[96]||(t[96]=s("span",{class:"comp-label"},"Риск",-1)),s("span",Dke,v(_t.value.variance.toFixed(6)),1)]),s("div",Pke,[t[97]||(t[97]=s("span",{class:"comp-label"},"Возврат",-1)),s("span",Lke,v((_t.value.return*yt.value.gamma).toFixed(6)),1)])])])])])]),s("div",Nke,[s("div",Oke,[s("div",Fke,[s("div",Bke,[t[99]||(t[99]=s("h3",null,"Сравнение весов",-1)),s("div",Uke,[s("div",{class:"tab-slider",style:y(N.value)},null,4),s("button",{ref:"el => weightsTabButtons.comparison = el",class:c(["tab-btn",{active:"comparison"===C.value}]),onClick:t[17]||(t[17]=e=>C.value="comparison")}," Сравнение ",2),s("button",{ref:"el => weightsTabButtons.optimal = el",class:c(["tab-btn",{active:"optimal"===C.value}]),onClick:t[18]||(t[18]=e=>C.value="optimal")}," Оптимальные ",2)])]),s("div",zke,["comparison"===C.value?(w(),i("div",Vke,[s("div",Hke,[s("table",Gke,[t[100]||(t[100]=s("thead",null,[s("tr",null,[s("th",null,"Инструмент"),s("th",{class:"text-right"},"Текущий вес"),s("th",{class:"text-right"},"Оптимальный вес"),s("th",{class:"text-right"},"Изменение")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(O.value,e=>{return w(),i("tr",{key:e.symbol},[s("td",null,[s("div",Wke,[s("div",{class:"asset-icon",style:y({background:e.color})},v(e.symbol[0]),5),s("div",qke,[s("span",Yke,v(e.symbol),1),s("span",jke,v(e.name),1)])])]),s("td",Xke,v(e.allocation)+"%",1),s("td",$ke,v(Tt(e.symbol).toFixed(1))+"% ",1),s("td",Kke,[s("span",{class:c(["change-pill",(t=kt(e),Math.abs(t)<.1?"neutral":t>0?"positive":"negative")])},v(kt(e)>0?"+":"")+v(kt(e).toFixed(1))+"% ",3)])]);var t}),128))])])])])):l("",!0),"optimal"===C.value?(w(),i("div",Zke,[s("div",Jke,[(w(!0),i(p,null,f(O.value,e=>(w(),i("div",{key:e.symbol,class:"weight-bar-container"},[s("div",Qke,[s("div",{class:"asset-icon-small",style:y({background:e.color})},v(e.symbol[0]),5),s("div",eCe,v(e.symbol),1)]),s("div",tCe,[s("div",{class:"weight-bar-fill",style:y({width:Tt(e.symbol)+"%",background:e.color})},null,4)]),s("div",aCe,v(Tt(e.symbol).toFixed(1))+"%",1)]))),128))])])):l("",!0)])])]),s("div",nCe,[s("div",rCe,[t[104]||(t[104]=s("div",{class:"panel-header"},[s("h3",null,"Иерархическая кластеризация")],-1)),s("div",iCe,[s("div",oCe,[s("div",sCe,[t[101]||(t[101]=s("span",{class:"label"},"Количество кластеров:",-1)),s("span",lCe,v(vt.value.numClusters),1)]),s("div",cCe,[t[102]||(t[102]=s("span",{class:"label"},"Активов в портфеле:",-1)),s("span",uCe,v(O.value.length),1)]),t[103]||(t[103]=I('<div class="info-row" data-v-baa812ed><span class="label" data-v-baa812ed>Метрика расстояния:</span><span class="value mono" data-v-baa812ed>1 - ρ (корреляция)</span></div><div class="info-row" data-v-baa812ed><span class="label" data-v-baa812ed>Метод кластеризации:</span><span class="value mono" data-v-baa812ed>Иерархическая (Ward)</span></div>',2))]),s("div",dCe,[(w(!0),i(p,null,f(vt.value.clusters,(e,t)=>(w(),i("div",{class:"cluster-row",key:t},[s("div",{class:"cluster-badge",style:y({background:gt[t%gt.length]})}," C"+v(t+1),5),s("div",hCe,[s("div",pCe,"Кластер "+v(t+1),1),s("div",fCe,[(w(!0),i(p,null,f(e.assets,e=>(w(),i("div",{class:"asset-tag",key:e},[s("span",mCe,v(e),1),Ct(e)?(w(),i("span",vCe,v(Ct(e))+"% ",1)):l("",!0)]))),128))])]),s("div",gCe,v(e.assets.length)+" "+v(1===e.assets.length?"актив":e.assets.length<5?"актива":"активов"),1)]))),128))])])])])]),s("div",yCe,[s("div",bCe,[s("div",xCe,[t[106]||(t[106]=s("div",{class:"panel-header"},[s("h3",null,"Метрики по кластерам")],-1)),s("div",wCe,[s("table",_Ce,[t[105]||(t[105]=s("thead",null,[s("tr",null,[s("th",null,"Кластер"),s("th",null,"μ (E[R])"),s("th",null,"σ (Vol)"),s("th",null,"ρ̄"),s("th",null,"Δₖ"),s("th",null,"αₖ")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(bt.value,(e,t)=>(w(),i("tr",{key:t},[s("td",null,[s("div",SCe,[s("div",{class:"cluster-dot",style:y({background:gt[t]})},null,4),s("span",null,"C"+v(t+1),1)])]),s("td",MCe,v((100*e.expectedReturn).toFixed(2))+"%",1),s("td",TCe,v((100*e.volatility).toFixed(2))+"%",1),s("td",kCe,v(e.avgCorrelation.toFixed(3)),1),s("td",CCe,v(e.deltaK),1),s("td",ACe,v((100*e.alphaK).toFixed(1))+"%",1)]))),128))])])])])]),s("div",ECe,[s("div",ICe,[t[108]||(t[108]=s("div",{class:"panel-header"},[s("h3",null,"Распределение по кластерам")],-1)),s("div",RCe,[s("div",DCe,[(w(!0),i(p,null,f(Mt.value,(e,a)=>(w(),i("div",{key:a,class:"alloc-segment",style:y({flexGrow:e.percentage,background:gt[a]})},[s("span",PCe,[m(" C"+v(a+1),1),t[107]||(t[107]=s("br",null,null,-1)),m(v(e.percentage.toFixed(1))+"% ",1)])],4))),128))]),s("div",LCe,[(w(!0),i(p,null,f(Mt.value,(e,t)=>(w(),i("div",{key:t,class:"alloc-row"},[s("div",{class:"alloc-dot",style:y({background:gt[t]})},null,4),s("span",NCe,"Кластер "+v(t+1),1),s("span",OCe,v(e.percentage.toFixed(1))+"%",1)]))),128))])])])]),s("div",FCe,[s("div",BCe,[t[113]||(t[113]=s("div",{class:"panel-header"},[s("h3",null,"Статистика портфеля")],-1)),s("div",UCe,[s("div",zCe,[t[109]||(t[109]=s("span",{class:"stat-label"},"Expected Return",-1)),s("span",VCe,v((100*St.value.expectedReturn).toFixed(2))+"%",1)]),s("div",HCe,[t[110]||(t[110]=s("span",{class:"stat-label"},"Volatility",-1)),s("span",GCe,v((100*St.value.volatility).toFixed(2))+"%",1)]),s("div",WCe,[t[111]||(t[111]=s("span",{class:"stat-label"},"Sharpe Ratio",-1)),s("span",qCe,v(St.value.sharpeRatio.toFixed(3)),1)]),s("div",YCe,[t[112]||(t[112]=s("span",{class:"stat-label"},"Кол-во позиций",-1)),s("span",jCe,v(St.value.numPositions),1)])])])])])],64)),u(M,{name:"slide-up"},{default:h(()=>[mt.value.show?(w(),i("div",{key:0,class:c(["toast-notification","toast-"+mt.value.type])},v(mt.value.message),3)):l("",!0)]),_:1})]))}}),$Ce=xe(XCe,[["__scopeId","data-v-baa812ed"]]),KCe="   https://stochastic-dashbord-v1-production.up.railway.app";async function ZCe(e){const t=await fetch(e);if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return t.json()}async function JCe(){return ZCe(`${KCe}/api/macro-data/cbr/rates`)}async function QCe(){return ZCe(`${KCe}/api/macro-data/cbr/key-rate`)}async function eAe(e){return async function(e,t){const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){const e=await a.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${a.status}`)}return a.json()}(`${KCe}/api/macro-data/openfigi/map`,e)}const tAe={class:"page-container"},aAe={class:"section-header"},nAe={class:"header-actions"},rAe=["disabled"],iAe={class:"tabs-navigation"},oAe=["onClick"],sAe={class:"tab-label"},lAe={class:"macro-grid"},cAe={class:"grid-content"},uAe={class:"glass-panel"},dAe={key:0,class:"key-rate-display"},hAe={class:"rate-value font-mono"},pAe={key:1,class:"chart-container"},fAe={key:2,class:"text-muted"},mAe={class:"glass-panel"},vAe={key:0,class:"rates-table-wrap"},gAe={class:"data-table"},yAe={class:"font-mono"},bAe={class:"font-mono text-right"},xAe={class:"font-mono text-right"},wAe={key:1,class:"text-muted"},_Ae={class:"grid-content"},SAe={class:"glass-panel"},MAe={class:"control-row mb-4"},TAe={key:0,class:"rates-table-wrap"},kAe={class:"data-table"},CAe={class:"font-mono"},AAe={class:"font-mono text-right"},EAe={key:1,class:"text-muted"},IAe={class:"grid-content"},RAe={class:"glass-panel"},DAe={class:"fred-controls"},PAe={class:"control-row mb-4"},LAe={class:"input-group"},NAe={class:"quick-buttons"},OAe=["onClick"],FAe={key:0,class:"chart-container"},BAe={key:1,class:"fred-info font-mono text-muted mt-2"},UAe={class:"glass-panel"},zAe={class:"control-row mb-4"},VAe={key:0,class:"rates-table-wrap"},HAe={class:"data-table"},GAe={class:"font-mono"},WAe={class:"font-mono"},qAe={class:"font-mono"},YAe=["onClick"],jAe={class:"grid-content"},XAe={class:"glass-panel"},$Ae={class:"control-row mb-4"},KAe={class:"input-group"},ZAe={key:0,class:"sec-info mb-4"},JAe={class:"font-mono"},QAe={class:"font-mono text-muted"},eEe={key:1,class:"rates-table-wrap"},tEe={class:"data-table"},aEe={class:"font-mono"},nEe={class:"font-mono"},rEe={class:"glass-panel"},iEe={class:"control-row mb-4"},oEe={class:"input-group"},sEe={key:0,class:"rates-table-wrap"},lEe={key:1,class:"text-red font-mono"},cEe={key:0,class:"error-banner"},uEe=e({__name:"MacroDashboard",setup(e){re.register(...ie);const a=t("cbr"),r=t(!1),o=t(""),d=[{id:"cbr",name:"ЦБ РФ"},{id:"ecb",name:"ЕЦБ"},{id:"fred",name:"FRED"},{id:"sec",name:"SEC / FIGI"}],g=t(null),y=t(null),b=t(null);let x=null;const _=t([]),S=["USD","EUR","GBP","CNY","JPY","CHF","TRY","KZT","BYN","AED"];async function C(){try{const[e,t]=await Promise.all([JCe(),QCe()]);g.value=e,y.value=t,_.value=e.rates.filter(e=>S.includes(e.char_code)),await A(),function(){if(!b.value||!y.value)return;x&&x.destroy();const e=[...y.value.history].reverse().slice(-60);x=new re(b.value,{type:"line",data:{labels:e.map(e=>e.date.slice(0,10)),datasets:[{label:"Ключевая ставка (%)",data:e.map(e=>e.rate),borderColor:"#DC2626",backgroundColor:"rgba(220,38,38,0.1)",fill:!0,tension:.3,pointRadius:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#aaa"}}},scales:{x:{ticks:{color:"#666",maxTicksLimit:12},grid:{color:"#1a1a1a"}},y:{ticks:{color:"#666"},grid:{color:"#1a1a1a"}}}}})}()}catch(TQe){o.value=`CBR: ${TQe.message}`}}const E=t("EUR"),I=t(null);async function R(){try{I.value=await async function(e="EUR"){return ZCe(`${KCe}/api/macro-data/ecb/latest?base=${e}`)}(E.value)}catch(TQe){o.value=`ECB: ${TQe.message}`}}const L=t("CPIAUCSL"),N=t(null),O=t(null);let F=null;const B=t(""),z=t(null),V=[{id:"GDP",label:"GDP"},{id:"CPIAUCSL",label:"CPI"},{id:"UNRATE",label:"Безработица"},{id:"DFF",label:"Fed Funds Rate"},{id:"M2SL",label:"M2"},{id:"DGS10",label:"US 10Y"}];async function H(){if(L.value)try{N.value=await async function(e,t=100,a="desc"){return ZCe(`${KCe}/api/macro-data/fred/series?series_id=${encodeURIComponent(e)}&limit=${t}&sort_order=${a}`)}(L.value,200,"asc"),await A(),function(){if(!O.value||!N.value)return;F&&F.destroy();const e=N.value.observations.filter(e=>null!==e.value);F=new re(O.value,{type:"line",data:{labels:e.map(e=>e.date),datasets:[{label:N.value.series_id,data:e.map(e=>e.value),borderColor:"#3B82F6",backgroundColor:"rgba(59,130,246,0.1)",fill:!0,tension:.2,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#aaa"}}},scales:{x:{ticks:{color:"#666",maxTicksLimit:12},grid:{color:"#1a1a1a"}},y:{ticks:{color:"#666"},grid:{color:"#1a1a1a"}}}}})}()}catch(TQe){o.value=`FRED: ${TQe.message}`}}async function G(){if(B.value)try{z.value=await async function(e,t=20){return ZCe(`${KCe}/api/macro-data/fred/search?q=${encodeURIComponent(e)}&limit=${t}`)}(B.value)}catch(TQe){o.value=`FRED search: ${TQe.message}`}}const W=t(""),q=t(null);async function Y(){if(W.value)try{q.value=await async function(e){return ZCe(`${KCe}/api/macro-data/sec/filings/${encodeURIComponent(e)}`)}(W.value)}catch(TQe){o.value=`SEC: ${TQe.message}`}}const j=t(""),X=t([]);async function $(){if(j.value)try{X.value=await eAe([{idType:"ID_ISIN",idValue:j.value}])}catch(TQe){o.value=`FIGI: ${TQe.message}`}}async function K(){r.value=!0,o.value="";try{await Promise.all([C(),R()])}finally{r.value=!1}}return n(()=>{K()}),(e,t)=>(w(),i("div",tAe,[s("div",aAe,[t[5]||(t[5]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Макроэкономика"),s("p",{class:"section-subtitle"},"FRED, ЦБ РФ, ЕЦБ, SEC EDGAR, OpenFIGI")],-1)),s("div",nAe,[s("button",{class:"btn-glass",onClick:K,disabled:r.value},v(r.value?"Загрузка...":"Обновить"),9,rAe)])]),s("div",iAe,[(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>a.value=e.id,class:c(["tab-item",{active:a.value===e.id}])},[s("span",sAe,v(e.name),1)],10,oAe)),64))]),s("div",lAe,[u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",cAe,[s("div",uAe,[t[6]||(t[6]=s("h3",{class:"block-title"},"Ключевая ставка ЦБ РФ",-1)),y.value?(w(),i("div",dAe,[s("span",hAe,v(y.value.current_rate)+"%",1)])):l("",!0),y.value&&y.value.history.length?(w(),i("div",pAe,[s("canvas",{ref_key:"keyRateChartRef",ref:b},null,512)])):l("",!0),y.value||r.value?l("",!0):(w(),i("p",fAe,"Нажмите «Обновить» для загрузки данных"))]),s("div",mAe,[t[8]||(t[8]=s("h3",{class:"block-title"},"Курсы ЦБ РФ",-1)),g.value&&g.value.rates.length?(w(),i("div",vAe,[s("table",gAe,[t[7]||(t[7]=s("thead",null,[s("tr",null,[s("th",null,"Код"),s("th",null,"Валюта"),s("th",null,"Номинал"),s("th",null,"Курс (₽)")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(_.value,e=>(w(),i("tr",{key:e.char_code},[s("td",yAe,v(e.char_code),1),s("td",null,v(e.name),1),s("td",bAe,v(e.nominal),1),s("td",xAe,v(e.value.toFixed(4)),1)]))),128))])])])):l("",!0),g.value||r.value?l("",!0):(w(),i("p",wAe,"Нет данных"))])],512),[[P,"cbr"===a.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",_Ae,[s("div",SAe,[t[12]||(t[12]=s("h3",{class:"block-title"},"Курсы ЕЦБ (Frankfurter)",-1)),s("div",MAe,[t[10]||(t[10]=s("label",null,"Базовая валюта",-1)),T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),class:"glass-select",onChange:R},[...t[9]||(t[9]=[s("option",{value:"EUR"},"EUR",-1),s("option",{value:"USD"},"USD",-1),s("option",{value:"GBP"},"GBP",-1),s("option",{value:"RUB"},"RUB",-1)])],544),[[D,E.value]])]),I.value?(w(),i("div",TAe,[s("table",kAe,[t[11]||(t[11]=s("thead",null,[s("tr",null,[s("th",null,"Валюта"),s("th",null,"Курс")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(I.value.rates,(e,t)=>(w(),i("tr",{key:t},[s("td",CAe,v(t),1),s("td",AAe,v(Number(e).toFixed(4)),1)]))),128))])])])):l("",!0),I.value||r.value?l("",!0):(w(),i("p",EAe,"Нажмите «Обновить»"))])],512),[[P,"ecb"===a.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",IAe,[s("div",RAe,[t[14]||(t[14]=s("h3",{class:"block-title"},"Индикаторы FRED",-1)),s("div",DAe,[s("div",PAe,[t[13]||(t[13]=s("label",null,"Series ID",-1)),s("div",LAe,[T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),class:"glass-input",placeholder:"GDP, CPIAUCSL, UNRATE, DFF, M2SL..."},null,512),[[k,L.value]]),s("button",{class:"btn-glass xs",onClick:H},"Загрузить")])]),s("div",NAe,[(w(),i(p,null,f(V,e=>s("button",{key:e.id,class:"btn-glass xs",onClick:t=>{L.value=e.id,H()}},v(e.label),9,OAe)),64))])]),N.value?(w(),i("div",FAe,[s("canvas",{ref_key:"fredChartRef",ref:O},null,512)])):l("",!0),N.value?(w(),i("div",BAe,v(N.value.series_id)+" — "+v(N.value.count)+" obs. ",1)):l("",!0)]),s("div",UAe,[t[16]||(t[16]=s("h3",{class:"block-title"},"Поиск серий FRED",-1)),s("div",zAe,[T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>B.value=e),class:"glass-input full",placeholder:"Search: inflation, unemployment, GDP...",onKeyup:U(G,["enter"])},null,544),[[k,B.value]]),s("button",{class:"btn-glass xs",onClick:G},"Поиск")]),z.value&&z.value.series.length?(w(),i("div",VAe,[s("table",HAe,[t[15]||(t[15]=s("thead",null,[s("tr",null,[s("th",null,"ID"),s("th",null,"Название"),s("th",null,"Частота"),s("th",null,"Единицы"),s("th")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(z.value.series,e=>(w(),i("tr",{key:e.id},[s("td",GAe,v(e.id),1),s("td",null,v(e.title),1),s("td",WAe,v(e.frequency),1),s("td",qAe,v(e.units),1),s("td",null,[s("button",{class:"btn-glass xs",onClick:t=>{L.value=e.id,H()}},"→",8,YAe)])]))),128))])])])):l("",!0)])],512),[[P,"fred"===a.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",jAe,[s("div",XAe,[t[19]||(t[19]=s("h3",{class:"block-title"},"SEC EDGAR — Поиск компании",-1)),s("div",$Ae,[t[17]||(t[17]=s("label",null,"CIK Number",-1)),s("div",KAe,[T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>W.value=e),class:"glass-input",placeholder:"0000320193 (Apple)"},null,512),[[k,W.value]]),s("button",{class:"btn-glass xs",onClick:Y},"Загрузить")])]),q.value?(w(),i("div",ZAe,[s("p",JAe,[s("strong",null,v(q.value.name),1),m(" (CIK: "+v(q.value.cik)+")",1)]),s("p",QAe,"Tickers: "+v(q.value.tickers.join(", "))+" | SIC: "+v(q.value.sic_description),1)])):l("",!0),q.value&&q.value.filings.length?(w(),i("div",eEe,[s("table",tEe,[t[18]||(t[18]=s("thead",null,[s("tr",null,[s("th",null,"Form"),s("th",null,"Date"),s("th",null,"Description")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(q.value.filings.slice(0,30),(e,t)=>(w(),i("tr",{key:t},[s("td",aEe,v(e.form),1),s("td",nEe,v(e.filing_date),1),s("td",null,v(e.description),1)]))),128))])])])):l("",!0)]),s("div",rEe,[t[21]||(t[21]=s("h3",{class:"block-title"},"OpenFIGI — Маппинг идентификаторов",-1)),s("div",iEe,[t[20]||(t[20]=s("label",null,"ISIN",-1)),s("div",oEe,[T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>j.value=e),class:"glass-input",placeholder:"US0378331005"},null,512),[[k,j.value]]),s("button",{class:"btn-glass xs",onClick:$},"Map")])]),X.value&&X.value.length?(w(),i("div",sEe,[(w(!0),i(p,null,f(X.value,(e,t)=>(w(),i("div",{key:t,class:"figi-result mb-2"},[e.data?(w(!0),i(p,{key:0},f(e.data,e=>(w(),i("div",{key:e.figi,class:"font-mono text-sm"},[s("strong",null,v(e.name),1),m(" — "+v(e.ticker)+" ("+v(e.exchCode)+") — FIGI: "+v(e.figi),1)]))),128)):l("",!0),e.error?(w(),i("div",lEe,v(e.error),1)):l("",!0)]))),128))])):l("",!0)])],512),[[P,"sec"===a.value]])]),_:1})]),o.value?(w(),i("div",cEe,v(o.value),1)):l("",!0)]))}}),dEe=xe(uEe,[["__scopeId","data-v-32cbb5d3"]]),hEe="   https://stochastic-dashbord-v1-production.up.railway.app";async function pEe(e){const t=await fetch(e);if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return t.json()}const fEe={class:"page-container"},mEe={class:"section-header"},vEe={class:"header-actions"},gEe=["disabled"],yEe={key:0,class:"stats-row"},bEe={class:"stat-card"},xEe={class:"stat-value font-mono"},wEe={class:"stat-card"},_Ee={class:"stat-value font-mono"},SEe={class:"stat-card"},MEe={class:"stat-value font-mono"},TEe={class:"stat-card"},kEe={class:"glass-panel"},CEe={class:"table-wrap"},AEe={class:"data-table"},EEe=["onClick"],IEe={class:"font-mono"},REe={class:"coin-cell"},DEe=["src","alt"],PEe={class:"coin-name"},LEe={class:"coin-symbol font-mono"},NEe={class:"font-mono text-right"},OEe={class:"font-mono text-right"},FEe={class:"font-mono text-right"},BEe={key:1,class:"glass-panel mt-4"},UEe={class:"block-title"},zEe={class:"chart-container"},VEe={key:2,class:"glass-panel mt-4"},HEe={class:"trending-grid"},GEe=["onClick"],WEe=["src"],qEe={class:"font-mono"},YEe={class:"coin-symbol font-mono"},jEe={class:"font-mono text-muted"},XEe={key:3,class:"error-banner"},$Ee=e({__name:"CryptoMarkets",setup(e){re.register(...ie);const a=t(!1),r=t(""),o=t("usd"),u=t([]),d=t(null),h=t(null),m=t(""),g=t(null);let y=null;const b=S(()=>{if(!h.value)return[];return(h.value?.coins||[]).map(e=>e.item).slice(0,10)});function x(e){return e>=1e12?(e/1e12).toFixed(2)+"T":e>=1e9?(e/1e9).toFixed(2)+"B":e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toFixed(2)}async function _(){try{u.value=await async function(e="usd",t=100,a=1){return pEe(`${hEe}/api/crypto-data/coingecko/markets?vs_currency=${e}&per_page=${t}&page=${a}`)}(o.value,50)}catch(TQe){r.value=TQe.message}}async function M(){try{d.value=await async function(){return pEe(`${hEe}/api/crypto-data/coingecko/global`)}()}catch(TQe){r.value=TQe.message}}async function k(){try{h.value=await async function(){return pEe(`${hEe}/api/crypto-data/coingecko/trending`)}()}catch(TQe){r.value=TQe.message}}async function C(){if(m.value)try{const e=await async function(e,t="usd",a=30){return pEe(`${hEe}/api/crypto-data/coingecko/coin/${encodeURIComponent(e)}/chart?vs_currency=${t}&days=${a}`)}(m.value,o.value,30);await A(),function(e){if(!g.value)return;y&&y.destroy();const t=e.prices||[];y=new re(g.value,{type:"line",data:{labels:t.map(e=>new Date(e[0]).toLocaleDateString()),datasets:[{label:`${m.value} (${o.value.toUpperCase()})`,data:t.map(e=>e[1]),borderColor:"#DC2626",backgroundColor:"rgba(220,38,38,0.1)",fill:!0,tension:.3,pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#aaa"}}},scales:{x:{ticks:{color:"#666",maxTicksLimit:10},grid:{color:"#1a1a1a"}},y:{ticks:{color:"#666"},grid:{color:"#1a1a1a"}}}}})}(e)}catch(TQe){r.value=TQe.message}}async function E(){a.value=!0,r.value="";try{await Promise.all([_(),M(),k()])}finally{a.value=!1}}return R(m,()=>{m.value&&C()}),n(()=>E()),(e,t)=>(w(),i("div",fEe,[s("div",mEe,[t[2]||(t[2]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Крипто рынки"),s("p",{class:"section-subtitle"},"CoinGecko + CoinGap")],-1)),s("div",vEe,[T(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),class:"glass-select",onChange:_},[...t[1]||(t[1]=[s("option",{value:"usd"},"USD",-1),s("option",{value:"eur"},"EUR",-1),s("option",{value:"rub"},"RUB",-1)])],544),[[D,o.value]]),s("button",{class:"btn-glass",onClick:E,disabled:a.value},v(a.value?"Загрузка...":"Обновить"),9,gEe)])]),d.value?(w(),i("div",yEe,[s("div",bEe,[t[3]||(t[3]=s("span",{class:"stat-label font-mono"},"Market Cap",-1)),s("span",xEe,"$"+v(x(d.value.total_market_cap?.usd||0)),1)]),s("div",wEe,[t[4]||(t[4]=s("span",{class:"stat-label font-mono"},"24h Volume",-1)),s("span",_Ee,"$"+v(x(d.value.total_volume?.usd||0)),1)]),s("div",SEe,[t[5]||(t[5]=s("span",{class:"stat-label font-mono"},"BTC Dominance",-1)),s("span",MEe,v((d.value.market_cap_percentage?.btc||0).toFixed(1))+"%",1)]),s("div",TEe,[t[6]||(t[6]=s("span",{class:"stat-label font-mono"},"24h Change",-1)),s("span",{class:c(["stat-value font-mono",d.value.market_cap_change_percentage_24h_usd>0?"text-green":"text-red"])},v((d.value.market_cap_change_percentage_24h_usd||0).toFixed(2))+"% ",3)])])):l("",!0),s("div",kEe,[t[8]||(t[8]=s("h3",{class:"block-title"},"Топ криптовалюты",-1)),s("div",CEe,[s("table",AEe,[t[7]||(t[7]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Монета"),s("th",{class:"text-right"},"Цена"),s("th",{class:"text-right"},"24h %"),s("th",{class:"text-right"},"7d %"),s("th",{class:"text-right"},"Market Cap"),s("th",{class:"text-right"},"Volume 24h")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(u.value,e=>(w(),i("tr",{key:e.id,onClick:t=>m.value=e.id,class:"clickable"},[s("td",IEe,v(e.market_cap_rank),1),s("td",null,[s("div",REe,[s("img",{src:e.image,alt:e.symbol,class:"coin-img"},null,8,DEe),s("span",PEe,v(e.name),1),s("span",LEe,v(e.symbol.toUpperCase()),1)])]),s("td",NEe,"$"+v(e.current_price?.toLocaleString()),1),s("td",{class:c(["font-mono text-right",(e.price_change_percentage_24h||0)>0?"text-green":"text-red"])},v((e.price_change_percentage_24h||0).toFixed(2))+"% ",3),s("td",{class:c(["font-mono text-right",(e.price_change_percentage_7d_in_currency||0)>0?"text-green":"text-red"])},v((e.price_change_percentage_7d_in_currency||0).toFixed(2))+"% ",3),s("td",OEe,"$"+v(x(e.market_cap)),1),s("td",FEe,"$"+v(x(e.total_volume)),1)],8,EEe))),128))])])])]),m.value?(w(),i("div",BEe,[s("h3",UEe,v(m.value)+" — История цены (30d)",1),s("div",zEe,[s("canvas",{ref_key:"chartRef",ref:g},null,512)])])):l("",!0),h.value?(w(),i("div",VEe,[t[9]||(t[9]=s("h3",{class:"block-title"},"Trending",-1)),s("div",HEe,[(w(!0),i(p,null,f(b.value,e=>(w(),i("div",{key:e.id,class:"trending-card",onClick:t=>m.value=e.id},[s("img",{src:e.thumb,class:"trending-img"},null,8,WEe),s("div",null,[s("span",qEe,v(e.name),1),s("span",YEe,v(e.symbol),1)]),s("span",jEe,"#"+v(e.market_cap_rank),1)],8,GEe))),128))])])):l("",!0),r.value?(w(),i("div",XEe,v(r.value),1)):l("",!0)]))}}),KEe=xe($Ee,[["__scopeId","data-v-d61cd75d"]]),ZEe="   https://stochastic-dashbord-v1-production.up.railway.app";async function JEe(e){const t=await fetch(e);if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return t.json()}async function QEe(e){return async function(e,t){const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){const e=await a.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${a.status}`)}return a.json()}(`${ZEe}/api/news-ai/huggingface/sentiment`,{text:e})}const eIe={class:"page-container"},tIe={class:"section-header"},aIe={class:"header-actions"},nIe=["disabled"],rIe={class:"tabs-navigation"},iIe=["onClick"],oIe={class:"search-bar"},sIe={class:"news-grid"},lIe={key:0,class:"news-img-wrap"},cIe=["src","alt"],uIe={class:"news-body"},dIe={class:"news-meta font-mono"},hIe={class:"news-source"},pIe={class:"news-date"},fIe=["href"],mIe={class:"news-desc"},vIe={class:"news-actions"},gIe=["onClick","disabled"],yIe={key:0,class:"text-muted"},bIe={class:"news-grid"},xIe={key:0,class:"news-img-wrap"},wIe=["src","alt"],_Ie={class:"news-body"},SIe={class:"news-meta font-mono"},MIe={class:"news-source"},TIe={class:"news-date"},kIe=["href"],CIe={class:"news-desc"},AIe={key:0,class:"text-muted"},EIe={class:"news-grid"},IIe={class:"news-body"},RIe={class:"news-meta font-mono"},DIe={class:"news-source"},PIe={class:"news-date"},LIe=["href"],NIe={class:"news-desc"},OIe={key:0,class:"text-muted"},FIe={key:0,class:"error-banner"},BIe=e({__name:"NewsHub",setup(e){const r=t(!1),o=t(""),d=t("headlines"),m=t(""),g=t(""),y=[{id:"headlines",name:"Заголовки"},{id:"currents",name:"Currents"},{id:"search",name:"Поиск"}],b=t([]),x=t([]),_=t([]),S=a({}),C=a({});function A(e){if(!e)return"";return new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}async function E(){try{const e=await async function(e){let t=`${ZEe}/api/news-ai/newsapi/headlines?`;return e?.country&&(t+=`country=${e.country}&`),e?.category&&(t+=`category=${e.category}&`),e?.q&&(t+=`q=${encodeURIComponent(e.q)}&`),e?.pageSize&&(t+=`page_size=${e.pageSize}&`),JEe(t)}({country:"us",category:g.value||void 0,pageSize:20});b.value=e.articles}catch(TQe){o.value=TQe.message}}async function R(){try{const e=await async function(e){let t=`${ZEe}/api/news-ai/currents/latest?`;return e?.language&&(t+=`language=${e.language}&`),e?.keywords&&(t+=`keywords=${encodeURIComponent(e.keywords)}&`),e?.category&&(t+=`category=${encodeURIComponent(e.category)}&`),JEe(t)}({language:"en",keywords:g.value||void 0});x.value=e.articles}catch(TQe){o.value=TQe.message}}async function L(){if(m.value){d.value="search";try{const e=await async function(e){let t=`${ZEe}/api/news-ai/newsapi/everything?q=${encodeURIComponent(e.q)}`;return e.from&&(t+=`&from=${e.from}`),e.to&&(t+=`&to=${e.to}`),e.sortBy&&(t+=`&sort_by=${e.sortBy}`),e.pageSize&&(t+=`&page_size=${e.pageSize}`),e.language&&(t+=`&language=${e.language}`),JEe(t)}({q:m.value,pageSize:20});_.value=e.articles}catch(TQe){o.value=TQe.message}}}async function N(){r.value=!0,o.value="";try{await Promise.all([E(),R()])}finally{r.value=!1}}return n(()=>N()),(e,t)=>(w(),i("div",eIe,[s("div",tIe,[t[2]||(t[2]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Новостной хаб"),s("p",{class:"section-subtitle"},"NewsAPI + Currents + HuggingFace AI")],-1)),s("div",aIe,[s("button",{class:"btn-glass",onClick:N,disabled:r.value},v(r.value?"Загрузка...":"Обновить"),9,nIe)])]),s("div",rIe,[(w(),i(p,null,f(y,e=>s("button",{key:e.id,onClick:t=>d.value=e.id,class:c(["tab-item",{active:d.value===e.id}])},v(e.name),11,iIe)),64))]),s("div",oIe,[T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),class:"glass-input full",placeholder:"Поиск новостей...",onKeyup:U(L,["enter"])},null,544),[[k,m.value]]),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),class:"glass-select"},[...t[3]||(t[3]=[I('<option value="" data-v-fd0889dd>Все</option><option value="business" data-v-fd0889dd>Business</option><option value="technology" data-v-fd0889dd>Technology</option><option value="science" data-v-fd0889dd>Science</option><option value="health" data-v-fd0889dd>Health</option>',5)])],512),[[D,g.value]]),s("button",{class:"btn-glass xs",onClick:L},"Найти")]),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",sIe,[(w(!0),i(p,null,f(b.value,(e,t)=>(w(),i("div",{key:t,class:"news-card"},[e.urlToImage?(w(),i("div",lIe,[s("img",{src:e.urlToImage,alt:e.title,class:"news-img"},null,8,cIe)])):l("",!0),s("div",uIe,[s("div",dIe,[s("span",hIe,v(e.source),1),s("span",pIe,v(A(e.publishedAt)),1)]),s("a",{href:e.url,target:"_blank",rel:"noopener",class:"news-title"},v(e.title),9,fIe),s("p",mIe,v(e.description),1),s("div",vIe,[s("button",{class:"btn-glass xs",onClick:a=>async function(e,t){if(e){C[t]=!0;try{const a=await QEe(e);if(a.scores&&a.scores.length){const e=a.scores.reduce((e,t)=>e.score>t.score?e:t);S[t]={label:e.label,score:e.score}}}catch(TQe){o.value=TQe.message}finally{C[t]=!1}}}(e.title+". "+(e.description||""),t),disabled:C[t]},v(C[t]?"...":"AI Sentiment"),9,gIe),S[t]?(w(),i("span",{key:0,class:c(["sentiment-badge font-mono","sentiment-"+S[t].label])},v(S[t].label)+" ("+v((100*S[t].score).toFixed(0))+"%) ",3)):l("",!0)])])]))),128)),b.value.length||r.value?l("",!0):(w(),i("p",yIe,"Нажмите «Обновить» для загрузки новостей"))],512),[[P,"headlines"===d.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",bIe,[(w(!0),i(p,null,f(x.value,(e,t)=>(w(),i("div",{key:t,class:"news-card"},[e.image?(w(),i("div",xIe,[s("img",{src:e.image,alt:e.title,class:"news-img"},null,8,wIe)])):l("",!0),s("div",_Ie,[s("div",SIe,[s("span",MIe,v(e.source),1),s("span",TIe,v(A(e.publishedAt)),1)]),s("a",{href:e.url,target:"_blank",rel:"noopener",class:"news-title"},v(e.title),9,kIe),s("p",CIe,v(e.description),1)])]))),128)),x.value.length||r.value?l("",!0):(w(),i("p",AIe,"Нет данных"))],512),[[P,"currents"===d.value]])]),_:1}),u(M,{name:"fade",mode:"out-in"},{default:h(()=>[T(s("div",EIe,[(w(!0),i(p,null,f(_.value,(e,t)=>(w(),i("div",{key:t,class:"news-card"},[s("div",IIe,[s("div",RIe,[s("span",DIe,v(e.source),1),s("span",PIe,v(A(e.publishedAt)),1)]),s("a",{href:e.url,target:"_blank",rel:"noopener",class:"news-title"},v(e.title),9,LIe),s("p",NIe,v(e.description),1)])]))),128)),_.value.length||r.value?l("",!0):(w(),i("p",OIe,"Введите запрос и нажмите «Найти»"))],512),[[P,"search"===d.value]])]),_:1}),o.value?(w(),i("div",FIe,v(o.value),1)):l("",!0)]))}}),UIe=xe(BIe,[["__scopeId","data-v-fd0889dd"]]),zIe="   https://stochastic-dashbord-v1-production.up.railway.app";async function VIe(e){const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return t.json()}async function HIe(e,t){const a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return a.json()}function GIe(e){return VIe(`${zIe}/api/security/ipinfo/${encodeURIComponent(e)}`)}function WIe(e){return VIe(`${zIe}/api/security/ip2location/${encodeURIComponent(e)}`)}function qIe(e){return VIe(`${zIe}/api/security/bigdatacloud/${encodeURIComponent(e)}`)}function YIe(e){return HIe(`${zIe}/api/security/virustotal/scan-url`,{url:e})}function jIe(e){return HIe(`${zIe}/api/security/urlscan/submit`,{url:e})}const XIe={class:"page-container"},$Ie={class:"tabs-navigation"},KIe=["onClick"],ZIe={key:0,class:"error-banner"},JIe={class:"tab-content"},QIe={class:"input-row"},eRe=["disabled"],tRe={key:0,class:"loading-text"},aRe={key:1,class:"results-grid three-col"},nRe={key:0,class:"glass-card"},rRe={class:"result-fields"},iRe={class:"field-row"},oRe={class:"field-value"},sRe={class:"field-row"},lRe={class:"field-value"},cRe={class:"field-row"},uRe={class:"field-value"},dRe={class:"field-row"},hRe={class:"field-value"},pRe={class:"field-row"},fRe={class:"field-value"},mRe={class:"field-row"},vRe={class:"field-value"},gRe={class:"field-row"},yRe={class:"field-value"},bRe={class:"field-row"},xRe={class:"field-value"},wRe={key:1,class:"glass-card"},_Re={class:"result-fields"},SRe={class:"field-row"},MRe={class:"field-value"},TRe={class:"field-row"},kRe={class:"field-value"},CRe={class:"field-row"},ARe={class:"field-value"},ERe={class:"field-row"},IRe={class:"field-value"},RRe={class:"field-row"},DRe={class:"field-value"},PRe={class:"field-row"},LRe={class:"field-value"},NRe={class:"field-row"},ORe={class:"field-value"},FRe={class:"field-row"},BRe={class:"field-value"},URe={key:2,class:"glass-card"},zRe={class:"result-fields"},VRe={class:"field-row"},HRe={class:"field-value"},GRe={class:"field-row"},WRe={class:"field-value"},qRe={class:"field-row"},YRe={class:"field-value"},jRe={class:"field-row"},XRe={class:"field-value"},$Re={class:"field-row"},KRe={class:"field-value"},ZRe={class:"tab-content"},JRe={class:"input-row"},QRe=["disabled"],eDe={key:0,class:"loading-text"},tDe={key:1,class:"results-grid two-col"},aDe={class:"glass-card"},nDe={key:0,class:"polling-text"},rDe={key:1,class:"result-fields"},iDe={class:"field-row"},oDe={class:"field-value"},sDe={class:"field-row"},lDe={class:"field-value vt-malicious"},cDe={class:"field-row"},uDe={class:"field-value vt-suspicious"},dDe={class:"field-row"},hDe={class:"field-value vt-harmless"},pDe={class:"field-row"},fDe={class:"field-value"},mDe={class:"field-row"},vDe={class:"field-value"},gDe={key:2,class:"result-fields"},yDe={class:"field-row"},bDe={class:"field-value text-truncate"},xDe={class:"glass-card"},wDe={key:0,class:"polling-text"},_De={key:1,class:"result-fields"},SDe={key:0,class:"result-section"},MDe={class:"field-row"},TDe={class:"field-value"},kDe={class:"field-row"},CDe={class:"field-value"},ADe={class:"field-row"},EDe={class:"field-value"},IDe={class:"field-row"},RDe={class:"field-value"},DDe={class:"field-row"},PDe={class:"field-value"},LDe={key:1,class:"result-section"},NDe={class:"field-row"},ODe={class:"field-row"},FDe={class:"field-value"},BDe={key:0,class:"field-row"},UDe={class:"field-value"},zDe={key:2,class:"result-fields"},VDe={class:"field-row"},HDe={class:"field-value text-truncate"},GDe={class:"tab-content"},WDe={class:"input-row"},qDe=["disabled"],YDe={key:0,class:"loading-text"},jDe={key:1,class:"results-grid single-col"},XDe={class:"glass-card"},$De={class:"abuse-score-wrap"},KDe={class:"result-fields"},ZDe={class:"field-row"},JDe={class:"field-value"},QDe={class:"field-row"},ePe={class:"field-value"},tPe={class:"field-row"},aPe={class:"field-row"},nPe={class:"field-value"},rPe={class:"field-row"},iPe={class:"field-value"},oPe={class:"field-row"},sPe={class:"field-value"},lPe={class:"field-row"},cPe={class:"field-value"},uPe={class:"field-row"},dPe={class:"field-value"},hPe={class:"field-row"},pPe={class:"field-value"},fPe={class:"tab-content"},mPe={class:"input-row"},vPe=["disabled"],gPe={key:0,class:"loading-text"},yPe={key:1,class:"results-grid single-col"},bPe={class:"glass-card"},xPe={class:"card-title"},wPe={class:"result-fields"},_Pe={class:"field-row"},SPe={class:"field-value"},MPe={class:"field-row"},TPe={class:"field-value"},kPe={class:"field-row"},CPe={class:"field-value"},APe={class:"field-row"},EPe={class:"field-value"},IPe={class:"field-row"},RPe={class:"field-value"},DPe={class:"field-row"},PPe={class:"field-value"},LPe={class:"field-row"},NPe={class:"field-value"},OPe={key:0,class:"field-row"},FPe={class:"field-value"},BPe={key:1,class:"field-row"},UPe={class:"field-value"},zPe={key:2,class:"field-row"},VPe={class:"field-value nameserver-list"},HPe=e({__name:"SecurityCenter",setup(e){const a=[{id:"ip-lookup",name:"IP Lookup"},{id:"url-scanner",name:"URL Scanner"},{id:"ip-abuse",name:"IP Abuse"},{id:"whois",name:"WHOIS"}],n=t("ip-lookup"),r=t(""),o=t(""),u=t(!1),d=t(null),h=t(null),m=t(null),g=S(()=>d.value||h.value||m.value);async function b(){const e=o.value.trim();if(e){u.value=!0,r.value="",d.value=null,h.value=null,m.value=null;try{const[t,a,n]=await Promise.allSettled([GIe(e),WIe(e),qIe(e)]);d.value="fulfilled"===t.status?t.value:null,h.value="fulfilled"===a.status?a.value:null,m.value="fulfilled"===n.status?n.value:null}catch(TQe){const t=TQe instanceof Error?TQe.message:String(TQe);r.value=`IP Lookup failed: ${t}`}finally{u.value=!1}}}function x(e,t){return null==e||null==t?"---":`${e.toFixed(4)}, ${t.toFixed(4)}`}const _=t(""),M=t(!1),C=t(null),A=t(null),E=t(!1),I=t(0),R=t(null),D=t(null),L=t(!1),N=t(0);async function O(){const e=_.value.trim();if(e){M.value=!0,r.value="",C.value=null,A.value=null,E.value=!1,I.value=0,R.value=null,D.value=null,L.value=!1,N.value=0;try{const[t,a]=await Promise.allSettled([YIe(e),jIe(e)]);if("fulfilled"===t.status?(C.value=t.value,function(e){E.value=!0,I.value=0;const t=60,a=setInterval(async()=>{I.value+=5;try{const n=await function(e){return VIe(`${zIe}/api/security/virustotal/analysis/${encodeURIComponent(e)}`)}(e);("completed"===n.status||I.value>=t)&&(A.value=n,E.value=!1,clearInterval(a))}catch{I.value>=t&&(E.value=!1,clearInterval(a))}},5e3)}(t.value.analysis_id)):r.value=`VirusTotal submit failed: ${t.reason}`,"fulfilled"===a.status)R.value=a.value,function(e){L.value=!0,N.value=0;const t=60,a=setInterval(async()=>{N.value+=5;try{const n=await function(e){return VIe(`${zIe}/api/security/urlscan/result/${encodeURIComponent(e)}`)}(e);("completed"===n.status||N.value>=t)&&(D.value=n,L.value=!1,clearInterval(a))}catch{N.value>=t&&(L.value=!1,clearInterval(a))}},5e3)}(a.value.uuid);else{const e=r.value,t=`URLScan submit failed: ${a.reason}`;r.value=e?`${e} | ${t}`:t}}catch(TQe){const t=TQe instanceof Error?TQe.message:String(TQe);r.value=`URL Scan failed: ${t}`}finally{M.value=!1}}}const F=t(""),B=t(!1),z=t(null),V=S(()=>{if(!z.value)return"#666";const e=z.value.abuse_confidence_score;return e<=25?"#22C55E":e<=50?"#EAB308":e<=75?"#F97316":"#DC2626"});async function H(){const e=F.value.trim();if(e){B.value=!0,r.value="",z.value=null;try{z.value=await function(e){return VIe(`${zIe}/api/security/abuseipdb/${encodeURIComponent(e)}`)}(e)}catch(TQe){const t=TQe instanceof Error?TQe.message:String(TQe);r.value=`Abuse check failed: ${t}`}finally{B.value=!1}}}const G=t(""),W=t(!1),q=t(null);async function Y(){const e=G.value.trim();if(e){W.value=!0,r.value="",q.value=null;try{q.value=await function(e){return VIe(`${zIe}/api/security/whois/${encodeURIComponent(e)}`)}(e)}catch(TQe){const t=TQe instanceof Error?TQe.message:String(TQe);r.value=`WHOIS lookup failed: ${t}`}finally{W.value=!1}}}return(e,t)=>(w(),i("div",XIe,[t[67]||(t[67]=s("div",{class:"section-header"},[s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Security Center"),s("p",{class:"section-subtitle"},"IP Geolocation / URL Scanner / Abuse Check / WHOIS")])],-1)),s("div",$Ie,[(w(),i(p,null,f(a,e=>s("button",{key:e.id,class:c(["tab-item",{active:n.value===e.id}]),onClick:t=>n.value=e.id},v(e.name),11,KIe)),64))]),r.value?(w(),i("div",ZIe,v(r.value),1)):l("",!0),T(s("div",JIe,[s("div",QIe,[T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),class:"security-input",placeholder:"Enter IP address (e.g. 8.8.8.8)",onKeyup:U(b,["enter"])},null,544),[[k,o.value]]),s("button",{class:"btn-submit",disabled:u.value||!o.value.trim(),onClick:b},v(u.value?"LOADING...":"LOOKUP"),9,eRe)]),u.value?(w(),i("div",tRe,"LOADING...")):l("",!0),g.value?(w(),i("div",aRe,[d.value?(w(),i("div",nRe,[t[12]||(t[12]=s("h3",{class:"card-title"},"IPINFO.IO",-1)),s("div",rRe,[s("div",iRe,[t[4]||(t[4]=s("span",{class:"field-label"},"IP",-1)),s("span",oRe,v(d.value.ip),1)]),s("div",sRe,[t[5]||(t[5]=s("span",{class:"field-label"},"COUNTRY",-1)),s("span",lRe,v(d.value.country||"---"),1)]),s("div",cRe,[t[6]||(t[6]=s("span",{class:"field-label"},"CITY",-1)),s("span",uRe,v(d.value.city||"---"),1)]),s("div",dRe,[t[7]||(t[7]=s("span",{class:"field-label"},"REGION",-1)),s("span",hRe,v(d.value.region||"---"),1)]),s("div",pRe,[t[8]||(t[8]=s("span",{class:"field-label"},"ORG",-1)),s("span",fRe,v(d.value.org||"---"),1)]),s("div",mRe,[t[9]||(t[9]=s("span",{class:"field-label"},"COORDINATES",-1)),s("span",vRe,v(d.value.loc||"---"),1)]),s("div",gRe,[t[10]||(t[10]=s("span",{class:"field-label"},"TIMEZONE",-1)),s("span",yRe,v(d.value.timezone||"---"),1)]),s("div",bRe,[t[11]||(t[11]=s("span",{class:"field-label"},"HOSTNAME",-1)),s("span",xRe,v(d.value.hostname||"---"),1)])])])):l("",!0),h.value?(w(),i("div",wRe,[t[21]||(t[21]=s("h3",{class:"card-title"},"IP2LOCATION",-1)),s("div",_Re,[s("div",SRe,[t[13]||(t[13]=s("span",{class:"field-label"},"IP",-1)),s("span",MRe,v(h.value.ip),1)]),s("div",TRe,[t[14]||(t[14]=s("span",{class:"field-label"},"COUNTRY",-1)),s("span",kRe,v(h.value.country_name||"---")+" ("+v(h.value.country_code||"")+")",1)]),s("div",CRe,[t[15]||(t[15]=s("span",{class:"field-label"},"CITY",-1)),s("span",ARe,v(h.value.city_name||"---"),1)]),s("div",ERe,[t[16]||(t[16]=s("span",{class:"field-label"},"REGION",-1)),s("span",IRe,v(h.value.region_name||"---"),1)]),s("div",RRe,[t[17]||(t[17]=s("span",{class:"field-label"},"ISP / AS",-1)),s("span",DRe,v(h.value.as||"---"),1)]),s("div",PRe,[t[18]||(t[18]=s("span",{class:"field-label"},"COORDINATES",-1)),s("span",LRe,v(x(h.value.latitude,h.value.longitude)),1)]),s("div",NRe,[t[19]||(t[19]=s("span",{class:"field-label"},"TIMEZONE",-1)),s("span",ORe,v(h.value.time_zone||"---"),1)]),s("div",FRe,[t[20]||(t[20]=s("span",{class:"field-label"},"PROXY",-1)),s("span",BRe,v(h.value.is_proxy?"YES":"NO"),1)])])])):l("",!0),m.value?(w(),i("div",URe,[t[27]||(t[27]=s("h3",{class:"card-title"},"BIGDATACLOUD",-1)),s("div",zRe,[s("div",VRe,[t[22]||(t[22]=s("span",{class:"field-label"},"IP",-1)),s("span",HRe,v(m.value.ip||"---"),1)]),s("div",GRe,[t[23]||(t[23]=s("span",{class:"field-label"},"COUNTRY",-1)),s("span",WRe,v(m.value.country?.name||"---")+" ("+v(m.value.country?.isoAlpha2||"")+")",1)]),s("div",qRe,[t[24]||(t[24]=s("span",{class:"field-label"},"CITY",-1)),s("span",YRe,v(m.value.city?.name||"---"),1)]),s("div",jRe,[t[25]||(t[25]=s("span",{class:"field-label"},"ORGANISATION",-1)),s("span",XRe,v(m.value.network?.organisation||"---"),1)]),s("div",$Re,[t[26]||(t[26]=s("span",{class:"field-label"},"COORDINATES",-1)),s("span",KRe,v(x(m.value.location?.latitude,m.value.location?.longitude)),1)])])])):l("",!0)])):l("",!0)],512),[[P,"ip-lookup"===n.value]]),T(s("div",ZRe,[s("div",JRe,[T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),class:"security-input",placeholder:"Enter URL (e.g. https://example.com)",onKeyup:U(O,["enter"])},null,544),[[k,_.value]]),s("button",{class:"btn-submit",disabled:M.value||!_.value.trim(),onClick:O},v(M.value?"SCANNING...":"SCAN"),9,QRe)]),M.value?(w(),i("div",eDe,"SCANNING URL...")):l("",!0),C.value||R.value?(w(),i("div",tDe,[s("div",aDe,[t[35]||(t[35]=s("h3",{class:"card-title"},"VIRUSTOTAL",-1)),E.value?(w(),i("div",nDe,"POLLING ANALYSIS... ("+v(I.value)+"s)",1)):l("",!0),A.value?(w(),i("div",rDe,[s("div",iDe,[t[28]||(t[28]=s("span",{class:"field-label"},"STATUS",-1)),s("span",oDe,v(A.value.status.toUpperCase()),1)]),s("div",sDe,[t[29]||(t[29]=s("span",{class:"field-label"},"MALICIOUS",-1)),s("span",lDe,v(A.value.stats.malicious),1)]),s("div",cDe,[t[30]||(t[30]=s("span",{class:"field-label"},"SUSPICIOUS",-1)),s("span",uDe,v(A.value.stats.suspicious),1)]),s("div",dDe,[t[31]||(t[31]=s("span",{class:"field-label"},"HARMLESS",-1)),s("span",hDe,v(A.value.stats.harmless),1)]),s("div",pDe,[t[32]||(t[32]=s("span",{class:"field-label"},"UNDETECTED",-1)),s("span",fDe,v(A.value.stats.undetected),1)]),s("div",mDe,[t[33]||(t[33]=s("span",{class:"field-label"},"TIMEOUT",-1)),s("span",vDe,v(A.value.stats.timeout),1)])])):C.value&&!E.value?(w(),i("div",gDe,[s("div",yDe,[t[34]||(t[34]=s("span",{class:"field-label"},"ANALYSIS ID",-1)),s("span",bDe,v(C.value.analysis_id),1)])])):l("",!0)]),s("div",xDe,[t[45]||(t[45]=s("h3",{class:"card-title"},"URLSCAN.IO",-1)),L.value?(w(),i("div",wDe,"POLLING RESULT... ("+v(N.value)+"s)",1)):l("",!0),D.value?(w(),i("div",_De,[D.value.page?(w(),i("div",SDe,[s("div",MDe,[t[36]||(t[36]=s("span",{class:"field-label"},"DOMAIN",-1)),s("span",TDe,v(D.value.page.domain),1)]),s("div",kDe,[t[37]||(t[37]=s("span",{class:"field-label"},"IP",-1)),s("span",CDe,v(D.value.page.ip),1)]),s("div",ADe,[t[38]||(t[38]=s("span",{class:"field-label"},"COUNTRY",-1)),s("span",EDe,v(D.value.page.country),1)]),s("div",IDe,[t[39]||(t[39]=s("span",{class:"field-label"},"SERVER",-1)),s("span",RDe,v(D.value.page.server),1)]),s("div",DDe,[t[40]||(t[40]=s("span",{class:"field-label"},"STATUS CODE",-1)),s("span",PDe,v(D.value.page.status_code),1)])])):l("",!0),D.value.verdicts?(w(),i("div",LDe,[s("div",NDe,[t[41]||(t[41]=s("span",{class:"field-label"},"MALICIOUS",-1)),s("span",{class:c(["field-value",D.value.verdicts.malicious?"text-danger":"text-safe"])},v(D.value.verdicts.malicious?"YES":"NO"),3)]),s("div",ODe,[t[42]||(t[42]=s("span",{class:"field-label"},"SCORE",-1)),s("span",FDe,v(D.value.verdicts.score),1)]),D.value.verdicts.categories.length?(w(),i("div",BDe,[t[43]||(t[43]=s("span",{class:"field-label"},"CATEGORIES",-1)),s("span",UDe,v(D.value.verdicts.categories.join(", ")),1)])):l("",!0)])):l("",!0)])):R.value&&!L.value?(w(),i("div",zDe,[s("div",VDe,[t[44]||(t[44]=s("span",{class:"field-label"},"UUID",-1)),s("span",HDe,v(R.value.uuid),1)])])):l("",!0)])])):l("",!0)],512),[[P,"url-scanner"===n.value]]),T(s("div",GDe,[s("div",WDe,[T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>F.value=e),class:"security-input",placeholder:"Enter IP address to check abuse reports",onKeyup:U(H,["enter"])},null,544),[[k,F.value]]),s("button",{class:"btn-submit",disabled:B.value||!F.value.trim(),onClick:H},v(B.value?"LOADING...":"CHECK"),9,qDe)]),B.value?(w(),i("div",YDe,"LOADING...")):l("",!0),z.value?(w(),i("div",jDe,[s("div",XDe,[t[56]||(t[56]=s("h3",{class:"card-title"},"ABUSEIPDB REPORT",-1)),s("div",$De,[s("div",{class:"abuse-score-circle",style:y({borderColor:V.value})},[s("span",{class:"abuse-score-value",style:y({color:V.value})},v(z.value.abuse_confidence_score),5),t[46]||(t[46]=s("span",{class:"abuse-score-label"},"CONFIDENCE",-1))],4)]),s("div",KDe,[s("div",ZDe,[t[47]||(t[47]=s("span",{class:"field-label"},"IP",-1)),s("span",JDe,v(z.value.ip),1)]),s("div",QDe,[t[48]||(t[48]=s("span",{class:"field-label"},"PUBLIC",-1)),s("span",ePe,v(z.value.is_public?"YES":"NO"),1)]),s("div",tPe,[t[49]||(t[49]=s("span",{class:"field-label"},"ABUSE SCORE",-1)),s("span",{class:"field-value",style:y({color:V.value})},v(z.value.abuse_confidence_score)+"%",5)]),s("div",aPe,[t[50]||(t[50]=s("span",{class:"field-label"},"TOTAL REPORTS",-1)),s("span",nPe,v(z.value.total_reports),1)]),s("div",rPe,[t[51]||(t[51]=s("span",{class:"field-label"},"DISTINCT USERS",-1)),s("span",iPe,v(z.value.num_distinct_users),1)]),s("div",oPe,[t[52]||(t[52]=s("span",{class:"field-label"},"ISP",-1)),s("span",sPe,v(z.value.isp||"---"),1)]),s("div",lPe,[t[53]||(t[53]=s("span",{class:"field-label"},"DOMAIN",-1)),s("span",cPe,v(z.value.domain||"---"),1)]),s("div",uPe,[t[54]||(t[54]=s("span",{class:"field-label"},"COUNTRY",-1)),s("span",dPe,v(z.value.country_code||"---"),1)]),s("div",hPe,[t[55]||(t[55]=s("span",{class:"field-label"},"LAST REPORTED",-1)),s("span",pPe,v(z.value.last_reported_at||"NEVER"),1)])])])])):l("",!0)],512),[[P,"ip-abuse"===n.value]]),T(s("div",fPe,[s("div",mPe,[T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>G.value=e),class:"security-input",placeholder:"Enter domain (e.g. example.com)",onKeyup:U(Y,["enter"])},null,544),[[k,G.value]]),s("button",{class:"btn-submit",disabled:W.value||!G.value.trim(),onClick:Y},v(W.value?"LOADING...":"LOOKUP"),9,vPe)]),W.value?(w(),i("div",gPe,"LOADING...")):l("",!0),q.value?(w(),i("div",yPe,[s("div",bPe,[s("h3",xPe,"WHOIS — "+v(q.value.domain||G.value),1),s("div",wPe,[s("div",_Pe,[t[57]||(t[57]=s("span",{class:"field-label"},"DOMAIN",-1)),s("span",SPe,v(q.value.domain||"---"),1)]),s("div",MPe,[t[58]||(t[58]=s("span",{class:"field-label"},"DOMAIN ID",-1)),s("span",TPe,v(q.value.domain_id||"---"),1)]),s("div",kPe,[t[59]||(t[59]=s("span",{class:"field-label"},"STATUS",-1)),s("span",CPe,v(q.value.status||"---"),1)]),s("div",APe,[t[60]||(t[60]=s("span",{class:"field-label"},"REGISTRAR",-1)),s("span",EPe,v(q.value.registrar?.name||"---"),1)]),s("div",IPe,[t[61]||(t[61]=s("span",{class:"field-label"},"CREATED",-1)),s("span",RPe,v(q.value.create_date||"---"),1)]),s("div",DPe,[t[62]||(t[62]=s("span",{class:"field-label"},"UPDATED",-1)),s("span",PPe,v(q.value.update_date||"---"),1)]),s("div",LPe,[t[63]||(t[63]=s("span",{class:"field-label"},"EXPIRES",-1)),s("span",NPe,v(q.value.expire_date||"---"),1)]),q.value.registrant?(w(),i("div",OPe,[t[64]||(t[64]=s("span",{class:"field-label"},"REGISTRANT ORG",-1)),s("span",FPe,v(q.value.registrant.organization||"---"),1)])):l("",!0),q.value.registrant?(w(),i("div",BPe,[t[65]||(t[65]=s("span",{class:"field-label"},"REGISTRANT COUNTRY",-1)),s("span",UPe,v(q.value.registrant.country||"---"),1)])):l("",!0),q.value.nameservers&&q.value.nameservers.length?(w(),i("div",zPe,[t[66]||(t[66]=s("span",{class:"field-label"},"NAMESERVERS",-1)),s("div",VPe,[(w(!0),i(p,null,f(q.value.nameservers,e=>(w(),i("span",{key:e,class:"ns-item"},v(e),1))),128))])])):l("",!0)])])])):l("",!0)],512),[[P,"whois"===n.value]])]))}}),GPe=xe(HPe,[["__scopeId","data-v-1851be95"]]);class WPe{constructor(e,t,a){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=t,this.end=a}static range(e,t){return t?e&&e.loc&&t.loc&&e.loc.lexer===t.loc.lexer?new WPe(e.loc.lexer,e.loc.start,t.loc.end):null:e&&e.loc}}class qPe{constructor(e,t){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=t}range(e,t){return new qPe(t,WPe.range(this,e))}}class YPe{constructor(e,t){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var a,n,r="KaTeX parse error: "+e,i=t&&t.loc;if(i&&i.start<=i.end){var o=i.lexer.input;a=i.start,n=i.end,a===o.length?r+=" at end of input: ":r+=" at position "+(a+1)+": ";var s=o.slice(a,n).replace(/[^]/g,"$&̲");r+=(a>15?"…"+o.slice(a-15,a):o.slice(0,a))+s+(n+15<o.length?o.slice(n,n+15)+"…":o.slice(n))}var l=new Error(r);return l.name="ParseError",l.__proto__=YPe.prototype,l.position=a,null!=a&&null!=n&&(l.length=n-a),l.rawMessage=e,l}}YPe.prototype.__proto__=Error.prototype;var jPe=/([A-Z])/g,XPe={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},$Pe=/[&><"']/g;var KPe=function e(t){return"ordgroup"===t.type||"color"===t.type?1===t.body.length?e(t.body[0]):t:"font"===t.type?e(t.body):t},ZPe={deflt:function(e,t){return void 0===e?t:e},escape:function(e){return String(e).replace($Pe,e=>XPe[e])},hyphenate:function(e){return e.replace(jPe,"-$1").toLowerCase()},getBaseElem:KPe,isCharacterBox:function(e){var t=KPe(e);return"mathord"===t.type||"textord"===t.type||"atom"===t.type},protocolFromUrl:function(e){var t=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return t?":"!==t[2]?null:/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(t[1])?t[1].toLowerCase():null:"_relative"}},JPe={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:e=>"#"+e},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(e,t)=>(t.push(e),t)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:e=>Math.max(0,e),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:e=>Math.max(0,e),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:e=>Math.max(0,e),cli:"-e, --max-expand <n>",cliProcessor:e=>"Infinity"===e?1/0:parseInt(e)},globalGroup:{type:"boolean",cli:!1}};function QPe(e){if(e.default)return e.default;var t=e.type,a=Array.isArray(t)?t[0]:t;if("string"!=typeof a)return a.enum[0];switch(a){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class eLe{constructor(e){for(var t in this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{},JPe)if(JPe.hasOwnProperty(t)){var a=JPe[t];this[t]=void 0!==e[t]?a.processor?a.processor(e[t]):e[t]:QPe(a)}}reportNonstrict(e,t,a){var n=this.strict;if("function"==typeof n&&(n=n(e,t,a)),n&&"ignore"!==n){if(!0===n||"error"===n)throw new YPe("LaTeX-incompatible input and strict mode is set to 'error': "+t+" ["+e+"]",a);"warn"===n?"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+t+" ["+e+"]"):"undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized '"+n+"': "+t+" ["+e+"]")}}useStrictBehavior(e,t,a){var n=this.strict;if("function"==typeof n)try{n=n(e,t,a)}catch(QXe){n="error"}return!(!n||"ignore"===n)&&(!0===n||"error"===n||("warn"===n?("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+t+" ["+e+"]"),!1):("undefined"!=typeof console&&console.warn("LaTeX-incompatible input and strict mode is set to unrecognized '"+n+"': "+t+" ["+e+"]"),!1)))}isTrusted(e){if(e.url&&!e.protocol){var t=ZPe.protocolFromUrl(e.url);if(null==t)return!1;e.protocol=t}var a="function"==typeof this.trust?this.trust(e):this.trust;return Boolean(a)}}class tLe{constructor(e,t,a){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=t,this.cramped=a}sup(){return aLe[nLe[this.id]]}sub(){return aLe[rLe[this.id]]}fracNum(){return aLe[iLe[this.id]]}fracDen(){return aLe[oLe[this.id]]}cramp(){return aLe[sLe[this.id]]}text(){return aLe[lLe[this.id]]}isTight(){return this.size>=2}}var aLe=[new tLe(0,0,!1),new tLe(1,0,!0),new tLe(2,1,!1),new tLe(3,1,!0),new tLe(4,2,!1),new tLe(5,2,!0),new tLe(6,3,!1),new tLe(7,3,!0)],nLe=[4,5,4,5,6,7,6,7],rLe=[5,5,5,5,7,7,7,7],iLe=[2,3,4,5,6,7,6,7],oLe=[3,3,5,5,7,7,7,7],sLe=[1,1,3,3,5,5,7,7],lLe=[0,1,2,3,2,3,2,3],cLe={DISPLAY:aLe[0],TEXT:aLe[2],SCRIPT:aLe[4],SCRIPTSCRIPT:aLe[6]},uLe=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];var dLe=[];function hLe(e){for(var t=0;t<dLe.length;t+=2)if(e>=dLe[t]&&e<=dLe[t+1])return!0;return!1}uLe.forEach(e=>e.blocks.forEach(e=>dLe.push(...e)));var pLe=80,fLe={doubleleftarrow:"M262 157\nl10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3\n 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28\n 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5\nc2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5\n 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87\n-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7\n-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z\nm8 0v40h399730v-40zm0 194v40h399730v-40z",doublerightarrow:"M399738 392l\n-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5\n 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88\n-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68\n-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18\n-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782\nc-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3\n-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z",leftarrow:"M400000 241H110l3-3c68.7-52.7 113.7-120\n 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8\n-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247\nc-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208\n 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3\n 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202\n l-3-3h399890zM100 241v40h399900v-40z",leftbrace:"M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117\n-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7\n 5-6 9-10 13-.7 1-7.3 1-20 1H6z",leftbraceunder:"M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13\n 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688\n 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7\n-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z",leftgroup:"M400000 80\nH435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0\n 435 0h399565z",leftgroupunder:"M400000 262\nH435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219\n 435 219h399565z",leftharpoon:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3\n-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5\n-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7\n-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z",leftharpoonplus:"M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5\n 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3\n-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7\n-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z\nm0 0v40h400000v-40z",leftharpoondown:"M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333\n 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5\n 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667\n-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z",leftharpoondownplus:"M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12\n 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7\n-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0\nv40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z",lefthook:"M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5\n-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3\n-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21\n 71.5 23h399859zM103 281v-40h399897v40z",leftlinesegment:"M40 281 V428 H0 V94 H40 V241 H400000 v40z\nM40 281 V428 H0 V94 H40 V241 H400000 v40z",leftmapsto:"M40 281 V448H0V74H40V241H400000v40z\nM40 281 V448H0V74H40V241H400000v40z",leftToFrom:"M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23\n-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8\nc28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3\n 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z",longequal:"M0 50 h400000 v40H0z m0 194h40000v40H0z\nM0 50 h400000 v40H0z m0 194h40000v40H0z",midbrace:"M200428 334\nc-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14\n-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7\n 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11\n 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z",midbraceunder:"M199572 214\nc100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14\n 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3\n 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0\n-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z",oiintSize1:"M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6\n-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z\nm368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8\n60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z",oiintSize2:"M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8\n-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z\nm502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2\nc0 110 84 276 504 276s502.4-166 502.4-276z",oiiintSize1:"M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6\n-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z\nm525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0\n85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z",oiiintSize2:"M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8\n-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z\nm770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1\nc0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z",rightarrow:"M0 241v40h399891c-47.3 35.3-84 78-110 128\n-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20\n 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7\n 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85\n-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n 151.7 139 205zm0 0v40h399900v-40z",rightbrace:"M400000 542l\n-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5\ns-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1\nc124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z",rightbraceunder:"M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3\n 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237\n-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z",rightgroup:"M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0\n 3-1 3-3v-38c-76-158-257-219-435-219H0z",rightgroupunder:"M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18\n 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z",rightharpoon:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3\n-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2\n-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58\n 69.2 92 94.5zm0 0v40h399900v-40z",rightharpoonplus:"M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11\n-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7\n 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z\nm0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z",rightharpoondown:"M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8\n 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5\n-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95\n-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z",rightharpoondownplus:"M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8\n 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3\n 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3\n-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z\nm0-194v40h400000v-40zm0 0v40h400000v-40z",righthook:"M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3\n 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0\n-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21\n 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z",rightlinesegment:"M399960 241 V94 h40 V428 h-40 V281 H0 v-40z\nM399960 241 V94 h40 V428 h-40 V281 H0 v-40z",rightToFrom:"M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23\n 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32\n-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142\n-167z M100 147v40h399900v-40zM0 341v40h399900v-40z",twoheadleftarrow:"M0 167c68 40\n 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69\n-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3\n-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19\n-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101\n 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z",twoheadrightarrow:"M400000 167\nc-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3\n 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42\n 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333\n-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70\n 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z",tilde1:"M200 55.538c-77 0-168 73.953-177 73.953-3 0-7\n-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0\n 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0\n 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128\n-68.267.847-113-73.952-191-73.952z",tilde2:"M344 55.266c-142 0-300.638 81.316-311.5 86.418\n-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9\n 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114\nc1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751\n 181.476 676 181.476c-149 0-189-126.21-332-126.21z",tilde3:"M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457\n-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0\n 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697\n 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696\n -338 0-409-156.573-744-156.573z",tilde4:"M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345\n-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409\n 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9\n 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409\n -175.236-744-175.236z",vec:"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z",widehat1:"M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z",widehat2:"M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat3:"M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widehat4:"M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10\n-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z",widecheck1:"M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,\n-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z",widecheck2:"M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck3:"M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",widecheck4:"M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,\n-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z",baraboveleftarrow:"M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202\nc4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5\nc-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130\ns-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47\n121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6\ns2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11\nc0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z\nM100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z",rightarrowabovebar:"M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32\n-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0\n13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39\n-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5\n-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5\n-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67\n151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z",baraboveshortleftharpoon:"M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17\nc2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21\nc-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40\nc-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z\nM0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z",rightharpoonaboveshortbar:"M0,241 l0,40c399126,0,399993,0,399993,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z",shortbaraboveleftharpoon:"M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11\nc1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,\n1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,\n-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z\nM93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z",shortrightharpoonabovebar:"M53,241l0,40c398570,0,399437,0,399437,0\nc4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,\n-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6\nc-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z\nM500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z"};class mLe{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return this.classes.includes(e)}toNode(){for(var e=document.createDocumentFragment(),t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){for(var e="",t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e}toText(){return this.children.map(e=>e.toText()).join("")}}var vLe={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},gLe={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},yLe={"Å":"A","Ð":"D","Þ":"o","å":"a","ð":"d","þ":"o","А":"A","Б":"B","В":"B","Г":"F","Д":"A","Е":"E","Ж":"K","З":"3","И":"N","Й":"N","К":"K","Л":"N","М":"M","Н":"H","О":"O","П":"N","Р":"P","С":"C","Т":"T","У":"y","Ф":"O","Х":"X","Ц":"U","Ч":"h","Ш":"W","Щ":"W","Ъ":"B","Ы":"X","Ь":"B","Э":"3","Ю":"X","Я":"R","а":"a","б":"b","в":"a","г":"r","д":"y","е":"e","ж":"m","з":"e","и":"n","й":"n","к":"n","л":"n","м":"m","н":"n","о":"o","п":"n","р":"p","с":"c","т":"o","у":"y","ф":"b","х":"x","ц":"n","ч":"n","ш":"w","щ":"w","ъ":"a","ы":"m","ь":"a","э":"e","ю":"m","я":"r"};function bLe(e,t,a){if(!vLe[t])throw new Error("Font metrics not found for font: "+t+".");var n=e.charCodeAt(0),r=vLe[t][n];if(!r&&e[0]in yLe&&(n=yLe[e[0]].charCodeAt(0),r=vLe[t][n]),r||"text"!==a||hLe(n)&&(r=vLe[t][77]),r)return{depth:r[0],height:r[1],italic:r[2],skew:r[3],width:r[4]}}var xLe={};var wLe=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],_Le=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],SLe=function(e,t){return t.size<2?e:wLe[e-1][t.size-1]};class MLe{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||MLe.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=_Le[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var t={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return new MLe(t)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:SLe(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:_Le[e-1]})}havingBaseStyle(e){e=e||this.style.text();var t=SLe(MLe.BASESIZE,e);return this.size===t&&this.textSize===MLe.BASESIZE&&this.style===e?this:this.extend({style:e,size:t})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==MLe.BASESIZE?["sizing","reset-size"+this.size,"size"+MLe.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=function(e){var t;if(!xLe[t=e>=5?0:e>=3?1:2]){var a=xLe[t]={cssEmPerMu:gLe.quad[t]/18};for(var n in gLe)gLe.hasOwnProperty(n)&&(a[n]=gLe[n][t])}return xLe[t]}(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}MLe.BASESIZE=6;var TLe={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:1.00375,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:1.00375},kLe={ex:!0,em:!0,mu:!0},CLe=function(e){return"string"!=typeof e&&(e=e.unit),e in TLe||e in kLe||"ex"===e},ALe=function(e,t){var a;if(e.unit in TLe)a=TLe[e.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if("mu"===e.unit)a=t.fontMetrics().cssEmPerMu;else{var n;if(n=t.style.isTight()?t.havingStyle(t.style.text()):t,"ex"===e.unit)a=n.fontMetrics().xHeight;else{if("em"!==e.unit)throw new YPe("Invalid unit: '"+e.unit+"'");a=n.fontMetrics().quad}n!==t&&(a*=n.sizeMultiplier/t.sizeMultiplier)}return Math.min(e.number*a,t.maxSize)},ELe=function(e){return+e.toFixed(4)+"em"},ILe=function(e){return e.filter(e=>e).join(" ")},RLe=function(e,t,a){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=a||{},t){t.style.isTight()&&this.classes.push("mtight");var n=t.getColor();n&&(this.style.color=n)}},DLe=function(e){var t=document.createElement(e);for(var a in t.className=ILe(this.classes),this.style)this.style.hasOwnProperty(a)&&(t.style[a]=this.style[a]);for(var n in this.attributes)this.attributes.hasOwnProperty(n)&&t.setAttribute(n,this.attributes[n]);for(var r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t},PLe=/[\s"'>/=\x00-\x1f]/,LLe=function(e){var t="<"+e;this.classes.length&&(t+=' class="'+ZPe.escape(ILe(this.classes))+'"');var a="";for(var n in this.style)this.style.hasOwnProperty(n)&&(a+=ZPe.hyphenate(n)+":"+this.style[n]+";");for(var r in a&&(t+=' style="'+ZPe.escape(a)+'"'),this.attributes)if(this.attributes.hasOwnProperty(r)){if(PLe.test(r))throw new YPe("Invalid attribute name '"+r+"'");t+=" "+r+'="'+ZPe.escape(this.attributes[r])+'"'}t+=">";for(var i=0;i<this.children.length;i++)t+=this.children[i].toMarkup();return t+="</"+e+">"};class NLe{constructor(e,t,a,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,RLe.call(this,e,a,n),this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return DLe.call(this,"span")}toMarkup(){return LLe.call(this,"span")}}class OLe{constructor(e,t,a,n){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,RLe.call(this,t,n),this.children=a||[],this.setAttribute("href",e)}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return DLe.call(this,"a")}toMarkup(){return LLe.call(this,"a")}}class FLe{constructor(e,t,a){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=t,this.src=e,this.classes=["mord"],this.style=a}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createElement("img");for(var t in e.src=this.src,e.alt=this.alt,e.className="mord",this.style)this.style.hasOwnProperty(t)&&(e.style[t]=this.style[t]);return e}toMarkup(){var e='<img src="'+ZPe.escape(this.src)+'" alt="'+ZPe.escape(this.alt)+'"',t="";for(var a in this.style)this.style.hasOwnProperty(a)&&(t+=ZPe.hyphenate(a)+":"+this.style[a]+";");return t&&(e+=' style="'+ZPe.escape(t)+'"'),e+="'/>"}}var BLe={"î":"ı̂","ï":"ı̈","í":"ı́","ì":"ı̀"};class ULe{constructor(e,t,a,n,r,i,o,s){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=t||0,this.depth=a||0,this.italic=n||0,this.skew=r||0,this.width=i||0,this.classes=o||[],this.style=s||{},this.maxFontSize=0;var l=function(e){for(var t=0;t<uLe.length;t++)for(var a=uLe[t],n=0;n<a.blocks.length;n++){var r=a.blocks[n];if(e>=r[0]&&e<=r[1])return a.name}return null}(this.text.charCodeAt(0));l&&this.classes.push(l+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=BLe[this.text])}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createTextNode(this.text),t=null;for(var a in this.italic>0&&((t=document.createElement("span")).style.marginRight=ELe(this.italic)),this.classes.length>0&&((t=t||document.createElement("span")).className=ILe(this.classes)),this.style)this.style.hasOwnProperty(a)&&((t=t||document.createElement("span")).style[a]=this.style[a]);return t?(t.appendChild(e),t):e}toMarkup(){var e=!1,t="<span";this.classes.length&&(e=!0,t+=' class="',t+=ZPe.escape(ILe(this.classes)),t+='"');var a="";for(var n in this.italic>0&&(a+="margin-right:"+this.italic+"em;"),this.style)this.style.hasOwnProperty(n)&&(a+=ZPe.hyphenate(n)+":"+this.style[n]+";");a&&(e=!0,t+=' style="'+ZPe.escape(a)+'"');var r=ZPe.escape(this.text);return e?(t+=">",t+=r,t+="</span>"):r}}class zLe{constructor(e,t){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=t||{}}toNode(){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);for(var a=0;a<this.children.length;a++)e.appendChild(this.children[a].toNode());return e}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+ZPe.escape(this.attributes[t])+'"');e+=">";for(var a=0;a<this.children.length;a++)e+=this.children[a].toMarkup();return e+="</svg>"}}class VLe{constructor(e,t){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=t}toNode(){var e=document.createElementNS("http://www.w3.org/2000/svg","path");return this.alternate?e.setAttribute("d",this.alternate):e.setAttribute("d",fLe[this.pathName]),e}toMarkup(){return this.alternate?'<path d="'+ZPe.escape(this.alternate)+'"/>':'<path d="'+ZPe.escape(fLe[this.pathName])+'"/>'}}class HLe{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e=document.createElementNS("http://www.w3.org/2000/svg","line");for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);return e}toMarkup(){var e="<line";for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+ZPe.escape(this.attributes[t])+'"');return e+="/>"}}function GLe(e){if(e instanceof ULe)return e;throw new Error("Expected symbolNode but got "+String(e)+".")}var WLe={bin:1,close:1,inner:1,open:1,punct:1,rel:1},qLe={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},YLe={math:{},text:{}};function jLe(e,t,a,n,r,i){YLe[e][r]={font:t,group:a,replace:n},i&&n&&(YLe[e][n]=YLe[e][r])}var XLe="math",$Le="text",KLe="main",ZLe="ams",JLe="accent-token",QLe="bin",eNe="close",tNe="inner",aNe="mathord",nNe="op-token",rNe="open",iNe="punct",oNe="rel",sNe="spacing",lNe="textord";jLe(XLe,KLe,oNe,"≡","\\equiv",!0),jLe(XLe,KLe,oNe,"≺","\\prec",!0),jLe(XLe,KLe,oNe,"≻","\\succ",!0),jLe(XLe,KLe,oNe,"∼","\\sim",!0),jLe(XLe,KLe,oNe,"⊥","\\perp"),jLe(XLe,KLe,oNe,"⪯","\\preceq",!0),jLe(XLe,KLe,oNe,"⪰","\\succeq",!0),jLe(XLe,KLe,oNe,"≃","\\simeq",!0),jLe(XLe,KLe,oNe,"∣","\\mid",!0),jLe(XLe,KLe,oNe,"≪","\\ll",!0),jLe(XLe,KLe,oNe,"≫","\\gg",!0),jLe(XLe,KLe,oNe,"≍","\\asymp",!0),jLe(XLe,KLe,oNe,"∥","\\parallel"),jLe(XLe,KLe,oNe,"⋈","\\bowtie",!0),jLe(XLe,KLe,oNe,"⌣","\\smile",!0),jLe(XLe,KLe,oNe,"⊑","\\sqsubseteq",!0),jLe(XLe,KLe,oNe,"⊒","\\sqsupseteq",!0),jLe(XLe,KLe,oNe,"≐","\\doteq",!0),jLe(XLe,KLe,oNe,"⌢","\\frown",!0),jLe(XLe,KLe,oNe,"∋","\\ni",!0),jLe(XLe,KLe,oNe,"∝","\\propto",!0),jLe(XLe,KLe,oNe,"⊢","\\vdash",!0),jLe(XLe,KLe,oNe,"⊣","\\dashv",!0),jLe(XLe,KLe,oNe,"∋","\\owns"),jLe(XLe,KLe,iNe,".","\\ldotp"),jLe(XLe,KLe,iNe,"⋅","\\cdotp"),jLe(XLe,KLe,lNe,"#","\\#"),jLe($Le,KLe,lNe,"#","\\#"),jLe(XLe,KLe,lNe,"&","\\&"),jLe($Le,KLe,lNe,"&","\\&"),jLe(XLe,KLe,lNe,"ℵ","\\aleph",!0),jLe(XLe,KLe,lNe,"∀","\\forall",!0),jLe(XLe,KLe,lNe,"ℏ","\\hbar",!0),jLe(XLe,KLe,lNe,"∃","\\exists",!0),jLe(XLe,KLe,lNe,"∇","\\nabla",!0),jLe(XLe,KLe,lNe,"♭","\\flat",!0),jLe(XLe,KLe,lNe,"ℓ","\\ell",!0),jLe(XLe,KLe,lNe,"♮","\\natural",!0),jLe(XLe,KLe,lNe,"♣","\\clubsuit",!0),jLe(XLe,KLe,lNe,"℘","\\wp",!0),jLe(XLe,KLe,lNe,"♯","\\sharp",!0),jLe(XLe,KLe,lNe,"♢","\\diamondsuit",!0),jLe(XLe,KLe,lNe,"ℜ","\\Re",!0),jLe(XLe,KLe,lNe,"♡","\\heartsuit",!0),jLe(XLe,KLe,lNe,"ℑ","\\Im",!0),jLe(XLe,KLe,lNe,"♠","\\spadesuit",!0),jLe(XLe,KLe,lNe,"§","\\S",!0),jLe($Le,KLe,lNe,"§","\\S"),jLe(XLe,KLe,lNe,"¶","\\P",!0),jLe($Le,KLe,lNe,"¶","\\P"),jLe(XLe,KLe,lNe,"†","\\dag"),jLe($Le,KLe,lNe,"†","\\dag"),jLe($Le,KLe,lNe,"†","\\textdagger"),jLe(XLe,KLe,lNe,"‡","\\ddag"),jLe($Le,KLe,lNe,"‡","\\ddag"),jLe($Le,KLe,lNe,"‡","\\textdaggerdbl"),jLe(XLe,KLe,eNe,"⎱","\\rmoustache",!0),jLe(XLe,KLe,rNe,"⎰","\\lmoustache",!0),jLe(XLe,KLe,eNe,"⟯","\\rgroup",!0),jLe(XLe,KLe,rNe,"⟮","\\lgroup",!0),jLe(XLe,KLe,QLe,"∓","\\mp",!0),jLe(XLe,KLe,QLe,"⊖","\\ominus",!0),jLe(XLe,KLe,QLe,"⊎","\\uplus",!0),jLe(XLe,KLe,QLe,"⊓","\\sqcap",!0),jLe(XLe,KLe,QLe,"∗","\\ast"),jLe(XLe,KLe,QLe,"⊔","\\sqcup",!0),jLe(XLe,KLe,QLe,"◯","\\bigcirc",!0),jLe(XLe,KLe,QLe,"∙","\\bullet",!0),jLe(XLe,KLe,QLe,"‡","\\ddagger"),jLe(XLe,KLe,QLe,"≀","\\wr",!0),jLe(XLe,KLe,QLe,"⨿","\\amalg"),jLe(XLe,KLe,QLe,"&","\\And"),jLe(XLe,KLe,oNe,"⟵","\\longleftarrow",!0),jLe(XLe,KLe,oNe,"⇐","\\Leftarrow",!0),jLe(XLe,KLe,oNe,"⟸","\\Longleftarrow",!0),jLe(XLe,KLe,oNe,"⟶","\\longrightarrow",!0),jLe(XLe,KLe,oNe,"⇒","\\Rightarrow",!0),jLe(XLe,KLe,oNe,"⟹","\\Longrightarrow",!0),jLe(XLe,KLe,oNe,"↔","\\leftrightarrow",!0),jLe(XLe,KLe,oNe,"⟷","\\longleftrightarrow",!0),jLe(XLe,KLe,oNe,"⇔","\\Leftrightarrow",!0),jLe(XLe,KLe,oNe,"⟺","\\Longleftrightarrow",!0),jLe(XLe,KLe,oNe,"↦","\\mapsto",!0),jLe(XLe,KLe,oNe,"⟼","\\longmapsto",!0),jLe(XLe,KLe,oNe,"↗","\\nearrow",!0),jLe(XLe,KLe,oNe,"↩","\\hookleftarrow",!0),jLe(XLe,KLe,oNe,"↪","\\hookrightarrow",!0),jLe(XLe,KLe,oNe,"↘","\\searrow",!0),jLe(XLe,KLe,oNe,"↼","\\leftharpoonup",!0),jLe(XLe,KLe,oNe,"⇀","\\rightharpoonup",!0),jLe(XLe,KLe,oNe,"↙","\\swarrow",!0),jLe(XLe,KLe,oNe,"↽","\\leftharpoondown",!0),jLe(XLe,KLe,oNe,"⇁","\\rightharpoondown",!0),jLe(XLe,KLe,oNe,"↖","\\nwarrow",!0),jLe(XLe,KLe,oNe,"⇌","\\rightleftharpoons",!0),jLe(XLe,ZLe,oNe,"≮","\\nless",!0),jLe(XLe,ZLe,oNe,"","\\@nleqslant"),jLe(XLe,ZLe,oNe,"","\\@nleqq"),jLe(XLe,ZLe,oNe,"⪇","\\lneq",!0),jLe(XLe,ZLe,oNe,"≨","\\lneqq",!0),jLe(XLe,ZLe,oNe,"","\\@lvertneqq"),jLe(XLe,ZLe,oNe,"⋦","\\lnsim",!0),jLe(XLe,ZLe,oNe,"⪉","\\lnapprox",!0),jLe(XLe,ZLe,oNe,"⊀","\\nprec",!0),jLe(XLe,ZLe,oNe,"⋠","\\npreceq",!0),jLe(XLe,ZLe,oNe,"⋨","\\precnsim",!0),jLe(XLe,ZLe,oNe,"⪹","\\precnapprox",!0),jLe(XLe,ZLe,oNe,"≁","\\nsim",!0),jLe(XLe,ZLe,oNe,"","\\@nshortmid"),jLe(XLe,ZLe,oNe,"∤","\\nmid",!0),jLe(XLe,ZLe,oNe,"⊬","\\nvdash",!0),jLe(XLe,ZLe,oNe,"⊭","\\nvDash",!0),jLe(XLe,ZLe,oNe,"⋪","\\ntriangleleft"),jLe(XLe,ZLe,oNe,"⋬","\\ntrianglelefteq",!0),jLe(XLe,ZLe,oNe,"⊊","\\subsetneq",!0),jLe(XLe,ZLe,oNe,"","\\@varsubsetneq"),jLe(XLe,ZLe,oNe,"⫋","\\subsetneqq",!0),jLe(XLe,ZLe,oNe,"","\\@varsubsetneqq"),jLe(XLe,ZLe,oNe,"≯","\\ngtr",!0),jLe(XLe,ZLe,oNe,"","\\@ngeqslant"),jLe(XLe,ZLe,oNe,"","\\@ngeqq"),jLe(XLe,ZLe,oNe,"⪈","\\gneq",!0),jLe(XLe,ZLe,oNe,"≩","\\gneqq",!0),jLe(XLe,ZLe,oNe,"","\\@gvertneqq"),jLe(XLe,ZLe,oNe,"⋧","\\gnsim",!0),jLe(XLe,ZLe,oNe,"⪊","\\gnapprox",!0),jLe(XLe,ZLe,oNe,"⊁","\\nsucc",!0),jLe(XLe,ZLe,oNe,"⋡","\\nsucceq",!0),jLe(XLe,ZLe,oNe,"⋩","\\succnsim",!0),jLe(XLe,ZLe,oNe,"⪺","\\succnapprox",!0),jLe(XLe,ZLe,oNe,"≆","\\ncong",!0),jLe(XLe,ZLe,oNe,"","\\@nshortparallel"),jLe(XLe,ZLe,oNe,"∦","\\nparallel",!0),jLe(XLe,ZLe,oNe,"⊯","\\nVDash",!0),jLe(XLe,ZLe,oNe,"⋫","\\ntriangleright"),jLe(XLe,ZLe,oNe,"⋭","\\ntrianglerighteq",!0),jLe(XLe,ZLe,oNe,"","\\@nsupseteqq"),jLe(XLe,ZLe,oNe,"⊋","\\supsetneq",!0),jLe(XLe,ZLe,oNe,"","\\@varsupsetneq"),jLe(XLe,ZLe,oNe,"⫌","\\supsetneqq",!0),jLe(XLe,ZLe,oNe,"","\\@varsupsetneqq"),jLe(XLe,ZLe,oNe,"⊮","\\nVdash",!0),jLe(XLe,ZLe,oNe,"⪵","\\precneqq",!0),jLe(XLe,ZLe,oNe,"⪶","\\succneqq",!0),jLe(XLe,ZLe,oNe,"","\\@nsubseteqq"),jLe(XLe,ZLe,QLe,"⊴","\\unlhd"),jLe(XLe,ZLe,QLe,"⊵","\\unrhd"),jLe(XLe,ZLe,oNe,"↚","\\nleftarrow",!0),jLe(XLe,ZLe,oNe,"↛","\\nrightarrow",!0),jLe(XLe,ZLe,oNe,"⇍","\\nLeftarrow",!0),jLe(XLe,ZLe,oNe,"⇏","\\nRightarrow",!0),jLe(XLe,ZLe,oNe,"↮","\\nleftrightarrow",!0),jLe(XLe,ZLe,oNe,"⇎","\\nLeftrightarrow",!0),jLe(XLe,ZLe,oNe,"△","\\vartriangle"),jLe(XLe,ZLe,lNe,"ℏ","\\hslash"),jLe(XLe,ZLe,lNe,"▽","\\triangledown"),jLe(XLe,ZLe,lNe,"◊","\\lozenge"),jLe(XLe,ZLe,lNe,"Ⓢ","\\circledS"),jLe(XLe,ZLe,lNe,"®","\\circledR"),jLe($Le,ZLe,lNe,"®","\\circledR"),jLe(XLe,ZLe,lNe,"∡","\\measuredangle",!0),jLe(XLe,ZLe,lNe,"∄","\\nexists"),jLe(XLe,ZLe,lNe,"℧","\\mho"),jLe(XLe,ZLe,lNe,"Ⅎ","\\Finv",!0),jLe(XLe,ZLe,lNe,"⅁","\\Game",!0),jLe(XLe,ZLe,lNe,"‵","\\backprime"),jLe(XLe,ZLe,lNe,"▲","\\blacktriangle"),jLe(XLe,ZLe,lNe,"▼","\\blacktriangledown"),jLe(XLe,ZLe,lNe,"■","\\blacksquare"),jLe(XLe,ZLe,lNe,"⧫","\\blacklozenge"),jLe(XLe,ZLe,lNe,"★","\\bigstar"),jLe(XLe,ZLe,lNe,"∢","\\sphericalangle",!0),jLe(XLe,ZLe,lNe,"∁","\\complement",!0),jLe(XLe,ZLe,lNe,"ð","\\eth",!0),jLe($Le,KLe,lNe,"ð","ð"),jLe(XLe,ZLe,lNe,"╱","\\diagup"),jLe(XLe,ZLe,lNe,"╲","\\diagdown"),jLe(XLe,ZLe,lNe,"□","\\square"),jLe(XLe,ZLe,lNe,"□","\\Box"),jLe(XLe,ZLe,lNe,"◊","\\Diamond"),jLe(XLe,ZLe,lNe,"¥","\\yen",!0),jLe($Le,ZLe,lNe,"¥","\\yen",!0),jLe(XLe,ZLe,lNe,"✓","\\checkmark",!0),jLe($Le,ZLe,lNe,"✓","\\checkmark"),jLe(XLe,ZLe,lNe,"ℶ","\\beth",!0),jLe(XLe,ZLe,lNe,"ℸ","\\daleth",!0),jLe(XLe,ZLe,lNe,"ℷ","\\gimel",!0),jLe(XLe,ZLe,lNe,"ϝ","\\digamma",!0),jLe(XLe,ZLe,lNe,"ϰ","\\varkappa"),jLe(XLe,ZLe,rNe,"┌","\\@ulcorner",!0),jLe(XLe,ZLe,eNe,"┐","\\@urcorner",!0),jLe(XLe,ZLe,rNe,"└","\\@llcorner",!0),jLe(XLe,ZLe,eNe,"┘","\\@lrcorner",!0),jLe(XLe,ZLe,oNe,"≦","\\leqq",!0),jLe(XLe,ZLe,oNe,"⩽","\\leqslant",!0),jLe(XLe,ZLe,oNe,"⪕","\\eqslantless",!0),jLe(XLe,ZLe,oNe,"≲","\\lesssim",!0),jLe(XLe,ZLe,oNe,"⪅","\\lessapprox",!0),jLe(XLe,ZLe,oNe,"≊","\\approxeq",!0),jLe(XLe,ZLe,QLe,"⋖","\\lessdot"),jLe(XLe,ZLe,oNe,"⋘","\\lll",!0),jLe(XLe,ZLe,oNe,"≶","\\lessgtr",!0),jLe(XLe,ZLe,oNe,"⋚","\\lesseqgtr",!0),jLe(XLe,ZLe,oNe,"⪋","\\lesseqqgtr",!0),jLe(XLe,ZLe,oNe,"≑","\\doteqdot"),jLe(XLe,ZLe,oNe,"≓","\\risingdotseq",!0),jLe(XLe,ZLe,oNe,"≒","\\fallingdotseq",!0),jLe(XLe,ZLe,oNe,"∽","\\backsim",!0),jLe(XLe,ZLe,oNe,"⋍","\\backsimeq",!0),jLe(XLe,ZLe,oNe,"⫅","\\subseteqq",!0),jLe(XLe,ZLe,oNe,"⋐","\\Subset",!0),jLe(XLe,ZLe,oNe,"⊏","\\sqsubset",!0),jLe(XLe,ZLe,oNe,"≼","\\preccurlyeq",!0),jLe(XLe,ZLe,oNe,"⋞","\\curlyeqprec",!0),jLe(XLe,ZLe,oNe,"≾","\\precsim",!0),jLe(XLe,ZLe,oNe,"⪷","\\precapprox",!0),jLe(XLe,ZLe,oNe,"⊲","\\vartriangleleft"),jLe(XLe,ZLe,oNe,"⊴","\\trianglelefteq"),jLe(XLe,ZLe,oNe,"⊨","\\vDash",!0),jLe(XLe,ZLe,oNe,"⊪","\\Vvdash",!0),jLe(XLe,ZLe,oNe,"⌣","\\smallsmile"),jLe(XLe,ZLe,oNe,"⌢","\\smallfrown"),jLe(XLe,ZLe,oNe,"≏","\\bumpeq",!0),jLe(XLe,ZLe,oNe,"≎","\\Bumpeq",!0),jLe(XLe,ZLe,oNe,"≧","\\geqq",!0),jLe(XLe,ZLe,oNe,"⩾","\\geqslant",!0),jLe(XLe,ZLe,oNe,"⪖","\\eqslantgtr",!0),jLe(XLe,ZLe,oNe,"≳","\\gtrsim",!0),jLe(XLe,ZLe,oNe,"⪆","\\gtrapprox",!0),jLe(XLe,ZLe,QLe,"⋗","\\gtrdot"),jLe(XLe,ZLe,oNe,"⋙","\\ggg",!0),jLe(XLe,ZLe,oNe,"≷","\\gtrless",!0),jLe(XLe,ZLe,oNe,"⋛","\\gtreqless",!0),jLe(XLe,ZLe,oNe,"⪌","\\gtreqqless",!0),jLe(XLe,ZLe,oNe,"≖","\\eqcirc",!0),jLe(XLe,ZLe,oNe,"≗","\\circeq",!0),jLe(XLe,ZLe,oNe,"≜","\\triangleq",!0),jLe(XLe,ZLe,oNe,"∼","\\thicksim"),jLe(XLe,ZLe,oNe,"≈","\\thickapprox"),jLe(XLe,ZLe,oNe,"⫆","\\supseteqq",!0),jLe(XLe,ZLe,oNe,"⋑","\\Supset",!0),jLe(XLe,ZLe,oNe,"⊐","\\sqsupset",!0),jLe(XLe,ZLe,oNe,"≽","\\succcurlyeq",!0),jLe(XLe,ZLe,oNe,"⋟","\\curlyeqsucc",!0),jLe(XLe,ZLe,oNe,"≿","\\succsim",!0),jLe(XLe,ZLe,oNe,"⪸","\\succapprox",!0),jLe(XLe,ZLe,oNe,"⊳","\\vartriangleright"),jLe(XLe,ZLe,oNe,"⊵","\\trianglerighteq"),jLe(XLe,ZLe,oNe,"⊩","\\Vdash",!0),jLe(XLe,ZLe,oNe,"∣","\\shortmid"),jLe(XLe,ZLe,oNe,"∥","\\shortparallel"),jLe(XLe,ZLe,oNe,"≬","\\between",!0),jLe(XLe,ZLe,oNe,"⋔","\\pitchfork",!0),jLe(XLe,ZLe,oNe,"∝","\\varpropto"),jLe(XLe,ZLe,oNe,"◀","\\blacktriangleleft"),jLe(XLe,ZLe,oNe,"∴","\\therefore",!0),jLe(XLe,ZLe,oNe,"∍","\\backepsilon"),jLe(XLe,ZLe,oNe,"▶","\\blacktriangleright"),jLe(XLe,ZLe,oNe,"∵","\\because",!0),jLe(XLe,ZLe,oNe,"⋘","\\llless"),jLe(XLe,ZLe,oNe,"⋙","\\gggtr"),jLe(XLe,ZLe,QLe,"⊲","\\lhd"),jLe(XLe,ZLe,QLe,"⊳","\\rhd"),jLe(XLe,ZLe,oNe,"≂","\\eqsim",!0),jLe(XLe,KLe,oNe,"⋈","\\Join"),jLe(XLe,ZLe,oNe,"≑","\\Doteq",!0),jLe(XLe,ZLe,QLe,"∔","\\dotplus",!0),jLe(XLe,ZLe,QLe,"∖","\\smallsetminus"),jLe(XLe,ZLe,QLe,"⋒","\\Cap",!0),jLe(XLe,ZLe,QLe,"⋓","\\Cup",!0),jLe(XLe,ZLe,QLe,"⩞","\\doublebarwedge",!0),jLe(XLe,ZLe,QLe,"⊟","\\boxminus",!0),jLe(XLe,ZLe,QLe,"⊞","\\boxplus",!0),jLe(XLe,ZLe,QLe,"⋇","\\divideontimes",!0),jLe(XLe,ZLe,QLe,"⋉","\\ltimes",!0),jLe(XLe,ZLe,QLe,"⋊","\\rtimes",!0),jLe(XLe,ZLe,QLe,"⋋","\\leftthreetimes",!0),jLe(XLe,ZLe,QLe,"⋌","\\rightthreetimes",!0),jLe(XLe,ZLe,QLe,"⋏","\\curlywedge",!0),jLe(XLe,ZLe,QLe,"⋎","\\curlyvee",!0),jLe(XLe,ZLe,QLe,"⊝","\\circleddash",!0),jLe(XLe,ZLe,QLe,"⊛","\\circledast",!0),jLe(XLe,ZLe,QLe,"⋅","\\centerdot"),jLe(XLe,ZLe,QLe,"⊺","\\intercal",!0),jLe(XLe,ZLe,QLe,"⋒","\\doublecap"),jLe(XLe,ZLe,QLe,"⋓","\\doublecup"),jLe(XLe,ZLe,QLe,"⊠","\\boxtimes",!0),jLe(XLe,ZLe,oNe,"⇢","\\dashrightarrow",!0),jLe(XLe,ZLe,oNe,"⇠","\\dashleftarrow",!0),jLe(XLe,ZLe,oNe,"⇇","\\leftleftarrows",!0),jLe(XLe,ZLe,oNe,"⇆","\\leftrightarrows",!0),jLe(XLe,ZLe,oNe,"⇚","\\Lleftarrow",!0),jLe(XLe,ZLe,oNe,"↞","\\twoheadleftarrow",!0),jLe(XLe,ZLe,oNe,"↢","\\leftarrowtail",!0),jLe(XLe,ZLe,oNe,"↫","\\looparrowleft",!0),jLe(XLe,ZLe,oNe,"⇋","\\leftrightharpoons",!0),jLe(XLe,ZLe,oNe,"↶","\\curvearrowleft",!0),jLe(XLe,ZLe,oNe,"↺","\\circlearrowleft",!0),jLe(XLe,ZLe,oNe,"↰","\\Lsh",!0),jLe(XLe,ZLe,oNe,"⇈","\\upuparrows",!0),jLe(XLe,ZLe,oNe,"↿","\\upharpoonleft",!0),jLe(XLe,ZLe,oNe,"⇃","\\downharpoonleft",!0),jLe(XLe,KLe,oNe,"⊶","\\origof",!0),jLe(XLe,KLe,oNe,"⊷","\\imageof",!0),jLe(XLe,ZLe,oNe,"⊸","\\multimap",!0),jLe(XLe,ZLe,oNe,"↭","\\leftrightsquigarrow",!0),jLe(XLe,ZLe,oNe,"⇉","\\rightrightarrows",!0),jLe(XLe,ZLe,oNe,"⇄","\\rightleftarrows",!0),jLe(XLe,ZLe,oNe,"↠","\\twoheadrightarrow",!0),jLe(XLe,ZLe,oNe,"↣","\\rightarrowtail",!0),jLe(XLe,ZLe,oNe,"↬","\\looparrowright",!0),jLe(XLe,ZLe,oNe,"↷","\\curvearrowright",!0),jLe(XLe,ZLe,oNe,"↻","\\circlearrowright",!0),jLe(XLe,ZLe,oNe,"↱","\\Rsh",!0),jLe(XLe,ZLe,oNe,"⇊","\\downdownarrows",!0),jLe(XLe,ZLe,oNe,"↾","\\upharpoonright",!0),jLe(XLe,ZLe,oNe,"⇂","\\downharpoonright",!0),jLe(XLe,ZLe,oNe,"⇝","\\rightsquigarrow",!0),jLe(XLe,ZLe,oNe,"⇝","\\leadsto"),jLe(XLe,ZLe,oNe,"⇛","\\Rrightarrow",!0),jLe(XLe,ZLe,oNe,"↾","\\restriction"),jLe(XLe,KLe,lNe,"‘","`"),jLe(XLe,KLe,lNe,"$","\\$"),jLe($Le,KLe,lNe,"$","\\$"),jLe($Le,KLe,lNe,"$","\\textdollar"),jLe(XLe,KLe,lNe,"%","\\%"),jLe($Le,KLe,lNe,"%","\\%"),jLe(XLe,KLe,lNe,"_","\\_"),jLe($Le,KLe,lNe,"_","\\_"),jLe($Le,KLe,lNe,"_","\\textunderscore"),jLe(XLe,KLe,lNe,"∠","\\angle",!0),jLe(XLe,KLe,lNe,"∞","\\infty",!0),jLe(XLe,KLe,lNe,"′","\\prime"),jLe(XLe,KLe,lNe,"△","\\triangle"),jLe(XLe,KLe,lNe,"Γ","\\Gamma",!0),jLe(XLe,KLe,lNe,"Δ","\\Delta",!0),jLe(XLe,KLe,lNe,"Θ","\\Theta",!0),jLe(XLe,KLe,lNe,"Λ","\\Lambda",!0),jLe(XLe,KLe,lNe,"Ξ","\\Xi",!0),jLe(XLe,KLe,lNe,"Π","\\Pi",!0),jLe(XLe,KLe,lNe,"Σ","\\Sigma",!0),jLe(XLe,KLe,lNe,"Υ","\\Upsilon",!0),jLe(XLe,KLe,lNe,"Φ","\\Phi",!0),jLe(XLe,KLe,lNe,"Ψ","\\Psi",!0),jLe(XLe,KLe,lNe,"Ω","\\Omega",!0),jLe(XLe,KLe,lNe,"A","Α"),jLe(XLe,KLe,lNe,"B","Β"),jLe(XLe,KLe,lNe,"E","Ε"),jLe(XLe,KLe,lNe,"Z","Ζ"),jLe(XLe,KLe,lNe,"H","Η"),jLe(XLe,KLe,lNe,"I","Ι"),jLe(XLe,KLe,lNe,"K","Κ"),jLe(XLe,KLe,lNe,"M","Μ"),jLe(XLe,KLe,lNe,"N","Ν"),jLe(XLe,KLe,lNe,"O","Ο"),jLe(XLe,KLe,lNe,"P","Ρ"),jLe(XLe,KLe,lNe,"T","Τ"),jLe(XLe,KLe,lNe,"X","Χ"),jLe(XLe,KLe,lNe,"¬","\\neg",!0),jLe(XLe,KLe,lNe,"¬","\\lnot"),jLe(XLe,KLe,lNe,"⊤","\\top"),jLe(XLe,KLe,lNe,"⊥","\\bot"),jLe(XLe,KLe,lNe,"∅","\\emptyset"),jLe(XLe,ZLe,lNe,"∅","\\varnothing"),jLe(XLe,KLe,aNe,"α","\\alpha",!0),jLe(XLe,KLe,aNe,"β","\\beta",!0),jLe(XLe,KLe,aNe,"γ","\\gamma",!0),jLe(XLe,KLe,aNe,"δ","\\delta",!0),jLe(XLe,KLe,aNe,"ϵ","\\epsilon",!0),jLe(XLe,KLe,aNe,"ζ","\\zeta",!0),jLe(XLe,KLe,aNe,"η","\\eta",!0),jLe(XLe,KLe,aNe,"θ","\\theta",!0),jLe(XLe,KLe,aNe,"ι","\\iota",!0),jLe(XLe,KLe,aNe,"κ","\\kappa",!0),jLe(XLe,KLe,aNe,"λ","\\lambda",!0),jLe(XLe,KLe,aNe,"μ","\\mu",!0),jLe(XLe,KLe,aNe,"ν","\\nu",!0),jLe(XLe,KLe,aNe,"ξ","\\xi",!0),jLe(XLe,KLe,aNe,"ο","\\omicron",!0),jLe(XLe,KLe,aNe,"π","\\pi",!0),jLe(XLe,KLe,aNe,"ρ","\\rho",!0),jLe(XLe,KLe,aNe,"σ","\\sigma",!0),jLe(XLe,KLe,aNe,"τ","\\tau",!0),jLe(XLe,KLe,aNe,"υ","\\upsilon",!0),jLe(XLe,KLe,aNe,"ϕ","\\phi",!0),jLe(XLe,KLe,aNe,"χ","\\chi",!0),jLe(XLe,KLe,aNe,"ψ","\\psi",!0),jLe(XLe,KLe,aNe,"ω","\\omega",!0),jLe(XLe,KLe,aNe,"ε","\\varepsilon",!0),jLe(XLe,KLe,aNe,"ϑ","\\vartheta",!0),jLe(XLe,KLe,aNe,"ϖ","\\varpi",!0),jLe(XLe,KLe,aNe,"ϱ","\\varrho",!0),jLe(XLe,KLe,aNe,"ς","\\varsigma",!0),jLe(XLe,KLe,aNe,"φ","\\varphi",!0),jLe(XLe,KLe,QLe,"∗","*",!0),jLe(XLe,KLe,QLe,"+","+"),jLe(XLe,KLe,QLe,"−","-",!0),jLe(XLe,KLe,QLe,"⋅","\\cdot",!0),jLe(XLe,KLe,QLe,"∘","\\circ",!0),jLe(XLe,KLe,QLe,"÷","\\div",!0),jLe(XLe,KLe,QLe,"±","\\pm",!0),jLe(XLe,KLe,QLe,"×","\\times",!0),jLe(XLe,KLe,QLe,"∩","\\cap",!0),jLe(XLe,KLe,QLe,"∪","\\cup",!0),jLe(XLe,KLe,QLe,"∖","\\setminus",!0),jLe(XLe,KLe,QLe,"∧","\\land"),jLe(XLe,KLe,QLe,"∨","\\lor"),jLe(XLe,KLe,QLe,"∧","\\wedge",!0),jLe(XLe,KLe,QLe,"∨","\\vee",!0),jLe(XLe,KLe,lNe,"√","\\surd"),jLe(XLe,KLe,rNe,"⟨","\\langle",!0),jLe(XLe,KLe,rNe,"∣","\\lvert"),jLe(XLe,KLe,rNe,"∥","\\lVert"),jLe(XLe,KLe,eNe,"?","?"),jLe(XLe,KLe,eNe,"!","!"),jLe(XLe,KLe,eNe,"⟩","\\rangle",!0),jLe(XLe,KLe,eNe,"∣","\\rvert"),jLe(XLe,KLe,eNe,"∥","\\rVert"),jLe(XLe,KLe,oNe,"=","="),jLe(XLe,KLe,oNe,":",":"),jLe(XLe,KLe,oNe,"≈","\\approx",!0),jLe(XLe,KLe,oNe,"≅","\\cong",!0),jLe(XLe,KLe,oNe,"≥","\\ge"),jLe(XLe,KLe,oNe,"≥","\\geq",!0),jLe(XLe,KLe,oNe,"←","\\gets"),jLe(XLe,KLe,oNe,">","\\gt",!0),jLe(XLe,KLe,oNe,"∈","\\in",!0),jLe(XLe,KLe,oNe,"","\\@not"),jLe(XLe,KLe,oNe,"⊂","\\subset",!0),jLe(XLe,KLe,oNe,"⊃","\\supset",!0),jLe(XLe,KLe,oNe,"⊆","\\subseteq",!0),jLe(XLe,KLe,oNe,"⊇","\\supseteq",!0),jLe(XLe,ZLe,oNe,"⊈","\\nsubseteq",!0),jLe(XLe,ZLe,oNe,"⊉","\\nsupseteq",!0),jLe(XLe,KLe,oNe,"⊨","\\models"),jLe(XLe,KLe,oNe,"←","\\leftarrow",!0),jLe(XLe,KLe,oNe,"≤","\\le"),jLe(XLe,KLe,oNe,"≤","\\leq",!0),jLe(XLe,KLe,oNe,"<","\\lt",!0),jLe(XLe,KLe,oNe,"→","\\rightarrow",!0),jLe(XLe,KLe,oNe,"→","\\to"),jLe(XLe,ZLe,oNe,"≱","\\ngeq",!0),jLe(XLe,ZLe,oNe,"≰","\\nleq",!0),jLe(XLe,KLe,sNe," ","\\ "),jLe(XLe,KLe,sNe," ","\\space"),jLe(XLe,KLe,sNe," ","\\nobreakspace"),jLe($Le,KLe,sNe," ","\\ "),jLe($Le,KLe,sNe," "," "),jLe($Le,KLe,sNe," ","\\space"),jLe($Le,KLe,sNe," ","\\nobreakspace"),jLe(XLe,KLe,sNe,null,"\\nobreak"),jLe(XLe,KLe,sNe,null,"\\allowbreak"),jLe(XLe,KLe,iNe,",",","),jLe(XLe,KLe,iNe,";",";"),jLe(XLe,ZLe,QLe,"⊼","\\barwedge",!0),jLe(XLe,ZLe,QLe,"⊻","\\veebar",!0),jLe(XLe,KLe,QLe,"⊙","\\odot",!0),jLe(XLe,KLe,QLe,"⊕","\\oplus",!0),jLe(XLe,KLe,QLe,"⊗","\\otimes",!0),jLe(XLe,KLe,lNe,"∂","\\partial",!0),jLe(XLe,KLe,QLe,"⊘","\\oslash",!0),jLe(XLe,ZLe,QLe,"⊚","\\circledcirc",!0),jLe(XLe,ZLe,QLe,"⊡","\\boxdot",!0),jLe(XLe,KLe,QLe,"△","\\bigtriangleup"),jLe(XLe,KLe,QLe,"▽","\\bigtriangledown"),jLe(XLe,KLe,QLe,"†","\\dagger"),jLe(XLe,KLe,QLe,"⋄","\\diamond"),jLe(XLe,KLe,QLe,"⋆","\\star"),jLe(XLe,KLe,QLe,"◃","\\triangleleft"),jLe(XLe,KLe,QLe,"▹","\\triangleright"),jLe(XLe,KLe,rNe,"{","\\{"),jLe($Le,KLe,lNe,"{","\\{"),jLe($Le,KLe,lNe,"{","\\textbraceleft"),jLe(XLe,KLe,eNe,"}","\\}"),jLe($Le,KLe,lNe,"}","\\}"),jLe($Le,KLe,lNe,"}","\\textbraceright"),jLe(XLe,KLe,rNe,"{","\\lbrace"),jLe(XLe,KLe,eNe,"}","\\rbrace"),jLe(XLe,KLe,rNe,"[","\\lbrack",!0),jLe($Le,KLe,lNe,"[","\\lbrack",!0),jLe(XLe,KLe,eNe,"]","\\rbrack",!0),jLe($Le,KLe,lNe,"]","\\rbrack",!0),jLe(XLe,KLe,rNe,"(","\\lparen",!0),jLe(XLe,KLe,eNe,")","\\rparen",!0),jLe($Le,KLe,lNe,"<","\\textless",!0),jLe($Le,KLe,lNe,">","\\textgreater",!0),jLe(XLe,KLe,rNe,"⌊","\\lfloor",!0),jLe(XLe,KLe,eNe,"⌋","\\rfloor",!0),jLe(XLe,KLe,rNe,"⌈","\\lceil",!0),jLe(XLe,KLe,eNe,"⌉","\\rceil",!0),jLe(XLe,KLe,lNe,"\\","\\backslash"),jLe(XLe,KLe,lNe,"∣","|"),jLe(XLe,KLe,lNe,"∣","\\vert"),jLe($Le,KLe,lNe,"|","\\textbar",!0),jLe(XLe,KLe,lNe,"∥","\\|"),jLe(XLe,KLe,lNe,"∥","\\Vert"),jLe($Le,KLe,lNe,"∥","\\textbardbl"),jLe($Le,KLe,lNe,"~","\\textasciitilde"),jLe($Le,KLe,lNe,"\\","\\textbackslash"),jLe($Le,KLe,lNe,"^","\\textasciicircum"),jLe(XLe,KLe,oNe,"↑","\\uparrow",!0),jLe(XLe,KLe,oNe,"⇑","\\Uparrow",!0),jLe(XLe,KLe,oNe,"↓","\\downarrow",!0),jLe(XLe,KLe,oNe,"⇓","\\Downarrow",!0),jLe(XLe,KLe,oNe,"↕","\\updownarrow",!0),jLe(XLe,KLe,oNe,"⇕","\\Updownarrow",!0),jLe(XLe,KLe,nNe,"∐","\\coprod"),jLe(XLe,KLe,nNe,"⋁","\\bigvee"),jLe(XLe,KLe,nNe,"⋀","\\bigwedge"),jLe(XLe,KLe,nNe,"⨄","\\biguplus"),jLe(XLe,KLe,nNe,"⋂","\\bigcap"),jLe(XLe,KLe,nNe,"⋃","\\bigcup"),jLe(XLe,KLe,nNe,"∫","\\int"),jLe(XLe,KLe,nNe,"∫","\\intop"),jLe(XLe,KLe,nNe,"∬","\\iint"),jLe(XLe,KLe,nNe,"∭","\\iiint"),jLe(XLe,KLe,nNe,"∏","\\prod"),jLe(XLe,KLe,nNe,"∑","\\sum"),jLe(XLe,KLe,nNe,"⨂","\\bigotimes"),jLe(XLe,KLe,nNe,"⨁","\\bigoplus"),jLe(XLe,KLe,nNe,"⨀","\\bigodot"),jLe(XLe,KLe,nNe,"∮","\\oint"),jLe(XLe,KLe,nNe,"∯","\\oiint"),jLe(XLe,KLe,nNe,"∰","\\oiiint"),jLe(XLe,KLe,nNe,"⨆","\\bigsqcup"),jLe(XLe,KLe,nNe,"∫","\\smallint"),jLe($Le,KLe,tNe,"…","\\textellipsis"),jLe(XLe,KLe,tNe,"…","\\mathellipsis"),jLe($Le,KLe,tNe,"…","\\ldots",!0),jLe(XLe,KLe,tNe,"…","\\ldots",!0),jLe(XLe,KLe,tNe,"⋯","\\@cdots",!0),jLe(XLe,KLe,tNe,"⋱","\\ddots",!0),jLe(XLe,KLe,lNe,"⋮","\\varvdots"),jLe($Le,KLe,lNe,"⋮","\\varvdots"),jLe(XLe,KLe,JLe,"ˊ","\\acute"),jLe(XLe,KLe,JLe,"ˋ","\\grave"),jLe(XLe,KLe,JLe,"¨","\\ddot"),jLe(XLe,KLe,JLe,"~","\\tilde"),jLe(XLe,KLe,JLe,"ˉ","\\bar"),jLe(XLe,KLe,JLe,"˘","\\breve"),jLe(XLe,KLe,JLe,"ˇ","\\check"),jLe(XLe,KLe,JLe,"^","\\hat"),jLe(XLe,KLe,JLe,"⃗","\\vec"),jLe(XLe,KLe,JLe,"˙","\\dot"),jLe(XLe,KLe,JLe,"˚","\\mathring"),jLe(XLe,KLe,aNe,"","\\@imath"),jLe(XLe,KLe,aNe,"","\\@jmath"),jLe(XLe,KLe,lNe,"ı","ı"),jLe(XLe,KLe,lNe,"ȷ","ȷ"),jLe($Le,KLe,lNe,"ı","\\i",!0),jLe($Le,KLe,lNe,"ȷ","\\j",!0),jLe($Le,KLe,lNe,"ß","\\ss",!0),jLe($Le,KLe,lNe,"æ","\\ae",!0),jLe($Le,KLe,lNe,"œ","\\oe",!0),jLe($Le,KLe,lNe,"ø","\\o",!0),jLe($Le,KLe,lNe,"Æ","\\AE",!0),jLe($Le,KLe,lNe,"Œ","\\OE",!0),jLe($Le,KLe,lNe,"Ø","\\O",!0),jLe($Le,KLe,JLe,"ˊ","\\'"),jLe($Le,KLe,JLe,"ˋ","\\`"),jLe($Le,KLe,JLe,"ˆ","\\^"),jLe($Le,KLe,JLe,"˜","\\~"),jLe($Le,KLe,JLe,"ˉ","\\="),jLe($Le,KLe,JLe,"˘","\\u"),jLe($Le,KLe,JLe,"˙","\\."),jLe($Le,KLe,JLe,"¸","\\c"),jLe($Le,KLe,JLe,"˚","\\r"),jLe($Le,KLe,JLe,"ˇ","\\v"),jLe($Le,KLe,JLe,"¨",'\\"'),jLe($Le,KLe,JLe,"˝","\\H"),jLe($Le,KLe,JLe,"◯","\\textcircled");var cNe={"--":!0,"---":!0,"``":!0,"''":!0};jLe($Le,KLe,lNe,"–","--",!0),jLe($Le,KLe,lNe,"–","\\textendash"),jLe($Le,KLe,lNe,"—","---",!0),jLe($Le,KLe,lNe,"—","\\textemdash"),jLe($Le,KLe,lNe,"‘","`",!0),jLe($Le,KLe,lNe,"‘","\\textquoteleft"),jLe($Le,KLe,lNe,"’","'",!0),jLe($Le,KLe,lNe,"’","\\textquoteright"),jLe($Le,KLe,lNe,"“","``",!0),jLe($Le,KLe,lNe,"“","\\textquotedblleft"),jLe($Le,KLe,lNe,"”","''",!0),jLe($Le,KLe,lNe,"”","\\textquotedblright"),jLe(XLe,KLe,lNe,"°","\\degree",!0),jLe($Le,KLe,lNe,"°","\\degree"),jLe($Le,KLe,lNe,"°","\\textdegree",!0),jLe(XLe,KLe,lNe,"£","\\pounds"),jLe(XLe,KLe,lNe,"£","\\mathsterling",!0),jLe($Le,KLe,lNe,"£","\\pounds"),jLe($Le,KLe,lNe,"£","\\textsterling",!0),jLe(XLe,ZLe,lNe,"✠","\\maltese"),jLe($Le,ZLe,lNe,"✠","\\maltese");for(var uNe='0123456789/@."',dNe=0;dNe<14;dNe++){var hNe=uNe.charAt(dNe);jLe(XLe,KLe,lNe,hNe,hNe)}for(var pNe='0123456789!@*()-=+";:?/.,',fNe=0;fNe<25;fNe++){var mNe=pNe.charAt(fNe);jLe($Le,KLe,lNe,mNe,mNe)}for(var vNe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",gNe=0;gNe<52;gNe++){var yNe=vNe.charAt(gNe);jLe(XLe,KLe,aNe,yNe,yNe),jLe($Le,KLe,lNe,yNe,yNe)}jLe(XLe,ZLe,lNe,"C","ℂ"),jLe($Le,ZLe,lNe,"C","ℂ"),jLe(XLe,ZLe,lNe,"H","ℍ"),jLe($Le,ZLe,lNe,"H","ℍ"),jLe(XLe,ZLe,lNe,"N","ℕ"),jLe($Le,ZLe,lNe,"N","ℕ"),jLe(XLe,ZLe,lNe,"P","ℙ"),jLe($Le,ZLe,lNe,"P","ℙ"),jLe(XLe,ZLe,lNe,"Q","ℚ"),jLe($Le,ZLe,lNe,"Q","ℚ"),jLe(XLe,ZLe,lNe,"R","ℝ"),jLe($Le,ZLe,lNe,"R","ℝ"),jLe(XLe,ZLe,lNe,"Z","ℤ"),jLe($Le,ZLe,lNe,"Z","ℤ"),jLe(XLe,KLe,aNe,"h","ℎ"),jLe($Le,KLe,aNe,"h","ℎ");for(var bNe="",xNe=0;xNe<52;xNe++){var wNe=vNe.charAt(xNe);jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56320+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56372+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56424+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56580+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56684+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56736+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56788+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56840+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56944+xNe)),jLe($Le,KLe,lNe,wNe,bNe),xNe<26&&(jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56632+xNe)),jLe($Le,KLe,lNe,wNe,bNe),jLe(XLe,KLe,aNe,wNe,bNe=String.fromCharCode(55349,56476+xNe)),jLe($Le,KLe,lNe,wNe,bNe))}jLe(XLe,KLe,aNe,"k",bNe=String.fromCharCode(55349,56668)),jLe($Le,KLe,lNe,"k",bNe);for(var _Ne=0;_Ne<10;_Ne++){var SNe=_Ne.toString();jLe(XLe,KLe,aNe,SNe,bNe=String.fromCharCode(55349,57294+_Ne)),jLe($Le,KLe,lNe,SNe,bNe),jLe(XLe,KLe,aNe,SNe,bNe=String.fromCharCode(55349,57314+_Ne)),jLe($Le,KLe,lNe,SNe,bNe),jLe(XLe,KLe,aNe,SNe,bNe=String.fromCharCode(55349,57324+_Ne)),jLe($Le,KLe,lNe,SNe,bNe),jLe(XLe,KLe,aNe,SNe,bNe=String.fromCharCode(55349,57334+_Ne)),jLe($Le,KLe,lNe,SNe,bNe)}for(var MNe="ÐÞþ",TNe=0;TNe<3;TNe++){var kNe=MNe.charAt(TNe);jLe(XLe,KLe,aNe,kNe,kNe),jLe($Le,KLe,lNe,kNe,kNe)}var CNe=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],ANe=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],ENe=function(e,t,a){return YLe[a][e]&&YLe[a][e].replace&&(e=YLe[a][e].replace),{value:e,metrics:bLe(e,t,a)}},INe=function(e,t,a,n,r){var i,o=ENe(e,t,a),s=o.metrics;if(e=o.value,s){var l=s.italic;("text"===a||n&&"mathit"===n.font)&&(l=0),i=new ULe(e,s.height,s.depth,l,s.skew,s.width,r)}else"undefined"!=typeof console&&console.warn("No character metrics for '"+e+"' in style '"+t+"' and mode '"+a+"'"),i=new ULe(e,0,0,0,0,0,r);if(n){i.maxFontSize=n.sizeMultiplier,n.style.isTight()&&i.classes.push("mtight");var c=n.getColor();c&&(i.style.color=c)}return i},RNe=(e,t)=>{if(ILe(e.classes)!==ILe(t.classes)||e.skew!==t.skew||e.maxFontSize!==t.maxFontSize)return!1;if(1===e.classes.length){var a=e.classes[0];if("mbin"===a||"mord"===a)return!1}for(var n in e.style)if(e.style.hasOwnProperty(n)&&e.style[n]!==t.style[n])return!1;for(var r in t.style)if(t.style.hasOwnProperty(r)&&e.style[r]!==t.style[r])return!1;return!0},DNe=function(e){for(var t=0,a=0,n=0,r=0;r<e.children.length;r++){var i=e.children[r];i.height>t&&(t=i.height),i.depth>a&&(a=i.depth),i.maxFontSize>n&&(n=i.maxFontSize)}e.height=t,e.depth=a,e.maxFontSize=n},PNe=function(e,t,a,n){var r=new NLe(e,t,a,n);return DNe(r),r},LNe=(e,t,a,n)=>new NLe(e,t,a,n),NNe=function(e){var t=new mLe(e);return DNe(t),t},ONe=function(e,t,a){var n="";switch(e){case"amsrm":n="AMS";break;case"textrm":n="Main";break;case"textsf":n="SansSerif";break;case"texttt":n="Typewriter";break;default:n=e}return n+"-"+("textbf"===t&&"textit"===a?"BoldItalic":"textbf"===t?"Bold":"textit"===t?"Italic":"Regular")},FNe={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},BNe={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},UNe={fontMap:FNe,makeSymbol:INe,mathsym:function(e,t,a,n){return void 0===n&&(n=[]),"boldsymbol"===a.font&&ENe(e,"Main-Bold",t).metrics?INe(e,"Main-Bold",t,a,n.concat(["mathbf"])):"\\"===e||"main"===YLe[t][e].font?INe(e,"Main-Regular",t,a,n):INe(e,"AMS-Regular",t,a,n.concat(["amsrm"]))},makeSpan:PNe,makeSvgSpan:LNe,makeLineSpan:function(e,t,a){var n=PNe([e],[],t);return n.height=Math.max(a||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),n.style.borderBottomWidth=ELe(n.height),n.maxFontSize=1,n},makeAnchor:function(e,t,a,n){var r=new OLe(e,t,a,n);return DNe(r),r},makeFragment:NNe,wrapFragment:function(e,t){return e instanceof mLe?PNe([],[e],t):e},makeVList:function(e,t){for(var{children:a,depth:n}=function(e){if("individualShift"===e.positionType){for(var t=e.children,a=[t[0]],n=-t[0].shift-t[0].elem.depth,r=n,i=1;i<t.length;i++){var o=-t[i].shift-r-t[i].elem.depth,s=o-(t[i-1].elem.height+t[i-1].elem.depth);r+=o,a.push({type:"kern",size:s}),a.push(t[i])}return{children:a,depth:n}}var l;if("top"===e.positionType){for(var c=e.positionData,u=0;u<e.children.length;u++){var d=e.children[u];c-="kern"===d.type?d.size:d.elem.height+d.elem.depth}l=c}else if("bottom"===e.positionType)l=-e.positionData;else{var h=e.children[0];if("elem"!==h.type)throw new Error('First child must have type "elem".');if("shift"===e.positionType)l=-h.elem.depth-e.positionData;else{if("firstBaseline"!==e.positionType)throw new Error("Invalid positionType "+e.positionType+".");l=-h.elem.depth}}return{children:e.children,depth:l}}(e),r=0,i=0;i<a.length;i++){var o=a[i];if("elem"===o.type){var s=o.elem;r=Math.max(r,s.maxFontSize,s.height)}}r+=2;var l=PNe(["pstrut"],[]);l.style.height=ELe(r);for(var c=[],u=n,d=n,h=n,p=0;p<a.length;p++){var f=a[p];if("kern"===f.type)h+=f.size;else{var m=f.elem,v=f.wrapperClasses||[],g=f.wrapperStyle||{},y=PNe(v,[l,m],void 0,g);y.style.top=ELe(-r-h-m.depth),f.marginLeft&&(y.style.marginLeft=f.marginLeft),f.marginRight&&(y.style.marginRight=f.marginRight),c.push(y),h+=m.height+m.depth}u=Math.min(u,h),d=Math.max(d,h)}var b,x=PNe(["vlist"],c);if(x.style.height=ELe(d),u<0){var w=PNe([],[]),_=PNe(["vlist"],[w]);_.style.height=ELe(-u);var S=PNe(["vlist-s"],[new ULe("​")]);b=[PNe(["vlist-r"],[x,S]),PNe(["vlist-r"],[_])]}else b=[PNe(["vlist-r"],[x])];var M=PNe(["vlist-t"],b);return 2===b.length&&M.classes.push("vlist-t2"),M.height=d,M.depth=-u,M},makeOrd:function(e,t,a){var n=e.mode,r=e.text,i=["mord"],o="math"===n||"text"===n&&t.font,s=o?t.font:t.fontFamily,l="",c="";if(55349===r.charCodeAt(0)&&([l,c]=function(e,t){var a=1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536,n="math"===t?0:1;if(119808<=a&&a<120484){var r=Math.floor((a-119808)/26);return[CNe[r][2],CNe[r][n]]}if(120782<=a&&a<=120831){var i=Math.floor((a-120782)/10);return[ANe[i][2],ANe[i][n]]}if(120485===a||120486===a)return[CNe[0][2],CNe[0][n]];if(120486<a&&a<120782)return["",""];throw new YPe("Unsupported character: "+e)}(r,n)),l.length>0)return INe(r,l,n,t,i.concat(c));if(s){var u,d;if("boldsymbol"===s){var h=function(e,t,a,n,r){return"textord"!==r&&ENe(e,"Math-BoldItalic",t).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}}(r,n,0,0,a);u=h.fontName,d=[h.fontClass]}else o?(u=FNe[s].fontName,d=[s]):(u=ONe(s,t.fontWeight,t.fontShape),d=[s,t.fontWeight,t.fontShape]);if(ENe(r,u,n).metrics)return INe(r,u,n,t,i.concat(d));if(cNe.hasOwnProperty(r)&&"Typewriter"===u.slice(0,10)){for(var p=[],f=0;f<r.length;f++)p.push(INe(r[f],u,n,t,i.concat(d)));return NNe(p)}}if("mathord"===a)return INe(r,"Math-Italic",n,t,i.concat(["mathnormal"]));if("textord"===a){var m=YLe[n][r]&&YLe[n][r].font;if("ams"===m){var v=ONe("amsrm",t.fontWeight,t.fontShape);return INe(r,v,n,t,i.concat("amsrm",t.fontWeight,t.fontShape))}if("main"!==m&&m){var g=ONe(m,t.fontWeight,t.fontShape);return INe(r,g,n,t,i.concat(g,t.fontWeight,t.fontShape))}var y=ONe("textrm",t.fontWeight,t.fontShape);return INe(r,y,n,t,i.concat(t.fontWeight,t.fontShape))}throw new Error("unexpected type: "+a+" in makeOrd")},makeGlue:(e,t)=>{var a=PNe(["mspace"],[],t),n=ALe(e,t);return a.style.marginRight=ELe(n),a},staticSvg:function(e,t){var[a,n,r]=BNe[e],i=new VLe(a),o=new zLe([i],{width:ELe(n),height:ELe(r),style:"width:"+ELe(n),viewBox:"0 0 "+1e3*n+" "+1e3*r,preserveAspectRatio:"xMinYMin"}),s=LNe(["overlay"],[o],t);return s.height=r,s.style.height=ELe(r),s.style.width=ELe(n),s},svgData:BNe,tryCombineChars:e=>{for(var t=0;t<e.length-1;t++){var a=e[t],n=e[t+1];a instanceof ULe&&n instanceof ULe&&RNe(a,n)&&(a.text+=n.text,a.height=Math.max(a.height,n.height),a.depth=Math.max(a.depth,n.depth),a.italic=n.italic,e.splice(t+1,1),t--)}return e}},zNe={number:3,unit:"mu"},VNe={number:4,unit:"mu"},HNe={number:5,unit:"mu"},GNe={mord:{mop:zNe,mbin:VNe,mrel:HNe,minner:zNe},mop:{mord:zNe,mop:zNe,mrel:HNe,minner:zNe},mbin:{mord:VNe,mop:VNe,mopen:VNe,minner:VNe},mrel:{mord:HNe,mop:HNe,mopen:HNe,minner:HNe},mopen:{},mclose:{mop:zNe,mbin:VNe,mrel:HNe,minner:zNe},mpunct:{mord:zNe,mop:zNe,mrel:HNe,mopen:zNe,mclose:zNe,mpunct:zNe,minner:zNe},minner:{mord:zNe,mop:zNe,mbin:VNe,mrel:HNe,mopen:zNe,mpunct:zNe,minner:zNe}},WNe={mord:{mop:zNe},mop:{mord:zNe,mop:zNe},mbin:{},mrel:{},mopen:{},mclose:{mop:zNe},mpunct:{},minner:{mop:zNe}},qNe={},YNe={},jNe={};function XNe(e){for(var{type:t,names:a,props:n,handler:r,htmlBuilder:i,mathmlBuilder:o}=e,s={type:t,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:void 0===n.allowedInMath||n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:r},l=0;l<a.length;++l)qNe[a[l]]=s;t&&(i&&(YNe[t]=i),o&&(jNe[t]=o))}function $Ne(e){var{type:t,htmlBuilder:a,mathmlBuilder:n}=e;XNe({type:t,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:a,mathmlBuilder:n})}var KNe=function(e){return"ordgroup"===e.type&&1===e.body.length?e.body[0]:e},ZNe=function(e){return"ordgroup"===e.type?e.body:[e]},JNe=UNe.makeSpan,QNe=["leftmost","mbin","mopen","mrel","mop","mpunct"],eOe=["rightmost","mrel","mclose","mpunct"],tOe={display:cLe.DISPLAY,text:cLe.TEXT,script:cLe.SCRIPT,scriptscript:cLe.SCRIPTSCRIPT},aOe={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},nOe=function(e,t,a,n){void 0===n&&(n=[null,null]);for(var r=[],i=0;i<e.length;i++){var o=cOe(e[i],t);if(o instanceof mLe){var s=o.children;r.push(...s)}else r.push(o)}if(UNe.tryCombineChars(r),!a)return r;var l=t;if(1===e.length){var c=e[0];"sizing"===c.type?l=t.havingSize(c.size):"styling"===c.type&&(l=t.havingStyle(tOe[c.style]))}var u=JNe([n[0]||"leftmost"],[],t),d=JNe([n[1]||"rightmost"],[],t),h="root"===a;return rOe(r,(e,t)=>{var a=t.classes[0],n=e.classes[0];"mbin"===a&&eOe.includes(n)?t.classes[0]="mord":"mbin"===n&&QNe.includes(a)&&(e.classes[0]="mord")},{node:u},d,h),rOe(r,(e,t)=>{var a=sOe(t),n=sOe(e),r=a&&n?e.hasClass("mtight")?WNe[a][n]:GNe[a][n]:null;if(r)return UNe.makeGlue(r,l)},{node:u},d,h),r},rOe=function e(t,a,n,r,i){r&&t.push(r);for(var o=0;o<t.length;o++){var s=t[o],l=iOe(s);if(l)e(l.children,a,n,null,i);else{var c=!s.hasClass("mspace");if(c){var u=a(s,n.node);u&&(n.insertAfter?n.insertAfter(u):(t.unshift(u),o++))}c?n.node=s:i&&s.hasClass("newline")&&(n.node=JNe(["leftmost"])),n.insertAfter=(e=>a=>{t.splice(e+1,0,a),o++})(o)}}r&&t.pop()},iOe=function(e){return e instanceof mLe||e instanceof OLe||e instanceof NLe&&e.hasClass("enclosing")?e:null},oOe=function e(t,a){var n=iOe(t);if(n){var r=n.children;if(r.length){if("right"===a)return e(r[r.length-1],"right");if("left"===a)return e(r[0],"left")}}return t},sOe=function(e,t){return e?(t&&(e=oOe(e,t)),aOe[e.classes[0]]||null):null},lOe=function(e,t){var a=["nulldelimiter"].concat(e.baseSizingClasses());return JNe(t.concat(a))},cOe=function(e,t,a){if(!e)return JNe();if(YNe[e.type]){var n=YNe[e.type](e,t);if(a&&t.size!==a.size){n=JNe(t.sizingClasses(a),[n],t);var r=t.sizeMultiplier/a.sizeMultiplier;n.height*=r,n.depth*=r}return n}throw new YPe("Got group of unknown type: '"+e.type+"'")};function uOe(e,t){var a=JNe(["base"],e,t),n=JNe(["strut"]);return n.style.height=ELe(a.height+a.depth),a.depth&&(n.style.verticalAlign=ELe(-a.depth)),a.children.unshift(n),a}function dOe(e,t){var a=null;1===e.length&&"tag"===e[0].type&&(a=e[0].tag,e=e[0].body);var n,r=nOe(e,t,"root");2===r.length&&r[1].hasClass("tag")&&(n=r.pop());for(var i,o=[],s=[],l=0;l<r.length;l++)if(s.push(r[l]),r[l].hasClass("mbin")||r[l].hasClass("mrel")||r[l].hasClass("allowbreak")){for(var c=!1;l<r.length-1&&r[l+1].hasClass("mspace")&&!r[l+1].hasClass("newline");)l++,s.push(r[l]),r[l].hasClass("nobreak")&&(c=!0);c||(o.push(uOe(s,t)),s=[])}else r[l].hasClass("newline")&&(s.pop(),s.length>0&&(o.push(uOe(s,t)),s=[]),o.push(r[l]));s.length>0&&o.push(uOe(s,t)),a?((i=uOe(nOe(a,t,!0))).classes=["tag"],o.push(i)):n&&o.push(n);var u=JNe(["katex-html"],o);if(u.setAttribute("aria-hidden","true"),i){var d=i.children[0];d.style.height=ELe(u.height+u.depth),u.depth&&(d.style.verticalAlign=ELe(-u.depth))}return u}function hOe(e){return new mLe(e)}class pOe{constructor(e,t,a){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=t||[],this.classes=a||[]}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);this.classes.length>0&&(e.className=ILe(this.classes));for(var a=0;a<this.children.length;a++)if(this.children[a]instanceof fOe&&this.children[a+1]instanceof fOe){for(var n=this.children[a].toText()+this.children[++a].toText();this.children[a+1]instanceof fOe;)n+=this.children[++a].toText();e.appendChild(new fOe(n).toNode())}else e.appendChild(this.children[a].toNode());return e}toMarkup(){var e="<"+this.type;for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="',e+=ZPe.escape(this.attributes[t]),e+='"');this.classes.length>0&&(e+=' class ="'+ZPe.escape(ILe(this.classes))+'"'),e+=">";for(var a=0;a<this.children.length;a++)e+=this.children[a].toMarkup();return e+="</"+this.type+">"}toText(){return this.children.map(e=>e.toText()).join("")}}class fOe{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return ZPe.escape(this.toText())}toText(){return this.text}}var mOe={MathNode:pOe,TextNode:fOe,SpaceNode:class{constructor(e){this.width=void 0,this.character=void 0,this.width=e,this.character=e>=.05555&&e<=.05556?" ":e>=.1666&&e<=.1667?" ":e>=.2222&&e<=.2223?" ":e>=.2777&&e<=.2778?"  ":e>=-.05556&&e<=-.05555?" ⁣":e>=-.1667&&e<=-.1666?" ⁣":e>=-.2223&&e<=-.2222?" ⁣":e>=-.2778&&e<=-.2777?" ⁣":null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",ELe(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+ELe(this.width)+'"/>'}toText(){return this.character?this.character:" "}},newDocumentFragment:hOe},vOe=function(e,t,a){return!YLe[t][e]||!YLe[t][e].replace||55349===e.charCodeAt(0)||cNe.hasOwnProperty(e)&&a&&(a.fontFamily&&"tt"===a.fontFamily.slice(4,6)||a.font&&"tt"===a.font.slice(4,6))||(e=YLe[t][e].replace),new mOe.TextNode(e)},gOe=function(e){return 1===e.length?e[0]:new mOe.MathNode("mrow",e)},yOe=function(e,t){if("texttt"===t.fontFamily)return"monospace";if("textsf"===t.fontFamily)return"textit"===t.fontShape&&"textbf"===t.fontWeight?"sans-serif-bold-italic":"textit"===t.fontShape?"sans-serif-italic":"textbf"===t.fontWeight?"bold-sans-serif":"sans-serif";if("textit"===t.fontShape&&"textbf"===t.fontWeight)return"bold-italic";if("textit"===t.fontShape)return"italic";if("textbf"===t.fontWeight)return"bold";var a=t.font;if(!a||"mathnormal"===a)return null;var n=e.mode;if("mathit"===a)return"italic";if("boldsymbol"===a)return"textord"===e.type?"bold":"bold-italic";if("mathbf"===a)return"bold";if("mathbb"===a)return"double-struck";if("mathsfit"===a)return"sans-serif-italic";if("mathfrak"===a)return"fraktur";if("mathscr"===a||"mathcal"===a)return"script";if("mathsf"===a)return"sans-serif";if("mathtt"===a)return"monospace";var r=e.text;return["\\imath","\\jmath"].includes(r)?null:(YLe[n][r]&&YLe[n][r].replace&&(r=YLe[n][r].replace),bLe(r,UNe.fontMap[a].fontName,n)?UNe.fontMap[a].variant:null)};function bOe(e){if(!e)return!1;if("mi"===e.type&&1===e.children.length){var t=e.children[0];return t instanceof fOe&&"."===t.text}if("mo"===e.type&&1===e.children.length&&"true"===e.getAttribute("separator")&&"0em"===e.getAttribute("lspace")&&"0em"===e.getAttribute("rspace")){var a=e.children[0];return a instanceof fOe&&","===a.text}return!1}var xOe=function(e,t,a){if(1===e.length){var n=_Oe(e[0],t);return a&&n instanceof pOe&&"mo"===n.type&&(n.setAttribute("lspace","0em"),n.setAttribute("rspace","0em")),[n]}for(var r,i=[],o=0;o<e.length;o++){var s=_Oe(e[o],t);if(s instanceof pOe&&r instanceof pOe){if("mtext"===s.type&&"mtext"===r.type&&s.getAttribute("mathvariant")===r.getAttribute("mathvariant")){r.children.push(...s.children);continue}if("mn"===s.type&&"mn"===r.type){r.children.push(...s.children);continue}if(bOe(s)&&"mn"===r.type){r.children.push(...s.children);continue}if("mn"===s.type&&bOe(r))s.children=[...r.children,...s.children],i.pop();else if(("msup"===s.type||"msub"===s.type)&&s.children.length>=1&&("mn"===r.type||bOe(r))){var l=s.children[0];l instanceof pOe&&"mn"===l.type&&(l.children=[...r.children,...l.children],i.pop())}else if("mi"===r.type&&1===r.children.length){var c=r.children[0];if(c instanceof fOe&&"̸"===c.text&&("mo"===s.type||"mi"===s.type||"mn"===s.type)){var u=s.children[0];u instanceof fOe&&u.text.length>0&&(u.text=u.text.slice(0,1)+"̸"+u.text.slice(1),i.pop())}}}i.push(s),r=s}return i},wOe=function(e,t,a){return gOe(xOe(e,t,a))},_Oe=function(e,t){if(!e)return new mOe.MathNode("mrow");if(jNe[e.type])return jNe[e.type](e,t);throw new YPe("Got group of unknown type: '"+e.type+"'")};function SOe(e,t,a,n,r){var i,o=xOe(e,a);i=1===o.length&&o[0]instanceof pOe&&["mrow","mtable"].includes(o[0].type)?o[0]:new mOe.MathNode("mrow",o);var s=new mOe.MathNode("annotation",[new mOe.TextNode(t)]);s.setAttribute("encoding","application/x-tex");var l=new mOe.MathNode("semantics",[i,s]),c=new mOe.MathNode("math",[l]);c.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n&&c.setAttribute("display","block");var u=r?"katex":"katex-mathml";return UNe.makeSpan([u],[c])}var MOe=function(e){return new MLe({style:e.displayMode?cLe.DISPLAY:cLe.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},TOe=function(e,t){if(t.displayMode){var a=["katex-display"];t.leqno&&a.push("leqno"),t.fleqn&&a.push("fleqn"),e=UNe.makeSpan(a,[e])}return e},kOe={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},COe={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},AOe=function(e,t,a,n,r){var i,o=e.height+e.depth+a+n;if(/fbox|color|angl/.test(t)){if(i=UNe.makeSpan(["stretchy",t],[],r),"fbox"===t){var s=r.color&&r.getColor();s&&(i.style.borderColor=s)}}else{var l=[];/^[bx]cancel$/.test(t)&&l.push(new HLe({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(t)&&l.push(new HLe({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var c=new zLe(l,{width:"100%",height:ELe(o)});i=UNe.makeSvgSpan([],[c],r)}return i.height=o,i.style.height=ELe(o),i},EOe=function(e){var t=new mOe.MathNode("mo",[new mOe.TextNode(kOe[e.replace(/^\\/,"")])]);return t.setAttribute("stretchy","true"),t},IOe=function(e,t){var{span:a,minWidth:n,height:r}=function(){var a=4e5,n=e.label.slice(1);if(["widehat","widecheck","widetilde","utilde"].includes(n)){var r,i,o,s="ordgroup"===(p=e.base).type?p.body.length:1;if(s>5)"widehat"===n||"widecheck"===n?(r=420,a=2364,o=.42,i=n+"4"):(r=312,a=2340,o=.34,i="tilde4");else{var l=[1,1,2,2,3,3][s];"widehat"===n||"widecheck"===n?(a=[0,1062,2364,2364,2364][l],r=[0,239,300,360,420][l],o=[0,.24,.3,.3,.36,.42][l],i=n+l):(a=[0,600,1033,2339,2340][l],r=[0,260,286,306,312][l],o=[0,.26,.286,.3,.306,.34][l],i="tilde"+l)}var c=new VLe(i),u=new zLe([c],{width:"100%",height:ELe(o),viewBox:"0 0 "+a+" "+r,preserveAspectRatio:"none"});return{span:UNe.makeSvgSpan([],[u],t),minWidth:0,height:o}}var d,h,p,f=[],m=COe[n],[v,g,y]=m,b=y/1e3,x=v.length;if(1===x)d=["hide-tail"],h=[m[3]];else if(2===x)d=["halfarrow-left","halfarrow-right"],h=["xMinYMin","xMaxYMin"];else{if(3!==x)throw new Error("Correct katexImagesData or update code here to support\n                    "+x+" children.");d=["brace-left","brace-center","brace-right"],h=["xMinYMin","xMidYMin","xMaxYMin"]}for(var w=0;w<x;w++){var _=new VLe(v[w]),S=new zLe([_],{width:"400em",height:ELe(b),viewBox:"0 0 "+a+" "+y,preserveAspectRatio:h[w]+" slice"}),M=UNe.makeSvgSpan([d[w]],[S],t);if(1===x)return{span:M,minWidth:g,height:b};M.style.height=ELe(b),f.push(M)}return{span:UNe.makeSpan(["stretchy"],f,t),minWidth:g,height:b}}();return a.height=r,a.style.height=ELe(r),n>0&&(a.style.minWidth=ELe(n)),a};function ROe(e,t){if(!e||e.type!==t)throw new Error("Expected node of type "+t+", but got "+(e?"node of type "+e.type:String(e)));return e}function DOe(e){var t=POe(e);if(!t)throw new Error("Expected node of symbol group type, but got "+(e?"node of type "+e.type:String(e)));return t}function POe(e){return e&&("atom"===e.type||qLe.hasOwnProperty(e.type))?e:null}var LOe=(e,t)=>{var a,n,r;e&&"supsub"===e.type?(a=(n=ROe(e.base,"accent")).base,e.base=a,r=function(e){if(e instanceof NLe)return e;throw new Error("Expected span<HtmlDomNode> but got "+String(e)+".")}(cOe(e,t)),e.base=n):a=(n=ROe(e,"accent")).base;var i=cOe(a,t.havingCrampedStyle()),o=0;if(n.isShifty&&ZPe.isCharacterBox(a)){var s=ZPe.getBaseElem(a);o=GLe(cOe(s,t.havingCrampedStyle())).skew}var l,c="\\c"===n.label,u=c?i.height+i.depth:Math.min(i.height,t.fontMetrics().xHeight);if(n.isStretchy)l=IOe(n,t),l=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"elem",elem:l,wrapperClasses:["svg-align"],wrapperStyle:o>0?{width:"calc(100% - "+ELe(2*o)+")",marginLeft:ELe(2*o)}:void 0}]},t);else{var d,h;"\\vec"===n.label?(d=UNe.staticSvg("vec",t),h=UNe.svgData.vec[1]):((d=GLe(d=UNe.makeOrd({mode:n.mode,text:n.label},t,"textord"))).italic=0,h=d.width,c&&(u+=d.depth)),l=UNe.makeSpan(["accent-body"],[d]);var p="\\textcircled"===n.label;p&&(l.classes.push("accent-full"),u=i.height);var f=o;p||(f-=h/2),l.style.left=ELe(f),"\\textcircled"===n.label&&(l.style.top=".2em"),l=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:-u},{type:"elem",elem:l}]},t)}var m=UNe.makeSpan(["mord","accent"],[l],t);return r?(r.children[0]=m,r.height=Math.max(m.height,r.height),r.classes[0]="mord",r):m},NOe=(e,t)=>{var a=e.isStretchy?EOe(e.label):new mOe.MathNode("mo",[vOe(e.label,e.mode)]),n=new mOe.MathNode("mover",[_Oe(e.base,t),a]);return n.setAttribute("accent","true"),n},OOe=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(e=>"\\"+e).join("|"));XNe({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(e,t)=>{var a=KNe(t[0]),n=!OOe.test(e.funcName),r=!n||"\\widehat"===e.funcName||"\\widetilde"===e.funcName||"\\widecheck"===e.funcName;return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:n,isShifty:r,base:a}},htmlBuilder:LOe,mathmlBuilder:NOe}),XNe({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(e,t)=>{var a=t[0],n=e.parser.mode;return"math"===n&&(e.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+e.funcName+" works only in text mode"),n="text"),{type:"accent",mode:n,label:e.funcName,isStretchy:!1,isShifty:!0,base:a}},htmlBuilder:LOe,mathmlBuilder:NOe}),XNe({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=t[0];return{type:"accentUnder",mode:a.mode,label:n,base:r}},htmlBuilder:(e,t)=>{var a=cOe(e.base,t),n=IOe(e,t),r="\\utilde"===e.label?.12:0,i=UNe.makeVList({positionType:"top",positionData:a.height,children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:r},{type:"elem",elem:a}]},t);return UNe.makeSpan(["mord","accentunder"],[i],t)},mathmlBuilder:(e,t)=>{var a=EOe(e.label),n=new mOe.MathNode("munder",[_Oe(e.base,t),a]);return n.setAttribute("accentunder","true"),n}});var FOe=e=>{var t=new mOe.MathNode("mpadded",e?[e]:[]);return t.setAttribute("width","+0.6em"),t.setAttribute("lspace","0.3em"),t};XNe({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,a){var{parser:n,funcName:r}=e;return{type:"xArrow",mode:n.mode,label:r,body:t[0],below:a[0]}},htmlBuilder(e,t){var a,n=t.style,r=t.havingStyle(n.sup()),i=UNe.wrapFragment(cOe(e.body,r,t),t),o="\\x"===e.label.slice(0,2)?"x":"cd";i.classes.push(o+"-arrow-pad"),e.below&&(r=t.havingStyle(n.sub()),(a=UNe.wrapFragment(cOe(e.below,r,t),t)).classes.push(o+"-arrow-pad"));var s,l=IOe(e,t),c=-t.fontMetrics().axisHeight+.5*l.height,u=-t.fontMetrics().axisHeight-.5*l.height-.111;if((i.depth>.25||"\\xleftequilibrium"===e.label)&&(u-=i.depth),a){var d=-t.fontMetrics().axisHeight+a.height+.5*l.height+.111;s=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:u},{type:"elem",elem:l,shift:c},{type:"elem",elem:a,shift:d}]},t)}else s=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:u},{type:"elem",elem:l,shift:c}]},t);return s.children[0].children[0].children[1].classes.push("svg-align"),UNe.makeSpan(["mrel","x-arrow"],[s],t)},mathmlBuilder(e,t){var a,n=EOe(e.label);if(n.setAttribute("minsize","x"===e.label.charAt(0)?"1.75em":"3.0em"),e.body){var r=FOe(_Oe(e.body,t));if(e.below){var i=FOe(_Oe(e.below,t));a=new mOe.MathNode("munderover",[n,i,r])}else a=new mOe.MathNode("mover",[n,r])}else if(e.below){var o=FOe(_Oe(e.below,t));a=new mOe.MathNode("munder",[n,o])}else a=FOe(),a=new mOe.MathNode("mover",[n,a]);return a}});var BOe=UNe.makeSpan;function UOe(e,t){var a=nOe(e.body,t,!0);return BOe([e.mclass],a,t)}function zOe(e,t){var a,n=xOe(e.body,t);return"minner"===e.mclass?a=new mOe.MathNode("mpadded",n):"mord"===e.mclass?e.isCharacterBox?(a=n[0]).type="mi":a=new mOe.MathNode("mi",n):(e.isCharacterBox?(a=n[0]).type="mo":a=new mOe.MathNode("mo",n),"mbin"===e.mclass?(a.attributes.lspace="0.22em",a.attributes.rspace="0.22em"):"mpunct"===e.mclass?(a.attributes.lspace="0em",a.attributes.rspace="0.17em"):"mopen"===e.mclass||"mclose"===e.mclass?(a.attributes.lspace="0em",a.attributes.rspace="0em"):"minner"===e.mclass&&(a.attributes.lspace="0.0556em",a.attributes.width="+0.1111em")),a}XNe({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(e,t){var{parser:a,funcName:n}=e,r=t[0];return{type:"mclass",mode:a.mode,mclass:"m"+n.slice(5),body:ZNe(r),isCharacterBox:ZPe.isCharacterBox(r)}},htmlBuilder:UOe,mathmlBuilder:zOe});var VOe=e=>{var t="ordgroup"===e.type&&e.body.length?e.body[0]:e;return"atom"!==t.type||"bin"!==t.family&&"rel"!==t.family?"mord":"m"+t.family};XNe({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(e,t){var{parser:a}=e;return{type:"mclass",mode:a.mode,mclass:VOe(t[0]),body:ZNe(t[1]),isCharacterBox:ZPe.isCharacterBox(t[1])}}}),XNe({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(e,t){var a,{parser:n,funcName:r}=e,i=t[1],o=t[0];a="\\stackrel"!==r?VOe(i):"mrel";var s={type:"op",mode:i.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:"\\stackrel"!==r,body:ZNe(i)},l={type:"supsub",mode:o.mode,base:s,sup:"\\underset"===r?null:o,sub:"\\underset"===r?o:null};return{type:"mclass",mode:n.mode,mclass:a,body:[l],isCharacterBox:ZPe.isCharacterBox(l)}},htmlBuilder:UOe,mathmlBuilder:zOe}),XNe({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:a}=e;return{type:"pmb",mode:a.mode,mclass:VOe(t[0]),body:ZNe(t[0])}},htmlBuilder(e,t){var a=nOe(e.body,t,!0),n=UNe.makeSpan([e.mclass],a,t);return n.style.textShadow="0.02em 0.01em 0.04px",n},mathmlBuilder(e,t){var a=xOe(e.body,t),n=new mOe.MathNode("mstyle",a);return n.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),n}});var HOe={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},GOe=()=>({type:"styling",body:[],mode:"math",style:"display"}),WOe=e=>"textord"===e.type&&"@"===e.text,qOe=(e,t)=>("mathord"===e.type||"atom"===e.type)&&e.text===t;function YOe(e,t,a){var n=HOe[e];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return a.callFunction(n,[t[0]],[t[1]]);case"\\uparrow":case"\\downarrow":var r={type:"atom",text:n,mode:"math",family:"rel"},i={type:"ordgroup",mode:"math",body:[a.callFunction("\\\\cdleft",[t[0]],[]),a.callFunction("\\Big",[r],[]),a.callFunction("\\\\cdright",[t[1]],[])]};return a.callFunction("\\\\cdparent",[i],[]);case"\\\\cdlongequal":return a.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":return a.callFunction("\\Big",[{type:"textord",text:"\\Vert",mode:"math"}],[]);default:return{type:"textord",text:" ",mode:"math"}}}XNe({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(e,t){var{parser:a,funcName:n}=e;return{type:"cdlabel",mode:a.mode,side:n.slice(4),label:t[0]}},htmlBuilder(e,t){var a=t.havingStyle(t.style.sup()),n=UNe.wrapFragment(cOe(e.label,a,t),t);return n.classes.push("cd-label-"+e.side),n.style.bottom=ELe(.8-n.depth),n.height=0,n.depth=0,n},mathmlBuilder(e,t){var a=new mOe.MathNode("mrow",[_Oe(e.label,t)]);return(a=new mOe.MathNode("mpadded",[a])).setAttribute("width","0"),"left"===e.side&&a.setAttribute("lspace","-1width"),a.setAttribute("voffset","0.7em"),(a=new mOe.MathNode("mstyle",[a])).setAttribute("displaystyle","false"),a.setAttribute("scriptlevel","1"),a}}),XNe({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(e,t){var{parser:a}=e;return{type:"cdlabelparent",mode:a.mode,fragment:t[0]}},htmlBuilder(e,t){var a=UNe.wrapFragment(cOe(e.fragment,t),t);return a.classes.push("cd-vert-arrow"),a},mathmlBuilder:(e,t)=>new mOe.MathNode("mrow",[_Oe(e.fragment,t)])}),XNe({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(e,t){for(var{parser:a}=e,n=ROe(t[0],"ordgroup").body,r="",i=0;i<n.length;i++){r+=ROe(n[i],"textord").text}var o,s=parseInt(r);if(isNaN(s))throw new YPe("\\@char has non-numeric argument "+r);if(s<0||s>=1114111)throw new YPe("\\@char with invalid code point "+r);return s<=65535?o=String.fromCharCode(s):(s-=65536,o=String.fromCharCode(55296+(s>>10),56320+(1023&s))),{type:"textord",mode:a.mode,text:o}}});var jOe=(e,t)=>{var a=nOe(e.body,t.withColor(e.color),!1);return UNe.makeFragment(a)},XOe=(e,t)=>{var a=xOe(e.body,t.withColor(e.color)),n=new mOe.MathNode("mstyle",a);return n.setAttribute("mathcolor",e.color),n};XNe({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(e,t){var{parser:a}=e,n=ROe(t[0],"color-token").color,r=t[1];return{type:"color",mode:a.mode,color:n,body:ZNe(r)}},htmlBuilder:jOe,mathmlBuilder:XOe}),XNe({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(e,t){var{parser:a,breakOnTokenText:n}=e,r=ROe(t[0],"color-token").color;a.gullet.macros.set("\\current@color",r);var i=a.parseExpression(!0,n);return{type:"color",mode:a.mode,color:r,body:i}},htmlBuilder:jOe,mathmlBuilder:XOe}),XNe({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(e,t,a){var{parser:n}=e,r="["===n.gullet.future().text?n.parseSizeGroup(!0):null,i=!n.settings.displayMode||!n.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:n.mode,newLine:i,size:r&&ROe(r,"size").value}},htmlBuilder(e,t){var a=UNe.makeSpan(["mspace"],[],t);return e.newLine&&(a.classes.push("newline"),e.size&&(a.style.marginTop=ELe(ALe(e.size,t)))),a},mathmlBuilder(e,t){var a=new mOe.MathNode("mspace");return e.newLine&&(a.setAttribute("linebreak","newline"),e.size&&a.setAttribute("height",ELe(ALe(e.size,t)))),a}});var $Oe={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},KOe=e=>{var t=e.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(t))throw new YPe("Expected a control sequence",e);return t},ZOe=(e,t,a,n)=>{var r=e.gullet.macros.get(a.text);null==r&&(a.noexpand=!0,r={tokens:[a],numArgs:0,unexpandable:!e.gullet.isExpandable(a.text)}),e.gullet.macros.set(t,r,n)};XNe({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(e){var{parser:t,funcName:a}=e;t.consumeSpaces();var n=t.fetch();if($Oe[n.text])return"\\global"!==a&&"\\\\globallong"!==a||(n.text=$Oe[n.text]),ROe(t.parseFunction(),"internal");throw new YPe("Invalid token after macro prefix",n)}}),XNe({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:a}=e,n=t.gullet.popToken(),r=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(r))throw new YPe("Expected a control sequence",n);for(var i,o=0,s=[[]];"{"!==t.gullet.future().text;)if("#"===(n=t.gullet.popToken()).text){if("{"===t.gullet.future().text){i=t.gullet.future(),s[o].push("{");break}if(n=t.gullet.popToken(),!/^[1-9]$/.test(n.text))throw new YPe('Invalid argument number "'+n.text+'"');if(parseInt(n.text)!==o+1)throw new YPe('Argument number "'+n.text+'" out of order');o++,s.push([])}else{if("EOF"===n.text)throw new YPe("Expected a macro definition");s[o].push(n.text)}var{tokens:l}=t.gullet.consumeArg();return i&&l.unshift(i),"\\edef"!==a&&"\\xdef"!==a||(l=t.gullet.expandTokens(l)).reverse(),t.gullet.macros.set(r,{tokens:l,numArgs:o,delimiters:s},a===$Oe[a]),{type:"internal",mode:t.mode}}}),XNe({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:a}=e,n=KOe(t.gullet.popToken());t.gullet.consumeSpaces();var r=(e=>{var t=e.gullet.popToken();return"="===t.text&&" "===(t=e.gullet.popToken()).text&&(t=e.gullet.popToken()),t})(t);return ZOe(t,n,r,"\\\\globallet"===a),{type:"internal",mode:t.mode}}}),XNe({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:a}=e,n=KOe(t.gullet.popToken()),r=t.gullet.popToken(),i=t.gullet.popToken();return ZOe(t,n,i,"\\\\globalfuture"===a),t.gullet.pushToken(i),t.gullet.pushToken(r),{type:"internal",mode:t.mode}}});var JOe=function(e,t,a){var n=bLe(YLe.math[e]&&YLe.math[e].replace||e,t,a);if(!n)throw new Error("Unsupported symbol "+e+" and font size "+t+".");return n},QOe=function(e,t,a,n){var r=a.havingBaseStyle(t),i=UNe.makeSpan(n.concat(r.sizingClasses(a)),[e],a),o=r.sizeMultiplier/a.sizeMultiplier;return i.height*=o,i.depth*=o,i.maxFontSize=r.sizeMultiplier,i},eFe=function(e,t,a){var n=t.havingBaseStyle(a),r=(1-t.sizeMultiplier/n.sizeMultiplier)*t.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=ELe(r),e.height-=r,e.depth+=r},tFe=function(e,t,a,n,r,i){var o=function(e,t,a,n){return UNe.makeSymbol(e,"Size"+t+"-Regular",a,n)}(e,t,r,n),s=QOe(UNe.makeSpan(["delimsizing","size"+t],[o],n),cLe.TEXT,n,i);return a&&eFe(s,n,cLe.TEXT),s},aFe=function(e,t,a){var n;return n="Size1-Regular"===t?"delim-size1":"delim-size4",{type:"elem",elem:UNe.makeSpan(["delimsizinginner",n],[UNe.makeSpan([],[UNe.makeSymbol(e,t,a)])])}},nFe=function(e,t,a){var n=vLe["Size4-Regular"][e.charCodeAt(0)]?vLe["Size4-Regular"][e.charCodeAt(0)][4]:vLe["Size1-Regular"][e.charCodeAt(0)][4],r=new VLe("inner",function(e,t){switch(e){case"⎜":return"M291 0 H417 V"+t+" H291z M291 0 H417 V"+t+" H291z";case"∣":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z";case"∥":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145zM367 0 H410 V"+t+" H367z M367 0 H410 V"+t+" H367z";case"⎟":return"M457 0 H583 V"+t+" H457z M457 0 H583 V"+t+" H457z";case"⎢":return"M319 0 H403 V"+t+" H319z M319 0 H403 V"+t+" H319z";case"⎥":return"M263 0 H347 V"+t+" H263z M263 0 H347 V"+t+" H263z";case"⎪":return"M384 0 H504 V"+t+" H384z M384 0 H504 V"+t+" H384z";case"⏐":return"M312 0 H355 V"+t+" H312z M312 0 H355 V"+t+" H312z";case"‖":return"M257 0 H300 V"+t+" H257z M257 0 H300 V"+t+" H257zM478 0 H521 V"+t+" H478z M478 0 H521 V"+t+" H478z";default:return""}}(e,Math.round(1e3*t))),i=new zLe([r],{width:ELe(n),height:ELe(t),style:"width:"+ELe(n),viewBox:"0 0 "+1e3*n+" "+Math.round(1e3*t),preserveAspectRatio:"xMinYMin"}),o=UNe.makeSvgSpan([],[i],a);return o.height=t,o.style.height=ELe(t),o.style.width=ELe(n),{type:"elem",elem:o}},rFe={type:"kern",size:-.008},iFe=["|","\\lvert","\\rvert","\\vert"],oFe=["\\|","\\lVert","\\rVert","\\Vert"],sFe=function(e,t,a,n,r,i){var o,s,l,c,u="",d=0;o=l=c=e,s=null;var h="Size1-Regular";"\\uparrow"===e?l=c="⏐":"\\Uparrow"===e?l=c="‖":"\\downarrow"===e?o=l="⏐":"\\Downarrow"===e?o=l="‖":"\\updownarrow"===e?(o="\\uparrow",l="⏐",c="\\downarrow"):"\\Updownarrow"===e?(o="\\Uparrow",l="‖",c="\\Downarrow"):iFe.includes(e)?(l="∣",u="vert",d=333):oFe.includes(e)?(l="∥",u="doublevert",d=556):"["===e||"\\lbrack"===e?(o="⎡",l="⎢",c="⎣",h="Size4-Regular",u="lbrack",d=667):"]"===e||"\\rbrack"===e?(o="⎤",l="⎥",c="⎦",h="Size4-Regular",u="rbrack",d=667):"\\lfloor"===e||"⌊"===e?(l=o="⎢",c="⎣",h="Size4-Regular",u="lfloor",d=667):"\\lceil"===e||"⌈"===e?(o="⎡",l=c="⎢",h="Size4-Regular",u="lceil",d=667):"\\rfloor"===e||"⌋"===e?(l=o="⎥",c="⎦",h="Size4-Regular",u="rfloor",d=667):"\\rceil"===e||"⌉"===e?(o="⎤",l=c="⎥",h="Size4-Regular",u="rceil",d=667):"("===e||"\\lparen"===e?(o="⎛",l="⎜",c="⎝",h="Size4-Regular",u="lparen",d=875):")"===e||"\\rparen"===e?(o="⎞",l="⎟",c="⎠",h="Size4-Regular",u="rparen",d=875):"\\{"===e||"\\lbrace"===e?(o="⎧",s="⎨",c="⎩",l="⎪",h="Size4-Regular"):"\\}"===e||"\\rbrace"===e?(o="⎫",s="⎬",c="⎭",l="⎪",h="Size4-Regular"):"\\lgroup"===e||"⟮"===e?(o="⎧",c="⎩",l="⎪",h="Size4-Regular"):"\\rgroup"===e||"⟯"===e?(o="⎫",c="⎭",l="⎪",h="Size4-Regular"):"\\lmoustache"===e||"⎰"===e?(o="⎧",c="⎭",l="⎪",h="Size4-Regular"):"\\rmoustache"!==e&&"⎱"!==e||(o="⎫",c="⎩",l="⎪",h="Size4-Regular");var p=JOe(o,h,r),f=p.height+p.depth,m=JOe(l,h,r),v=m.height+m.depth,g=JOe(c,h,r),y=g.height+g.depth,b=0,x=1;if(null!==s){var w=JOe(s,h,r);b=w.height+w.depth,x=2}var _=f+y+b,S=_+Math.max(0,Math.ceil((t-_)/(x*v)))*x*v,M=n.fontMetrics().axisHeight;a&&(M*=n.sizeMultiplier);var T=S/2-M,k=[];if(u.length>0){var C=S-f-y,A=Math.round(1e3*S),E=function(e,t){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+" v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v"+t+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+" v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v"+t+" v1759 h84z";case"vert":return"M145 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+t+" v585 h43z";case"doublevert":return"M145 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v"+t+" v585 h43z\nM367 15 v585 v"+t+" v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v"+-t+" v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v"+t+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+t+" v1715 h263 v84 H319z\nMM319 602 V0 H403 V602 v"+t+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+t+" v1799 H0 v-84 H319z\nMM319 602 V0 H403 V602 v"+t+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+" v602 h84z\nM403 1759 V0 H319 V1759 v"+t+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+" v602 h84z\nM347 1759 V0 h-84 V1759 v"+t+" v602 h84z";case"lparen":return"M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\n-36,557 l0,"+(t+84)+"c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\nl0,-"+(t+92)+"c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z";case"rparen":return"M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,"+(t+9)+"\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\nl0,-"+(t+144)+"c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z";default:throw new Error("Unknown stretchy delimiter.")}}(u,Math.round(1e3*C)),I=new VLe(u,E),R=(d/1e3).toFixed(3)+"em",D=(A/1e3).toFixed(3)+"em",P=new zLe([I],{width:R,height:D,viewBox:"0 0 "+d+" "+A}),L=UNe.makeSvgSpan([],[P],n);L.height=A/1e3,L.style.width=R,L.style.height=D,k.push({type:"elem",elem:L})}else{if(k.push(aFe(c,h,r)),k.push(rFe),null===s){var N=S-f-y+.016;k.push(nFe(l,N,n))}else{var O=(S-f-y-b)/2+.016;k.push(nFe(l,O,n)),k.push(rFe),k.push(aFe(s,h,r)),k.push(rFe),k.push(nFe(l,O,n))}k.push(rFe),k.push(aFe(o,h,r))}var F=n.havingBaseStyle(cLe.TEXT),B=UNe.makeVList({positionType:"bottom",positionData:T,children:k},F);return QOe(UNe.makeSpan(["delimsizing","mult"],[B],F),cLe.TEXT,n,i)},lFe=.08,cFe=function(e,t,a,n,r){var i=function(e,t,a){t*=1e3;var n="";switch(e){case"sqrtMain":n=function(e,t){return"M95,"+(622+e+t)+"\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl"+e/2.075+" -"+e+"\nc5.3,-9.3,12,-14,20,-14\nH400000v"+(40+e)+"H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM"+(834+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,pLe);break;case"sqrtSize1":n=function(e,t){return"M263,"+(601+e+t)+"c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl"+e/2.084+" -"+e+"\nc4.7,-7.3,11,-11,19,-11\nH40000v"+(40+e)+"H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM"+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,pLe);break;case"sqrtSize2":n=function(e,t){return"M983 "+(10+e+t)+"\nl"+e/3.13+" -"+e+"\nc4,-6.7,10,-10,18,-10 H400000v"+(40+e)+"\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM"+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"}(t,pLe);break;case"sqrtSize3":n=function(e,t){return"M424,"+(2398+e+t)+"\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl"+e/4.223+" -"+e+"c4,-6.7,10,-10,18,-10 H400000\nv"+(40+e)+"H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M"+(1001+e)+" "+t+"\nh400000v"+(40+e)+"h-400000z"}(t,pLe);break;case"sqrtSize4":n=function(e,t){return"M473,"+(2713+e+t)+"\nc339.3,-1799.3,509.3,-2700,510,-2702 l"+e/5.298+" -"+e+"\nc3.3,-7.3,9.3,-11,18,-11 H400000v"+(40+e)+"H1017.7\ns-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200\nc0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26\ns76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,\n606zM"+(1001+e)+" "+t+"h400000v"+(40+e)+"H1017.7z"}(t,pLe);break;case"sqrtTall":n=function(e,t,a){return"M702 "+(e+t)+"H400000"+(40+e)+"\nH742v"+(a-54-t-e)+"l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 "+t+"H400000v"+(40+e)+"H742z"}(t,pLe,a)}return n}(e,n,a),o=new VLe(e,i),s=new zLe([o],{width:"400em",height:ELe(t),viewBox:"0 0 400000 "+a,preserveAspectRatio:"xMinYMin slice"});return UNe.makeSvgSpan(["hide-tail"],[s],r)},uFe=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],dFe=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],hFe=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],pFe=[0,1.2,1.8,2.4,3],fFe=[{type:"small",style:cLe.SCRIPTSCRIPT},{type:"small",style:cLe.SCRIPT},{type:"small",style:cLe.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],mFe=[{type:"small",style:cLe.SCRIPTSCRIPT},{type:"small",style:cLe.SCRIPT},{type:"small",style:cLe.TEXT},{type:"stack"}],vFe=[{type:"small",style:cLe.SCRIPTSCRIPT},{type:"small",style:cLe.SCRIPT},{type:"small",style:cLe.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],gFe=function(e){if("small"===e.type)return"Main-Regular";if("large"===e.type)return"Size"+e.size+"-Regular";if("stack"===e.type)return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},yFe=function(e,t,a,n){for(var r=Math.min(2,3-n.style.size);r<a.length&&"stack"!==a[r].type;r++){var i=JOe(e,gFe(a[r]),"math"),o=i.height+i.depth;if("small"===a[r].type&&(o*=n.havingBaseStyle(a[r].style).sizeMultiplier),o>t)return a[r]}return a[a.length-1]},bFe=function(e,t,a,n,r,i){var o;"<"===e||"\\lt"===e||"⟨"===e?e="\\langle":">"!==e&&"\\gt"!==e&&"⟩"!==e||(e="\\rangle"),o=hFe.includes(e)?fFe:uFe.includes(e)?vFe:mFe;var s=yFe(e,t,o,n);return"small"===s.type?function(e,t,a,n,r,i){var o=UNe.makeSymbol(e,"Main-Regular",r,n),s=QOe(o,t,n,i);return a&&eFe(s,n,t),s}(e,s.style,a,n,r,i):"large"===s.type?tFe(e,s.size,a,n,r,i):sFe(e,t,a,n,r,i)},xFe={sqrtImage:function(e,t){var a,n,r=t.havingBaseSizing(),i=yFe("\\surd",e*r.sizeMultiplier,vFe,r),o=r.sizeMultiplier,s=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness),l=0,c=0,u=0;return"small"===i.type?(e<1?o=1:e<1.4&&(o=.7),c=(1+s)/o,(a=cFe("sqrtMain",l=(1+s+lFe)/o,u=1e3+1e3*s+80,s,t)).style.minWidth="0.853em",n=.833/o):"large"===i.type?(u=1080*pFe[i.size],c=(pFe[i.size]+s)/o,l=(pFe[i.size]+s+lFe)/o,(a=cFe("sqrtSize"+i.size,l,u,s,t)).style.minWidth="1.02em",n=1/o):(l=e+s+lFe,c=e+s,u=Math.floor(1e3*e+s)+80,(a=cFe("sqrtTall",l,u,s,t)).style.minWidth="0.742em",n=1.056),a.height=c,a.style.height=ELe(l),{span:a,advanceWidth:n,ruleWidth:(t.fontMetrics().sqrtRuleThickness+s)*o}},sizedDelim:function(e,t,a,n,r){if("<"===e||"\\lt"===e||"⟨"===e?e="\\langle":">"!==e&&"\\gt"!==e&&"⟩"!==e||(e="\\rangle"),uFe.includes(e)||hFe.includes(e))return tFe(e,t,!1,a,n,r);if(dFe.includes(e))return sFe(e,pFe[t],!1,a,n,r);throw new YPe("Illegal delimiter: '"+e+"'")},sizeToMaxHeight:pFe,customSizedDelim:bFe,leftRightDelim:function(e,t,a,n,r,i){var o=n.fontMetrics().axisHeight*n.sizeMultiplier,s=5/n.fontMetrics().ptPerEm,l=Math.max(t-o,a+o),c=Math.max(l/500*901,2*l-s);return bFe(e,c,!0,n,r,i)}},wFe={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},_Fe=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function SFe(e,t){var a=POe(e);if(a&&_Fe.includes(a.text))return a;throw new YPe(a?"Invalid delimiter '"+a.text+"' after '"+t.funcName+"'":"Invalid delimiter type '"+e.type+"'",e)}function MFe(e){if(!e.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}XNe({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{var a=SFe(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:wFe[e.funcName].size,mclass:wFe[e.funcName].mclass,delim:a.text}},htmlBuilder:(e,t)=>"."===e.delim?UNe.makeSpan([e.mclass]):xFe.sizedDelim(e.delim,e.size,t,e.mode,[e.mclass]),mathmlBuilder:e=>{var t=[];"."!==e.delim&&t.push(vOe(e.delim,e.mode));var a=new mOe.MathNode("mo",t);"mopen"===e.mclass||"mclose"===e.mclass?a.setAttribute("fence","true"):a.setAttribute("fence","false"),a.setAttribute("stretchy","true");var n=ELe(xFe.sizeToMaxHeight[e.size]);return a.setAttribute("minsize",n),a.setAttribute("maxsize",n),a}}),XNe({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var a=e.parser.gullet.macros.get("\\current@color");if(a&&"string"!=typeof a)throw new YPe("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:e.parser.mode,delim:SFe(t[0],e).text,color:a}}}),XNe({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var a=SFe(t[0],e),n=e.parser;++n.leftrightDepth;var r=n.parseExpression(!1);--n.leftrightDepth,n.expect("\\right",!1);var i=ROe(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:r,left:a.text,right:i.delim,rightColor:i.color}},htmlBuilder:(e,t)=>{MFe(e);for(var a,n,r=nOe(e.body,t,!0,["mopen","mclose"]),i=0,o=0,s=!1,l=0;l<r.length;l++)r[l].isMiddle?s=!0:(i=Math.max(r[l].height,i),o=Math.max(r[l].depth,o));if(i*=t.sizeMultiplier,o*=t.sizeMultiplier,a="."===e.left?lOe(t,["mopen"]):xFe.leftRightDelim(e.left,i,o,t,e.mode,["mopen"]),r.unshift(a),s)for(var c=1;c<r.length;c++){var u=r[c].isMiddle;u&&(r[c]=xFe.leftRightDelim(u.delim,i,o,u.options,e.mode,[]))}if("."===e.right)n=lOe(t,["mclose"]);else{var d=e.rightColor?t.withColor(e.rightColor):t;n=xFe.leftRightDelim(e.right,i,o,d,e.mode,["mclose"])}return r.push(n),UNe.makeSpan(["minner"],r,t)},mathmlBuilder:(e,t)=>{MFe(e);var a=xOe(e.body,t);if("."!==e.left){var n=new mOe.MathNode("mo",[vOe(e.left,e.mode)]);n.setAttribute("fence","true"),a.unshift(n)}if("."!==e.right){var r=new mOe.MathNode("mo",[vOe(e.right,e.mode)]);r.setAttribute("fence","true"),e.rightColor&&r.setAttribute("mathcolor",e.rightColor),a.push(r)}return gOe(a)}}),XNe({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var a=SFe(t[0],e);if(!e.parser.leftrightDepth)throw new YPe("\\middle without preceding \\left",a);return{type:"middle",mode:e.parser.mode,delim:a.text}},htmlBuilder:(e,t)=>{var a;if("."===e.delim)a=lOe(t,[]);else{a=xFe.sizedDelim(e.delim,1,t,e.mode,[]);var n={delim:e.delim,options:t};a.isMiddle=n}return a},mathmlBuilder:(e,t)=>{var a="\\vert"===e.delim||"|"===e.delim?vOe("|","text"):vOe(e.delim,e.mode),n=new mOe.MathNode("mo",[a]);return n.setAttribute("fence","true"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});var TFe=(e,t)=>{var a,n,r,i=UNe.wrapFragment(cOe(e.body,t),t),o=e.label.slice(1),s=t.sizeMultiplier,l=0,c=ZPe.isCharacterBox(e.body);if("sout"===o)(a=UNe.makeSpan(["stretchy","sout"])).height=t.fontMetrics().defaultRuleThickness/s,l=-.5*t.fontMetrics().xHeight;else if("phase"===o){var u=ALe({number:.6,unit:"pt"},t),d=ALe({number:.35,unit:"ex"},t);s/=t.havingBaseSizing().sizeMultiplier;var h=i.height+i.depth+u+d;i.style.paddingLeft=ELe(h/2+u);var p=Math.floor(1e3*h*s),f="M400000 "+(n=p)+" H0 L"+n/2+" 0 l65 45 L145 "+(n-80)+" H400000z",m=new zLe([new VLe("phase",f)],{width:"400em",height:ELe(p/1e3),viewBox:"0 0 400000 "+p,preserveAspectRatio:"xMinYMin slice"});(a=UNe.makeSvgSpan(["hide-tail"],[m],t)).style.height=ELe(h),l=i.depth+u+d}else{/cancel/.test(o)?c||i.classes.push("cancel-pad"):"angl"===o?i.classes.push("anglpad"):i.classes.push("boxpad");var v=0,g=0,y=0;/box/.test(o)?(y=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness),g=v=t.fontMetrics().fboxsep+("colorbox"===o?0:y)):"angl"===o?(v=4*(y=Math.max(t.fontMetrics().defaultRuleThickness,t.minRuleThickness)),g=Math.max(0,.25-i.depth)):g=v=c?.2:0,a=AOe(i,o,v,g,t),/fbox|boxed|fcolorbox/.test(o)?(a.style.borderStyle="solid",a.style.borderWidth=ELe(y)):"angl"===o&&.049!==y&&(a.style.borderTopWidth=ELe(y),a.style.borderRightWidth=ELe(y)),l=i.depth+g,e.backgroundColor&&(a.style.backgroundColor=e.backgroundColor,e.borderColor&&(a.style.borderColor=e.borderColor))}if(e.backgroundColor)r=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:a,shift:l},{type:"elem",elem:i,shift:0}]},t);else{var b=/cancel|phase/.test(o)?["svg-align"]:[];r=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:0},{type:"elem",elem:a,shift:l,wrapperClasses:b}]},t)}return/cancel/.test(o)&&(r.height=i.height,r.depth=i.depth),/cancel/.test(o)&&!c?UNe.makeSpan(["mord","cancel-lap"],[r],t):UNe.makeSpan(["mord"],[r],t)},kFe=(e,t)=>{var a=0,n=new mOe.MathNode(e.label.indexOf("colorbox")>-1?"mpadded":"menclose",[_Oe(e.body,t)]);switch(e.label){case"\\cancel":n.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":n.setAttribute("notation","downdiagonalstrike");break;case"\\phase":n.setAttribute("notation","phasorangle");break;case"\\sout":n.setAttribute("notation","horizontalstrike");break;case"\\fbox":n.setAttribute("notation","box");break;case"\\angl":n.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(a=t.fontMetrics().fboxsep*t.fontMetrics().ptPerEm,n.setAttribute("width","+"+2*a+"pt"),n.setAttribute("height","+"+2*a+"pt"),n.setAttribute("lspace",a+"pt"),n.setAttribute("voffset",a+"pt"),"\\fcolorbox"===e.label){var r=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness);n.setAttribute("style","border: "+r+"em solid "+String(e.borderColor))}break;case"\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike")}return e.backgroundColor&&n.setAttribute("mathbackground",e.backgroundColor),n};XNe({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(e,t,a){var{parser:n,funcName:r}=e,i=ROe(t[0],"color-token").color,o=t[1];return{type:"enclose",mode:n.mode,label:r,backgroundColor:i,body:o}},htmlBuilder:TFe,mathmlBuilder:kFe}),XNe({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(e,t,a){var{parser:n,funcName:r}=e,i=ROe(t[0],"color-token").color,o=ROe(t[1],"color-token").color,s=t[2];return{type:"enclose",mode:n.mode,label:r,backgroundColor:o,borderColor:i,body:s}},htmlBuilder:TFe,mathmlBuilder:kFe}),XNe({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(e,t){var{parser:a}=e;return{type:"enclose",mode:a.mode,label:"\\fbox",body:t[0]}}}),XNe({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(e,t){var{parser:a,funcName:n}=e,r=t[0];return{type:"enclose",mode:a.mode,label:n,body:r}},htmlBuilder:TFe,mathmlBuilder:kFe}),XNe({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(e,t){var{parser:a}=e;return{type:"enclose",mode:a.mode,label:"\\angl",body:t[0]}}});var CFe={};function AFe(e){for(var{type:t,names:a,props:n,handler:r,htmlBuilder:i,mathmlBuilder:o}=e,s={type:t,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:r},l=0;l<a.length;++l)CFe[a[l]]=s;i&&(YNe[t]=i),o&&(jNe[t]=o)}var EFe={};function IFe(e,t){EFe[e]=t}function RFe(e){var t=[];e.consumeSpaces();var a=e.fetch().text;for("\\relax"===a&&(e.consume(),e.consumeSpaces(),a=e.fetch().text);"\\hline"===a||"\\hdashline"===a;)e.consume(),t.push("\\hdashline"===a),e.consumeSpaces(),a=e.fetch().text;return t}var DFe=e=>{if(!e.parser.settings.displayMode)throw new YPe("{"+e.envName+"} can be used only in display mode.")};function PFe(e){if(-1===e.indexOf("ed"))return-1===e.indexOf("*")}function LFe(e,t,a){var{hskipBeforeAndAfter:n,addJot:r,cols:i,arraystretch:o,colSeparationType:s,autoTag:l,singleRow:c,emptySingleRow:u,maxNumCols:d,leqno:h}=t;if(e.gullet.beginGroup(),c||e.gullet.macros.set("\\cr","\\\\\\relax"),!o){var p=e.gullet.expandMacroAsText("\\arraystretch");if(null==p)o=1;else if(!(o=parseFloat(p))||o<0)throw new YPe("Invalid \\arraystretch: "+p)}e.gullet.beginGroup();var f=[],m=[f],v=[],g=[],y=null!=l?[]:void 0;function b(){l&&e.gullet.macros.set("\\@eqnsw","1",!0)}function x(){y&&(e.gullet.macros.get("\\df@tag")?(y.push(e.subparse([new qPe("\\df@tag")])),e.gullet.macros.set("\\df@tag",void 0,!0)):y.push(Boolean(l)&&"1"===e.gullet.macros.get("\\@eqnsw")))}for(b(),g.push(RFe(e));;){var w=e.parseExpression(!1,c?"\\end":"\\\\");e.gullet.endGroup(),e.gullet.beginGroup(),w={type:"ordgroup",mode:e.mode,body:w},a&&(w={type:"styling",mode:e.mode,style:a,body:[w]}),f.push(w);var _=e.fetch().text;if("&"===_){if(d&&f.length===d){if(c||s)throw new YPe("Too many tab characters: &",e.nextToken);e.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}e.consume()}else{if("\\end"===_){x(),1===f.length&&"styling"===w.type&&0===w.body[0].body.length&&(m.length>1||!u)&&m.pop(),g.length<m.length+1&&g.push([]);break}if("\\\\"!==_)throw new YPe("Expected & or \\\\ or \\cr or \\end",e.nextToken);e.consume();var S=void 0;" "!==e.gullet.future().text&&(S=e.parseSizeGroup(!0)),v.push(S?S.value:null),x(),g.push(RFe(e)),f=[],m.push(f),b()}}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:e.mode,addJot:r,arraystretch:o,body:m,cols:i,rowGaps:v,hskipBeforeAndAfter:n,hLinesBeforeRow:g,colSeparationType:s,tags:y,leqno:h}}function NFe(e){return"d"===e.slice(0,1)?"display":"text"}var OFe=function(e,t){var a,n,r=e.body.length,i=e.hLinesBeforeRow,o=0,s=new Array(r),l=[],c=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),u=1/t.fontMetrics().ptPerEm,d=5*u;e.colSeparationType&&"small"===e.colSeparationType&&(d=t.havingStyle(cLe.SCRIPT).sizeMultiplier/t.sizeMultiplier*.2778);var h="CD"===e.colSeparationType?ALe({number:3,unit:"ex"},t):12*u,p=3*u,f=e.arraystretch*h,m=.7*f,v=.3*f,g=0;function y(e){for(var t=0;t<e.length;++t)t>0&&(g+=.25),l.push({pos:g,isDashed:e[t]})}for(y(i[0]),a=0;a<e.body.length;++a){var b=e.body[a],x=m,w=v;o<b.length&&(o=b.length);var _=new Array(b.length);for(n=0;n<b.length;++n){var S=cOe(b[n],t);w<S.depth&&(w=S.depth),x<S.height&&(x=S.height),_[n]=S}var M=e.rowGaps[a],T=0;M&&(T=ALe(M,t))>0&&(w<(T+=v)&&(w=T),T=0),e.addJot&&(w+=p),_.height=x,_.depth=w,g+=x,_.pos=g,g+=w+T,s[a]=_,y(i[a+1])}var k,C,A=g/2+t.fontMetrics().axisHeight,E=e.cols||[],I=[],R=[];if(e.tags&&e.tags.some(e=>e))for(a=0;a<r;++a){var D=s[a],P=D.pos-A,L=e.tags[a],N=void 0;(N=!0===L?UNe.makeSpan(["eqn-num"],[],t):!1===L?UNe.makeSpan([],[],t):UNe.makeSpan([],nOe(L,t,!0),t)).depth=D.depth,N.height=D.height,R.push({type:"elem",elem:N,shift:P})}for(n=0,C=0;n<o||C<E.length;++n,++C){for(var O=E[C]||{},F=!0;"separator"===O.type;){if(F||((k=UNe.makeSpan(["arraycolsep"],[])).style.width=ELe(t.fontMetrics().doubleRuleSep),I.push(k)),"|"!==O.separator&&":"!==O.separator)throw new YPe("Invalid separator type: "+O.separator);var B="|"===O.separator?"solid":"dashed",U=UNe.makeSpan(["vertical-separator"],[],t);U.style.height=ELe(g),U.style.borderRightWidth=ELe(c),U.style.borderRightStyle=B,U.style.margin="0 "+ELe(-c/2);var z=g-A;z&&(U.style.verticalAlign=ELe(-z)),I.push(U),O=E[++C]||{},F=!1}if(!(n>=o)){var V=void 0;(n>0||e.hskipBeforeAndAfter)&&0!==(V=ZPe.deflt(O.pregap,d))&&((k=UNe.makeSpan(["arraycolsep"],[])).style.width=ELe(V),I.push(k));var H=[];for(a=0;a<r;++a){var G=s[a],W=G[n];if(W){var q=G.pos-A;W.depth=G.depth,W.height=G.height,H.push({type:"elem",elem:W,shift:q})}}H=UNe.makeVList({positionType:"individualShift",children:H},t),H=UNe.makeSpan(["col-align-"+(O.align||"c")],[H]),I.push(H),(n<o-1||e.hskipBeforeAndAfter)&&0!==(V=ZPe.deflt(O.postgap,d))&&((k=UNe.makeSpan(["arraycolsep"],[])).style.width=ELe(V),I.push(k))}}if(s=UNe.makeSpan(["mtable"],I),l.length>0){for(var Y=UNe.makeLineSpan("hline",t,c),j=UNe.makeLineSpan("hdashline",t,c),X=[{type:"elem",elem:s,shift:0}];l.length>0;){var $=l.pop(),K=$.pos-A;$.isDashed?X.push({type:"elem",elem:j,shift:K}):X.push({type:"elem",elem:Y,shift:K})}s=UNe.makeVList({positionType:"individualShift",children:X},t)}if(0===R.length)return UNe.makeSpan(["mord"],[s],t);var Z=UNe.makeVList({positionType:"individualShift",children:R},t);return Z=UNe.makeSpan(["tag"],[Z],t),UNe.makeFragment([s,Z])},FFe={c:"center ",l:"left ",r:"right "},BFe=function(e,t){for(var a=[],n=new mOe.MathNode("mtd",[],["mtr-glue"]),r=new mOe.MathNode("mtd",[],["mml-eqn-num"]),i=0;i<e.body.length;i++){for(var o=e.body[i],s=[],l=0;l<o.length;l++)s.push(new mOe.MathNode("mtd",[_Oe(o[l],t)]));e.tags&&e.tags[i]&&(s.unshift(n),s.push(n),e.leqno?s.unshift(r):s.push(r)),a.push(new mOe.MathNode("mtr",s))}var c=new mOe.MathNode("mtable",a),u=.5===e.arraystretch?.1:.16+e.arraystretch-1+(e.addJot?.09:0);c.setAttribute("rowspacing",ELe(u));var d="",h="";if(e.cols&&e.cols.length>0){var p=e.cols,f="",m=!1,v=0,g=p.length;"separator"===p[0].type&&(d+="top ",v=1),"separator"===p[p.length-1].type&&(d+="bottom ",g-=1);for(var y=v;y<g;y++)"align"===p[y].type?(h+=FFe[p[y].align],m&&(f+="none "),m=!0):"separator"===p[y].type&&m&&(f+="|"===p[y].separator?"solid ":"dashed ",m=!1);c.setAttribute("columnalign",h.trim()),/[sd]/.test(f)&&c.setAttribute("columnlines",f.trim())}if("align"===e.colSeparationType){for(var b=e.cols||[],x="",w=1;w<b.length;w++)x+=w%2?"0em ":"1em ";c.setAttribute("columnspacing",x.trim())}else"alignat"===e.colSeparationType||"gather"===e.colSeparationType?c.setAttribute("columnspacing","0em"):"small"===e.colSeparationType?c.setAttribute("columnspacing","0.2778em"):"CD"===e.colSeparationType?c.setAttribute("columnspacing","0.5em"):c.setAttribute("columnspacing","1em");var _="",S=e.hLinesBeforeRow;d+=S[0].length>0?"left ":"",d+=S[S.length-1].length>0?"right ":"";for(var M=1;M<S.length-1;M++)_+=0===S[M].length?"none ":S[M][0]?"dashed ":"solid ";return/[sd]/.test(_)&&c.setAttribute("rowlines",_.trim()),""!==d&&(c=new mOe.MathNode("menclose",[c])).setAttribute("notation",d.trim()),e.arraystretch&&e.arraystretch<1&&(c=new mOe.MathNode("mstyle",[c])).setAttribute("scriptlevel","1"),c},UFe=function(e,t){-1===e.envName.indexOf("ed")&&DFe(e);var a,n=[],r=e.envName.indexOf("at")>-1?"alignat":"align",i="split"===e.envName,o=LFe(e.parser,{cols:n,addJot:!0,autoTag:i?void 0:PFe(e.envName),emptySingleRow:!0,colSeparationType:r,maxNumCols:i?2:void 0,leqno:e.parser.settings.leqno},"display"),s=0,l={type:"ordgroup",mode:e.mode,body:[]};if(t[0]&&"ordgroup"===t[0].type){for(var c="",u=0;u<t[0].body.length;u++){c+=ROe(t[0].body[u],"textord").text}a=Number(c),s=2*a}var d=!s;o.body.forEach(function(e){for(var t=1;t<e.length;t+=2){var n=ROe(e[t],"styling");ROe(n.body[0],"ordgroup").body.unshift(l)}if(d)s<e.length&&(s=e.length);else{var r=e.length/2;if(a<r)throw new YPe("Too many math in a row: expected "+a+", but got "+r,e[0])}});for(var h=0;h<s;++h){var p="r",f=0;h%2==1?p="l":h>0&&d&&(f=1),n[h]={type:"align",align:p,pregap:f,postgap:0}}return o.colSeparationType=d?"align":"alignat",o};AFe({type:"array",names:["array","darray"],props:{numArgs:1},handler(e,t){var a=(POe(t[0])?[t[0]]:ROe(t[0],"ordgroup").body).map(function(e){var t=DOe(e).text;if(-1!=="lcr".indexOf(t))return{type:"align",align:t};if("|"===t)return{type:"separator",separator:"|"};if(":"===t)return{type:"separator",separator:":"};throw new YPe("Unknown column alignment: "+t,e)}),n={cols:a,hskipBeforeAndAfter:!0,maxNumCols:a.length};return LFe(e.parser,n,NFe(e.envName))},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(e){var t={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[e.envName.replace("*","")],a="c",n={hskipBeforeAndAfter:!1,cols:[{type:"align",align:a}]};if("*"===e.envName.charAt(e.envName.length-1)){var r=e.parser;if(r.consumeSpaces(),"["===r.fetch().text){if(r.consume(),r.consumeSpaces(),a=r.fetch().text,-1==="lcr".indexOf(a))throw new YPe("Expected l or c or r",r.nextToken);r.consume(),r.consumeSpaces(),r.expect("]"),r.consume(),n.cols=[{type:"align",align:a}]}}var i=LFe(e.parser,n,NFe(e.envName)),o=Math.max(0,...i.body.map(e=>e.length));return i.cols=new Array(o).fill({type:"align",align:a}),t?{type:"leftright",mode:e.mode,body:[i],left:t[0],right:t[1],rightColor:void 0}:i},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){var t=LFe(e.parser,{arraystretch:.5},"script");return t.colSeparationType="small",t},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["subarray"],props:{numArgs:1},handler(e,t){var a=(POe(t[0])?[t[0]]:ROe(t[0],"ordgroup").body).map(function(e){var t=DOe(e).text;if(-1!=="lc".indexOf(t))return{type:"align",align:t};throw new YPe("Unknown column alignment: "+t,e)});if(a.length>1)throw new YPe("{subarray} can contain only one column");var n={cols:a,hskipBeforeAndAfter:!1,arraystretch:.5};if((n=LFe(e.parser,n,"script")).body.length>0&&n.body[0].length>1)throw new YPe("{subarray} can contain only one column");return n},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){var t=LFe(e.parser,{arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},NFe(e.envName));return{type:"leftright",mode:e.mode,body:[t],left:e.envName.indexOf("r")>-1?".":"\\{",right:e.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:UFe,htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){["gather","gather*"].includes(e.envName)&&DFe(e);var t={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:PFe(e.envName),emptySingleRow:!0,leqno:e.parser.settings.leqno};return LFe(e.parser,t,"display")},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:UFe,htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){DFe(e);var t={autoTag:PFe(e.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:e.parser.settings.leqno};return LFe(e.parser,t,"display")},htmlBuilder:OFe,mathmlBuilder:BFe}),AFe({type:"array",names:["CD"],props:{numArgs:0},handler:e=>(DFe(e),function(e){var t=[];for(e.gullet.beginGroup(),e.gullet.macros.set("\\cr","\\\\\\relax"),e.gullet.beginGroup();;){t.push(e.parseExpression(!1,"\\\\")),e.gullet.endGroup(),e.gullet.beginGroup();var a=e.fetch().text;if("&"!==a&&"\\\\"!==a){if("\\end"===a){0===t[t.length-1].length&&t.pop();break}throw new YPe("Expected \\\\ or \\cr or \\end",e.nextToken)}e.consume()}for(var n=[],r=[n],i=0;i<t.length;i++){for(var o=t[i],s=GOe(),l=0;l<o.length;l++)if(WOe(o[l])){n.push(s);var c=DOe(o[l+=1]).text,u=new Array(2);if(u[0]={type:"ordgroup",mode:"math",body:[]},u[1]={type:"ordgroup",mode:"math",body:[]},"=|.".indexOf(c)>-1);else{if(!("<>AV".indexOf(c)>-1))throw new YPe('Expected one of "<>AV=|." after @',o[l]);for(var d=0;d<2;d++){for(var h=!0,p=l+1;p<o.length;p++){if(qOe(o[p],c)){h=!1,l=p;break}if(WOe(o[p]))throw new YPe("Missing a "+c+" character to complete a CD arrow.",o[p]);u[d].body.push(o[p])}if(h)throw new YPe("Missing a "+c+" character to complete a CD arrow.",o[l])}}var f={type:"styling",body:[YOe(c,u,e)],mode:"math",style:"display"};n.push(f),s=GOe()}else s.body.push(o[l]);i%2==0?n.push(s):n.shift(),n=[],r.push(n)}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:"math",body:r,arraystretch:1,addJot:!0,rowGaps:[null],cols:new Array(r[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25}),colSeparationType:"CD",hLinesBeforeRow:new Array(r.length+1).fill([])}}(e.parser)),htmlBuilder:OFe,mathmlBuilder:BFe}),IFe("\\nonumber","\\gdef\\@eqnsw{0}"),IFe("\\notag","\\nonumber"),XNe({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(e,t){throw new YPe(e.funcName+" valid only within array environment")}});var zFe=CFe;XNe({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(e,t){var{parser:a,funcName:n}=e,r=t[0];if("ordgroup"!==r.type)throw new YPe("Invalid environment name",r);for(var i="",o=0;o<r.body.length;++o)i+=ROe(r.body[o],"textord").text;if("\\begin"===n){if(!zFe.hasOwnProperty(i))throw new YPe("No such environment: "+i,r);var s=zFe[i],{args:l,optArgs:c}=a.parseArguments("\\begin{"+i+"}",s),u={mode:a.mode,envName:i,parser:a},d=s.handler(u,l,c);a.expect("\\end",!1);var h=a.nextToken,p=ROe(a.parseFunction(),"environment");if(p.name!==i)throw new YPe("Mismatch: \\begin{"+i+"} matched by \\end{"+p.name+"}",h);return d}return{type:"environment",mode:a.mode,name:i,nameGroup:r}}});var VFe=(e,t)=>{var a=e.font,n=t.withFont(a);return cOe(e.body,n)},HFe=(e,t)=>{var a=e.font,n=t.withFont(a);return _Oe(e.body,n)},GFe={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};XNe({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=KNe(t[0]),i=n;return i in GFe&&(i=GFe[i]),{type:"font",mode:a.mode,font:i.slice(1),body:r}},htmlBuilder:VFe,mathmlBuilder:HFe}),XNe({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(e,t)=>{var{parser:a}=e,n=t[0],r=ZPe.isCharacterBox(n);return{type:"mclass",mode:a.mode,mclass:VOe(n),body:[{type:"font",mode:a.mode,font:"boldsymbol",body:n}],isCharacterBox:r}}}),XNe({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{parser:a,funcName:n,breakOnTokenText:r}=e,{mode:i}=a,o=a.parseExpression(!0,r);return{type:"font",mode:i,font:"math"+n.slice(1),body:{type:"ordgroup",mode:a.mode,body:o}}},htmlBuilder:VFe,mathmlBuilder:HFe});var WFe=(e,t)=>{var a=t;return"display"===e?a=a.id>=cLe.SCRIPT.id?a.text():cLe.DISPLAY:"text"===e&&a.size===cLe.DISPLAY.size?a=cLe.TEXT:"script"===e?a=cLe.SCRIPT:"scriptscript"===e&&(a=cLe.SCRIPTSCRIPT),a},qFe=(e,t)=>{var a,n=WFe(e.size,t.style),r=n.fracNum(),i=n.fracDen();a=t.havingStyle(r);var o=cOe(e.numer,a,t);if(e.continued){var s=8.5/t.fontMetrics().ptPerEm,l=3.5/t.fontMetrics().ptPerEm;o.height=o.height<s?s:o.height,o.depth=o.depth<l?l:o.depth}a=t.havingStyle(i);var c,u,d,h,p,f,m,v,g,y,b=cOe(e.denom,a,t);if(e.hasBarLine?(e.barSize?(u=ALe(e.barSize,t),c=UNe.makeLineSpan("frac-line",t,u)):c=UNe.makeLineSpan("frac-line",t),u=c.height,d=c.height):(c=null,u=0,d=t.fontMetrics().defaultRuleThickness),n.size===cLe.DISPLAY.size||"display"===e.size?(h=t.fontMetrics().num1,p=u>0?3*d:7*d,f=t.fontMetrics().denom1):(u>0?(h=t.fontMetrics().num2,p=d):(h=t.fontMetrics().num3,p=3*d),f=t.fontMetrics().denom2),c){var x=t.fontMetrics().axisHeight;h-o.depth-(x+.5*u)<p&&(h+=p-(h-o.depth-(x+.5*u))),x-.5*u-(b.height-f)<p&&(f+=p-(x-.5*u-(b.height-f)));var w=-(x-.5*u);m=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:b,shift:f},{type:"elem",elem:c,shift:w},{type:"elem",elem:o,shift:-h}]},t)}else{var _=h-o.depth-(b.height-f);_<p&&(h+=.5*(p-_),f+=.5*(p-_)),m=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:b,shift:f},{type:"elem",elem:o,shift:-h}]},t)}return a=t.havingStyle(n),m.height*=a.sizeMultiplier/t.sizeMultiplier,m.depth*=a.sizeMultiplier/t.sizeMultiplier,v=n.size===cLe.DISPLAY.size?t.fontMetrics().delim1:n.size===cLe.SCRIPTSCRIPT.size?t.havingStyle(cLe.SCRIPT).fontMetrics().delim2:t.fontMetrics().delim2,g=null==e.leftDelim?lOe(t,["mopen"]):xFe.customSizedDelim(e.leftDelim,v,!0,t.havingStyle(n),e.mode,["mopen"]),y=e.continued?UNe.makeSpan([]):null==e.rightDelim?lOe(t,["mclose"]):xFe.customSizedDelim(e.rightDelim,v,!0,t.havingStyle(n),e.mode,["mclose"]),UNe.makeSpan(["mord"].concat(a.sizingClasses(t)),[g,UNe.makeSpan(["mfrac"],[m]),y],t)},YFe=(e,t)=>{var a=new mOe.MathNode("mfrac",[_Oe(e.numer,t),_Oe(e.denom,t)]);if(e.hasBarLine){if(e.barSize){var n=ALe(e.barSize,t);a.setAttribute("linethickness",ELe(n))}}else a.setAttribute("linethickness","0px");var r=WFe(e.size,t.style);if(r.size!==t.style.size){a=new mOe.MathNode("mstyle",[a]);var i=r.size===cLe.DISPLAY.size?"true":"false";a.setAttribute("displaystyle",i),a.setAttribute("scriptlevel","0")}if(null!=e.leftDelim||null!=e.rightDelim){var o=[];if(null!=e.leftDelim){var s=new mOe.MathNode("mo",[new mOe.TextNode(e.leftDelim.replace("\\",""))]);s.setAttribute("fence","true"),o.push(s)}if(o.push(a),null!=e.rightDelim){var l=new mOe.MathNode("mo",[new mOe.TextNode(e.rightDelim.replace("\\",""))]);l.setAttribute("fence","true"),o.push(l)}return gOe(o)}return a};XNe({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(e,t)=>{var a,{parser:n,funcName:r}=e,i=t[0],o=t[1],s=null,l=null,c="auto";switch(r){case"\\dfrac":case"\\frac":case"\\tfrac":a=!0;break;case"\\\\atopfrac":a=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":a=!1,s="(",l=")";break;case"\\\\bracefrac":a=!1,s="\\{",l="\\}";break;case"\\\\brackfrac":a=!1,s="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(r){case"\\dfrac":case"\\dbinom":c="display";break;case"\\tfrac":case"\\tbinom":c="text"}return{type:"genfrac",mode:n.mode,continued:!1,numer:i,denom:o,hasBarLine:a,leftDelim:s,rightDelim:l,size:c,barSize:null}},htmlBuilder:qFe,mathmlBuilder:YFe}),XNe({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=t[0],i=t[1];return{type:"genfrac",mode:a.mode,continued:!0,numer:r,denom:i,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}}),XNe({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(e){var t,{parser:a,funcName:n,token:r}=e;switch(n){case"\\over":t="\\frac";break;case"\\choose":t="\\binom";break;case"\\atop":t="\\\\atopfrac";break;case"\\brace":t="\\\\bracefrac";break;case"\\brack":t="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:a.mode,replaceWith:t,token:r}}});var jFe=["display","text","script","scriptscript"],XFe=function(e){var t=null;return e.length>0&&(t="."===(t=e)?null:t),t};XNe({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(e,t){var a,{parser:n}=e,r=t[4],i=t[5],o=KNe(t[0]),s="atom"===o.type&&"open"===o.family?XFe(o.text):null,l=KNe(t[1]),c="atom"===l.type&&"close"===l.family?XFe(l.text):null,u=ROe(t[2],"size"),d=null;a=!!u.isBlank||(d=u.value).number>0;var h="auto",p=t[3];if("ordgroup"===p.type){if(p.body.length>0){var f=ROe(p.body[0],"textord");h=jFe[Number(f.text)]}}else p=ROe(p,"textord"),h=jFe[Number(p.text)];return{type:"genfrac",mode:n.mode,numer:r,denom:i,continued:!1,hasBarLine:a,barSize:d,leftDelim:s,rightDelim:c,size:h}},htmlBuilder:qFe,mathmlBuilder:YFe}),XNe({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(e,t){var{parser:a,funcName:n,token:r}=e;return{type:"infix",mode:a.mode,replaceWith:"\\\\abovefrac",size:ROe(t[0],"size").value,token:r}}}),XNe({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=t[0],i=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e}(ROe(t[1],"infix").size),o=t[2],s=i.number>0;return{type:"genfrac",mode:a.mode,numer:r,denom:o,continued:!1,hasBarLine:s,barSize:i,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:qFe,mathmlBuilder:YFe});var $Fe=(e,t)=>{var a,n,r=t.style;"supsub"===e.type?(a=e.sup?cOe(e.sup,t.havingStyle(r.sup()),t):cOe(e.sub,t.havingStyle(r.sub()),t),n=ROe(e.base,"horizBrace")):n=ROe(e,"horizBrace");var i,o=cOe(n.base,t.havingBaseStyle(cLe.DISPLAY)),s=IOe(n,t);if(n.isOver?(i=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:o},{type:"kern",size:.1},{type:"elem",elem:s}]},t)).children[0].children[0].children[1].classes.push("svg-align"):(i=UNe.makeVList({positionType:"bottom",positionData:o.depth+.1+s.height,children:[{type:"elem",elem:s},{type:"kern",size:.1},{type:"elem",elem:o}]},t)).children[0].children[0].children[0].classes.push("svg-align"),a){var l=UNe.makeSpan(["mord",n.isOver?"mover":"munder"],[i],t);i=n.isOver?UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.2},{type:"elem",elem:a}]},t):UNe.makeVList({positionType:"bottom",positionData:l.depth+.2+a.height+a.depth,children:[{type:"elem",elem:a},{type:"kern",size:.2},{type:"elem",elem:l}]},t)}return UNe.makeSpan(["mord",n.isOver?"mover":"munder"],[i],t)};XNe({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(e,t){var{parser:a,funcName:n}=e;return{type:"horizBrace",mode:a.mode,label:n,isOver:/^\\over/.test(n),base:t[0]}},htmlBuilder:$Fe,mathmlBuilder:(e,t)=>{var a=EOe(e.label);return new mOe.MathNode(e.isOver?"mover":"munder",[_Oe(e.base,t),a])}}),XNe({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(e,t)=>{var{parser:a}=e,n=t[1],r=ROe(t[0],"url").url;return a.settings.isTrusted({command:"\\href",url:r})?{type:"href",mode:a.mode,href:r,body:ZNe(n)}:a.formatUnsupportedCmd("\\href")},htmlBuilder:(e,t)=>{var a=nOe(e.body,t,!1);return UNe.makeAnchor(e.href,[],a,t)},mathmlBuilder:(e,t)=>{var a=wOe(e.body,t);return a instanceof pOe||(a=new pOe("mrow",[a])),a.setAttribute("href",e.href),a}}),XNe({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(e,t)=>{var{parser:a}=e,n=ROe(t[0],"url").url;if(!a.settings.isTrusted({command:"\\url",url:n}))return a.formatUnsupportedCmd("\\url");for(var r=[],i=0;i<n.length;i++){var o=n[i];"~"===o&&(o="\\textasciitilde"),r.push({type:"textord",mode:"text",text:o})}var s={type:"text",mode:a.mode,font:"\\texttt",body:r};return{type:"href",mode:a.mode,href:n,body:ZNe(s)}}}),XNe({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(e,t){var{parser:a}=e;return{type:"hbox",mode:a.mode,body:ZNe(t[0])}},htmlBuilder(e,t){var a=nOe(e.body,t,!1);return UNe.makeFragment(a)},mathmlBuilder:(e,t)=>new mOe.MathNode("mrow",xOe(e.body,t))}),XNe({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(e,t)=>{var a,{parser:n,funcName:r,token:i}=e,o=ROe(t[0],"raw").string,s=t[1];n.settings.strict&&n.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var l={};switch(r){case"\\htmlClass":l.class=o,a={command:"\\htmlClass",class:o};break;case"\\htmlId":l.id=o,a={command:"\\htmlId",id:o};break;case"\\htmlStyle":l.style=o,a={command:"\\htmlStyle",style:o};break;case"\\htmlData":for(var c=o.split(","),u=0;u<c.length;u++){var d=c[u],h=d.indexOf("=");if(h<0)throw new YPe("\\htmlData key/value '"+d+"' missing equals sign");var p=d.slice(0,h),f=d.slice(h+1);l["data-"+p.trim()]=f}a={command:"\\htmlData",attributes:l};break;default:throw new Error("Unrecognized html command")}return n.settings.isTrusted(a)?{type:"html",mode:n.mode,attributes:l,body:ZNe(s)}:n.formatUnsupportedCmd(r)},htmlBuilder:(e,t)=>{var a=nOe(e.body,t,!1),n=["enclosing"];e.attributes.class&&n.push(...e.attributes.class.trim().split(/\s+/));var r=UNe.makeSpan(n,a,t);for(var i in e.attributes)"class"!==i&&e.attributes.hasOwnProperty(i)&&r.setAttribute(i,e.attributes[i]);return r},mathmlBuilder:(e,t)=>wOe(e.body,t)}),XNe({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(e,t)=>{var{parser:a}=e;return{type:"htmlmathml",mode:a.mode,html:ZNe(t[0]),mathml:ZNe(t[1])}},htmlBuilder:(e,t)=>{var a=nOe(e.html,t,!1);return UNe.makeFragment(a)},mathmlBuilder:(e,t)=>wOe(e.mathml,t)});var KFe=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var t=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!t)throw new YPe("Invalid size: '"+e+"' in \\includegraphics");var a={number:+(t[1]+t[2]),unit:t[3]};if(!CLe(a))throw new YPe("Invalid unit: '"+a.unit+"' in \\includegraphics.");return a};XNe({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(e,t,a)=>{var{parser:n}=e,r={number:0,unit:"em"},i={number:.9,unit:"em"},o={number:0,unit:"em"},s="";if(a[0])for(var l=ROe(a[0],"raw").string.split(","),c=0;c<l.length;c++){var u=l[c].split("=");if(2===u.length){var d=u[1].trim();switch(u[0].trim()){case"alt":s=d;break;case"width":r=KFe(d);break;case"height":i=KFe(d);break;case"totalheight":o=KFe(d);break;default:throw new YPe("Invalid key: '"+u[0]+"' in \\includegraphics.")}}}var h=ROe(t[0],"url").url;return""===s&&(s=(s=(s=h).replace(/^.*[\\/]/,"")).substring(0,s.lastIndexOf("."))),n.settings.isTrusted({command:"\\includegraphics",url:h})?{type:"includegraphics",mode:n.mode,alt:s,width:r,height:i,totalheight:o,src:h}:n.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(e,t)=>{var a=ALe(e.height,t),n=0;e.totalheight.number>0&&(n=ALe(e.totalheight,t)-a);var r=0;e.width.number>0&&(r=ALe(e.width,t));var i={height:ELe(a+n)};r>0&&(i.width=ELe(r)),n>0&&(i.verticalAlign=ELe(-n));var o=new FLe(e.src,e.alt,i);return o.height=a,o.depth=n,o},mathmlBuilder:(e,t)=>{var a=new mOe.MathNode("mglyph",[]);a.setAttribute("alt",e.alt);var n=ALe(e.height,t),r=0;if(e.totalheight.number>0&&(r=ALe(e.totalheight,t)-n,a.setAttribute("valign",ELe(-r))),a.setAttribute("height",ELe(n+r)),e.width.number>0){var i=ALe(e.width,t);a.setAttribute("width",ELe(i))}return a.setAttribute("src",e.src),a}}),XNe({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(e,t){var{parser:a,funcName:n}=e,r=ROe(t[0],"size");if(a.settings.strict){var i="m"===n[1],o="mu"===r.value.unit;i?(o||a.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" supports only mu units, not "+r.value.unit+" units"),"math"!==a.mode&&a.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" works only in math mode")):o&&a.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" doesn't support mu units")}return{type:"kern",mode:a.mode,dimension:r.value}},htmlBuilder:(e,t)=>UNe.makeGlue(e.dimension,t),mathmlBuilder(e,t){var a=ALe(e.dimension,t);return new mOe.SpaceNode(a)}}),XNe({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=t[0];return{type:"lap",mode:a.mode,alignment:n.slice(5),body:r}},htmlBuilder:(e,t)=>{var a;"clap"===e.alignment?(a=UNe.makeSpan([],[cOe(e.body,t)]),a=UNe.makeSpan(["inner"],[a],t)):a=UNe.makeSpan(["inner"],[cOe(e.body,t)]);var n=UNe.makeSpan(["fix"],[]),r=UNe.makeSpan([e.alignment],[a,n],t),i=UNe.makeSpan(["strut"]);return i.style.height=ELe(r.height+r.depth),r.depth&&(i.style.verticalAlign=ELe(-r.depth)),r.children.unshift(i),r=UNe.makeSpan(["thinbox"],[r],t),UNe.makeSpan(["mord","vbox"],[r],t)},mathmlBuilder:(e,t)=>{var a=new mOe.MathNode("mpadded",[_Oe(e.body,t)]);if("rlap"!==e.alignment){var n="llap"===e.alignment?"-1":"-0.5";a.setAttribute("lspace",n+"width")}return a.setAttribute("width","0px"),a}}),XNe({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){var{funcName:a,parser:n}=e,r=n.mode;n.switchMode("math");var i="\\("===a?"\\)":"$",o=n.parseExpression(!1,i);return n.expect(i),n.switchMode(r),{type:"styling",mode:n.mode,style:"text",body:o}}}),XNe({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){throw new YPe("Mismatched "+e.funcName)}});var ZFe=(e,t)=>{switch(t.style.size){case cLe.DISPLAY.size:return e.display;case cLe.TEXT.size:return e.text;case cLe.SCRIPT.size:return e.script;case cLe.SCRIPTSCRIPT.size:return e.scriptscript;default:return e.text}};XNe({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(e,t)=>{var{parser:a}=e;return{type:"mathchoice",mode:a.mode,display:ZNe(t[0]),text:ZNe(t[1]),script:ZNe(t[2]),scriptscript:ZNe(t[3])}},htmlBuilder:(e,t)=>{var a=ZFe(e,t),n=nOe(a,t,!1);return UNe.makeFragment(n)},mathmlBuilder:(e,t)=>{var a=ZFe(e,t);return wOe(a,t)}});var JFe=(e,t,a,n,r,i,o)=>{e=UNe.makeSpan([],[e]);var s,l,c,u=a&&ZPe.isCharacterBox(a);if(t){var d=cOe(t,n.havingStyle(r.sup()),n);l={elem:d,kern:Math.max(n.fontMetrics().bigOpSpacing1,n.fontMetrics().bigOpSpacing3-d.depth)}}if(a){var h=cOe(a,n.havingStyle(r.sub()),n);s={elem:h,kern:Math.max(n.fontMetrics().bigOpSpacing2,n.fontMetrics().bigOpSpacing4-h.height)}}if(l&&s){var p=n.fontMetrics().bigOpSpacing5+s.elem.height+s.elem.depth+s.kern+e.depth+o;c=UNe.makeVList({positionType:"bottom",positionData:p,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:s.elem,marginLeft:ELe(-i)},{type:"kern",size:s.kern},{type:"elem",elem:e},{type:"kern",size:l.kern},{type:"elem",elem:l.elem,marginLeft:ELe(i)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else if(s){var f=e.height-o;c=UNe.makeVList({positionType:"top",positionData:f,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:s.elem,marginLeft:ELe(-i)},{type:"kern",size:s.kern},{type:"elem",elem:e}]},n)}else{if(!l)return e;var m=e.depth+o;c=UNe.makeVList({positionType:"bottom",positionData:m,children:[{type:"elem",elem:e},{type:"kern",size:l.kern},{type:"elem",elem:l.elem,marginLeft:ELe(i)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}var v=[c];if(s&&0!==i&&!u){var g=UNe.makeSpan(["mspace"],[],n);g.style.marginRight=ELe(i),v.unshift(g)}return UNe.makeSpan(["mop","op-limits"],v,n)},QFe=["\\smallint"],eBe=(e,t)=>{var a,n,r,i=!1;"supsub"===e.type?(a=e.sup,n=e.sub,r=ROe(e.base,"op"),i=!0):r=ROe(e,"op");var o,s=t.style,l=!1;if(s.size===cLe.DISPLAY.size&&r.symbol&&!QFe.includes(r.name)&&(l=!0),r.symbol){var c=l?"Size2-Regular":"Size1-Regular",u="";if("\\oiint"!==r.name&&"\\oiiint"!==r.name||(u=r.name.slice(1),r.name="oiint"===u?"\\iint":"\\iiint"),o=UNe.makeSymbol(r.name,c,"math",t,["mop","op-symbol",l?"large-op":"small-op"]),u.length>0){var d=o.italic,h=UNe.staticSvg(u+"Size"+(l?"2":"1"),t);o=UNe.makeVList({positionType:"individualShift",children:[{type:"elem",elem:o,shift:0},{type:"elem",elem:h,shift:l?.08:0}]},t),r.name="\\"+u,o.classes.unshift("mop"),o.italic=d}}else if(r.body){var p=nOe(r.body,t,!0);1===p.length&&p[0]instanceof ULe?(o=p[0]).classes[0]="mop":o=UNe.makeSpan(["mop"],p,t)}else{for(var f=[],m=1;m<r.name.length;m++)f.push(UNe.mathsym(r.name[m],r.mode,t));o=UNe.makeSpan(["mop"],f,t)}var v=0,g=0;return(o instanceof ULe||"\\oiint"===r.name||"\\oiiint"===r.name)&&!r.suppressBaseShift&&(v=(o.height-o.depth)/2-t.fontMetrics().axisHeight,g=o.italic),i?JFe(o,a,n,t,s,g,v):(v&&(o.style.position="relative",o.style.top=ELe(v)),o)},tBe=(e,t)=>{var a;if(e.symbol)a=new pOe("mo",[vOe(e.name,e.mode)]),QFe.includes(e.name)&&a.setAttribute("largeop","false");else if(e.body)a=new pOe("mo",xOe(e.body,t));else{a=new pOe("mi",[new fOe(e.name.slice(1))]);var n=new pOe("mo",[vOe("⁡","text")]);a=e.parentIsSupSub?new pOe("mrow",[a,n]):hOe([a,n])}return a},aBe={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};XNe({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=n;return 1===r.length&&(r=aBe[r]),{type:"op",mode:a.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:r}},htmlBuilder:eBe,mathmlBuilder:tBe}),XNe({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var{parser:a}=e,n=t[0];return{type:"op",mode:a.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:ZNe(n)}},htmlBuilder:eBe,mathmlBuilder:tBe});var nBe={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};XNe({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(e){var{parser:t,funcName:a}=e;return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:a}},htmlBuilder:eBe,mathmlBuilder:tBe}),XNe({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(e){var{parser:t,funcName:a}=e;return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:a}},htmlBuilder:eBe,mathmlBuilder:tBe}),XNe({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0,allowedInArgument:!0},handler(e){var{parser:t,funcName:a}=e,n=a;return 1===n.length&&(n=nBe[n]),{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:eBe,mathmlBuilder:tBe});var rBe=(e,t)=>{var a,n,r,i,o=!1;if("supsub"===e.type?(a=e.sup,n=e.sub,r=ROe(e.base,"operatorname"),o=!0):r=ROe(e,"operatorname"),r.body.length>0){for(var s=r.body.map(e=>{var t=e.text;return"string"==typeof t?{type:"textord",mode:e.mode,text:t}:e}),l=nOe(s,t.withFont("mathrm"),!0),c=0;c<l.length;c++){var u=l[c];u instanceof ULe&&(u.text=u.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}i=UNe.makeSpan(["mop"],l,t)}else i=UNe.makeSpan(["mop"],[],t);return o?JFe(i,a,n,t,t.style,0,0):i};function iBe(e,t,a){for(var n=nOe(e,t,!1),r=t.sizeMultiplier/a.sizeMultiplier,i=0;i<n.length;i++){var o=n[i].classes.indexOf("sizing");o<0?Array.prototype.push.apply(n[i].classes,t.sizingClasses(a)):n[i].classes[o+1]==="reset-size"+t.size&&(n[i].classes[o+1]="reset-size"+a.size),n[i].height*=r,n[i].depth*=r}return UNe.makeFragment(n)}XNe({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(e,t)=>{var{parser:a,funcName:n}=e,r=t[0];return{type:"operatorname",mode:a.mode,body:ZNe(r),alwaysHandleSupSub:"\\operatornamewithlimits"===n,limits:!1,parentIsSupSub:!1}},htmlBuilder:rBe,mathmlBuilder:(e,t)=>{for(var a=xOe(e.body,t.withFont("mathrm")),n=!0,r=0;r<a.length;r++){var i=a[r];if(i instanceof mOe.SpaceNode);else if(i instanceof mOe.MathNode)switch(i.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":var o=i.children[0];1===i.children.length&&o instanceof mOe.TextNode?o.text=o.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):n=!1;break;default:n=!1}else n=!1}if(n){var s=a.map(e=>e.toText()).join("");a=[new mOe.TextNode(s)]}var l=new mOe.MathNode("mi",a);l.setAttribute("mathvariant","normal");var c=new mOe.MathNode("mo",[vOe("⁡","text")]);return e.parentIsSupSub?new mOe.MathNode("mrow",[l,c]):mOe.newDocumentFragment([l,c])}}),IFe("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@"),$Ne({type:"ordgroup",htmlBuilder:(e,t)=>e.semisimple?UNe.makeFragment(nOe(e.body,t,!1)):UNe.makeSpan(["mord"],nOe(e.body,t,!0),t),mathmlBuilder:(e,t)=>wOe(e.body,t,!0)}),XNe({type:"overline",names:["\\overline"],props:{numArgs:1},handler(e,t){var{parser:a}=e,n=t[0];return{type:"overline",mode:a.mode,body:n}},htmlBuilder(e,t){var a=cOe(e.body,t.havingCrampedStyle()),n=UNe.makeLineSpan("overline-line",t),r=t.fontMetrics().defaultRuleThickness,i=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"kern",size:3*r},{type:"elem",elem:n},{type:"kern",size:r}]},t);return UNe.makeSpan(["mord","overline"],[i],t)},mathmlBuilder(e,t){var a=new mOe.MathNode("mo",[new mOe.TextNode("‾")]);a.setAttribute("stretchy","true");var n=new mOe.MathNode("mover",[_Oe(e.body,t),a]);return n.setAttribute("accent","true"),n}}),XNe({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:a}=e,n=t[0];return{type:"phantom",mode:a.mode,body:ZNe(n)}},htmlBuilder:(e,t)=>{var a=nOe(e.body,t.withPhantom(),!1);return UNe.makeFragment(a)},mathmlBuilder:(e,t)=>{var a=xOe(e.body,t);return new mOe.MathNode("mphantom",a)}}),XNe({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:a}=e,n=t[0];return{type:"hphantom",mode:a.mode,body:n}},htmlBuilder:(e,t)=>{var a=UNe.makeSpan([],[cOe(e.body,t.withPhantom())]);if(a.height=0,a.depth=0,a.children)for(var n=0;n<a.children.length;n++)a.children[n].height=0,a.children[n].depth=0;return a=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a}]},t),UNe.makeSpan(["mord"],[a],t)},mathmlBuilder:(e,t)=>{var a=xOe(ZNe(e.body),t),n=new mOe.MathNode("mphantom",a),r=new mOe.MathNode("mpadded",[n]);return r.setAttribute("height","0px"),r.setAttribute("depth","0px"),r}}),XNe({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:a}=e,n=t[0];return{type:"vphantom",mode:a.mode,body:n}},htmlBuilder:(e,t)=>{var a=UNe.makeSpan(["inner"],[cOe(e.body,t.withPhantom())]),n=UNe.makeSpan(["fix"],[]);return UNe.makeSpan(["mord","rlap"],[a,n],t)},mathmlBuilder:(e,t)=>{var a=xOe(ZNe(e.body),t),n=new mOe.MathNode("mphantom",a),r=new mOe.MathNode("mpadded",[n]);return r.setAttribute("width","0px"),r}}),XNe({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(e,t){var{parser:a}=e,n=ROe(t[0],"size").value,r=t[1];return{type:"raisebox",mode:a.mode,dy:n,body:r}},htmlBuilder(e,t){var a=cOe(e.body,t),n=ALe(e.dy,t);return UNe.makeVList({positionType:"shift",positionData:-n,children:[{type:"elem",elem:a}]},t)},mathmlBuilder(e,t){var a=new mOe.MathNode("mpadded",[_Oe(e.body,t)]),n=e.dy.number+e.dy.unit;return a.setAttribute("voffset",n),a}}),XNe({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(e){var{parser:t}=e;return{type:"internal",mode:t.mode}}}),XNe({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(e,t,a){var{parser:n}=e,r=a[0],i=ROe(t[0],"size"),o=ROe(t[1],"size");return{type:"rule",mode:n.mode,shift:r&&ROe(r,"size").value,width:i.value,height:o.value}},htmlBuilder(e,t){var a=UNe.makeSpan(["mord","rule"],[],t),n=ALe(e.width,t),r=ALe(e.height,t),i=e.shift?ALe(e.shift,t):0;return a.style.borderRightWidth=ELe(n),a.style.borderTopWidth=ELe(r),a.style.bottom=ELe(i),a.width=n,a.height=r+i,a.depth=-i,a.maxFontSize=1.125*r*t.sizeMultiplier,a},mathmlBuilder(e,t){var a=ALe(e.width,t),n=ALe(e.height,t),r=e.shift?ALe(e.shift,t):0,i=t.color&&t.getColor()||"black",o=new mOe.MathNode("mspace");o.setAttribute("mathbackground",i),o.setAttribute("width",ELe(a)),o.setAttribute("height",ELe(n));var s=new mOe.MathNode("mpadded",[o]);return r>=0?s.setAttribute("height",ELe(r)):(s.setAttribute("height",ELe(r)),s.setAttribute("depth",ELe(-r))),s.setAttribute("voffset",ELe(r)),s}});var oBe=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"];XNe({type:"sizing",names:oBe,props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{breakOnTokenText:a,funcName:n,parser:r}=e,i=r.parseExpression(!1,a);return{type:"sizing",mode:r.mode,size:oBe.indexOf(n)+1,body:i}},htmlBuilder:(e,t)=>{var a=t.havingSize(e.size);return iBe(e.body,a,t)},mathmlBuilder:(e,t)=>{var a=t.havingSize(e.size),n=xOe(e.body,a),r=new mOe.MathNode("mstyle",n);return r.setAttribute("mathsize",ELe(a.sizeMultiplier)),r}}),XNe({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(e,t,a)=>{var{parser:n}=e,r=!1,i=!1,o=a[0]&&ROe(a[0],"ordgroup");if(o)for(var s="",l=0;l<o.body.length;++l){if("t"===(s=o.body[l].text))r=!0;else{if("b"!==s){r=!1,i=!1;break}i=!0}}else r=!0,i=!0;var c=t[0];return{type:"smash",mode:n.mode,body:c,smashHeight:r,smashDepth:i}},htmlBuilder:(e,t)=>{var a=UNe.makeSpan([],[cOe(e.body,t)]);if(!e.smashHeight&&!e.smashDepth)return a;if(e.smashHeight&&(a.height=0,a.children))for(var n=0;n<a.children.length;n++)a.children[n].height=0;if(e.smashDepth&&(a.depth=0,a.children))for(var r=0;r<a.children.length;r++)a.children[r].depth=0;var i=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a}]},t);return UNe.makeSpan(["mord"],[i],t)},mathmlBuilder:(e,t)=>{var a=new mOe.MathNode("mpadded",[_Oe(e.body,t)]);return e.smashHeight&&a.setAttribute("height","0px"),e.smashDepth&&a.setAttribute("depth","0px"),a}}),XNe({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,a){var{parser:n}=e,r=a[0],i=t[0];return{type:"sqrt",mode:n.mode,body:i,index:r}},htmlBuilder(e,t){var a=cOe(e.body,t.havingCrampedStyle());0===a.height&&(a.height=t.fontMetrics().xHeight),a=UNe.wrapFragment(a,t);var n=t.fontMetrics().defaultRuleThickness,r=n;t.style.id<cLe.TEXT.id&&(r=t.fontMetrics().xHeight);var i=n+r/4,o=a.height+a.depth+i+n,{span:s,ruleWidth:l,advanceWidth:c}=xFe.sqrtImage(o,t),u=s.height-l;u>a.height+a.depth+i&&(i=(i+u-a.height-a.depth)/2);var d=s.height-a.height-i-l;a.style.paddingLeft=ELe(c);var h=UNe.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a,wrapperClasses:["svg-align"]},{type:"kern",size:-(a.height+d)},{type:"elem",elem:s},{type:"kern",size:l}]},t);if(e.index){var p=t.havingStyle(cLe.SCRIPTSCRIPT),f=cOe(e.index,p,t),m=.6*(h.height-h.depth),v=UNe.makeVList({positionType:"shift",positionData:-m,children:[{type:"elem",elem:f}]},t),g=UNe.makeSpan(["root"],[v]);return UNe.makeSpan(["mord","sqrt"],[g,h],t)}return UNe.makeSpan(["mord","sqrt"],[h],t)},mathmlBuilder(e,t){var{body:a,index:n}=e;return n?new mOe.MathNode("mroot",[_Oe(a,t),_Oe(n,t)]):new mOe.MathNode("msqrt",[_Oe(a,t)])}});var sBe={display:cLe.DISPLAY,text:cLe.TEXT,script:cLe.SCRIPT,scriptscript:cLe.SCRIPTSCRIPT};XNe({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e,t){var{breakOnTokenText:a,funcName:n,parser:r}=e,i=r.parseExpression(!0,a),o=n.slice(1,n.length-5);return{type:"styling",mode:r.mode,style:o,body:i}},htmlBuilder(e,t){var a=sBe[e.style],n=t.havingStyle(a).withFont("");return iBe(e.body,n,t)},mathmlBuilder(e,t){var a=sBe[e.style],n=t.havingStyle(a),r=xOe(e.body,n),i=new mOe.MathNode("mstyle",r),o={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]}[e.style];return i.setAttribute("scriptlevel",o[0]),i.setAttribute("displaystyle",o[1]),i}});$Ne({type:"supsub",htmlBuilder(e,t){var a=function(e,t){var a=e.base;return a?"op"===a.type?a.limits&&(t.style.size===cLe.DISPLAY.size||a.alwaysHandleSupSub)?eBe:null:"operatorname"===a.type?a.alwaysHandleSupSub&&(t.style.size===cLe.DISPLAY.size||a.limits)?rBe:null:"accent"===a.type?ZPe.isCharacterBox(a.base)?LOe:null:"horizBrace"===a.type&&!e.sub===a.isOver?$Fe:null:null}(e,t);if(a)return a(e,t);var n,r,i,{base:o,sup:s,sub:l}=e,c=cOe(o,t),u=t.fontMetrics(),d=0,h=0,p=o&&ZPe.isCharacterBox(o);if(s){var f=t.havingStyle(t.style.sup());n=cOe(s,f,t),p||(d=c.height-f.fontMetrics().supDrop*f.sizeMultiplier/t.sizeMultiplier)}if(l){var m=t.havingStyle(t.style.sub());r=cOe(l,m,t),p||(h=c.depth+m.fontMetrics().subDrop*m.sizeMultiplier/t.sizeMultiplier)}i=t.style===cLe.DISPLAY?u.sup1:t.style.cramped?u.sup3:u.sup2;var v,g=t.sizeMultiplier,y=ELe(.5/u.ptPerEm/g),b=null;if(r){var x=e.base&&"op"===e.base.type&&e.base.name&&("\\oiint"===e.base.name||"\\oiiint"===e.base.name);(c instanceof ULe||x)&&(b=ELe(-c.italic))}if(n&&r){d=Math.max(d,i,n.depth+.25*u.xHeight),h=Math.max(h,u.sub2);var w=4*u.defaultRuleThickness;if(d-n.depth-(r.height-h)<w){h=w-(d-n.depth)+r.height;var _=.8*u.xHeight-(d-n.depth);_>0&&(d+=_,h-=_)}var S=[{type:"elem",elem:r,shift:h,marginRight:y,marginLeft:b},{type:"elem",elem:n,shift:-d,marginRight:y}];v=UNe.makeVList({positionType:"individualShift",children:S},t)}else if(r){h=Math.max(h,u.sub1,r.height-.8*u.xHeight);var M=[{type:"elem",elem:r,marginLeft:b,marginRight:y}];v=UNe.makeVList({positionType:"shift",positionData:h,children:M},t)}else{if(!n)throw new Error("supsub must have either sup or sub.");d=Math.max(d,i,n.depth+.25*u.xHeight),v=UNe.makeVList({positionType:"shift",positionData:-d,children:[{type:"elem",elem:n,marginRight:y}]},t)}var T=sOe(c,"right")||"mord";return UNe.makeSpan([T],[c,UNe.makeSpan(["msupsub"],[v])],t)},mathmlBuilder(e,t){var a,n=!1;e.base&&"horizBrace"===e.base.type&&!!e.sup===e.base.isOver&&(n=!0,a=e.base.isOver),!e.base||"op"!==e.base.type&&"operatorname"!==e.base.type||(e.base.parentIsSupSub=!0);var r,i=[_Oe(e.base,t)];if(e.sub&&i.push(_Oe(e.sub,t)),e.sup&&i.push(_Oe(e.sup,t)),n)r=a?"mover":"munder";else if(e.sub)if(e.sup){var o=e.base;r=o&&"op"===o.type&&o.limits&&t.style===cLe.DISPLAY||o&&"operatorname"===o.type&&o.alwaysHandleSupSub&&(t.style===cLe.DISPLAY||o.limits)?"munderover":"msubsup"}else{var s=e.base;r=s&&"op"===s.type&&s.limits&&(t.style===cLe.DISPLAY||s.alwaysHandleSupSub)||s&&"operatorname"===s.type&&s.alwaysHandleSupSub&&(s.limits||t.style===cLe.DISPLAY)?"munder":"msub"}else{var l=e.base;r=l&&"op"===l.type&&l.limits&&(t.style===cLe.DISPLAY||l.alwaysHandleSupSub)||l&&"operatorname"===l.type&&l.alwaysHandleSupSub&&(l.limits||t.style===cLe.DISPLAY)?"mover":"msup"}return new mOe.MathNode(r,i)}}),$Ne({type:"atom",htmlBuilder:(e,t)=>UNe.mathsym(e.text,e.mode,t,["m"+e.family]),mathmlBuilder(e,t){var a=new mOe.MathNode("mo",[vOe(e.text,e.mode)]);if("bin"===e.family){var n=yOe(e,t);"bold-italic"===n&&a.setAttribute("mathvariant",n)}else"punct"===e.family?a.setAttribute("separator","true"):"open"!==e.family&&"close"!==e.family||a.setAttribute("stretchy","false");return a}});var lBe={mi:"italic",mn:"normal",mtext:"normal"};$Ne({type:"mathord",htmlBuilder:(e,t)=>UNe.makeOrd(e,t,"mathord"),mathmlBuilder(e,t){var a=new mOe.MathNode("mi",[vOe(e.text,e.mode,t)]),n=yOe(e,t)||"italic";return n!==lBe[a.type]&&a.setAttribute("mathvariant",n),a}}),$Ne({type:"textord",htmlBuilder:(e,t)=>UNe.makeOrd(e,t,"textord"),mathmlBuilder(e,t){var a,n=vOe(e.text,e.mode,t),r=yOe(e,t)||"normal";return a="text"===e.mode?new mOe.MathNode("mtext",[n]):/[0-9]/.test(e.text)?new mOe.MathNode("mn",[n]):"\\prime"===e.text?new mOe.MathNode("mo",[n]):new mOe.MathNode("mi",[n]),r!==lBe[a.type]&&a.setAttribute("mathvariant",r),a}});var cBe={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},uBe={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};$Ne({type:"spacing",htmlBuilder(e,t){if(uBe.hasOwnProperty(e.text)){var a=uBe[e.text].className||"";if("text"===e.mode){var n=UNe.makeOrd(e,t,"textord");return n.classes.push(a),n}return UNe.makeSpan(["mspace",a],[UNe.mathsym(e.text,e.mode,t)],t)}if(cBe.hasOwnProperty(e.text))return UNe.makeSpan(["mspace",cBe[e.text]],[],t);throw new YPe('Unknown type of space "'+e.text+'"')},mathmlBuilder(e,t){if(!uBe.hasOwnProperty(e.text)){if(cBe.hasOwnProperty(e.text))return new mOe.MathNode("mspace");throw new YPe('Unknown type of space "'+e.text+'"')}return new mOe.MathNode("mtext",[new mOe.TextNode(" ")])}});var dBe=()=>{var e=new mOe.MathNode("mtd",[]);return e.setAttribute("width","50%"),e};$Ne({type:"tag",mathmlBuilder(e,t){var a=new mOe.MathNode("mtable",[new mOe.MathNode("mtr",[dBe(),new mOe.MathNode("mtd",[wOe(e.body,t)]),dBe(),new mOe.MathNode("mtd",[wOe(e.tag,t)])])]);return a.setAttribute("width","100%"),a}});var hBe={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},pBe={"\\textbf":"textbf","\\textmd":"textmd"},fBe={"\\textit":"textit","\\textup":"textup"},mBe=(e,t)=>{var a=e.font;return a?hBe[a]?t.withTextFontFamily(hBe[a]):pBe[a]?t.withTextFontWeight(pBe[a]):"\\emph"===a?"textit"===t.fontShape?t.withTextFontShape("textup"):t.withTextFontShape("textit"):t.withTextFontShape(fBe[a]):t};XNe({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(e,t){var{parser:a,funcName:n}=e,r=t[0];return{type:"text",mode:a.mode,body:ZNe(r),font:n}},htmlBuilder(e,t){var a=mBe(e,t),n=nOe(e.body,a,!0);return UNe.makeSpan(["mord","text"],n,a)},mathmlBuilder(e,t){var a=mBe(e,t);return wOe(e.body,a)}}),XNe({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:a}=e;return{type:"underline",mode:a.mode,body:t[0]}},htmlBuilder(e,t){var a=cOe(e.body,t),n=UNe.makeLineSpan("underline-line",t),r=t.fontMetrics().defaultRuleThickness,i=UNe.makeVList({positionType:"top",positionData:a.height,children:[{type:"kern",size:r},{type:"elem",elem:n},{type:"kern",size:3*r},{type:"elem",elem:a}]},t);return UNe.makeSpan(["mord","underline"],[i],t)},mathmlBuilder(e,t){var a=new mOe.MathNode("mo",[new mOe.TextNode("‾")]);a.setAttribute("stretchy","true");var n=new mOe.MathNode("munder",[_Oe(e.body,t),a]);return n.setAttribute("accentunder","true"),n}}),XNe({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(e,t){var{parser:a}=e;return{type:"vcenter",mode:a.mode,body:t[0]}},htmlBuilder(e,t){var a=cOe(e.body,t),n=t.fontMetrics().axisHeight,r=.5*(a.height-n-(a.depth+n));return UNe.makeVList({positionType:"shift",positionData:r,children:[{type:"elem",elem:a}]},t)},mathmlBuilder:(e,t)=>new mOe.MathNode("mpadded",[_Oe(e.body,t)],["vcenter"])}),XNe({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(e,t,a){throw new YPe("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(e,t){for(var a=vBe(e),n=[],r=t.havingStyle(t.style.text()),i=0;i<a.length;i++){var o=a[i];"~"===o&&(o="\\textasciitilde"),n.push(UNe.makeSymbol(o,"Typewriter-Regular",e.mode,r,["mord","texttt"]))}return UNe.makeSpan(["mord","text"].concat(r.sizingClasses(t)),UNe.tryCombineChars(n),r)},mathmlBuilder(e,t){var a=new mOe.TextNode(vBe(e)),n=new mOe.MathNode("mtext",[a]);return n.setAttribute("mathvariant","monospace"),n}});var vBe=e=>e.body.replace(/ /g,e.star?"␣":" "),gBe=qNe,yBe="[ \r\n\t]",bBe="(\\\\[a-zA-Z@]+)"+yBe+"*",xBe="[̀-ͯ]",wBe=new RegExp(xBe+"+$"),_Be="("+yBe+"+)|\\\\(\n|[ \r\t]+\n?)[ \r\t]*|([!-\\[\\]-‧‪-퟿豈-￿]"+xBe+"*|[\ud800-\udbff][\udc00-\udfff]"+xBe+"*|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5|"+bBe+"|\\\\[^\ud800-\udfff])";class SBe{constructor(e,t){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=t,this.tokenRegex=new RegExp(_Be,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,t){this.catcodes[e]=t}lex(){var e=this.input,t=this.tokenRegex.lastIndex;if(t===e.length)return new qPe("EOF",new WPe(this,t,t));var a=this.tokenRegex.exec(e);if(null===a||a.index!==t)throw new YPe("Unexpected character: '"+e[t]+"'",new qPe(e[t],new WPe(this,t,t+1)));var n=a[6]||a[3]||(a[2]?"\\ ":" ");if(14===this.catcodes[n]){var r=e.indexOf("\n",this.tokenRegex.lastIndex);return-1===r?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=r+1,this.lex()}return new qPe(n,new WPe(this,t,this.tokenRegex.lastIndex))}}class MBe{constructor(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=t,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(0===this.undefStack.length)throw new YPe("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var t in e)e.hasOwnProperty(t)&&(null==e[t]?delete this.current[t]:this.current[t]=e[t])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,t,a){if(void 0===a&&(a=!1),a){for(var n=0;n<this.undefStack.length;n++)delete this.undefStack[n][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=t)}else{var r=this.undefStack[this.undefStack.length-1];r&&!r.hasOwnProperty(e)&&(r[e]=this.current[e])}null==t?delete this.current[e]:this.current[e]=t}}var TBe=EFe;IFe("\\noexpand",function(e){var t=e.popToken();return e.isExpandable(t.text)&&(t.noexpand=!0,t.treatAsRelax=!0),{tokens:[t],numArgs:0}}),IFe("\\expandafter",function(e){var t=e.popToken();return e.expandOnce(!0),{tokens:[t],numArgs:0}}),IFe("\\@firstoftwo",function(e){return{tokens:e.consumeArgs(2)[0],numArgs:0}}),IFe("\\@secondoftwo",function(e){return{tokens:e.consumeArgs(2)[1],numArgs:0}}),IFe("\\@ifnextchar",function(e){var t=e.consumeArgs(3);e.consumeSpaces();var a=e.future();return 1===t[0].length&&t[0][0].text===a.text?{tokens:t[1],numArgs:0}:{tokens:t[2],numArgs:0}}),IFe("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}"),IFe("\\TextOrMath",function(e){var t=e.consumeArgs(2);return"text"===e.mode?{tokens:t[0],numArgs:0}:{tokens:t[1],numArgs:0}});var kBe={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};IFe("\\char",function(e){var t,a=e.popToken(),n="";if("'"===a.text)t=8,a=e.popToken();else if('"'===a.text)t=16,a=e.popToken();else if("`"===a.text)if("\\"===(a=e.popToken()).text[0])n=a.text.charCodeAt(1);else{if("EOF"===a.text)throw new YPe("\\char` missing argument");n=a.text.charCodeAt(0)}else t=10;if(t){if(null==(n=kBe[a.text])||n>=t)throw new YPe("Invalid base-"+t+" digit "+a.text);for(var r;null!=(r=kBe[e.future().text])&&r<t;)n*=t,n+=r,e.popToken()}return"\\@char{"+n+"}"});var CBe=(e,t,a,n)=>{var r=e.consumeArg().tokens;if(1!==r.length)throw new YPe("\\newcommand's first argument must be a macro name");var i=r[0].text,o=e.isDefined(i);if(o&&!t)throw new YPe("\\newcommand{"+i+"} attempting to redefine "+i+"; use \\renewcommand");if(!o&&!a)throw new YPe("\\renewcommand{"+i+"} when command "+i+" does not yet exist; use \\newcommand");var s=0;if(1===(r=e.consumeArg().tokens).length&&"["===r[0].text){for(var l="",c=e.expandNextToken();"]"!==c.text&&"EOF"!==c.text;)l+=c.text,c=e.expandNextToken();if(!l.match(/^\s*[0-9]+\s*$/))throw new YPe("Invalid number of arguments: "+l);s=parseInt(l),r=e.consumeArg().tokens}return o&&n||e.macros.set(i,{tokens:r,numArgs:s}),""};IFe("\\newcommand",e=>CBe(e,!1,!0,!1)),IFe("\\renewcommand",e=>CBe(e,!0,!1,!1)),IFe("\\providecommand",e=>CBe(e,!0,!0,!0)),IFe("\\message",e=>{var t=e.consumeArgs(1)[0];return console.log(t.reverse().map(e=>e.text).join("")),""}),IFe("\\errmessage",e=>{var t=e.consumeArgs(1)[0];return console.error(t.reverse().map(e=>e.text).join("")),""}),IFe("\\show",e=>{var t=e.popToken(),a=t.text;return console.log(t,e.macros.get(a),gBe[a],YLe.math[a],YLe.text[a]),""}),IFe("\\bgroup","{"),IFe("\\egroup","}"),IFe("~","\\nobreakspace"),IFe("\\lq","`"),IFe("\\rq","'"),IFe("\\aa","\\r a"),IFe("\\AA","\\r A"),IFe("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}"),IFe("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}"),IFe("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}"),IFe("ℬ","\\mathscr{B}"),IFe("ℰ","\\mathscr{E}"),IFe("ℱ","\\mathscr{F}"),IFe("ℋ","\\mathscr{H}"),IFe("ℐ","\\mathscr{I}"),IFe("ℒ","\\mathscr{L}"),IFe("ℳ","\\mathscr{M}"),IFe("ℛ","\\mathscr{R}"),IFe("ℭ","\\mathfrak{C}"),IFe("ℌ","\\mathfrak{H}"),IFe("ℨ","\\mathfrak{Z}"),IFe("\\Bbbk","\\Bbb{k}"),IFe("·","\\cdotp"),IFe("\\llap","\\mathllap{\\textrm{#1}}"),IFe("\\rlap","\\mathrlap{\\textrm{#1}}"),IFe("\\clap","\\mathclap{\\textrm{#1}}"),IFe("\\mathstrut","\\vphantom{(}"),IFe("\\underbar","\\underline{\\text{#1}}"),IFe("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}'),IFe("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}"),IFe("\\ne","\\neq"),IFe("≠","\\neq"),IFe("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}"),IFe("∉","\\notin"),IFe("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}"),IFe("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}"),IFe("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}"),IFe("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}"),IFe("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}"),IFe("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}"),IFe("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}"),IFe("⟂","\\perp"),IFe("‼","\\mathclose{!\\mkern-0.8mu!}"),IFe("∌","\\notni"),IFe("⌜","\\ulcorner"),IFe("⌝","\\urcorner"),IFe("⌞","\\llcorner"),IFe("⌟","\\lrcorner"),IFe("©","\\copyright"),IFe("®","\\textregistered"),IFe("️","\\textregistered"),IFe("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}'),IFe("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}'),IFe("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}'),IFe("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}'),IFe("\\vdots","{\\varvdots\\rule{0pt}{15pt}}"),IFe("⋮","\\vdots"),IFe("\\varGamma","\\mathit{\\Gamma}"),IFe("\\varDelta","\\mathit{\\Delta}"),IFe("\\varTheta","\\mathit{\\Theta}"),IFe("\\varLambda","\\mathit{\\Lambda}"),IFe("\\varXi","\\mathit{\\Xi}"),IFe("\\varPi","\\mathit{\\Pi}"),IFe("\\varSigma","\\mathit{\\Sigma}"),IFe("\\varUpsilon","\\mathit{\\Upsilon}"),IFe("\\varPhi","\\mathit{\\Phi}"),IFe("\\varPsi","\\mathit{\\Psi}"),IFe("\\varOmega","\\mathit{\\Omega}"),IFe("\\substack","\\begin{subarray}{c}#1\\end{subarray}"),IFe("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax"),IFe("\\boxed","\\fbox{$\\displaystyle{#1}$}"),IFe("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;"),IFe("\\implies","\\DOTSB\\;\\Longrightarrow\\;"),IFe("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;"),IFe("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}"),IFe("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var ABe={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};IFe("\\dots",function(e){var t="\\dotso",a=e.expandAfterFuture().text;return a in ABe?t=ABe[a]:("\\not"===a.slice(0,4)||a in YLe.math&&["bin","rel"].includes(YLe.math[a].group))&&(t="\\dotsb"),t});var EBe={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};IFe("\\dotso",function(e){return e.future().text in EBe?"\\ldots\\,":"\\ldots"}),IFe("\\dotsc",function(e){var t=e.future().text;return t in EBe&&","!==t?"\\ldots\\,":"\\ldots"}),IFe("\\cdots",function(e){return e.future().text in EBe?"\\@cdots\\,":"\\@cdots"}),IFe("\\dotsb","\\cdots"),IFe("\\dotsm","\\cdots"),IFe("\\dotsi","\\!\\cdots"),IFe("\\dotsx","\\ldots\\,"),IFe("\\DOTSI","\\relax"),IFe("\\DOTSB","\\relax"),IFe("\\DOTSX","\\relax"),IFe("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax"),IFe("\\,","\\tmspace+{3mu}{.1667em}"),IFe("\\thinspace","\\,"),IFe("\\>","\\mskip{4mu}"),IFe("\\:","\\tmspace+{4mu}{.2222em}"),IFe("\\medspace","\\:"),IFe("\\;","\\tmspace+{5mu}{.2777em}"),IFe("\\thickspace","\\;"),IFe("\\!","\\tmspace-{3mu}{.1667em}"),IFe("\\negthinspace","\\!"),IFe("\\negmedspace","\\tmspace-{4mu}{.2222em}"),IFe("\\negthickspace","\\tmspace-{5mu}{.277em}"),IFe("\\enspace","\\kern.5em "),IFe("\\enskip","\\hskip.5em\\relax"),IFe("\\quad","\\hskip1em\\relax"),IFe("\\qquad","\\hskip2em\\relax"),IFe("\\tag","\\@ifstar\\tag@literal\\tag@paren"),IFe("\\tag@paren","\\tag@literal{({#1})}"),IFe("\\tag@literal",e=>{if(e.macros.get("\\df@tag"))throw new YPe("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"}),IFe("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}"),IFe("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)"),IFe("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}"),IFe("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1"),IFe("\\newline","\\\\\\relax"),IFe("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var IBe=ELe(vLe["Main-Regular"]["T".charCodeAt(0)][1]-.7*vLe["Main-Regular"]["A".charCodeAt(0)][1]);IFe("\\LaTeX","\\textrm{\\html@mathml{L\\kern-.36em\\raisebox{"+IBe+"}{\\scriptstyle A}\\kern-.15em\\TeX}{LaTeX}}"),IFe("\\KaTeX","\\textrm{\\html@mathml{K\\kern-.17em\\raisebox{"+IBe+"}{\\scriptstyle A}\\kern-.15em\\TeX}{KaTeX}}"),IFe("\\hspace","\\@ifstar\\@hspacer\\@hspace"),IFe("\\@hspace","\\hskip #1\\relax"),IFe("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax"),IFe("\\ordinarycolon",":"),IFe("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}"),IFe("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}'),IFe("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}'),IFe("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}'),IFe("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}'),IFe("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}'),IFe("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}'),IFe("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}'),IFe("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}'),IFe("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}'),IFe("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}'),IFe("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}'),IFe("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}'),IFe("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}'),IFe("∷","\\dblcolon"),IFe("∹","\\eqcolon"),IFe("≔","\\coloneqq"),IFe("≕","\\eqqcolon"),IFe("⩴","\\Coloneqq"),IFe("\\ratio","\\vcentcolon"),IFe("\\coloncolon","\\dblcolon"),IFe("\\colonequals","\\coloneqq"),IFe("\\coloncolonequals","\\Coloneqq"),IFe("\\equalscolon","\\eqqcolon"),IFe("\\equalscoloncolon","\\Eqqcolon"),IFe("\\colonminus","\\coloneq"),IFe("\\coloncolonminus","\\Coloneq"),IFe("\\minuscolon","\\eqcolon"),IFe("\\minuscoloncolon","\\Eqcolon"),IFe("\\coloncolonapprox","\\Colonapprox"),IFe("\\coloncolonsim","\\Colonsim"),IFe("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),IFe("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}"),IFe("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}"),IFe("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}"),IFe("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}"),IFe("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}"),IFe("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}"),IFe("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}"),IFe("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}"),IFe("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}"),IFe("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}"),IFe("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}"),IFe("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}"),IFe("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}"),IFe("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}"),IFe("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}"),IFe("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}"),IFe("\\nleqq","\\html@mathml{\\@nleqq}{≰}"),IFe("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}"),IFe("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}"),IFe("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}"),IFe("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}"),IFe("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}"),IFe("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}"),IFe("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}"),IFe("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}"),IFe("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}"),IFe("\\imath","\\html@mathml{\\@imath}{ı}"),IFe("\\jmath","\\html@mathml{\\@jmath}{ȷ}"),IFe("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}"),IFe("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}"),IFe("⟦","\\llbracket"),IFe("⟧","\\rrbracket"),IFe("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}"),IFe("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}"),IFe("⦃","\\lBrace"),IFe("⦄","\\rBrace"),IFe("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}"),IFe("⦵","\\minuso"),IFe("\\darr","\\downarrow"),IFe("\\dArr","\\Downarrow"),IFe("\\Darr","\\Downarrow"),IFe("\\lang","\\langle"),IFe("\\rang","\\rangle"),IFe("\\uarr","\\uparrow"),IFe("\\uArr","\\Uparrow"),IFe("\\Uarr","\\Uparrow"),IFe("\\N","\\mathbb{N}"),IFe("\\R","\\mathbb{R}"),IFe("\\Z","\\mathbb{Z}"),IFe("\\alef","\\aleph"),IFe("\\alefsym","\\aleph"),IFe("\\Alpha","\\mathrm{A}"),IFe("\\Beta","\\mathrm{B}"),IFe("\\bull","\\bullet"),IFe("\\Chi","\\mathrm{X}"),IFe("\\clubs","\\clubsuit"),IFe("\\cnums","\\mathbb{C}"),IFe("\\Complex","\\mathbb{C}"),IFe("\\Dagger","\\ddagger"),IFe("\\diamonds","\\diamondsuit"),IFe("\\empty","\\emptyset"),IFe("\\Epsilon","\\mathrm{E}"),IFe("\\Eta","\\mathrm{H}"),IFe("\\exist","\\exists"),IFe("\\harr","\\leftrightarrow"),IFe("\\hArr","\\Leftrightarrow"),IFe("\\Harr","\\Leftrightarrow"),IFe("\\hearts","\\heartsuit"),IFe("\\image","\\Im"),IFe("\\infin","\\infty"),IFe("\\Iota","\\mathrm{I}"),IFe("\\isin","\\in"),IFe("\\Kappa","\\mathrm{K}"),IFe("\\larr","\\leftarrow"),IFe("\\lArr","\\Leftarrow"),IFe("\\Larr","\\Leftarrow"),IFe("\\lrarr","\\leftrightarrow"),IFe("\\lrArr","\\Leftrightarrow"),IFe("\\Lrarr","\\Leftrightarrow"),IFe("\\Mu","\\mathrm{M}"),IFe("\\natnums","\\mathbb{N}"),IFe("\\Nu","\\mathrm{N}"),IFe("\\Omicron","\\mathrm{O}"),IFe("\\plusmn","\\pm"),IFe("\\rarr","\\rightarrow"),IFe("\\rArr","\\Rightarrow"),IFe("\\Rarr","\\Rightarrow"),IFe("\\real","\\Re"),IFe("\\reals","\\mathbb{R}"),IFe("\\Reals","\\mathbb{R}"),IFe("\\Rho","\\mathrm{P}"),IFe("\\sdot","\\cdot"),IFe("\\sect","\\S"),IFe("\\spades","\\spadesuit"),IFe("\\sub","\\subset"),IFe("\\sube","\\subseteq"),IFe("\\supe","\\supseteq"),IFe("\\Tau","\\mathrm{T}"),IFe("\\thetasym","\\vartheta"),IFe("\\weierp","\\wp"),IFe("\\Zeta","\\mathrm{Z}"),IFe("\\argmin","\\DOTSB\\operatorname*{arg\\,min}"),IFe("\\argmax","\\DOTSB\\operatorname*{arg\\,max}"),IFe("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits"),IFe("\\bra","\\mathinner{\\langle{#1}|}"),IFe("\\ket","\\mathinner{|{#1}\\rangle}"),IFe("\\braket","\\mathinner{\\langle{#1}\\rangle}"),IFe("\\Bra","\\left\\langle#1\\right|"),IFe("\\Ket","\\left|#1\\right\\rangle");var RBe=e=>t=>{var a=t.consumeArg().tokens,n=t.consumeArg().tokens,r=t.consumeArg().tokens,i=t.consumeArg().tokens,o=t.macros.get("|"),s=t.macros.get("\\|");t.macros.beginGroup();var l=t=>a=>{e&&(a.macros.set("|",o),r.length&&a.macros.set("\\|",s));var i=t;!t&&r.length&&("|"===a.future().text&&(a.popToken(),i=!0));return{tokens:i?r:n,numArgs:0}};t.macros.set("|",l(!1)),r.length&&t.macros.set("\\|",l(!0));var c=t.consumeArg().tokens,u=t.expandTokens([...i,...c,...a]);return t.macros.endGroup(),{tokens:u.reverse(),numArgs:0}};IFe("\\bra@ket",RBe(!1)),IFe("\\bra@set",RBe(!0)),IFe("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}"),IFe("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}"),IFe("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}"),IFe("\\angln","{\\angl n}"),IFe("\\blue","\\textcolor{##6495ed}{#1}"),IFe("\\orange","\\textcolor{##ffa500}{#1}"),IFe("\\pink","\\textcolor{##ff00af}{#1}"),IFe("\\red","\\textcolor{##df0030}{#1}"),IFe("\\green","\\textcolor{##28ae7b}{#1}"),IFe("\\gray","\\textcolor{gray}{#1}"),IFe("\\purple","\\textcolor{##9d38bd}{#1}"),IFe("\\blueA","\\textcolor{##ccfaff}{#1}"),IFe("\\blueB","\\textcolor{##80f6ff}{#1}"),IFe("\\blueC","\\textcolor{##63d9ea}{#1}"),IFe("\\blueD","\\textcolor{##11accd}{#1}"),IFe("\\blueE","\\textcolor{##0c7f99}{#1}"),IFe("\\tealA","\\textcolor{##94fff5}{#1}"),IFe("\\tealB","\\textcolor{##26edd5}{#1}"),IFe("\\tealC","\\textcolor{##01d1c1}{#1}"),IFe("\\tealD","\\textcolor{##01a995}{#1}"),IFe("\\tealE","\\textcolor{##208170}{#1}"),IFe("\\greenA","\\textcolor{##b6ffb0}{#1}"),IFe("\\greenB","\\textcolor{##8af281}{#1}"),IFe("\\greenC","\\textcolor{##74cf70}{#1}"),IFe("\\greenD","\\textcolor{##1fab54}{#1}"),IFe("\\greenE","\\textcolor{##0d923f}{#1}"),IFe("\\goldA","\\textcolor{##ffd0a9}{#1}"),IFe("\\goldB","\\textcolor{##ffbb71}{#1}"),IFe("\\goldC","\\textcolor{##ff9c39}{#1}"),IFe("\\goldD","\\textcolor{##e07d10}{#1}"),IFe("\\goldE","\\textcolor{##a75a05}{#1}"),IFe("\\redA","\\textcolor{##fca9a9}{#1}"),IFe("\\redB","\\textcolor{##ff8482}{#1}"),IFe("\\redC","\\textcolor{##f9685d}{#1}"),IFe("\\redD","\\textcolor{##e84d39}{#1}"),IFe("\\redE","\\textcolor{##bc2612}{#1}"),IFe("\\maroonA","\\textcolor{##ffbde0}{#1}"),IFe("\\maroonB","\\textcolor{##ff92c6}{#1}"),IFe("\\maroonC","\\textcolor{##ed5fa6}{#1}"),IFe("\\maroonD","\\textcolor{##ca337c}{#1}"),IFe("\\maroonE","\\textcolor{##9e034e}{#1}"),IFe("\\purpleA","\\textcolor{##ddd7ff}{#1}"),IFe("\\purpleB","\\textcolor{##c6b9fc}{#1}"),IFe("\\purpleC","\\textcolor{##aa87ff}{#1}"),IFe("\\purpleD","\\textcolor{##7854ab}{#1}"),IFe("\\purpleE","\\textcolor{##543b78}{#1}"),IFe("\\mintA","\\textcolor{##f5f9e8}{#1}"),IFe("\\mintB","\\textcolor{##edf2df}{#1}"),IFe("\\mintC","\\textcolor{##e0e5cc}{#1}"),IFe("\\grayA","\\textcolor{##f6f7f7}{#1}"),IFe("\\grayB","\\textcolor{##f0f1f2}{#1}"),IFe("\\grayC","\\textcolor{##e3e5e6}{#1}"),IFe("\\grayD","\\textcolor{##d6d8da}{#1}"),IFe("\\grayE","\\textcolor{##babec2}{#1}"),IFe("\\grayF","\\textcolor{##888d93}{#1}"),IFe("\\grayG","\\textcolor{##626569}{#1}"),IFe("\\grayH","\\textcolor{##3b3e40}{#1}"),IFe("\\grayI","\\textcolor{##21242c}{#1}"),IFe("\\kaBlue","\\textcolor{##314453}{#1}"),IFe("\\kaGreen","\\textcolor{##71B307}{#1}");var DBe={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class PBe{constructor(e,t,a){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=t,this.expansionCount=0,this.feed(e),this.macros=new MBe(TBe,t.macros),this.mode=a,this.stack=[]}feed(e){this.lexer=new SBe(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return 0===this.stack.length&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var t,a,n;if(e){if(this.consumeSpaces(),"["!==this.future().text)return null;t=this.popToken(),({tokens:n,end:a}=this.consumeArg(["]"]))}else({tokens:n,start:t,end:a}=this.consumeArg());return this.pushToken(new qPe("EOF",a.loc)),this.pushTokens(n),new qPe("",WPe.range(t,a))}consumeSpaces(){for(;;){if(" "!==this.future().text)break;this.stack.pop()}}consumeArg(e){var t=[],a=e&&e.length>0;a||this.consumeSpaces();var n,r=this.future(),i=0,o=0;do{if(n=this.popToken(),t.push(n),"{"===n.text)++i;else if("}"===n.text){if(-1===--i)throw new YPe("Extra }",n)}else if("EOF"===n.text)throw new YPe("Unexpected end of input in a macro argument, expected '"+(e&&a?e[o]:"}")+"'",n);if(e&&a)if((0===i||1===i&&"{"===e[o])&&n.text===e[o]){if(++o===e.length){t.splice(-o,o);break}}else o=0}while(0!==i||a);return"{"===r.text&&"}"===t[t.length-1].text&&(t.pop(),t.shift()),t.reverse(),{tokens:t,start:r,end:n}}consumeArgs(e,t){if(t){if(t.length!==e+1)throw new YPe("The length of delimiters doesn't match the number of args!");for(var a=t[0],n=0;n<a.length;n++){var r=this.popToken();if(a[n]!==r.text)throw new YPe("Use of the macro doesn't match its definition",r)}}for(var i=[],o=0;o<e;o++)i.push(this.consumeArg(t&&t[o+1]).tokens);return i}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new YPe("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){var t=this.popToken(),a=t.text,n=t.noexpand?null:this._getExpansion(a);if(null==n||e&&n.unexpandable){if(e&&null==n&&"\\"===a[0]&&!this.isDefined(a))throw new YPe("Undefined control sequence: "+a);return this.pushToken(t),!1}this.countExpansion(1);var r=n.tokens,i=this.consumeArgs(n.numArgs,n.delimiters);if(n.numArgs)for(var o=(r=r.slice()).length-1;o>=0;--o){var s=r[o];if("#"===s.text){if(0===o)throw new YPe("Incomplete placeholder at end of macro body",s);if("#"===(s=r[--o]).text)r.splice(o+1,1);else{if(!/^[1-9]$/.test(s.text))throw new YPe("Not a valid argument number",s);r.splice(o,2,...i[+s.text-1])}}}return this.pushTokens(r),r.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(!1===this.expandOnce()){var e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new qPe(e)]):void 0}expandTokens(e){var t=[],a=this.stack.length;for(this.pushTokens(e);this.stack.length>a;)if(!1===this.expandOnce(!0)){var n=this.stack.pop();n.treatAsRelax&&(n.noexpand=!1,n.treatAsRelax=!1),t.push(n)}return this.countExpansion(t.length),t}expandMacroAsText(e){var t=this.expandMacro(e);return t?t.map(e=>e.text).join(""):t}_getExpansion(e){var t=this.macros.get(e);if(null==t)return t;if(1===e.length){var a=this.lexer.catcodes[e];if(null!=a&&13!==a)return}var n="function"==typeof t?t(this):t;if("string"==typeof n){var r=0;if(-1!==n.indexOf("#"))for(var i=n.replace(/##/g,"");-1!==i.indexOf("#"+(r+1));)++r;for(var o=new SBe(n,this.settings),s=[],l=o.lex();"EOF"!==l.text;)s.push(l),l=o.lex();return s.reverse(),{tokens:s,numArgs:r}}return n}isDefined(e){return this.macros.has(e)||gBe.hasOwnProperty(e)||YLe.math.hasOwnProperty(e)||YLe.text.hasOwnProperty(e)||DBe.hasOwnProperty(e)}isExpandable(e){var t=this.macros.get(e);return null!=t?"string"==typeof t||"function"==typeof t||!t.unexpandable:gBe.hasOwnProperty(e)&&!gBe[e].primitive}}var LBe=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,NBe=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g","ʰ":"h","ⁱ":"i","ʲ":"j","ᵏ":"k","ˡ":"l","ᵐ":"m","ⁿ":"n","ᵒ":"o","ᵖ":"p","ʳ":"r","ˢ":"s","ᵗ":"t","ᵘ":"u","ᵛ":"v","ʷ":"w","ˣ":"x","ʸ":"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),OBe={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},FBe={"á":"á","à":"à","ä":"ä","ǟ":"ǟ","ã":"ã","ā":"ā","ă":"ă","ắ":"ắ","ằ":"ằ","ẵ":"ẵ","ǎ":"ǎ","â":"â","ấ":"ấ","ầ":"ầ","ẫ":"ẫ","ȧ":"ȧ","ǡ":"ǡ","å":"å","ǻ":"ǻ","ḃ":"ḃ","ć":"ć","ḉ":"ḉ","č":"č","ĉ":"ĉ","ċ":"ċ","ç":"ç","ď":"ď","ḋ":"ḋ","ḑ":"ḑ","é":"é","è":"è","ë":"ë","ẽ":"ẽ","ē":"ē","ḗ":"ḗ","ḕ":"ḕ","ĕ":"ĕ","ḝ":"ḝ","ě":"ě","ê":"ê","ế":"ế","ề":"ề","ễ":"ễ","ė":"ė","ȩ":"ȩ","ḟ":"ḟ","ǵ":"ǵ","ḡ":"ḡ","ğ":"ğ","ǧ":"ǧ","ĝ":"ĝ","ġ":"ġ","ģ":"ģ","ḧ":"ḧ","ȟ":"ȟ","ĥ":"ĥ","ḣ":"ḣ","ḩ":"ḩ","í":"í","ì":"ì","ï":"ï","ḯ":"ḯ","ĩ":"ĩ","ī":"ī","ĭ":"ĭ","ǐ":"ǐ","î":"î","ǰ":"ǰ","ĵ":"ĵ","ḱ":"ḱ","ǩ":"ǩ","ķ":"ķ","ĺ":"ĺ","ľ":"ľ","ļ":"ļ","ḿ":"ḿ","ṁ":"ṁ","ń":"ń","ǹ":"ǹ","ñ":"ñ","ň":"ň","ṅ":"ṅ","ņ":"ņ","ó":"ó","ò":"ò","ö":"ö","ȫ":"ȫ","õ":"õ","ṍ":"ṍ","ṏ":"ṏ","ȭ":"ȭ","ō":"ō","ṓ":"ṓ","ṑ":"ṑ","ŏ":"ŏ","ǒ":"ǒ","ô":"ô","ố":"ố","ồ":"ồ","ỗ":"ỗ","ȯ":"ȯ","ȱ":"ȱ","ő":"ő","ṕ":"ṕ","ṗ":"ṗ","ŕ":"ŕ","ř":"ř","ṙ":"ṙ","ŗ":"ŗ","ś":"ś","ṥ":"ṥ","š":"š","ṧ":"ṧ","ŝ":"ŝ","ṡ":"ṡ","ş":"ş","ẗ":"ẗ","ť":"ť","ṫ":"ṫ","ţ":"ţ","ú":"ú","ù":"ù","ü":"ü","ǘ":"ǘ","ǜ":"ǜ","ǖ":"ǖ","ǚ":"ǚ","ũ":"ũ","ṹ":"ṹ","ū":"ū","ṻ":"ṻ","ŭ":"ŭ","ǔ":"ǔ","û":"û","ů":"ů","ű":"ű","ṽ":"ṽ","ẃ":"ẃ","ẁ":"ẁ","ẅ":"ẅ","ŵ":"ŵ","ẇ":"ẇ","ẘ":"ẘ","ẍ":"ẍ","ẋ":"ẋ","ý":"ý","ỳ":"ỳ","ÿ":"ÿ","ỹ":"ỹ","ȳ":"ȳ","ŷ":"ŷ","ẏ":"ẏ","ẙ":"ẙ","ź":"ź","ž":"ž","ẑ":"ẑ","ż":"ż","Á":"Á","À":"À","Ä":"Ä","Ǟ":"Ǟ","Ã":"Ã","Ā":"Ā","Ă":"Ă","Ắ":"Ắ","Ằ":"Ằ","Ẵ":"Ẵ","Ǎ":"Ǎ","Â":"Â","Ấ":"Ấ","Ầ":"Ầ","Ẫ":"Ẫ","Ȧ":"Ȧ","Ǡ":"Ǡ","Å":"Å","Ǻ":"Ǻ","Ḃ":"Ḃ","Ć":"Ć","Ḉ":"Ḉ","Č":"Č","Ĉ":"Ĉ","Ċ":"Ċ","Ç":"Ç","Ď":"Ď","Ḋ":"Ḋ","Ḑ":"Ḑ","É":"É","È":"È","Ë":"Ë","Ẽ":"Ẽ","Ē":"Ē","Ḗ":"Ḗ","Ḕ":"Ḕ","Ĕ":"Ĕ","Ḝ":"Ḝ","Ě":"Ě","Ê":"Ê","Ế":"Ế","Ề":"Ề","Ễ":"Ễ","Ė":"Ė","Ȩ":"Ȩ","Ḟ":"Ḟ","Ǵ":"Ǵ","Ḡ":"Ḡ","Ğ":"Ğ","Ǧ":"Ǧ","Ĝ":"Ĝ","Ġ":"Ġ","Ģ":"Ģ","Ḧ":"Ḧ","Ȟ":"Ȟ","Ĥ":"Ĥ","Ḣ":"Ḣ","Ḩ":"Ḩ","Í":"Í","Ì":"Ì","Ï":"Ï","Ḯ":"Ḯ","Ĩ":"Ĩ","Ī":"Ī","Ĭ":"Ĭ","Ǐ":"Ǐ","Î":"Î","İ":"İ","Ĵ":"Ĵ","Ḱ":"Ḱ","Ǩ":"Ǩ","Ķ":"Ķ","Ĺ":"Ĺ","Ľ":"Ľ","Ļ":"Ļ","Ḿ":"Ḿ","Ṁ":"Ṁ","Ń":"Ń","Ǹ":"Ǹ","Ñ":"Ñ","Ň":"Ň","Ṅ":"Ṅ","Ņ":"Ņ","Ó":"Ó","Ò":"Ò","Ö":"Ö","Ȫ":"Ȫ","Õ":"Õ","Ṍ":"Ṍ","Ṏ":"Ṏ","Ȭ":"Ȭ","Ō":"Ō","Ṓ":"Ṓ","Ṑ":"Ṑ","Ŏ":"Ŏ","Ǒ":"Ǒ","Ô":"Ô","Ố":"Ố","Ồ":"Ồ","Ỗ":"Ỗ","Ȯ":"Ȯ","Ȱ":"Ȱ","Ő":"Ő","Ṕ":"Ṕ","Ṗ":"Ṗ","Ŕ":"Ŕ","Ř":"Ř","Ṙ":"Ṙ","Ŗ":"Ŗ","Ś":"Ś","Ṥ":"Ṥ","Š":"Š","Ṧ":"Ṧ","Ŝ":"Ŝ","Ṡ":"Ṡ","Ş":"Ş","Ť":"Ť","Ṫ":"Ṫ","Ţ":"Ţ","Ú":"Ú","Ù":"Ù","Ü":"Ü","Ǘ":"Ǘ","Ǜ":"Ǜ","Ǖ":"Ǖ","Ǚ":"Ǚ","Ũ":"Ũ","Ṹ":"Ṹ","Ū":"Ū","Ṻ":"Ṻ","Ŭ":"Ŭ","Ǔ":"Ǔ","Û":"Û","Ů":"Ů","Ű":"Ű","Ṽ":"Ṽ","Ẃ":"Ẃ","Ẁ":"Ẁ","Ẅ":"Ẅ","Ŵ":"Ŵ","Ẇ":"Ẇ","Ẍ":"Ẍ","Ẋ":"Ẋ","Ý":"Ý","Ỳ":"Ỳ","Ÿ":"Ÿ","Ỹ":"Ỹ","Ȳ":"Ȳ","Ŷ":"Ŷ","Ẏ":"Ẏ","Ź":"Ź","Ž":"Ž","Ẑ":"Ẑ","Ż":"Ż","ά":"ά","ὰ":"ὰ","ᾱ":"ᾱ","ᾰ":"ᾰ","έ":"έ","ὲ":"ὲ","ή":"ή","ὴ":"ὴ","ί":"ί","ὶ":"ὶ","ϊ":"ϊ","ΐ":"ΐ","ῒ":"ῒ","ῑ":"ῑ","ῐ":"ῐ","ό":"ό","ὸ":"ὸ","ύ":"ύ","ὺ":"ὺ","ϋ":"ϋ","ΰ":"ΰ","ῢ":"ῢ","ῡ":"ῡ","ῠ":"ῠ","ώ":"ώ","ὼ":"ὼ","Ύ":"Ύ","Ὺ":"Ὺ","Ϋ":"Ϋ","Ῡ":"Ῡ","Ῠ":"Ῠ","Ώ":"Ώ","Ὼ":"Ὼ"};class BBe{constructor(e,t){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new PBe(e,t,this.mode),this.settings=t,this.leftrightDepth=0}expect(e,t){if(void 0===t&&(t=!0),this.fetch().text!==e)throw new YPe("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());t&&this.consume()}consume(){this.nextToken=null}fetch(){return null==this.nextToken&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var t=this.nextToken;this.consume(),this.gullet.pushToken(new qPe("}")),this.gullet.pushTokens(e);var a=this.parseExpression(!1);return this.expect("}"),this.nextToken=t,a}parseExpression(e,t){for(var a=[];;){"math"===this.mode&&this.consumeSpaces();var n=this.fetch();if(-1!==BBe.endOfExpression.indexOf(n.text))break;if(t&&n.text===t)break;if(e&&gBe[n.text]&&gBe[n.text].infix)break;var r=this.parseAtom(t);if(!r)break;"internal"!==r.type&&a.push(r)}return"text"===this.mode&&this.formLigatures(a),this.handleInfixNodes(a)}handleInfixNodes(e){for(var t,a=-1,n=0;n<e.length;n++)if("infix"===e[n].type){if(-1!==a)throw new YPe("only one infix operator per group",e[n].token);a=n,t=e[n].replaceWith}if(-1!==a&&t){var r,i,o=e.slice(0,a),s=e.slice(a+1);return r=1===o.length&&"ordgroup"===o[0].type?o[0]:{type:"ordgroup",mode:this.mode,body:o},i=1===s.length&&"ordgroup"===s[0].type?s[0]:{type:"ordgroup",mode:this.mode,body:s},["\\\\abovefrac"===t?this.callFunction(t,[r,e[a],i],[]):this.callFunction(t,[r,i],[])]}return e}handleSupSubscript(e){var t,a=this.fetch(),n=a.text;this.consume(),this.consumeSpaces();do{var r;t=this.parseGroup(e)}while("internal"===(null==(r=t)?void 0:r.type));if(!t)throw new YPe("Expected group after '"+n+"'",a);return t}formatUnsupportedCmd(e){for(var t=[],a=0;a<e.length;a++)t.push({type:"textord",mode:"text",text:e[a]});var n={type:"text",mode:this.mode,body:t};return{type:"color",mode:this.mode,color:this.settings.errorColor,body:[n]}}parseAtom(e){var t,a,n=this.parseGroup("atom",e);if("internal"===(null==n?void 0:n.type))return n;if("text"===this.mode)return n;for(;;){this.consumeSpaces();var r=this.fetch();if("\\limits"===r.text||"\\nolimits"===r.text){if(n&&"op"===n.type){var i="\\limits"===r.text;n.limits=i,n.alwaysHandleSupSub=!0}else{if(!n||"operatorname"!==n.type)throw new YPe("Limit controls must follow a math operator",r);n.alwaysHandleSupSub&&(n.limits="\\limits"===r.text)}this.consume()}else if("^"===r.text){if(t)throw new YPe("Double superscript",r);t=this.handleSupSubscript("superscript")}else if("_"===r.text){if(a)throw new YPe("Double subscript",r);a=this.handleSupSubscript("subscript")}else if("'"===r.text){if(t)throw new YPe("Double superscript",r);var o={type:"textord",mode:this.mode,text:"\\prime"},s=[o];for(this.consume();"'"===this.fetch().text;)s.push(o),this.consume();"^"===this.fetch().text&&s.push(this.handleSupSubscript("superscript")),t={type:"ordgroup",mode:this.mode,body:s}}else{if(!NBe[r.text])break;var l=LBe.test(r.text),c=[];for(c.push(new qPe(NBe[r.text])),this.consume();;){var u=this.fetch().text;if(!NBe[u])break;if(LBe.test(u)!==l)break;c.unshift(new qPe(NBe[u])),this.consume()}var d=this.subparse(c);l?a={type:"ordgroup",mode:"math",body:d}:t={type:"ordgroup",mode:"math",body:d}}}return t||a?{type:"supsub",mode:this.mode,base:n,sup:t,sub:a}:n}parseFunction(e,t){var a=this.fetch(),n=a.text,r=gBe[n];if(!r)return null;if(this.consume(),t&&"atom"!==t&&!r.allowedInArgument)throw new YPe("Got function '"+n+"' with no arguments"+(t?" as "+t:""),a);if("text"===this.mode&&!r.allowedInText)throw new YPe("Can't use function '"+n+"' in text mode",a);if("math"===this.mode&&!1===r.allowedInMath)throw new YPe("Can't use function '"+n+"' in math mode",a);var{args:i,optArgs:o}=this.parseArguments(n,r);return this.callFunction(n,i,o,a,e)}callFunction(e,t,a,n,r){var i={funcName:e,parser:this,token:n,breakOnTokenText:r},o=gBe[e];if(o&&o.handler)return o.handler(i,t,a);throw new YPe("No function handler for "+e)}parseArguments(e,t){var a=t.numArgs+t.numOptionalArgs;if(0===a)return{args:[],optArgs:[]};for(var n=[],r=[],i=0;i<a;i++){var o=t.argTypes&&t.argTypes[i],s=i<t.numOptionalArgs;(t.primitive&&null==o||"sqrt"===t.type&&1===i&&null==r[0])&&(o="primitive");var l=this.parseGroupOfType("argument to '"+e+"'",o,s);if(s)r.push(l);else{if(null==l)throw new YPe("Null argument, please report this as a bug");n.push(l)}}return{args:n,optArgs:r}}parseGroupOfType(e,t,a){switch(t){case"color":return this.parseColorGroup(a);case"size":return this.parseSizeGroup(a);case"url":return this.parseUrlGroup(a);case"math":case"text":return this.parseArgumentGroup(a,t);case"hbox":var n=this.parseArgumentGroup(a,"text");return null!=n?{type:"styling",mode:n.mode,body:[n],style:"text"}:null;case"raw":var r=this.parseStringGroup("raw",a);return null!=r?{type:"raw",mode:"text",string:r.text}:null;case"primitive":if(a)throw new YPe("A primitive argument cannot be optional");var i=this.parseGroup(e);if(null==i)throw new YPe("Expected group as "+e,this.fetch());return i;case"original":case null:case void 0:return this.parseArgumentGroup(a);default:throw new YPe("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;" "===this.fetch().text;)this.consume()}parseStringGroup(e,t){var a=this.gullet.scanArgument(t);if(null==a)return null;for(var n,r="";"EOF"!==(n=this.fetch()).text;)r+=n.text,this.consume();return this.consume(),a.text=r,a}parseRegexGroup(e,t){for(var a,n=this.fetch(),r=n,i="";"EOF"!==(a=this.fetch()).text&&e.test(i+a.text);)i+=(r=a).text,this.consume();if(""===i)throw new YPe("Invalid "+t+": '"+n.text+"'",n);return n.range(r,i)}parseColorGroup(e){var t=this.parseStringGroup("color",e);if(null==t)return null;var a=/^(#[a-f0-9]{3,4}|#[a-f0-9]{6}|#[a-f0-9]{8}|[a-f0-9]{6}|[a-z]+)$/i.exec(t.text);if(!a)throw new YPe("Invalid color: '"+t.text+"'",t);var n=a[0];return/^[0-9a-f]{6}$/i.test(n)&&(n="#"+n),{type:"color-token",mode:this.mode,color:n}}parseSizeGroup(e){var t,a=!1;if(this.gullet.consumeSpaces(),!(t=e||"{"===this.gullet.future().text?this.parseStringGroup("size",e):this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size")))return null;e||0!==t.text.length||(t.text="0pt",a=!0);var n=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t.text);if(!n)throw new YPe("Invalid size: '"+t.text+"'",t);var r={number:+(n[1]+n[2]),unit:n[3]};if(!CLe(r))throw new YPe("Invalid unit: '"+r.unit+"'",t);return{type:"size",mode:this.mode,value:r,isBlank:a}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var t=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),null==t)return null;var a=t.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:a}}parseArgumentGroup(e,t){var a=this.gullet.scanArgument(e);if(null==a)return null;var n=this.mode;t&&this.switchMode(t),this.gullet.beginGroup();var r=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var i={type:"ordgroup",mode:this.mode,loc:a.loc,body:r};return t&&this.switchMode(n),i}parseGroup(e,t){var a,n=this.fetch(),r=n.text;if("{"===r||"\\begingroup"===r){this.consume();var i="{"===r?"}":"\\endgroup";this.gullet.beginGroup();var o=this.parseExpression(!1,i),s=this.fetch();this.expect(i),this.gullet.endGroup(),a={type:"ordgroup",mode:this.mode,loc:WPe.range(n,s),body:o,semisimple:"\\begingroup"===r||void 0}}else if(null==(a=this.parseFunction(t,e)||this.parseSymbol())&&"\\"===r[0]&&!DBe.hasOwnProperty(r)){if(this.settings.throwOnError)throw new YPe("Undefined control sequence: "+r,n);a=this.formatUnsupportedCmd(r),this.consume()}return a}formLigatures(e){for(var t=e.length-1,a=0;a<t;++a){var n=e[a],r=n.text;"-"===r&&"-"===e[a+1].text&&(a+1<t&&"-"===e[a+2].text?(e.splice(a,3,{type:"textord",mode:"text",loc:WPe.range(n,e[a+2]),text:"---"}),t-=2):(e.splice(a,2,{type:"textord",mode:"text",loc:WPe.range(n,e[a+1]),text:"--"}),t-=1)),"'"!==r&&"`"!==r||e[a+1].text!==r||(e.splice(a,2,{type:"textord",mode:"text",loc:WPe.range(n,e[a+1]),text:r+r}),t-=1)}}parseSymbol(){var e=this.fetch(),t=e.text;if(/^\\verb[^a-zA-Z]/.test(t)){this.consume();var a=t.slice(5),n="*"===a.charAt(0);if(n&&(a=a.slice(1)),a.length<2||a.charAt(0)!==a.slice(-1))throw new YPe("\\verb assertion failed --\n                    please report what input caused this bug");return{type:"verb",mode:"text",body:a=a.slice(1,-1),star:n}}FBe.hasOwnProperty(t[0])&&!YLe[this.mode][t[0]]&&(this.settings.strict&&"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+t[0]+'" used in math mode',e),t=FBe[t[0]]+t.slice(1));var r,i=wBe.exec(t);if(i&&("i"===(t=t.substring(0,i.index))?t="ı":"j"===t&&(t="ȷ")),YLe[this.mode][t]){this.settings.strict&&"math"===this.mode&&MNe.indexOf(t)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+t[0]+'" used in math mode',e);var o,s=YLe[this.mode][t].group,l=WPe.range(e);if(WLe.hasOwnProperty(s)){var c=s;o={type:"atom",mode:this.mode,family:c,loc:l,text:t}}else o={type:s,mode:this.mode,loc:l,text:t};r=o}else{if(!(t.charCodeAt(0)>=128))return null;this.settings.strict&&(hLe(t.charCodeAt(0))?"math"===this.mode&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+t[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+t[0]+'" ('+t.charCodeAt(0)+")",e)),r={type:"textord",mode:"text",loc:WPe.range(e),text:t}}if(this.consume(),i)for(var u=0;u<i[0].length;u++){var d=i[0][u];if(!OBe[d])throw new YPe("Unknown accent ' "+d+"'",e);var h=OBe[d][this.mode]||OBe[d].text;if(!h)throw new YPe("Accent "+d+" unsupported in "+this.mode+" mode",e);r={type:"accent",mode:this.mode,loc:WPe.range(e),label:h,isStretchy:!1,isShifty:!0,base:r}}return r}}BBe.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var UBe=function(e,t){if(!("string"==typeof e||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var a=new BBe(e,t);delete a.gullet.macros.current["\\df@tag"];var n=a.parse();if(delete a.gullet.macros.current["\\current@color"],delete a.gullet.macros.current["\\color"],a.gullet.macros.get("\\df@tag")){if(!t.displayMode)throw new YPe("\\tag works only in display equations");n=[{type:"tag",mode:"text",body:n,tag:a.subparse([new qPe("\\df@tag")])}]}return n},zBe=function(e,t,a){t.textContent="";var n=HBe(e,a).toNode();t.appendChild(n)};"undefined"!=typeof document&&"CSS1Compat"!==document.compatMode&&("undefined"!=typeof console&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),zBe=function(){throw new YPe("KaTeX doesn't work in quirks mode.")});var VBe=function(e,t,a){if(a.throwOnError||!(e instanceof YPe))throw e;var n=UNe.makeSpan(["katex-error"],[new ULe(t)]);return n.setAttribute("title",e.toString()),n.setAttribute("style","color:"+a.errorColor),n},HBe=function(e,t){var a=new eLe(t);try{return function(e,t,a){var n,r=MOe(a);if("mathml"===a.output)return SOe(e,t,r,a.displayMode,!0);if("html"===a.output){var i=dOe(e,r);n=UNe.makeSpan(["katex"],[i])}else{var o=SOe(e,t,r,a.displayMode,!1),s=dOe(e,r);n=UNe.makeSpan(["katex"],[o,s])}return TOe(n,a)}(UBe(e,a),e,a)}catch(QXe){return VBe(QXe,e,a)}},GBe={version:"0.16.27",render:zBe,renderToString:function(e,t){return HBe(e,t).toMarkup()},ParseError:YPe,SETTINGS_SCHEMA:JPe,__parse:function(e,t){var a=new eLe(t);return UBe(e,a)},__renderToDomTree:HBe,__renderToHTMLTree:function(e,t){var a=new eLe(t);try{return function(e,t,a){var n=dOe(e,MOe(a)),r=UNe.makeSpan(["katex"],[n]);return TOe(r,a)}(UBe(e,a),0,a)}catch(QXe){return VBe(QXe,e,a)}},__setFontMetrics:function(e,t){vLe[e]=t},__defineSymbol:jLe,__defineFunction:XNe,__defineMacro:IFe,__domTree:{Span:NLe,Anchor:OLe,SymbolNode:ULe,SvgNode:zLe,PathNode:VLe,LineNode:HLe}};const WBe={class:"docs-root"},qBe={class:"docs-wrapper"},YBe={class:"docs-layout"},jBe={class:"hero"},XBe={class:"hero-actions"},$Be={class:"tool-grid-wrapper"},KBe={class:"tool-grid"},ZBe={class:"tools-grid"},JBe={class:"content-container"},QBe={key:0,class:"content-section"},eUe={key:1,class:"content-section"},tUe={key:2,class:"content-section"},aUe={key:3,class:"content-section"},nUe={key:4,class:"content-section"},rUe={key:5,class:"content-section"},iUe={key:6,class:"content-section coming-soon-section"},oUe=e({__name:"DocumentationPage",setup(e){x();const a=t("overview"),r=t(null),o=e=>{a.value=e,setTimeout(()=>{r.value?.scrollIntoView({behavior:"smooth",block:"start"}),A(()=>{f()})},100)},p=()=>{r.value?.scrollIntoView({behavior:"smooth",block:"start"})},f=()=>{A(()=>{document.querySelectorAll(".latex-formula").forEach(e=>{if(e instanceof HTMLElement&&!e.dataset.rendered)try{const t=e.textContent||"";GBe.render(t,e,{throwOnError:!1,displayMode:e.classList.contains("display-mode")}),e.dataset.rendered="true"}catch(TQe){console.error("Error rendering formula:",TQe)}})})};return n(()=>{f()}),(e,t)=>{const n=d("router-link");return w(),i("div",WBe,[t[27]||(t[27]=I('<div class="lava-layer" data-v-be540d41><div class="blob blob-1" data-v-be540d41></div><div class="blob blob-2" data-v-be540d41></div><div class="blob blob-3" data-v-be540d41></div><div class="blob blob-4" data-v-be540d41></div><div class="glass-gradient" data-v-be540d41></div></div>',1)),s("div",qBe,[s("div",YBe,[s("section",jBe,[t[9]||(t[9]=s("div",{class:"logo-badge"}," Documentation & Glossary ",-1)),t[10]||(t[10]=s("h1",{class:"hero-title"},[m(" Полная "),s("span",null,"документация"),m(" платформы ")],-1)),t[11]||(t[11]=s("div",{class:"subtitle-frame"},[s("p",{class:"hero-subtitle"}," Руководства, глоссарий терминов, описание архитектуры и математические модели Stochastic Dashboard v1. ")],-1)),s("div",XBe,[u(n,{to:"/",class:"btn primary"},{default:h(()=>[...t[7]||(t[7]=[s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),s("polyline",{points:"13 2 13 9 20 9"})],-1),m(" К платформе ",-1)])]),_:1}),s("button",{class:"btn ghost",onClick:p},[...t[8]||(t[8]=[s("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),s("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})],-1),m(" К контенту ",-1)])])])]),s("section",$Be,[s("div",KBe,[t[19]||(t[19]=s("div",{class:"tools-header"},[s("h2",{class:"tools-title"},"Разделы документации")],-1)),s("div",ZBe,[s("button",{class:c(["tool-card",{active:"overview"===a.value}]),onClick:t[0]||(t[0]=e=>o("overview"))},[...t[12]||(t[12]=[I('<div class="tool-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" data-v-be540d41></path><circle cx="12" cy="12" r="3" data-v-be540d41></circle></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>Обзор платформы</div><div class="tool-desc" data-v-be540d41> Целевые пользователи, функции, технологический стек </div></div>',2)])],2),s("button",{class:c(["tool-card",{active:"architecture"===a.value}]),onClick:t[1]||(t[1]=e=>o("architecture"))},[...t[13]||(t[13]=[I('<div class="tool-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><rect x="3" y="3" width="7" height="7" data-v-be540d41></rect><rect x="14" y="3" width="7" height="7" data-v-be540d41></rect><rect x="14" y="14" width="7" height="7" data-v-be540d41></rect><rect x="3" y="14" width="7" height="7" data-v-be540d41></rect></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>Архитектура системы</div><div class="tool-desc" data-v-be540d41> Структура интерфейса, модули, компоненты и навигация </div></div>',2)])],2),s("button",{class:c(["tool-card",{active:"pages"===a.value}]),onClick:t[2]||(t[2]=e=>o("pages"))},[...t[14]||(t[14]=[I('<div class="tool-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" data-v-be540d41></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" data-v-be540d41></path></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>Страницы приложения</div><div class="tool-desc" data-v-be540d41> 30+ страниц с подробным описанием функционала и методики </div></div>',2)])],2),s("button",{class:c(["tool-card",{active:"glossary"===a.value}]),onClick:t[3]||(t[3]=e=>o("glossary"))},[...t[15]||(t[15]=[I('<div class="tool-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><path d="M10 3H4a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-6" data-v-be540d41></path><path d="M14 3v4" data-v-be540d41></path><path d="M10 12h4" data-v-be540d41></path><path d="M10 16h4" data-v-be540d41></path></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>Глоссарий терминов</div><div class="tool-desc" data-v-be540d41> 40+ определений по портфелям, облигациям, опциям и HMM </div></div>',2)])],2),s("button",{class:c(["tool-card",{active:"models"===a.value}]),onClick:t[4]||(t[4]=e=>o("models"))},[...t[16]||(t[16]=[I('<div class="tool-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><polyline points="12 3 20 7.5 20 16.5 12 21 4 16.5 4 7.5 12 3" data-v-be540d41></polyline><line x1="12" y1="12" x2="20" y2="7.5" data-v-be540d41></line><line x1="12" y1="12" x2="12" y2="21" data-v-be540d41></line><line x1="12" y1="12" x2="4" y2="7.5" data-v-be540d41></line></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>Математические модели</div><div class="tool-desc" data-v-be540d41> VaR/ES, BSM, Heston, Lévy, HMM, DCF, формулы </div></div>',2)])],2),s("button",{class:c(["tool-card",{active:"examples"===a.value}]),onClick:t[5]||(t[5]=e=>o("examples"))},[...t[17]||(t[17]=[I('<div class="tool-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" data-v-be540d41></path><polyline points="14 2 14 8 20 8" data-v-be540d41></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-be540d41></line><line x1="16" y1="17" x2="8" y2="17" data-v-be540d41></line><polyline points="10 9 9 9 8 9" data-v-be540d41></polyline></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>Примеры расчетов</div><div class="tool-desc" data-v-be540d41> Практические примеры использования формул </div></div>',2)])],2),s("button",{class:c(["tool-card coming-soon",{active:"api"===a.value}]),onClick:t[6]||(t[6]=e=>o("api"))},[...t[18]||(t[18]=[I('<div class="tool-icon soon-icon" data-v-be540d41><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-be540d41><polyline points="16 18 22 12 16 6" data-v-be540d41></polyline><polyline points="8 6 2 12 8 18" data-v-be540d41></polyline></svg></div><div class="tool-body" data-v-be540d41><div class="tool-name" data-v-be540d41>REST API Reference</div><div class="tool-desc" data-v-be540d41> Endpoints, методы, примеры запросов и ответов </div><div class="tool-tag" data-v-be540d41>Soon</div></div>',2)])],2)])])])]),s("div",{class:"docs-content",ref_key:"contentRef",ref:r},[s("div",JBe,["overview"===a.value?(w(),i("section",QBe,[...t[20]||(t[20]=[I('<h2 data-v-be540d41>Обзор платформы Stochastic Dashboard</h2><p data-v-be540d41><strong data-v-be540d41>Stochastic Dashboard v1</strong> — комплексная веб-платформа для количественного анализа финансовых инструментов, управления портфельным риском и ценообразования деривативов на базе стохастических моделей и современных методов машинного обучения. </p><h3 data-v-be540d41>Целевые пользователи</h3><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Риск-менеджеры и аналитики</strong> — оценка и мониторинг рисков портфелей, расчет VaR/ES, стресс-тестирование</li><li data-v-be540d41><strong data-v-be540d41>Портфельные менеджеры и трейдеры</strong> — оптимизация портфелей, анализ производительности, бэктестинг стратегий</li><li data-v-be540d41><strong data-v-be540d41>Структурщики и квантовые исследователи</strong> — ценообразование сложных деривативов, анализ Greeks, моделирование волатильности</li><li data-v-be540d41><strong data-v-be540d41>Риск-комитеты и регуляторные отделы</strong> — генерация отчетов, соответствие регуляторным требованиям, анализ стресс-сценариев</li><li data-v-be540d41><strong data-v-be540d41>Аналитики облигаций</strong> — оценка справедливой стоимости, анализ кривых доходности, расчет Duration/DV01</li></ul><h3 data-v-be540d41>Основные функции платформы</h3><div class="features-grid" data-v-be540d41><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Портфельный анализ</h4><ul data-v-be540d41><li data-v-be540d41>Расчет VaR и Expected Shortfall (Historical, Parametric, Cornish-Fisher)</li><li data-v-be540d41>Анализ производительности (Sharpe, Sortino, Calmar Ratio)</li><li data-v-be540d41>Оптимизация портфеля (CCMV, Markowitz, Risk Parity)</li><li data-v-be540d41>Мониторинг позиций и P&amp;L</li><li data-v-be540d41>Анализ корреляций и диверсификации</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>HMM рыночные режимы</h4><ul data-v-be540d41><li data-v-be540d41>Идентификация скрытых рыночных режимов</li><li data-v-be540d41>Матрица переходов между режимами</li><li data-v-be540d41>Прогнозирование вероятностей режимов</li><li data-v-be540d41>Анализ длительности режимов</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Ценообразование деривативов</h4><ul data-v-be540d41><li data-v-be540d41>Black-Scholes-Merton модель</li><li data-v-be540d41>Heston стохастическая волатильность</li><li data-v-be540d41>Lévy процессы и FFT методы</li><li data-v-be540d41>Расчет всех Greeks (Δ, Γ, ν, Θ, ρ)</li><li data-v-be540d41>Поверхность волатильности (volatility surface)</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Оценка облигаций</h4><ul data-v-be540d41><li data-v-be540d41>DCF оценка (Discounted Cash Flow)</li><li data-v-be540d41>Расчет Duration, Modified Duration, DV01</li><li data-v-be540d41>Convexity анализ</li><li data-v-be540d41>Кривые доходности (Yield Curves, ZCYC)</li><li data-v-be540d41>Отчеты по облигациям (Vanilla, Floater)</li><li data-v-be540d41>Работа с реестрами (загрузка/выгрузка XLSX/XLSM)</li><li data-v-be540d41>Получение рыночной доходности из MOEX API</li><li data-v-be540d41>Сохранение реестров в формате Parquet</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Свопы и форварды</h4><ul data-v-be540d41><li data-v-be540d41>Оценка процентных свопов (IRS)</li><li data-v-be540d41>Кредитные дефолтные свопы (CDS)</li><li data-v-be540d41>Валютные свопы (CCS)</li><li data-v-be540d41>Оценка форвардов и анализ базисов</li><li data-v-be540d41>Работа с реестрами (загрузка/выгрузка XLSX)</li><li data-v-be540d41>Сохранение реестров в формате Parquet</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Управление рисками</h4><ul data-v-be540d41><li data-v-be540d41>Стресс-тестирование портфелей</li><li data-v-be540d41>Monte Carlo симуляции</li><li data-v-be540d41>Атрибуция P&amp;L</li><li data-v-be540d41>Хеджирование позиций</li><li data-v-be540d41>Генерация PDF отчетов</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Рыночные данные</h4><ul data-v-be540d41><li data-v-be540d41>Потоковые данные российского рынка</li><li data-v-be540d41>Индексы, акции, облигации, ПИФы</li><li data-v-be540d41>Количественный анализ (3D визуализации)</li><li data-v-be540d41>Manifold learning и анализ ликвидности</li></ul></div><div class="feature-card" data-v-be540d41><h4 data-v-be540d41>Вспомогательные инструменты</h4><ul data-v-be540d41><li data-v-be540d41>Бэктестинг стратегий</li><li data-v-be540d41>Помощник по хеджированию</li><li data-v-be540d41>Работа с реестрами и экспорт данных</li></ul></div></div><h3 data-v-be540d41>Технологический стек</h3><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Frontend:</strong> Vue.js 3, TypeScript, Chart.js, D3.js, Three.js, Plotly.js</li><li data-v-be540d41><strong data-v-be540d41>Стилизация:</strong> Tailwind CSS, кастомные CSS переменные, Apple Vision Pro &quot;Glass&quot; дизайн</li><li data-v-be540d41><strong data-v-be540d41>Математические библиотеки:</strong> Собственные реализации BSM, Heston, Monte Carlo, HMM</li><li data-v-be540d41><strong data-v-be540d41>Визуализация:</strong> 3D графики (Three.js), интерактивные графики (Chart.js, D3.js), поверхности (Plotly.js)</li></ul><h3 data-v-be540d41>Ключевые особенности</h3><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Реальное время:</strong> Обновление данных и расчетов в реальном времени</li><li data-v-be540d41><strong data-v-be540d41>Интерактивность:</strong> Интерактивные графики, детальная информация по клику</li><li data-v-be540d41><strong data-v-be540d41>Профессиональные отчеты:</strong> Генерация PDF отчетов с графиками и таблицами</li><li data-v-be540d41><strong data-v-be540d41>Адаптивный дизайн:</strong> Оптимизация для мобильных устройств и планшетов</li><li data-v-be540d41><strong data-v-be540d41>Расширяемость:</strong> Модульная архитектура, легко добавлять новые функции</li></ul>',10)])])):l("",!0),"architecture"===a.value?(w(),i("section",eUe,[...t[21]||(t[21]=[I('<h2 data-v-be540d41>Архитектура платформы</h2><p data-v-be540d41> Stochastic Dashboard построен на модульной архитектуре с четким разделением функциональности и единообразным интерфейсом для всех страниц. </p><h3 data-v-be540d41>Основные элементы интерфейса</h3><div class="architecture-block" data-v-be540d41><h4 data-v-be540d41>Верхняя панель (Header)</h4><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Логотип и навигация:</strong> Переход на главную страницу, поиск по платформе</li><li data-v-be540d41><strong data-v-be540d41>Поиск (⌘K):</strong> Быстрый поиск страниц, инструментов, активов</li><li data-v-be540d41><strong data-v-be540d41>API статус:</strong> Индикатор подключения к API (API Live / Ping X ms)</li><li data-v-be540d41><strong data-v-be540d41>Уведомления:</strong> Системные уведомления и алерты</li><li data-v-be540d41><strong data-v-be540d41>Профиль пользователя:</strong> Настройки, выход из системы</li></ul></div><div class="architecture-block" data-v-be540d41><h4 data-v-be540d41>Левый сайдбар (Sidebar)</h4><p data-v-be540d41>Иерархическая структура модулей с группировкой по функциональности:</p><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>PORTFOLIO:</strong> Управление портфелем, оптимизация, анализ производительности</li><li data-v-be540d41><strong data-v-be540d41>HMM:</strong> Анализ рыночных режимов, матрица переходов, прогнозирование</li><li data-v-be540d41><strong data-v-be540d41>FIXED INCOME:</strong> Оценка облигаций, кривые доходности, отчеты</li><li data-v-be540d41><strong data-v-be540d41>PRICING:</strong> Ценообразование опционов, сравнение моделей, Greeks</li><li data-v-be540d41><strong data-v-be540d41>VALUATION:</strong> Оценка свопов, форвардов, базисов</li><li data-v-be540d41><strong data-v-be540d41>ANALYTICS:</strong> Аналитика, P&amp;L атрибуция, хеджирование, отчеты</li><li data-v-be540d41><strong data-v-be540d41>DATA:</strong> Рыночные данные, количественный анализ</li></ul></div><div class="architecture-block" data-v-be540d41><h4 data-v-be540d41>Контент-зона (Main Content)</h4><p data-v-be540d41>Стандартная структура страниц:</p><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Заголовок секции:</strong> Название страницы, подзаголовок, кнопки действий</li><li data-v-be540d41><strong data-v-be540d41>KPI карточки:</strong> Ключевые метрики в виде карточек с визуальными индикаторами</li><li data-v-be540d41><strong data-v-be540d41>Параметры управления:</strong> Формы ввода, слайдеры, селекторы</li><li data-v-be540d41><strong data-v-be540d41>Графики и визуализации:</strong> Интерактивные графики, 3D поверхности, тепловые карты</li><li data-v-be540d41><strong data-v-be540d41>Таблицы данных:</strong> Детальная информация в табличном виде</li><li data-v-be540d41><strong data-v-be540d41>Результаты расчетов:</strong> Отформатированные числовые результаты</li></ul></div><h3 data-v-be540d41>Модули платформы</h3><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>PORTFOLIO — Управление портфелем</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /portfolio, /CCMVoptimization, /monte-carlo, /stress, /backtest</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>Мониторинг позиций и P&amp;L в реальном времени</li><li data-v-be540d41>Расчет рисков (VaR, ES, Beta, Sharpe)</li><li data-v-be540d41>Оптимизация весов активов</li><li data-v-be540d41>Monte Carlo симуляции</li><li data-v-be540d41>Стресс-тестирование</li><li data-v-be540d41>Бэктестинг стратегий</li></ul></div><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>HMM — Рыночные режимы</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /regimes, /regime-details</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>Идентификация скрытых рыночных режимов</li><li data-v-be540d41>Обучение HMM модели на исторических данных</li><li data-v-be540d41>Визуализация режимов на временной шкале</li><li data-v-be540d41>Анализ матрицы переходов</li><li data-v-be540d41>Прогнозирование вероятностей режимов</li></ul></div><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>FIXED INCOME — Облигации</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /bond-valuation, /vanila-bond-report, /floater-bond-report, /fixed-income, /zcyc-viewer</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>DCF оценка облигаций</li><li data-v-be540d41>Расчет Duration, DV01, Convexity</li><li data-v-be540d41>Анализ кривых доходности</li><li data-v-be540d41>Генерация отчетов по облигациям</li><li data-v-be540d41>Сравнение с индексами</li></ul></div><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>PRICING — Ценообразование опционов</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /pricing/options, /pricing/options/models, /pricing/options/greeks, /pricing/options/portfolio, /volatility-surface</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>Расчет цены опционов (BSM, Heston, Lévy)</li><li data-v-be540d41>Анализ всех Greeks</li><li data-v-be540d41>Сравнение моделей</li><li data-v-be540d41>Поверхность волатильности</li><li data-v-be540d41>Анализ портфеля опционов</li></ul></div><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>VALUATION — Оценка свопов и форвардов</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /valuation/swaps, /valuation/forwards, /forwards/basis, /forwards/greeks</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>Оценка процентных свопов (IRS)</li><li data-v-be540d41>Кредитные дефолтные свопы (CDS)</li><li data-v-be540d41>Валютные свопы (CCS)</li><li data-v-be540d41>Оценка форвардов</li><li data-v-be540d41>Анализ базисов</li></ul></div><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>ANALYTICS — Аналитика</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /greeks, /reports, /pnl-attribution, /hedging-assistant, /stress/swaps</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>Комплексный анализ рисков</li><li data-v-be540d41>Генерация PDF отчетов</li><li data-v-be540d41>Атрибуция P&amp;L</li><li data-v-be540d41>Помощник по хеджированию</li><li data-v-be540d41>Стресс-тестирование свопов</li></ul></div><div class="module-detail" data-v-be540d41><h4 data-v-be540d41>TERMINAL — Терминал</h4><p data-v-be540d41><strong data-v-be540d41>Страницы:</strong> /terminal</p><p data-v-be540d41><strong data-v-be540d41>Функции:</strong></p><ul data-v-be540d41><li data-v-be540d41>Потоковые данные российского рынка</li><li data-v-be540d41>Индексы, акции, облигации, ПИФы</li><li data-v-be540d41>Количественный анализ (3D визуализации)</li><li data-v-be540d41>Manifold learning и анализ ликвидности</li><li data-v-be540d41>Детальная информация по активам</li></ul></div><h3 data-v-be540d41>Дизайн-система</h3><p data-v-be540d41> Платформа использует единую дизайн-систему &quot;Apple Liquid Glass&quot; с прозрачными стеклянными панелями, размытием фона и современной типографикой. </p><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Цветовая палитра:</strong> Темная тема с акцентами (cyan, green, orange, red)</li><li data-v-be540d41><strong data-v-be540d41>Типографика:</strong> SF Pro / Inter для основного текста, SF Mono для числовых данных</li><li data-v-be540d41><strong data-v-be540d41>Компоненты:</strong> Glass cards, glass panels, glass inputs, glass pills</li><li data-v-be540d41><strong data-v-be540d41>Анимации:</strong> Плавные переходы, hover эффекты, пульсирующие индикаторы</li><li data-v-be540d41><strong data-v-be540d41>Адаптивность:</strong> Оптимизация для мобильных устройств и планшетов</li></ul><h3 data-v-be540d41>Навигация</h3><ul data-v-be540d41><li data-v-be540d41><strong data-v-be540d41>Главная страница (/):</strong> Обзор платформы, быстрый доступ к основным функциям</li><li data-v-be540d41><strong data-v-be540d41>Документация (/docs):</strong> Полная документация по платформе</li><li data-v-be540d41><strong data-v-be540d41>Настройки (/settings):</strong> Конфигурация моделей и параметров</li></ul>',19)])])):l("",!0),"pages"===a.value?(w(),i("section",tUe,[...t[22]||(t[22]=[I('<h2 data-v-be540d41>Страницы приложения и инструкции по использованию</h2><p data-v-be540d41> Платформа содержит 30+ специализированных страниц для анализа портфелей, управления рисками и ценообразования финансовых инструментов. Ниже приведено подробное описание каждой страницы с инструкциями по использованию. </p><h3 data-v-be540d41>Портфельный анализ</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/portfolio — Управление портфелем</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Комплексный анализ портфеля активов с расчетом доходности, рисков и визуализацией позиций.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Просмотрите KPI карточки: Total P&amp;L, VaR 95%, Sharpe Ratio, Diversification</li><li data-v-be540d41>Изучите графики: WAVE_σ.9 Momentum-Volatility Surface, Latent Volatility Surface</li><li data-v-be540d41>Проверьте вкладки метрик: Performance, Risk, Stats</li><li data-v-be540d41>Используйте кнопку &quot;Пересчитать&quot; для обновления данных</li><li data-v-be540d41>Экспортируйте отчет в PDF через кнопку &quot;Экспорт PDF&quot;</li></ol><p data-v-be540d41><strong data-v-be540d41>Ключевые метрики:</strong> NAV, Total P&amp;L, VaR, ES, Sharpe Ratio, Max Drawdown, Correlation</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/CCMVoptimization — Оптимизация портфеля (CCMV)</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Оптимизация весов активов в портфеле по модели Constant Correlation Matrix.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите активы для включения в портфель</li><li data-v-be540d41>Установите целевую доходность или максимальный риск</li><li data-v-be540d41>Нажмите &quot;Оптимизировать&quot; для расчета оптимальных весов</li><li data-v-be540d41>Просмотрите эффективную границу (Efficient Frontier)</li><li data-v-be540d41>Сравните текущий и оптимальный портфели</li></ol><p data-v-be540d41><strong data-v-be540d41>Выходные данные:</strong> Оптимальные веса активов, ожидаемая доходность, волатильность портфеля</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/monte-carlo — Симуляция Монте-Карло</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Генерация стохастических сценариев цен активов по модели Geometric Brownian Motion.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Введите параметры модели: Начальная цена (S₀), Волатильность (σ), Доходность (μ)</li><li data-v-be540d41>Установите временной горизонт (Дней) и количество путей (N)</li><li data-v-be540d41>Нажмите &quot;Запустить симуляцию&quot;</li><li data-v-be540d41>Изучите график распределения цен и статистику (мин, макс, медиана, квантили)</li><li data-v-be540d41>Используйте результаты для оценки вероятности достижения целевой цены</li></ol><p data-v-be540d41><strong data-v-be540d41>Параметры модели:</strong> S₀ — начальная цена, σ — волатильность (%), μ — дрейф (%), T — период (дни), N — количество сценариев</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/stress — Стресс-тестирование портфеля</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Оценка влияния стрессовых сценариев на портфель (шоки цен, волатильности, корреляций).</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите тип стресс-сценария (ценовой шок, волатильность, корреляция)</li><li data-v-be540d41>Установите параметры шока (процент изменения)</li><li data-v-be540d41>Запустите расчет стресс-теста</li><li data-v-be540d41>Просмотрите изменение P&amp;L, VaR, позиций</li><li data-v-be540d41>Экспортируйте отчет о стресс-тестировании</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/backtest — Бэктестинг стратегий</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Тестирование торговых стратегий на исторических данных.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите стратегию (Long/Short, Market Neutral, Momentum)</li><li data-v-be540d41>Установите параметры стратегии (период удержания, фильтры входа/выхода)</li><li data-v-be540d41>Выберите исторический период для тестирования</li><li data-v-be540d41>Запустите бэктест</li><li data-v-be540d41>Изучите метрики производительности: Total Return, Sharpe, Max DD, Win Rate</li></ol></div><h3 data-v-be540d41>Управление рисками</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/greeks — Risk Metrics</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Комплексный анализ рисков портфеля с расчетом VaR, ES и чувствительностей.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите уровень доверия для VaR (95%, 99%)</li><li data-v-be540d41>Установите временной горизонт (1D, 10D, 30D)</li><li data-v-be540d41>Просмотрите KPI: VaR, Expected Shortfall, Бета портфеля, Sharpe Ratio</li><li data-v-be540d41>Изучите матрицу чувствительности к факторам риска</li><li data-v-be540d41>Проверьте распределение P&amp;L и tail risk</li></ol><p data-v-be540d41><strong data-v-be540d41>Метрики:</strong> VaR (Historical/Parametric), ES (CVaR), Beta, Sharpe, Sortino, Correlation Matrix</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/reports — Генерация PDF отчётов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Создание профессиональных PDF отчетов по портфелю, рискам и производительности.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите тип отчета (Portfolio Summary, Risk Report, Performance Analysis)</li><li data-v-be540d41>Настройте параметры отчета (период, уровень детализации)</li><li data-v-be540d41>Выберите разделы для включения</li><li data-v-be540d41>Нажмите &quot;Сгенерировать PDF&quot;</li><li data-v-be540d41>Скачайте готовый отчет</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/stress/swaps — Стресс-тестирование свопов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Оценка влияния стрессовых сценариев на портфель процентных и кредитных свопов.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите портфель свопов для анализа</li><li data-v-be540d41>Установите стресс-сценарии (параллельный сдвиг кривой, изменение спредов)</li><li data-v-be540d41>Запустите расчет</li><li data-v-be540d41>Просмотрите изменение стоимости и P&amp;L по каждому свопу</li></ol></div><h3 data-v-be540d41>Рыночные режимы (HMM)</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/regimes — Анализ HMM режимов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Идентификация скрытых рыночных режимов (low vol, normal, high vol, crisis) с помощью Hidden Markov Model.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите актив или индекс для анализа</li><li data-v-be540d41>Установите количество режимов (обычно 3-5)</li><li data-v-be540d41>Запустите обучение HMM модели</li><li data-v-be540d41>Просмотрите идентифицированные режимы на временной шкале</li><li data-v-be540d41>Изучите параметры каждого режима (средняя доходность, волатильность)</li></ol><p data-v-be540d41><strong data-v-be540d41>Выходные данные:</strong> Идентифицированные режимы, матрица переходов, стационарное распределение, параметры режимов</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/regime-details — Детальная аналитика режимов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Глубокий анализ HMM режимов с матрицей переходов, прогнозами и статистикой.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Изучите матрицу переходов между режимами</li><li data-v-be540d41>Просмотрите ожидаемую длительность каждого режима</li><li data-v-be540d41>Проверьте прогноз вероятностей режимов на следующий период</li><li data-v-be540d41>Анализируйте историческую статистику по каждому режиму</li></ol></div><h3 data-v-be540d41>Облигации (Fixed Income)</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/bond-valuation — DCF оценка облигаций</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Расчет справедливой стоимости облигации методом дисконтирования денежных потоков.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Введите ISIN облигации или выберите из списка</li><li data-v-be540d41>Установите дату оценки</li><li data-v-be540d41>Выберите режим работы: два сценария или рыночная доходность из MOEX</li><li data-v-be540d41>Для режима двух сценариев: введите ставки дисконтирования для двух сценариев (базовый и стрессовый)</li><li data-v-be540d41>Для режима рыночной доходности: включите флажок &quot;Использовать доходность из MOEX API&quot; и нажмите &quot;Загрузить из MOEX&quot; или введите вручную</li><li data-v-be540d41>Загрузите реестр облигаций через кнопку &quot;Загрузить Excel&quot; (формат XLSX или XLSM)</li><li data-v-be540d41>Нажмите &quot;Рассчитать все&quot; для оценки всех облигаций в реестре</li><li data-v-be540d41>Просмотрите результаты: Dirty Price, Clean Price, Duration, DV01, Convexity</li><li data-v-be540d41>Экспортируйте результаты в Excel через кнопку &quot;Выгрузить Excel&quot;</li><li data-v-be540d41>Сохраните реестр в Parquet через кнопку &quot;Сохранить в DB (Parquet)&quot;</li><li data-v-be540d41>Изучите таблицу денежных потоков с дисконт-факторами</li></ol><p data-v-be540d41><strong data-v-be540d41>Выходные данные:</strong> Dirty/Clean Price, Macaulay/Modified Duration, DV01, Convexity, Cash Flows Schedule</p><p data-v-be540d41><strong data-v-be540d41>Работа с реестрами:</strong> Поддерживается загрузка реестров в формате XLSX и XLSM. Реестр должен содержать колонки: ISIN, Дата оценки, Y аналога (%), Y индекса (%), Рыночная доходность (%), Активность рынка, Базис расчета.</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/vanila-bond-report — Отчет по ванильной облигации</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Комплексный отчет по ванильной облигации с графиками, метриками и сравнением с индексами.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Введите ISIN облигации</li><li data-v-be540d41>Просмотрите блоки: Котировка и доходность, Риск-метрики, Активность рынка</li><li data-v-be540d41>Изучите график сравнения с индексами (наведите курсор для деталей)</li><li data-v-be540d41>Проверьте историю котировок на scatter plot (красная точка — основная облигация)</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/floater-bond-report — Отчет по плавающей облигации</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Анализ облигации с плавающей купонной ставкой (floater).</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong> Аналогично ванильной облигации, но с учетом специфики плавающей ставки.</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/fixed-income — Анализ кривых доходности</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Визуализация и анализ кривых доходности (yield curves) для различных классов облигаций.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите тип кривой (государственные, корпоративные, по срокам)</li><li data-v-be540d41>Просмотрите график кривой доходности</li><li data-v-be540d41>Сравните кривые на разные даты</li><li data-v-be540d41>Анализируйте спреды между кривыми</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/zcyc-viewer — Кривая бескупонных доходностей</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Просмотр и анализ кривой бескупонных доходностей (Zero-Coupon Yield Curve, ZCYC).</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите дату для отображения кривой</li><li data-v-be540d41>Просмотрите график ZCYC</li><li data-v-be540d41>Изучите таблицу ставок по срокам</li><li data-v-be540d41>Сравните кривые на разные даты</li></ol></div><h3 data-v-be540d41>Опционы (Options Pricing)</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/pricing/options — Ценообразование опционов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Расчет справедливой стоимости опциона по модели Black-Scholes-Merton и анализ Greeks.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Введите параметры опциона: Spot (S), Strike (K), Волатильность (σ), Безрисковая ставка (r), Время до экспирации (T), Дивидендная доходность (q)</li><li data-v-be540d41>Выберите тип опциона (Call/Put)</li><li data-v-be540d41>Выберите модель (BSM, Heston, Lévy)</li><li data-v-be540d41>Нажмите &quot;Рассчитать&quot;</li><li data-v-be540d41>Просмотрите результаты: Цена опциона, Intrinsic Value, Time Value, все Greeks (Δ, Γ, ν, Θ, ρ)</li><li data-v-be540d41>Изучите матрицу чувствительности к изменениям спота и волатильности</li><li data-v-be540d41>Проверьте график Payoff функции</li></ol><p data-v-be540d41><strong data-v-be540d41>Параметры:</strong> S — текущая цена актива, K — страйк, σ — волатильность (%), r — безрисковая ставка (%), T — время до экспирации (годы), q — дивидендная доходность (%)</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/pricing/options/models — Сравнение моделей</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Сравнение цен опционов, рассчитанных по различным моделям (BSM, Heston, Lévy, FFT).</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Введите базовые параметры опциона</li><li data-v-be540d41>Настройте параметры для каждой модели (если требуется)</li><li data-v-be540d41>Запустите расчет по всем моделям</li><li data-v-be540d41>Сравните цены Call и Put опционов</li><li data-v-be540d41>Изучите различия в Greeks между моделями</li><li data-v-be540d41>Проанализируйте, какая модель лучше подходит для вашего случая</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/pricing/options/greeks — Анализ Greeks</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Детальный анализ чувствительностей опциона (Greeks) и их влияния на P&amp;L.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Введите параметры опциона</li><li data-v-be540d41>Просмотрите значения всех Greeks: Delta, Gamma, Vega, Theta, Rho</li><li data-v-be540d41>Изучите матрицу чувствительности (изменение цены при изменении спота и волатильности)</li><li data-v-be540d41>Проверьте P&amp;L разложение по компонентам Greeks</li><li data-v-be540d41>Используйте для планирования хеджирования</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/pricing/options/portfolio — Портфель опционов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Анализ портфеля опционов с агрегированными рисками и Greeks.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Добавьте опционы в портфель (введите параметры каждого)</li><li data-v-be540d41>Просмотрите агрегированные Greeks портфеля</li><li data-v-be540d41>Проверьте общий P&amp;L и риски</li><li data-v-be540d41>Изучите распределение позиций по страйкам и экспирациям</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/volatility-surface — Поверхность волатильности</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Визуализация 3D поверхности волатильности (implied volatility) по страйкам и экспирациям.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите базовый актив</li><li data-v-be540d41>Просмотрите 3D график поверхности волатильности</li><li data-v-be540d41>Изучите &quot;улыбку волатильности&quot; (volatility smile) и &quot;наклон&quot; (skew)</li><li data-v-be540d41>Используйте для выявления арбитражных возможностей</li></ol></div><h3 data-v-be540d41>Свопы и форварды</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/valuation/swaps — Оценка свопов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Расчет справедливой стоимости процентных (IRS), кредитных (CDS), базисных (Basis) и валютных (CCS) свопов.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите тип свопа (IRS, CDS, Basis, CCS)</li><li data-v-be540d41>Введите параметры свопа: номинал, фиксированная/плавающая ставка, даты платежей</li><li data-v-be540d41>Выберите кривую дисконтирования</li><li data-v-be540d41>Загрузите реестр свопов через кнопку &quot;Загрузить Excel&quot; (формат XLSX)</li><li data-v-be540d41>Нажмите &quot;Рассчитать все&quot; для оценки всех свопов в реестре</li><li data-v-be540d41>Рассчитайте справедливую стоимость</li><li data-v-be540d41>Просмотрите денежные потоки и их приведенную стоимость</li><li data-v-be540d41>Изучите Greeks свопа (DV01, Convexity)</li><li data-v-be540d41>Экспортируйте результаты в Excel через кнопку &quot;Выгрузить Excel&quot;</li><li data-v-be540d41>Сохраните реестр в Parquet через кнопку &quot;Сохранить в DB (Parquet)&quot;</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/valuation/forwards — Оценка форвардов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Расчет справедливой форвардной цены и стоимости форвардного контракта.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите тип форварда (FX, Bond, Commodity, Equity, Rate)</li><li data-v-be540d41>Введите спотовую цену актива</li><li data-v-be540d41>Установите безрисковую ставку и дивидендную доходность</li><li data-v-be540d41>Введите время до экспирации форварда</li><li data-v-be540d41>Загрузите реестр форвардов через кнопку &quot;Загрузить Excel&quot; (формат XLSX)</li><li data-v-be540d41>Нажмите &quot;Рассчитать все&quot; для оценки всех форвардов в реестре</li><li data-v-be540d41>Рассчитайте справедливую форвардную цену</li><li data-v-be540d41>Сравните с рыночной форвардной ценой для выявления арбитража</li><li data-v-be540d41>Экспортируйте результаты в Excel через кнопку &quot;Выгрузить Excel&quot;</li><li data-v-be540d41>Сохраните реестр в Parquet через кнопку &quot;Сохранить в DB (Parquet)&quot;</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/forwards/basis — Анализ спот-форвард базиса</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Анализ разницы между спотовой и форвардной ценой (basis) и выявление арбитражных возможностей.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите актив</li><li data-v-be540d41>Просмотрите график базиса по времени</li><li data-v-be540d41>Изучите факторы, влияющие на базис (стоимость хранения, дивиденды)</li><li data-v-be540d41>Используйте для арбитражных стратегий</li></ol></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/forwards/greeks — Greeks форвардов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Анализ чувствительности форвардных контрактов к изменениям параметров.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong> Аналогично опционам, но для форвардов (Delta, Theta, Rho)</p></div><h3 data-v-be540d41>Рыночные данные и аналитика</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/terminal — Терминал</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Потоковые рыночные данные российского финансового рынка с количественным анализом.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Просмотрите вкладки: &quot;Обзор рынка&quot;, &quot;Акции&quot;, &quot;Облигации&quot;, &quot;ПИФы&quot;, &quot;Количественный анализ&quot;</li><li data-v-be540d41>Используйте поиск для быстрого нахождения актива по тикеру или ISIN</li><li data-v-be540d41>Кликните на актив для просмотра детальной информации (график, стакан заявок)</li><li data-v-be540d41>Во вкладке &quot;Количественный анализ&quot; изучите 3D визуализации ликвидности и волатильности</li><li data-v-be540d41>Просмотрите дашборды: Quant Alpha Terminal, QuantLatent v9.2, Volatility Trading System</li></ol><p data-v-be540d41><strong data-v-be540d41>Функции:</strong> Поиск активов, детальная информация по активам, графики цен (линия/свечи), стакан заявок, количественный анализ</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/yield-analysis — Анализ доходности</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Анализ доходности различных классов активов и сравнение с бенчмарками.</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/basis-analysis — Анализ базисов</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Анализ базисов между различными инструментами и выявление арбитражных возможностей.</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/forward-curve-builder — Построение форвардных кривых</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Построение и анализ форвардных кривых для различных активов.</p></div><h3 data-v-be540d41>Вспомогательные инструменты</h3><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/hedging-assistant — Помощник по хеджированию</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Расчет оптимальных позиций для хеджирования портфеля.</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/analytics/pnl — Атрибуция P&amp;L</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Разложение P&amp;L портфеля по источникам (ценовые движения, волатильность, время, корреляции).</p></div><div class="page-detail-block" data-v-be540d41><h4 data-v-be540d41>/settings — Настройки</h4><p data-v-be540d41><strong data-v-be540d41>Назначение:</strong> Настройка параметров платформы, моделей расчета, валют, единиц измерения.</p><p data-v-be540d41><strong data-v-be540d41>Как использовать:</strong></p><ol data-v-be540d41><li data-v-be540d41>Выберите модель оптимизации портфеля (Markowitz, Black-Litterman, Risk Parity, HRP)</li><li data-v-be540d41>Выберите модель VaR (Historical, Parametric, Cornish-Fisher, GPD)</li><li data-v-be540d41>Настройте валюту и единицы измерения</li><li data-v-be540d41>Сохраните настройки</li></ol></div>',41)])])):l("",!0),"glossary"===a.value?(w(),i("section",aUe,[...t[23]||(t[23]=[I('<h2 id="glossary" data-v-be540d41>Глоссарий терминов</h2><h3 data-v-be540d41>Портфельные метрики и риск</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>TOTAL P&amp;L</dt><dd data-v-be540d41>Совокупная прибыль/убыток портфеля за выбранный период, выраженная в процентах и абсолютном значении. Включает реализованную и нереализованную прибыль.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>NAV (Net Asset Value)</dt><dd data-v-be540d41>Чистая стоимость активов — текущая совокупная стоимость портфеля с учётом рыночной переоценки всех позиций. NAV = Σ (Количество × Текущая цена) - Обязательства.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>VaR (Value at Risk)</dt><dd data-v-be540d41>Максимальный ожидаемый убыток портфеля на заданном уровне доверия (обычно 95% или 99%) и временном горизонте (1 день, 10 дней). Например, VaR 95% = -2.5% означает, что с вероятностью 95% убыток не превысит 2.5%.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>ES / CVaR (Expected Shortfall / Conditional VaR)</dt><dd data-v-be540d41>Средний убыток при сценариях, превышающих VaR на том же уровне доверия. Более консервативная метрика tail-risk, учитывающая экстремальные события.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Sharpe Ratio</dt><dd data-v-be540d41>Отношение избыточной доходности портфеля (над безрисковой ставкой) к его волатильности. SR = (R<sub data-v-be540d41>p</sub> - R<sub data-v-be540d41>f</sub>) / σ<sub data-v-be540d41>p</sub>. Показывает доходность на единицу риска.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Sortino Ratio</dt><dd data-v-be540d41>Аналогичен Sharpe Ratio, но учитывает только downside deviation (волатильность отрицательных доходностей). Более точная метрика для оценки управления рисками.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Max Drawdown</dt><dd data-v-be540d41>Максимальная просадка портфеля от пика до минимума в рассматриваемом периоде. Показывает максимальный понесенный убыток от исторического максимума.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Calmar Ratio</dt><dd data-v-be540d41>Отношение годовой доходности к максимальной просадке. Calmar = Annual Return / |Max Drawdown|. Показывает эффективность восстановления после просадок.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Beta (β)</dt><dd data-v-be540d41>Мера чувствительности портфеля к движениям рынка (бенчмарка). β = 1 означает движение вместе с рынком, β &gt; 1 — более волатильный, β &lt; 1 — менее волатильный.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Correlation</dt><dd data-v-be540d41>Мера линейной зависимости между доходностями двух активов. Значения от -1 до +1. +1 — полная положительная корреляция, -1 — полная отрицательная, 0 — отсутствие корреляции.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Diversification</dt><dd data-v-be540d41>Снижение риска портфеля за счет включения некоррелированных активов. Измеряется коэффициентом диверсификации (1 - корреляция портфеля).</dd></div></div><h3 data-v-be540d41>Облигационные метрики</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>DCF (Discounted Cash Flow)</dt><dd data-v-be540d41>Метод оценки справедливой стоимости инструмента дисконтированием ожидаемых будущих денежных потоков по соответствующей ставке дисконтирования.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Dirty Price</dt><dd data-v-be540d41>Полная стоимость облигации, включающая накопленный купонный доход (Accrued Interest). Dirty Price = Clean Price + Accrued Interest.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Clean Price</dt><dd data-v-be540d41>Котировочная цена облигации без учета накопленного купонного дохода. Цена, по которой облигация котируется на рынке.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Accrued Interest</dt><dd data-v-be540d41>Накопленный купонный доход с момента последней выплаты купона до даты расчета. AI = Coupon × (Days since last coupon / Days in coupon period).</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Duration (Macaulay Duration)</dt><dd data-v-be540d41>Взвешенный по приведенной стоимости срок до получения денежных потоков. Показывает средний срок жизни облигации. D = Σ[tᵢ × PV(CFᵢ)] / P.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Modified Duration</dt><dd data-v-be540d41>Модифицированная дюрация, показывающая процентное изменение цены при изменении доходности на 1%. D<sub data-v-be540d41>mod</sub> = D / (1 + y).</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>DV01 (Рублевая стоимость 1 базисного пункта)</dt><dd data-v-be540d41>Изменение стоимости облигации в денежных единицах при сдвиге кривой доходности на 1 basis point (0.01%). DV01 = -P × D<sub data-v-be540d41>mod</sub> × 0.0001.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Convexity</dt><dd data-v-be540d41>Вторая производная цены облигации по доходности. Уточняет оценку изменения цены при крупных сдвигах ставок, учитывая нелинейность зависимости. C = Σ[tᵢ(tᵢ + 1) × PV(CFᵢ)] / [P × (1 + y)²].</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Yield to Maturity (YTM)</dt><dd data-v-be540d41>Доходность к погашению — внутренняя норма доходности облигации при удержании до погашения. Ставка дисконтирования, при которой текущая стоимость денежных потоков равна цене облигации.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>ZCYC (Zero-Coupon Yield Curve)</dt><dd data-v-be540d41>Кривая бескупонных доходностей — кривая ставок дисконтирования для бескупонных облигаций различных сроков погашения. Основа для оценки всех облигаций.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Spread</dt><dd data-v-be540d41>Разница между доходностью облигации и безрисковой ставкой (обычно ОФЗ). Измеряет кредитный риск и ликвидность. Spread = YTM<sub data-v-be540d41>bond</sub> - YTM<sub data-v-be540d41>risk-free</sub>.</dd></div></div><h3 data-v-be540d41>Опционные метрики (Greeks)</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Delta (Δ)</dt><dd data-v-be540d41>Первая производная цены опциона по спотовой цене базового актива. Показывает изменение цены опциона при изменении спота на 1 пункт. Для Call: Δ = e<sup data-v-be540d41>-qT</sup>N(d₁), для Put: Δ = -e<sup data-v-be540d41>-qT</sup>N(-d₁). Диапазон для Call: 0 до 1, для Put: -1 до 0.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Gamma (Γ)</dt><dd data-v-be540d41>Вторая производная цены опциона по споту, или первая производная Delta. Показывает скорость изменения Delta при движении спота. Γ = e<sup data-v-be540d41>-qT</sup>n(d₁) / (Sσ√T). Максимальна для опционов &quot;at-the-money&quot;.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Vega (ν)</dt><dd data-v-be540d41>Производная цены опциона по волатильности. Показывает изменение цены опциона при изменении волатильности на 1 процентный пункт. ν = S₀e<sup data-v-be540d41>-qT</sup>n(d₁)√T / 100. Всегда положительна для длинных позиций.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Theta (Θ)</dt><dd data-v-be540d41>Производная цены опциона по времени (временной распад). Показывает изменение цены опциона при уменьшении времени до экспирации на 1 день. Обычно отрицательна (опцион теряет стоимость со временем).</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Rho (ρ)</dt><dd data-v-be540d41>Производная цены опциона по безрисковой процентной ставке. Показывает изменение цены опциона при изменении ставки на 1 процентный пункт. Для Call: ρ = KTe<sup data-v-be540d41>-rT</sup>N(d₂) / 100, для Put: отрицательна.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Intrinsic Value</dt><dd data-v-be540d41>Внутренняя стоимость опциона — разница между текущей ценой актива и страйком (для Call: max(S - K, 0), для Put: max(K - S, 0)). Минимальная стоимость опциона.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Time Value</dt><dd data-v-be540d41>Временная стоимость опциона — разница между рыночной ценой опциона и его внутренней стоимостью. Time Value = Option Price - Intrinsic Value. Убывает по мере приближения к экспирации.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Moneyness</dt><dd data-v-be540d41>Отношение текущей цены актива к страйку опциона. In-the-money (ITM): Call при S &gt; K, Put при S &lt; K. At-the-money (ATM): S ≈ K. Out-of-the-money (OTM): Call при S &lt; K, Put при S &gt; K.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Volatility Smile</dt><dd data-v-be540d41>Явление, при котором подразумеваемая волатильность (implied volatility) варьируется в зависимости от страйка. График напоминает улыбку, отсюда название.</dd></div></div><h3 data-v-be540d41>HMM и рыночные режимы</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>HMM (Hidden Markov Model)</dt><dd data-v-be540d41>Стохастическая модель с невидимыми состояниями (скрытые режимы) и наблюдаемыми доходностями. Каждое состояние характеризуется своими параметрами распределения (средняя, волатильность).</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Рыночные режимы (Market Regimes)</dt><dd data-v-be540d41>Дискретные скрытые состояния рынка (например: low volatility, normal, high volatility, crisis), управляющие динамикой наблюдаемых доходностей. Каждый режим имеет свои характеристики.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Матрица переходов (Transition Matrix)</dt><dd data-v-be540d41>Матрица вероятностей перехода между режимами за один временной шаг. A<sub data-v-be540d41>ij</sub> = P(S<sub data-v-be540d41>t+1</sub> = j | S<sub data-v-be540d41>t</sub> = i). Сумма по строке равна 1.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Стационарное распределение (Stationary Distribution)</dt><dd data-v-be540d41>Долгосрочное распределение вероятностей режимов, не изменяющееся со временем. Решение системы π = π × A. Показывает долю времени, проводимого в каждом режиме.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Ожидаемая длительность режима</dt><dd data-v-be540d41>Среднее время пребывания в режиме перед переходом в другой. Рассчитывается как 1 / (1 - A<sub data-v-be540d41>ii</sub>), где A<sub data-v-be540d41>ii</sub> — вероятность остаться в режиме i.</dd></div></div><h3 data-v-be540d41>Стохастические модели</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Geometric Brownian Motion (GBM)</dt><dd data-v-be540d41>Стохастический процесс для моделирования цен активов: dS = μS dt + σS dW, где μ — дрейф, σ — волатильность, dW — винеровский процесс. Основа модели Black-Scholes.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Wiener Process (Brownian Motion)</dt><dd data-v-be540d41>Случайный процесс с независимыми нормально распределенными приращениями. dW ~ N(0, dt). Основа стохастического исчисления.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Monte Carlo Simulation</dt><dd data-v-be540d41>Метод численного моделирования, использующий случайные числа для генерации множества сценариев. Применяется для оценки сложных финансовых инструментов и портфелей.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Stochastic Volatility</dt><dd data-v-be540d41>Модели, в которых волатильность сама является случайным процессом (например, Heston модель). Позволяют моделировать volatility smile и динамику волатильности.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Lévy Process</dt><dd data-v-be540d41>Обобщённые стохастические процессы с толстыми хвостами (heavy tails) и скачками (jumps). Включают нормальное распределение как частный случай.</dd></div></div><h3 data-v-be540d41>Свопы и форварды</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>IRS (Interest Rate Swap)</dt><dd data-v-be540d41>Процентный своп — соглашение об обмене фиксированной процентной ставки на плавающую (или наоборот) на определенный номинал в течение срока действия.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>CDS (Credit Default Swap)</dt><dd data-v-be540d41>Кредитный дефолтный своп — соглашение о защите от дефолта эмитента. Покупатель CDS платит премию и получает компенсацию при дефолте.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Basis Swap</dt><dd data-v-be540d41>Базисный своп — обмен одной плавающей ставки на другую (например, LIBOR на EURIBOR) на одинаковый номинал.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>CCS (Cross-Currency Swap)</dt><dd data-v-be540d41>Валютный своп — обмен процентных платежей в одной валюте на платежи в другой валюте, часто с обменом номиналов в начале и конце.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Forward Price</dt><dd data-v-be540d41>Справедливая форвардная цена актива: F = S₀ × e<sup data-v-be540d41>(r - q)T</sup>, где S₀ — спотовая цена, r — безрисковая ставка, q — дивидендная доходность, T — время до экспирации.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Basis</dt><dd data-v-be540d41>Разница между спотовой и форвардной ценой. Basis = Spot - Forward. Может быть положительным (contango) или отрицательным (backwardation).</dd></div></div><h3 data-v-be540d41>Количественный анализ и визуализация</h3><div class="glossary-terms" data-v-be540d41><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Manifold Learning</dt><dd data-v-be540d41>Класс алгоритмов машинного обучения для обнаружения низкоразмерной структуры в высокоразмерных данных. Применяется для анализа рыночной микроструктуры.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Liquidity Surface</dt><dd data-v-be540d41>3D визуализация ликвидности рынка как функции различных параметров (flow pressure, time evolution). Используется для детекции стресса ликвидности.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Signal Matrix</dt><dd data-v-be540d41>Тепловая карта (heatmap) сигналов количественной модели, показывающая временные паттерны и интенсивность сигналов по различным измерениям.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Order Book (Стакан заявок)</dt><dd data-v-be540d41>Список заявок на покупку (bids) и продажу (asks) актива с указанием цен и объемов. Показывает текущую ликвидность и спред.</dd></div><div class="glossary-item" data-v-be540d41><dt data-v-be540d41>Spread</dt><dd data-v-be540d41>Разница между лучшей ценой покупки (best bid) и лучшей ценой продажи (best ask) в стакане заявок. Мера ликвидности и транзакционных издержек.</dd></div></div>',15)])])):l("",!0),"models"===a.value?(w(),i("section",nUe,[...t[24]||(t[24]=[I('<h2 data-v-be540d41>Математические модели и формулы</h2><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Value at Risk (VaR) &amp; Expected Shortfall (ES)</h3><p data-v-be540d41><strong data-v-be540d41>VaR (Value at Risk)</strong> — максимальный ожидаемый убыток портфеля на заданном уровне доверия α и горизонте времени T. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>VaR (Historical Simulation):</div><div class="latex-formula display-mode" data-v-be540d41>\\text{VaR}_\\alpha = -\\text{Quantile}_\\alpha(\\text{Returns})</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>\\text{Quantile}_\\alpha</span> — α-квантиль исторических доходностей портфеля</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>VaR (Parametric, Normal):</div><div class="latex-formula display-mode" data-v-be540d41>\\text{VaR}_\\alpha = -\\mu - z_\\alpha \\times \\sigma \\times \\sqrt{T}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>\\mu</span> — средняя доходность, <span class="latex-formula" data-v-be540d41>\\sigma</span> — волатильность, <span class="latex-formula" data-v-be540d41>z_\\alpha</span> — квантиль нормального распределения (1.645 для 95%, 2.326 для 99%)</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Expected Shortfall (CVaR):</div><div class="latex-formula display-mode" data-v-be540d41>\\text{ES}_\\alpha = \\mathbb{E}[\\text{Loss} \\mid \\text{Loss} \\geq \\text{VaR}_\\alpha]</div><p class="formula-desc" data-v-be540d41>Средний убыток при сценариях, превышающих VaR. Более консервативная метрика tail-risk.</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/greeks</code> — расчет VaR/ES для портфеля. Страница <code data-v-be540d41>/portfolio</code> — отображение VaR в KPI.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Black–Scholes–Merton (BSM) Model</h3><p data-v-be540d41> Классическая модель ценообразования европейских опционов на базе логнормального распределения доходностей базового актива. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Цена Call опциона:</div><div class="latex-formula display-mode" data-v-be540d41>C = S_0 e^{-qT} N(d_1) - K e^{-rT} N(d_2)</div></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Цена Put опциона:</div><div class="latex-formula display-mode" data-v-be540d41>P = K e^{-rT} N(-d_2) - S_0 e^{-qT} N(-d_1)</div></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Вспомогательные переменные:</div><div class="latex-formula display-mode" data-v-be540d41>d_1 = \\frac{\\ln(S_0/K) + (r - q + \\sigma^2/2)T}{\\sigma\\sqrt{T}}</div><div class="latex-formula display-mode" data-v-be540d41>d_2 = d_1 - \\sigma\\sqrt{T}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>S_0</span> — текущая цена актива, <span class="latex-formula" data-v-be540d41>K</span> — страйк, <span class="latex-formula" data-v-be540d41>r</span> — безрисковая ставка, <span class="latex-formula" data-v-be540d41>q</span> — дивидендная доходность, <span class="latex-formula" data-v-be540d41>\\sigma</span> — волатильность, <span class="latex-formula" data-v-be540d41>T</span> — время до экспирации, <span class="latex-formula" data-v-be540d41>N(\\cdot)</span> — функция стандартного нормального распределения</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Greeks (чувствительности):</div><div class="latex-formula display-mode" data-v-be540d41>\\Delta = \\frac{\\partial C}{\\partial S} = e^{-qT} N(d_1) \\quad \\text{(для Call)}</div><div class="latex-formula display-mode" data-v-be540d41>\\Gamma = \\frac{\\partial^2 C}{\\partial S^2} = \\frac{e^{-qT} n(d_1)}{S\\sigma\\sqrt{T}}</div><div class="latex-formula display-mode" data-v-be540d41>\\nu = \\frac{\\partial C}{\\partial \\sigma} = \\frac{S_0 e^{-qT} n(d_1)\\sqrt{T}}{100}</div><div class="latex-formula display-mode" data-v-be540d41>\\Theta = \\frac{\\partial C}{\\partial T} = -\\frac{S_0 e^{-qT} n(d_1)\\sigma/(2\\sqrt{T}) + qS_0 e^{-qT} N(d_1) - rK e^{-rT} N(d_2)}{365}</div><div class="latex-formula display-mode" data-v-be540d41>\\rho = \\frac{\\partial C}{\\partial r} = \\frac{K T e^{-rT} N(d_2)}{100} \\quad \\text{(для Call)}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>n(\\cdot)</span> — плотность стандартного нормального распределения</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/pricing/options</code> — расчет цены и Greeks. Страница <code data-v-be540d41>/pricing/options/greeks</code> — детальный анализ чувствительностей.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Heston Stochastic Volatility Model</h3><p data-v-be540d41> Модель со стохастической волатильностью, позволяющая моделировать улыбку волатильности (volatility smile) и корреляцию между ценой и волатильностью. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Система стохастических уравнений:</div><div class="latex-formula display-mode" data-v-be540d41>dS = \\mu S \\, dt + \\sqrt{V} S \\, dW_1</div><div class="latex-formula display-mode" data-v-be540d41>dV = \\kappa(\\theta - V) \\, dt + \\sigma_v \\sqrt{V} \\, dW_2</div><div class="latex-formula display-mode" data-v-be540d41>\\mathbb{E}[dW_1 \\, dW_2] = \\rho \\, dt</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>V</span> — мгновенная дисперсия, <span class="latex-formula" data-v-be540d41>\\kappa</span> — скорость возврата к среднему (mean reversion), <span class="latex-formula" data-v-be540d41>\\theta</span> — долгосрочная дисперсия, <span class="latex-formula" data-v-be540d41>\\sigma_v</span> — волатильность волатильности, <span class="latex-formula" data-v-be540d41>\\rho</span> — корреляция между ценой и волатильностью</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/pricing/options/models</code> — сравнение BSM и Heston моделей.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Geometric Brownian Motion (GBM)</h3><p data-v-be540d41> Стохастический процесс для моделирования цен активов в Monte Carlo симуляциях. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Стохастическое дифференциальное уравнение:</div><div class="latex-formula display-mode" data-v-be540d41>dS = \\mu S \\, dt + \\sigma S \\, dW</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>\\mu</span> — дрейф (drift), <span class="latex-formula" data-v-be540d41>\\sigma</span> — волатильность, <span class="latex-formula" data-v-be540d41>dW</span> — винеровский процесс</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Дискретная аппроксимация (Euler scheme):</div><div class="latex-formula display-mode" data-v-be540d41>S_{t+\\Delta t} = S_t \\times \\exp\\left[(\\mu - \\sigma^2/2)\\Delta t + \\sigma\\sqrt{\\Delta t} \\times Z\\right]</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>Z \\sim \\mathcal{N}(0,1)</span> — стандартная нормальная случайная величина, <span class="latex-formula" data-v-be540d41>\\Delta t</span> — временной шаг</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/monte-carlo</code> — генерация сценариев цен. Страница <code data-v-be540d41>/terminal</code> — симуляция в Quant Alpha Terminal.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>DCF Bond Valuation (Discounted Cash Flow)</h3><p data-v-be540d41> Оценка справедливой стоимости облигации дисконтированием будущих денежных потоков (купоны + номинал). </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Dirty Price (полная стоимость):</div><div class="latex-formula display-mode" data-v-be540d41>P_{\\text{dirty}} = \\sum_{i=1}^{n} \\frac{CF_i}{(1 + r_i)^{t_i}}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>CF_i</span> — денежный поток в момент <span class="latex-formula" data-v-be540d41>t_i</span>, <span class="latex-formula" data-v-be540d41>r_i</span> — ставка дисконтирования для периода i, <span class="latex-formula" data-v-be540d41>n</span> — количество платежей</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Clean Price (котировочная цена):</div><div class="latex-formula display-mode" data-v-be540d41>P_{\\text{clean}} = P_{\\text{dirty}} - \\text{Accrued Interest}</div><p class="formula-desc" data-v-be540d41><span class="latex-formula" data-v-be540d41>\\text{Accrued Interest} = \\text{Coupon} \\times \\frac{\\text{Days since last coupon}}{\\text{Days in coupon period}}</span></p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Macaulay Duration:</div><div class="latex-formula display-mode" data-v-be540d41>D = \\frac{\\sum_{i=1}^{n} t_i \\times \\text{PV}(CF_i)}{P_{\\text{dirty}}}</div><p class="formula-desc" data-v-be540d41>Взвешенный по приведенной стоимости срок до получения денежных потоков</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Modified Duration:</div><div class="latex-formula display-mode" data-v-be540d41>D_{\\text{mod}} = \\frac{D}{1 + y}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>y</span> — доходность к погашению. Показывает процентное изменение цены при изменении доходности на 1%</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>DV01 (Рублевая стоимость 1 б.п.):</div><div class="latex-formula display-mode" data-v-be540d41>\\text{DV01} = -P \\times D_{\\text{mod}} \\times 0.0001</div><p class="formula-desc" data-v-be540d41>Изменение стоимости облигации при сдвиге кривой доходности на 1 basis point (0.01%)</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Convexity:</div><div class="latex-formula display-mode" data-v-be540d41>C = \\frac{\\sum_{i=1}^{n} t_i(t_i + 1) \\times \\text{PV}(CF_i)}{P \\times (1 + y)^2}</div><p class="formula-desc" data-v-be540d41>Вторая производная цены по доходности, уточняет оценку изменения цены при крупных сдвигах ставок</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/bond-valuation</code> — расчет DCF, Duration, DV01, Convexity. Страницы <code data-v-be540d41>/vanila-bond-report</code> и <code data-v-be540d41>/floater-bond-report</code> — отчеты по облигациям.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Sharpe Ratio &amp; Risk-Adjusted Returns</h3><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Sharpe Ratio:</div><div class="latex-formula display-mode" data-v-be540d41>\\text{SR} = \\frac{R_p - R_f}{\\sigma_p}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>R_p</span> — средняя доходность портфеля, <span class="latex-formula" data-v-be540d41>R_f</span> — безрисковая ставка, <span class="latex-formula" data-v-be540d41>\\sigma_p</span> — волатильность портфеля. Показывает избыточную доходность на единицу риска</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Sortino Ratio:</div><div class="latex-formula display-mode" data-v-be540d41>\\text{Sortino} = \\frac{R_p - R_f}{\\sigma_{\\text{down}}}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>\\sigma_{\\text{down}}</span> — волатильность отрицательных доходностей (downside deviation). Учитывает только негативный риск</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Calmar Ratio:</div><div class="latex-formula display-mode" data-v-be540d41>\\text{Calmar} = \\frac{\\text{Annual Return}}{|\\text{Max Drawdown}|}</div><p class="formula-desc" data-v-be540d41>Отношение годовой доходности к максимальной просадке</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/portfolio</code> — отображение Sharpe Ratio в KPI. Страница <code data-v-be540d41>/greeks</code> — детальные метрики риска.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Hidden Markov Model (HMM)</h3><p data-v-be540d41> Модель с невидимыми состояниями (рыночные режимы), управляющими динамикой наблюдаемых доходностей. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Вероятность наблюдения:</div><div class="latex-formula display-mode" data-v-be540d41>P(O_t \\mid S_t = i) \\sim \\mathcal{N}(\\mu_i, \\sigma_i^2)</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>O_t</span> — наблюдаемая доходность в момент t, <span class="latex-formula" data-v-be540d41>S_t</span> — скрытое состояние (режим), <span class="latex-formula" data-v-be540d41>\\mu_i</span> и <span class="latex-formula" data-v-be540d41>\\sigma_i</span> — параметры нормального распределения для режима i</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Матрица переходов:</div><div class="latex-formula display-mode" data-v-be540d41>A_{ij} = P(S_{t+1} = j \\mid S_t = i)</div><p class="formula-desc" data-v-be540d41>Вероятность перехода из режима i в режим j за один временной шаг</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Стационарное распределение:</div><div class="latex-formula display-mode" data-v-be540d41>\\pi = \\pi \\times A</div><p class="formula-desc" data-v-be540d41>Долгосрочное распределение вероятностей режимов, решение системы линейных уравнений</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/regimes</code> — анализ HMM режимов. Страница <code data-v-be540d41>/regime-details</code> — детальная аналитика режимов.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Portfolio Optimization (CCMV)</h3><p data-v-be540d41> Constant Correlation Matrix Model — упрощенная модель оптимизации портфеля с постоянной корреляцией между активами. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Ожидаемая доходность портфеля:</div><div class="latex-formula display-mode" data-v-be540d41>\\mathbb{E}[R_p] = \\sum_{i=1}^{n} w_i \\times \\mathbb{E}[R_i]</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>w_i</span> — вес актива i в портфеле, <span class="latex-formula" data-v-be540d41>\\mathbb{E}[R_i]</span> — ожидаемая доходность актива i</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Волатильность портфеля:</div><div class="latex-formula display-mode" data-v-be540d41>\\sigma_p = \\sqrt{\\sum_{i,j} w_i w_j \\sigma_i \\sigma_j \\rho_{ij}}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>\\sigma_i</span> — волатильность актива i, <span class="latex-formula" data-v-be540d41>\\rho_{ij}</span> — корреляция между активами i и j</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/CCMVoptimization</code> — оптимизация весов портфеля.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Swap Valuation (IRS)</h3><p data-v-be540d41> Оценка справедливой стоимости процентного свопа (Interest Rate Swap) методом дисконтирования денежных потоков. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Стоимость свопа (для получателя фиксированной ставки):</div><div class="latex-formula display-mode" data-v-be540d41>V_{\\text{swap}} = \\text{PV}_{\\text{fixed}} - \\text{PV}_{\\text{floating}}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>\\text{PV}_{\\text{fixed}} = \\sum_i [\\text{Fixed Rate} \\times \\text{Notional} \\times \\text{DF}_i]</span>, <span class="latex-formula" data-v-be540d41>\\text{PV}_{\\text{floating}} = \\text{Notional} \\times (1 - \\text{DF}_n)</span></p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/valuation/swaps</code> — оценка IRS, CDS, Basis, CCS свопов.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Forward Valuation</h3><p data-v-be540d41> Оценка справедливой форвардной цены и стоимости форвардного контракта. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Форвардная цена (без дивидендов):</div><div class="latex-formula display-mode" data-v-be540d41>F = S_0 \\times e^{(r - q)T}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>S_0</span> — спотовая цена, <span class="latex-formula" data-v-be540d41>r</span> — безрисковая ставка, <span class="latex-formula" data-v-be540d41>q</span> — дивидендная доходность, <span class="latex-formula" data-v-be540d41>T</span> — время до экспирации</p></div><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Стоимость форварда (для длинной позиции):</div><div class="latex-formula display-mode" data-v-be540d41>V = (F - K) \\times e^{-rT}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>K</span> — форвардная цена контракта</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/valuation/forwards</code> — оценка форвардов. Страница <code data-v-be540d41>/forwards/basis</code> — анализ спот-форвард базиса.</p></div><div class="model-block" data-v-be540d41><h3 data-v-be540d41>Manifold Learning &amp; Liquidity Surface</h3><p data-v-be540d41> Нестационарный manifold inference для детекции стресса ликвидности на основе топологии рыночной микроструктуры. </p><div class="formula-block" data-v-be540d41><div class="formula-title" data-v-be540d41>Параметрическая поверхность ликвидности:</div><div class="latex-formula display-mode" data-v-be540d41>z(x,y,t) = \\text{FlowPressure} \\times \\sin(r \\times f + t) \\times \\cos(\\theta \\times 3 + t \\times 0.5) \\times \\text{Liquidity} + \\text{TimeEffect}</div><p class="formula-desc" data-v-be540d41>где <span class="latex-formula" data-v-be540d41>r = \\sqrt{x^2 + y^2}</span>, <span class="latex-formula" data-v-be540d41>\\theta = \\text{atan2}(y, x)</span>, <span class="latex-formula" data-v-be540d41>f</span> — частота, <span class="latex-formula" data-v-be540d41>t</span> — время эволюции</p></div><p data-v-be540d41><strong data-v-be540d41>Использование:</strong> Страница <code data-v-be540d41>/terminal</code> → вкладка &quot;Количественный анализ&quot; — 3D визуализация поверхности ликвидности.</p></div>',12)])])):l("",!0),"examples"===a.value?(w(),i("section",rUe,[...t[25]||(t[25]=[I('<h2 data-v-be540d41>Примеры расчетов</h2><p data-v-be540d41> Практические примеры использования формул и моделей платформы с пошаговыми расчетами. </p><div class="example-block" data-v-be540d41><h3 data-v-be540d41>Пример 1: Расчет цены Call опциона (Black-Scholes)</h3><p data-v-be540d41><strong data-v-be540d41>Условия:</strong></p><ul data-v-be540d41><li data-v-be540d41>Текущая цена актива (S₀): 100 ₽</li><li data-v-be540d41>Страйк (K): 105 ₽</li><li data-v-be540d41>Волатильность (σ): 20%</li><li data-v-be540d41>Безрисковая ставка (r): 8%</li><li data-v-be540d41>Время до экспирации (T): 0.25 года (3 месяца)</li><li data-v-be540d41>Дивидендная доходность (q): 2%</li></ul><p data-v-be540d41><strong data-v-be540d41>Решение:</strong></p><ol data-v-be540d41><li data-v-be540d41>Рассчитываем d₁: <div class="formula" data-v-be540d41>d₁ = [ln(100/105) + (0.08 - 0.02 + 0.2²/2) × 0.25] / (0.2 × √0.25)</div><div class="formula" data-v-be540d41>d₁ = [-0.0488 + 0.015] / 0.1 = -0.338</div></li><li data-v-be540d41>Рассчитываем d₂: <div class="formula" data-v-be540d41>d₂ = -0.338 - 0.2 × √0.25 = -0.438</div></li><li data-v-be540d41>Находим N(d₁) и N(d₂) из таблицы нормального распределения: <div class="formula" data-v-be540d41>N(d₁) = N(-0.338) ≈ 0.368</div><div class="formula" data-v-be540d41>N(d₂) = N(-0.438) ≈ 0.331</div></li><li data-v-be540d41>Рассчитываем цену Call опциона: <div class="formula" data-v-be540d41>C = 100 × e<sup data-v-be540d41>-0.02×0.25</sup> × 0.368 - 105 × e<sup data-v-be540d41>-0.08×0.25</sup> × 0.331</div><div class="formula" data-v-be540d41>C = 36.6 - 33.9 = 2.7 ₽</div></li></ol><p data-v-be540d41><strong data-v-be540d41>Использование в платформе:</strong> Страница <code data-v-be540d41>/pricing/options</code> — введите параметры и получите результат автоматически.</p></div><div class="example-block" data-v-be540d41><h3 data-v-be540d41>Пример 2: Расчет VaR портфеля (Parametric)</h3><p data-v-be540d41><strong data-v-be540d41>Условия:</strong></p><ul data-v-be540d41><li data-v-be540d41>Текущая стоимость портфеля: 1,000,000 ₽</li><li data-v-be540d41>Средняя дневная доходность (μ): 0.1%</li><li data-v-be540d41>Волатильность портфеля (σ): 1.5%</li><li data-v-be540d41>Уровень доверия: 95% (z₀.₀₅ = 1.645)</li><li data-v-be540d41>Временной горизонт: 1 день</li></ul><p data-v-be540d41><strong data-v-be540d41>Решение:</strong></p><div class="formula" data-v-be540d41>VaR<sub data-v-be540d41>95%</sub> = -μ - z<sub data-v-be540d41>α</sub> × σ × √T</div><div class="formula" data-v-be540d41>VaR<sub data-v-be540d41>95%</sub> = -0.001 - 1.645 × 0.015 × √1</div><div class="formula" data-v-be540d41>VaR<sub data-v-be540d41>95%</sub> = -0.001 - 0.0247 = -0.0257 = -2.57%</div><p data-v-be540d41>В абсолютном выражении:</p><div class="formula" data-v-be540d41>VaR = 1,000,000 × 0.0257 = 25,700 ₽</div><p data-v-be540d41><strong data-v-be540d41>Интерпретация:</strong> С вероятностью 95% убыток портфеля за 1 день не превысит 25,700 ₽.</p><p data-v-be540d41><strong data-v-be540d41>Использование в платформе:</strong> Страница <code data-v-be540d41>/greeks</code> — выберите &quot;Parametric&quot; модель VaR.</p></div><div class="example-block" data-v-be540d41><h3 data-v-be540d41>Пример 3: Расчет Duration облигации</h3><p data-v-be540d41><strong data-v-be540d41>Условия:</strong></p><ul data-v-be540d41><li data-v-be540d41>Номинал облигации: 1,000 ₽</li><li data-v-be540d41>Купон: 50 ₽ (выплачивается раз в полгода)</li><li data-v-be540d41>Срок до погашения: 3 года (6 купонных периодов)</li><li data-v-be540d41>Доходность к погашению: 6% годовых (3% за полгода)</li></ul><p data-v-be540d41><strong data-v-be540d41>Решение:</strong></p><ol data-v-be540d41><li data-v-be540d41>Рассчитываем денежные потоки и их приведенную стоимость: <table class="example-table" data-v-be540d41><thead data-v-be540d41><tr data-v-be540d41><th data-v-be540d41>Период</th><th data-v-be540d41>Денежный поток</th><th data-v-be540d41>DF (3%)</th><th data-v-be540d41>PV</th><th data-v-be540d41>t × PV</th></tr></thead><tbody data-v-be540d41><tr data-v-be540d41><td data-v-be540d41>1</td><td data-v-be540d41>50</td><td data-v-be540d41>0.971</td><td data-v-be540d41>48.5</td><td data-v-be540d41>48.5</td></tr><tr data-v-be540d41><td data-v-be540d41>2</td><td data-v-be540d41>50</td><td data-v-be540d41>0.943</td><td data-v-be540d41>47.2</td><td data-v-be540d41>94.4</td></tr><tr data-v-be540d41><td data-v-be540d41>3</td><td data-v-be540d41>50</td><td data-v-be540d41>0.915</td><td data-v-be540d41>45.8</td><td data-v-be540d41>137.4</td></tr><tr data-v-be540d41><td data-v-be540d41>4</td><td data-v-be540d41>50</td><td data-v-be540d41>0.888</td><td data-v-be540d41>44.4</td><td data-v-be540d41>177.6</td></tr><tr data-v-be540d41><td data-v-be540d41>5</td><td data-v-be540d41>50</td><td data-v-be540d41>0.863</td><td data-v-be540d41>43.2</td><td data-v-be540d41>216.0</td></tr><tr data-v-be540d41><td data-v-be540d41>6</td><td data-v-be540d41>1,050</td><td data-v-be540d41>0.838</td><td data-v-be540d41>879.9</td><td data-v-be540d41>5,279.4</td></tr><tr class="total-row" data-v-be540d41><td data-v-be540d41><strong data-v-be540d41>Итого</strong></td><td data-v-be540d41></td><td data-v-be540d41></td><td data-v-be540d41><strong data-v-be540d41>1,109.0</strong></td><td data-v-be540d41><strong data-v-be540d41>5,953.3</strong></td></tr></tbody></table></li><li data-v-be540d41>Рассчитываем Macaulay Duration: <div class="formula" data-v-be540d41>D = Σ(tᵢ × PVᵢ) / P = 5,953.3 / 1,109.0 = 5.37 полугодий = 2.69 лет</div></li><li data-v-be540d41>Рассчитываем Modified Duration: <div class="formula" data-v-be540d41>D<sub data-v-be540d41>mod</sub> = D / (1 + y) = 5.37 / 1.03 = 5.21</div></li><li data-v-be540d41>Рассчитываем DV01: <div class="formula" data-v-be540d41>DV01 = -P × D<sub data-v-be540d41>mod</sub> × 0.0001 = -1,109 × 5.21 × 0.0001 = -0.58 ₽</div></li></ol><p data-v-be540d41><strong data-v-be540d41>Интерпретация:</strong> При увеличении доходности на 1 bp (0.01%) цена облигации снизится на 0.58 ₽.</p><p data-v-be540d41><strong data-v-be540d41>Использование в платформе:</strong> Страница <code data-v-be540d41>/bond-valuation</code> — введите параметры облигации и получите все метрики автоматически.</p></div><div class="example-block" data-v-be540d41><h3 data-v-be540d41>Пример 4: Monte Carlo симуляция цены актива</h3><p data-v-be540d41><strong data-v-be540d41>Условия:</strong></p><ul data-v-be540d41><li data-v-be540d41>Начальная цена (S₀): 100 ₽</li><li data-v-be540d41>Дрейф (μ): 10% годовых</li><li data-v-be540d41>Волатильность (σ): 25% годовых</li><li data-v-be540d41>Период: 30 дней</li><li data-v-be540d41>Количество сценариев: 10,000</li></ul><p data-v-be540d41><strong data-v-be540d41>Алгоритм:</strong></p><ol data-v-be540d41><li data-v-be540d41>Для каждого сценария генерируем случайное число Z ~ N(0,1)</li><li data-v-be540d41>Рассчитываем цену через 30 дней: <div class="formula" data-v-be540d41>S<sub data-v-be540d41>30</sub> = 100 × exp[(0.10 - 0.25²/2) × (30/365) + 0.25 × √(30/365) × Z]</div></li><li data-v-be540d41>Повторяем 10,000 раз</li><li data-v-be540d41>Анализируем распределение: медиана, квантили, вероятность достижения целевой цены</li></ol><p data-v-be540d41><strong data-v-be540d41>Использование в платформе:</strong> Страница <code data-v-be540d41>/monte-carlo</code> — введите параметры и запустите симуляцию.</p></div><div class="example-block" data-v-be540d41><h3 data-v-be540d41>Пример 5: Расчет Sharpe Ratio</h3><p data-v-be540d41><strong data-v-be540d41>Условия:</strong></p><ul data-v-be540d41><li data-v-be540d41>Средняя годовая доходность портфеля: 15%</li><li data-v-be540d41>Безрисковая ставка: 5%</li><li data-v-be540d41>Волатильность портфеля: 12%</li></ul><p data-v-be540d41><strong data-v-be540d41>Решение:</strong></p><div class="formula" data-v-be540d41>Sharpe Ratio = (R<sub data-v-be540d41>p</sub> - R<sub data-v-be540d41>f</sub>) / σ<sub data-v-be540d41>p</sub></div><div class="formula" data-v-be540d41>Sharpe Ratio = (0.15 - 0.05) / 0.12 = 0.833</div><p data-v-be540d41><strong data-v-be540d41>Интерпретация:</strong> Портфель генерирует 0.833 единицы избыточной доходности на единицу риска. Значение выше 1 считается хорошим, выше 2 — отличным.</p><p data-v-be540d41><strong data-v-be540d41>Использование в платформе:</strong> Страница <code data-v-be540d41>/portfolio</code> — Sharpe Ratio отображается в KPI карточке.</p></div>',7)])])):l("",!0),"api"===a.value?(w(),i("section",iUe,[...t[26]||(t[26]=[s("h2",null,"REST API Reference",-1),s("p",{style:{"text-align":"center","font-size":"18px",color:"rgba(255, 255, 255, 0.6)"}}," 📋 Документация API скоро будет доступна ",-1)])])):l("",!0)])],512)])])}}}),sUe=xe(oUe,[["__scopeId","data-v-be540d41"]]),lUe=[{id:"options",name:"ОПЦИОНЫ",description:"Ценообразование опционов, греки, модели волатильности",color:"#22c55e",longDescription:"Раздел посвящён ценообразованию опционов с использованием классических и современных моделей: Black-Scholes, Heston, Merton, SABR. Включает расчёт греков (чувствительностей) и анализ портфеля опционов."},{id:"bonds",name:"ОБЛИГАЦИИ",description:"Оценка облигаций, дюрация, кривые доходности",color:"#3b82f6",longDescription:"Инструменты для оценки облигаций методом дисконтированных денежных потоков, расчёта дюрации, выпуклости, DV01. Поддержка фиксированных и плавающих купонов, интеграция с MOEX."},{id:"swaps",name:"СВОПЫ И ФОРВАРДЫ",description:"IRS, CDS, форварды, базисный анализ",color:"#f59e0b",longDescription:"Оценка процентных свопов (IRS), кредитных дефолтных свопов (CDS), валютных свопов и форвардных контрактов. Анализ базиса и построение форвардных кривых."},{id:"risk",name:"РИСК-МЕНЕДЖМЕНТ",description:"VaR, стресс-тесты, хеджирование",color:"#ef4444",longDescription:"Комплексный анализ рисков портфеля: Value-at-Risk, Expected Shortfall, стресс-тестирование. Инструменты для построения хеджей и атрибуции P&L."},{id:"simulation",name:"СИМУЛЯЦИИ",description:"Monte Carlo, бэктестинг, сценарии",color:"#8b5cf6",longDescription:"Стохастическое моделирование с использованием Monte Carlo симуляций на основе геометрического броуновского движения. Бэктестинг торговых стратегий."},{id:"regimes",name:"РЕЖИМЫ РЫНКА",description:"HMM, спектральный анализ, переходы",color:"#06b6d4",longDescription:"Определение рыночных режимов с помощью скрытых марковских моделей (HMM). Анализ матриц переходов, стационарных распределений и спектральных свойств."},{id:"portfolio",name:"ПОРТФЕЛЬ",description:"Оптимизация, аллокация, метрики",color:"#ec4899",longDescription:"Управление портфелем активов: оптимизация по Марковицу, HJB-оптимизация, расчёт Sharpe Ratio, анализ диверсификации и корреляций."},{id:"terminal",name:"ТЕРМИНАЛ",description:"Потоковые данные, количественный анализ",color:"#f97316",longDescription:"Торговый терминал с потоковыми данными в реальном времени. Продвинутые 3D-визуализации: поверхности волатильности, фазовое пространство, модели ликвидности."}],cUe=[{id:"bsm",code:"BSM",title:"Модель Блэка-Шоулза",category:"options",path:"/pricing/options",description:"Классическая модель ценообразования европейских опционов, разработанная Фишером Блэком и Майроном Шоулзом в 1973 году. Предполагает логнормальное распределение цены базового актива и постоянную волатильность.",formula:"C = S₀·N(d₁) - K·e^(-rT)·N(d₂)",formulaExplanation:"Где:\n• C — цена колл-опциона\n• S₀ — текущая цена базового актива\n• K — страйк (цена исполнения)\n• r — безрисковая ставка\n• T — время до экспирации (в годах)\n• N(x) — функция стандартного нормального распределения\n• d₁ = [ln(S₀/K) + (r + σ²/2)T] / (σ√T)\n• d₂ = d₁ - σ√T\n• σ — волатильность базового актива\n\nДля пут-опциона: P = K·e^(-rT)·N(-d₂) - S₀·N(-d₁)",features:["Расчёт цены Call и Put опционов","Поддержка дивидендной доходности","Расчёт всех греков (Δ, Γ, ν, Θ, ρ)","Implied Volatility калькулятор","Batch-расчёт из Excel"],howToUse:["Введите параметры: S₀ (цена актива), K (страйк), T (срок), r (ставка), σ (волатильность)","Выберите тип опциона: Call или Put",'Нажмите "Рассчитать" для получения цены и греков',"Используйте IV калькулятор для определения подразумеваемой волатильности по рыночной цене"],relatedItems:["greeks","heston","volsurf"]},{id:"heston",code:"HEST",title:"Модель Хестона",category:"options",path:"/pricing/options/models",description:'Модель стохастической волатильности, где волатильность сама является случайным процессом. Позволяет воспроизводить "улыбку волатильности" и эффект левериджа.',formula:"dSₜ = μSₜdt + √Vₜ·Sₜ·dW₁\ndVₜ = κ(θ - Vₜ)dt + ξ√Vₜ·dW₂",formulaExplanation:"Система стохастических дифференциальных уравнений:\n\n• Sₜ — цена базового актива\n• Vₜ — мгновенная дисперсия (σ² = V)\n• μ — дрифт цены актива\n• κ — скорость возврата волатильности к среднему\n• θ — долгосрочный уровень дисперсии\n• ξ — волатильность волатильности (vol of vol)\n• ρ — корреляция между dW₁ и dW₂ (обычно отрицательная)\n• dW₁, dW₂ — коррелированные винеровские процессы\n\nУсловие Феллера: 2κθ > ξ² гарантирует V > 0",features:["Стохастическая волатильность","Воспроизведение улыбки волатильности","Эффект левериджа (отрицательная корреляция)","Mean-reversion волатильности","Калибровка на рыночные данные"],howToUse:["Задайте базовые параметры опциона (S, K, T, r)","Настройте параметры Хестона: V₀, κ, θ, ξ, ρ","Сравните цену с BSM для оценки влияния стохастической волатильности","Используйте для pricing опционов с длинными сроками"],relatedItems:["bsm","sabr","volsurf"]},{id:"greeks",code:"GREEK",title:"Греки опционов",category:"options",path:"/option-greeks-analyzer",description:"Греки — это частные производные цены опциона по различным параметрам. Они показывают чувствительность цены к изменению входных параметров и используются для управления рисками.",formula:"Δ = ∂C/∂S, Γ = ∂²C/∂S², ν = ∂C/∂σ, Θ = ∂C/∂t, ρ = ∂C/∂r",formulaExplanation:"Основные греки для BSM:\n\n• Delta (Δ) = N(d₁) для Call, N(d₁)-1 для Put\n  Изменение цены опциона при изменении базового актива на $1\n\n• Gamma (Γ) = N'(d₁) / (S·σ·√T)\n  Скорость изменения дельты, \"выпуклость\" опциона\n\n• Vega (ν) = S·√T·N'(d₁)\n  Чувствительность к изменению волатильности на 1%\n\n• Theta (Θ) = -S·N'(d₁)·σ/(2√T) - r·K·e^(-rT)·N(d₂)\n  Временной распад, потеря стоимости за 1 день\n\n• Rho (ρ) = K·T·e^(-rT)·N(d₂) для Call\n  Чувствительность к изменению процентной ставки",features:["Расчёт всех 5 основных греков","P&L сценарный анализ","Матрица чувствительности (ΔS × Δσ)","Декомпозиция P&L по грекам","Визуализация профиля греков"],howToUse:["Введите параметры опциона или выберите из портфеля","Просмотрите значения греков в карточках KPI","Используйте сценарный анализ для оценки P&L при изменении S или σ","Изучите матрицу чувствительности для понимания рисков"],relatedItems:["bsm","portfolio-greeks","hedging"]},{id:"merton",code:"MERT",title:"Модель Мертона (Jump Diffusion)",category:"options",path:"/pricing/options/models",description:'Расширение модели Блэка-Шоулза с добавлением скачков цены (jumps). Позволяет моделировать резкие движения рынка и "толстые хвосты" распределения доходностей.',formula:"dSₜ = (μ - λk)Sₜdt + σSₜdWₜ + Sₜ(e^J - 1)dNₜ",formulaExplanation:"Компоненты модели:\n\n• dWₜ — стандартное броуновское движение\n• dNₜ — пуассоновский процесс с интенсивностью λ\n• J — размер скачка, J ~ N(μⱼ, σⱼ²)\n• k = E[e^J - 1] = e^(μⱼ + σⱼ²/2) - 1\n• λ — среднее количество скачков в год\n\nЦена опциона вычисляется как сумма:\nC = Σₙ (e^(-λT)(λT)ⁿ/n!) · BSM(Sₙ, σₙ)\n\nгде σₙ² = σ² + nσⱼ²/T",features:["Моделирование скачков цены","Толстые хвосты распределения","Калибровка интенсивности скачков","Сравнение с BSM","Распределение размера скачков"],howToUse:["Задайте параметры диффузии (σ) и скачков (λ, μⱼ, σⱼ)","Сравните цену с BSM для оценки премии за скачки","Используйте для опционов на активы с редкими резкими движениями"],relatedItems:["bsm","bates","variance-gamma"]},{id:"sabr",code:"SABR",title:"Модель SABR",category:"options",path:"/volatility-surface",description:"Stochastic Alpha Beta Rho — модель для описания динамики улыбки волатильности. Широко используется на рынках процентных ставок и валют.",formula:"dFₜ = σₜ·Fₜ^β·dW₁\ndσₜ = α·σₜ·dW₂",formulaExplanation:"Параметры модели SABR:\n\n• F — форвардная цена\n• σ — стохастическая волатильность\n• α — vol-of-vol (волатильность волатильности)\n• β — эластичность (0 ≤ β ≤ 1)\n  - β = 0: нормальная модель\n  - β = 1: логнормальная модель\n• ρ — корреляция между F и σ\n\nФормула Хагана для implied volatility:\nσᵢₘₚ(K) ≈ α·[...] · [1 + (ε₁ + ε₂)T]\n\nгде коэффициенты зависят от α, β, ρ и F/K",features:["Калибровка на рыночную улыбку","Интерполяция между страйками","Динамика улыбки во времени","Применение для swaptions и caps","Параметр β для контроля скошенности"],howToUse:["Загрузите рыночные котировки опционов","Запустите калибровку для нахождения α, β, ρ","Используйте для интерполяции IV между страйками","Экстраполируйте улыбку на нестандартные страйки"],relatedItems:["volsurf","heston","swaptions"]},{id:"volsurf",code:"VOLSURF",title:"Поверхность волатильности",category:"options",path:"/volatility-surface",description:"3D-визуализация подразумеваемой волатильности как функции страйка и времени до экспирации. Отражает рыночные ожидания будущей волатильности.",formula:"IV = f(K/S, T)",formulaExplanation:"Поверхность волатильности описывает:\n\n• Улыбка (Smile): IV выше для OTM опционов\n  - Вызвана толстыми хвостами распределения\n  - Отражает страх рынка перед резкими движениями\n\n• Скос (Skew): асимметрия улыбки\n  - Negative skew: IV(Put OTM) > IV(Call OTM)\n  - Характерен для акций (crash risk)\n\n• Временная структура: изменение IV с T\n  - Обычно убывает с ростом T (term structure)\n  - Инверсия при ожидании событий\n\nМонейность: m = ln(K/F) / (σ√T)\nATM: m = 0, OTM Put: m < 0, OTM Call: m > 0",features:["3D интерактивная визуализация","Построение по разным моделям","Wireframe и solid режимы","Анимация вращения","Экспорт данных"],howToUse:["Выберите модель построения (BSM, Heston, SABR, Local Vol)","Загрузите рыночные котировки из Excel","Изучите форму улыбки и скоса","Вращайте поверхность для анализа структуры"],relatedItems:["sabr","heston","bsm"]},{id:"portfolio-options",code:"OPTPF",title:"Портфель опционов",category:"options",path:"/option-portfolio",description:"Управление портфелем опционных позиций с агрегированием греков, анализом P&L и оценкой рисков.",formula:"Δₚ = Σᵢ nᵢ·Δᵢ, Γₚ = Σᵢ nᵢ·Γᵢ, ...",formulaExplanation:"Агрегирование греков портфеля:\n\n• Портфельная Delta: Δₚ = Σ (количество × Δ каждой позиции)\n• Портфельная Gamma: Γₚ = Σ (количество × Γ)\n• Портфельная Vega: νₚ = Σ (количество × ν)\n• Портфельная Theta: Θₚ = Σ (количество × Θ)\n\nP&L декомпозиция:\nΔP&L ≈ Δ·ΔS + ½Γ·(ΔS)² + ν·Δσ + Θ·Δt\n\nНетто-позиция определяет направленность:\n• Δₚ > 0: лонг по рынку\n• Γₚ > 0: выигрыш от волатильности\n• Θₚ < 0: временной распад (платим)",features:["Агрегированные греки портфеля","P&L по каждой позиции","Анализ монейности","Группировка по экспирациям","Нетто-греки портфеля"],howToUse:["Добавьте опционные позиции в портфель","Просмотрите агрегированные греки","Оцените P&L при сценарных изменениях","Идентифицируйте риски (gamma risk, vega risk)"],relatedItems:["greeks","hedging","pnl-attr"]},{id:"bond-valuation",code:"BOND",title:"Оценка облигаций (DCF)",category:"bonds",path:"/bond-valuation",description:"Оценка облигаций методом дисконтированных денежных потоков. Рассчитывается приведённая стоимость всех будущих купонов и номинала.",formula:"P = Σᵢ CFᵢ/(1+y)^tᵢ + N/(1+y)^T",formulaExplanation:"Формула приведённой стоимости:\n\nP = Σ [C/(1+y)^tᵢ] + N/(1+y)^T\n\nГде:\n• P — грязная цена облигации (Dirty Price)\n• C — купонный платёж\n• N — номинал (обычно 100 или 1000)\n• y — доходность к погашению (YTM)\n• tᵢ — время до i-го купона (в годах)\n• T — время до погашения\n\nЧистая цена = Грязная цена - НКД\nНКД = C × (дней с последнего купона / дней в купонном периоде)\n\nYTM находится итеративно (Newton-Raphson):\nP(y) = Market Price",features:["Расчёт грязной и чистой цены","Накопленный купонный доход (НКД)","Доходность к погашению (YTM)","Интеграция с MOEX ISS API","Batch-расчёт из Excel"],howToUse:["Введите ISIN или выберите облигацию из списка","Система загрузит параметры с MOEX","Укажите дату оценки и кривую доходности","Получите цену, YTM и аналитику"],relatedItems:["duration","zcyc","convexity"]},{id:"duration",code:"DUR",title:"Дюрация и DV01",category:"bonds",path:"/bond-valuation",description:"Дюрация — мера процентного риска облигации, показывающая чувствительность цены к изменению доходности. DV01 — изменение цены при сдвиге ставки на 1 б.п.",formula:"D = -1/P · dP/dy = Σ(tᵢ·PVᵢ)/P",formulaExplanation:"Виды дюрации:\n\n• Дюрация Маколея:\n  Dₘ = Σ[tᵢ · CFᵢ/(1+y)^tᵢ] / P\n  Средневзвешенный срок денежных потоков\n\n• Модифицированная дюрация:\n  Dₘₒₐ = Dₘ / (1 + y/m)\n  где m — частота купонов в год\n\n• Dollar Duration (DV01):\n  DV01 = Dₘₒₐ × P × 0.0001\n  Изменение цены при росте ставки на 1 б.п.\n\nПриближение изменения цены:\nΔP ≈ -Dₘₒₐ × P × Δy\n\nДля большей точности добавляем выпуклость:\nΔP ≈ -Dₘₒₐ × P × Δy + ½ × Convexity × P × (Δy)²",features:["Дюрация Маколея","Модифицированная дюрация","DV01 (PVBP)","Эффективная дюрация","Key Rate Duration"],howToUse:["Загрузите облигацию по ISIN","Просмотрите показатели в карточках метрик","Используйте DV01 для оценки риска позиции","Сравните дюрации для выбора облигаций"],relatedItems:["bond-valuation","convexity","hedging"]},{id:"convexity",code:"CONV",title:"Выпуклость (Convexity)",category:"bonds",path:"/bond-valuation",description:"Выпуклость — вторая производная цены по доходности. Улучшает оценку изменения цены при больших движениях ставок.",formula:"Convexity = 1/P · d²P/dy² = Σ[tᵢ(tᵢ+1)·PVᵢ] / [P·(1+y)²]",formulaExplanation:"Выпуклость описывает кривизну зависимости P(y):\n\nConvexity = [Σ tᵢ(tᵢ+1)·CFᵢ/(1+y)^tᵢ] / [P·(1+y)²]\n\nСвойства:\n• Convexity > 0 для обычных облигаций\n• Чем больше Convexity, тем лучше для инвестора\n• При росте ставок — меньше потери\n• При падении ставок — больше прибыль\n\nПолная формула изменения цены:\nΔP/P ≈ -Dₘₒₐ·Δy + ½·Convexity·(Δy)²\n\nПример: D = 5, C = 30, Δy = +1%\nΔP/P ≈ -5×0.01 + 0.5×30×0.0001 = -4.85%\n(без convexity было бы -5%)",features:["Расчёт выпуклости","Dollar Convexity","Сравнение облигаций","Сценарный анализ","Визуализация P(y)"],howToUse:["Выберите облигацию для анализа","Сравните Convexity разных бумаг","Используйте для оценки риска при больших движениях ставок"],relatedItems:["duration","bond-valuation"]},{id:"zcyc",code:"ZCYC",title:"Кривая бескупонной доходности",category:"bonds",path:"/zcyc-viewer",description:"Zero-Coupon Yield Curve — кривая доходности, построенная по бескупонным инструментам. Отражает временную структуру процентных ставок.",formula:"P(T) = e^(-r(T)·T) или P(T) = 1/(1+r(T))^T",formulaExplanation:"Построение ZCYC:\n\n1. Bootstrapping из рыночных инструментов:\n   - Короткие сроки: денежный рынок (RUONIA, депозиты)\n   - Средние: свопы (IRS)\n   - Длинные: гос. облигации\n\n2. Discount Factor:\n   DF(T) = e^(-r(T)·T) для непрерывного начисления\n   DF(T) = 1/(1+r(T))^T для дискретного\n\n3. Forward Rate:\n   f(t₁,t₂) = [r(t₂)·t₂ - r(t₁)·t₁] / (t₂-t₁)\n\n4. Интерполяция:\n   - Linear (простая)\n   - Cubic Spline (гладкая)\n   - Nelson-Siegel (параметрическая)\n\nMOEX публикует G-Curve (ОФЗ) ежедневно",features:["Загрузка с MOEX ISS API","Историческое сравнение","Статистика кривой","3D визуализация","Forward rates"],howToUse:["Выберите дату для загрузки кривой","Сравните с историческими данными","Изучите форму кривой (нормальная/инвертированная)","Используйте для дисконтирования денежных потоков"],relatedItems:["bond-valuation","swap-val","forward-curve"]},{id:"floater",code:"FRN",title:"Облигации с плавающим купоном",category:"bonds",path:"/floater-bond-report",description:"Floating Rate Notes — облигации с купоном, привязанным к референсной ставке (RUONIA, SOFR). Имеют низкую процентную чувствительность.",formula:"Coupon = Reference Rate + Spread",formulaExplanation:"Механика FRN:\n\nКупон = Референсная ставка + Спред\n\n• Референсные ставки:\n  - RUONIA (Россия)\n  - SOFR (США)\n  - EURIBOR (Еврозона)\n  - SONIA (Великобритания)\n\n• Спред фиксирован на весь срок\n• Купон пересчитывается каждый период\n\nОсобенности оценки:\n• Дюрация ≈ время до следующего reset\n• Цена близка к номиналу в дату reset\n• Основной риск — кредитный (spread risk)\n\nDirty Price = PV(будущих купонов) + PV(номинала)\nгде купоны прогнозируются через forward rates",features:["Прогноз купонов через forwards","Spread analysis","Reset mechanics","Сравнение с fixed-rate","RUONIA интеграция"],howToUse:["Введите ISIN флоатера","Просмотрите текущий и прогнозные купоны","Оцените spread risk","Сравните с фиксированными облигациями"],relatedItems:["bond-valuation","zcyc","swap-val"]},{id:"irs",code:"IRS",title:"Процентные свопы (IRS)",category:"swaps",path:"/valuation/swaps",description:"Interest Rate Swap — контракт обмена фиксированных платежей на плавающие. Используется для хеджирования процентного риска.",formula:"NPV = PV(Fixed Leg) - PV(Floating Leg)",formulaExplanation:"Структура IRS:\n\n• Fixed Leg: платим/получаем фиксированную ставку K\n  PV_fixed = K × Σ[Δtᵢ × DF(tᵢ)] × Notional\n\n• Floating Leg: получаем/платим плавающую ставку\n  PV_float = Σ[Fᵢ × Δtᵢ × DF(tᵢ)] × Notional\n  где Fᵢ — forward rate\n\nPar Swap Rate (справедливая фикс. ставка):\nK* = [1 - DF(T)] / Σ[Δtᵢ × DF(tᵢ)]\n\nDV01 свопа:\nDV01 ≈ Σ[Δtᵢ × DF(tᵢ)] × Notional × 0.0001\n\nPayer Swap: платим fixed, получаем float\nReceiver Swap: получаем fixed, платим float",features:["Расчёт NPV и DV01","Par rate калькулятор","Payer / Receiver свопы","Multi-currency support","Batch valuation"],howToUse:["Задайте notional, maturity, fixed rate","Выберите floating leg (RUONIA, MOSPRIME)","Рассчитайте NPV и risk metrics","Используйте для хеджирования bond portfolio"],relatedItems:["cds","forward-val","duration"]},{id:"cds",code:"CDS",title:"Кредитные дефолтные свопы",category:"swaps",path:"/valuation/swaps",description:"Credit Default Swap — страховка от дефолта. Покупатель платит премию, продавец компенсирует потери при дефолте.",formula:"Spread × RPV01 = (1-R) × Σ[q(tᵢ)·DF(tᵢ)]",formulaExplanation:"Компоненты CDS:\n\n• Premium Leg (платежи покупателя):\n  PV_premium = Spread × RPV01\n  RPV01 = Σ[Δtᵢ × DF(tᵢ) × Q(tᵢ)]\n  Q(tᵢ) — вероятность выживания до tᵢ\n\n• Protection Leg (выплата при дефолте):\n  PV_protection = (1-R) × Σ[q(tᵢ) × DF(tᵢ)]\n  q(tᵢ) = Q(tᵢ₋₁) - Q(tᵢ) — вероятность дефолта\n  R — Recovery Rate (обычно 40%)\n\nPar Spread (справедливый spread):\nS* = (1-R) × Σ[q(tᵢ)·DF(tᵢ)] / RPV01\n\nHazard Rate (интенсивность дефолта):\nλ ≈ Spread / (1-R)",features:["Расчёт NPV","Par spread calculator","Implied default probability","Recovery rate sensitivity","Hazard rate curve"],howToUse:["Введите reference entity и notional","Укажите spread и recovery rate","Рассчитайте справедливую стоимость","Оцените вероятность дефолта"],relatedItems:["irs","credit-risk","bond-valuation"]},{id:"forward-val",code:"FWD",title:"Форвардные контракты",category:"swaps",path:"/valuation/forwards",description:"Форвард — соглашение о покупке/продаже актива в будущем по фиксированной цене. Применяется для хеджирования и спекуляций.",formula:"F = S × e^((r-q)T) или F = S × (1+r)^T / (1+q)^T",formulaExplanation:"Форвардная цена по типам активов:\n\n• Акции без дивидендов:\n  F = S × e^(rT)\n\n• Акции с дивидендной доходностью q:\n  F = S × e^((r-q)T)\n\n• Валюта (Covered Interest Parity):\n  F = S × (1+r_domestic)^T / (1+r_foreign)^T\n\n• Товары (cost-of-carry):\n  F = S × e^((r+c-y)T)\n  c — storage cost, y — convenience yield\n\n• Облигации:\n  F = (S - PV(coupons)) × e^(rT)\n\nСтоимость существующего форварда:\nV = (F_new - K) × e^(-rT) × Notional",features:["Pricing всех типов форвардов","Валютные форварды","Commodity forwards","Bond forwards","Mark-to-market"],howToUse:["Выберите тип базового актива","Введите spot price, rates, maturity","Получите forward price","Оцените стоимость существующей позиции"],relatedItems:["basis","forward-curve","irs"]},{id:"basis",code:"BASIS",title:"Базисный анализ",category:"swaps",path:"/basis-analysis",description:"Базис — разница между форвардной и спотовой ценой. Анализ базиса важен для понимания стоимости хеджирования и арбитражных возможностей.",formula:"Basis = F - S = S × (e^((r-q)T) - 1)",formulaExplanation:"Компоненты базиса:\n\nBasis = Forward Price - Spot Price\n\nДля финансовых активов:\nBasis ≈ S × (r - q) × T\n• r — безрисковая ставка\n• q — дивидендная доходность\n\nДля товаров:\nBasis = S × (r + c - y) × T\n• c — storage costs\n• y — convenience yield\n\nТипы базиса:\n• Contango: F > S (basis > 0) — норма для финансов\n• Backwardation: F < S (basis < 0) — commodity markets\n\nAnnualized Basis:\nBasis% = (F/S - 1) × (365/T)\n\nИспользуется для:\n• Оценки стоимости хеджа\n• Cash-and-carry арбитража\n• Rollover analysis",features:["Basis calculation","Annualized carry cost","Contango/Backwardation","Historical basis tracking","Roll analysis"],howToUse:["Выберите актив и форвардный срок","Сравните basis для разных экспираций","Оцените стоимость roll-over","Идентифицируйте арбитражные возможности"],relatedItems:["forward-val","forward-curve","hedging"]},{id:"var",code:"VAR",title:"Value at Risk (VaR)",category:"risk",path:"/greeks",description:"VaR — максимальные потери портфеля за период с заданной вероятностью. Ключевая метрика рыночного риска.",formula:"VaR_α = -μ + σ × Φ⁻¹(α)",formulaExplanation:'Методы расчёта VaR:\n\n1. Параметрический (Variance-Covariance):\n   VaR = Portfolio × σ × z_α × √T\n   • z_α — квантиль нормального распределения\n   • z_95% = 1.645, z_99% = 2.326\n   • Предполагает нормальность returns\n\n2. Исторический:\n   VaR = -Percentile(returns, 1-α)\n   • Берём α-квантиль реальных returns\n   • Не требует допущений о распределении\n\n3. Monte Carlo:\n   • Генерируем N сценариев\n   • VaR = -Percentile(simulated P&L, 1-α)\n\nПример: VaR 95% = $1M означает:\n"С вероятностью 95% потери за день не превысят $1M"\nили "5% дней потери будут больше $1M"',features:["Параметрический VaR","Historical VaR","Monte Carlo VaR","Marginal VaR","Component VaR"],howToUse:["Выберите уровень доверия (95%, 99%)","Укажите временной горизонт (1d, 10d)","Сравните методы расчёта","Используйте Marginal VaR для оценки вклада позиций"],relatedItems:["cvar","stress","backtest"]},{id:"cvar",code:"CVAR",title:"Expected Shortfall (CVaR)",category:"risk",path:"/greeks",description:"Conditional VaR — ожидаемые потери при условии, что VaR превышен. Более консервативная метрика, учитывающая хвостовые риски.",formula:"ES_α = E[Loss | Loss > VaR_α]",formulaExplanation:'Expected Shortfall (ES / CVaR):\n\nОпределение:\nES_α = -E[X | X < -VaR_α]\n     = среднее потерь в худших (1-α)% случаев\n\nДля нормального распределения:\nES_α = μ + σ × φ(z_α)/(1-α)\nгде φ — плотность N(0,1)\n\nСвойства ES vs VaR:\n• ES всегда ≥ VaR\n• ES — когерентная мера риска\n• ES учитывает форму хвоста\n• Basel III требует ES 97.5% (≈ VaR 99%)\n\nПример:\nVaR 95% = $1M, ES 95% = $1.4M означает:\n"В худшие 5% дней средние потери = $1.4M"\n\nИсторическая формула:\nES = -Среднее(worst 5% returns)',features:["Параметрический ES","Historical ES","Сравнение с VaR","Tail risk analysis","Basel III compliance"],howToUse:["Рассчитайте VaR для выбранного уровня",'ES покажет "цену" превышения VaR',"Используйте для stress capital requirements"],relatedItems:["var","stress","extreme-value"]},{id:"stress",code:"STRESS",title:"Стресс-тестирование",category:"risk",path:"/stress",description:"Оценка поведения портфеля в экстремальных, но правдоподобных сценариях. Выявляет уязвимости, не видимые в VaR.",formula:"ΔPortfolio = Σᵢ Sensitivityᵢ × Shockᵢ",formulaExplanation:'Типы стресс-тестов:\n\n1. Исторические сценарии:\n   • Кризис 2008 (Lehman)\n   • COVID-19 (март 2020)\n   • Рубль 2014\n\n2. Гипотетические сценарии:\n   • Параллельный сдвиг ставок +200bp\n   • Падение акций -30%\n   • Рост волатильности ×2\n\n3. Sensitivity-based:\n   ΔP ≈ Σ(∂P/∂xᵢ × Δxᵢ)\n\n   Для портфеля облигаций:\n   ΔP ≈ -Duration × ΔY + ½×Convexity×(ΔY)²\n\n   Для опционов:\n   ΔP ≈ Δ×ΔS + ½Γ×(ΔS)² + ν×Δσ\n\n4. Reverse Stress Test:\n   "Какой шок нужен для потери X?"',features:["Исторические сценарии","Кастомные сценарии","Shock multiplier","P&L impact по активам","Severity levels"],howToUse:["Выберите тип стресс-теста","Настройте параметры шока","Оцените impact на портфель","Идентифицируйте уязвимые позиции"],relatedItems:["var","cvar","scenario"]},{id:"hedging",code:"HEDGE",title:"Хеджирование",category:"risk",path:"/hedging-assistant",description:"Построение хеджирующих позиций для снижения рисков портфеля. Включает delta-hedging, duration matching и regression-based hedging.",formula:"Hedge Ratio = -Cov(Portfolio, Hedge) / Var(Hedge)",formulaExplanation:"Стратегии хеджирования:\n\n1. Delta Hedging (опционы):\n   Hedge = -Δ × Notional\n   • Нейтрализует направленный риск\n   • Требует частой ребалансировки\n\n2. Duration Matching (облигации):\n   Hedge_notional = -(DV01_portfolio / DV01_hedge)\n   • Иммунизация от параллельного сдвига\n\n3. Regression Hedging:\n   Hedge Ratio = β = Cov(P,H)/Var(H)\n   • Минимизирует дисперсию хеджированной позиции\n\n4. Optimal Hedge (многофакторный):\n   h* = argmin Var(Portfolio - h×Hedge)\n\nHedge Effectiveness:\nR² = 1 - Var(hedged)/Var(unhedged)\n\nBasis Risk:\nРиск неполного хеджирования из-за\nнесовпадения hedge и underlying",features:["Delta hedging","Duration matching","Regression hedging","Hedge ratio calculator","Basis risk analysis"],howToUse:["Выберите позицию для хеджирования","Определите тип риска (direction, duration, vol)","Выберите hedge instrument","Рассчитайте оптимальный hedge ratio"],relatedItems:["greeks","duration","basis"]},{id:"pnl-attr",code:"PNLA",title:"P&L Атрибуция",category:"risk",path:"/analytics/pnl",description:"Декомпозиция прибыли и убытков по источникам: рыночные движения, временной распад, волатильность, и другие факторы.",formula:"ΔP&L = ΔS×Δ + ½(ΔS)²×Γ + Δσ×ν + Δt×Θ + residual",formulaExplanation:"Компоненты P&L Attribution:\n\n1. Greeks-based (для опционов):\n   • Market P&L = Δ × ΔS (направленное движение)\n   • Gamma P&L = ½ × Γ × (ΔS)² (кривизна)\n   • Vega P&L = ν × Δσ (волатильность)\n   • Theta P&L = Θ × Δt (временной распад)\n   • Residual = неучтённые эффекты\n\n2. Factor-based (для акций):\n   P&L = β_mkt × R_mkt + β_size × R_size + ...\n   • Market factor\n   • Size, Value, Momentum factors\n\n3. Position-based:\n   • P&L по каждой позиции\n   • Contribution to total\n\nФормула для облигаций:\nΔP ≈ -Dur×Δy + ½Conv×(Δy)² + Carry + Roll",features:["Greeks decomposition","Factor attribution","Position-level P&L","Daily/Weekly/Monthly","Contribution analysis"],howToUse:["Выберите период анализа","Выберите метод атрибуции","Изучите вклад каждого фактора","Идентифицируйте источники прибыли/убытков"],relatedItems:["greeks","portfolio-options","var"]},{id:"monte-carlo",code:"MC",title:"Monte Carlo симуляция",category:"simulation",path:"/monte-carlo",description:"Стохастическое моделирование цен активов с использованием геометрического броуновского движения. Генерация тысяч сценариев для оценки рисков.",formula:"S(t+Δt) = S(t) × exp[(μ - σ²/2)Δt + σ√Δt × Z]",formulaExplanation:"Geometric Brownian Motion (GBM):\n\nНепрерывная форма:\ndS = μSdt + σSdW\n\nДискретизация (Euler):\nS(t+Δt) = S(t) × exp[(μ - σ²/2)Δt + σ√Δt × Z]\nгде Z ~ N(0,1)\n\nПараметры:\n• S₀ — начальная цена\n• μ — дрифт (ожидаемая доходность)\n• σ — волатильность\n• T — горизонт симуляции\n• N — количество путей\n• dt — шаг по времени\n\nОценки из симуляции:\n• E[S_T] ≈ (1/N) × Σ S_T^(i)\n• VaR = Percentile(S_T, α)\n• Prob(S_T > K) ≈ #{S_T > K} / N\n\nДля опционов:\nC ≈ e^(-rT) × (1/N) × Σ max(S_T^(i) - K, 0)",features:["GBM path generation","Настраиваемые параметры","VaR из симуляции","Probability analysis","Path visualization"],howToUse:["Введите S₀, μ, σ, T, N","Запустите симуляцию","Изучите распределение терминальных цен","Оцените VaR и вероятности"],relatedItems:["var","bsm","heston"]},{id:"backtest",code:"BACK",title:"Бэктестинг стратегий",category:"simulation",path:"/backtest",description:"Тестирование торговых стратегий на исторических данных. Оценка CAGR, Sharpe Ratio, Maximum Drawdown и других метрик.",formula:"Sharpe = (R_p - R_f) / σ_p",formulaExplanation:"Ключевые метрики бэктеста:\n\n1. Total Return:\n   R_total = (V_end - V_start) / V_start\n\n2. CAGR (Compound Annual Growth Rate):\n   CAGR = (V_end/V_start)^(1/years) - 1\n\n3. Sharpe Ratio:\n   Sharpe = (R_p - R_f) / σ_p\n   • R_p — средняя доходность портфеля\n   • R_f — безрисковая ставка\n   • σ_p — волатильность портфеля\n   • Sharpe > 1 — хорошо, > 2 — отлично\n\n4. Maximum Drawdown:\n   MDD = max[(Peak - Trough) / Peak]\n   • Максимальная просадка от пика\n\n5. Win Rate:\n   Win Rate = # profitable trades / # total trades\n\n6. Sortino Ratio (downside risk):\n   Sortino = (R_p - R_f) / σ_downside",features:["Long/Short стратегии","Equity curve","Benchmark comparison","Monthly returns table","Risk-adjusted metrics"],howToUse:["Выберите стратегию","Задайте исторический период","Запустите бэктест","Сравните с бенчмарком (S&P 500)","Анализируйте метрики"],relatedItems:["sharpe","monte-carlo","portfolio"]},{id:"gbm",code:"GBM",title:"Геометрическое броуновское движение",category:"simulation",description:"Фундаментальная стохастическая модель для цен активов. Предполагает логнормальное распределение цен и постоянную волатильность.",formula:"dS = μSdt + σSdW",formulaExplanation:"Геометрическое Броуновское Движение:\n\nСтохастическое дифференциальное уравнение:\ndS = μSdt + σSdW\n\nРешение (Itô):\nS(T) = S(0) × exp[(μ - σ²/2)T + σW(T)]\n\nСвойства:\n• S(T) > 0 всегда (цены неотрицательны)\n• ln(S) ~ Normal (логнормальное распределение)\n• E[S(T)] = S(0) × e^(μT)\n• Var[S(T)] = S(0)² × e^(2μT) × (e^(σ²T) - 1)\n\nДоходности:\nR = ln(S(t+1)/S(t)) ~ N((μ-σ²/2)Δt, σ²Δt)\n\nОграничения модели:\n• Постоянная волатильность (не реалистично)\n• Непрерывные пути (нет скачков)\n• Тонкие хвосты (недооценивает extreme events)",features:["Базовая модель цен","Аналитические формулы","Основа для BSM","Простая калибровка"],howToUse:["Оцените μ и σ из исторических данных","Используйте для симуляции цен","Помните об ограничениях модели"],relatedItems:["monte-carlo","bsm","merton"]},{id:"hmm",code:"HMM",title:"Скрытые Марковские модели",category:"regimes",path:"/regimes",description:"Hidden Markov Model — статистическая модель для определения скрытых рыночных режимов (бычий/медвежий/боковой) по наблюдаемым доходностям.",formula:"P(Xₜ|Sₜ) × P(Sₜ|Sₜ₋₁)",formulaExplanation:"Компоненты HMM:\n\n1. Скрытые состояния (S):\n   • Обычно 2-4 режима\n   • Режим 1: низкая vol, позитивный дрифт (Bull)\n   • Режим 2: высокая vol, негативный дрифт (Bear)\n\n2. Матрица переходов (A):\n   A[i,j] = P(Sₜ = j | Sₜ₋₁ = i)\n   • Сумма строк = 1\n   • Диагональ — persistence\n\n3. Эмиссии (B):\n   P(Xₜ | Sₜ = i) ~ N(μᵢ, σᵢ²)\n   • Каждый режим имеет свои μ и σ\n\n4. Алгоритмы:\n   • Forward-Backward: P(S|X)\n   • Viterbi: наиболее вероятный путь\n   • Baum-Welch: оценка параметров (EM)\n\nСтационарное распределение π:\nπ = π × A (собственный вектор)\nπ[i] — долгосрочная вероятность режима i",features:["2-5 режимов (auto-select)","Матрица переходов","Regime probability timeline","Статистика по режимам","2D/3D visualization"],howToUse:["Загрузите исторические данные","Выберите количество режимов (или auto)","Обучите модель","Изучите характеристики режимов","Прогнозируйте текущий режим"],relatedItems:["spectral","regime-stats","portfolio"]},{id:"spectral",code:"SPEC",title:"Спектральный анализ режимов",category:"regimes",path:"/spectral-regime-analysis",description:"Продвинутый анализ динамики режимов через спектральное разложение. Выявление полюсов, оценка стабильности и периодичности.",formula:"G(z) = (zI - A)⁻¹",formulaExplanation:"Спектральный анализ матрицы переходов:\n\n1. Собственные значения A:\n   det(A - λI) = 0\n   • λ₁ = 1 (Perron-Frobenius)\n   • |λᵢ| < 1 для i > 1 (эргодичность)\n\n2. Mixing Time:\n   τ_mix ≈ 1 / (1 - |λ₂|)\n   Время сходимости к стационарному распределению\n\n3. Persistence:\n   P_stay[i] = A[i,i]\n   Expected duration = 1 / (1 - P_stay)\n\n4. Передаточная функция:\n   G(z) = (zI - A)⁻¹\n   Полюса = 1/собственные значения\n\n5. Stability Analysis:\n   • Все |λ| < 1 → стабильная система\n   • |λ| близко к 1 → медленное mixing\n\nМероморфное расширение для анализа\nскрытой структуры переходов",features:["Eigenvalue analysis","Pole detection","Stability metrics","Mixing time","Complex plane visualization"],howToUse:["Обучите HMM на данных","Запустите спектральный анализ","Изучите собственные значения","Оцените стабильность режимов"],relatedItems:["hmm","regime-stats"]},{id:"portfolio",code:"PORT",title:"Управление портфелем",category:"portfolio",path:"/portfolio",description:"Комплексный анализ инвестиционного портфеля: P&L, VaR, Sharpe Ratio, диверсификация, корреляции между активами.",formula:"R_p = Σ wᵢ×Rᵢ, σ_p² = w'Σw",formulaExplanation:"Метрики портфеля:\n\n1. Доходность портфеля:\n   R_p = Σ wᵢ × Rᵢ\n   где wᵢ — вес актива i\n\n2. Риск портфеля:\n   σ_p² = Σᵢ Σⱼ wᵢwⱼσᵢσⱼρᵢⱼ = w'Σw\n   Σ — ковариационная матрица\n\n3. Sharpe Ratio:\n   SR = (R_p - R_f) / σ_p\n\n4. Diversification Ratio:\n   DR = (Σ wᵢσᵢ) / σ_p\n   DR > 1 означает выигрыш от диверсификации\n\n5. Concentration (Herfindahl):\n   HHI = Σ wᵢ²\n   • HHI → 1: концентрация\n   • HHI → 1/N: равномерное распределение\n\n6. Correlation Contribution:\n   Вклад корреляций в общий риск",features:["KPI dashboard","Asset allocation chart","Top-5 positions","Correlation matrix","PDF export"],howToUse:["Выберите портфель из списка","Изучите KPI карточки","Просмотрите аллокацию по активам","Анализируйте корреляции","Экспортируйте отчёт в PDF"],relatedItems:["optimization","var","sharpe"]},{id:"optimization",code:"OPT",title:"Оптимизация портфеля",category:"portfolio",path:"/CCMVoptimization",description:"Поиск оптимальных весов активов для максимизации доходности при заданном уровне риска (Markowitz Mean-Variance) или с использованием HJB-оптимизации.",formula:"max w'μ - (γ/2)×w'Σw s.t. Σwᵢ=1",formulaExplanation:"Методы оптимизации:\n\n1. Mean-Variance (Markowitz):\n   min w'Σw (risk)\n   s.t. w'μ ≥ R_target\n        Σwᵢ = 1\n        wᵢ ≥ 0 (no short)\n\n   Или: max w'μ - (γ/2)×w'Σw\n   γ — параметр риск-аверсии\n\n2. Efficient Frontier:\n   Множество портфелей с минимальным\n   риском для каждого уровня доходности\n\n3. HJB (Hamilton-Jacobi-Bellman):\n   Динамическая оптимизация:\n   max E[∫ U(c_t)dt + U(W_T)]\n\n   w*(t) = (1/γ) × Σ⁻¹(μ - r)\n   Оптимальные веса зависят от\n   risk aversion и horizon\n\n4. CCMV (Cluster-Constrained):\n   Mean-Variance с ограничениями\n   на группы активов",features:["Markowitz optimization","HJB stochastic control","Efficient Frontier","Risk aversion tuning","Constraint handling"],howToUse:["Выберите активы для оптимизации","Задайте constraints (min/max weights)","Выберите метод (MV или HJB)","Найдите оптимальные веса","Сравните с текущим портфелем"],relatedItems:["portfolio","sharpe","var"]},{id:"sharpe",code:"SR",title:"Sharpe Ratio",category:"portfolio",description:"Коэффициент Шарпа — отношение избыточной доходности к волатильности. Стандартная мера risk-adjusted performance.",formula:"SR = (R_p - R_f) / σ_p",formulaExplanation:"Sharpe Ratio:\n\nSR = (R_p - R_f) / σ_p\n\nГде:\n• R_p — средняя доходность портфеля\n• R_f — безрисковая ставка\n• σ_p — стандартное отклонение доходности\n\nИнтерпретация:\n• SR < 0: портфель хуже безрисковой ставки\n• SR = 0-1: умеренная risk-adjusted доходность\n• SR = 1-2: хорошая performance\n• SR > 2: отличная performance\n\nAnnualized Sharpe:\nSR_annual = SR_daily × √252\n\nСвязанные метрики:\n• Sortino Ratio = (R_p - R_f) / σ_downside\n  (только downside volatility)\n\n• Information Ratio = (R_p - R_b) / σ_tracking\n  (относительно бенчмарка)\n\n• Calmar Ratio = CAGR / Max Drawdown",features:["Расчёт Sharpe","Annualization","Rolling Sharpe","Сравнение с бенчмарком","Связанные метрики"],howToUse:["Загрузите returns портфеля","Укажите безрисковую ставку","Получите Sharpe Ratio","Сравните с альтернативами"],relatedItems:["portfolio","backtest","optimization"]},{id:"terminal",code:"TERM",title:"Дзета-Терминал",category:"terminal",path:"/terminal",description:"Продвинутый торговый терминал с потоковыми данными в реальном времени. Акции, криптовалюты, фьючерсы, опционы.",features:["Real-time price updates","Order book depth","Multi-window layout","Custom widgets","Keyboard shortcuts (⌘K)"],howToUse:["Откройте терминал","Используйте ⌘K для command palette","Добавьте виджеты через Settings","Создавайте multiple windows"],relatedItems:["czf","wave-sigma","liquidity"]},{id:"czf",code:"CZF",title:"Citadel Zeta Field",category:"terminal",path:"/terminal",description:"3D визуализация гравитационного поля ликвидности. Частицы притягиваются к зонам высокой ликвидности.",features:["3D particle system","Gravity simulation","Liquidity zones","Real-time updates","Interactive controls"],relatedItems:["terminal","liquidity","wave-sigma"]},{id:"wave-sigma",code:"WSIG",title:"WAVE_σ.9 Surface",category:"terminal",path:"/terminal",description:"Momentum-Volatility топологическая поверхность. 3D визуализация динамики momentum и волатильности рынка.",features:["3D surface mesh","Momentum dynamics","Volatility mapping","Regime coloring","Trading simulation"],relatedItems:["terminal","volsurf","hmm"]},{id:"variance-gamma",code:"VG",title:"Variance Gamma процесс",category:"options",description:"Lévy-процесс с конечной вариацией и бесконечной активностью. Лучше описывает распределение доходностей с толстыми хвостами.",formula:"X(t) = θG(t) + σW(G(t))",formulaExplanation:"Variance Gamma Process:\n\nX(t) = θG(t) + σW(G(t))\n\nГде:\n• G(t) — Gamma process с параметром ν\n• W(t) — Brownian motion\n• θ — дрифт (skewness control)\n• σ — волатильность\n• ν — variance rate (kurtosis control)\n\nХарактеристическая функция:\nφ(u) = (1 - iuθν + σ²u²ν/2)^(-t/ν)\n\nСвойства:\n• Конечные моменты всех порядков\n• Толстые хвосты (kurtosis > 3)\n• Асимметрия (skewness ≠ 0)\n• Нет непрерывных путей (pure jump)\n\nPricing через FFT более эффективен",features:["Lévy process","Fat tails","Skewness control","FFT pricing","Calibration"],relatedItems:["merton","bsm","fft"]},{id:"bates",code:"BATES",title:"Модель Бейтса",category:"options",description:"Комбинация Heston (stochastic volatility) и Merton (jumps). Наиболее гибкая модель для ценообразования опционов.",formula:"dS = (μ-λk)Sdt + √V·S·dW₁ + S(e^J-1)dN",formulaExplanation:"Модель Бейтса (SVJ):\n\ndSₜ = (μ - λk)Sₜdt + √Vₜ·Sₜ·dW₁ + Sₜ(e^J - 1)dNₜ\ndVₜ = κ(θ - Vₜ)dt + ξ√Vₜ·dW₂\n\nКомпоненты:\n• Stochastic Volatility (от Heston):\n  - κ: mean reversion speed\n  - θ: long-run variance\n  - ξ: vol of vol\n  - ρ: correlation\n\n• Jumps (от Merton):\n  - λ: jump intensity\n  - μⱼ: mean jump size\n  - σⱼ: jump size volatility\n\nПреимущества:\n• Улыбка волатильности\n• Толстые хвосты\n• Asymmetry (leverage + jumps)\n• Flexible calibration",features:["Stochastic volatility","Jump diffusion","8 parameters","Most flexible model","Calibration intensive"],relatedItems:["heston","merton","volsurf"]}],uUe=["onClick"],dUe={class:"label-text font-oswald"},hUe={class:"label-count font-mono"},pUe={class:"kb-header"},fUe={class:"header-actions"},mUe={key:0,class:"kb-hero"},vUe={class:"hero-subtitle font-mono"},gUe={class:"panel-content custom-scrollbar"},yUe={class:"panel-meta"},bUe={class:"panel-title font-anton"},xUe={class:"panel-desc font-mono"},wUe={class:"panel-items"},_Ue=["onClick"],SUe={class:"item-header"},MUe={class:"item-title font-oswald"},TUe={class:"item-desc font-mono"},kUe={class:"item-tags"},CUe={key:0,class:"item-tag formula font-mono"},AUe={key:1,class:"item-tag path font-mono"},EUe={class:"search-modal"},IUe={class:"search-box"},RUe={key:0,class:"search-results custom-scrollbar"},DUe=["onClick"],PUe={class:"result-info"},LUe={class:"result-title font-oswald"},NUe={class:"result-category font-mono"},OUe={key:1,class:"search-empty font-mono"},FUe={class:"modal-content custom-scrollbar"},BUe={class:"modal-header"},UUe={class:"modal-title font-anton"},zUe={class:"modal-code font-mono"},VUe={class:"modal-body"},HUe={key:0,class:"modal-section"},GUe={class:"section-text font-mono"},WUe={key:1,class:"modal-section"},qUe={class:"formula-code font-mono"},YUe={key:2,class:"modal-section formula-explanation"},jUe={class:"explanation-text font-mono"},XUe={key:3,class:"modal-section"},$Ue={class:"feature-list"},KUe={key:4,class:"modal-section"},ZUe={class:"howto-list"},JUe={key:0,class:"modal-footer"},QUe={key:1,class:"kb-nav-bar"},eze=["onClick"],tze={class:"nav-name font-oswald"},aze={class:"nav-count font-mono"},nze={key:2,class:"kb-footer"},rze={class:"footer-stats"},ize={class:"stat-value font-anton"},oze={class:"stat-label font-mono"},sze=300,lze=1500,cze=e({__name:"KnowledgeBase",setup(a){const o=t(null),g=t(null),x=t(null),_=t({x:0,y:0}),D=t(!1),P=t(""),L=t(!1),N=t(null),O=t(null),F=t(null),B=t([]),z=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),G("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),G("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})])}),V=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),G("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),G("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})])}),W=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),G("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})])}),q=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("polyline",{points:"4 17 10 11 4 5"}),G("line",{x1:"12",y1:"19",x2:"20",y2:"19"})])}),Y=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),G("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),G("line",{x1:"6",y1:"20",x2:"6",y2:"14"})])}),j=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("circle",{cx:"12",cy:"12",r:"10"}),G("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})])}),X=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M2 20h.01"}),G("path",{d:"M7 20v-4"}),G("path",{d:"M12 20v-8"}),G("path",{d:"M17 20V8"}),G("path",{d:"M22 4v16"})])}),$={options:W,bonds:Y,swaps:e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("polyline",{points:"17 1 21 5 17 9"}),G("path",{d:"M3 5h18"}),G("polyline",{points:"7 23 3 19 7 15"}),G("path",{d:"M21 19H3"})])}),risk:V,simulation:X,regimes:j,portfolio:z,terminal:q},K=S(()=>lUe.map(e=>({...e,icon:$[e.id]||z}))),Z=S(()=>K.value.find(e=>e.id===N.value)),J=S(()=>cUe),Q=S(()=>[{value:J.value.length+"+",label:"Документов"},{value:K.value.length,label:"Созвездий"},{value:J.value.filter(e=>e.formula).length+"+",label:"Формул"},{value:"37+",label:"Страниц"}]),ee=S(()=>J.value.length),te=S(()=>P.value?(e=>{const t=e.toLowerCase();return cUe.filter(e=>e.title.toLowerCase().includes(t)||e.code.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.formula?.toLowerCase().includes(t))})(P.value):[]),ae=e=>{return t=e,cUe.filter(e=>e.category===t);var t},ne=e=>K.value.find(t=>t.id===e)?.color||"#666",re=e=>K.value.find(t=>t.id===e)?.name||"",ie=e=>{N.value=e},oe=()=>{N.value=null},se=e=>{O.value=e};let le,ce,ue,de,he=new rw,pe=new MT,fe=new aw,me=[];const ve=(e,t,a,n)=>{const r=new hS,i=new Float32Array(900),o=new Float32Array(sze),s=new Float32Array(900),l=new Float32Array(sze),c=new j_(e.color),u=new rw(t,a,20*(Math.random()-.5));for(let p=0;p<sze;p++){const e=3*p,t=p/sze*Math.PI*6+.5*n,a=3+p/sze*12+3*Math.random(),r=2*Math.sin(2*t);i[e]=u.x+Math.cos(t)*a+r+4*(Math.random()-.5),i[e+1]=u.y+Math.sin(t)*a*.6+3*(Math.random()-.5),i[e+2]=u.z+8*(Math.random()-.5);const d=Math.sqrt(Math.pow(i[e]-u.x,2)+Math.pow(i[e+1]-u.y,2));o[p]=Math.max(.5,3-.15*d)*(.5+.5*Math.random());const h=.7+.3*Math.random();s[e]=c.r*h,s[e+1]=c.g*h,s[e+2]=c.b*h,l[p]=Math.random()}r.setAttribute("position",new tS(i,3)),r.setAttribute("size",new tS(o,1)),r.setAttribute("color",new tS(s,3)),r.setAttribute("aRandom",new tS(l,1));const d=new RS({uniforms:{uTime:{value:0},uMouse:{value:new rw},uHovered:{value:0}},vertexShader:`\n      attribute float size;\n      attribute vec3 color;\n      attribute float aRandom;\n      varying vec3 vColor;\n      varying float vAlpha;\n      uniform float uTime;\n      uniform vec3 uMouse;\n      uniform float uHovered;\n\n      void main() {\n        vColor = color;\n        vec3 pos = position;\n\n        // Orbital motion\n        float angle = uTime * (0.1 + aRandom * 0.1);\n        float dist = length(pos.xy - vec2(${u.x.toFixed(1)}, ${u.y.toFixed(1)}));\n        pos.x += sin(angle + dist * 0.1) * 0.5;\n        pos.y += cos(angle + dist * 0.1) * 0.3;\n\n        // Breathing effect\n        float breathe = sin(uTime * 0.5 + aRandom * 6.28) * 0.3;\n        pos.xy += normalize(pos.xy - vec2(${u.x.toFixed(1)}, ${u.y.toFixed(1)})) * breathe;\n\n        // Mouse repulsion\n        float mouseDist = distance(pos.xy, uMouse.xy);\n        float influence = smoothstep(25.0, 0.0, mouseDist);\n        vec2 dir = normalize(pos.xy - uMouse.xy + 0.001);\n        pos.xy += dir * influence * 5.0;\n\n        // Hover expansion\n        pos.xy += normalize(pos.xy - vec2(${u.x.toFixed(1)}, ${u.y.toFixed(1)})) * uHovered * 3.0;\n\n        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n        gl_PointSize = size * (250.0 / -mvPosition.z) * (1.0 + uHovered * 0.5);\n        gl_Position = projectionMatrix * mvPosition;\n\n        vAlpha = 0.8 + uHovered * 0.2;\n      }\n    `,fragmentShader:"\n      varying vec3 vColor;\n      varying float vAlpha;\n\n      void main() {\n        float dist = length(gl_PointCoord - vec2(0.5));\n        if (dist > 0.5) discard;\n\n        float glow = 1.0 - smoothstep(0.0, 0.5, dist);\n        float core = 1.0 - smoothstep(0.0, 0.2, dist);\n\n        vec3 finalColor = vColor * glow + vec3(1.0) * core * 0.3;\n        float alpha = glow * vAlpha;\n\n        gl_FragColor = vec4(finalColor, alpha);\n      }\n    ",transparent:!0,depthWrite:!1,blending:2}),h=new BM(r,d);return h.userData={clusterId:e.id,center:u},{id:e.id,name:e.name,color:c,center:u,particles:h,count:ae(e.id).length}},ge=()=>{const e=new hS,t=new Float32Array(4500),a=new Float32Array(lze),n=new Float32Array(4500);for(let o=0;o<lze;o++){const e=3*o;t[e]=300*(Math.random()-.5),t[e+1]=200*(Math.random()-.5),t[e+2]=-50-100*Math.random(),a[o]=1.5*Math.random();const r=.3+.4*Math.random();n[e]=r,n[e+1]=r,n[e+2]=r}e.setAttribute("position",new tS(t,3)),e.setAttribute("size",new tS(a,1)),e.setAttribute("color",new tS(n,3));const r=new RS({uniforms:{uTime:{value:0}},vertexShader:"\n      attribute float size;\n      attribute vec3 color;\n      varying vec3 vColor;\n      varying float vAlpha;\n      uniform float uTime;\n\n      void main() {\n        vColor = color;\n\n        vec3 pos = position;\n        pos.z += sin(uTime * 0.1 + position.x * 0.01) * 2.0;\n\n        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n        gl_PointSize = size * (150.0 / -mvPosition.z);\n        gl_Position = projectionMatrix * mvPosition;\n\n        float twinkle = sin(uTime * 2.0 + position.x + position.y) * 0.3 + 0.7;\n        vAlpha = twinkle;\n      }\n    ",fragmentShader:"\n      varying vec3 vColor;\n      varying float vAlpha;\n\n      void main() {\n        float dist = length(gl_PointCoord - vec2(0.5));\n        if (dist > 0.5) discard;\n\n        float alpha = smoothstep(0.5, 0.0, dist) * vAlpha * 0.6;\n        gl_FragColor = vec4(vColor, alpha);\n      }\n    ",transparent:!0,depthWrite:!1,blending:2}),i=new BM(e,r);i.userData={isBackground:!0},le.add(i)},ye=()=>{if(!ce||!ue)return;const e=[];me.forEach(t=>{const a=t.center.clone().project(ce),n=(.5*a.x+.5)*window.innerWidth,r=(.5*-a.y+.5)*window.innerHeight,i=K.value.find(e=>e.id===t.id);e.push({id:t.id,name:i?.name||t.id,count:t.count,color:i?.color||"#ffffff",x:n,y:r,visible:a.z<1&&n>0&&n<window.innerWidth&&r>0&&r<window.innerHeight})}),B.value=e},be=()=>{de=requestAnimationFrame(be);const e=.001*performance.now();le.children.forEach(t=>{if(t instanceof BM&&t.material instanceof RS&&(t.material.uniforms.uTime.value=e,t.material.uniforms.uMouse.value=he,t.userData.clusterId)){const e=F.value?.id===t.userData.clusterId;t.material.uniforms.uHovered.value+=.1*(e?1:0-t.material.uniforms.uHovered.value)}}),ce.position.x=3*Math.sin(.1*e),ce.position.y=2*Math.cos(.08*e),ce.lookAt(0,0,0),ye(),ue.render(le,ce)},xe=e=>{if(_.value={x:e.clientX,y:e.clientY},fe.x=e.clientX/window.innerWidth*2-1,fe.y=-e.clientY/window.innerHeight*2+1,he.set(60*fe.x,40*fe.y,0),ce&&le){pe.setFromCamera(fe,ce);let e=null;for(const t of me){if(pe.ray.distanceToPoint(t.center)<15){const a=K.value.find(e=>e.id===t.id);e={id:t.id,color:a?.color||"#ffffff"};break}}F.value=e,g.value&&(g.value.style.cursor=e?"pointer":"default")}},we=e=>{F.value&&(N.value=F.value.id)},_e=()=>{D.value=!0},Se=()=>{D.value=!1,F.value=null},Me=()=>{ue&&ce&&(ce.aspect=window.innerWidth/window.innerHeight,ce.updateProjectionMatrix(),ue.setSize(window.innerWidth,window.innerHeight),ye())},Te=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),L.value=!0,A(()=>x.value?.focus())),"Escape"===e.key&&(L.value?L.value=!1:O.value?O.value=null:N.value&&(N.value=null))};return n(()=>{(()=>{if(!g.value)return;le=new qS,ce=new OS(60,window.innerWidth/window.innerHeight,.1,1e3),ce.position.z=100,ue=new AA({canvas:g.value,alpha:!0,antialias:!0}),ue.setSize(window.innerWidth,window.innerHeight),ue.setPixelRatio(Math.min(window.devicePixelRatio,2));const e=[{x:-50,y:30},{x:0,y:40},{x:50,y:30},{x:-40,y:-5},{x:40,y:-5},{x:-50,y:-35},{x:0,y:-40},{x:50,y:-35}];K.value.forEach((t,a)=>{const n=e[a%e.length],r=ve(t,n.x,n.y,a);me.push(r),le.add(r.particles)}),ge(),ye(),be()})(),window.addEventListener("mousemove",xe),window.addEventListener("click",we),window.addEventListener("resize",Me),window.addEventListener("keydown",Te),o.value&&(o.value.addEventListener("mouseenter",_e),o.value.addEventListener("mouseleave",Se))}),r(()=>{de&&cancelAnimationFrame(de),ue&&ue.dispose(),me=[],window.removeEventListener("mousemove",xe),window.removeEventListener("click",we),window.removeEventListener("resize",Me),window.removeEventListener("keydown",Te)}),R(L,e=>{e?A(()=>x.value?.focus()):P.value=""}),(e,t)=>{const a=d("router-link");return w(),i("div",{class:"kb-root",ref_key:"rootRef",ref:o},[s("canvas",{ref_key:"canvasRef",ref:g,class:"kb-canvas"},null,512),t[22]||(t[22]=s("div",{class:"bg-noise"},null,-1)),s("div",{class:"cursor-glow",style:y({left:`${_.value.x}px`,top:`${_.value.y}px`,opacity:D.value?1:0,background:F.value?`radial-gradient(circle, ${F.value.color}30 0%, transparent 70%)`:void 0})},null,4),(w(!0),i(p,null,f(B.value,e=>(w(),i("div",{key:e.id,class:c(["cluster-label",{active:N.value===e.id,hovered:F.value?.id===e.id}]),style:y({left:`${e.x}px`,top:`${e.y}px`,"--accent":e.color,opacity:e.visible?1:0,pointerEvents:e.visible?"auto":"none"}),onClick:t=>ie(e.id)},[s("div",{class:"label-dot",style:y({background:e.color})},null,4),s("span",dUe,v(e.name),1),s("span",hUe,v(e.count),1)],14,uUe))),128)),s("header",pUe,[s("div",{class:"kb-logo",onClick:t[0]||(t[0]=t=>e.$router.push("/"))},[...t[7]||(t[7]=[s("span",{class:"logo-symbol font-anton"},"ζ",-1),s("span",{class:"logo-text font-oswald"},"STOCHASTIC",-1)])]),t[10]||(t[10]=s("div",{class:"header-center"},[s("span",{class:"header-title font-mono"},"KNOWLEDGE BASE"),s("span",{class:"header-version font-mono"},"v3.0")],-1)),s("div",fUe,[s("button",{class:"search-trigger",onClick:t[1]||(t[1]=e=>L.value=!0)},[...t[8]||(t[8]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("path",{d:"m21 21-4.35-4.35"})],-1),s("span",{class:"font-mono"},"⌘K",-1)])]),u(a,{to:"/terminal",class:"terminal-btn font-oswald"},{default:h(()=>[...t[9]||(t[9]=[m(" ТЕРМИНАЛ → ",-1)])]),_:1})])]),N.value?l("",!0):(w(),i("section",mUe,[t[11]||(t[11]=I('<div class="hero-badge font-mono" data-v-a7544f4f><span class="badge-dot" data-v-a7544f4f></span> INTERACTIVE GALAXY </div><h1 class="hero-title font-anton" data-v-a7544f4f><span class="title-line" data-v-a7544f4f>БАЗА</span><span class="title-line accent" data-v-a7544f4f>ЗНАНИЙ</span></h1>',2)),s("p",vUe,v(ee.value)+" документов · "+v(K.value.length)+" созвездий · Кликните на скопление для навигации ",1),t[12]||(t[12]=s("div",{class:"hero-hint font-mono"}," Выберите категорию ниже или используйте ⌘K для поиска ",-1))])),(w(),b(H,{to:"body"},[u(M,{name:"panel"},{default:h(()=>[N.value?(w(),i("div",{key:0,class:"category-panel",onClick:E(oe,["self"])},[s("div",gUe,[s("button",{class:"panel-close",onClick:oe},[...t[13]||(t[13]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),s("div",{class:"panel-header",style:y({"--accent":Z.value?.color})},[s("div",{class:"panel-icon",style:y({background:Z.value?.color})},[(w(),b(C(Z.value?.icon)))],4),s("div",yUe,[s("h2",bUe,v(Z.value?.name),1),s("p",xUe,v(Z.value?.longDescription),1)])],4),s("div",wUe,[(w(!0),i(p,null,f(ae(N.value),e=>(w(),i("div",{key:e.id,class:"panel-item",onClick:t=>se(e)},[s("div",SUe,[s("span",{class:"item-code font-mono",style:y({color:Z.value?.color})},v(e.code),5),s("span",MUe,v(e.title),1)]),s("p",TUe,v(e.description?.slice(0,100))+"...",1),s("div",kUe,[e.formula?(w(),i("span",CUe,"Формула")):l("",!0),e.path?(w(),i("span",AUe,"Страница")):l("",!0)])],8,_Ue))),128))])])])):l("",!0)]),_:1})])),(w(),b(H,{to:"body"},[u(M,{name:"modal"},{default:h(()=>[L.value?(w(),i("div",{key:0,class:"search-overlay",onClick:t[4]||(t[4]=E(e=>L.value=!1,["self"]))},[s("div",EUe,[s("div",IUe,[t[14]||(t[14]=s("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("path",{d:"m21 21-4.35-4.35"})],-1)),T(s("input",{ref_key:"searchInputRef",ref:x,"onUpdate:modelValue":t[2]||(t[2]=e=>P.value=e),type:"text",placeholder:"Поиск по базе знаний...",class:"search-input font-mono",onKeydown:t[3]||(t[3]=U(e=>L.value=!1,["escape"]))},null,544),[[k,P.value]])]),te.value.length?(w(),i("div",RUe,[(w(!0),i(p,null,f(te.value.slice(0,10),e=>(w(),i("div",{key:e.id,class:"search-result",onClick:t=>{se(e),L.value=!1}},[s("div",{class:"result-icon",style:y({background:ne(e.category)})},v(e.code.slice(0,2)),5),s("div",PUe,[s("span",LUe,v(e.title),1),s("span",NUe,v(re(e.category)),1)])],8,DUe))),128))])):P.value?(w(),i("div",OUe," Ничего не найдено ")):l("",!0)])])):l("",!0)]),_:1})])),(w(),b(H,{to:"body"},[u(M,{name:"modal"},{default:h(()=>[O.value?(w(),i("div",{key:0,class:"modal-overlay",onClick:t[6]||(t[6]=E(e=>O.value=null,["self"]))},[s("div",FUe,[s("button",{class:"modal-close",onClick:t[5]||(t[5]=e=>O.value=null)},[...t[15]||(t[15]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),s("div",BUe,[s("span",{class:"modal-badge font-mono",style:y({background:ne(O.value.category)})},v(re(O.value.category)),5),s("h2",UUe,v(O.value.title),1),s("p",zUe,v(O.value.code),1)]),s("div",VUe,[O.value.description?(w(),i("div",HUe,[t[16]||(t[16]=s("h4",{class:"section-title font-oswald"},"Описание",-1)),s("p",GUe,v(O.value.description),1)])):l("",!0),O.value.formula?(w(),i("div",WUe,[t[17]||(t[17]=s("h4",{class:"section-title font-oswald"},"Формула",-1)),s("code",qUe,v(O.value.formula),1)])):l("",!0),O.value.formulaExplanation?(w(),i("div",YUe,[t[18]||(t[18]=s("h4",{class:"section-title font-oswald"},"Объяснение",-1)),s("pre",jUe,v(O.value.formulaExplanation),1)])):l("",!0),O.value.features?.length?(w(),i("div",XUe,[t[19]||(t[19]=s("h4",{class:"section-title font-oswald"},"Функции",-1)),s("ul",$Ue,[(w(!0),i(p,null,f(O.value.features,(e,t)=>(w(),i("li",{key:t,class:"font-mono"},v(e),1))),128))])])):l("",!0),O.value.howToUse?.length?(w(),i("div",KUe,[t[20]||(t[20]=s("h4",{class:"section-title font-oswald"},"Как использовать",-1)),s("ol",ZUe,[(w(!0),i(p,null,f(O.value.howToUse,(e,t)=>(w(),i("li",{key:t,class:"font-mono"},v(e),1))),128))])])):l("",!0)]),O.value.path?(w(),i("div",JUe,[u(a,{to:O.value.path,class:"modal-btn primary font-oswald"},{default:h(()=>[...t[21]||(t[21]=[m(" Открыть страницу → ",-1)])]),_:1},8,["to"])])):l("",!0)])])):l("",!0)]),_:1})])),N.value?l("",!0):(w(),i("nav",QUe,[(w(!0),i(p,null,f(K.value,e=>(w(),i("button",{key:e.id,class:"nav-category",style:y({"--accent":e.color}),onClick:t=>ie(e.id)},[s("span",{class:"nav-dot",style:y({background:e.color})},null,4),s("span",tze,v(e.name),1),s("span",aze,v(ae(e.id).length),1)],12,eze))),128))])),N.value?l("",!0):(w(),i("footer",nze,[s("div",rze,[(w(!0),i(p,null,f(Q.value,e=>(w(),i("div",{class:"stat-item",key:e.label},[s("span",ize,v(e.value),1),s("span",oze,v(e.label),1)]))),128))])]))],512)}}}),uze=xe(cze,[["__scopeId","data-v-a7544f4f"]]),dze=64230.5,hze=e=>{const t=[];let a=dze,n=Date.now()-60*e*1e3;for(let r=0;r<e;r++){const e=a,r=a+100*(Math.random()-.5),i=Math.max(e,r)+50*Math.random(),o=Math.min(e,r)-50*Math.random(),s=10*Math.random()+1;a=r,n+=6e4,t.push({time:new Date(n).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),timestamp:n,open:e,high:i,low:o,close:r,volume:s})}return t},pze=e=>{const t=[],a=[];for(let n=1;n<=15;n++)t.push({price:e-5*n-2*Math.random(),amount:2*Math.random(),total:0}),a.push({price:e+5*n+2*Math.random(),amount:2*Math.random(),total:0});return{bids:t,asks:a.reverse()}},fze={key:0,class:"command-overlay"},mze={class:"command-modal"},vze={class:"command-search"},gze={key:0,class:"command-empty font-mono"},yze=["onClick","onMouseenter"],bze={class:"command-item-left"},xze={key:1,class:"font-oswald"},wze={class:"command-info"},_ze={class:"command-label font-oswald"},Sze={class:"command-desc font-mono"},Mze={class:"command-item-right"},Tze={key:0,class:"command-code font-mono"},kze={key:1,class:"command-enter font-mono"},Cze=e({__name:"CommandPalette",props:{isOpen:{type:Boolean},items:{}},emits:["close","select"],setup(e,{emit:a}){const r=e,o=a,d=t(""),h=t(0),g=t(null),y=t(null),x=S(()=>r.items.filter(e=>e.label.toLowerCase().includes(d.value.toLowerCase())||e.code?.toLowerCase().includes(d.value.toLowerCase()))),_=()=>{h.value=0},M=e=>{o("select",e),o("close")},C=()=>o("close");R(()=>r.isOpen,e=>{e&&A(()=>{g.value?.focus(),d.value="",h.value=0})});const E=e=>{r.isOpen&&("ArrowDown"===e.key?(e.preventDefault(),h.value=(h.value+1)%x.value.length):"ArrowUp"===e.key?(e.preventDefault(),h.value=(h.value-1+x.value.length)%x.value.length):"Enter"===e.key?(e.preventDefault(),x.value[h.value]&&M(x.value[h.value])):"Escape"===e.key&&C())};R(()=>h.value,()=>{A(()=>{y.value&&y.value.children[h.value]&&y.value.children[h.value].scrollIntoView({block:"nearest"})})}),n(()=>{window.addEventListener("keydown",E)}),z(()=>{window.removeEventListener("keydown",E)});const I={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>'},D={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/></svg>'},P={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 10 4 15 9 20"/><path d="M20 4v7a4 4 0 0 1-4 4H4"/></svg>'};return(t,a)=>(w(),b(H,{to:"body"},[e.isOpen?(w(),i("div",fze,[s("div",{class:"command-backdrop",onClick:C}),s("div",mze,[s("div",vze,[u(I,{class:"w-5 h-5 text-[#DC2626]"}),T(s("input",{ref_key:"inputRef",ref:g,type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>d.value=e),onInput:_,placeholder:"ВВЕДИТЕ КОМАНДУ ИЛИ ТИКЕР...",class:"search-input font-mono"},null,544),[[k,d.value]]),a[1]||(a[1]=s("span",{class:"esc-badge font-mono"},"ESC",-1))]),s("div",{ref_key:"listRef",ref:y,class:"command-list custom-scrollbar"},[0===x.value.length?(w(),i("div",gze,[s("p",null,'НИЧЕГО НЕ НАЙДЕНО ПО ЗАПРОСУ "'+v(d.value)+'"',1)])):l("",!0),(w(!0),i(p,null,f(x.value,(e,t)=>(w(),i("div",{key:e.id,onClick:t=>M(e),onMouseenter:e=>h.value=t,class:c(["command-item",{"command-item-active":t===h.value}])},[s("div",bze,[s("div",{class:c(["command-icon",{"command-icon-active":t===h.value}])},["command"===e.type?(w(),b(D,{key:0,class:"w-3.5 h-3.5"})):(w(),i("span",xze,v(e.label.substring(0,2)),1))],2),s("div",wze,[s("div",_ze,v(e.label),1),s("div",Sze,v(e.description),1)])]),s("div",Mze,[e.code?(w(),i("span",Tze,v(e.code),1)):l("",!0),t===h.value?(w(),i("div",kze,[u(P,{class:"w-2.5 h-2.5"}),a[2]||(a[2]=m(" ENTER ",-1))])):l("",!0)])],42,yze))),128))],512),a[3]||(a[3]=s("div",{class:"command-footer font-mono"},[s("div",{class:"footer-hints"},[s("span",null,[s("b",null,"↑↓"),m(" НАВИГАЦИЯ")]),s("span",null,[s("b",null,"↵"),m(" ВЫБРАТЬ")])]),s("div",{class:"footer-label"},"КОМАНДНАЯ СТРОКА")],-1))])])):l("",!0)]))}}),Aze=xe(Cze,[["__scopeId","data-v-6540b802"]]),Eze="   https://stochastic-dashbord-v1-production.up.railway.app",Ize=async e=>{try{const t=await fetch(`${Eze}/api/market/stocks/multiple`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tickers:e})});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Failed to fetch multiple stocks:",QXe),QXe}},Rze=async e=>{try{const t=await fetch(`${Eze}/api/market/crypto/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){const e=await t.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${t.status}`)}return await t.json()}catch(QXe){throw console.error("Failed to fetch crypto info:",QXe),QXe}},Dze={class:"page-container custom-scrollbar"},Pze={class:"section-header flex-col gap-4"},Lze={class:"flex justify-between items-center w-full"},Nze={class:"section-title font-anton"},Oze={class:"tab-group"},Fze=["onClick"],Bze={class:"flex flex-wrap items-center gap-3"},Uze={class:"relative","data-dropdown-region":""},zze={class:"relative"},Vze=["onClick"],Hze={class:"relative","data-dropdown-country":""},Gze={class:"relative"},Wze=["onClick"],qze={class:"relative","data-dropdown-sector":""},Yze={class:"relative"},jze=["onClick"],Xze={class:"flex items-end"},$ze={key:0,class:"flex items-center justify-center py-8 text-gray-400 flex-shrink-0"},Kze={class:"w-full text-left border-collapse"},Zze=["onClick"],Jze={class:"py-4 px-6"},Qze={class:"flex items-center gap-3"},eVe=["src","alt"],tVe={key:1,class:"text-white text-xs font-bold"},aVe={class:"min-w-0 flex-1"},nVe={class:"text-white font-bold text-sm mb-0.5 truncate"},rVe={class:"text-xs text-gray-400 flex items-center gap-2 truncate"},iVe={class:"truncate"},oVe={class:"px-2 py-0.5 rounded-md bg-white/5 text-[10px] font-medium uppercase text-gray-400 flex-shrink-0"},sVe={class:"py-4 px-6 text-right"},lVe={class:"font-mono text-white text-sm font-semibold"},cVe={class:"py-4 px-6 text-right"},uVe={class:"font-mono"},dVe={class:"py-4 px-6 text-right hidden md:table-cell"},hVe={class:"text-xs text-gray-400 font-mono"},pVe={key:0,class:"text-gray-300"},fVe={key:1,class:"text-gray-600"},mVe=e({__name:"MarketsPage",props:{category:{}},emits:["navigate","assetClick"],setup(e,{emit:a}){const r=e,o=["Топ роста","Топ падения","Высокий объём"],d=t("Топ роста"),h=t("All"),m=t("All"),g=t("All"),y=t(!1),x=t(!1),_=t(!1),M=t(new Set),T=t(!1),k=t(!0),A=e=>{h.value=e,m.value="All",y.value=!1,x.value=!1,"All"!==e&&setTimeout(()=>{x.value=!0},100)},I=e=>{m.value=e,x.value=!1},R=e=>{g.value=e,_.value=!1};let D=null;n(()=>{D=e=>{const t=e.target;t.closest("[data-dropdown-region]")||t.closest("[data-dropdown-country]")||t.closest("[data-dropdown-sector]")||(y.value=!1,x.value=!1,_.value=!1)},document.addEventListener("click",D)});let P=null;n(async()=>{D=e=>{const t=e.target;t.closest("[data-dropdown-region]")||t.closest("[data-dropdown-country]")||t.closest("[data-dropdown-sector]")||(y.value=!1,x.value=!1,_.value=!1)},document.addEventListener("click",D),await N(),P=setInterval(N,6e4)}),z(()=>{P&&clearInterval(P),D&&document.removeEventListener("click",D)});const L=async()=>{try{console.log("🔄 Loading popular tickers from API...");const e=await(async()=>{try{const e=await fetch(`${Eze}/api/market/tickers/popular`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(t.detail||`HTTP error! status: ${e.status}`)}return await e.json()}catch(QXe){throw console.error("Failed to fetch popular tickers:",QXe),QXe}})();console.log(`✅ Loaded ${e.length} popular tickers from API`);const t=new Set(O.value.map(e=>e.symbol));let a=0;e.forEach(e=>{if(!t.has(e)){let n="Americas",r="USA",i="Technology";e.includes(".ME")?(n="EMEA",r="Russia",i="Banking"):e.includes(".L")||["AZN","SHEL","BP","GSK","VOD","DEO","UL"].some(t=>e.includes(t))?(n="EMEA",r="UK",i="Consumer"):["SAP","SIEGY","MBGYY","BMWYY","VWAGY","ALIZY"].some(t=>e.includes(t))?(n="EMEA",r="Germany",i="Technology"):["TTE","LVMUY","LRLCY","SNY","EADSY"].some(t=>e.includes(t))?(n="EMEA",r="France",i="Consumer"):["NSRGY","NVS","RHHBY","UBS"].some(t=>e.includes(t))?(n="EMEA",r="Switzerland",i="Healthcare"):["ASML","UNLY","ING"].some(t=>e.includes(t))?(n="EMEA",r="Netherlands",i="Technology"):["TM","SONY","SFTBY","NTDOY","HMC","NSANY"].some(t=>e.includes(t))?(n="APAC",r="Japan",i="Technology"):["SSNLF","HXSCL","LGEAF"].some(t=>e.includes(t))?(n="APAC",r="South Korea",i="Technology"):e.includes("TSM")?(n="APAC",r="Taiwan",i="Technology"):e.includes(".BSE")||["RELIANCE","TCS","INFY"].some(t=>e.includes(t))?(n="APAC",r="India",i="Technology"):["BABA","TCEHY","JD","BIDU","PNGAY","IDCBY","CICHY","BYDDY","NIO","XPEV","LI"].some(t=>e.includes(t))?(n="APAC",r="China",i="Technology"):["SHOP","RY","CNI"].some(t=>e.includes(t))?(n="Americas",r="Canada",i="Technology"):["BHP","RIO","CMWAY"].some(t=>e.includes(t))&&(n="APAC",r="Australia",i="Materials"),O.value.push({name:e,symbol:e,price:"0.00",change:"+0.00%",category:"Equities",region:n,country:r,sector:i,vol:"-",cap:"-"}),t.add(e),a++}}),console.log(`✅ Added ${a} new tickers to the list`)}catch(QXe){console.error("❌ Error loading popular tickers:",QXe),console.warn("⚠️ Using static tickers only")}},N=async()=>{if(k.value){T.value=!0;try{await L();const t=O.value.map(e=>e.symbol);console.log("🔄 Loading market data for",t.length,"tickers...");const a=50;let n=0;for(let r=0;r<t.length;r+=a){const i=t.slice(r,r+a);console.log(`📦 Loading batch ${Math.floor(r/a)+1}/${Math.ceil(t.length/a)} (${i.length} tickers)...`);try{(await Ize(i)).forEach(e=>{const t=O.value.findIndex(t=>t.symbol===e.ticker);if(-1!==t){if(O.value[t].price=e.price.toFixed(2),O.value[t].change=`${e.changePercent>=0?"+":""}${e.changePercent.toFixed(2)}%`,O.value[t].name=e.name,e.marketCap){const a=e.marketCap/1e9;O.value[t].cap=a>=1e3?`${(a/1e3).toFixed(1)}T`:`${a.toFixed(0)}B`}if(e.volume){const a=e.volume/1e6;O.value[t].vol=`${a.toFixed(0)}M`}n++}}),r+a<t.length&&await new Promise(e=>setTimeout(e,500))}catch(e){console.warn(`⚠️ Error loading batch ${Math.floor(r/a)+1}:`,e.message)}}console.log(`✅ Updated ${n} assets with real data`)}catch(QXe){console.error("❌ Error loading real market data:",QXe),console.error("Error message:",QXe.message),QXe.stack&&console.error("Error stack:",QXe.stack),k.value=!1,console.warn("⚠️ Falling back to static data")}finally{T.value=!1,console.log("🏁 Data loading finished")}}else console.log("Real data loading is disabled")},O=t([{name:"Apple Inc.",symbol:"AAPL",price:"173.50",change:"+1.20%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"55M",cap:"2.7T"},{name:"NVIDIA Corp",symbol:"NVDA",price:"892.10",change:"+4.25%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"42M",cap:"2.2T"},{name:"Microsoft",symbol:"MSFT",price:"420.55",change:"-0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"22M",cap:"3.1T"},{name:"Tesla Inc",symbol:"TSLA",price:"175.30",change:"+2.10%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"95M",cap:"550B"},{name:"Amazon",symbol:"AMZN",price:"180.25",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"38M",cap:"1.8T"},{name:"Meta Platforms",symbol:"META",price:"495.10",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"18M",cap:"1.2T"},{name:"Google",symbol:"GOOGL",price:"156.40",change:"-0.20%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"24M",cap:"1.9T"},{name:"Alphabet Inc",symbol:"GOOG",price:"156.80",change:"-0.18%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"12M",cap:"1.9T"},{name:"Netflix",symbol:"NFLX",price:"485.20",change:"+2.30%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"8M",cap:"215B"},{name:"AMD",symbol:"AMD",price:"142.50",change:"+3.15%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"65M",cap:"230B"},{name:"Intel",symbol:"INTC",price:"44.80",change:"+0.90%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"35M",cap:"185B"},{name:"Qualcomm",symbol:"QCOM",price:"145.60",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"12M",cap:"162B"},{name:"Broadcom",symbol:"AVGO",price:"1280.40",change:"+2.60%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"3M",cap:"590B"},{name:"Oracle",symbol:"ORCL",price:"118.25",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"18M",cap:"320B"},{name:"Adobe",symbol:"ADBE",price:"545.80",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"248B"},{name:"JPMorgan Chase",symbol:"JPM",price:"185.40",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"15M",cap:"540B"},{name:"Bank of America",symbol:"BAC",price:"38.50",change:"+0.40%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"45M",cap:"305B"},{name:"Wells Fargo",symbol:"WFC",price:"58.20",change:"+0.30%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"25M",cap:"215B"},{name:"Goldman Sachs",symbol:"GS",price:"425.80",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"3M",cap:"145B"},{name:"Morgan Stanley",symbol:"MS",price:"95.60",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"175B"},{name:"Citigroup",symbol:"C",price:"62.40",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"28M",cap:"120B"},{name:"Walmart",symbol:"WMT",price:"165.30",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"8M",cap:"445B"},{name:"Procter & Gamble",symbol:"PG",price:"168.90",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"7M",cap:"400B"},{name:"Coca-Cola",symbol:"KO",price:"62.80",change:"+0.20%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"18M",cap:"270B"},{name:"PepsiCo",symbol:"PEP",price:"172.50",change:"+0.40%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"6M",cap:"238B"},{name:"Nike",symbol:"NKE",price:"98.40",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"8M",cap:"151B"},{name:"McDonald's",symbol:"MCD",price:"295.60",change:"+0.50%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"4M",cap:"215B"},{name:"Starbucks",symbol:"SBUX",price:"95.80",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"9M",cap:"110B"},{name:"Johnson & Johnson",symbol:"JNJ",price:"158.40",change:"+0.30%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"9M",cap:"420B"},{name:"Pfizer",symbol:"PFE",price:"27.80",change:"-0.50%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"45M",cap:"158B"},{name:"Merck",symbol:"MRK",price:"128.60",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"12M",cap:"326B"},{name:"AbbVie",symbol:"ABBV",price:"168.90",change:"+0.40%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"8M",cap:"298B"},{name:"UnitedHealth",symbol:"UNH",price:"525.40",change:"+1.20%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"4M",cap:"495B"},{name:"Eli Lilly",symbol:"LLY",price:"765.20",change:"+2.45%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"3M",cap:"728B"},{name:"Exxon Mobil",symbol:"XOM",price:"118.50",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"22M",cap:"495B"},{name:"Chevron",symbol:"CVX",price:"162.40",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"12M",cap:"305B"},{name:"ConocoPhillips",symbol:"COP",price:"115.80",change:"+1.05%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"8M",cap:"138B"},{name:"Boeing",symbol:"BA",price:"185.40",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"8M",cap:"115B"},{name:"Caterpillar",symbol:"CAT",price:"348.60",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"4M",cap:"175B"},{name:"3M",symbol:"MMM",price:"98.50",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"5M",cap:"55B"},{name:"General Electric",symbol:"GE",price:"148.20",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"12M",cap:"162B"},{name:"AT&T",symbol:"T",price:"17.40",change:"+0.15%",category:"Equities",region:"Americas",country:"USA",sector:"Telecommunications",vol:"45M",cap:"124B"},{name:"Verizon",symbol:"VZ",price:"40.80",change:"+0.10%",category:"Equities",region:"Americas",country:"USA",sector:"Telecommunications",vol:"25M",cap:"172B"},{name:"T-Mobile",symbol:"TMUS",price:"165.40",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Telecommunications",vol:"5M",cap:"195B"},{name:"BP",symbol:"BP",price:"38.50",change:"+0.85%",category:"Equities",region:"EMEA",country:"UK",sector:"Oil & Gas",vol:"18M",cap:"82B"},{name:"Shell",symbol:"SHEL",price:"32.80",change:"+0.75%",category:"Equities",region:"EMEA",country:"UK",sector:"Oil & Gas",vol:"15M",cap:"210B"},{name:"AstraZeneca",symbol:"AZN",price:"68.40",change:"+0.45%",category:"Equities",region:"EMEA",country:"UK",sector:"Healthcare",vol:"5M",cap:"215B"},{name:"Unilever",symbol:"UL",price:"52.60",change:"+0.30%",category:"Equities",region:"EMEA",country:"UK",sector:"Consumer",vol:"8M",cap:"125B"},{name:"Diageo",symbol:"DEO",price:"145.20",change:"+0.50%",category:"Equities",region:"EMEA",country:"UK",sector:"Consumer",vol:"2M",cap:"82B"},{name:"GlaxoSmithKline",symbol:"GSK",price:"42.80",change:"+0.35%",category:"Equities",region:"EMEA",country:"UK",sector:"Healthcare",vol:"12M",cap:"88B"},{name:"Vodafone",symbol:"VOD",price:"8.45",change:"+0.15%",category:"Equities",region:"EMEA",country:"UK",sector:"Telecommunications",vol:"28M",cap:"24B"},{name:"SAP",symbol:"SAP",price:"185.40",change:"+1.25%",category:"Equities",region:"EMEA",country:"Germany",sector:"Technology",vol:"2M",cap:"228B"},{name:"Siemens",symbol:"SIEGY",price:"95.80",change:"+0.85%",category:"Equities",region:"EMEA",country:"Germany",sector:"Industrial",vol:"1.5M",cap:"145B"},{name:"Mercedes-Benz",symbol:"MBGYY",price:"18.50",change:"+0.60%",category:"Equities",region:"EMEA",country:"Germany",sector:"Automotive",vol:"0.5M",cap:"68B"},{name:"BMW",symbol:"BMWYY",price:"36.40",change:"+0.45%",category:"Equities",region:"EMEA",country:"Germany",sector:"Automotive",vol:"0.8M",cap:"62B"},{name:"Volkswagen",symbol:"VWAGY",price:"15.20",change:"+0.35%",category:"Equities",region:"EMEA",country:"Germany",sector:"Technology",vol:"1.2M",cap:"75B"},{name:"Allianz",symbol:"ALIZY",price:"28.60",change:"+0.40%",category:"Equities",region:"EMEA",country:"Germany",sector:"Technology",vol:"0.6M",cap:"112B"},{name:"TotalEnergies",symbol:"TTE",price:"68.40",change:"+0.95%",category:"Equities",region:"EMEA",country:"France",sector:"Oil & Gas",vol:"5M",cap:"165B"},{name:"LVMH",symbol:"LVMUY",price:"182.50",change:"+1.15%",category:"Equities",region:"EMEA",country:"France",sector:"Consumer",vol:"0.3M",cap:"385B"},{name:"L'Oreal",symbol:"LRLCY",price:"28.40",change:"+0.55%",category:"Equities",region:"EMEA",country:"France",sector:"Consumer",vol:"0.5M",cap:"245B"},{name:"Sanofi",symbol:"SNY",price:"48.20",change:"+0.35%",category:"Equities",region:"EMEA",country:"France",sector:"Healthcare",vol:"3M",cap:"120B"},{name:"Airbus",symbol:"EADSY",price:"42.80",change:"+0.85%",category:"Equities",region:"EMEA",country:"France",sector:"Industrial",vol:"1.8M",cap:"125B"},{name:"Nestle",symbol:"NSRGY",price:"108.40",change:"+0.25%",category:"Equities",region:"EMEA",country:"Switzerland",sector:"Consumer",vol:"1.2M",cap:"295B"},{name:"Novartis",symbol:"NVS",price:"98.60",change:"+0.40%",category:"Equities",region:"EMEA",country:"Switzerland",sector:"Healthcare",vol:"3M",cap:"215B"},{name:"Roche",symbol:"RHHBY",price:"45.20",change:"+0.30%",category:"Equities",region:"EMEA",country:"Switzerland",sector:"Healthcare",vol:"1.5M",cap:"265B"},{name:"UBS",symbol:"UBS",price:"28.40",change:"+0.55%",category:"Equities",region:"EMEA",country:"Switzerland",sector:"Finance",vol:"8M",cap:"95B"},{name:"ASML",symbol:"ASML",price:"945.60",change:"+2.85%",category:"Equities",region:"EMEA",country:"Netherlands",sector:"Technology",vol:"1.2M",cap:"375B"},{name:"Unilever",symbol:"UNLY",price:"52.80",change:"+0.30%",category:"Equities",region:"EMEA",country:"Netherlands",sector:"Consumer",vol:"2M",cap:"125B"},{name:"ING Group",symbol:"ING",price:"16.80",change:"+0.45%",category:"Equities",region:"EMEA",country:"Netherlands",sector:"Banking",vol:"15M",cap:"62B"},{name:"Сбербанк",symbol:"SBER",price:"285.40",change:"+1.85%",category:"Equities",region:"EMEA",country:"Russia",sector:"Banking",vol:"125M",cap:"6.5T"},{name:"Газпром",symbol:"GAZP",price:"168.50",change:"+0.95%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"85M",cap:"4.2T"},{name:"Лукойл",symbol:"LKOH",price:"7850.60",change:"+1.25%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"1.2M",cap:"8.1T"},{name:"Роснефть",symbol:"ROSN",price:"585.40",change:"+0.75%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"15M",cap:"6.2T"},{name:"Норникель",symbol:"GMKN",price:"16250.80",change:"+2.15%",category:"Equities",region:"EMEA",country:"Russia",sector:"Materials",vol:"0.8M",cap:"2.8T"},{name:"Яндекс",symbol:"YNDX",price:"2840.50",change:"+1.45%",category:"Equities",region:"EMEA",country:"Russia",sector:"Technology",vol:"2.5M",cap:"1.1T"},{name:"Магнит",symbol:"MGNT",price:"7850.20",change:"+0.55%",category:"Equities",region:"EMEA",country:"Russia",sector:"Retail",vol:"0.3M",cap:"1.8T"},{name:"ВТБ",symbol:"VTBR",price:"0.0285",change:"+1.20%",category:"Equities",region:"EMEA",country:"Russia",sector:"Banking",vol:"2.5B",cap:"850B"},{name:"Татнефть",symbol:"TATN",price:"625.80",change:"+0.85%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"8M",cap:"1.4T"},{name:"Новатэк",symbol:"NVTK",price:"1650.40",change:"+1.55%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"1.8M",cap:"5.5T"},{name:"Сургутнефтегаз",symbol:"SNGS",price:"42.60",change:"+0.65%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"12M",cap:"1.2T"},{name:"Алроса",symbol:"ALRS",price:"82.40",change:"+1.95%",category:"Equities",region:"EMEA",country:"Russia",sector:"Materials",vol:"5M",cap:"625B"},{name:"МТС",symbol:"MTSS",price:"285.60",change:"+0.45%",category:"Equities",region:"EMEA",country:"Russia",sector:"Telecommunications",vol:"3M",cap:"585B"},{name:"Транснефть",symbol:"TRNFP",price:"185000",change:"+0.35%",category:"Equities",region:"EMEA",country:"Russia",sector:"Oil & Gas",vol:"0.01M",cap:"4.2T"},{name:"Alibaba",symbol:"BABA",price:"85.40",change:"+2.15%",category:"Equities",region:"APAC",country:"China",sector:"Technology",vol:"25M",cap:"215B"},{name:"Tencent",symbol:"TCEHY",price:"48.60",change:"+1.85%",category:"Equities",region:"APAC",country:"China",sector:"Technology",vol:"18M",cap:"465B"},{name:"JD.com",symbol:"JD",price:"28.80",change:"+1.45%",category:"Equities",region:"APAC",country:"China",sector:"Retail",vol:"12M",cap:"45B"},{name:"Baidu",symbol:"BIDU",price:"115.40",change:"+0.95%",category:"Equities",region:"APAC",country:"China",sector:"Technology",vol:"8M",cap:"42B"},{name:"Ping An",symbol:"PNGAY",price:"12.80",change:"+0.65%",category:"Equities",region:"APAC",country:"China",sector:"Finance",vol:"5M",cap:"95B"},{name:"ICBC",symbol:"IDCBY",price:"18.40",change:"+0.35%",category:"Equities",region:"APAC",country:"China",sector:"Banking",vol:"3M",cap:"285B"},{name:"China Construction Bank",symbol:"CICHY",price:"15.60",change:"+0.25%",category:"Equities",region:"APAC",country:"China",sector:"Banking",vol:"2M",cap:"198B"},{name:"BYD",symbol:"BYDDY",price:"62.40",change:"+3.25%",category:"Equities",region:"APAC",country:"China",sector:"Automotive",vol:"8M",cap:"95B"},{name:"Toyota",symbol:"TM",price:"245.80",change:"+0.85%",category:"Equities",region:"APAC",country:"Japan",sector:"Automotive",vol:"1.2M",cap:"285B"},{name:"Sony",symbol:"SONY",price:"98.40",change:"+1.45%",category:"Equities",region:"APAC",country:"Japan",sector:"Technology",vol:"3M",cap:"125B"},{name:"SoftBank",symbol:"SFTBY",price:"28.60",change:"+0.65%",category:"Equities",region:"APAC",country:"Japan",sector:"Finance",vol:"2M",cap:"85B"},{name:"Nintendo",symbol:"NTDOY",price:"15.80",change:"+0.35%",category:"Equities",region:"APAC",country:"Japan",sector:"Technology",vol:"0.8M",cap:"68B"},{name:"Honda",symbol:"HMC",price:"38.40",change:"+0.55%",category:"Equities",region:"APAC",country:"Japan",sector:"Automotive",vol:"1.5M",cap:"72B"},{name:"Nissan",symbol:"NSANY",price:"8.50",change:"+0.25%",category:"Equities",region:"APAC",country:"Japan",sector:"Automotive",vol:"1.2M",cap:"18B"},{name:"Samsung",symbol:"SSNLF",price:"45.80",change:"+1.15%",category:"Equities",region:"APAC",country:"South Korea",sector:"Technology",vol:"0.5M",cap:"385B"},{name:"SK Hynix",symbol:"HXSCL",price:"128.40",change:"+2.45%",category:"Equities",region:"APAC",country:"South Korea",sector:"Technology",vol:"1.2M",cap:"95B"},{name:"LG",symbol:"LGEAF",price:"18.60",change:"+0.65%",category:"Equities",region:"APAC",country:"South Korea",sector:"Technology",vol:"0.8M",cap:"12B"},{name:"Taiwan Semiconductor",symbol:"TSM",price:"142.50",change:"+3.15%",category:"Equities",region:"APAC",country:"Taiwan",sector:"Technology",vol:"15M",cap:"725B"},{name:"Reliance Industries",symbol:"RELIANCE.BSE",price:"2845.60",change:"+1.85%",category:"Equities",region:"APAC",country:"India",sector:"Oil & Gas",vol:"2M",cap:"245B"},{name:"TCS",symbol:"TCS.BSE",price:"3850.40",change:"+0.95%",category:"Equities",region:"APAC",country:"India",sector:"Technology",vol:"1.2M",cap:"145B"},{name:"Infosys",symbol:"INFY",price:"18.50",change:"+0.75%",category:"Equities",region:"APAC",country:"India",sector:"Technology",vol:"8M",cap:"82B"},{name:"Shopify",symbol:"SHOP",price:"78.40",change:"+2.15%",category:"Equities",region:"Americas",country:"Canada",sector:"Technology",vol:"8M",cap:"98B"},{name:"Royal Bank of Canada",symbol:"RY",price:"128.60",change:"+0.45%",category:"Equities",region:"Americas",country:"Canada",sector:"Banking",vol:"3M",cap:"185B"},{name:"Canadian National Railway",symbol:"CNI",price:"132.80",change:"+0.65%",category:"Equities",region:"Americas",country:"Canada",sector:"Industrial",vol:"1.5M",cap:"95B"},{name:"BHP Group",symbol:"BHP",price:"62.40",change:"+1.25%",category:"Equities",region:"APAC",country:"Australia",sector:"Materials",vol:"5M",cap:"158B"},{name:"Rio Tinto",symbol:"RIO",price:"68.80",change:"+1.05%",category:"Equities",region:"APAC",country:"Australia",sector:"Materials",vol:"3M",cap:"125B"},{name:"Commonwealth Bank",symbol:"CMWAY",price:"85.20",change:"+0.55%",category:"Equities",region:"APAC",country:"Australia",sector:"Banking",vol:"1.2M",cap:"165B"},{name:"Costco",symbol:"COST",price:"850.20",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"2M",cap:"375B"},{name:"Home Depot",symbol:"HD",price:"385.60",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"4M",cap:"385B"},{name:"Visa",symbol:"V",price:"285.40",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"585B"},{name:"Mastercard",symbol:"MA",price:"485.80",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"3M",cap:"425B"},{name:"PayPal",symbol:"PYPL",price:"68.50",change:"+1.25%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"12M",cap:"72B"},{name:"Salesforce",symbol:"CRM",price:"285.40",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"8M",cap:"285B"},{name:"Cisco",symbol:"CSCO",price:"52.80",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"18M",cap:"215B"},{name:"IBM",symbol:"IBM",price:"185.60",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"168B"},{name:"Disney",symbol:"DIS",price:"112.40",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"15M",cap:"205B"},{name:"Comcast",symbol:"CMCSA",price:"42.80",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Telecommunications",vol:"18M",cap:"175B"},{name:"AT&T",symbol:"T",price:"17.40",change:"+0.15%",category:"Equities",region:"Americas",country:"USA",sector:"Telecommunications",vol:"45M",cap:"124B"},{name:"Boeing",symbol:"BA",price:"185.40",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"8M",cap:"115B"},{name:"Lockheed Martin",symbol:"LMT",price:"485.20",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"1M",cap:"125B"},{name:"Raytheon",symbol:"RTX",price:"95.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"5M",cap:"145B"},{name:"General Motors",symbol:"GM",price:"42.60",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"18M",cap:"48B"},{name:"Ford",symbol:"F",price:"12.80",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"45M",cap:"52B"},{name:"Starbucks",symbol:"SBUX",price:"95.80",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"9M",cap:"110B"},{name:"Chipotle",symbol:"CMG",price:"2850.40",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"0.3M",cap:"78B"},{name:"Target",symbol:"TGT",price:"165.20",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"5M",cap:"75B"},{name:"Lowe's",symbol:"LOW",price:"225.60",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"4M",cap:"135B"},{name:"Nike",symbol:"NKE",price:"98.40",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"8M",cap:"151B"},{name:"Coca-Cola",symbol:"KO",price:"62.80",change:"+0.20%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"18M",cap:"270B"},{name:"PepsiCo",symbol:"PEP",price:"172.50",change:"+0.40%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"6M",cap:"238B"},{name:"Procter & Gamble",symbol:"PG",price:"168.90",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"7M",cap:"400B"},{name:"Johnson & Johnson",symbol:"JNJ",price:"158.40",change:"+0.30%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"9M",cap:"420B"},{name:"Pfizer",symbol:"PFE",price:"27.80",change:"-0.50%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"45M",cap:"158B"},{name:"Merck",symbol:"MRK",price:"128.60",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"12M",cap:"326B"},{name:"AbbVie",symbol:"ABBV",price:"168.90",change:"+0.40%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"8M",cap:"298B"},{name:"UnitedHealth",symbol:"UNH",price:"525.40",change:"+1.20%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"4M",cap:"495B"},{name:"Eli Lilly",symbol:"LLY",price:"765.20",change:"+2.45%",category:"Equities",region:"Americas",country:"USA",sector:"Healthcare",vol:"3M",cap:"728B"},{name:"Exxon Mobil",symbol:"XOM",price:"118.50",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"22M",cap:"495B"},{name:"Chevron",symbol:"CVX",price:"162.40",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"12M",cap:"305B"},{name:"ConocoPhillips",symbol:"COP",price:"115.80",change:"+1.05%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"8M",cap:"138B"},{name:"Schlumberger",symbol:"SLB",price:"52.40",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"12M",cap:"75B"},{name:"Halliburton",symbol:"HAL",price:"38.60",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"8M",cap:"35B"},{name:"Caterpillar",symbol:"CAT",price:"348.60",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"4M",cap:"175B"},{name:"3M",symbol:"MMM",price:"98.50",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"5M",cap:"55B"},{name:"General Electric",symbol:"GE",price:"148.20",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"12M",cap:"162B"},{name:"Honeywell",symbol:"HON",price:"215.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"3M",cap:"145B"},{name:"Deere",symbol:"DE",price:"385.40",change:"+1.25%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"2M",cap:"108B"},{name:"Union Pacific",symbol:"UNP",price:"245.60",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"3M",cap:"145B"},{name:"FedEx",symbol:"FDX",price:"285.40",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"2M",cap:"72B"},{name:"UPS",symbol:"UPS",price:"165.80",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"4M",cap:"145B"},{name:"JPMorgan Chase",symbol:"JPM",price:"185.40",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"15M",cap:"540B"},{name:"Bank of America",symbol:"BAC",price:"38.50",change:"+0.40%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"45M",cap:"305B"},{name:"Wells Fargo",symbol:"WFC",price:"58.20",change:"+0.30%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"25M",cap:"215B"},{name:"Goldman Sachs",symbol:"GS",price:"425.80",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"3M",cap:"145B"},{name:"Morgan Stanley",symbol:"MS",price:"95.60",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"175B"},{name:"Citigroup",symbol:"C",price:"62.40",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Banking",vol:"28M",cap:"120B"},{name:"Charles Schwab",symbol:"SCHW",price:"68.50",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"125B"},{name:"BlackRock",symbol:"BLK",price:"825.40",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"0.5M",cap:"125B"},{name:"Berkshire Hathaway",symbol:"BRK.B",price:"385.60",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"4M",cap:"875B"},{name:"American Express",symbol:"AXP",price:"225.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"3M",cap:"165B"},{name:"Walmart",symbol:"WMT",price:"165.30",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"8M",cap:"445B"},{name:"Amazon",symbol:"AMZN",price:"180.25",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"38M",cap:"1.8T"},{name:"Apple Inc.",symbol:"AAPL",price:"173.50",change:"+1.20%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"55M",cap:"2.7T"},{name:"Microsoft",symbol:"MSFT",price:"420.55",change:"-0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"22M",cap:"3.1T"},{name:"NVIDIA Corp",symbol:"NVDA",price:"892.10",change:"+4.25%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"42M",cap:"2.2T"},{name:"Google",symbol:"GOOGL",price:"156.40",change:"-0.20%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"24M",cap:"1.9T"},{name:"Meta Platforms",symbol:"META",price:"495.10",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"18M",cap:"1.2T"},{name:"Tesla Inc",symbol:"TSLA",price:"175.30",change:"+2.10%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"95M",cap:"550B"},{name:"Netflix",symbol:"NFLX",price:"485.20",change:"+2.30%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"8M",cap:"215B"},{name:"AMD",symbol:"AMD",price:"142.50",change:"+3.15%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"65M",cap:"230B"},{name:"Intel",symbol:"INTC",price:"44.80",change:"+0.90%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"35M",cap:"185B"},{name:"Qualcomm",symbol:"QCOM",price:"145.60",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"12M",cap:"162B"},{name:"Broadcom",symbol:"AVGO",price:"1280.40",change:"+2.60%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"3M",cap:"590B"},{name:"Oracle",symbol:"ORCL",price:"118.25",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"18M",cap:"320B"},{name:"Adobe",symbol:"ADBE",price:"545.80",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"248B"},{name:"Snowflake",symbol:"SNOW",price:"185.40",change:"+2.15%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"58B"},{name:"Palantir",symbol:"PLTR",price:"25.60",change:"+3.45%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"45M",cap:"52B"},{name:"Zoom",symbol:"ZM",price:"68.50",change:"+1.25%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"22B"},{name:"Datadog",symbol:"DDOG",price:"145.80",change:"+2.35%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"3M",cap:"48B"},{name:"CrowdStrike",symbol:"CRWD",price:"325.40",change:"+2.85%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"4M",cap:"78B"},{name:"Zscaler",symbol:"ZS",price:"185.60",change:"+1.95%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"2M",cap:"28B"},{name:"Okta",symbol:"OKTA",price:"95.40",change:"+1.65%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"3M",cap:"15B"},{name:"Twilio",symbol:"TWLO",price:"68.20",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"12B"},{name:"Shopify",symbol:"SHOP",price:"78.40",change:"+2.15%",category:"Equities",region:"Americas",country:"Canada",sector:"Technology",vol:"8M",cap:"98B"},{name:"Square",symbol:"SQ",price:"68.50",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"12M",cap:"42B"},{name:"Coinbase",symbol:"COIN",price:"185.40",change:"+4.25%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"45B"},{name:"Robinhood",symbol:"HOOD",price:"18.50",change:"+2.15%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"15M",cap:"16B"},{name:"SoFi",symbol:"SOFI",price:"8.50",change:"+1.85%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"45M",cap:"8B"},{name:"Rivian",symbol:"RIVN",price:"15.80",change:"+3.25%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"25M",cap:"15B"},{name:"Lucid",symbol:"LCID",price:"3.25",change:"+2.45%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"45M",cap:"7B"},{name:"NIO",symbol:"NIO",price:"5.80",change:"+1.95%",category:"Equities",region:"APAC",country:"China",sector:"Automotive",vol:"55M",cap:"12B"},{name:"XPeng",symbol:"XPEV",price:"8.50",change:"+2.15%",category:"Equities",region:"APAC",country:"China",sector:"Automotive",vol:"25M",cap:"8B"},{name:"Li Auto",symbol:"LI",price:"28.40",change:"+1.65%",category:"Equities",region:"APAC",country:"China",sector:"Automotive",vol:"12M",cap:"28B"},{name:"Rivian",symbol:"RIVN",price:"15.80",change:"+3.25%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"25M",cap:"15B"},{name:"Lucid",symbol:"LCID",price:"3.25",change:"+2.45%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"45M",cap:"7B"},{name:"Costco",symbol:"COST",price:"850.20",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"2M",cap:"375B"},{name:"Home Depot",symbol:"HD",price:"385.60",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"4M",cap:"385B"},{name:"Visa",symbol:"V",price:"285.40",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"585B"},{name:"Mastercard",symbol:"MA",price:"485.80",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"3M",cap:"425B"},{name:"Salesforce",symbol:"CRM",price:"285.40",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"8M",cap:"285B"},{name:"Cisco",symbol:"CSCO",price:"52.80",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"18M",cap:"215B"},{name:"IBM",symbol:"IBM",price:"185.60",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Technology",vol:"5M",cap:"168B"},{name:"Disney",symbol:"DIS",price:"112.40",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"15M",cap:"205B"},{name:"Lockheed Martin",symbol:"LMT",price:"485.20",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"1M",cap:"125B"},{name:"Raytheon",symbol:"RTX",price:"95.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"5M",cap:"145B"},{name:"General Motors",symbol:"GM",price:"42.60",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"18M",cap:"48B"},{name:"Ford",symbol:"F",price:"12.80",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Automotive",vol:"45M",cap:"52B"},{name:"Chipotle",symbol:"CMG",price:"2850.40",change:"+1.45%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"0.3M",cap:"78B"},{name:"Target",symbol:"TGT",price:"165.20",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"5M",cap:"75B"},{name:"Lowe's",symbol:"LOW",price:"225.60",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Retail",vol:"4M",cap:"135B"},{name:"Charles Schwab",symbol:"SCHW",price:"68.50",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"8M",cap:"125B"},{name:"BlackRock",symbol:"BLK",price:"825.40",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"0.5M",cap:"125B"},{name:"Berkshire Hathaway",symbol:"BRK.B",price:"385.60",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"4M",cap:"875B"},{name:"American Express",symbol:"AXP",price:"225.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Finance",vol:"3M",cap:"165B"},{name:"Honeywell",symbol:"HON",price:"215.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"3M",cap:"145B"},{name:"Deere",symbol:"DE",price:"385.40",change:"+1.25%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"2M",cap:"108B"},{name:"Union Pacific",symbol:"UNP",price:"245.60",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"3M",cap:"145B"},{name:"FedEx",symbol:"FDX",price:"285.40",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"2M",cap:"72B"},{name:"UPS",symbol:"UPS",price:"165.80",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"4M",cap:"145B"},{name:"Schlumberger",symbol:"SLB",price:"52.40",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"12M",cap:"75B"},{name:"Halliburton",symbol:"HAL",price:"38.60",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"8M",cap:"35B"},{name:"NextEra Energy",symbol:"NEE",price:"68.50",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Utilities",vol:"8M",cap:"145B"},{name:"Duke Energy",symbol:"DUK",price:"102.40",change:"+0.35%",category:"Equities",region:"Americas",country:"USA",sector:"Utilities",vol:"5M",cap:"78B"},{name:"Prologis",symbol:"PLD",price:"125.60",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Real Estate",vol:"4M",cap:"125B"},{name:"Freeport-McMoRan",symbol:"FCX",price:"42.60",change:"+1.25%",category:"Equities",region:"Americas",country:"USA",sector:"Materials",vol:"18M",cap:"62B"},{name:"Newmont",symbol:"NEM",price:"42.80",change:"+0.85%",category:"Equities",region:"Americas",country:"USA",sector:"Materials",vol:"12M",cap:"52B"},{name:"Northrop Grumman",symbol:"NOC",price:"485.60",change:"+0.75%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"0.8M",cap:"75B"},{name:"General Dynamics",symbol:"GD",price:"285.40",change:"+0.55%",category:"Equities",region:"Americas",country:"USA",sector:"Industrial",vol:"1.2M",cap:"78B"},{name:"Domino's",symbol:"DPZ",price:"425.60",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"0.5M",cap:"15B"},{name:"Yum Brands",symbol:"YUM",price:"142.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Consumer",vol:"2M",cap:"38B"},{name:"Marathon Petroleum",symbol:"MPC",price:"185.40",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"5M",cap:"68B"},{name:"Valero Energy",symbol:"VLO",price:"145.60",change:"+0.95%",category:"Equities",region:"Americas",country:"USA",sector:"Oil & Gas",vol:"6M",cap:"52B"},{name:"Southern Company",symbol:"SO",price:"72.80",change:"+0.25%",category:"Equities",region:"Americas",country:"USA",sector:"Utilities",vol:"6M",cap:"82B"},{name:"Equity Residential",symbol:"EQR",price:"62.40",change:"+0.45%",category:"Equities",region:"Americas",country:"USA",sector:"Real Estate",vol:"3M",cap:"25B"},{name:"Simon Property",symbol:"SPG",price:"145.80",change:"+0.65%",category:"Equities",region:"Americas",country:"USA",sector:"Real Estate",vol:"2M",cap:"48B"},{name:"Southern Copper",symbol:"SCCO",price:"85.40",change:"+1.15%",category:"Equities",region:"Americas",country:"USA",sector:"Materials",vol:"2M",cap:"68B"}]),F=S(()=>{const e=O.value.filter(e=>"Equities"===e.category),t=new Set(e.map(e=>e.region).filter(Boolean));return Array.from(t).sort()}),B=S(()=>{let e=O.value.filter(e=>"Equities"===e.category);"All"!==h.value&&(e=e.filter(e=>e.region===h.value));const t=new Set(e.map(e=>e.country).filter(Boolean));return Array.from(t).sort()}),U=S(()=>{let e=O.value.filter(e=>"Equities"===e.category);"All"!==h.value&&(e=e.filter(e=>e.region===h.value)),"All"!==m.value&&(e=e.filter(e=>e.country===m.value));const t=new Set(e.map(e=>e.sector).filter(Boolean));return Array.from(t).sort()}),V=S(()=>{let e=O.value.filter(e=>"Equities"===e.category);return"All"!==r.category&&(e=e.filter(e=>e.category===r.category)),"All"!==h.value&&(e=e.filter(e=>e.region===h.value)),"All"!==m.value&&(e=e.filter(e=>e.country===m.value)),"All"!==g.value&&(e=e.filter(e=>e.sector===g.value)),"Топ роста"===d.value?e=[...e].sort((e,t)=>{const a=parseFloat(e.change.replace("%",""));return parseFloat(t.change.replace("%",""))-a}):"Топ падения"===d.value?e=[...e].sort((e,t)=>parseFloat(e.change.replace("%",""))-parseFloat(t.change.replace("%",""))):"Высокий объём"===d.value&&(e=[...e].sort((e,t)=>{const a=parseFloat(e.vol?.replace(/[MB]/g,"")||"0");return parseFloat(t.vol?.replace(/[MB]/g,"")||"0")-a})),e}),H=e=>({Americas:"Америка",EMEA:"Европа, Ближний Восток, Африка",APAC:"Азия и Тихоокеанский регион"}[e]||e),G=e=>({USA:"США",UK:"Великобритания",Germany:"Германия",France:"Франция",Switzerland:"Швейцария",Netherlands:"Нидерланды",China:"Китай",Japan:"Япония","South Korea":"Южная Корея",Taiwan:"Тайвань",India:"Индия",Canada:"Канада",Australia:"Австралия",Russia:"Россия"}[e]||e),W=()=>{h.value="All",m.value="All",g.value="All"},q=e=>({Technology:"Технологии",Finance:"Финансы",Healthcare:"Здравоохранение",Energy:"Энергетика",Consumer:"Потребительские товары",Industrial:"Промышленность",Telecommunications:"Телекоммуникации",Materials:"Материалы","Real Estate":"Недвижимость",Utilities:"Коммунальные услуги","Oil & Gas":"Нефть и газ",Banking:"Банковский сектор",Retail:"Розничная торговля",Automotive:"Автомобильная промышленность"}[e]||e),Y=e=>{if(M.value.has(e))return"";const t=e.split(".")[0].toUpperCase(),a=j(t);return a&&(a.includes(".com")||a.includes(".ru")||a.includes(".cn"))?`https://logo.clearbit.com/${a}`:`https://assets.cdn.money.net/udata/images/logos/${t}.png`},j=e=>({AAPL:"apple.com",MSFT:"microsoft.com",GOOGL:"google.com",GOOG:"google.com",AMZN:"amazon.com",META:"meta.com",TSLA:"tesla.com",NVDA:"nvidia.com",NFLX:"netflix.com",AMD:"amd.com",INTC:"intel.com",QCOM:"qualcomm.com",AVGO:"broadcom.com",ORCL:"oracle.com",ADBE:"adobe.com",JPM:"jpmorganchase.com",BAC:"bankofamerica.com",WFC:"wellsfargo.com",GS:"goldmansachs.com",MS:"morganstanley.com",C:"citi.com",WMT:"walmart.com",PG:"pg.com",KO:"coca-cola.com",PEP:"pepsico.com",NKE:"nike.com",MCD:"mcdonalds.com",SBUX:"starbucks.com",JNJ:"jnj.com",PFE:"pfizer.com",MRK:"merck.com",ABBV:"abbvie.com",UNH:"unitedhealthgroup.com",LLY:"lilly.com",XOM:"exxonmobil.com",CVX:"chevron.com",COP:"conocophillips.com",BA:"boeing.com",CAT:"caterpillar.com",MMM:"3m.com",GE:"ge.com",T:"att.com",VZ:"verizon.com",TMUS:"t-mobile.com",BP:"bp.com",SHEL:"shell.com",AZN:"astrazeneca.com",UL:"unilever.com",DEO:"diageo.com",GSK:"gsk.com",VOD:"vodafone.com",SAP:"sap.com",SIEGY:"siemens.com",MBGYY:"mercedes-benz.com",BMWYY:"bmw.com",VWAGY:"volkswagen.com",ALIZY:"allianz.com",TTE:"totalenergies.com",LVMUY:"lvmh.com",LRLCY:"loreal.com",SNY:"sanofi.com",EADSY:"airbus.com",NSRGY:"nestle.com",NVS:"novartis.com",RHHBY:"roche.com",UBS:"ubs.com",ASML:"asml.com",UNLY:"unilever.com",ING:"ing.com",BABA:"alibaba.com",TCEHY:"tencent.com",JD:"jd.com",BIDU:"baidu.com",PNGAY:"pingan.com",IDCBY:"icbc.com.cn",CICHY:"ccb.com",BYDDY:"byd.com",TM:"toyota.com",SONY:"sony.com",SFTBY:"softbank.com",NTDOY:"nintendo.com",HMC:"honda.com",NSANY:"nissan.com",SSNLF:"samsung.com",HXSCL:"skhynix.com",LGEAF:"lg.com",TSM:"tsmc.com",SHOP:"shopify.com",RY:"rbc.com",CNI:"cn.ca",BHP:"bhp.com",RIO:"riotinto.com",CMWAY:"commbank.com.au",SBER:"sberbank.ru",GAZP:"gazprom.ru",LKOH:"lukoil.ru",ROSN:"rosneft.ru",GMKN:"nornickel.com",YNDX:"yandex.ru",MGNT:"magnit.ru",VTBR:"vtb.ru",TATN:"tatneft.ru",NVTK:"novatek.ru",SNGS:"surgutneftegas.ru",ALRS:"alrosa.ru",MTSS:"mts.ru",TRNFP:"transneft.ru"}[e]||`unknown-${e.toLowerCase()}.com`),X=e=>{const t=e.target,a=t.alt;M.value.add(a),t&&(t.style.display="none")},$={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>'},K={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'};return(t,a)=>(w(),i("div",Dze,[s("div",Pze,[s("div",Lze,[s("div",null,[s("h2",Nze,v("All"===e.category?"АКЦИИ":e.category.toUpperCase()),1),a[10]||(a[10]=s("p",{class:"section-subtitle font-mono"},"ЦЕНЫ И АНАЛИТИКА В РЕАЛЬНОМ ВРЕМЕНИ",-1))]),s("div",Oze,[(w(),i(p,null,f(o,(e,t)=>s("button",{key:e,onClick:t=>d.value=e,class:c(["tab-btn",{active:d.value===e}])},v(e),11,Fze)),64))])]),s("div",Bze,[s("div",Uze,[a[11]||(a[11]=s("span",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Регион",-1)),s("div",zze,[s("button",{onClick:a[0]||(a[0]=e=>y.value=!y.value),class:"px-4 py-2.5 bg-black/20 border border-white/10 rounded-xl text-sm text-white hover:border-indigo-500/50 transition-all flex items-center justify-between gap-3 min-w-[200px]"},[s("span",null,v("All"===h.value?"Все регионы":H(h.value)),1),u(K,{class:c("w-4 h-4 transition-transform "+(y.value?"rotate-180":""))},null,8,["class"])]),y.value?(w(),i("div",{key:0,onClick:a[2]||(a[2]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:a[1]||(a[1]=e=>A("All")),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+("All"===h.value?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все регионы ",2),(w(!0),i(p,null,f(F.value,e=>(w(),i("button",{key:e,onClick:t=>A(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+(h.value===e?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(H(e)),11,Vze))),128))])):l("",!0)])]),s("div",Hze,[a[12]||(a[12]=s("span",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Страна",-1)),s("div",Gze,[s("button",{onClick:a[3]||(a[3]=e=>"All"!==h.value&&(x.value=!x.value)),class:c("px-4 py-2.5 bg-black/20 border border-white/10 rounded-xl text-sm transition-all flex items-center justify-between gap-3 min-w-[200px] "+("All"===h.value?"opacity-50 cursor-not-allowed text-gray-500":"text-white hover:border-indigo-500/50 cursor-pointer"))},[s("span",null,v("All"===m.value?"Все страны":G(m.value)),1),u(K,{class:c("w-4 h-4 transition-transform "+(x.value&&"All"!==h.value?"rotate-180":""))},null,8,["class"])],2),x.value&&"All"!==h.value&&B.value.length>0?(w(),i("div",{key:0,onClick:a[5]||(a[5]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:a[4]||(a[4]=e=>I("All")),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+("All"===m.value?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все страны ",2),(w(!0),i(p,null,f(B.value,e=>(w(),i("button",{key:e,onClick:t=>I(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+(m.value===e?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(G(e)),11,Wze))),128))])):l("",!0)])]),s("div",qze,[a[13]||(a[13]=s("span",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Сектор",-1)),s("div",Yze,[s("button",{onClick:a[6]||(a[6]=e=>_.value=!_.value),class:"px-4 py-2.5 bg-black/20 border border-white/10 rounded-xl text-sm text-white hover:border-indigo-500/50 transition-all flex items-center justify-between gap-3 min-w-[200px]"},[s("span",null,v("All"===g.value?"Все сектора":q(g.value)),1),u(K,{class:c("w-4 h-4 transition-transform "+(_.value?"rotate-180":""))},null,8,["class"])]),_.value?(w(),i("div",{key:0,onClick:a[8]||(a[8]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:a[7]||(a[7]=e=>R("All")),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+("All"===g.value?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все сектора ",2),(w(!0),i(p,null,f(U.value,e=>(w(),i("button",{key:e,onClick:t=>R(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+(g.value===e?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(q(e)),11,jze))),128))])):l("",!0)])]),s("div",Xze,["All"!==h.value||"All"!==m.value||"All"!==g.value?(w(),i("button",{key:0,onClick:W,class:"px-4 py-2.5 text-xs font-bold text-gray-400 hover:text-white hover:bg-white/5 rounded-xl border border-white/5 hover:border-white/20 transition-all"}," Сбросить ")):l("",!0)])])]),T.value?(w(),i("div",$ze,[...a[14]||(a[14]=[s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-4 h-4 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"}),s("span",{class:"text-xs font-bold"},"Загрузка реальных данных...")],-1)])])):l("",!0),s("div",{class:c([{"opacity-50":T.value},"bg-black/20 rounded-2xl border border-white/5 overflow-y-auto custom-scrollbar flex-1 min-h-0 relative"])},[s("table",Kze,[a[15]||(a[15]=s("thead",{class:"sticky top-0 z-20"},[s("tr",{class:"bg-black/95 backdrop-blur-md border-b border-white/10"},[s("th",{class:"font-bold py-3.5 px-6 text-xs text-gray-400 uppercase tracking-wider",style:{"border-radius":"0.75rem 0 0 0"}},"Инструмент"),s("th",{class:"font-bold py-3.5 px-6 text-xs text-gray-400 uppercase tracking-wider text-right"},"Цена"),s("th",{class:"font-bold py-3.5 px-6 text-xs text-gray-400 uppercase tracking-wider text-right"},"Изменение 24ч"),s("th",{class:"font-bold py-3.5 px-6 text-xs text-gray-400 uppercase tracking-wider text-right hidden md:table-cell",style:{"border-radius":"0 0.75rem 0 0"}},"Детали")])],-1)),s("tbody",null,[(w(!0),i(p,null,f(V.value,e=>{return w(),i("tr",{key:e.symbol,onClick:a=>t.$emit("assetClick",e),class:"border-b border-white/5 hover:bg-white/5 transition-all duration-150 group cursor-pointer"},[s("td",Jze,[s("div",Qze,[s("button",{class:"opacity-0 group-hover:opacity-100 text-gray-500 hover:text-yellow-400 transition-all duration-150 flex-shrink-0",onClick:a[9]||(a[9]=E(()=>{},["stop"])),title:"Добавить в избранное"},[u($,{class:"w-4 h-4"})]),s("div",{class:c(`w-12 h-12 rounded-xl flex items-center justify-center text-xs font-bold shadow-md overflow-hidden flex-shrink-0 ${n=e.category,{Crypto:"bg-gradient-to-br from-orange-500/20 to-yellow-500/20 text-orange-400",Indices:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 text-blue-400",FX:"bg-gradient-to-br from-emerald-500/20 to-teal-500/20 text-emerald-400",Equities:"bg-gradient-to-br from-indigo-500/20 to-purple-500/20 text-indigo-400"}[n]||"bg-gradient-to-br from-purple-500/20 to-pink-500/20 text-purple-400"}`)},[!M.value.has(e.symbol)&&Y(e.symbol)?(w(),i("img",{key:0,src:Y(e.symbol),alt:e.symbol,onError:X,class:"w-full h-full object-cover",loading:"lazy"},null,40,eVe)):(w(),i("span",tVe,v(e.symbol.substring(0,2)),1))],2),s("div",aVe,[s("div",nVe,v(e.symbol),1),s("div",rVe,[s("span",iVe,v(e.name),1),s("span",oVe,v(e.category),1)])])])]),s("td",sVe,[s("div",lVe,v(e.price),1)]),s("td",cVe,[s("div",{class:c("inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold "+(e.change.startsWith("+")?"bg-emerald-500/15 text-emerald-400 border border-emerald-500/20":"bg-rose-500/15 text-rose-400 border border-rose-500/20"))},[(w(),b(C(e.change.startsWith("+")?"TrendingUpIcon":"TrendingDownIcon"),{class:"w-3.5 h-3.5 flex-shrink-0"})),s("span",uVe,v(e.change),1)],2)]),s("td",dVe,[s("div",hVe,[e.cap?(w(),i("span",pVe,v(e.cap),1)):(w(),i("span",fVe,"-"))])])],8,Zze);var n}),128))])])],2)]))}}),vVe={class:"page-container custom-scrollbar"},gVe={class:"section-header flex-col gap-4"},yVe={class:"flex justify-between items-center w-full"},bVe={class:"tab-group"},xVe=["onClick"],wVe={class:"flex flex-wrap items-center gap-3"},_Ve={class:"relative","data-dropdown-type":""},SVe={class:"relative"},MVe=["onClick"],TVe={class:"relative","data-dropdown-cap":""},kVe={class:"relative"},CVe=["onClick"],AVe={class:"flex items-end"},EVe={key:0,class:"flex items-center justify-center py-8 text-gray-400 flex-shrink-0"},IVe={class:"w-full text-left border-collapse"},RVe={class:"text-sm font-medium"},DVe=["onClick"],PVe={class:"py-4 px-4 pl-0"},LVe={class:"flex items-center gap-4"},NVe={class:"w-10 h-10 rounded-xl flex items-center justify-center text-xs font-bold shadow-lg bg-gradient-to-br from-orange-500/20 to-yellow-500/20 text-orange-400"},OVe={class:"text-white font-bold text-base"},FVe={class:"text-xs text-gray-500 flex items-center gap-2"},BVe={class:"py-4 px-4 text-right font-mono text-white text-base"},UVe={class:"py-4 px-4 text-right"},zVe={class:"font-mono font-bold"},VVe={class:"py-4 px-4 text-right text-gray-400 hidden md:table-cell font-mono"},HVe=e({__name:"CryptoPage",emits:["navigate","assetClick"],setup(e,{emit:a}){const r=["Топ роста","Топ падения","Высокий объём"],o=t("Топ роста"),d=t("All"),h=t("All"),g=t(!1),y=t(!1),x=["Mega","Large","Mid","Small","Micro"],_=t(!1),M=t(!0),T=t([{name:"Bitcoin",symbol:"BTC",price:"64,230.50",change:"+2.45%",cap:"1.2T",vol:"35B",category:"Crypto",region:"Layer1"},{name:"Ethereum",symbol:"ETH",price:"3,450.20",change:"-1.12%",cap:"400B",vol:"15B",category:"Crypto",region:"Layer1"},{name:"Solana",symbol:"SOL",price:"148.50",change:"+5.67%",cap:"65B",vol:"4B",category:"Crypto",region:"Layer1"},{name:"Cardano",symbol:"ADA",price:"0.45",change:"+1.20%",cap:"16B",vol:"400M",category:"Crypto",region:"Layer1"},{name:"Avalanche",symbol:"AVAX",price:"38.50",change:"+4.20%",cap:"14.5B",vol:"320M",category:"Crypto",region:"Layer1"},{name:"Polkadot",symbol:"DOT",price:"7.25",change:"+3.10%",cap:"9.5B",vol:"250M",category:"Crypto",region:"Layer1"},{name:"Cosmos",symbol:"ATOM",price:"8.45",change:"+2.15%",cap:"3.2B",vol:"85M",category:"Crypto",region:"Layer1"},{name:"Near Protocol",symbol:"NEAR",price:"5.80",change:"+1.85%",cap:"6.1B",vol:"120M",category:"Crypto",region:"Layer1"},{name:"Algorand",symbol:"ALGO",price:"0.18",change:"+0.95%",cap:"1.4B",vol:"45M",category:"Crypto",region:"Layer1"},{name:"Tezos",symbol:"XTZ",price:"0.95",change:"-0.25%",cap:"950M",vol:"28M",category:"Crypto",region:"Layer1"},{name:"Hedera",symbol:"HBAR",price:"0.08",change:"+1.45%",cap:"2.8B",vol:"65M",category:"Crypto",region:"Layer1"},{name:"Fantom",symbol:"FTM",price:"0.42",change:"+3.25%",cap:"1.2B",vol:"55M",category:"Crypto",region:"Layer1"},{name:"Aptos",symbol:"APT",price:"9.25",change:"+2.60%",cap:"4.1B",vol:"180M",category:"Crypto",region:"Layer1"},{name:"Sui",symbol:"SUI",price:"1.85",change:"+1.95%",cap:"2.3B",vol:"95M",category:"Crypto",region:"Layer1"},{name:"Shiba Inu",symbol:"SHIB",price:"0.000025",change:"+4.50%",cap:"14.8B",vol:"850M",category:"Crypto",region:"Meme"},{name:"Polygon",symbol:"MATIC",price:"0.85",change:"-0.30%",cap:"7.8B",vol:"150M",category:"Crypto",region:"Layer2"},{name:"Arbitrum",symbol:"ARB",price:"1.25",change:"+2.15%",cap:"3.2B",vol:"280M",category:"Crypto",region:"Layer2"},{name:"Optimism",symbol:"OP",price:"2.45",change:"+1.85%",cap:"2.8B",vol:"185M",category:"Crypto",region:"Layer2"},{name:"Immutable X",symbol:"IMX",price:"2.15",change:"+3.40%",cap:"3.1B",vol:"95M",category:"Crypto",region:"Layer2"},{name:"Loopring",symbol:"LRC",price:"0.28",change:"+1.25%",cap:"380M",vol:"25M",category:"Crypto",region:"Layer2"},{name:"Starknet",symbol:"STRK",price:"1.15",change:"+2.85%",cap:"1.6B",vol:"120M",category:"Crypto",region:"Layer2"},{name:"Uniswap",symbol:"UNI",price:"6.20",change:"+2.50%",cap:"4.6B",vol:"95M",category:"Crypto",region:"DeFi"},{name:"Chainlink",symbol:"LINK",price:"14.80",change:"+1.85%",cap:"8.2B",vol:"180M",category:"Crypto",region:"DeFi"},{name:"Aave",symbol:"AAVE",price:"95.40",change:"+1.45%",cap:"1.4B",vol:"85M",category:"Crypto",region:"DeFi"},{name:"Maker",symbol:"MKR",price:"2,850.60",change:"+0.95%",cap:"2.7B",vol:"45M",category:"Crypto",region:"DeFi"},{name:"Compound",symbol:"COMP",price:"58.20",change:"+1.25%",cap:"450M",vol:"28M",category:"Crypto",region:"DeFi"},{name:"Curve",symbol:"CRV",price:"0.65",change:"+2.15%",cap:"680M",vol:"42M",category:"Crypto",region:"DeFi"},{name:"SushiSwap",symbol:"SUSHI",price:"1.25",change:"+1.85%",cap:"240M",vol:"35M",category:"Crypto",region:"DeFi"},{name:"PancakeSwap",symbol:"CAKE",price:"2.85",change:"+3.25%",cap:"750M",vol:"95M",category:"Crypto",region:"DeFi"},{name:"1inch",symbol:"1INCH",price:"0.45",change:"+1.15%",cap:"540M",vol:"38M",category:"Crypto",region:"DeFi"},{name:"Yearn Finance",symbol:"YFI",price:"8,450.20",change:"+0.85%",cap:"280M",vol:"18M",category:"Crypto",region:"DeFi"},{name:"Synthetix",symbol:"SNX",price:"2.95",change:"+2.45%",cap:"950M",vol:"55M",category:"Crypto",region:"DeFi"},{name:"Balancer",symbol:"BAL",price:"4.25",change:"+1.65%",cap:"240M",vol:"15M",category:"Crypto",region:"DeFi"},{name:"Convex Finance",symbol:"CVX",price:"3.85",change:"+2.25%",cap:"380M",vol:"28M",category:"Crypto",region:"DeFi"},{name:"Frax",symbol:"FRAX",price:"0.998",change:"+0.05%",cap:"650M",vol:"45M",category:"Crypto",region:"DeFi"},{name:"Lido",symbol:"LDO",price:"2.15",change:"+1.95%",cap:"1.9B",vol:"85M",category:"Crypto",region:"DeFi"},{name:"Tether",symbol:"USDT",price:"1.00",change:"+0.01%",cap:"95B",vol:"45B",category:"Crypto",region:"Stablecoin"},{name:"USD Coin",symbol:"USDC",price:"1.00",change:"+0.01%",cap:"28B",vol:"4.5B",category:"Crypto",region:"Stablecoin"},{name:"Dai",symbol:"DAI",price:"0.999",change:"+0.02%",cap:"5.2B",vol:"280M",category:"Crypto",region:"Stablecoin"},{name:"Binance USD",symbol:"BUSD",price:"1.00",change:"0.00%",cap:"1.8B",vol:"450M",category:"Crypto",region:"Stablecoin"},{name:"TrueUSD",symbol:"TUSD",price:"1.00",change:"+0.01%",cap:"480M",vol:"85M",category:"Crypto",region:"Stablecoin"},{name:"Ripple",symbol:"XRP",price:"0.62",change:"-0.45%",cap:"34B",vol:"1.2B",category:"Crypto",region:"Payment"},{name:"Litecoin",symbol:"LTC",price:"82.40",change:"+0.95%",cap:"6.1B",vol:"280M",category:"Crypto",region:"Payment"},{name:"Bitcoin Cash",symbol:"BCH",price:"245.60",change:"-0.15%",cap:"4.8B",vol:"120M",category:"Crypto",region:"Payment"},{name:"Stellar",symbol:"XLM",price:"0.12",change:"+0.85%",cap:"3.5B",vol:"95M",category:"Crypto",region:"Payment"},{name:"Dash",symbol:"DASH",price:"28.50",change:"+1.25%",cap:"320M",vol:"28M",category:"Crypto",region:"Payment"},{name:"Monero",symbol:"XMR",price:"145.80",change:"+0.65%",cap:"2.6B",vol:"85M",category:"Crypto",region:"Payment"},{name:"Zcash",symbol:"ZEC",price:"24.85",change:"+1.15%",cap:"380M",vol:"35M",category:"Crypto",region:"Payment"},{name:"The Sandbox",symbol:"SAND",price:"0.45",change:"+2.85%",cap:"950M",vol:"85M",category:"Crypto",region:"NFT"},{name:"Decentraland",symbol:"MANA",price:"0.42",change:"+1.95%",cap:"780M",vol:"65M",category:"Crypto",region:"NFT"},{name:"Axie Infinity",symbol:"AXS",price:"7.25",change:"+3.15%",cap:"980M",vol:"95M",category:"Crypto",region:"NFT"},{name:"Enjin Coin",symbol:"ENJ",price:"0.28",change:"+1.45%",cap:"420M",vol:"35M",category:"Crypto",region:"NFT"},{name:"Flow",symbol:"FLOW",price:"0.85",change:"+2.25%",cap:"880M",vol:"55M",category:"Crypto",region:"NFT"},{name:"Immutable X",symbol:"IMX",price:"2.15",change:"+3.40%",cap:"3.1B",vol:"95M",category:"Crypto",region:"NFT"},{name:"ApeCoin",symbol:"APE",price:"1.85",change:"+4.25%",cap:"680M",vol:"120M",category:"Crypto",region:"NFT"},{name:"Dogecoin",symbol:"DOGE",price:"0.15",change:"+5.25%",cap:"21.5B",vol:"1.2B",category:"Crypto",region:"Meme"},{name:"Shiba Inu",symbol:"SHIB",price:"0.000025",change:"+4.50%",cap:"14.8B",vol:"850M",category:"Crypto",region:"Meme"},{name:"Pepe",symbol:"PEPE",price:"0.0000085",change:"+8.95%",cap:"3.6B",vol:"450M",category:"Crypto",region:"Meme"},{name:"Floki",symbol:"FLOKI",price:"0.00018",change:"+6.25%",cap:"1.7B",vol:"180M",category:"Crypto",region:"Meme"},{name:"Bonk",symbol:"BONK",price:"0.000025",change:"+12.50%",cap:"1.6B",vol:"280M",category:"Crypto",region:"Meme"},{name:"Dogwifhat",symbol:"WIF",price:"2.85",change:"+9.85%",cap:"2.8B",vol:"380M",category:"Crypto",region:"Meme"},{name:"Binance Coin",symbol:"BNB",price:"585.40",change:"+1.25%",cap:"88B",vol:"1.8B",category:"Crypto",region:"Exchange"},{name:"Cronos",symbol:"CRO",price:"0.12",change:"+1.85%",cap:"3.2B",vol:"45M",category:"Crypto",region:"Exchange"},{name:"KuCoin Token",symbol:"KCS",price:"10.25",change:"+0.95%",cap:"980M",vol:"18M",category:"Crypto",region:"Exchange"},{name:"Huobi Token",symbol:"HT",price:"4.85",change:"+1.45%",cap:"780M",vol:"25M",category:"Crypto",region:"Exchange"},{name:"OKB",symbol:"OKB",price:"52.40",change:"+0.85%",cap:"3.1B",vol:"35M",category:"Crypto",region:"Exchange"},{name:"FTX Token",symbol:"FTT",price:"1.25",change:"-2.15%",cap:"420M",vol:"15M",category:"Crypto",region:"Exchange"},{name:"Gala",symbol:"GALA",price:"0.042",change:"+3.85%",cap:"1.1B",vol:"95M",category:"Crypto",region:"Gaming"},{name:"The Sandbox",symbol:"SAND",price:"0.45",change:"+2.85%",cap:"950M",vol:"85M",category:"Crypto",region:"Gaming"},{name:"Axie Infinity",symbol:"AXS",price:"7.25",change:"+3.15%",cap:"980M",vol:"95M",category:"Crypto",region:"Gaming"},{name:"Illuvium",symbol:"ILV",price:"85.40",change:"+2.45%",cap:"380M",vol:"28M",category:"Crypto",region:"Gaming"},{name:"Star Atlas",symbol:"ATLAS",price:"0.0085",change:"+1.95%",cap:"180M",vol:"12M",category:"Crypto",region:"Gaming"},{name:"Fetch.ai",symbol:"FET",price:"1.85",change:"+4.25%",cap:"1.5B",vol:"120M",category:"Crypto",region:"AI"},{name:"SingularityNET",symbol:"AGIX",price:"0.42",change:"+3.15%",cap:"540M",vol:"65M",category:"Crypto",region:"AI"},{name:"Ocean Protocol",symbol:"OCEAN",price:"0.85",change:"+2.45%",cap:"480M",vol:"45M",category:"Crypto",region:"AI"},{name:"Render",symbol:"RNDR",price:"8.25",change:"+5.85%",cap:"3.2B",vol:"280M",category:"Crypto",region:"AI"},{name:"The Graph",symbol:"GRT",price:"0.28",change:"+1.85%",cap:"2.6B",vol:"95M",category:"Crypto",region:"AI"},{name:"Bittensor",symbol:"TAO",price:"425.60",change:"+6.25%",cap:"2.8B",vol:"85M",category:"Crypto",region:"AI"},{name:"Monero",symbol:"XMR",price:"145.80",change:"+0.65%",cap:"2.6B",vol:"85M",category:"Crypto",region:"Privacy"},{name:"Zcash",symbol:"ZEC",price:"24.85",change:"+1.15%",cap:"380M",vol:"35M",category:"Crypto",region:"Privacy"},{name:"Dash",symbol:"DASH",price:"28.50",change:"+1.25%",cap:"320M",vol:"28M",category:"Crypto",region:"Privacy"},{name:"Horizen",symbol:"ZEN",price:"8.45",change:"+0.95%",cap:"125M",vol:"8M",category:"Crypto",region:"Privacy"},{name:"Filecoin",symbol:"FIL",price:"5.85",change:"+2.15%",cap:"3.1B",vol:"180M",category:"Crypto",region:"Infrastructure"},{name:"Arweave",symbol:"AR",price:"28.50",change:"+3.45%",cap:"1.9B",vol:"65M",category:"Crypto",region:"Infrastructure"},{name:"Helium",symbol:"HNT",price:"4.25",change:"+1.85%",cap:"680M",vol:"35M",category:"Crypto",region:"Infrastructure"},{name:"Theta Network",symbol:"THETA",price:"1.85",change:"+2.25%",cap:"1.8B",vol:"55M",category:"Crypto",region:"Infrastructure"},{name:"Basic Attention Token",symbol:"BAT",price:"0.28",change:"+1.15%",cap:"420M",vol:"28M",category:"Crypto",region:"Infrastructure"},{name:"Tron",symbol:"TRX",price:"0.12",change:"+1.45%",cap:"10.5B",vol:"450M",category:"Crypto",region:"Layer1"},{name:"Toncoin",symbol:"TON",price:"6.25",change:"+3.85%",cap:"14.2B",vol:"280M",category:"Crypto",region:"Layer1"},{name:"Internet Computer",symbol:"ICP",price:"12.85",change:"+2.15%",cap:"5.8B",vol:"95M",category:"Crypto",region:"Layer1"},{name:"VeChain",symbol:"VET",price:"0.035",change:"+1.95%",cap:"2.5B",vol:"65M",category:"Crypto",region:"Layer1"},{name:"Theta Fuel",symbol:"TFUEL",price:"0.085",change:"+2.45%",cap:"450M",vol:"18M",category:"Crypto",region:"Layer1"},{name:"EOS",symbol:"EOS",price:"0.75",change:"+0.85%",cap:"850M",vol:"45M",category:"Crypto",region:"Layer1"},{name:"Waves",symbol:"WAVES",price:"2.45",change:"+1.25%",cap:"280M",vol:"25M",category:"Crypto",region:"Layer1"},{name:"Zilliqa",symbol:"ZIL",price:"0.025",change:"+1.65%",cap:"450M",vol:"35M",category:"Crypto",region:"Layer1"},{name:"Harmony",symbol:"ONE",price:"0.018",change:"+2.85%",cap:"240M",vol:"18M",category:"Crypto",region:"Layer1"},{name:"Elrond",symbol:"EGLD",price:"42.50",change:"+1.45%",cap:"1.1B",vol:"45M",category:"Crypto",region:"Layer1"},{name:"MultiversX",symbol:"EGLD",price:"42.50",change:"+1.45%",cap:"1.1B",vol:"45M",category:"Crypto",region:"Layer1"},{name:"Celo",symbol:"CELO",price:"0.85",change:"+1.95%",cap:"450M",vol:"28M",category:"Crypto",region:"Layer1"},{name:"Klaytn",symbol:"KLAY",price:"0.18",change:"+1.25%",cap:"680M",vol:"35M",category:"Crypto",region:"Layer1"},{name:"Terra Classic",symbol:"LUNC",price:"0.00012",change:"+3.25%",cap:"720M",vol:"85M",category:"Crypto",region:"Layer1"},{name:"Terra",symbol:"LUNA",price:"0.65",change:"+2.15%",cap:"450M",vol:"45M",category:"Crypto",region:"Layer1"}]),k=async()=>{try{console.log("🔄 Loading popular cryptos from API...");const e=await(async()=>{try{const e=await fetch(`${Eze}/api/market/crypto/popular`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(t.detail||`HTTP error! status: ${e.status}`)}return await e.json()}catch(QXe){throw console.error("Failed to fetch popular cryptos:",QXe),QXe}})();console.log(`✅ Loaded ${e.length} popular cryptos from API`);const t=new Set(T.value.map(e=>e.symbol));let a=0;e.forEach(e=>{const n=e.replace("-USD","");if(!t.has(n)){const e=(e=>{const t=e.toUpperCase();return["BTC","ETH","SOL","ADA","AVAX","DOT","ATOM","NEAR","ALGO","XTZ","HBAR","FTM","APT","SUI","TRX","TON","ICP","VET","EOS","WAVES","ZIL","ONE","EGLD","CELO","KLAY","LUNC","LUNA"].includes(t)?"Layer1":["MATIC","ARB","OP","IMX","LRC","STRK"].includes(t)?"Layer2":["UNI","LINK","AAVE","MKR","COMP","CRV","SUSHI","CAKE","1INCH","YFI","SNX","BAL","CVX","FRAX","LDO"].includes(t)?"DeFi":["USDT","USDC","DAI","BUSD","TUSD","USDP","GUSD","HUSD"].includes(t)?"Stablecoin":["XRP","LTC","BCH","XLM","DASH","XMR","ZEC"].includes(t)?"Payment":["SAND","MANA","AXS","ENJ","FLOW","IMX","APE"].includes(t)?"NFT":["DOGE","SHIB","PEPE","FLOKI","BONK","WIF","MEME","MYRO","POPCAT","MEW"].includes(t)?"Meme":["BNB","CRO","KCS","HT","OKB","FTT","LEO","GT"].includes(t)?"Exchange":["GALA","ILV","ATLAS","POLIS","MAGIC","GMT","GFT","HOOK","HFT"].includes(t)?"Gaming":["FET","AGIX","OCEAN","RNDR","TAO","AI","OLAS","ARKM","GLM","NMR","CTXC","DBC","VXV","COTI","GRT"].includes(t)?"AI":["XMR","ZEC","DASH","ZEN"].includes(t)?"Privacy":["FIL","AR","HNT","THETA","BAT"].includes(t)?"Infrastructure":"Layer1"})(n);T.value.push({name:n,symbol:n,price:"0.00",change:"+0.00%",cap:"-",vol:"-",category:"Crypto",region:e}),t.add(n),a++}}),console.log(`✅ Added ${a} new cryptos to the list`)}catch(QXe){console.error("❌ Error loading popular cryptos:",QXe),console.warn("⚠️ Using static cryptos only")}},A=async()=>{if(M.value){_.value=!0;try{await k();const e=T.value.map(e=>`${e.symbol}-USD`);console.log("🔄 Loading market data for",e.length,"cryptos...");const t=20;let a=0;for(let n=0;n<e.length;n+=t){const r=e.slice(n,n+t);console.log(`📦 Loading batch ${Math.floor(n/t)+1}/${Math.ceil(e.length/t)} (${r.length} cryptos)...`);const i=r.map(async e=>{try{const t=await Rze(e),n=e.replace("-USD",""),r=T.value.findIndex(e=>e.symbol===n);if(-1!==r){if(T.value[r].price=t.price.toFixed(2),T.value[r].change=`${t.changePercent>=0?"+":""}${t.changePercent.toFixed(2)}%`,T.value[r].name=t.name||n,t.marketCap){const e=t.marketCap/1e9;T.value[r].cap=e>=1e3?`${(e/1e3).toFixed(1)}T`:`${e.toFixed(2)}B`}if(t.volume){const e=t.volume/1e6;T.value[r].vol=e>=1e3?`${(e/1e3).toFixed(2)}B`:`${e.toFixed(2)}M`}a++}}catch(QXe){console.warn(`⚠️ Error loading ${e}:`,QXe.message)}});await Promise.all(i),n+t<e.length&&await new Promise(e=>setTimeout(e,500))}console.log(`✅ Updated ${a} cryptos with real data`)}catch(QXe){console.error("❌ Error loading real crypto data:",QXe),console.warn("⚠️ Falling back to static data"),M.value=!1}finally{_.value=!1,console.log("🏁 Crypto data loading finished")}}else console.log("Real data loading is disabled")},I=S(()=>{const e=new Set(T.value.map(e=>e.region).filter(Boolean));return Array.from(e).sort()}),R=S(()=>{let e=[...T.value];return"All"!==d.value&&(e=e.filter(e=>e.region===d.value)),"All"!==h.value&&(e=e.filter(e=>{const t=D(e.cap||"0");switch(h.value){case"Mega":return t>=100;case"Large":return t>=10&&t<100;case"Mid":return t>=1&&t<10;case"Small":return t>=.1&&t<1;case"Micro":return t<.1;default:return!0}})),"Топ роста"===o.value?e=e.sort((e,t)=>{const a=parseFloat(e.change.replace("%",""));return parseFloat(t.change.replace("%",""))-a}):"Топ падения"===o.value?e=e.sort((e,t)=>parseFloat(e.change.replace("%",""))-parseFloat(t.change.replace("%",""))):"Высокий объём"===o.value&&(e=e.sort((e,t)=>{const a=P(e.vol||"0");return P(t.vol||"0")-a})),e}),D=e=>e.includes("T")?1e3*parseFloat(e.replace("T","")):e.includes("B")?parseFloat(e.replace("B","")):e.includes("M")?parseFloat(e.replace("M",""))/1e3:0,P=e=>e.includes("B")?1e3*parseFloat(e.replace("B","")):e.includes("M")?parseFloat(e.replace("M","")):0,L=e=>({Layer1:"Layer 1",Layer2:"Layer 2",DeFi:"DeFi",Stablecoin:"Стейблкоины",Payment:"Платежи",NFT:"NFT & Metaverse",Meme:"Мем-коины",Exchange:"Биржевые токены",Gaming:"Игровые",AI:"AI & Big Data",Privacy:"Приватность",Infrastructure:"Инфраструктура"}[e]||e),N=e=>({Mega:"Мега (>100B)",Large:"Крупные (10B-100B)",Mid:"Средние (1B-10B)",Small:"Малые (100M-1B)",Micro:"Микро (<100M)"}[e]||e),O=e=>{d.value=e,g.value=!1},F=e=>{h.value=e,y.value=!1},B=()=>{d.value="All",h.value="All"};let U=null,V=null;n(()=>{U=e=>{const t=e.target;t.closest("[data-dropdown-type]")||t.closest("[data-dropdown-cap]")||(g.value=!1,y.value=!1)},document.addEventListener("click",U),A(),V=setInterval(()=>{A()},6e4)}),z(()=>{U&&document.removeEventListener("click",U),V&&clearInterval(V)});const H={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>'},G={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'};return(e,t)=>(w(),i("div",vVe,[s("div",gVe,[s("div",yVe,[t[7]||(t[7]=s("div",null,[s("h2",{class:"section-title font-anton"},"КРИПТОВАЛЮТЫ"),s("p",{class:"section-subtitle font-mono"},"ЦЕНЫ И АНАЛИТИКА В РЕАЛЬНОМ ВРЕМЕНИ")],-1)),s("div",bVe,[(w(),i(p,null,f(r,e=>s("button",{key:e,onClick:t=>o.value=e,class:c(["tab-btn",{active:o.value===e}])},v(e),11,xVe)),64))])]),s("div",wVe,[s("div",_Ve,[t[8]||(t[8]=s("span",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Тип",-1)),s("div",SVe,[s("button",{onClick:t[0]||(t[0]=e=>g.value=!g.value),class:"px-4 py-2.5 bg-black/20 border border-white/10 rounded-xl text-sm text-white hover:border-indigo-500/50 transition-all flex items-center justify-between gap-3 min-w-[180px]"},[s("span",null,v("All"===d.value?"Все типы":L(d.value)),1),u(G,{class:c("w-4 h-4 transition-transform "+(g.value?"rotate-180":""))},null,8,["class"])]),g.value?(w(),i("div",{key:0,onClick:t[2]||(t[2]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:t[1]||(t[1]=e=>O("All")),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+("All"===d.value?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все типы ",2),(w(!0),i(p,null,f(I.value,e=>(w(),i("button",{key:e,onClick:t=>O(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+(d.value===e?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(L(e)),11,MVe))),128))])):l("",!0)])]),s("div",TVe,[t[9]||(t[9]=s("span",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Капитализация",-1)),s("div",kVe,[s("button",{onClick:t[3]||(t[3]=e=>y.value=!y.value),class:"px-4 py-2.5 bg-black/20 border border-white/10 rounded-xl text-sm text-white hover:border-indigo-500/50 transition-all flex items-center justify-between gap-3 min-w-[180px]"},[s("span",null,v("All"===h.value?"Все":N(h.value)),1),u(G,{class:c("w-4 h-4 transition-transform "+(y.value?"rotate-180":""))},null,8,["class"])]),y.value?(w(),i("div",{key:0,onClick:t[5]||(t[5]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:t[4]||(t[4]=e=>F("All")),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+("All"===h.value?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все ",2),(w(),i(p,null,f(x,e=>s("button",{key:e,onClick:t=>F(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors "+(h.value===e?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(N(e)),11,CVe)),64))])):l("",!0)])]),s("div",AVe,["All"!==d.value||"All"!==h.value?(w(),i("button",{key:0,onClick:B,class:"px-4 py-2.5 text-xs font-bold text-gray-400 hover:text-white hover:bg-white/5 rounded-xl border border-white/5 hover:border-white/20 transition-all"}," Сбросить ")):l("",!0)])])]),_.value?(w(),i("div",EVe,[...t[10]||(t[10]=[s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-4 h-4 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),s("span",{class:"text-xs font-bold"},"Загрузка реальных данных...")],-1)])])):l("",!0),s("div",{class:c(["overflow-auto custom-scrollbar flex-1",{"opacity-50":_.value}])},[s("table",IVe,[t[12]||(t[12]=s("thead",null,[s("tr",{class:"text-xs text-gray-500 border-b border-white/5 uppercase tracking-wider"},[s("th",{class:"font-bold py-4 px-4 pl-0"},"Инструмент"),s("th",{class:"font-bold py-4 px-4 text-right"},"Цена"),s("th",{class:"font-bold py-4 px-4 text-right"},"Изменение 24ч"),s("th",{class:"font-bold py-4 px-4 text-right hidden md:table-cell"},"Детали")])],-1)),s("tbody",RVe,[(w(!0),i(p,null,f(R.value,a=>(w(),i("tr",{key:a.symbol,onClick:t=>e.$emit("assetClick",a),class:"border-b border-white/5 hover:bg-white/5 transition-colors group cursor-pointer"},[s("td",PVe,[s("div",LVe,[s("button",{class:"text-gray-600 hover:text-yellow-400 transition-colors",onClick:t[6]||(t[6]=E(()=>{},["stop"]))},[u(H,{class:"w-4 h-4"})]),s("div",NVe,v(a.symbol.substring(0,2)),1),s("div",null,[s("div",OVe,v(a.symbol),1),s("div",FVe,[m(v(a.name)+" ",1),t[11]||(t[11]=s("span",{class:"px-1.5 py-0.5 rounded bg-white/5 text-[10px] uppercase text-gray-400"},"Крипто",-1))])])])]),s("td",BVe,v(a.price),1),s("td",UVe,[s("div",{class:c("inline-flex items-center gap-1 px-2 py-1 rounded-lg "+(a.change.startsWith("+")?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"))},[(w(),b(C(a.change.startsWith("+")?"TrendingUpIcon":"TrendingDownIcon"),{class:"w-3 h-3"})),s("span",zVe,v(a.change),1)],2)]),s("td",VVe,v(a.cap?`Кап: ${a.cap}`:"-"),1)],8,DVe))),128))])])],2)]))}}),GVe={class:"page-container custom-scrollbar"},WVe={class:"section-header flex-col md:flex-row gap-4"},qVe={class:"flex items-center gap-4"},YVe={class:"icon-box icon-indigo"},jVe={class:"section-subtitle font-mono"},XVe={class:"tab-group"},$Ve=["onClick"],KVe={class:"flex-1 flex flex-col gap-4"},ZVe={key:0,class:"flex flex-col gap-4"},JVe={class:"news-meta"},QVe={class:"news-source"},eHe={class:"news-source flex items-center gap-1"},tHe={class:"news-title"},aHe={key:1,class:"flex flex-col gap-6"},nHe={class:"search-box max-w-md"},rHe={key:2,class:"flex flex-col gap-6"},iHe={class:"data-panel text-center"},oHe={class:"search-box max-w-2xl mx-auto relative"},sHe={class:"btn btn-primary absolute right-2 top-1/2 -translate-y-1/2 h-10"},lHe={class:"flex justify-center gap-3 mt-6"},cHe={key:3,class:"flex flex-col gap-6"},uHe={class:"flex flex-col gap-3"},dHe={class:"flex items-center gap-4"},hHe={class:"font-mono text-xs text-[var(--text-muted)]"},pHe={class:"flex items-center gap-4"},fHe={class:"font-mono text-xs text-[var(--text-muted)]"},mHe={key:4,class:"grid-2"},vHe={class:"data-panel flex flex-col"},gHe={class:"data-panel-header"},yHe={class:"icon-box-sm icon-indigo"},bHe={class:"flex-1 flex flex-col gap-3 overflow-y-auto custom-scrollbar"},xHe={class:"font-oswald text-sm group-hover:text-[var(--accent-red)] mb-2"},wHe={class:"data-panel relative overflow-hidden",style:{"border-color":"rgba(220, 38, 38, 0.3)"}},_He={class:"absolute top-0 right-0 p-8 opacity-10"},SHe={key:5,class:"flex flex-col gap-6"},MHe={class:"flex flex-col gap-4"},THe={class:"flex items-center gap-4"},kHe={class:"icon-box group-hover:icon-red"},CHe={class:"font-oswald text-base mb-1"},AHe={class:"flex items-center gap-3 font-mono text-xs text-[var(--text-muted)]"},EHe={class:"uppercase tracking-wider"},IHe={class:"btn btn-outline"},RHe=e({__name:"NewsPage",props:{activeSection:{default:"TOP"}},setup(e){const a=e,n=t(a.activeSection);R(()=>a.activeSection,e=>{n.value=e});const r=[{id:"TOP",label:"Онлайн",icon:"ZapIcon",description:"Актуальные новости рынка в реальном времени"},{id:"CN",label:"Компании",icon:"NewspaperIcon",description:"Новости и события по конкретным компаниям"},{id:"NSRC",label:"Поиск",icon:"SearchIcon",description:"Глубокий поиск по рынку, компаниям и инвесторам"},{id:"SALT",label:"Уведомления",icon:"BellIcon",description:"Управление умными уведомлениями и триггерами"},{id:"FIRS",label:"Резюме",icon:"BotIcon",description:"AI-резюме по трендовым темам и событиям"},{id:"BRIE",label:"Обзоры",icon:"BookOpenIcon",description:"Ежедневные, еженедельные и ежемесячные рыночные обзоры"}],o=S(()=>r.find(e=>e.id===n.value)||r[0]),d=[{id:1,title:"Bitcoin достиг исторического максимума на фоне институционального ажиотажа",source:"Bloomberg",time:"2 мин назад",importance:"High",sentiment:"Bullish"},{id:2,title:"Федеральная резервная система назначила экстренное заседание на понедельник",source:"Reuters",time:"15 мин назад",importance:"Critical",sentiment:"Bearish"},{id:3,title:"NVIDIA анонсировала революционный AI-чип 'Rubin'",source:"TechCrunch",time:"42 мин назад",importance:"High",sentiment:"Bullish"},{id:4,title:"Цены на нефть снижаются по мере небольшого ослабления напряжённости на Ближнем Востоке",source:"CNBC",time:"1 ч назад",importance:"Medium",sentiment:"Neutral"},{id:5,title:"Apple сообщила о рекордной выручке от услуг в Q3",source:"MarketWatch",time:"2 ч назад",importance:"Medium",sentiment:"Bullish"},{id:6,title:"Microsoft объявляет о крупнейшем инвестиционном раунде в OpenAI на $10 млрд",source:"TechCrunch",time:"3 ч назад",importance:"High",sentiment:"Bullish"},{id:7,title:"Tesla запускает производство новой модели Model Y+ с увеличенным запасом хода",source:"Reuters",time:"4 ч назад",importance:"Medium",sentiment:"Bullish"},{id:8,title:"Amazon Web Services сообщает о росте выручки на 25% в облачном сегменте",source:"Bloomberg",time:"5 ч назад",importance:"High",sentiment:"Bullish"},{id:9,title:"Meta Platforms представляет новую AR-платформу для бизнеса",source:"The Verge",time:"6 ч назад",importance:"Medium",sentiment:"Bullish"},{id:10,title:"JPMorgan Chase увеличивает дивиденды после сильных квартальных результатов",source:"Financial Times",time:"7 ч назад",importance:"High",sentiment:"Bullish"},{id:11,title:"AMD выпускает новые процессоры Ryzen 9000 с улучшенной энергоэффективностью",source:"TechCrunch",time:"8 ч назад",importance:"Medium",sentiment:"Bullish"},{id:12,title:"Exxon Mobil объявляет о новом месторождении в Мексиканском заливе",source:"Reuters",time:"9 ч назад",importance:"Medium",sentiment:"Neutral"},{id:13,title:"Google запускает новую версию поисковой системы с интеграцией AI",source:"The Verge",time:"10 ч назад",importance:"High",sentiment:"Bullish"},{id:14,title:"Pfizer получает одобрение FDA на новое лекарство от диабета",source:"Bloomberg",time:"11 ч назад",importance:"High",sentiment:"Bullish"},{id:15,title:"Intel сообщает о задержке выпуска следующего поколения чипов до 2026 года",source:"Reuters",time:"12 ч назад",importance:"Medium",sentiment:"Bearish"},{id:16,title:"Nike увеличивает прогнозы на год после роста продаж в Азии",source:"MarketWatch",time:"13 ч назад",importance:"Medium",sentiment:"Bullish"},{id:17,title:"Goldman Sachs объявляет о сокращении 3% персонала в инвестиционном банке",source:"Financial Times",time:"14 ч назад",importance:"High",sentiment:"Bearish"},{id:18,title:"Coca-Cola запускает новую линейку энергетических напитков",source:"CNBC",time:"15 ч назад",importance:"Medium",sentiment:"Neutral"},{id:19,title:"Bank of America сообщает о росте кредитных потерь в потребительском сегменте",source:"Reuters",time:"16 ч назад",importance:"High",sentiment:"Bearish"},{id:20,title:"Chevron объявляет о партнёрстве с Tesla для строительства сети зарядных станций",source:"Bloomberg",time:"17 ч назад",importance:"High",sentiment:"Bullish"},{id:21,title:"Apple представляет новый iPhone 16 Pro с улучшенной камерой и AI-функциями",source:"The Verge",time:"18 ч назад",importance:"High",sentiment:"Bullish"},{id:22,title:"Netflix сообщает о рекордном количестве подписчиков после запуска рекламного тарифа",source:"MarketWatch",time:"19 ч назад",importance:"Medium",sentiment:"Bullish"}],h=[{name:"Предупреждение о падении портфеля",condition:"Любой актив падает > 5%",active:!0},{name:"Новости NVIDIA",condition:'Ключевые слова: "Прибыль", "Musk"',active:!0},{name:"Ставки ФРС",condition:"Источник: Федеральная резервная система",active:!1},{name:"Прорыв Bitcoin",condition:"BTC > $70k",active:!0}],g=[{title:"Утренний звонок: Технологический ралли продолжается",date:"24 окт 2025",type:"Ежедневно"},{title:"Еженедельный обзор криптовалют: Потоки ETF",date:"21 окт 2025",type:"Еженедельно"},{title:"Макроэкономический прогноз: Проекции Q4",date:"01 окт 2025",type:"Ежемесячно"}],y=["Полупроводники","Warren Buffet","IPO","Слияния"],x=["Обновление о глобальном дефиците чипов","Анализ данных инфляции США","Законопроект о регулировании криптовалют 2025"],_={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>'},M={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>'},T={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="10" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>'},k={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>'},A={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>'},E={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>'},D={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>'},P={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>'};return(e,t)=>(w(),i("div",GVe,[s("div",WVe,[s("div",qVe,[s("div",YVe,[(w(),b(C(o.value.icon),{class:"w-5 h-5"}))]),s("div",null,[t[0]||(t[0]=s("h2",{class:"section-title font-anton"},"НОВОСТИ",-1)),s("p",jVe,v(o.value.description),1)])]),s("div",XVe,[(w(),i(p,null,f(r,e=>s("button",{key:e.id,onClick:t=>n.value=e.id,class:c(["tab-btn",{active:n.value===e.id}])},v(e.label),11,$Ve)),64))])]),s("div",KVe,["TOP"===n.value?(w(),i("div",ZVe,[t[2]||(t[2]=s("div",{class:"flex items-center justify-between"},[s("h3",{class:"font-oswald text-sm text-text-tertiary uppercase tracking-wider"},"ГЛАВНЫЕ НОВОСТИ"),s("div",{class:"badge badge-red"},[s("span",{class:"status-dot"}),m(" ОНЛАЙН ")])],-1)),(w(),i(p,null,f(d,e=>{return s("div",{key:e.id,class:c(["news-item",e.importance.toLowerCase()])},[s("div",JVe,[s("span",{class:c(["news-badge",{critical:"Critical"===e.importance}])},v((a=e.importance,{Critical:"КРИТИЧНО",High:"ВЫСОКАЯ",Medium:"СРЕДНЯЯ"}[a]||a.toUpperCase())),3),s("span",QVe,v(e.source),1),s("span",eHe,[u(A,{class:"w-2.5 h-2.5"}),m(" "+v(e.time),1)])]),s("h3",tHe,v(e.title),1),t[1]||(t[1]=s("div",{class:"flex items-center gap-4 mt-3"},[s("button",{class:"btn-ghost text-xs font-mono"},"ЧИТАТЬ ПОЛНОСТЬЮ"),s("button",{class:"btn-ghost text-xs font-mono"},"РЕЗЮМИРОВАТЬ")],-1))],2);var a}),64))])):"CN"===n.value?(w(),i("div",aHe,[s("div",nHe,[u(_,{class:"search-icon"}),t[3]||(t[3]=s("input",{type:"text",placeholder:"ВВЕДИТЕ ТИКЕР (НАПРИМЕР, NVDA, TSLA)",value:"NVDA"},null,-1))]),t[4]||(t[4]=I('<div class="data-panel flex items-center gap-6"><div class="icon-box icon-green"><span class="font-anton text-lg">NV</span></div><div><h3 class="font-anton text-2xl text-text-primary">NVIDIA CORPORATION</h3><div class="flex items-center gap-4 mt-2"><span class="font-mono text-3xl font-bold text-green">$892.10</span><span class="badge badge-green">+4.25%</span></div></div></div><div class="timeline"><div class="timeline-item"><div class="timeline-marker"><div class="timeline-dot active"></div><div class="timeline-line"></div></div><div class="timeline-content"><span class="timeline-date">СЕГОДНЯ, 10:30</span><h4 class="timeline-title">Подтверждено приобретение Run:ai за $700M</h4><p class="timeline-desc">NVIDIA официально подтвердила приобретение платформы оркестрации Kubernetes Run:ai для усиления возможностей управления инфраструктурой ИИ.</p></div></div><div class="timeline-item"><div class="timeline-marker"><div class="timeline-dot active"></div><div class="timeline-line"></div></div><div class="timeline-content"><span class="timeline-date">ВЧЕРА, 14:20</span><h4 class="timeline-title">NVIDIA анонсировала революционный AI-чип &#39;Rubin&#39;</h4><p class="timeline-desc">Компания представила новый графический процессор следующего поколения с улучшенной производительностью для обучения больших языковых моделей.</p></div></div><div class="timeline-item"><div class="timeline-marker"><div class="timeline-dot"></div><div class="timeline-line"></div></div><div class="timeline-content"><span class="timeline-date" style="color:var(--text-muted);">ВЧЕРА, 16:15</span><h4 class="timeline-title" style="color:var(--text-secondary);">Директор продал 5,000 акций</h4><p class="timeline-desc">Форма SEC 4 указывает, что директор продал акции по средней цене $850.20.</p></div></div><div class="timeline-item"><div class="timeline-marker"><div class="timeline-dot"></div><div class="timeline-line"></div></div><div class="timeline-content"><span class="timeline-date" style="color:var(--text-muted);">2 ДНЯ НАЗАД, 11:45</span><h4 class="timeline-title" style="color:var(--text-secondary);">Отчёт о прибылях и убытках превзошёл ожидания</h4><p class="timeline-desc">NVIDIA сообщила о выручке $22.1 млрд, что на 15% выше прогнозов аналитиков. Прибыль на акцию составила $4.50.</p></div></div><div class="timeline-item"><div class="timeline-marker"><div class="timeline-dot"></div><div class="timeline-line"></div></div><div class="timeline-content"><span class="timeline-date" style="color:var(--text-muted);">3 ДНЯ НАЗАД, 09:30</span><h4 class="timeline-title" style="color:var(--text-secondary);">Партнёрство с крупными облачными провайдерами</h4><p class="timeline-desc">Компания объявила о расширении сотрудничества с AWS, Microsoft Azure и Google Cloud для развёртывания AI-инфраструктуры.</p></div></div><div class="timeline-item"><div class="timeline-marker"><div class="timeline-dot"></div></div><div class="timeline-content"><span class="timeline-date" style="color:var(--text-muted);">5 ДНЕЙ НАЗАД, 15:00</span><h4 class="timeline-title" style="color:var(--text-secondary);">Запуск нового центра разработки в Сингапуре</h4><p class="timeline-desc">NVIDIA инвестирует $500M в создание нового исследовательского центра, специализирующегося на разработке AI-решений для Азиатско-Тихоокеанского региона.</p></div></div></div>',2))])):"NSRC"===n.value?(w(),i("div",rHe,[s("div",iHe,[t[6]||(t[6]=s("h3",{class:"font-anton text-2xl mb-6"},"ГЛУБОКИЙ ПОИСК ПО РЫНКУ",-1)),s("div",oHe,[u(_,{class:"search-icon"}),t[5]||(t[5]=s("input",{type:"text",placeholder:"ПОИСК ПО КОМПАНИИ, ИНВЕСТОРУ, СЕКТОРУ..."},null,-1)),s("button",sHe,[u(E,{class:"w-4 h-4"})])]),s("div",lHe,[(w(),i(p,null,f(y,e=>s("span",{key:e,class:"badge cursor-pointer hover:border-[var(--accent-red)] hover:color-[var(--accent-red)]"},v(e),1)),64))])])])):"SALT"===n.value?(w(),i("div",cHe,[t[7]||(t[7]=s("div",{class:"flex items-center justify-between"},[s("div",null,[s("h3",{class:"font-anton text-xl"},"УМНЫЕ УВЕДОМЛЕНИЯ"),s("p",{class:"section-subtitle font-mono mt-1"},"УПРАВЛЯЙТЕ EMAIL-УВЕДОМЛЕНИЯМИ И ТРИГГЕРАМИ")]),s("button",{class:"btn btn-primary"},"+ СОЗДАТЬ УВЕДОМЛЕНИЕ")],-1)),s("div",uHe,[(w(),i(p,null,f(h,(e,t)=>s("div",{key:t,class:"data-panel flex items-center justify-between"},[s("div",dHe,[s("div",{class:c(["icon-box-sm",e.active?"icon-green":""])},[u(M,{class:"w-4 h-4"})],2),s("div",null,[s("h4",{class:c(["font-oswald text-sm",e.active?"text-[var(--text-primary)]":"text-[var(--text-muted)]"])},v(e.name),3),s("p",hHe,v(e.condition),1)])]),s("div",pHe,[s("span",fHe,v(e.active?"МГНОВЕННЫЙ EMAIL":"ПРИОСТАНОВЛЕНО"),1),s("div",{class:c(["toggle-switch",{active:e.active}])},null,2)])])),64))])])):"FIRS"===n.value?(w(),i("div",mHe,[s("div",vHe,[s("div",gHe,[s("div",yHe,[u(T,{class:"w-4 h-4"})]),t[8]||(t[8]=s("h3",{class:"data-panel-title"},"ФАКТЫ ПО ЗАПРОСУ",-1))]),t[10]||(t[10]=s("p",{class:"section-subtitle font-mono mb-6"},"ВЫБЕРИТЕ ТРЕНДОВУЮ ТЕМУ ДЛЯ МГНОВЕННОЙ ГЕНЕРАЦИИ AI-РЕЗЮМЕ",-1)),s("div",bHe,[(w(),i(p,null,f(x,(e,a)=>s("div",{key:a,class:"brutalist-card cursor-pointer group"},[s("h4",xHe,v(e),1),t[9]||(t[9]=s("div",{class:"flex items-center justify-between"},[s("span",{class:"font-mono text-[10px] text-[var(--text-muted)]"},"ВКЛЮЧАЕТ 12 ИСТОЧНИКОВ"),s("button",{class:"font-mono text-[10px] text-[var(--accent-red)] opacity-0 group-hover:opacity-100"},"СГЕНЕРИРОВАТЬ")],-1))])),64))])]),s("div",wHe,[s("div",_He,[u(D,{class:"w-32 h-32"})]),t[11]||(t[11]=I('<h3 class="font-anton text-lg mb-6">ПОСЛЕДНЕЕ СГЕНЕРИРОВАННОЕ РЕЗЮМЕ</h3><div class="flex flex-col gap-4"><div class="flex items-center gap-2 font-mono text-xs text-[var(--accent-red)]"><span>ТЕМА:</span><span class="badge badge-red">EU AI Act</span></div><p class="font-mono text-sm text-[var(--text-secondary)] leading-relaxed"> Европейский парламент одобрил AI Act, устанавливая первую в мире всеобъемлющую правовую основу для искусственного интеллекта. </p><div class="pt-4 mt-4 border-t border-[var(--border-dark)] flex gap-3"><button class="btn btn-outline flex-1">ПОДЕЛИТЬСЯ</button><button class="btn btn-primary flex-1">ПОЛНЫЙ ОТЧЁТ</button></div></div>',2))])])):"BRIE"===n.value?(w(),i("div",SHe,[t[13]||(t[13]=I('<div class="flex items-center justify-between"><h3 class="font-anton text-xl">РЫНОЧНЫЕ ОБЗОРЫ</h3><div class="tab-group"><button class="tab-btn">ЕЖЕДНЕВНО</button><button class="tab-btn active">ЕЖЕНЕДЕЛЬНО</button></div></div>',1)),s("div",MHe,[(w(),i(p,null,f(g,(e,a)=>s("div",{key:a,class:"data-panel flex items-center justify-between group"},[s("div",THe,[s("div",kHe,[u(k,{class:"w-5 h-5"})]),s("div",null,[s("h4",CHe,v(e.title),1),s("div",AHe,[s("span",null,v(e.date),1),t[12]||(t[12]=s("span",null,"•",-1)),s("span",EHe,v(e.type),1)])])]),s("button",IHe,[u(P,{class:"w-4 h-4"})])])),64))])])):l("",!0)])]))}});var DHe=(e=>(e.TRENDING="TRENDING",e.CHOPPY="CHOPPY",e.TRANSITION="TRANSITION",e))(DHe||{});const PHe=e=>e-Math.floor(e),LHe=e=>PHe(43758.5453*Math.sin(e)),NHe=e=>{const t=Math.floor(e),a=PHe(e),n=a*a*(3-2*a);return r=LHe(t),i=LHe(t+1),r*(1-(o=n))+i*o;var r,i,o},OHe=(e,t)=>{const a=Math.max(0,Math.min(1,e));if(a<.25){const e=a/.25;t.r=0,t.g=e,t.b=1}else if(a<.5){const e=(a-.25)/.25;t.r=0,t.g=1,t.b=1-e}else if(a<.75){const e=(a-.5)/.25;t.r=e,t.g=1,t.b=0}else{const e=(a-.75)/.25;t.r=1,t.g=1-e,t.b=0}};class FHe{scene;camera;renderer;controls;container;mesh=null;wireframeMesh=null;geometry=null;colors=null;animationId=null;isAnimating=!1;time=0;regime=DHe.TRENDING;onSignal=null;constructor(e,t){this.container=e,this.onSignal=t||null,this.initScene(),this.initCamera(),this.initRenderer(),this.initControls(),this.initLighting(),this.initSurface(),this.animate()}initScene(){this.scene=new qS,this.scene.background=new j_(328965)}initCamera(){const e=this.container.clientWidth,t=this.container.clientHeight;this.camera=new OS(45,e/t,.1,1e3),this.camera.position.set(0,25,40),this.camera.lookAt(0,0,0)}initRenderer(){this.renderer=new AA({antialias:!0,alpha:!0,powerPreference:"high-performance"}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.container.appendChild(this.renderer.domElement)}initControls(){this.controls=new YA(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.enablePan=!1,this.controls.enableZoom=!0,this.controls.maxPolarAngle=Math.PI/2,this.controls.minPolarAngle=0,this.controls.autoRotate=!0,this.controls.autoRotateSpeed=.5}initLighting(){const e=new wT(16777215,.5);this.scene.add(e);const t=new gT(16777215,1);t.position.set(10,10,10),this.scene.add(t)}initSurface(){this.geometry=new rT(50,50,60,60);this.colors=new Float32Array(11163),this.geometry.setAttribute("color",new tS(this.colors,3));const e=new Z_({vertexColors:!0,side:2,transparent:!0,opacity:.8});this.mesh=new MS(this.geometry,e),this.mesh.rotation.x=-Math.PI/2.5,this.mesh.position.y=-5,this.scene.add(this.mesh);const t=new Z_({wireframe:!0,color:16777215,transparent:!0,opacity:.15,depthWrite:!1});this.wireframeMesh=new MS(this.geometry,t),this.wireframeMesh.rotation.x=-Math.PI/2.5,this.wireframeMesh.position.y=-5,this.scene.add(this.wireframeMesh)}updateSurface(e){if(!this.geometry||!this.colors)return;const t=this.geometry.getAttribute("position"),a=this.geometry.getAttribute("color");if(!t||!a)return;const n=1.5*e;this.time+=n;const r=this.time,i=t.array,o=a.array,s=t.count,l={r:0,g:0,b:0};let c=0,u=0;for(let h=0;h<s;h++){const e=i[3*h],t=i[3*h+1],a=t-4*r;let n=2*Math.sin(.2*e+.2*a);const s=12*Math.exp(-Math.pow(.15*e,2)),d=3*(NHe(.8*e+a)+.5*NHe(1.5*e-1.5*a));this.regime===DHe.TRENDING?(n+=1.5*s,n+=.2*d):(n+=.2*s,n+=2.5*d),n+=.5*Math.sin(Math.sqrt(e*e+t*t)-5*r),i[3*h+2]=n;OHe((n+5)/20,l),o[3*h]=l.r,o[3*h+1]=l.g,o[3*h+2]=l.b,Math.abs(t-25)<1&&Math.abs(e)<1&&(c=n),Math.abs(t-25)<1&&(u+=Math.abs(n))}t.needsUpdate=!0,a.needsUpdate=!0;const d=Math.max(-1,Math.min(1,(c-5)/10));this.onSignal&&this.onSignal(d,u)}animate=()=>{this.isAnimating||(this.isAnimating=!0),this.animationId=requestAnimationFrame(this.animate),this.updateSurface(.016),this.controls.update(),this.renderer.render(this.scene,this.camera)};setRegime(e){this.regime=e}getRegime(){return this.regime}resize(){const e=this.container.clientWidth,t=this.container.clientHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}dispose(){if(this.isAnimating=!1,null!==this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.geometry&&this.geometry.dispose(),this.mesh){this.mesh.material.dispose(),this.scene.remove(this.mesh)}if(this.wireframeMesh){this.wireframeMesh.material.dispose(),this.scene.remove(this.wireframeMesh)}this.controls.dispose(),this.renderer.dispose(),this.renderer.domElement.parentNode&&this.renderer.domElement.parentNode.removeChild(this.renderer.domElement)}}function BHe(){let e=null;return{init:(t,a)=>(e=new FHe(t,a),e),dispose:()=>{e&&(e.dispose(),e=null)},setRegime:t=>{e&&e.setRegime(t)},resize:()=>{e&&e.resize()},getRenderer:()=>e}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var UHe=function(e,t){return UHe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},UHe(e,t)};function zHe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}UHe(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var VHe=function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1},HHe=new function(){this.browser=new VHe,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow="undefined"!=typeof window};"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?(HHe.wxa=!0,HHe.touchEventsSupported=!0):"undefined"==typeof document&&"undefined"!=typeof self?HHe.worker=!0:!HHe.hasGlobalWindow||"Deno"in window||"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Node.js")>-1?(HHe.node=!0,HHe.svgSupported=!0):function(e,t){var a=t.browser,n=e.match(/Firefox\/([\d.]+)/),r=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),i=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);n&&(a.firefox=!0,a.version=n[1]);r&&(a.ie=!0,a.version=r[1]);i&&(a.edge=!0,a.version=i[1],a.newEdge=+i[1].split(".")[0]>18);o&&(a.weChat=!0);t.svgSupported="undefined"!=typeof SVGRect,t.touchEventsSupported="ontouchstart"in window&&!a.ie&&!a.edge,t.pointerEventsSupported="onpointerdown"in window&&(a.edge||a.ie&&+a.version>=11);var s=t.domSupported="undefined"!=typeof document;if(s){var l=document.documentElement.style;t.transform3dSupported=(a.ie&&"transition"in l||a.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in l)&&!("OTransition"in l),t.transformSupported=t.transform3dSupported||a.ie&&+a.version>=9}}(navigator.userAgent,HHe);var GHe="sans-serif",WHe="12px "+GHe;var qHe,YHe,jHe=function(e){var t={};if("undefined"==typeof JSON)return t;for(var a=0;a<e.length;a++){var n=String.fromCharCode(a+32),r=(e.charCodeAt(a)-20)/100;t[n]=r}return t}("007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N"),XHe={createCanvas:function(){return"undefined"!=typeof document&&document.createElement("canvas")},measureText:function(e,t){if(!qHe){var a=XHe.createCanvas();qHe=a&&a.getContext("2d")}if(qHe)return YHe!==t&&(YHe=qHe.font=t||WHe),qHe.measureText(e);e=e||"";var n=/((?:\d+)?\.?\d*)px/.exec(t=t||WHe),r=n&&+n[1]||12,i=0;if(t.indexOf("mono")>=0)i=r*e.length;else for(var o=0;o<e.length;o++){var s=jHe[e[o]];i+=null==s?r:s*r}return{width:i}},loadImage:function(e,t,a){var n=new Image;return n.onload=t,n.onerror=a,n.src=e,n}},$He=bGe(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),KHe=bGe(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),ZHe=Object.prototype.toString,JHe=Array.prototype,QHe=JHe.forEach,eGe=JHe.filter,tGe=JHe.slice,aGe=JHe.map,nGe=function(){}.constructor,rGe=nGe?nGe.prototype:null,iGe="__proto__",oGe=2311;function sGe(){return oGe++}function lGe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];"undefined"!=typeof console&&console.error.apply(console,e)}function cGe(e){if(null==e||"object"!=typeof e)return e;var t=e,a=ZHe.call(e);if("[object Array]"===a){if(!qGe(e)){t=[];for(var n=0,r=e.length;n<r;n++)t[n]=cGe(e[n])}}else if(KHe[a]){if(!qGe(e)){var i=e.constructor;if(i.from)t=i.from(e);else{t=new i(e.length);for(n=0,r=e.length;n<r;n++)t[n]=e[n]}}}else if(!$He[a]&&!qGe(e)&&!PGe(e))for(var o in t={},e)e.hasOwnProperty(o)&&o!==iGe&&(t[o]=cGe(e[o]));return t}function uGe(e,t,a){if(!IGe(t)||!IGe(e))return a?cGe(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==iGe){var r=e[n],i=t[n];!IGe(i)||!IGe(r)||TGe(i)||TGe(r)||PGe(i)||PGe(r)||RGe(i)||RGe(r)||qGe(i)||qGe(r)?!a&&n in e||(e[n]=cGe(t[n])):uGe(r,i,a)}return e}function dGe(e,t){for(var a=e[0],n=1,r=e.length;n<r;n++)a=uGe(a,e[n],t);return a}function hGe(e,t){if(Object.assign)Object.assign(e,t);else for(var a in t)t.hasOwnProperty(a)&&a!==iGe&&(e[a]=t[a]);return e}function pGe(e,t,a){for(var n=_Ge(t),r=0,i=n.length;r<i;r++){var o=n[r];(a?null!=t[o]:null==e[o])&&(e[o]=t[o])}return e}function fGe(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var a=0,n=e.length;a<n;a++)if(e[a]===t)return a}return-1}function mGe(e,t,a){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r];"constructor"!==i&&(a?null!=t[i]:null==e[i])&&(e[i]=t[i])}else pGe(e,t,a)}function vGe(e){return!!e&&("string"!=typeof e&&"number"==typeof e.length)}function gGe(e,t,a){if(e&&t)if(e.forEach&&e.forEach===QHe)e.forEach(t,a);else if(e.length===+e.length)for(var n=0,r=e.length;n<r;n++)t.call(a,e[n],n,e);else for(var i in e)e.hasOwnProperty(i)&&t.call(a,e[i],i,e)}function yGe(e,t,a){if(!e)return[];if(!t)return UGe(e);if(e.map&&e.map===aGe)return e.map(t,a);for(var n=[],r=0,i=e.length;r<i;r++)n.push(t.call(a,e[r],r,e));return n}function bGe(e,t,a,n){if(e&&t){for(var r=0,i=e.length;r<i;r++)a=t.call(n,a,e[r],r,e);return a}}function xGe(e,t,a){if(!e)return[];if(!t)return UGe(e);if(e.filter&&e.filter===eGe)return e.filter(t,a);for(var n=[],r=0,i=e.length;r<i;r++)t.call(a,e[r],r,e)&&n.push(e[r]);return n}function wGe(e,t,a){if(e&&t)for(var n=0,r=e.length;n<r;n++)if(t.call(a,e[n],n,e))return e[n]}function _Ge(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(a);return t}var SGe=rGe&&kGe(rGe.bind)?rGe.call.bind(rGe.bind):function(e,t){for(var a=[],n=2;n<arguments.length;n++)a[n-2]=arguments[n];return function(){return e.apply(t,a.concat(tGe.call(arguments)))}};function MGe(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return function(){return e.apply(this,t.concat(tGe.call(arguments)))}}function TGe(e){return Array.isArray?Array.isArray(e):"[object Array]"===ZHe.call(e)}function kGe(e){return"function"==typeof e}function CGe(e){return"string"==typeof e}function AGe(e){return"[object String]"===ZHe.call(e)}function EGe(e){return"number"==typeof e}function IGe(e){var t=typeof e;return"function"===t||!!e&&"object"===t}function RGe(e){return!!$He[ZHe.call(e)]}function DGe(e){return!!KHe[ZHe.call(e)]}function PGe(e){return"object"==typeof e&&"number"==typeof e.nodeType&&"object"==typeof e.ownerDocument}function LGe(e){return null!=e.colorStops}function NGe(e){return e!=e}function OGe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var a=0,n=e.length;a<n;a++)if(null!=e[a])return e[a]}function FGe(e,t){return null!=e?e:t}function BGe(e,t,a){return null!=e?e:null!=t?t:a}function UGe(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return tGe.apply(e,t)}function zGe(e){if("number"==typeof e)return[e,e,e,e];var t=e.length;return 2===t?[e[0],e[1],e[0],e[1]]:3===t?[e[0],e[1],e[2],e[1]]:e}function VGe(e,t){if(!e)throw new Error(t)}function HGe(e){return null==e?null:"function"==typeof e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var GGe="__ec_primitive__";function WGe(e){e[GGe]=!0}function qGe(e){return e[GGe]}var YGe=function(){function e(){this.data={}}return e.prototype.delete=function(e){var t=this.has(e);return t&&delete this.data[e],t},e.prototype.has=function(e){return this.data.hasOwnProperty(e)},e.prototype.get=function(e){return this.data[e]},e.prototype.set=function(e,t){return this.data[e]=t,this},e.prototype.keys=function(){return _Ge(this.data)},e.prototype.forEach=function(e){var t=this.data;for(var a in t)t.hasOwnProperty(a)&&e(t[a],a)},e}(),jGe="function"==typeof Map;var XGe=function(){function e(t){var a=TGe(t);this.data=jGe?new Map:new YGe;var n=this;function r(e,t){a?n.set(e,t):n.set(t,e)}t instanceof e?t.each(r):t&&gGe(t,r)}return e.prototype.hasKey=function(e){return this.data.has(e)},e.prototype.get=function(e){return this.data.get(e)},e.prototype.set=function(e,t){return this.data.set(e,t),t},e.prototype.each=function(e,t){this.data.forEach(function(a,n){e.call(t,a,n)})},e.prototype.keys=function(){var e=this.data.keys();return jGe?Array.from(e):e},e.prototype.removeKey=function(e){this.data.delete(e)},e}();function $Ge(e){return new XGe(e)}function KGe(e,t){for(var a=new e.constructor(e.length+t.length),n=0;n<e.length;n++)a[n]=e[n];var r=e.length;for(n=0;n<t.length;n++)a[n+r]=t[n];return a}function ZGe(e,t){var a;if(Object.create)a=Object.create(e);else{var n=function(){};n.prototype=e,a=new n}return t&&hGe(a,t),a}function JGe(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function QGe(e,t){return e.hasOwnProperty(t)}function eWe(){}var tWe=180/Math.PI;function aWe(e,t){return null==e&&(e=0),null==t&&(t=0),[e,t]}function nWe(e,t){return e[0]=t[0],e[1]=t[1],e}function rWe(e){return[e[0],e[1]]}function iWe(e,t,a){return e[0]=t,e[1]=a,e}function oWe(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e}function sWe(e,t,a,n){return e[0]=t[0]+a[0]*n,e[1]=t[1]+a[1]*n,e}function lWe(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e}function cWe(e){return Math.sqrt(function(e){return e[0]*e[0]+e[1]*e[1]}(e))}function uWe(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e}function dWe(e,t){var a=cWe(t);return 0===a?(e[0]=0,e[1]=0):(e[0]=t[0]/a,e[1]=t[1]/a),e}function hWe(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var pWe=hWe;var fWe=function(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])};function mWe(e,t,a,n){return e[0]=t[0]+n*(a[0]-t[0]),e[1]=t[1]+n*(a[1]-t[1]),e}function vWe(e,t,a){var n=t[0],r=t[1];return e[0]=a[0]*n+a[2]*r+a[4],e[1]=a[1]*n+a[3]*r+a[5],e}function gWe(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e}function yWe(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e}var bWe=function(e,t){this.target=e,this.topTarget=t&&t.topTarget},xWe=function(){function e(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new bWe(t,e),"dragstart",e.event))},e.prototype._drag=function(e){var t=this._draggingTarget;if(t){var a=e.offsetX,n=e.offsetY,r=a-this._x,i=n-this._y;this._x=a,this._y=n,t.drift(r,i,e),this.handler.dispatchToElement(new bWe(t,e),"drag",e.event);var o=this.handler.findHover(a,n,t).target,s=this._dropTarget;this._dropTarget=o,t!==o&&(s&&o!==s&&this.handler.dispatchToElement(new bWe(s,e),"dragleave",e.event),o&&o!==s&&this.handler.dispatchToElement(new bWe(o,e),"dragenter",e.event))}},e.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new bWe(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new bWe(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},e}(),wWe=function(){function e(e){e&&(this._$eventProcessor=e)}return e.prototype.on=function(e,t,a,n){this._$handlers||(this._$handlers={});var r=this._$handlers;if("function"==typeof t&&(n=a,a=t,t=null),!a||!e)return this;var i=this._$eventProcessor;null!=t&&i&&i.normalizeQuery&&(t=i.normalizeQuery(t)),r[e]||(r[e]=[]);for(var o=0;o<r[e].length;o++)if(r[e][o].h===a)return this;var s={h:a,query:t,ctx:n||this,callAtLast:a.zrEventfulCallAtLast},l=r[e].length-1,c=r[e][l];return c&&c.callAtLast?r[e].splice(l,0,s):r[e].push(s),this},e.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},e.prototype.off=function(e,t){var a=this._$handlers;if(!a)return this;if(!e)return this._$handlers={},this;if(t){if(a[e]){for(var n=[],r=0,i=a[e].length;r<i;r++)a[e][r].h!==t&&n.push(a[e][r]);a[e]=n}a[e]&&0===a[e].length&&delete a[e]}else delete a[e];return this},e.prototype.trigger=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(!this._$handlers)return this;var n=this._$handlers[e],r=this._$eventProcessor;if(n)for(var i=t.length,o=n.length,s=0;s<o;s++){var l=n[s];if(!r||!r.filter||null==l.query||r.filter(e,l.query))switch(i){case 0:l.h.call(l.ctx);break;case 1:l.h.call(l.ctx,t[0]);break;case 2:l.h.call(l.ctx,t[0],t[1]);break;default:l.h.apply(l.ctx,t)}}return r&&r.afterTrigger&&r.afterTrigger(e),this},e.prototype.triggerWithContext=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(!this._$handlers)return this;var n=this._$handlers[e],r=this._$eventProcessor;if(n)for(var i=t.length,o=t[i-1],s=n.length,l=0;l<s;l++){var c=n[l];if(!r||!r.filter||null==c.query||r.filter(e,c.query))switch(i){case 0:c.h.call(o);break;case 1:c.h.call(o,t[0]);break;case 2:c.h.call(o,t[0],t[1]);break;default:c.h.apply(o,t.slice(1,i-1))}}return r&&r.afterTrigger&&r.afterTrigger(e),this},e}(),_We=Math.log(2);function SWe(e,t,a,n,r,i){var o=n+"-"+r,s=e.length;if(i.hasOwnProperty(o))return i[o];if(1===t){var l=Math.round(Math.log((1<<s)-1&~r)/_We);return e[a][l]}for(var c=n|1<<a,u=a+1;n&1<<u;)u++;for(var d=0,h=0,p=0;h<s;h++){var f=1<<h;f&r||(d+=(p%2?-1:1)*e[a][h]*SWe(e,t-1,u,c,r|f,i),p++)}return i[o]=d,d}function MWe(e,t){var a=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},r=SWe(a,8,0,0,0,n);if(0!==r){for(var i=[],o=0;o<8;o++)for(var s=0;s<8;s++)null==i[s]&&(i[s]=0),i[s]+=((o+s)%2?-1:1)*SWe(a,7,0===o?1:0,1<<o,1<<s,n)/r*t[o];return function(e,t,a){var n=t*i[6]+a*i[7]+1;e[0]=(t*i[0]+a*i[1]+i[2])/n,e[1]=(t*i[3]+a*i[4]+i[5])/n}}}var TWe="___zrEVENTSAVED",kWe=[];function CWe(e,t,a,n,r){if(t.getBoundingClientRect&&HHe.domSupported&&!AWe(t)){var i=t[TWe]||(t[TWe]={}),o=function(e,t){var a=t.markers;if(a)return a;a=t.markers=[];for(var n=["left","right"],r=["top","bottom"],i=0;i<4;i++){var o=document.createElement("div"),s=i%2,l=(i>>1)%2;o.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[s]+":0",r[l]+":0",n[1-s]+":auto",r[1-l]+":auto",""].join("!important;"),e.appendChild(o),a.push(o)}return t.clearMarkers=function(){gGe(a,function(e){e.parentNode&&e.parentNode.removeChild(e)})},a}(t,i),s=function(e,t,a){for(var n=a?"invTrans":"trans",r=t[n],i=t.srcCoords,o=[],s=[],l=!0,c=0;c<4;c++){var u=e[c].getBoundingClientRect(),d=2*c,h=u.left,p=u.top;o.push(h,p),l=l&&i&&h===i[d]&&p===i[d+1],s.push(e[c].offsetLeft,e[c].offsetTop)}return l&&r?r:(t.srcCoords=o,t[n]=a?MWe(s,o):MWe(o,s))}(o,i,r);if(s)return s(e,a,n),!0}return!1}function AWe(e){return"CANVAS"===e.nodeName.toUpperCase()}var EWe=/([&<>"'])/g,IWe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function RWe(e){return null==e?"":(e+"").replace(EWe,function(e,t){return IWe[t]})}var DWe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,PWe=[],LWe=HHe.browser.firefox&&+HHe.browser.version.split(".")[0]<39;function NWe(e,t,a,n){return a=a||{},n?OWe(e,t,a):LWe&&null!=t.layerX&&t.layerX!==t.offsetX?(a.zrX=t.layerX,a.zrY=t.layerY):null!=t.offsetX?(a.zrX=t.offsetX,a.zrY=t.offsetY):OWe(e,t,a),a}function OWe(e,t,a){if(HHe.domSupported&&e.getBoundingClientRect){var n=t.clientX,r=t.clientY;if(AWe(e)){var i=e.getBoundingClientRect();return a.zrX=n-i.left,void(a.zrY=r-i.top)}if(CWe(PWe,e,n,r))return a.zrX=PWe[0],void(a.zrY=PWe[1])}a.zrX=a.zrY=0}function FWe(e){return e||window.event}function BWe(e,t,a){if(null!=(t=FWe(t)).zrX)return t;var n=t.type;if(n&&n.indexOf("touch")>=0){var r="touchend"!==n?t.targetTouches[0]:t.changedTouches[0];r&&NWe(e,r,t,a)}else{NWe(e,t,t,a);var i=function(e){var t=e.wheelDelta;if(t)return t;var a=e.deltaX,n=e.deltaY;if(null==a||null==n)return t;return 3*(0!==n?Math.abs(n):Math.abs(a))*(n>0?-1:n<0?1:a>0?-1:1)}(t);t.zrDelta=i?i/120:-(t.detail||0)/3}var o=t.button;return null==t.which&&void 0!==o&&DWe.test(t.type)&&(t.which=1&o?1:2&o?3:4&o?2:0),t}function UWe(e,t,a,n){e.addEventListener(t,a,n)}function zWe(e,t,a,n){e.removeEventListener(t,a,n)}var VWe=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0};function HWe(e){return 2===e.which||3===e.which}var GWe=function(){function e(){this._track=[]}return e.prototype.recognize=function(e,t,a){return this._doTrack(e,t,a),this._recognize(e)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(e,t,a){var n=e.touches;if(n){for(var r={points:[],touches:[],target:t,event:e},i=0,o=n.length;i<o;i++){var s=n[i],l=NWe(a,s,{});r.points.push([l.zrX,l.zrY]),r.touches.push(s)}this._track.push(r)}},e.prototype._recognize=function(e){for(var t in qWe)if(qWe.hasOwnProperty(t)){var a=qWe[t](this._track,e);if(a)return a}},e}();function WWe(e){var t=e[1][0]-e[0][0],a=e[1][1]-e[0][1];return Math.sqrt(t*t+a*a)}var qWe={pinch:function(e,t){var a=e.length;if(a){var n,r=(e[a-1]||{}).points,i=(e[a-2]||{}).points||r;if(i&&i.length>1&&r&&r.length>1){var o=WWe(r)/WWe(i);!isFinite(o)&&(o=1),t.pinchScale=o;var s=[((n=r)[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2];return t.pinchX=s[0],t.pinchY=s[1],{type:"pinch",target:e[0].target,event:t}}}}};function YWe(){return[1,0,0,1,0,0]}function jWe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function XWe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function $We(e,t,a){var n=t[0]*a[0]+t[2]*a[1],r=t[1]*a[0]+t[3]*a[1],i=t[0]*a[2]+t[2]*a[3],o=t[1]*a[2]+t[3]*a[3],s=t[0]*a[4]+t[2]*a[5]+t[4],l=t[1]*a[4]+t[3]*a[5]+t[5];return e[0]=n,e[1]=r,e[2]=i,e[3]=o,e[4]=s,e[5]=l,e}function KWe(e,t,a){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+a[0],e[5]=t[5]+a[1],e}function ZWe(e,t,a,n){void 0===n&&(n=[0,0]);var r=t[0],i=t[2],o=t[4],s=t[1],l=t[3],c=t[5],u=Math.sin(a),d=Math.cos(a);return e[0]=r*d+s*u,e[1]=-r*u+s*d,e[2]=i*d+l*u,e[3]=-i*u+d*l,e[4]=d*(o-n[0])+u*(c-n[1])+n[0],e[5]=d*(c-n[1])-u*(o-n[0])+n[1],e}function JWe(e,t,a){var n=a[0],r=a[1];return e[0]=t[0]*n,e[1]=t[1]*r,e[2]=t[2]*n,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*r,e}function QWe(e,t){var a=t[0],n=t[2],r=t[4],i=t[1],o=t[3],s=t[5],l=a*o-i*n;return l?(l=1/l,e[0]=o*l,e[1]=-i*l,e[2]=-n*l,e[3]=a*l,e[4]=(n*s-o*r)*l,e[5]=(i*r-a*s)*l,e):null}var eqe=function(){function e(e,t){this.x=e||0,this.y=t||0}return e.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(e,t){return this.x=e,this.y=t,this},e.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},e.prototype.distance=function(e){var t=this.x-e.x,a=this.y-e.y;return Math.sqrt(t*t+a*a)},e.prototype.distanceSquare=function(e){var t=this.x-e.x,a=this.y-e.y;return t*t+a*a},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(e){if(e){var t=this.x,a=this.y;return this.x=e[0]*t+e[2]*a+e[4],this.y=e[1]*t+e[3]*a+e[5],this}},e.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},e.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},e.set=function(e,t,a){e.x=t,e.y=a},e.copy=function(e,t){e.x=t.x,e.y=t.y},e.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},e.lenSquare=function(e){return e.x*e.x+e.y*e.y},e.dot=function(e,t){return e.x*t.x+e.y*t.y},e.add=function(e,t,a){e.x=t.x+a.x,e.y=t.y+a.y},e.sub=function(e,t,a){e.x=t.x-a.x,e.y=t.y-a.y},e.scale=function(e,t,a){e.x=t.x*a,e.y=t.y*a},e.scaleAndAdd=function(e,t,a,n){e.x=t.x+a.x*n,e.y=t.y+a.y*n},e.lerp=function(e,t,a,n){var r=1-n;e.x=r*t.x+n*a.x,e.y=r*t.y+n*a.y},e}(),tqe=Math.min,aqe=Math.max,nqe=Math.abs,rqe=["x","y"],iqe=["width","height"],oqe=new eqe,sqe=new eqe,lqe=new eqe,cqe=new eqe,uqe=yqe(),dqe=uqe.minTv,hqe=uqe.maxTv,pqe=[0,0],fqe=function(){function e(t,a,n,r){e.set(this,t,a,n,r)}return e.set=function(e,t,a,n,r){return n<0&&(t+=n,n=-n),r<0&&(a+=r,r=-r),e.x=t,e.y=a,e.width=n,e.height=r,e},e.prototype.union=function(e){var t=tqe(e.x,this.x),a=tqe(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=aqe(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=aqe(e.y+e.height,this.y+this.height)-a:this.height=e.height,this.x=t,this.y=a},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(e){var t=this,a=e.width/t.width,n=e.height/t.height,r=[1,0,0,1,0,0];return KWe(r,r,[-t.x,-t.y]),JWe(r,r,[a,n]),KWe(r,r,[e.x,e.y]),r},e.prototype.intersect=function(t,a,n){return e.intersect(this,t,a,n)},e.intersect=function(t,a,n,r){n&&eqe.set(n,0,0);var i=r&&r.outIntersectRect||null,o=r&&r.clamp;if(i&&(i.x=i.y=i.width=i.height=NaN),!t||!a)return!1;t instanceof e||(t=e.set(mqe,t.x,t.y,t.width,t.height)),a instanceof e||(a=e.set(vqe,a.x,a.y,a.width,a.height));var s=!!n;uqe.reset(r,s);var l=uqe.touchThreshold,c=t.x+l,u=t.x+t.width-l,d=t.y+l,h=t.y+t.height-l,p=a.x+l,f=a.x+a.width-l,m=a.y+l,v=a.y+a.height-l;if(c>u||d>h||p>f||m>v)return!1;var g=!(u<p||f<c||h<m||v<d);return(s||i)&&(pqe[0]=1/0,pqe[1]=0,gqe(c,u,p,f,0,s,i,o),gqe(d,h,m,v,1,s,i,o),s&&eqe.copy(n,g?uqe.useDir?uqe.dirMinTv:dqe:hqe)),g},e.contain=function(e,t,a){return t>=e.x&&t<=e.x+e.width&&a>=e.y&&a<=e.y+e.height},e.prototype.contain=function(t,a){return e.contain(this,t,a)},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return 0===this.width||0===this.height},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(e,t){return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e},e.applyTransform=function(t,a,n){if(n){if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var r=n[0],i=n[3],o=n[4],s=n[5];return t.x=a.x*r+o,t.y=a.y*i+s,t.width=a.width*r,t.height=a.height*i,t.width<0&&(t.x+=t.width,t.width=-t.width),void(t.height<0&&(t.y+=t.height,t.height=-t.height))}oqe.x=lqe.x=a.x,oqe.y=cqe.y=a.y,sqe.x=cqe.x=a.x+a.width,sqe.y=lqe.y=a.y+a.height,oqe.transform(n),cqe.transform(n),sqe.transform(n),lqe.transform(n),t.x=tqe(oqe.x,sqe.x,lqe.x,cqe.x),t.y=tqe(oqe.y,sqe.y,lqe.y,cqe.y);var l=aqe(oqe.x,sqe.x,lqe.x,cqe.x),c=aqe(oqe.y,sqe.y,lqe.y,cqe.y);t.width=l-t.x,t.height=c-t.y}else t!==a&&e.copy(t,a)},e}(),mqe=new fqe(0,0,0,0),vqe=new fqe(0,0,0,0);function gqe(e,t,a,n,r,i,o,s){var l=nqe(t-a),c=nqe(n-e),u=tqe(l,c),d=rqe[r],h=rqe[1-r],p=iqe[r];t<a||n<e?l<c?(i&&(hqe[d]=-l),s&&(o[d]=t,o[p]=0)):(i&&(hqe[d]=c),s&&(o[d]=e,o[p]=0)):(o&&(o[d]=aqe(e,a),o[p]=tqe(t,n)-o[d]),i&&(u<pqe[0]||uqe.useDir)&&(pqe[0]=tqe(u,pqe[0]),(l<c||!uqe.bidirectional)&&(dqe[d]=l,dqe[h]=0,uqe.useDir&&uqe.calcDirMTV()),(l>=c||!uqe.bidirectional)&&(dqe[d]=-c,dqe[h]=0,uqe.useDir&&uqe.calcDirMTV())))}function yqe(){var e=0,t=new eqe,a=new eqe,n={minTv:new eqe,maxTv:new eqe,useDir:!1,dirMinTv:new eqe,touchThreshold:0,bidirectional:!0,negativeSize:!1,reset:function(r,i){n.touchThreshold=0,r&&null!=r.touchThreshold&&(n.touchThreshold=aqe(0,r.touchThreshold)),n.negativeSize=!1,i&&(n.minTv.set(1/0,1/0),n.maxTv.set(0,0),n.useDir=!1,r&&null!=r.direction&&(n.useDir=!0,n.dirMinTv.copy(n.minTv),a.copy(n.minTv),e=r.direction,n.bidirectional=null==r.bidirectional||!!r.bidirectional,n.bidirectional||t.set(Math.cos(e),Math.sin(e))))},calcDirMTV:function(){var i=n.minTv,o=n.dirMinTv,s=i.y*i.y+i.x*i.x,l=Math.sin(e),c=Math.cos(e),u=l*i.y+c*i.x;r(u)?r(i.x)&&r(i.y)&&o.set(0,0):(a.x=s*c/u,a.y=s*l/u,r(a.x)&&r(a.y)?o.set(0,0):(n.bidirectional||t.dot(a)>0)&&a.len()<o.len()&&o.copy(a))}};function r(e){return nqe(e)<1e-10}return n}var bqe="silent";function xqe(){VWe(this.event)}var wqe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handler=null,t}return zHe(t,e),t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(wWe),_qe=function(e,t){this.x=e,this.y=t},Sqe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],Mqe=new fqe(0,0,0,0),Tqe=function(e){function t(t,a,n,r,i){var o=e.call(this)||this;return o._hovered=new _qe(0,0),o.storage=t,o.painter=a,o.painterRoot=r,o._pointerSize=i,n=n||new wqe,o.proxy=null,o.setHandlerProxy(n),o._draggingMgr=new xWe(o),o}return zHe(t,e),t.prototype.setHandlerProxy=function(e){this.proxy&&this.proxy.dispose(),e&&(gGe(Sqe,function(t){e.on&&e.on(t,this[t],this)},this),e.handler=this),this.proxy=e},t.prototype.mousemove=function(e){var t=e.zrX,a=e.zrY,n=Aqe(this,t,a),r=this._hovered,i=r.target;i&&!i.__zr&&(i=(r=this.findHover(r.x,r.y)).target);var o=this._hovered=n?new _qe(t,a):this.findHover(t,a),s=o.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),i&&s!==i&&this.dispatchToElement(r,"mouseout",e),this.dispatchToElement(o,"mousemove",e),s&&s!==i&&this.dispatchToElement(o,"mouseover",e)},t.prototype.mouseout=function(e){var t=e.zrEventControl;"only_globalout"!==t&&this.dispatchToElement(this._hovered,"mouseout",e),"no_globalout"!==t&&this.trigger("globalout",{type:"globalout",event:e})},t.prototype.resize=function(){this._hovered=new _qe(0,0)},t.prototype.dispatch=function(e,t){var a=this[e];a&&a.call(this,t)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(e){var t=this.proxy;t.setCursor&&t.setCursor(e)},t.prototype.dispatchToElement=function(e,t,a){var n=(e=e||{}).target;if(!n||!n.silent){for(var r="on"+t,i=function(e,t,a){return{type:e,event:a,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:a.zrX,offsetY:a.zrY,gestureEvent:a.gestureEvent,pinchX:a.pinchX,pinchY:a.pinchY,pinchScale:a.pinchScale,wheelDelta:a.zrDelta,zrByTouch:a.zrByTouch,which:a.which,stop:xqe}}(t,e,a);n&&(n[r]&&(i.cancelBubble=!!n[r].call(n,i)),n.trigger(t,i),n=n.__hostTarget?n.__hostTarget:n.parent,!i.cancelBubble););i.cancelBubble||(this.trigger(t,i),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(e){"function"==typeof e[r]&&e[r].call(e,i),e.trigger&&e.trigger(t,i)}))}},t.prototype.findHover=function(e,t,a){var n=this.storage.getDisplayList(),r=new _qe(e,t);if(Cqe(n,r,e,t,a),this._pointerSize&&!r.target){for(var i=[],o=this._pointerSize,s=o/2,l=new fqe(e-s,t-s,o,o),c=n.length-1;c>=0;c--){var u=n[c];u===a||u.ignore||u.ignoreCoarsePointer||u.parent&&u.parent.ignoreCoarsePointer||(Mqe.copy(u.getBoundingRect()),u.transform&&Mqe.applyTransform(u.transform),Mqe.intersect(l)&&i.push(u))}if(i.length)for(var d=Math.PI/12,h=2*Math.PI,p=0;p<s;p+=4)for(var f=0;f<h;f+=d){if(Cqe(i,r,e+p*Math.cos(f),t+p*Math.sin(f),a),r.target)return r}}return r},t.prototype.processGesture=function(e,t){this._gestureMgr||(this._gestureMgr=new GWe);var a=this._gestureMgr;"start"===t&&a.clear();var n=a.recognize(e,this.findHover(e.zrX,e.zrY,null).target,this.proxy.dom);if("end"===t&&a.clear(),n){var r=n.type;e.gestureEvent=r;var i=new _qe;i.target=n.target,this.dispatchToElement(i,r,n.event)}},t}(wWe);function kqe(e,t,a){if(e[e.rectHover?"rectContain":"contain"](t,a)){for(var n=e,r=void 0,i=!1;n;){if(n.ignoreClip&&(i=!0),!i){var o=n.getClipPath();if(o&&!o.contain(t,a))return!1}n.silent&&(r=!0);var s=n.__hostTarget;n=s?n.ignoreHostSilent?null:s:n.parent}return!r||bqe}return!1}function Cqe(e,t,a,n,r){for(var i=e.length-1;i>=0;i--){var o=e[i],s=void 0;if(o!==r&&!o.ignore&&(s=kqe(o,a,n))&&(!t.topTarget&&(t.topTarget=o),s!==bqe)){t.target=o;break}}}function Aqe(e,t,a){var n=e.painter;return t<0||t>n.getWidth()||a<0||a>n.getHeight()}gGe(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){Tqe.prototype[e]=function(t){var a,n,r=t.zrX,i=t.zrY,o=Aqe(this,r,i);if("mouseup"===e&&o||(n=(a=this.findHover(r,i)).target),"mousedown"===e)this._downEl=n,this._downPoint=[t.zrX,t.zrY],this._upEl=n;else if("mouseup"===e)this._upEl=n;else if("click"===e){if(this._downEl!==this._upEl||!this._downPoint||pWe(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,e,t)}});function Eqe(e,t,a,n){var r=t+1;if(r===a)return 1;if(n(e[r++],e[t])<0){for(;r<a&&n(e[r],e[r-1])<0;)r++;!function(e,t,a){a--;for(;t<a;){var n=e[t];e[t++]=e[a],e[a--]=n}}(e,t,r)}else for(;r<a&&n(e[r],e[r-1])>=0;)r++;return r-t}function Iqe(e,t,a,n,r){for(n===t&&n++;n<a;n++){for(var i,o=e[n],s=t,l=n;s<l;)r(o,e[i=s+l>>>1])<0?l=i:s=i+1;var c=n-s;switch(c){case 3:e[s+3]=e[s+2];case 2:e[s+2]=e[s+1];case 1:e[s+1]=e[s];break;default:for(;c>0;)e[s+c]=e[s+c-1],c--}e[s]=o}}function Rqe(e,t,a,n,r,i){var o=0,s=0,l=1;if(i(e,t[a+r])>0){for(s=n-r;l<s&&i(e,t[a+r+l])>0;)o=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),o+=r,l+=r}else{for(s=r+1;l<s&&i(e,t[a+r-l])<=0;)o=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=o;o=r-l,l=r-c}for(o++;o<l;){var u=o+(l-o>>>1);i(e,t[a+u])>0?o=u+1:l=u}return l}function Dqe(e,t,a,n,r,i){var o=0,s=0,l=1;if(i(e,t[a+r])<0){for(s=r+1;l<s&&i(e,t[a+r-l])<0;)o=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var c=o;o=r-l,l=r-c}else{for(s=n-r;l<s&&i(e,t[a+r+l])>=0;)o=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),o+=r,l+=r}for(o++;o<l;){var u=o+(l-o>>>1);i(e,t[a+u])<0?l=u:o=u+1}return l}function Pqe(e,t){var a,n,r=7,i=0,o=[];function s(s){var l=a[s],c=n[s],u=a[s+1],d=n[s+1];n[s]=c+d,s===i-3&&(a[s+1]=a[s+2],n[s+1]=n[s+2]),i--;var h=Dqe(e[u],e,l,c,0,t);l+=h,0!==(c-=h)&&0!==(d=Rqe(e[l+c-1],e,u,d,d-1,t))&&(c<=d?function(a,n,i,s){var l=0;for(l=0;l<n;l++)o[l]=e[a+l];var c=0,u=i,d=a;if(e[d++]=e[u++],0===--s){for(l=0;l<n;l++)e[d+l]=o[c+l];return}if(1===n){for(l=0;l<s;l++)e[d+l]=e[u+l];return void(e[d+s]=o[c])}var h,p,f,m=r;for(;;){h=0,p=0,f=!1;do{if(t(e[u],o[c])<0){if(e[d++]=e[u++],p++,h=0,0===--s){f=!0;break}}else if(e[d++]=o[c++],h++,p=0,1===--n){f=!0;break}}while((h|p)<m);if(f)break;do{if(0!==(h=Dqe(e[u],o,c,n,0,t))){for(l=0;l<h;l++)e[d+l]=o[c+l];if(d+=h,c+=h,(n-=h)<=1){f=!0;break}}if(e[d++]=e[u++],0===--s){f=!0;break}if(0!==(p=Rqe(o[c],e,u,s,0,t))){for(l=0;l<p;l++)e[d+l]=e[u+l];if(d+=p,u+=p,0===(s-=p)){f=!0;break}}if(e[d++]=o[c++],1===--n){f=!0;break}m--}while(h>=7||p>=7);if(f)break;m<0&&(m=0),m+=2}if((r=m)<1&&(r=1),1===n){for(l=0;l<s;l++)e[d+l]=e[u+l];e[d+s]=o[c]}else{if(0===n)throw new Error;for(l=0;l<n;l++)e[d+l]=o[c+l]}}(l,c,u,d):function(a,n,i,s){var l=0;for(l=0;l<s;l++)o[l]=e[i+l];var c=a+n-1,u=s-1,d=i+s-1,h=0,p=0;if(e[d--]=e[c--],0===--n){for(h=d-(s-1),l=0;l<s;l++)e[h+l]=o[l];return}if(1===s){for(p=(d-=n)+1,h=(c-=n)+1,l=n-1;l>=0;l--)e[p+l]=e[h+l];return void(e[d]=o[u])}var f=r;for(;;){var m=0,v=0,g=!1;do{if(t(o[u],e[c])<0){if(e[d--]=e[c--],m++,v=0,0===--n){g=!0;break}}else if(e[d--]=o[u--],v++,m=0,1===--s){g=!0;break}}while((m|v)<f);if(g)break;do{if(0!==(m=n-Dqe(o[u],e,a,n,n-1,t))){for(n-=m,p=(d-=m)+1,h=(c-=m)+1,l=m-1;l>=0;l--)e[p+l]=e[h+l];if(0===n){g=!0;break}}if(e[d--]=o[u--],1===--s){g=!0;break}if(0!==(v=s-Rqe(e[c],o,0,s,s-1,t))){for(s-=v,p=(d-=v)+1,h=(u-=v)+1,l=0;l<v;l++)e[p+l]=o[h+l];if(s<=1){g=!0;break}}if(e[d--]=e[c--],0===--n){g=!0;break}f--}while(m>=7||v>=7);if(g)break;f<0&&(f=0),f+=2}(r=f)<1&&(r=1);if(1===s){for(p=(d-=n)+1,h=(c-=n)+1,l=n-1;l>=0;l--)e[p+l]=e[h+l];e[d]=o[u]}else{if(0===s)throw new Error;for(h=d-(s-1),l=0;l<s;l++)e[h+l]=o[l]}}(l,c,u,d))}return a=[],n=[],{mergeRuns:function(){for(;i>1;){var e=i-2;if(e>=1&&n[e-1]<=n[e]+n[e+1]||e>=2&&n[e-2]<=n[e]+n[e-1])n[e-1]<n[e+1]&&e--;else if(n[e]>n[e+1])break;s(e)}},forceMergeRuns:function(){for(;i>1;){var e=i-2;e>0&&n[e-1]<n[e+1]&&e--,s(e)}},pushRun:function(e,t){a[i]=e,n[i]=t,i+=1}}}function Lqe(e,t,a,n){a||(a=0),n||(n=e.length);var r=n-a;if(!(r<2)){var i=0;if(r<32)Iqe(e,a,n,a+(i=Eqe(e,a,n,t)),t);else{var o=Pqe(e,t),s=function(e){for(var t=0;e>=32;)t|=1&e,e>>=1;return e+t}(r);do{if((i=Eqe(e,a,n,t))<s){var l=r;l>s&&(l=s),Iqe(e,a,a+l,a+i,t),i=l}o.pushRun(a,i),o.mergeRuns(),r-=i,a+=i}while(0!==r);o.forceMergeRuns()}}}var Nqe=!1;function Oqe(){Nqe||(Nqe=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function Fqe(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var Bqe,Uqe=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=Fqe}return e.prototype.traverse=function(e,t){for(var a=0;a<this._roots.length;a++)this._roots[a].traverse(e,t)},e.prototype.getDisplayList=function(e,t){t=t||!1;var a=this._displayList;return!e&&a.length||this.updateDisplayList(t),a},e.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,a=this._displayList,n=0,r=t.length;n<r;n++)this._updateAndAddDisplayable(t[n],null,e);a.length=this._displayListLen,Lqe(a,Fqe)},e.prototype._updateAndAddDisplayable=function(e,t,a){if(!e.ignore||a){e.beforeUpdate(),e.update(),e.afterUpdate();var n=e.getClipPath(),r=t&&t.length,i=0,o=e.__clipPaths;if(!e.ignoreClip&&(r||n)){if(o||(o=e.__clipPaths=[]),r)for(var s=0;s<t.length;s++)o[i++]=t[s];for(var l=n,c=e;l;)l.parent=c,l.updateTransform(),o[i++]=l,c=l,l=l.getClipPath()}if(o&&(o.length=i),e.childrenRef){for(var u=e.childrenRef(),d=0;d<u.length;d++){var h=u[d];e.__dirty&&(h.__dirty|=1),this._updateAndAddDisplayable(h,o,a)}e.__dirty=0}else{var p=e;isNaN(p.z)&&(Oqe(),p.z=0),isNaN(p.z2)&&(Oqe(),p.z2=0),isNaN(p.zlevel)&&(Oqe(),p.zlevel=0),this._displayList[this._displayListLen++]=p}var f=e.getDecalElement&&e.getDecalElement();f&&this._updateAndAddDisplayable(f,o,a);var m=e.getTextGuideLine();m&&this._updateAndAddDisplayable(m,o,a);var v=e.getTextContent();v&&this._updateAndAddDisplayable(v,o,a)}},e.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},e.prototype.delRoot=function(e){if(e instanceof Array)for(var t=0,a=e.length;t<a;t++)this.delRoot(e[t]);else{var n=fGe(this._roots,e);n>=0&&this._roots.splice(n,1)}},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}();Bqe=HHe.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};var zqe={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return.5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return 0===e?0:Math.pow(1024,e-1)},exponentialOut:function(e){return 1===e?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,a=.1;return 0===e?0:1===e?1:(!a||a<1?(a=1,t=.1):t=.4*Math.asin(1/a)/(2*Math.PI),-a*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},elasticOut:function(e){var t,a=.1;return 0===e?0:1===e?1:(!a||a<1?(a=1,t=.1):t=.4*Math.asin(1/a)/(2*Math.PI),a*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},elasticInOut:function(e){var t,a=.1,n=.4;return 0===e?0:1===e?1:(!a||a<1?(a=1,t=.1):t=n*Math.asin(1/a)/(2*Math.PI),(e*=2)<1?a*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*-.5:a*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-zqe.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?.5*zqe.bounceIn(2*e):.5*zqe.bounceOut(2*e-1)+.5}},Vqe=Math.pow,Hqe=Math.sqrt,Gqe=1e-8,Wqe=1e-4,qqe=Hqe(3),Yqe=1/3,jqe=aWe(),Xqe=aWe(),$qe=aWe();function Kqe(e){return e>-1e-8&&e<Gqe}function Zqe(e){return e>Gqe||e<-1e-8}function Jqe(e,t,a,n,r){var i=1-r;return i*i*(i*e+3*r*t)+r*r*(r*n+3*i*a)}function Qqe(e,t,a,n,r){var i=1-r;return 3*(((t-e)*i+2*(a-t)*r)*i+(n-a)*r*r)}function eYe(e,t,a,n,r,i){var o=n+3*(t-a)-e,s=3*(a-2*t+e),l=3*(t-e),c=e-r,u=s*s-3*o*l,d=s*l-9*o*c,h=l*l-3*s*c,p=0;if(Kqe(u)&&Kqe(d)){if(Kqe(s))i[0]=0;else(M=-l/s)>=0&&M<=1&&(i[p++]=M)}else{var f=d*d-4*u*h;if(Kqe(f)){var m=d/u,v=-m/2;(M=-s/o+m)>=0&&M<=1&&(i[p++]=M),v>=0&&v<=1&&(i[p++]=v)}else if(f>0){var g=Hqe(f),y=u*s+1.5*o*(-d+g),b=u*s+1.5*o*(-d-g);(M=(-s-((y=y<0?-Vqe(-y,Yqe):Vqe(y,Yqe))+(b=b<0?-Vqe(-b,Yqe):Vqe(b,Yqe))))/(3*o))>=0&&M<=1&&(i[p++]=M)}else{var x=(2*u*s-3*o*d)/(2*Hqe(u*u*u)),w=Math.acos(x)/3,_=Hqe(u),S=Math.cos(w),M=(-s-2*_*S)/(3*o),T=(v=(-s+_*(S+qqe*Math.sin(w)))/(3*o),(-s+_*(S-qqe*Math.sin(w)))/(3*o));M>=0&&M<=1&&(i[p++]=M),v>=0&&v<=1&&(i[p++]=v),T>=0&&T<=1&&(i[p++]=T)}}return p}function tYe(e,t,a,n,r){var i=6*a-12*t+6*e,o=9*t+3*n-3*e-9*a,s=3*t-3*e,l=0;if(Kqe(o)){if(Zqe(i))(u=-s/i)>=0&&u<=1&&(r[l++]=u)}else{var c=i*i-4*o*s;if(Kqe(c))r[0]=-i/(2*o);else if(c>0){var u,d=Hqe(c),h=(-i-d)/(2*o);(u=(-i+d)/(2*o))>=0&&u<=1&&(r[l++]=u),h>=0&&h<=1&&(r[l++]=h)}}return l}function aYe(e,t,a,n,r,i){var o=(t-e)*r+e,s=(a-t)*r+t,l=(n-a)*r+a,c=(s-o)*r+o,u=(l-s)*r+s,d=(u-c)*r+c;i[0]=e,i[1]=o,i[2]=c,i[3]=d,i[4]=d,i[5]=u,i[6]=l,i[7]=n}function nYe(e,t,a,n,r,i,o,s,l,c,u){var d,h,p,f,m,v=.005,g=1/0;jqe[0]=l,jqe[1]=c;for(var y=0;y<1;y+=.05)Xqe[0]=Jqe(e,a,r,o,y),Xqe[1]=Jqe(t,n,i,s,y),(f=fWe(jqe,Xqe))<g&&(d=y,g=f);g=1/0;for(var b=0;b<32&&!(v<Wqe);b++)h=d-v,p=d+v,Xqe[0]=Jqe(e,a,r,o,h),Xqe[1]=Jqe(t,n,i,s,h),f=fWe(Xqe,jqe),h>=0&&f<g?(d=h,g=f):($qe[0]=Jqe(e,a,r,o,p),$qe[1]=Jqe(t,n,i,s,p),m=fWe($qe,jqe),p<=1&&m<g?(d=p,g=m):v*=.5);return u&&(u[0]=Jqe(e,a,r,o,d),u[1]=Jqe(t,n,i,s,d)),Hqe(g)}function rYe(e,t,a,n,r,i,o,s,l){for(var c=e,u=t,d=0,h=1/l,p=1;p<=l;p++){var f=p*h,m=Jqe(e,a,r,o,f),v=Jqe(t,n,i,s,f),g=m-c,y=v-u;d+=Math.sqrt(g*g+y*y),c=m,u=v}return d}function iYe(e,t,a,n){var r=1-n;return r*(r*e+2*n*t)+n*n*a}function oYe(e,t,a,n){return 2*((1-n)*(t-e)+n*(a-t))}function sYe(e,t,a){var n=e+a-2*t;return 0===n?.5:(e-t)/n}function lYe(e,t,a,n,r){var i=(t-e)*n+e,o=(a-t)*n+t,s=(o-i)*n+i;r[0]=e,r[1]=i,r[2]=s,r[3]=s,r[4]=o,r[5]=a}function cYe(e,t,a,n,r,i,o,s,l){var c,u=.005,d=1/0;jqe[0]=o,jqe[1]=s;for(var h=0;h<1;h+=.05){Xqe[0]=iYe(e,a,r,h),Xqe[1]=iYe(t,n,i,h),(v=fWe(jqe,Xqe))<d&&(c=h,d=v)}d=1/0;for(var p=0;p<32&&!(u<Wqe);p++){var f=c-u,m=c+u;Xqe[0]=iYe(e,a,r,f),Xqe[1]=iYe(t,n,i,f);var v=fWe(Xqe,jqe);if(f>=0&&v<d)c=f,d=v;else{$qe[0]=iYe(e,a,r,m),$qe[1]=iYe(t,n,i,m);var g=fWe($qe,jqe);m<=1&&g<d?(c=m,d=g):u*=.5}}return l&&(l[0]=iYe(e,a,r,c),l[1]=iYe(t,n,i,c)),Hqe(d)}function uYe(e,t,a,n,r,i,o){for(var s=e,l=t,c=0,u=1/o,d=1;d<=o;d++){var h=d*u,p=iYe(e,a,r,h),f=iYe(t,n,i,h),m=p-s,v=f-l;c+=Math.sqrt(m*m+v*v),s=p,l=f}return c}var dYe=/cubic-bezier\(([0-9,\.e ]+)\)/;function hYe(e){var t=e&&dYe.exec(e);if(t){var a=t[1].split(","),n=+HGe(a[0]),r=+HGe(a[1]),i=+HGe(a[2]),o=+HGe(a[3]);if(isNaN(n+r+i+o))return;var s=[];return function(e){return e<=0?0:e>=1?1:eYe(0,n,i,1,e,s)&&Jqe(0,r,o,1,s[0])}}}var pYe=function(){function e(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||eWe,this.ondestroy=e.ondestroy||eWe,this.onrestart=e.onrestart||eWe,e.easing&&this.setEasing(e.easing)}return e.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),!this._paused){var a=this._life,n=e-this._startTime-this._pausedTime,r=n/a;r<0&&(r=0),r=Math.min(r,1);var i=this.easingFunc,o=i?i(r):r;if(this.onframe(o),1===r){if(!this.loop)return!0;var s=n%a;this._startTime=e-s,this._pausedTime=0,this.onrestart()}return!1}this._pausedTime+=t},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(e){this.easing=e,this.easingFunc=kGe(e)?e:zqe[e]||hYe(e)},e}(),fYe=function(e){this.value=e},mYe=function(){function e(){this._len=0}return e.prototype.insert=function(e){var t=new fYe(e);return this.insertEntry(t),t},e.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},e.prototype.remove=function(e){var t=e.prev,a=e.next;t?t.next=a:this.head=a,a?a.prev=t:this.tail=t,e.next=e.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),vYe=function(){function e(e){this._list=new mYe,this._maxSize=10,this._map={},this._maxSize=e}return e.prototype.put=function(e,t){var a=this._list,n=this._map,r=null;if(null==n[e]){var i=a.len(),o=this._lastRemovedEntry;if(i>=this._maxSize&&i>0){var s=a.head;a.remove(s),delete n[s.key],r=s.value,this._lastRemovedEntry=s}o?o.value=t:o=new fYe(t),o.key=e,a.insertEntry(o),n[e]=o}return r},e.prototype.get=function(e){var t=this._map[e],a=this._list;if(null!=t)return t!==a.tail&&(a.remove(t),a.insertEntry(t)),t.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}(),gYe={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function yYe(e){return(e=Math.round(e))<0?0:e>255?255:e}function bYe(e){return e<0?0:e>1?1:e}function xYe(e){var t=e;return t.length&&"%"===t.charAt(t.length-1)?yYe(parseFloat(t)/100*255):yYe(parseInt(t,10))}function wYe(e){var t=e;return t.length&&"%"===t.charAt(t.length-1)?bYe(parseFloat(t)/100):bYe(parseFloat(t))}function _Ye(e,t,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?e+(t-e)*a*6:2*a<1?t:3*a<2?e+(t-e)*(2/3-a)*6:e}function SYe(e,t,a){return e+(t-e)*a}function MYe(e,t,a,n,r){return e[0]=t,e[1]=a,e[2]=n,e[3]=r,e}function TYe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var kYe=new vYe(20),CYe=null;function AYe(e,t){CYe&&TYe(CYe,t),CYe=kYe.put(e,CYe||t.slice())}function EYe(e,t){if(e){t=t||[];var a=kYe.get(e);if(a)return TYe(t,a);var n=(e+="").replace(/ /g,"").toLowerCase();if(n in gYe)return TYe(t,gYe[n]),AYe(e,t),t;var r,i=n.length;if("#"===n.charAt(0))return 4===i||5===i?(r=parseInt(n.slice(1,4),16))>=0&&r<=4095?(MYe(t,(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,5===i?parseInt(n.slice(4),16)/15:1),AYe(e,t),t):void MYe(t,0,0,0,1):7===i||9===i?(r=parseInt(n.slice(1,7),16))>=0&&r<=16777215?(MYe(t,(16711680&r)>>16,(65280&r)>>8,255&r,9===i?parseInt(n.slice(7),16)/255:1),AYe(e,t),t):void MYe(t,0,0,0,1):void 0;var o=n.indexOf("("),s=n.indexOf(")");if(-1!==o&&s+1===i){var l=n.substr(0,o),c=n.substr(o+1,s-(o+1)).split(","),u=1;switch(l){case"rgba":if(4!==c.length)return 3===c.length?MYe(t,+c[0],+c[1],+c[2],1):MYe(t,0,0,0,1);u=wYe(c.pop());case"rgb":return c.length>=3?(MYe(t,xYe(c[0]),xYe(c[1]),xYe(c[2]),3===c.length?u:wYe(c[3])),AYe(e,t),t):void MYe(t,0,0,0,1);case"hsla":return 4!==c.length?void MYe(t,0,0,0,1):(c[3]=wYe(c[3]),IYe(c,t),AYe(e,t),t);case"hsl":return 3!==c.length?void MYe(t,0,0,0,1):(IYe(c,t),AYe(e,t),t);default:return}}MYe(t,0,0,0,1)}}function IYe(e,t){var a=(parseFloat(e[0])%360+360)%360/360,n=wYe(e[1]),r=wYe(e[2]),i=r<=.5?r*(n+1):r+n-r*n,o=2*r-i;return MYe(t=t||[],yYe(255*_Ye(o,i,a+1/3)),yYe(255*_Ye(o,i,a)),yYe(255*_Ye(o,i,a-1/3)),1),4===e.length&&(t[3]=e[3]),t}function RYe(e,t){var a=EYe(e);if(a){for(var n=0;n<3;n++)a[n]=t<0?a[n]*(1-t)|0:(255-a[n])*t+a[n]|0,a[n]>255?a[n]=255:a[n]<0&&(a[n]=0);return NYe(a,4===a.length?"rgba":"rgb")}}function DYe(e,t,a){if(t&&t.length&&e>=0&&e<=1){a=a||[];var n=e*(t.length-1),r=Math.floor(n),i=Math.ceil(n),o=t[r],s=t[i],l=n-r;return a[0]=yYe(SYe(o[0],s[0],l)),a[1]=yYe(SYe(o[1],s[1],l)),a[2]=yYe(SYe(o[2],s[2],l)),a[3]=bYe(SYe(o[3],s[3],l)),a}}function PYe(e,t,a,n){var r=EYe(e);if(e)return r=function(e){if(e){var t,a,n=e[0]/255,r=e[1]/255,i=e[2]/255,o=Math.min(n,r,i),s=Math.max(n,r,i),l=s-o,c=(s+o)/2;if(0===l)t=0,a=0;else{a=c<.5?l/(s+o):l/(2-s-o);var u=((s-n)/6+l/2)/l,d=((s-r)/6+l/2)/l,h=((s-i)/6+l/2)/l;n===s?t=h-d:r===s?t=1/3+u-h:i===s&&(t=2/3+d-u),t<0&&(t+=1),t>1&&(t-=1)}var p=[360*t,a,c];return null!=e[3]&&p.push(e[3]),p}}(r),null!=t&&(r[0]=function(e){return(e=Math.round(e))<0?0:e>360?360:e}(kGe(t)?t(r[0]):t)),null!=a&&(r[1]=wYe(kGe(a)?a(r[1]):a)),null!=n&&(r[2]=wYe(kGe(n)?n(r[2]):n)),NYe(IYe(r),"rgba")}function LYe(e,t){var a=EYe(e);if(a&&null!=t)return a[3]=bYe(t),NYe(a,"rgba")}function NYe(e,t){if(e&&e.length){var a=e[0]+","+e[1]+","+e[2];return"rgba"!==t&&"hsva"!==t&&"hsla"!==t||(a+=","+e[3]),t+"("+a+")"}}function OYe(e,t){var a=EYe(e);return a?(.299*a[0]+.587*a[1]+.114*a[2])*a[3]/255+(1-a[3])*t:0}var FYe=new vYe(100);function BYe(e){if(CGe(e)){var t=FYe.get(e);return t||(t=RYe(e,-.1),FYe.put(e,t)),t}if(LGe(e)){var a=hGe({},e);return a.colorStops=yGe(e.colorStops,function(e){return{offset:e.offset,color:RYe(e.color,-.1)}}),a}return e}var UYe=Math.round;function zYe(e){var t;if(e&&"transparent"!==e){if("string"==typeof e&&e.indexOf("rgba")>-1){var a=EYe(e);a&&(e="rgb("+a[0]+","+a[1]+","+a[2]+")",t=a[3])}}else e="none";return{color:e,opacity:null==t?1:t}}var VYe=1e-4;function HYe(e){return e<VYe&&e>-1e-4}function GYe(e){return UYe(1e3*e)/1e3}function WYe(e){return UYe(1e4*e)/1e4}var qYe={left:"start",right:"end",center:"middle",middle:"middle"};function YYe(e){return e&&!!e.image}function jYe(e){return YYe(e)||function(e){return e&&!!e.svgElement}(e)}function XYe(e){return"linear"===e.type}function $Ye(e){return"radial"===e.type}function KYe(e){return e&&("linear"===e.type||"radial"===e.type)}function ZYe(e){return"url(#"+e+")"}function JYe(e){var t=e.getGlobalScale(),a=Math.max(t[0],t[1]);return Math.max(Math.ceil(Math.log(a)/Math.log(10)),1)}function QYe(e){var t=e.x||0,a=e.y||0,n=(e.rotation||0)*tWe,r=FGe(e.scaleX,1),i=FGe(e.scaleY,1),o=e.skewX||0,s=e.skewY||0,l=[];return(t||a)&&l.push("translate("+t+"px,"+a+"px)"),n&&l.push("rotate("+n+")"),1===r&&1===i||l.push("scale("+r+","+i+")"),(o||s)&&l.push("skew("+UYe(o*tWe)+"deg, "+UYe(s*tWe)+"deg)"),l.join(" ")}var eje=HHe.hasGlobalWindow&&kGe(window.btoa)?function(e){return window.btoa(unescape(encodeURIComponent(e)))}:"undefined"!=typeof Buffer?function(e){return Buffer.from(e).toString("base64")}:function(e){return null},tje=Array.prototype.slice;function aje(e,t,a){return(t-e)*a+e}function nje(e,t,a,n){for(var r=t.length,i=0;i<r;i++)e[i]=aje(t[i],a[i],n);return e}function rje(e,t,a,n){for(var r=t.length,i=0;i<r;i++)e[i]=t[i]+a[i]*n;return e}function ije(e,t,a,n){for(var r=t.length,i=r&&t[0].length,o=0;o<r;o++){e[o]||(e[o]=[]);for(var s=0;s<i;s++)e[o][s]=t[o][s]+a[o][s]*n}return e}function oje(e,t){for(var a=e.length,n=t.length,r=a>n?t:e,i=Math.min(a,n),o=r[i-1]||{color:[0,0,0,0],offset:0},s=i;s<Math.max(a,n);s++)r.push({offset:o.offset,color:o.color.slice()})}function sje(e,t,a){var n=e,r=t;if(n.push&&r.push){var i=n.length,o=r.length;if(i!==o)if(i>o)n.length=o;else for(var s=i;s<o;s++)n.push(1===a?r[s]:tje.call(r[s]));var l=n[0]&&n[0].length;for(s=0;s<n.length;s++)if(1===a)isNaN(n[s])&&(n[s]=r[s]);else for(var c=0;c<l;c++)isNaN(n[s][c])&&(n[s][c]=r[s][c])}}function lje(e){if(vGe(e)){var t=e.length;if(vGe(e[0])){for(var a=[],n=0;n<t;n++)a.push(tje.call(e[n]));return a}return tje.call(e)}return e}function cje(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=null==e[3]?1:e[3],"rgba("+e.join(",")+")"}function uje(e){return 4===e||5===e}function dje(e){return 1===e||2===e}var hje=[0,0,0,0],pje=function(){function e(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(e,t,a){this._needsSort=!0;var n=this.keyframes,r=n.length,i=!1,o=6,s=t;if(vGe(t)){var l=function(e){return vGe(e&&e[0])?2:1}(t);o=l,(1===l&&!EGe(t[0])||2===l&&!EGe(t[0][0]))&&(i=!0)}else if(EGe(t)&&!NGe(t))o=0;else if(CGe(t))if(isNaN(+t)){var c=EYe(t);c&&(s=c,o=3)}else o=0;else if(LGe(t)){var u=hGe({},s);u.colorStops=yGe(t.colorStops,function(e){return{offset:e.offset,color:EYe(e.color)}}),XYe(t)?o=4:$Ye(t)&&(o=5),s=u}0===r?this.valType=o:o===this.valType&&6!==o||(i=!0),this.discrete=this.discrete||i;var d={time:e,value:s,rawValue:t,percent:0};return a&&(d.easing=a,d.easingFunc=kGe(a)?a:zqe[a]||hYe(a)),n.push(d),d},e.prototype.prepare=function(e,t){var a=this.keyframes;this._needsSort&&a.sort(function(e,t){return e.time-t.time});for(var n=this.valType,r=a.length,i=a[r-1],o=this.discrete,s=dje(n),l=uje(n),c=0;c<r;c++){var u=a[c],d=u.value,h=i.value;u.percent=u.time/e,o||(s&&c!==r-1?sje(d,h,n):l&&oje(d.colorStops,h.colorStops))}if(!o&&5!==n&&t&&this.needsAnimate()&&t.needsAnimate()&&n===t.valType&&!t._finished){this._additiveTrack=t;var p=a[0].value;for(c=0;c<r;c++)0===n?a[c].additiveValue=a[c].value-p:3===n?a[c].additiveValue=rje([],a[c].value,p,-1):dje(n)&&(a[c].additiveValue=1===n?rje([],a[c].value,p,-1):ije([],a[c].value,p,-1))}},e.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var a,n,r,i=null!=this._additiveTrack,o=i?"additiveValue":"value",s=this.valType,l=this.keyframes,c=l.length,u=this.propName,d=3===s,h=this._lastFr,p=Math.min;if(1===c)n=r=l[0];else{if(t<0)a=0;else if(t<this._lastFrP){for(a=p(h+1,c-1);a>=0&&!(l[a].percent<=t);a--);a=p(a,c-2)}else{for(a=h;a<c&&!(l[a].percent>t);a++);a=p(a-1,c-2)}r=l[a+1],n=l[a]}if(n&&r){this._lastFr=a,this._lastFrP=t;var f=r.percent-n.percent,m=0===f?1:p((t-n.percent)/f,1);r.easingFunc&&(m=r.easingFunc(m));var v=i?this._additiveValue:d?hje:e[u];if(!dje(s)&&!d||v||(v=this._additiveValue=[]),this.discrete)e[u]=m<1?n.rawValue:r.rawValue;else if(dje(s))1===s?nje(v,n[o],r[o],m):function(e,t,a,n){for(var r=t.length,i=r&&t[0].length,o=0;o<r;o++){e[o]||(e[o]=[]);for(var s=0;s<i;s++)e[o][s]=aje(t[o][s],a[o][s],n)}}(v,n[o],r[o],m);else if(uje(s)){var g=n[o],y=r[o],b=4===s;e[u]={type:b?"linear":"radial",x:aje(g.x,y.x,m),y:aje(g.y,y.y,m),colorStops:yGe(g.colorStops,function(e,t){var a=y.colorStops[t];return{offset:aje(e.offset,a.offset,m),color:cje(nje([],e.color,a.color,m))}}),global:y.global},b?(e[u].x2=aje(g.x2,y.x2,m),e[u].y2=aje(g.y2,y.y2,m)):e[u].r=aje(g.r,y.r,m)}else if(d)nje(v,n[o],r[o],m),i||(e[u]=cje(v));else{var x=aje(n[o],r[o],m);i?this._additiveValue=x:e[u]=x}i&&this._addToTarget(e)}}},e.prototype._addToTarget=function(e){var t=this.valType,a=this.propName,n=this._additiveValue;0===t?e[a]=e[a]+n:3===t?(EYe(e[a],hje),rje(hje,hje,n,1),e[a]=cje(hje)):1===t?rje(e[a],e[a],n,1):2===t&&ije(e[a],e[a],n,1)},e}(),fje=function(){function e(e,t,a,n){this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&n?lGe("Can' use additive animation on looped animation."):(this._additiveAnimators=n,this._allowDiscrete=a)}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(e){this._target=e},e.prototype.when=function(e,t,a){return this.whenWithKeys(e,t,_Ge(t),a)},e.prototype.whenWithKeys=function(e,t,a,n){for(var r=this._tracks,i=0;i<a.length;i++){var o=a[i],s=r[o];if(!s){s=r[o]=new pje(o);var l=void 0,c=this._getAdditiveTrack(o);if(c){var u=c.keyframes,d=u[u.length-1];l=d&&d.value,3===c.valType&&l&&(l=cje(l))}else l=this._target[o];if(null==l)continue;e>0&&s.addKeyframe(0,lje(l),n),this._trackKeys.push(o)}s.addKeyframe(e,lje(t[o]),n)}return this._maxTime=Math.max(this._maxTime,e),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,a=0;a<t;a++)e[a].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var a=0;a<t.length;a++)t[a].call(this)},e.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,a=0;a<t.length;a++)e[t[a]].setFinished()},e.prototype._getAdditiveTrack=function(e){var t,a=this._additiveAnimators;if(a)for(var n=0;n<a.length;n++){var r=a[n].getTrack(e);r&&(t=r)}return t},e.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,a=[],n=this._maxTime||0,r=0;r<this._trackKeys.length;r++){var i=this._trackKeys[r],o=this._tracks[i],s=this._getAdditiveTrack(i),l=o.keyframes,c=l.length;if(o.prepare(n,s),o.needsAnimate())if(!this._allowDiscrete&&o.discrete){var u=l[c-1];u&&(t._target[o.propName]=u.rawValue),o.setFinished()}else a.push(o)}if(a.length||this._force){var d=new pYe({life:n,loop:this._loop,delay:this._delay||0,onframe:function(e){t._started=2;var n=t._additiveAnimators;if(n){for(var r=!1,i=0;i<n.length;i++)if(n[i]._clip){r=!0;break}r||(t._additiveAnimators=null)}for(i=0;i<a.length;i++)a[i].step(t._target,e);var o=t._onframeCbs;if(o)for(i=0;i<o.length;i++)o[i](t._target,e)},ondestroy:function(){t._doneCallback()}});this._clip=d,this.animation&&this.animation.addClip(d),e&&d.setEasing(e)}else this._doneCallback();return this}},e.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},e.prototype.delay=function(e){return this._delay=e,this},e.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},e.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},e.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(e){return this._tracks[e]},e.prototype.getTracks=function(){var e=this;return yGe(this._trackKeys,function(t){return e._tracks[t]})},e.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var a=this._tracks,n=this._trackKeys,r=0;r<e.length;r++){var i=a[e[r]];i&&!i.isFinished()&&(t?i.step(this._target,1):1===this._started&&i.step(this._target,0),i.setFinished())}var o=!0;for(r=0;r<n.length;r++)if(!a[n[r]].isFinished()){o=!1;break}return o&&this._abortedCallback(),o},e.prototype.saveTo=function(e,t,a){if(e){t=t||this._trackKeys;for(var n=0;n<t.length;n++){var r=t[n],i=this._tracks[r];if(i&&!i.isFinished()){var o=i.keyframes,s=o[a?0:o.length-1];s&&(e[r]=lje(s.rawValue))}}}},e.prototype.__changeFinalValue=function(e,t){t=t||_Ge(e);for(var a=0;a<t.length;a++){var n=t[a],r=this._tracks[n];if(r){var i=r.keyframes;if(i.length>1){var o=i.pop();r.addKeyframe(o.time,e[n]),r.prepare(this._maxTime,r.getAdditiveTrack())}}}},e}();function mje(){return(new Date).getTime()}var vje,gje,yje=function(e){function t(t){var a=e.call(this)||this;return a._running=!1,a._time=0,a._pausedTime=0,a._pauseStart=0,a._paused=!1,t=t||{},a.stage=t.stage||{},a}return zHe(t,e),t.prototype.addClip=function(e){e.animation&&this.removeClip(e),this._head?(this._tail.next=e,e.prev=this._tail,e.next=null,this._tail=e):this._head=this._tail=e,e.animation=this},t.prototype.addAnimator=function(e){e.animation=this;var t=e.getClip();t&&this.addClip(t)},t.prototype.removeClip=function(e){if(e.animation){var t=e.prev,a=e.next;t?t.next=a:this._head=a,a?a.prev=t:this._tail=t,e.next=e.prev=e.animation=null}},t.prototype.removeAnimator=function(e){var t=e.getClip();t&&this.removeClip(t),e.animation=null},t.prototype.update=function(e){for(var t=mje()-this._pausedTime,a=t-this._time,n=this._head;n;){var r=n.next;n.step(t,a)?(n.ondestroy(),this.removeClip(n),n=r):n=r}this._time=t,e||(this.trigger("frame",a),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var e=this;this._running=!0,Bqe(function t(){e._running&&(Bqe(t),!e._paused&&e.update())})},t.prototype.start=function(){this._running||(this._time=mje(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=mje(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=mje()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var e=this._head;e;){var t=e.next;e.prev=e.next=e.animation=null,e=t}this._head=this._tail=null},t.prototype.isFinished=function(){return null==this._head},t.prototype.animate=function(e,t){t=t||{},this.start();var a=new fje(e,t.loop);return this.addAnimator(a),a},t}(wWe),bje=HHe.domSupported,xje=(gje={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:vje=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:yGe(vje,function(e){var t=e.replace("mouse","pointer");return gje.hasOwnProperty(t)?t:e})}),wje=["mousemove","mouseup"],_je=["pointermove","pointerup"],Sje=!1;function Mje(e){var t=e.pointerType;return"pen"===t||"touch"===t}function Tje(e){e&&(e.zrByTouch=!0)}function kje(e,t){for(var a=t,n=!1;a&&9!==a.nodeType&&!(n=a.domBelongToZr||a!==t&&a===e.painterRoot);)a=a.parentNode;return n}var Cje=function(e,t){this.stopPropagation=eWe,this.stopImmediatePropagation=eWe,this.preventDefault=eWe,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY},Aje={mousedown:function(e){e=BWe(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=BWe(this.dom,e);var t=this.__mayPointerCapture;!t||e.zrX===t[0]&&e.zrY===t[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=BWe(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){kje(this,(e=BWe(this.dom,e)).toElement||e.relatedTarget)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){Sje=!0,e=BWe(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){Sje||(e=BWe(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){Tje(e=BWe(this.dom,e)),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),Aje.mousemove.call(this,e),Aje.mousedown.call(this,e)},touchmove:function(e){Tje(e=BWe(this.dom,e)),this.handler.processGesture(e,"change"),Aje.mousemove.call(this,e)},touchend:function(e){Tje(e=BWe(this.dom,e)),this.handler.processGesture(e,"end"),Aje.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<300&&Aje.click.call(this,e)},pointerdown:function(e){Aje.mousedown.call(this,e)},pointermove:function(e){Mje(e)||Aje.mousemove.call(this,e)},pointerup:function(e){Aje.mouseup.call(this,e)},pointerout:function(e){Mje(e)||Aje.mouseout.call(this,e)}};gGe(["click","dblclick","contextmenu"],function(e){Aje[e]=function(t){t=BWe(this.dom,t),this.trigger(e,t)}});var Eje={pointermove:function(e){Mje(e)||Eje.mousemove.call(this,e)},pointerup:function(e){Eje.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function Ije(e,t){var a=t.domHandlers;HHe.pointerEventsSupported?gGe(xje.pointer,function(n){Dje(t,n,function(t){a[n].call(e,t)})}):(HHe.touchEventsSupported&&gGe(xje.touch,function(n){Dje(t,n,function(r){a[n].call(e,r),function(e){e.touching=!0,null!=e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)}(t)})}),gGe(xje.mouse,function(n){Dje(t,n,function(r){r=FWe(r),t.touching||a[n].call(e,r)})}))}function Rje(e,t){function a(a){Dje(t,a,function(n){n=FWe(n),kje(e,n.target)||(n=function(e,t){return BWe(e.dom,new Cje(e,t),!0)}(e,n),t.domHandlers[a].call(e,n))},{capture:!0})}HHe.pointerEventsSupported?gGe(_je,a):HHe.touchEventsSupported||gGe(wje,a)}function Dje(e,t,a,n){e.mounted[t]=a,e.listenerOpts[t]=n,UWe(e.domTarget,t,a,n)}function Pje(e){var t=e.mounted;for(var a in t)t.hasOwnProperty(a)&&zWe(e.domTarget,a,t[a],e.listenerOpts[a]);e.mounted={}}var Lje=function(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t},Nje=function(e){function t(t,a){var n=e.call(this)||this;return n.__pointerCapturing=!1,n.dom=t,n.painterRoot=a,n._localHandlerScope=new Lje(t,Aje),bje&&(n._globalHandlerScope=new Lje(document,Eje)),Ije(n,n._localHandlerScope),n}return zHe(t,e),t.prototype.dispose=function(){Pje(this._localHandlerScope),bje&&Pje(this._globalHandlerScope)},t.prototype.setCursor=function(e){this.dom.style&&(this.dom.style.cursor=e||"default")},t.prototype.__togglePointerCapture=function(e){if(this.__mayPointerCapture=null,bje&&+this.__pointerCapturing^+e){this.__pointerCapturing=e;var t=this._globalHandlerScope;e?Rje(this,t):Pje(t)}},t}(wWe),Oje=1;HHe.hasGlobalWindow&&(Oje=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var Fje=Oje,Bje="#333",Uje="#ccc",zje=jWe,Vje=5e-5;function Hje(e){return e>Vje||e<-5e-5}var Gje,Wje=[],qje=[],Yje=[1,0,0,1,0,0],jje=Math.abs,Xje=function(){function e(){}var t;return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},e.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},e.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},e.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},e.prototype.needLocalTransform=function(){return Hje(this.rotation)||Hje(this.x)||Hje(this.y)||Hje(this.scaleX-1)||Hje(this.scaleY-1)||Hje(this.skewX)||Hje(this.skewY)},e.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),a=this.transform;t||e?(a=a||[1,0,0,1,0,0],t?this.getLocalTransform(a):zje(a),e&&(t?$We(a,e,a):XWe(a,e)),this.transform=a,this._resolveGlobalScaleRatio(a)):a&&(zje(a),this.invTransform=null)},e.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(null!=t&&1!==t){this.getGlobalScale(Wje);var a=Wje[0]<0?-1:1,n=Wje[1]<0?-1:1,r=((Wje[0]-a)*t+a)/Wje[0]||0,i=((Wje[1]-n)*t+n)/Wje[1]||0;e[0]*=r,e[1]*=r,e[2]*=i,e[3]*=i}this.invTransform=this.invTransform||[1,0,0,1,0,0],QWe(this.invTransform,e)},e.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},e.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],a=e[2]*e[2]+e[3]*e[3],n=Math.atan2(e[1],e[0]),r=Math.PI/2+n-Math.atan2(e[3],e[2]);a=Math.sqrt(a)*Math.cos(r),t=Math.sqrt(t),this.skewX=r,this.skewY=0,this.rotation=-n,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=a,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(e.invTransform=e.invTransform||[1,0,0,1,0,0],$We(qje,e.invTransform,t),t=qje);var a=this.originX,n=this.originY;(a||n)&&(Yje[4]=a,Yje[5]=n,$We(qje,t,Yje),qje[4]-=a,qje[5]-=n,t=qje),this.setLocalTransform(t)}},e.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},e.prototype.transformCoordToLocal=function(e,t){var a=[e,t],n=this.invTransform;return n&&vWe(a,a,n),a},e.prototype.transformCoordToGlobal=function(e,t){var a=[e,t],n=this.transform;return n&&vWe(a,a,n),a},e.prototype.getLineScale=function(){var e=this.transform;return e&&jje(e[0]-1)>1e-10&&jje(e[3]-1)>1e-10?Math.sqrt(jje(e[0]*e[3]-e[2]*e[1])):1},e.prototype.copyTransform=function(e){Kje(this,e)},e.getLocalTransform=function(e,t){t=t||[];var a=e.originX||0,n=e.originY||0,r=e.scaleX,i=e.scaleY,o=e.anchorX,s=e.anchorY,l=e.rotation||0,c=e.x,u=e.y,d=e.skewX?Math.tan(e.skewX):0,h=e.skewY?Math.tan(-e.skewY):0;if(a||n||o||s){var p=a+o,f=n+s;t[4]=-p*r-d*f*i,t[5]=-f*i-h*p*r}else t[4]=t[5]=0;return t[0]=r,t[3]=i,t[1]=h*r,t[2]=d*i,l&&ZWe(t,t,l),t[4]+=a+c,t[5]+=n+u,t},e.initDefaultProps=((t=e.prototype).scaleX=t.scaleY=t.globalScaleRatio=1,void(t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0)),e}(),$je=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function Kje(e,t){for(var a=0;a<$je.length;a++){var n=$je[a];e[n]=t[n]}}function Zje(e){Gje||(Gje=new vYe(100)),e=e||WHe;var t=Gje.get(e);return t||(t={font:e,strWidthCache:new vYe(500),asciiWidthMap:null,asciiWidthMapTried:!1,stWideCharWidth:XHe.measureText("国",e).width,asciiCharWidth:XHe.measureText("a",e).width},Gje.put(e,t)),t}var Jje=0,Qje=5;function eXe(e,t){return e.asciiWidthMapTried||(e.asciiWidthMap=function(e){if(!(Jje>=Qje)){e=e||WHe;for(var t=[],a=+new Date,n=0;n<=127;n++)t[n]=XHe.measureText(String.fromCharCode(n),e).width;var r=+new Date-a;return r>16?Jje=Qje:r>2&&Jje++,t}}(e.font),e.asciiWidthMapTried=!0),0<=t&&t<=127?null!=e.asciiWidthMap?e.asciiWidthMap[t]:e.asciiCharWidth:e.stWideCharWidth}function tXe(e,t){var a=e.strWidthCache,n=a.get(t);return null==n&&(n=XHe.measureText(t,e.font).width,a.put(t,n)),n}function aXe(e,t,a,n){var r=tXe(Zje(t),e),i=oXe(t),o=rXe(0,r,a),s=iXe(0,i,n);return new fqe(o,s,r,i)}function nXe(e,t,a,n){var r=((e||"")+"").split("\n");if(1===r.length)return aXe(r[0],t,a,n);for(var i=new fqe(0,0,0,0),o=0;o<r.length;o++){var s=aXe(r[o],t,a,n);0===o?i.copy(s):i.union(s)}return i}function rXe(e,t,a,n){return"right"===a?n?e+=t:e-=t:"center"===a&&(n?e+=t/2:e-=t/2),e}function iXe(e,t,a,n){return"middle"===a?n?e+=t/2:e-=t/2:"bottom"===a&&(n?e+=t:e-=t),e}function oXe(e){return Zje(e).stWideCharWidth}function sXe(e,t){return"string"==typeof e?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function lXe(e,t,a){var n=t.position||"inside",r=null!=t.distance?t.distance:5,i=a.height,o=a.width,s=i/2,l=a.x,c=a.y,u="left",d="top";if(n instanceof Array)l+=sXe(n[0],a.width),c+=sXe(n[1],a.height),u=null,d=null;else switch(n){case"left":l-=r,c+=s,u="right",d="middle";break;case"right":l+=r+o,c+=s,d="middle";break;case"top":l+=o/2,c-=r,u="center",d="bottom";break;case"bottom":l+=o/2,c+=i+r,u="center";break;case"inside":l+=o/2,c+=s,u="center",d="middle";break;case"insideLeft":l+=r,c+=s,d="middle";break;case"insideRight":l+=o-r,c+=s,u="right",d="middle";break;case"insideTop":l+=o/2,c+=r,u="center";break;case"insideBottom":l+=o/2,c+=i-r,u="center",d="bottom";break;case"insideTopLeft":l+=r,c+=r;break;case"insideTopRight":l+=o-r,c+=r,u="right";break;case"insideBottomLeft":l+=r,c+=i-r,d="bottom";break;case"insideBottomRight":l+=o-r,c+=i-r,u="right",d="bottom"}return(e=e||{}).x=l,e.y=c,e.align=u,e.verticalAlign=d,e}var cXe="__zr_normal__",uXe=$je.concat(["ignore"]),dXe=bGe($je,function(e,t){return e[t]=!0,e},{ignore:!1}),hXe={},pXe=new fqe(0,0,0,0),fXe=[],mXe=function(){function e(e){this.id=sGe(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return e.prototype._init=function(e){this.attr(e)},e.prototype.drift=function(e,t,a){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0}var n=this.transform;n||(n=this.transform=[1,0,0,1,0,0]),n[4]+=e,n[5]+=t,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var a=this.textConfig,n=a.local,r=t.innerTransformable,i=void 0,o=void 0,s=!1;r.parent=n?this:null;var l=!1;r.copyTransform(t);var c=null!=a.position,u=a.autoOverflowArea,d=void 0;if((u||c)&&(d=pXe,a.layoutRect?d.copy(a.layoutRect):d.copy(this.getBoundingRect()),n||d.applyTransform(this.transform)),c){this.calculateTextPosition?this.calculateTextPosition(hXe,a,d):lXe(hXe,a,d),r.x=hXe.x,r.y=hXe.y,i=hXe.align,o=hXe.verticalAlign;var h=a.origin;if(h&&null!=a.rotation){var p=void 0,f=void 0;"center"===h?(p=.5*d.width,f=.5*d.height):(p=sXe(h[0],d.width),f=sXe(h[1],d.height)),l=!0,r.originX=-r.x+p+(n?0:d.x),r.originY=-r.y+f+(n?0:d.y)}}null!=a.rotation&&(r.rotation=a.rotation);var m=a.offset;m&&(r.x+=m[0],r.y+=m[1],l||(r.originX=-m[0],r.originY=-m[1]));var v=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={});if(u){var g=v.overflowRect=v.overflowRect||new fqe(0,0,0,0);r.getLocalTransform(fXe),QWe(fXe,fXe),fqe.copy(g,d),g.applyTransform(fXe)}else v.overflowRect=null;var y=void 0,b=void 0,x=void 0;(null==a.inside?"string"==typeof a.position&&a.position.indexOf("inside")>=0:a.inside)&&this.canBeInsideText()?(y=a.insideFill,b=a.insideStroke,null!=y&&"auto"!==y||(y=this.getInsideTextFill()),null!=b&&"auto"!==b||(b=this.getInsideTextStroke(y),x=!0)):(y=a.outsideFill,b=a.outsideStroke,null!=y&&"auto"!==y||(y=this.getOutsideFill()),null!=b&&"auto"!==b||(b=this.getOutsideStroke(y),x=!0)),(y=y||"#000")===v.fill&&b===v.stroke&&x===v.autoStroke&&i===v.align&&o===v.verticalAlign||(s=!0,v.fill=y,v.stroke=b,v.autoStroke=x,v.align=i,v.verticalAlign=o,t.setDefaultTextStyle(v)),t.__dirty|=1,s&&t.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(e){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?Uje:Bje},e.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),a="string"==typeof t&&EYe(t);a||(a=[255,255,255,1]);for(var n=a[3],r=this.__zr.isDarkMode(),i=0;i<3;i++)a[i]=a[i]*n+(r?0:255)*(1-n);return a[3]=1,NYe(a,"rgba")},e.prototype.traverse=function(e,t){},e.prototype.attrKV=function(e,t){"textConfig"===e?this.setTextConfig(t):"textContent"===e?this.setTextContent(t):"clipPath"===e?this.setClipPath(t):"extra"===e?(this.extra=this.extra||{},hGe(this.extra,t)):this[e]=t},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(e,t){if("string"==typeof e)this.attrKV(e,t);else if(IGe(e))for(var a=_Ge(e),n=0;n<a.length;n++){var r=a[n];this.attrKV(r,e[r])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,a=0;a<this.animators.length;a++){var n=this.animators[a],r=n.__fromStateTransition;if(!(n.getLoop()||r&&r!==cXe)){var i=n.targetName,o=i?t[i]:t;n.saveTo(o)}}},e.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,uXe)},e.prototype._savePrimaryToNormal=function(e,t,a){for(var n=0;n<a.length;n++){var r=a[n];null==e[r]||r in t||(t[r]=this[r])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(e){return this.states[e]},e.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},e.prototype.clearStates=function(e){this.useState(cXe,!1,e)},e.prototype.useState=function(e,t,a,n){var r=e===cXe;if(this.hasState()||!r){var i=this.currentStates,o=this.stateTransition;if(!(fGe(i,e)>=0)||!t&&1!==i.length){var s;if(this.stateProxy&&!r&&(s=this.stateProxy(e)),s||(s=this.states&&this.states[e]),s||r){r||this.saveCurrentToNormalState(s);var l=!!(s&&s.hoverLayer||n);l&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,s,this._normalState,t,!a&&!this.__inHover&&o&&o.duration>0,o);var c=this._textContent,u=this._textGuide;return c&&c.useState(e,t,a,l),u&&u.useState(e,t,a,l),r?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!l&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),s}lGe("State "+e+" not exists.")}}},e.prototype.useStates=function(e,t,a){if(e.length){var n=[],r=this.currentStates,i=e.length,o=i===r.length;if(o)for(var s=0;s<i;s++)if(e[s]!==r[s]){o=!1;break}if(o)return;for(s=0;s<i;s++){var l=e[s],c=void 0;this.stateProxy&&(c=this.stateProxy(l,e)),c||(c=this.states[l]),c&&n.push(c)}var u=n[i-1],d=!!(u&&u.hoverLayer||a);d&&this._toggleHoverLayerFlag(!0);var h=this._mergeStates(n),p=this.stateTransition;this.saveCurrentToNormalState(h),this._applyStateObj(e.join(","),h,this._normalState,!1,!t&&!this.__inHover&&p&&p.duration>0,p);var f=this._textContent,m=this._textGuide;f&&f.useStates(e,t,d),m&&m.useStates(e,t,d),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!d&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}else this.clearStates()},e.prototype.isSilent=function(){for(var e=this;e;){if(e.silent)return!0;var t=e.__hostTarget;e=t?e.ignoreHostSilent?null:t:e.parent}return!1},e.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},e.prototype.removeState=function(e){var t=fGe(this.currentStates,e);if(t>=0){var a=this.currentStates.slice();a.splice(t,1),this.useStates(a)}},e.prototype.replaceState=function(e,t,a){var n=this.currentStates.slice(),r=fGe(n,e),i=fGe(n,t)>=0;r>=0?i?n.splice(r,1):n[r]=t:a&&!i&&n.push(t),this.useStates(n)},e.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},e.prototype._mergeStates=function(e){for(var t,a={},n=0;n<e.length;n++){var r=e[n];hGe(a,r),r.textConfig&&hGe(t=t||{},r.textConfig)}return t&&(a.textConfig=t),a},e.prototype._applyStateObj=function(e,t,a,n,r,i){var o=!(t&&n);t&&t.textConfig?(this.textConfig=hGe({},n?this.textConfig:a.textConfig),hGe(this.textConfig,t.textConfig)):o&&a.textConfig&&(this.textConfig=a.textConfig);for(var s={},l=!1,c=0;c<uXe.length;c++){var u=uXe[c],d=r&&dXe[u];t&&null!=t[u]?d?(l=!0,s[u]=t[u]):this[u]=t[u]:o&&null!=a[u]&&(d?(l=!0,s[u]=a[u]):this[u]=a[u])}if(!r)for(c=0;c<this.animators.length;c++){var h=this.animators[c],p=h.targetName;h.getLoop()||h.__changeFinalValue(p?(t||a)[p]:t||a)}l&&this._transitionState(e,s,i)},e.prototype._attachComponent=function(e){if((!e.__zr||e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},e.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},e.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new Xje,this._attachComponent(e),this._textContent=e,this.markRedraw())},e.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),hGe(this.textConfig,e),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=1;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,a=this._textGuide;t&&(t.__inHover=e),a&&(a.__inHover=e)},e.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var a=0;a<t.length;a++)e.animation.addAnimator(t[a]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},e.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var a=0;a<t.length;a++)e.animation.removeAnimator(t[a]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},e.prototype.animate=function(e,t,a){var n=e?this[e]:this,r=new fje(n,t,a);return e&&(r.targetName=e),this.addAnimator(r,e),r},e.prototype.addAnimator=function(e,t){var a=this.__zr,n=this;e.during(function(){n.updateDuringAnimation(t)}).done(function(){var t=n.animators,a=fGe(t,e);a>=0&&t.splice(a,1)}),this.animators.push(e),a&&a.animation.addAnimator(e),a&&a.wakeUp()},e.prototype.updateDuringAnimation=function(e){this.markRedraw()},e.prototype.stopAnimation=function(e,t){for(var a=this.animators,n=a.length,r=[],i=0;i<n;i++){var o=a[i];e&&e!==o.scope?r.push(o):o.stop(t)}return this.animators=r,this},e.prototype.animateTo=function(e,t,a){vXe(this,e,t,a)},e.prototype.animateFrom=function(e,t,a){vXe(this,e,t,a,!0)},e.prototype._transitionState=function(e,t,a,n){for(var r=vXe(this,t,a,n),i=0;i<r.length;i++)r[i].__fromStateTransition=e},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;function a(e,a,n,r){function i(e,t){Object.defineProperty(t,0,{get:function(){return e[n]},set:function(t){e[n]=t}}),Object.defineProperty(t,1,{get:function(){return e[r]},set:function(t){e[r]=t}})}Object.defineProperty(t,e,{get:function(){this[a]||i(this,this[a]=[]);return this[a]},set:function(e){this[n]=e[0],this[r]=e[1],this[a]=e,i(this,e)}})}t.type="element",t.name="",t.ignore=t.silent=t.ignoreHostSilent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=1,Object.defineProperty&&(a("position","_legacyPos","x","y"),a("scale","_legacyScale","scaleX","scaleY"),a("origin","_legacyOrigin","originX","originY"))}(),e}();function vXe(e,t,a,n,r){var i=[];bXe(e,"",e,t,a=a||{},n,i,r);var o=i.length,s=!1,l=a.done,c=a.aborted,u=function(){s=!0,--o<=0&&(s?l&&l():c&&c())},d=function(){--o<=0&&(s?l&&l():c&&c())};o||l&&l(),i.length>0&&a.during&&i[0].during(function(e,t){a.during(t)});for(var h=0;h<i.length;h++){var p=i[h];u&&p.done(u),d&&p.aborted(d),a.force&&p.duration(a.duration),p.start(a.easing)}return i}function gXe(e,t,a){for(var n=0;n<a;n++)e[n]=t[n]}function yXe(e,t,a){if(vGe(t[a]))if(vGe(e[a])||(e[a]=[]),DGe(t[a])){var n=t[a].length;e[a].length!==n&&(e[a]=new t[a].constructor(n),gXe(e[a],t[a],n))}else{var r=t[a],i=e[a],o=r.length;if(vGe(r[0]))for(var s=r[0].length,l=0;l<o;l++)i[l]?gXe(i[l],r[l],s):i[l]=Array.prototype.slice.call(r[l]);else gXe(i,r,o);i.length=r.length}else e[a]=t[a]}function bXe(e,t,a,n,r,i,o,s){for(var l=_Ge(n),c=r.duration,u=r.delay,d=r.additive,h=r.setToFinal,p=!IGe(i),f=e.animators,m=[],v=0;v<l.length;v++){var g=l[v],y=n[g];if(null!=y&&null!=a[g]&&(p||i[g]))if(!IGe(y)||vGe(y)||LGe(y))m.push(g);else{if(t){s||(a[g]=y,e.updateDuringAnimation(t));continue}bXe(e,g,a[g],y,r,i&&i[g],o,s)}else s||(a[g]=y,e.updateDuringAnimation(t),m.push(g))}var b=m.length;if(!d&&b)for(var x=0;x<f.length;x++){if((_=f[x]).targetName===t)if(_.stopTracks(m)){var w=fGe(f,_);f.splice(w,1)}}if(r.force||(m=xGe(m,function(e){return t=n[e],r=a[e],!(t===r||vGe(t)&&vGe(r)&&function(e,t){var a=e.length;if(a!==t.length)return!1;for(var n=0;n<a;n++)if(e[n]!==t[n])return!1;return!0}(t,r));var t,r}),b=m.length),b>0||r.force&&!o.length){var _,S=void 0,M=void 0,T=void 0;if(s){M={},h&&(S={});for(x=0;x<b;x++){M[g=m[x]]=a[g],h?S[g]=n[g]:a[g]=n[g]}}else if(h){T={};for(x=0;x<b;x++){T[g=m[x]]=lje(a[g]),yXe(a,n,g)}}(_=new fje(a,!1,!1,d?xGe(f,function(e){return e.targetName===t}):null)).targetName=t,r.scope&&(_.scope=r.scope),h&&S&&_.whenWithKeys(0,S,m),T&&_.whenWithKeys(0,T,m),_.whenWithKeys(null==c?500:c,s?M:n,m).delay(u||0),e.addAnimator(_,t),o.push(_)}}mGe(mXe,wWe),mGe(mXe,Xje);var xXe=function(e){function t(t){var a=e.call(this)||this;return a.isGroup=!0,a._children=[],a.attr(t),a}return zHe(t,e),t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(e){return this._children[e]},t.prototype.childOfName=function(e){for(var t=this._children,a=0;a<t.length;a++)if(t[a].name===e)return t[a]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},t.prototype.addBefore=function(e,t){if(e&&e!==this&&e.parent!==this&&t&&t.parent===this){var a=this._children,n=a.indexOf(t);n>=0&&(a.splice(n,0,e),this._doAdd(e))}return this},t.prototype.replace=function(e,t){var a=fGe(this._children,e);return a>=0&&this.replaceAt(t,a),this},t.prototype.replaceAt=function(e,t){var a=this._children,n=a[t];if(e&&e!==this&&e.parent!==this&&e!==n){a[t]=e,n.parent=null;var r=this.__zr;r&&n.removeSelfFromZr(r),this._doAdd(e)}return this},t.prototype._doAdd=function(e){e.parent&&e.parent.remove(e),e.parent=this;var t=this.__zr;t&&t!==e.__zr&&e.addSelfToZr(t),t&&t.refresh()},t.prototype.remove=function(e){var t=this.__zr,a=this._children,n=fGe(a,e);return n<0||(a.splice(n,1),e.parent=null,t&&e.removeSelfFromZr(t),t&&t.refresh()),this},t.prototype.removeAll=function(){for(var e=this._children,t=this.__zr,a=0;a<e.length;a++){var n=e[a];t&&n.removeSelfFromZr(t),n.parent=null}return e.length=0,this},t.prototype.eachChild=function(e,t){for(var a=this._children,n=0;n<a.length;n++){var r=a[n];e.call(t,r,n)}return this},t.prototype.traverse=function(e,t){for(var a=0;a<this._children.length;a++){var n=this._children[a],r=e.call(t,n);n.isGroup&&!r&&n.traverse(e,t)}return this},t.prototype.addSelfToZr=function(t){e.prototype.addSelfToZr.call(this,t);for(var a=0;a<this._children.length;a++){this._children[a].addSelfToZr(t)}},t.prototype.removeSelfFromZr=function(t){e.prototype.removeSelfFromZr.call(this,t);for(var a=0;a<this._children.length;a++){this._children[a].removeSelfFromZr(t)}},t.prototype.getBoundingRect=function(e){for(var t=new fqe(0,0,0,0),a=e||this._children,n=[],r=null,i=0;i<a.length;i++){var o=a[i];if(!o.ignore&&!o.invisible){var s=o.getBoundingRect(),l=o.getLocalTransform(n);l?(fqe.applyTransform(t,s,l),(r=r||t.clone()).union(t)):(r=r||s.clone()).union(s)}}return r||t},t}(mXe);xXe.prototype.type="group";
/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/
var wXe={},_Xe={};var SXe,MXe=function(){function e(e,t,a){var n=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,a=a||{},this.dom=t,this.id=e;var r=new Uqe,i=a.renderer||"canvas";wXe[i]||(i=_Ge(wXe)[0]),a.useDirtyRect=null!=a.useDirtyRect&&a.useDirtyRect;var o=new wXe[i](t,r,a,e),s=a.ssr||o.ssrOnly;this.storage=r,this.painter=o;var l,c=HHe.node||HHe.worker||s?null:new Nje(o.getViewportRoot(),o.root),u=a.useCoarsePointer;(null==u||"auto"===u?HHe.touchEventsSupported:!!u)&&(l=FGe(a.pointerSize,44)),this.handler=new Tqe(r,o,c,o.root,l),this.animation=new yje({stage:{update:s?null:function(){return n._flush(!0)}}}),s||this.animation.start()}return e.prototype.add=function(e){!this._disposed&&e&&(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},e.prototype.remove=function(e){!this._disposed&&e&&(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(e,t){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh())},e.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=function(e){if(!e)return!1;if("string"==typeof e)return OYe(e,1)<.4;if(e.colorStops){for(var t=e.colorStops,a=0,n=t.length,r=0;r<n;r++)a+=OYe(t[r].color,1);return(a/=n)<.4}return!1}(e))},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(e){this._darkMode=e},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},e.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},e.prototype.flush=function(){this._disposed||this._flush(!1)},e.prototype._flush=function(e){var t,a=mje();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var n=mje();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:n-a})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},e.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover())},e.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},e.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},e.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},e.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},e.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},e.prototype.findHover=function(e,t){if(!this._disposed)return this.handler.findHover(e,t)},e.prototype.on=function(e,t,a){return this._disposed||this.handler.on(e,t,a),this},e.prototype.off=function(e,t){this._disposed||this.handler.off(e,t)},e.prototype.trigger=function(e,t){this._disposed||this.handler.trigger(e,t)},e.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof xXe&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},e.prototype.dispose=function(){var e;this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,e=this.id,delete _Xe[e])},e}();function TXe(e,t){var a=new MXe(sGe(),e,t);return _Xe[a.id]=a,a}var kXe=1e-4;var CXe=Math.min,AXe=Math.max,EXe=Math.abs;function IXe(e,t,a,n){var r=t[0],i=t[1],o=a[0],s=a[1],l=i-r,c=s-o;if(0===l)return 0===c?o:(o+s)/2;if(n)if(l>0){if(e<=r)return o;if(e>=i)return s}else{if(e>=r)return o;if(e<=i)return s}else{if(e===r)return o;if(e===i)return s}return(e-r)/l*c+o}var RXe=function(e,t,a){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%"}return DXe(e,t,a)};function DXe(e,t,a){return CGe(e)?(n=e,n.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(e)/100*t+(a||0):parseFloat(e):null==e?NaN:+e;var n}function PXe(e,t,a){return null==t&&(t=10),t=Math.min(Math.max(0,t),20),e=(+e).toFixed(t),a?e:+e}function LXe(e){return e.sort(function(e,t){return e-t}),e}function NXe(e){if(e=+e,isNaN(e))return 0;if(e>1e-14)for(var t=1,a=0;a<15;a++,t*=10)if(Math.round(e*t)/t===e)return a;return function(e){var t=e.toString().toLowerCase(),a=t.indexOf("e"),n=a>0?+t.slice(a+1):0,r=a>0?a:t.length,i=t.indexOf("."),o=i<0?0:r-1-i;return Math.max(0,o-n)}(e)}function OXe(e,t){var a=Math.log,n=Math.LN10,r=Math.floor(a(e[1]-e[0])/n),i=Math.round(a(EXe(t[1]-t[0]))/n),o=Math.min(Math.max(-r+i,0),20);return isFinite(o)?o:20}function FXe(e,t){var a=Math.max(NXe(e),NXe(t)),n=e+t;return a>20?n:PXe(n,a)}var BXe=9007199254740991;function UXe(e){var t=2*Math.PI;return(e%t+t)%t}function zXe(e){return e>-1e-4&&e<kXe}var VXe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function HXe(e){if(e instanceof Date)return e;if(CGe(e)){var t=VXe.exec(e);if(!t)return new Date(NaN);if(t[8]){var a=+t[4]||0;return"Z"!==t[8].toUpperCase()&&(a-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,a,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}return null==e?new Date(NaN):new Date(Math.round(e))}function GXe(e){if(0===e)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function WXe(e,t){var a=GXe(e),n=Math.pow(10,a),r=e/n;return e=(r<1.5?1:r<2.5?2:r<4?3:r<7?5:10)*n,a>=-20?+e.toFixed(a<0?-a:0):e}function qXe(e,t){var a=(e.length-1)*t+1,n=Math.floor(a),r=+e[n-1],i=a-n;return i?r+i*(e[n]-r):r}function YXe(e){e.sort(function(e,t){return s(e,t,0)?-1:1});for(var t=-1/0,a=1,n=0;n<e.length;){for(var r=e[n].interval,i=e[n].close,o=0;o<2;o++)r[o]<=t&&(r[o]=t,i[o]=o?1:1-a),t=r[o],a=i[o];r[0]===r[1]&&i[0]*i[1]!==1?e.splice(n,1):n++}return e;function s(e,t,a){return e.interval[a]<t.interval[a]||e.interval[a]===t.interval[a]&&(e.close[a]-t.close[a]===(a?-1:1)||!a&&s(e,t,1))}}function jXe(e){var t=parseFloat(e);return t==e&&(0!==t||!CGe(e)||e.indexOf("x")<=0)?t:NaN}function XXe(e){return!isNaN(jXe(e))}function $Xe(){return Math.round(9*Math.random())}function KXe(e,t){return 0===t?e:KXe(t,e%t)}function ZXe(e,t){return null==e?t:null==t?e:e*t/KXe(e,t)}var JXe="undefined"!=typeof console&&console.warn&&console.log;function QXe(e,t){!function(e,t){JXe&&console[e]("[ECharts] "+t)}("error",e)}function e$e(e){throw new Error(e)}function t$e(e,t,a){return(t-e)*a+e}var a$e="series\0",n$e="\0_ec_\0";function r$e(e){return e instanceof Array?e:null==e?[]:[e]}function i$e(e,t,a){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var n=0,r=a.length;n<r;n++){var i=a[n];!e.emphasis[t].hasOwnProperty(i)&&e[t].hasOwnProperty(i)&&(e.emphasis[t][i]=e[t][i])}}}var o$e=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function s$e(e){return!IGe(e)||TGe(e)||e instanceof Date?e:e.value}function l$e(e){return IGe(e)&&!(e instanceof Array)}function c$e(e,t,a){var n="normalMerge"===a,r="replaceMerge"===a,i="replaceAll"===a;e=e||[],t=(t||[]).slice();var o=$Ge();gGe(t,function(e,a){IGe(e)||(t[a]=null)});var s,l,c=function(e,t,a){var n=[];if("replaceAll"===a)return n;for(var r=0;r<e.length;r++){var i=e[r];i&&null!=i.id&&t.set(i.id,r),n.push({existing:"replaceMerge"===a||f$e(i)?null:i,newOption:null,keyInfo:null,brandNew:null})}return n}(e,o,a);return(n||r)&&function(e,t,a,n){gGe(n,function(r,i){if(r&&null!=r.id){var o=d$e(r.id),s=a.get(o);if(null!=s){var l=e[s];VGe(!l.newOption,'Duplicated option on id "'+o+'".'),l.newOption=r,l.existing=t[s],n[i]=null}}})}(c,e,o,t),n&&function(e,t){gGe(t,function(a,n){if(a&&null!=a.name)for(var r=0;r<e.length;r++){var i=e[r].existing;if(!e[r].newOption&&i&&(null==i.id||null==a.id)&&!f$e(a)&&!f$e(i)&&u$e("name",i,a))return e[r].newOption=a,void(t[n]=null)}})}(c,t),n||r?function(e,t,a){gGe(t,function(t){if(t){for(var n,r=0;(n=e[r])&&(n.newOption||f$e(n.existing)||n.existing&&null!=t.id&&!u$e("id",t,n.existing));)r++;n?(n.newOption=t,n.brandNew=a):e.push({newOption:t,brandNew:a,existing:null,keyInfo:null}),r++}})}(c,t,r):i&&function(e,t){gGe(t,function(t){e.push({newOption:t,brandNew:!0,existing:null,keyInfo:null})})}(c,t),s=c,l=$Ge(),gGe(s,function(e){var t=e.existing;t&&l.set(t.id,e)}),gGe(s,function(e){var t=e.newOption;VGe(!t||null==t.id||!l.get(t.id)||l.get(t.id)===e,"id duplicates: "+(t&&t.id)),t&&null!=t.id&&l.set(t.id,e),!e.keyInfo&&(e.keyInfo={})}),gGe(s,function(e,t){var a=e.existing,n=e.newOption,r=e.keyInfo;if(IGe(n)){if(r.name=null!=n.name?d$e(n.name):a?a.name:a$e+t,a)r.id=d$e(a.id);else if(null!=n.id)r.id=d$e(n.id);else{var i=0;do{r.id="\0"+r.name+"\0"+i++}while(l.get(r.id))}l.set(r.id,e)}}),c}function u$e(e,t,a){var n=h$e(t[e],null),r=h$e(a[e],null);return null!=n&&null!=r&&n===r}function d$e(e){return h$e(e,"")}function h$e(e,t){return null==e?t:CGe(e)?e:EGe(e)||AGe(e)?e+"":t}function p$e(e){var t=e.name;return!(!t||!t.indexOf(a$e))}function f$e(e){return e&&null!=e.id&&0===d$e(e.id).indexOf(n$e)}function m$e(e,t){return null!=t.dataIndexInside?t.dataIndexInside:null!=t.dataIndex?TGe(t.dataIndex)?yGe(t.dataIndex,function(t){return e.indexOfRawIndex(t)}):e.indexOfRawIndex(t.dataIndex):null!=t.name?TGe(t.name)?yGe(t.name,function(t){return e.indexOfName(t)}):e.indexOfName(t.name):void 0}function v$e(){var e="__ec_inner_"+g$e++;return function(t){return t[e]||(t[e]={})}}var g$e=$Xe();function y$e(e,t,a){var n=b$e(t,a),r=n.mainTypeSpecified,i=n.queryOptionMap,o=n.others,s=a?a.defaultMainType:null;return!r&&s&&i.set(s,{}),i.each(function(t,n){var r=_$e(e,n,t,{useDefault:s===n,enableAll:!a||null==a.enableAll||a.enableAll,enableNone:!a||null==a.enableNone||a.enableNone});o[n+"Models"]=r.models,o[n+"Model"]=r.models[0]}),o}function b$e(e,t){var a;if(CGe(e)){var n={};n[e+"Index"]=0,a=n}else a=e;var r=$Ge(),i={},o=!1;return gGe(a,function(e,a){if("dataIndex"!==a&&"dataIndexInside"!==a){var n=a.match(/^(\w+)(Index|Id|Name)$/)||[],s=n[1],l=(n[2]||"").toLowerCase();if(s&&l&&!(t&&t.includeMainTypes&&fGe(t.includeMainTypes,s)<0))o=o||!!s,(r.get(s)||r.set(s,{}))[l]=e}else i[a]=e}),{mainTypeSpecified:o,queryOptionMap:r,others:i}}var x$e={useDefault:!0,enableAll:!1,enableNone:!1},w$e={useDefault:!1,enableAll:!0,enableNone:!0};function _$e(e,t,a,n){n=n||x$e;var r=a.index,i=a.id,o=a.name,s={models:null,specified:null!=r||null!=i||null!=o};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=e.getComponent(t))?[l]:[],s}if("none"===r||!1===r){if(n.enableNone)return s.models=[],s;r=-1}return"all"===r&&(r=n.enableAll?i=o=null:-1),s.models=e.queryComponents({mainType:t,index:r,id:i,name:o}),s}function S$e(e,t,a){e.setAttribute?e.setAttribute(t,a):e[t]=a}function M$e(e,t){var a=$Ge(),n=[];return gGe(e,function(e){var r=t(e);(a.get(r)||(n.push(r),a.set(r,[]))).push(e)}),{keys:n,buckets:a}}function T$e(e,t,a,n,r){var i=null==t||"auto"===t;if(null==n)return n;if(EGe(n))return PXe(f=t$e(a||0,n,r),i?Math.max(NXe(a||0),NXe(n)):t);if(CGe(n))return r<1?a:n;for(var o=[],s=a,l=n,c=Math.max(s?s.length:0,l.length),u=0;u<c;++u){var d=e.getDimensionInfo(u);if(d&&"ordinal"===d.type)o[u]=(r<1&&s?s:l)[u];else{var h=s&&s[u]?s[u]:0,p=l[u],f=t$e(h,p,r);o[u]=PXe(f,i?Math.max(NXe(h),NXe(p)):t)}}return o}var k$e=function(){function e(){}return e.prototype.reset=function(e,t,a,n){return this._list=e,this._step=n=n||1,this._idx=t,this._end=null!=a?a:n>0?e.length:0,this.item=null,this.key=NaN,this},e.prototype.next=function(){return(this._step>0?this._idx<this._end:this._idx>=this._end)&&(this.item=this._list[this._idx],this.key=this._idx=this._idx+this._step,!0)},e}();function C$e(e){e.option=e.parentModel=e.ecModel=null}var A$e="___EC__COMPONENT__CONTAINER___",E$e="___EC__EXTENDED_CLASS___";function I$e(e){var t={main:"",sub:""};if(e){var a=e.split(".");t.main=a[0]||"",t.sub=a[1]||""}return t}function R$e(e,t){e.$constructor=e,e.extend=function(e){var t,a,n=this;return kGe(a=n)&&/^class\s/.test(Function.prototype.toString.call(a))?t=function(e){function t(){return e.apply(this,arguments)||this}return zHe(t,e),t}(n):(t=function(){(e.$constructor||n).apply(this,arguments)},function(e,t){var a=e.prototype;function n(){}for(var r in n.prototype=t.prototype,e.prototype=new n,a)a.hasOwnProperty(r)&&(e.prototype[r]=a[r]);e.prototype.constructor=e,e.superClass=t}(t,this)),hGe(t.prototype,e),t[E$e]=!0,t.extend=this.extend,t.superCall=L$e,t.superApply=N$e,t.superClass=n,t}}function D$e(e,t){e.extend=t.extend}var P$e=Math.round(10*Math.random());function L$e(e,t){for(var a=[],n=2;n<arguments.length;n++)a[n-2]=arguments[n];return this.superClass.prototype[t].apply(e,a)}function N$e(e,t,a){return this.superClass.prototype[t].apply(e,a)}function O$e(e){var t={};e.registerClass=function(e){var a,n=e.type||e.prototype.type;if(n){VGe(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(a=n),'componentType "'+a+'" illegal'),e.prototype.type=n;var r=I$e(n);if(r.sub){if(r.sub!==A$e){var i=function(e){var a=t[e.main];a&&a[A$e]||((a=t[e.main]={})[A$e]=!0);return a}(r);i[r.sub]=e}}else t[r.main]=e}return e},e.getClass=function(e,a,n){var r=t[e];if(r&&r[A$e]&&(r=a?r[a]:null),n&&!r)throw new Error(a?"Component "+e+"."+(a||"")+" is used but not imported.":e+".type should be specified.");return r},e.getClassesByMainType=function(e){var a=I$e(e),n=[],r=t[a.main];return r&&r[A$e]?gGe(r,function(e,t){t!==A$e&&n.push(e)}):n.push(r),n},e.hasClass=function(e){var a=I$e(e);return!!t[a.main]},e.getAllClassMainTypes=function(){var e=[];return gGe(t,function(t,a){e.push(a)}),e},e.hasSubTypes=function(e){var a=I$e(e),n=t[a.main];return n&&n[A$e]}}function F$e(e,t){for(var a=0;a<e.length;a++)e[a][1]||(e[a][1]=e[a][0]);return t=t||!1,function(a,n,r){for(var i={},o=0;o<e.length;o++){var s=e[o][1];if(!(n&&fGe(n,s)>=0||r&&fGe(r,s)<0)){var l=a.getShallow(s,t);null!=l&&(i[e[o][0]]=l)}}return i}}var B$e=F$e([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),U$e=function(){function e(){}return e.prototype.getAreaStyle=function(e,t){return B$e(this,e,t)},e}(),z$e=new vYe(50);function V$e(e){if("string"==typeof e){var t=z$e.get(e);return t&&t.image}return e}function H$e(e,t,a,n,r){if(e){if("string"==typeof e){if(t&&t.__zrImageSrc===e||!a)return t;var i=z$e.get(e),o={hostEl:a,cb:n,cbPayload:r};return i?!W$e(t=i.image)&&i.pending.push(o):((t=XHe.loadImage(e,G$e,G$e)).__zrImageSrc=e,z$e.put(e,t.__cachedImgObj={image:t,pending:[o]})),t}return e}return t}function G$e(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var a=e.pending[t],n=a.cb;n&&n(this,a.cbPayload),a.hostEl.dirty()}e.pending.length=0}function W$e(e){return e&&e.width&&e.height}var q$e=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function Y$e(e,t,a,n,r,i){if(!a)return e.text="",void(e.isTruncated=!1);var o=(t+"").split("\n");i=j$e(a,n,r,i);for(var s=!1,l={},c=0,u=o.length;c<u;c++)X$e(l,o[c],i),o[c]=l.textLine,s=s||l.isTruncated;e.text=o.join("\n"),e.isTruncated=s}function j$e(e,t,a,n){var r=hGe({},n=n||{});a=FGe(a,"..."),r.maxIterations=FGe(n.maxIterations,2);var i=r.minChar=FGe(n.minChar,0),o=r.fontMeasureInfo=Zje(t),s=o.asciiCharWidth;r.placeholder=FGe(n.placeholder,"");for(var l=e=Math.max(0,e-1),c=0;c<i&&l>=s;c++)l-=s;var u=tXe(o,a);return u>l&&(a="",u=0),l=e-u,r.ellipsis=a,r.ellipsisWidth=u,r.contentWidth=l,r.containerWidth=e,r}function X$e(e,t,a){var n=a.containerWidth,r=a.contentWidth,i=a.fontMeasureInfo;if(!n)return e.textLine="",void(e.isTruncated=!1);var o=tXe(i,t);if(o<=n)return e.textLine=t,void(e.isTruncated=!1);for(var s=0;;s++){if(o<=r||s>=a.maxIterations){t+=a.ellipsis;break}var l=0===s?$$e(t,r,i):o>0?Math.floor(t.length*r/o):0;o=tXe(i,t=t.substr(0,l))}""===t&&(t=a.placeholder),e.textLine=t,e.isTruncated=!0}function $$e(e,t,a){for(var n=0,r=0,i=e.length;r<i&&n<t;r++)n+=eXe(a,e.charCodeAt(r));return r}var K$e=function(){},Z$e=function(e){this.tokens=[],e&&(this.tokens=e)},J$e=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1};function Q$e(e,t,a,n,r){var i,o,s=""===t,l=r&&a.rich[r]||{},c=e.lines,u=l.font||a.font,d=!1;if(n){var h=l.padding,p=h?h[1]+h[3]:0;if(null!=l.width&&"auto"!==l.width){var f=sXe(l.width,n.width)+p;c.length>0&&f+n.accumWidth>n.width&&(i=t.split("\n"),d=!0),n.accumWidth=f}else{var m=aKe(t,u,n.width,n.breakAll,n.accumWidth);n.accumWidth=m.accumWidth+p,o=m.linesWidths,i=m.lines}}i||(i=t.split("\n"));for(var v=Zje(u),g=0;g<i.length;g++){var y=i[g],b=new K$e;if(b.styleName=r,b.text=y,b.isLineHolder=!y&&!s,"number"==typeof l.width?b.width=l.width:b.width=o?o[g]:tXe(v,y),g||d)c.push(new Z$e([b]));else{var x=(c[c.length-1]||(c[0]=new Z$e)).tokens,w=x.length;1===w&&x[0].isLineHolder?x[0]=b:(y||!w||s)&&x.push(b)}}}var eKe=bGe(",&?/;] ".split(""),function(e,t){return e[t]=!0,e},{});function tKe(e){return!function(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}(e)||!!eKe[e]}function aKe(e,t,a,n,r){for(var i=[],o=[],s="",l="",c=0,u=0,d=Zje(t),h=0;h<e.length;h++){var p=e.charAt(h);if("\n"!==p){var f=eXe(d,p.charCodeAt(0)),m=!n&&!tKe(p);(i.length?u+f>a:r+u+f>a)?u?(s||l)&&(m?(s||(s=l,l="",u=c=0),i.push(s),o.push(u-c),l+=p,s="",u=c+=f):(l&&(s+=l,l="",c=0),i.push(s),o.push(u),s=p,u=f)):m?(i.push(l),o.push(c),l=p,c=f):(i.push(p),o.push(f)):(u+=f,m?(l+=p,c+=f):(l&&(s+=l,l="",c=0),s+=p))}else l&&(s+=l,u+=c),i.push(s),o.push(u),s="",l="",c=0,u=0}return l&&(s+=l),s&&(i.push(s),o.push(u)),1===i.length&&(u+=r),{accumWidth:u,lines:i,linesWidths:o}}function nKe(e,t,a,n,r,i){if(e.baseX=a,e.baseY=n,e.outerWidth=e.outerHeight=null,t){var o=2*t.width,s=2*t.height;fqe.set(rKe,rXe(a,o,r),iXe(n,s,i),o,s),fqe.intersect(t,rKe,null,iKe);var l=iKe.outIntersectRect;e.outerWidth=l.width,e.outerHeight=l.height,e.baseX=rXe(l.x,l.width,r,!0),e.baseY=iXe(l.y,l.height,i,!0)}}var rKe=new fqe(0,0,0,0),iKe={outIntersectRect:{},clamp:!0};function oKe(e){return null!=e?e+="":e=""}function sKe(e,t,a,n){var r=new fqe(rXe(e.x||0,t,e.textAlign),iXe(e.y||0,a,e.textBaseline),t,a),i=null!=n?n:lKe(e)?e.lineWidth:0;return i>0&&(r.x-=i/2,r.y-=i/2,r.width+=i,r.height+=i),r}function lKe(e){var t=e.stroke;return null!=t&&"none"!==t&&e.lineWidth>0}var cKe="__zr_style_"+Math.round(10*Math.random()),uKe={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},dKe={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};uKe[cKe]=!0;var hKe=["z","z2","invisible"],pKe=["invisible"],fKe=function(e){function t(t){return e.call(this,t)||this}var a;return zHe(t,e),t.prototype._init=function(t){for(var a=_Ge(t),n=0;n<a.length;n++){var r=a[n];"style"===r?this.useStyle(t[r]):e.prototype.attrKV.call(this,r,t[r])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(e,t,a,n){var r=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(e,t,a){mKe.copy(e.getBoundingRect()),e.transform&&mKe.applyTransform(e.transform);return vKe.width=t,vKe.height=a,!mKe.intersect(vKe)}(this,e,t)||r&&!r[0]&&!r[3])return!1;if(a&&this.__clipPaths&&this.__clipPaths.length)for(var i=0;i<this.__clipPaths.length;++i)if(this.__clipPaths[i].isZeroArea())return!1;if(n&&this.parent)for(var o=this.parent;o;){if(o.ignore)return!1;o=o.parent}return!0},t.prototype.contain=function(e,t){return this.rectContain(e,t)},t.prototype.traverse=function(e,t){e.call(t,this)},t.prototype.rectContain=function(e,t){var a=this.transformCoordToLocal(e,t);return this.getBoundingRect().contain(a[0],a[1])},t.prototype.getPaintRect=function(){var e=this._paintRect;if(!this._paintRect||this.__dirty){var t=this.transform,a=this.getBoundingRect(),n=this.style,r=n.shadowBlur||0,i=n.shadowOffsetX||0,o=n.shadowOffsetY||0;e=this._paintRect||(this._paintRect=new fqe(0,0,0,0)),t?fqe.applyTransform(e,a,t):e.copy(a),(r||i||o)&&(e.width+=2*r+Math.abs(i),e.height+=2*r+Math.abs(o),e.x=Math.min(e.x,e.x+i-r),e.y=Math.min(e.y,e.y+o-r));var s=this.dirtyRectTolerance;e.isZero()||(e.x=Math.floor(e.x-s),e.y=Math.floor(e.y-s),e.width=Math.ceil(e.width+1+2*s),e.height=Math.ceil(e.height+1+2*s))}return e},t.prototype.setPrevPaintRect=function(e){e?(this._prevPaintRect=this._prevPaintRect||new fqe(0,0,0,0),this._prevPaintRect.copy(e)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(e){return this.animate("style",e)},t.prototype.updateDuringAnimation=function(e){"style"===e?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(t,a){"style"!==t?e.prototype.attrKV.call(this,t,a):this.style?this.setStyle(a):this.useStyle(a)},t.prototype.setStyle=function(e,t){return"string"==typeof e?this.style[e]=t:hGe(this.style,e),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(e){e||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(2&this.__dirty)},t.prototype.styleUpdated=function(){this.__dirty&=-3},t.prototype.createStyle=function(e){return ZGe(uKe,e)},t.prototype.useStyle=function(e){e[cKe]||(e=this.createStyle(e)),this.__inHover?this.__hoverStyle=e:this.style=e,this.dirtyStyle()},t.prototype.isStyleObject=function(e){return e[cKe]},t.prototype._innerSaveToNormal=function(t){e.prototype._innerSaveToNormal.call(this,t);var a=this._normalState;t.style&&!a.style&&(a.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,a,hKe)},t.prototype._applyStateObj=function(t,a,n,r,i,o){e.prototype._applyStateObj.call(this,t,a,n,r,i,o);var s,l=!(a&&r);if(a&&a.style?i?r?s=a.style:(s=this._mergeStyle(this.createStyle(),n.style),this._mergeStyle(s,a.style)):(s=this._mergeStyle(this.createStyle(),r?this.style:n.style),this._mergeStyle(s,a.style)):l&&(s=n.style),s)if(i){var c=this.style;if(this.style=this.createStyle(l?{}:c),l)for(var u=_Ge(c),d=0;d<u.length;d++){(p=u[d])in s&&(s[p]=s[p],this.style[p]=c[p])}var h=_Ge(s);for(d=0;d<h.length;d++){var p=h[d];this.style[p]=this.style[p]}this._transitionState(t,{style:s},o,this.getAnimationStyleProps())}else this.useStyle(s);var f=this.__inHover?pKe:hKe;for(d=0;d<f.length;d++){p=f[d];a&&null!=a[p]?this[p]=a[p]:l&&null!=n[p]&&(this[p]=n[p])}},t.prototype._mergeStates=function(t){for(var a,n=e.prototype._mergeStates.call(this,t),r=0;r<t.length;r++){var i=t[r];i.style&&(a=a||{},this._mergeStyle(a,i.style))}return a&&(n.style=a),n},t.prototype._mergeStyle=function(e,t){return hGe(e,t),e},t.prototype.getAnimationStyleProps=function(){return dKe},t.initDefaultProps=((a=t.prototype).type="displayable",a.invisible=!1,a.z=0,a.z2=0,a.zlevel=0,a.culling=!1,a.cursor="pointer",a.rectHover=!1,a.incremental=!1,a._rect=null,a.dirtyRectTolerance=0,void(a.__dirty=3)),t}(mXe),mKe=new fqe(0,0,0,0),vKe=new fqe(0,0,0,0);var gKe=Math.min,yKe=Math.max,bKe=Math.sin,xKe=Math.cos,wKe=2*Math.PI,_Ke=aWe(),SKe=aWe(),MKe=aWe();function TKe(e,t,a){if(0!==e.length){for(var n=e[0],r=n[0],i=n[0],o=n[1],s=n[1],l=1;l<e.length;l++)n=e[l],r=gKe(r,n[0]),i=yKe(i,n[0]),o=gKe(o,n[1]),s=yKe(s,n[1]);t[0]=r,t[1]=o,a[0]=i,a[1]=s}}function kKe(e,t,a,n,r,i){r[0]=gKe(e,a),r[1]=gKe(t,n),i[0]=yKe(e,a),i[1]=yKe(t,n)}var CKe=[],AKe=[];function EKe(e,t,a,n,r,i,o,s,l,c){var u=tYe,d=Jqe,h=u(e,a,r,o,CKe);l[0]=1/0,l[1]=1/0,c[0]=-1/0,c[1]=-1/0;for(var p=0;p<h;p++){var f=d(e,a,r,o,CKe[p]);l[0]=gKe(f,l[0]),c[0]=yKe(f,c[0])}h=u(t,n,i,s,AKe);for(p=0;p<h;p++){var m=d(t,n,i,s,AKe[p]);l[1]=gKe(m,l[1]),c[1]=yKe(m,c[1])}l[0]=gKe(e,l[0]),c[0]=yKe(e,c[0]),l[0]=gKe(o,l[0]),c[0]=yKe(o,c[0]),l[1]=gKe(t,l[1]),c[1]=yKe(t,c[1]),l[1]=gKe(s,l[1]),c[1]=yKe(s,c[1])}function IKe(e,t,a,n,r,i,o,s){var l=sYe,c=iYe,u=yKe(gKe(l(e,a,r),1),0),d=yKe(gKe(l(t,n,i),1),0),h=c(e,a,r,u),p=c(t,n,i,d);o[0]=gKe(e,r,h),o[1]=gKe(t,i,p),s[0]=yKe(e,r,h),s[1]=yKe(t,i,p)}function RKe(e,t,a,n,r,i,o,s,l){var c=gWe,u=yWe,d=Math.abs(r-i);if(d%wKe<1e-4&&d>1e-4)return s[0]=e-a,s[1]=t-n,l[0]=e+a,void(l[1]=t+n);if(_Ke[0]=xKe(r)*a+e,_Ke[1]=bKe(r)*n+t,SKe[0]=xKe(i)*a+e,SKe[1]=bKe(i)*n+t,c(s,_Ke,SKe),u(l,_Ke,SKe),(r%=wKe)<0&&(r+=wKe),(i%=wKe)<0&&(i+=wKe),r>i&&!o?i+=wKe:r<i&&o&&(r+=wKe),o){var h=i;i=r,r=h}for(var p=0;p<i;p+=Math.PI/2)p>r&&(MKe[0]=xKe(p)*a+e,MKe[1]=bKe(p)*n+t,c(s,MKe,s),u(l,MKe,l))}var DKe={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},PKe=[],LKe=[],NKe=[],OKe=[],FKe=[],BKe=[],UKe=Math.min,zKe=Math.max,VKe=Math.cos,HKe=Math.sin,GKe=Math.abs,WKe=Math.PI,qKe=2*WKe,YKe="undefined"!=typeof Float32Array,jKe=[];function XKe(e){return Math.round(e/WKe*1e8)/1e8%2*WKe}function $Ke(e,t){var a=XKe(e[0]);a<0&&(a+=qKe);var n=a-e[0],r=e[1];r+=n,!t&&r-a>=qKe?r=a+qKe:t&&a-r>=qKe?r=a-qKe:!t&&a>r?r=a+(qKe-XKe(a-r)):t&&a<r&&(r=a-(qKe-XKe(r-a))),e[0]=a,e[1]=r}var KKe=function(){function e(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}var t;return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(e,t,a){(a=a||0)>0&&(this._ux=GKe(a/Fje/e)||0,this._uy=GKe(a/Fje/t)||0)},e.prototype.setDPR=function(e){this.dpr=e},e.prototype.setContext=function(e){this._ctx=e},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(DKe.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},e.prototype.lineTo=function(e,t){var a=GKe(e-this._xi),n=GKe(t-this._yi),r=a>this._ux||n>this._uy;if(this.addData(DKe.L,e,t),this._ctx&&r&&this._ctx.lineTo(e,t),r)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var i=a*a+n*n;i>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=i)}return this},e.prototype.bezierCurveTo=function(e,t,a,n,r,i){return this._drawPendingPt(),this.addData(DKe.C,e,t,a,n,r,i),this._ctx&&this._ctx.bezierCurveTo(e,t,a,n,r,i),this._xi=r,this._yi=i,this},e.prototype.quadraticCurveTo=function(e,t,a,n){return this._drawPendingPt(),this.addData(DKe.Q,e,t,a,n),this._ctx&&this._ctx.quadraticCurveTo(e,t,a,n),this._xi=a,this._yi=n,this},e.prototype.arc=function(e,t,a,n,r,i){this._drawPendingPt(),jKe[0]=n,jKe[1]=r,$Ke(jKe,i),n=jKe[0];var o=(r=jKe[1])-n;return this.addData(DKe.A,e,t,a,a,n,o,0,i?0:1),this._ctx&&this._ctx.arc(e,t,a,n,r,i),this._xi=VKe(r)*a+e,this._yi=HKe(r)*a+t,this},e.prototype.arcTo=function(e,t,a,n,r){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,a,n,r),this},e.prototype.rect=function(e,t,a,n){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,a,n),this.addData(DKe.R,e,t,a,n),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(DKe.Z);var e=this._ctx,t=this._x0,a=this._y0;return e&&e.closePath(),this._xi=t,this._yi=a,this},e.prototype.fill=function(e){e&&e.fill(),this.toStatic()},e.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(e){if(this._saveData){var t=e.length;this.data&&this.data.length===t||!YKe||(this.data=new Float32Array(t));for(var a=0;a<t;a++)this.data[a]=e[a];this._len=t}},e.prototype.appendPath=function(e){if(this._saveData){e instanceof Array||(e=[e]);for(var t=e.length,a=0,n=this._len,r=0;r<t;r++)a+=e[r].len();var i=this.data;if(YKe&&(i instanceof Float32Array||!i)&&(this.data=new Float32Array(n+a),n>0&&i))for(var o=0;o<n;o++)this.data[o]=i[o];for(r=0;r<t;r++){var s=e[r].data;for(o=0;o<s.length;o++)this.data[n++]=s[o]}this._len=n}},e.prototype.addData=function(e,t,a,n,r,i,o,s,l){if(this._saveData){var c=this.data;this._len+arguments.length>c.length&&(this._expandData(),c=this.data);for(var u=0;u<arguments.length;u++)c[this._len++]=arguments[u]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,YKe&&this._len>11&&(this.data=new Float32Array(e)))}},e.prototype.getBoundingRect=function(){NKe[0]=NKe[1]=FKe[0]=FKe[1]=Number.MAX_VALUE,OKe[0]=OKe[1]=BKe[0]=BKe[1]=-Number.MAX_VALUE;var e,t=this.data,a=0,n=0,r=0,i=0;for(e=0;e<this._len;){var o=t[e++],s=1===e;switch(s&&(r=a=t[e],i=n=t[e+1]),o){case DKe.M:a=r=t[e++],n=i=t[e++],FKe[0]=r,FKe[1]=i,BKe[0]=r,BKe[1]=i;break;case DKe.L:kKe(a,n,t[e],t[e+1],FKe,BKe),a=t[e++],n=t[e++];break;case DKe.C:EKe(a,n,t[e++],t[e++],t[e++],t[e++],t[e],t[e+1],FKe,BKe),a=t[e++],n=t[e++];break;case DKe.Q:IKe(a,n,t[e++],t[e++],t[e],t[e+1],FKe,BKe),a=t[e++],n=t[e++];break;case DKe.A:var l=t[e++],c=t[e++],u=t[e++],d=t[e++],h=t[e++],p=t[e++]+h;e+=1;var f=!t[e++];s&&(r=VKe(h)*u+l,i=HKe(h)*d+c),RKe(l,c,u,d,h,p,f,FKe,BKe),a=VKe(p)*u+l,n=HKe(p)*d+c;break;case DKe.R:kKe(r=a=t[e++],i=n=t[e++],r+t[e++],i+t[e++],FKe,BKe);break;case DKe.Z:a=r,n=i}gWe(NKe,NKe,FKe),yWe(OKe,OKe,BKe)}return 0===e&&(NKe[0]=NKe[1]=OKe[0]=OKe[1]=0),new fqe(NKe[0],NKe[1],OKe[0]-NKe[0],OKe[1]-NKe[1])},e.prototype._calculateLength=function(){var e=this.data,t=this._len,a=this._ux,n=this._uy,r=0,i=0,o=0,s=0;this._pathSegLen||(this._pathSegLen=[]);for(var l=this._pathSegLen,c=0,u=0,d=0;d<t;){var h=e[d++],p=1===d;p&&(o=r=e[d],s=i=e[d+1]);var f=-1;switch(h){case DKe.M:r=o=e[d++],i=s=e[d++];break;case DKe.L:var m=e[d++],v=(b=e[d++])-i;(GKe(E=m-r)>a||GKe(v)>n||d===t-1)&&(f=Math.sqrt(E*E+v*v),r=m,i=b);break;case DKe.C:var g=e[d++],y=e[d++],b=(m=e[d++],e[d++]),x=e[d++],w=e[d++];f=rYe(r,i,g,y,m,b,x,w,10),r=x,i=w;break;case DKe.Q:f=uYe(r,i,g=e[d++],y=e[d++],m=e[d++],b=e[d++],10),r=m,i=b;break;case DKe.A:var _=e[d++],S=e[d++],M=e[d++],T=e[d++],k=e[d++],C=e[d++],A=C+k;d+=1,p&&(o=VKe(k)*M+_,s=HKe(k)*T+S),f=zKe(M,T)*UKe(qKe,Math.abs(C)),r=VKe(A)*M+_,i=HKe(A)*T+S;break;case DKe.R:o=r=e[d++],s=i=e[d++],f=2*e[d++]+2*e[d++];break;case DKe.Z:var E=o-r;v=s-i;f=Math.sqrt(E*E+v*v),r=o,i=s}f>=0&&(l[u++]=f,c+=f)}return this._pathLen=c,c},e.prototype.rebuildPath=function(e,t){var a,n,r,i,o,s,l,c,u,d,h=this.data,p=this._ux,f=this._uy,m=this._len,v=t<1,g=0,y=0,b=0;if(!v||(this._pathSegLen||this._calculateLength(),l=this._pathSegLen,c=t*this._pathLen))e:for(var x=0;x<m;){var w=h[x++],_=1===x;switch(_&&(a=r=h[x],n=i=h[x+1]),w!==DKe.L&&b>0&&(e.lineTo(u,d),b=0),w){case DKe.M:a=r=h[x++],n=i=h[x++],e.moveTo(r,i);break;case DKe.L:o=h[x++],s=h[x++];var S=GKe(o-r),M=GKe(s-i);if(S>p||M>f){if(v){if(g+(X=l[y++])>c){var T=(c-g)/X;e.lineTo(r*(1-T)+o*T,i*(1-T)+s*T);break e}g+=X}e.lineTo(o,s),r=o,i=s,b=0}else{var k=S*S+M*M;k>b&&(u=o,d=s,b=k)}break;case DKe.C:var C=h[x++],A=h[x++],E=h[x++],I=h[x++],R=h[x++],D=h[x++];if(v){if(g+(X=l[y++])>c){aYe(r,C,E,R,T=(c-g)/X,PKe),aYe(i,A,I,D,T,LKe),e.bezierCurveTo(PKe[1],LKe[1],PKe[2],LKe[2],PKe[3],LKe[3]);break e}g+=X}e.bezierCurveTo(C,A,E,I,R,D),r=R,i=D;break;case DKe.Q:C=h[x++],A=h[x++],E=h[x++],I=h[x++];if(v){if(g+(X=l[y++])>c){lYe(r,C,E,T=(c-g)/X,PKe),lYe(i,A,I,T,LKe),e.quadraticCurveTo(PKe[1],LKe[1],PKe[2],LKe[2]);break e}g+=X}e.quadraticCurveTo(C,A,E,I),r=E,i=I;break;case DKe.A:var P=h[x++],L=h[x++],N=h[x++],O=h[x++],F=h[x++],B=h[x++],U=h[x++],z=!h[x++],V=N>O?N:O,H=GKe(N-O)>.001,G=F+B,W=!1;if(v)g+(X=l[y++])>c&&(G=F+B*(c-g)/X,W=!0),g+=X;if(H&&e.ellipse?e.ellipse(P,L,N,O,U,F,G,z):e.arc(P,L,V,F,G,z),W)break e;_&&(a=VKe(F)*N+P,n=HKe(F)*O+L),r=VKe(G)*N+P,i=HKe(G)*O+L;break;case DKe.R:a=r=h[x],n=i=h[x+1],o=h[x++],s=h[x++];var q=h[x++],Y=h[x++];if(v){if(g+(X=l[y++])>c){var j=c-g;e.moveTo(o,s),e.lineTo(o+UKe(j,q),s),(j-=q)>0&&e.lineTo(o+q,s+UKe(j,Y)),(j-=Y)>0&&e.lineTo(o+zKe(q-j,0),s+Y),(j-=q)>0&&e.lineTo(o,s+zKe(Y-j,0));break e}g+=X}e.rect(o,s,q,Y);break;case DKe.Z:if(v){var X;if(g+(X=l[y++])>c){T=(c-g)/X;e.lineTo(r*(1-T)+a*T,i*(1-T)+n*T);break e}g+=X}e.closePath(),r=a,i=n}}},e.prototype.clone=function(){var t=new e,a=this.data;return t.data=a.slice?a.slice():Array.prototype.slice.call(a),t._len=this._len,t},e.prototype.canSave=function(){return!!this._saveData},e.CMD=DKe,e.initDefaultProps=((t=e.prototype)._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,void(t._version=0)),e}();function ZKe(e,t,a,n,r,i,o){if(0===r)return!1;var s=r,l=0;if(o>t+s&&o>n+s||o<t-s&&o<n-s||i>e+s&&i>a+s||i<e-s&&i<a-s)return!1;if(e===a)return Math.abs(i-e)<=s/2;var c=(l=(t-n)/(e-a))*i-o+(e*n-a*t)/(e-a);return c*c/(l*l+1)<=s/2*s/2}function JKe(e,t,a,n,r,i,o,s,l,c,u){if(0===l)return!1;var d=l;return!(u>t+d&&u>n+d&&u>i+d&&u>s+d||u<t-d&&u<n-d&&u<i-d&&u<s-d||c>e+d&&c>a+d&&c>r+d&&c>o+d||c<e-d&&c<a-d&&c<r-d&&c<o-d)&&nYe(e,t,a,n,r,i,o,s,c,u,null)<=d/2}function QKe(e,t,a,n,r,i,o,s,l){if(0===o)return!1;var c=o;return!(l>t+c&&l>n+c&&l>i+c||l<t-c&&l<n-c&&l<i-c||s>e+c&&s>a+c&&s>r+c||s<e-c&&s<a-c&&s<r-c)&&cYe(e,t,a,n,r,i,s,l,null)<=c/2}var eZe=2*Math.PI;function tZe(e){return(e%=eZe)<0&&(e+=eZe),e}var aZe=2*Math.PI;function nZe(e,t,a,n,r,i,o,s,l){if(0===o)return!1;var c=o;s-=e,l-=t;var u=Math.sqrt(s*s+l*l);if(u-c>a||u+c<a)return!1;if(Math.abs(n-r)%aZe<1e-4)return!0;if(i){var d=n;n=tZe(r),r=tZe(d)}else n=tZe(n),r=tZe(r);n>r&&(r+=aZe);var h=Math.atan2(l,s);return h<0&&(h+=aZe),h>=n&&h<=r||h+aZe>=n&&h+aZe<=r}function rZe(e,t,a,n,r,i){if(i>t&&i>n||i<t&&i<n)return 0;if(n===t)return 0;var o=(i-t)/(n-t),s=n<t?1:-1;1!==o&&0!==o||(s=n<t?.5:-.5);var l=o*(a-e)+e;return l===r?1/0:l>r?s:0}var iZe=KKe.CMD,oZe=2*Math.PI;var sZe=[-1,-1,-1],lZe=[-1,-1];function cZe(){var e=lZe[0];lZe[0]=lZe[1],lZe[1]=e}function uZe(e,t,a,n,r,i,o,s,l,c){if(c>t&&c>n&&c>i&&c>s||c<t&&c<n&&c<i&&c<s)return 0;var u=eYe(t,n,i,s,c,sZe);if(0===u)return 0;for(var d=0,h=-1,p=void 0,f=void 0,m=0;m<u;m++){var v=sZe[m],g=0===v||1===v?.5:1;Jqe(e,a,r,o,v)<l||(h<0&&(h=tYe(t,n,i,s,lZe),lZe[1]<lZe[0]&&h>1&&cZe(),p=Jqe(t,n,i,s,lZe[0]),h>1&&(f=Jqe(t,n,i,s,lZe[1]))),2===h?v<lZe[0]?d+=p<t?g:-g:v<lZe[1]?d+=f<p?g:-g:d+=s<f?g:-g:v<lZe[0]?d+=p<t?g:-g:d+=s<p?g:-g)}return d}function dZe(e,t,a,n,r,i,o,s){if(s>t&&s>n&&s>i||s<t&&s<n&&s<i)return 0;var l=function(e,t,a,n,r){var i=e-2*t+a,o=2*(t-e),s=e-n,l=0;if(Kqe(i))Zqe(o)&&(u=-s/o)>=0&&u<=1&&(r[l++]=u);else{var c=o*o-4*i*s;if(Kqe(c))(u=-o/(2*i))>=0&&u<=1&&(r[l++]=u);else if(c>0){var u,d=Hqe(c),h=(-o-d)/(2*i);(u=(-o+d)/(2*i))>=0&&u<=1&&(r[l++]=u),h>=0&&h<=1&&(r[l++]=h)}}return l}(t,n,i,s,sZe);if(0===l)return 0;var c=sYe(t,n,i);if(c>=0&&c<=1){for(var u=0,d=iYe(t,n,i,c),h=0;h<l;h++){var p=0===sZe[h]||1===sZe[h]?.5:1;iYe(e,a,r,sZe[h])<o||(sZe[h]<c?u+=d<t?p:-p:u+=i<d?p:-p)}return u}p=0===sZe[0]||1===sZe[0]?.5:1;return iYe(e,a,r,sZe[0])<o?0:i<t?p:-p}function hZe(e,t,a,n,r,i,o,s){if((s-=t)>a||s<-a)return 0;var l=Math.sqrt(a*a-s*s);sZe[0]=-l,sZe[1]=l;var c=Math.abs(n-r);if(c<1e-4)return 0;if(c>=oZe-1e-4){n=0,r=oZe;var u=i?1:-1;return o>=sZe[0]+e&&o<=sZe[1]+e?u:0}if(n>r){var d=n;n=r,r=d}n<0&&(n+=oZe,r+=oZe);for(var h=0,p=0;p<2;p++){var f=sZe[p];if(f+e>o){var m=Math.atan2(s,f);u=i?1:-1;m<0&&(m=oZe+m),(m>=n&&m<=r||m+oZe>=n&&m+oZe<=r)&&(m>Math.PI/2&&m<1.5*Math.PI&&(u=-u),h+=u)}}return h}function pZe(e,t,a,n,r){for(var i,o,s,l,c=e.data,u=e.len(),d=0,h=0,p=0,f=0,m=0,v=0;v<u;){var g=c[v++],y=1===v;switch(g===iZe.M&&v>1&&(a||(d+=rZe(h,p,f,m,n,r))),y&&(f=h=c[v],m=p=c[v+1]),g){case iZe.M:h=f=c[v++],p=m=c[v++];break;case iZe.L:if(a){if(ZKe(h,p,c[v],c[v+1],t,n,r))return!0}else d+=rZe(h,p,c[v],c[v+1],n,r)||0;h=c[v++],p=c[v++];break;case iZe.C:if(a){if(JKe(h,p,c[v++],c[v++],c[v++],c[v++],c[v],c[v+1],t,n,r))return!0}else d+=uZe(h,p,c[v++],c[v++],c[v++],c[v++],c[v],c[v+1],n,r)||0;h=c[v++],p=c[v++];break;case iZe.Q:if(a){if(QKe(h,p,c[v++],c[v++],c[v],c[v+1],t,n,r))return!0}else d+=dZe(h,p,c[v++],c[v++],c[v],c[v+1],n,r)||0;h=c[v++],p=c[v++];break;case iZe.A:var b=c[v++],x=c[v++],w=c[v++],_=c[v++],S=c[v++],M=c[v++];v+=1;var T=!!(1-c[v++]);i=Math.cos(S)*w+b,o=Math.sin(S)*_+x,y?(f=i,m=o):d+=rZe(h,p,i,o,n,r);var k=(n-b)*_/w+b;if(a){if(nZe(b,x,_,S,S+M,T,t,k,r))return!0}else d+=hZe(b,x,_,S,S+M,T,k,r);h=Math.cos(S+M)*w+b,p=Math.sin(S+M)*_+x;break;case iZe.R:if(f=h=c[v++],m=p=c[v++],i=f+c[v++],o=m+c[v++],a){if(ZKe(f,m,i,m,t,n,r)||ZKe(i,m,i,o,t,n,r)||ZKe(i,o,f,o,t,n,r)||ZKe(f,o,f,m,t,n,r))return!0}else d+=rZe(i,m,i,o,n,r),d+=rZe(f,o,f,m,n,r);break;case iZe.Z:if(a){if(ZKe(h,p,f,m,t,n,r))return!0}else d+=rZe(h,p,f,m,n,r);h=f,p=m}}return a||(s=p,l=m,Math.abs(s-l)<1e-4)||(d+=rZe(h,p,f,m,n,r)||0),0!==d}var fZe=pGe({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},uKe),mZe={style:pGe({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},dKe.style)},vZe=$je.concat(["invisible","culling","z","z2","zlevel","parent"]),gZe=function(e){function t(t){return e.call(this,t)||this}var a;return zHe(t,e),t.prototype.update=function(){var a=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var r=this._decalEl=this._decalEl||new t;r.buildPath===t.prototype.buildPath&&(r.buildPath=function(e){a.buildPath(e,a.shape)}),r.silent=!0;var i=r.style;for(var o in n)i[o]!==n[o]&&(i[o]=n[o]);i.fill=n.fill?n.decal:null,i.decal=null,i.shadowColor=null,n.strokeFirst&&(i.stroke=null);for(var s=0;s<vZe.length;++s)r[vZe[s]]=this[vZe[s]];r.__dirty|=1}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(t){var a=_Ge(t);this.shape=this.getDefaultShape();var n=this.getDefaultStyle();n&&this.useStyle(n);for(var r=0;r<a.length;r++){var i=a[r],o=t[i];"style"===i?this.style?hGe(this.style,o):this.useStyle(o):"shape"===i?hGe(this.shape,o):e.prototype.attrKV.call(this,i,o)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var e=this.style.fill;if("none"!==e){if(CGe(e)){var t=OYe(e,0);return t>.5?Bje:t>.2?"#eee":Uje}if(e)return Uje}return Bje},t.prototype.getInsideTextStroke=function(e){var t=this.style.fill;if(CGe(t)){var a=this.__zr;if(!(!a||!a.isDarkMode())===OYe(e,0)<.4)return t}},t.prototype.buildPath=function(e,t,a){},t.prototype.pathUpdated=function(){this.__dirty&=-5},t.prototype.getUpdatedPathProxy=function(e){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,e),this.path},t.prototype.createPathProxy=function(){this.path=new KKe(!1)},t.prototype.hasStroke=function(){var e=this.style,t=e.stroke;return!(null==t||"none"===t||!(e.lineWidth>0))},t.prototype.hasFill=function(){var e=this.style.fill;return null!=e&&"none"!==e},t.prototype.getBoundingRect=function(){var e=this._rect,t=this.style,a=!e;if(a){var n=!1;this.path||(n=!0,this.createPathProxy());var r=this.path;(n||4&this.__dirty)&&(r.beginPath(),this.buildPath(r,this.shape,!1),this.pathUpdated()),e=r.getBoundingRect()}if(this._rect=e,this.hasStroke()&&this.path&&this.path.len()>0){var i=this._rectStroke||(this._rectStroke=e.clone());if(this.__dirty||a){i.copy(e);var o=t.strokeNoScale?this.getLineScale():1,s=t.lineWidth;if(!this.hasFill()){var l=this.strokeContainThreshold;s=Math.max(s,null==l?4:l)}o>1e-10&&(i.width+=s/o,i.height+=s/o,i.x-=s/o/2,i.y-=s/o/2)}return i}return e},t.prototype.contain=function(e,t){var a=this.transformCoordToLocal(e,t),n=this.getBoundingRect(),r=this.style;if(e=a[0],t=a[1],n.contain(e,t)){var i=this.path;if(this.hasStroke()){var o=r.lineWidth,s=r.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(o=Math.max(o,this.strokeContainThreshold)),function(e,t,a,n){return pZe(e,t,!0,a,n)}(i,o/s,e,t)))return!0}if(this.hasFill())return function(e,t,a){return pZe(e,0,!1,t,a)}(i,e,t)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(e){return this.animate("shape",e)},t.prototype.updateDuringAnimation=function(e){"style"===e?this.dirtyStyle():"shape"===e?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(t,a){"shape"===t?this.setShape(a):e.prototype.attrKV.call(this,t,a)},t.prototype.setShape=function(e,t){var a=this.shape;return a||(a=this.shape={}),"string"==typeof e?a[e]=t:hGe(a,e),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(4&this.__dirty)},t.prototype.createStyle=function(e){return ZGe(fZe,e)},t.prototype._innerSaveToNormal=function(t){e.prototype._innerSaveToNormal.call(this,t);var a=this._normalState;t.shape&&!a.shape&&(a.shape=hGe({},this.shape))},t.prototype._applyStateObj=function(t,a,n,r,i,o){e.prototype._applyStateObj.call(this,t,a,n,r,i,o);var s,l=!(a&&r);if(a&&a.shape?i?r?s=a.shape:(s=hGe({},n.shape),hGe(s,a.shape)):(s=hGe({},r?this.shape:n.shape),hGe(s,a.shape)):l&&(s=n.shape),s)if(i){this.shape=hGe({},this.shape);for(var c={},u=_Ge(s),d=0;d<u.length;d++){var h=u[d];"object"==typeof s[h]?this.shape[h]=s[h]:c[h]=s[h]}this._transitionState(t,{shape:c},o)}else this.shape=s,this.dirtyShape()},t.prototype._mergeStates=function(t){for(var a,n=e.prototype._mergeStates.call(this,t),r=0;r<t.length;r++){var i=t[r];i.shape&&(a=a||{},this._mergeStyle(a,i.shape))}return a&&(n.shape=a),n},t.prototype.getAnimationStyleProps=function(){return mZe},t.prototype.isZeroArea=function(){return!1},t.extend=function(e){var a=function(t){function a(a){var n=t.call(this,a)||this;return e.init&&e.init.call(n,a),n}return zHe(a,t),a.prototype.getDefaultStyle=function(){return cGe(e.style)},a.prototype.getDefaultShape=function(){return cGe(e.shape)},a}(t);for(var n in e)"function"==typeof e[n]&&(a.prototype[n]=e[n]);return a},t.initDefaultProps=((a=t.prototype).type="path",a.strokeContainThreshold=5,a.segmentIgnoreThreshold=0,a.subPixelOptimize=!1,a.autoBatch=!1,void(a.__dirty=7)),t}(fKe),yZe=pGe({strokeFirst:!0,font:WHe,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},fZe),bZe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.hasStroke=function(){return lKe(this.style)},t.prototype.hasFill=function(){var e=this.style.fill;return null!=e&&"none"!==e},t.prototype.createStyle=function(e){return ZGe(yZe,e)},t.prototype.setBoundingRect=function(e){this._rect=e},t.prototype.getBoundingRect=function(){return this._rect||(this._rect=function(e){var t=oKe(e.text),a=e.font;return sKe(e,tXe(Zje(a),t),oXe(a),null)}(this.style)),this._rect},t.initDefaultProps=void(t.prototype.dirtyRectTolerance=10),t}(fKe);bZe.prototype.type="tspan";var xZe=pGe({x:0,y:0},uKe),wZe={style:pGe({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},dKe.style)};var _Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.createStyle=function(e){return ZGe(xZe,e)},t.prototype._getSize=function(e){var t=this.style,a=t[e];if(null!=a)return a;var n,r=(n=t.image)&&"string"!=typeof n&&n.width&&n.height?t.image:this.__image;if(!r)return 0;var i="width"===e?"height":"width",o=t[i];return null==o?r[e]:r[e]/r[i]*o},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return wZe},t.prototype.getBoundingRect=function(){var e=this.style;return this._rect||(this._rect=new fqe(e.x||0,e.y||0,this.getWidth(),this.getHeight())),this._rect},t}(fKe);_Ze.prototype.type="image";var SZe=Math.round;function MZe(e,t,a){if(t){var n=t.x1,r=t.x2,i=t.y1,o=t.y2;e.x1=n,e.x2=r,e.y1=i,e.y2=o;var s=a&&a.lineWidth;return s?(SZe(2*n)===SZe(2*r)&&(e.x1=e.x2=kZe(n,s,!0)),SZe(2*i)===SZe(2*o)&&(e.y1=e.y2=kZe(i,s,!0)),e):e}}function TZe(e,t,a){if(t){var n=t.x,r=t.y,i=t.width,o=t.height;e.x=n,e.y=r,e.width=i,e.height=o;var s=a&&a.lineWidth;return s?(e.x=kZe(n,s,!0),e.y=kZe(r,s,!0),e.width=Math.max(kZe(n+i,s,!1)-e.x,0===i?0:1),e.height=Math.max(kZe(r+o,s,!1)-e.y,0===o?0:1),e):e}}function kZe(e,t,a){if(!t)return e;var n=SZe(2*e);return(n+SZe(t))%2==0?n/2:(n+(a?1:-1))/2}var CZe=function(){this.x=0,this.y=0,this.width=0,this.height=0},AZe={},EZe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new CZe},t.prototype.buildPath=function(e,t){var a,n,r,i;if(this.subPixelOptimize){var o=TZe(AZe,t,this.style);a=o.x,n=o.y,r=o.width,i=o.height,o.r=t.r,t=o}else a=t.x,n=t.y,r=t.width,i=t.height;t.r?function(e,t){var a,n,r,i,o,s=t.x,l=t.y,c=t.width,u=t.height,d=t.r;c<0&&(s+=c,c=-c),u<0&&(l+=u,u=-u),"number"==typeof d?a=n=r=i=d:d instanceof Array?1===d.length?a=n=r=i=d[0]:2===d.length?(a=r=d[0],n=i=d[1]):3===d.length?(a=d[0],n=i=d[1],r=d[2]):(a=d[0],n=d[1],r=d[2],i=d[3]):a=n=r=i=0,a+n>c&&(a*=c/(o=a+n),n*=c/o),r+i>c&&(r*=c/(o=r+i),i*=c/o),n+r>u&&(n*=u/(o=n+r),r*=u/o),a+i>u&&(a*=u/(o=a+i),i*=u/o),e.moveTo(s+a,l),e.lineTo(s+c-n,l),0!==n&&e.arc(s+c-n,l+n,n,-Math.PI/2,0),e.lineTo(s+c,l+u-r),0!==r&&e.arc(s+c-r,l+u-r,r,0,Math.PI/2),e.lineTo(s+i,l+u),0!==i&&e.arc(s+i,l+u-i,i,Math.PI/2,Math.PI),e.lineTo(s,l+a),0!==a&&e.arc(s+a,l+a,a,Math.PI,1.5*Math.PI)}(e,t):e.rect(a,n,r,i)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(gZe);EZe.prototype.type="rect";var IZe={fill:"#000"},RZe={},DZe={style:pGe({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},dKe.style)},PZe=function(e){function t(t){var a=e.call(this)||this;return a.type="text",a._children=[],a._defaultStyle=IZe,a.attr(t),a}return zHe(t,e),t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var a=this._children[t];a.zlevel=this.zlevel,a.z=this.z,a.z2=this.z2,a.culling=this.culling,a.cursor=this.cursor,a.invisible=this.invisible}},t.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(t){var a=this.innerTransformable;return a?a.getLocalTransform(t):e.prototype.getLocalTransform.call(this,t)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){var e;this._childCursor=0,zZe(e=this.style),gGe(e.rich,zZe),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(t){e.prototype.addSelfToZr.call(this,t);for(var a=0;a<this._children.length;a++)this._children[a].__zr=t},t.prototype.removeSelfFromZr=function(t){e.prototype.removeSelfFromZr.call(this,t);for(var a=0;a<this._children.length;a++)this._children[a].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var e=new fqe(0,0,0,0),t=this._children,a=[],n=null,r=0;r<t.length;r++){var i=t[r],o=i.getBoundingRect(),s=i.getLocalTransform(a);s?(e.copy(o),e.applyTransform(s),(n=n||e.clone()).union(e)):(n=n||o.clone()).union(o)}this._rect=n||e}return this._rect},t.prototype.setDefaultTextStyle=function(e){this._defaultStyle=e||IZe},t.prototype.setTextContent=function(e){},t.prototype._mergeStyle=function(e,t){if(!t)return e;var a=t.rich,n=e.rich||a&&{};return hGe(e,t),a&&n?(this._mergeRich(n,a),e.rich=n):n&&(e.rich=n),e},t.prototype._mergeRich=function(e,t){for(var a=_Ge(t),n=0;n<a.length;n++){var r=a[n];e[r]=e[r]||{},hGe(e[r],t[r])}},t.prototype.getAnimationStyleProps=function(){return DZe},t.prototype._getOrCreateChild=function(e){var t=this._children[this._childCursor];return t&&t instanceof e||(t=new e),this._children[this._childCursor++]=t,t.__zr=this.__zr,t.parent=this,t},t.prototype._updatePlainTexts=function(){var e=this.style,t=e.font||WHe,a=e.padding,n=this._defaultStyle,r=e.x||0,i=e.y||0,o=e.align||n.align||"left",s=e.verticalAlign||n.verticalAlign||"top";nKe(RZe,n.overflowRect,r,i,o,s),r=RZe.baseX,i=RZe.baseY;var l=function(e,t,a,n){var r=oKe(e),i=t.overflow,o=t.padding,s=o?o[1]+o[3]:0,l=o?o[0]+o[2]:0,c=t.font,u="truncate"===i,d=oXe(c),h=FGe(t.lineHeight,d),p="truncate"===t.lineOverflow,f=!1,m=t.width;null==m&&null!=a&&(m=a-s);var v,g=t.height;null==g&&null!=n&&(g=n-l);var y=(v=null==m||"break"!==i&&"breakAll"!==i?r?r.split("\n"):[]:r?aKe(r,t.font,m,"breakAll"===i,0).lines:[]).length*h;if(null==g&&(g=y),y>g&&p){var b=Math.floor(g/h);f=f||v.length>b,y=(v=v.slice(0,b)).length*h}if(r&&u&&null!=m)for(var x=j$e(m,c,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),w={},_=0;_<v.length;_++)X$e(w,v[_],x),v[_]=w.textLine,f=f||w.isTruncated;var S=g,M=0,T=Zje(c);for(_=0;_<v.length;_++)M=Math.max(tXe(T,v[_]),M);null==m&&(m=M);var k=m;return{lines:v,height:g,outerWidth:k+=s,outerHeight:S+=l,lineHeight:h,calculatedLineHeight:d,contentWidth:M,contentHeight:y,width:m,isTruncated:f}}(WZe(e),e,RZe.outerWidth,RZe.outerHeight),c=qZe(e),u=!!e.backgroundColor,d=l.outerHeight,h=l.outerWidth,p=l.lines,f=l.lineHeight;this.isTruncated=!!l.isTruncated;var m=r,v=iXe(i,l.contentHeight,s);if(c||a){var g=rXe(r,h,o),y=iXe(i,d,s);c&&this._renderBackground(e,e,g,y,h,d)}v+=f/2,a&&(m=GZe(r,o,a),"top"===s?v+=a[0]:"bottom"===s&&(v-=a[2]));for(var b=0,x=!1,w=!1,_=(HZe("fill"in e?e.fill:(w=!0,n.fill))),S=(VZe("stroke"in e?e.stroke:u||n.autoStroke&&!w?null:(b=2,x=!0,n.stroke))),M=e.textShadowBlur>0,T=0;T<p.length;T++){var k=this._getOrCreateChild(bZe),C=k.createStyle();k.useStyle(C),C.text=p[T],C.x=m,C.y=v,C.textAlign=o,C.textBaseline="middle",C.opacity=e.opacity,C.strokeFirst=!0,M&&(C.shadowBlur=e.textShadowBlur||0,C.shadowColor=e.textShadowColor||"transparent",C.shadowOffsetX=e.textShadowOffsetX||0,C.shadowOffsetY=e.textShadowOffsetY||0),C.stroke=S,C.fill=_,S&&(C.lineWidth=e.lineWidth||b,C.lineDash=e.lineDash,C.lineDashOffset=e.lineDashOffset||0),C.font=t,BZe(C,e),v+=f,k.setBoundingRect(sKe(C,l.contentWidth,l.calculatedLineHeight,x?0:null))}},t.prototype._updateRichTexts=function(){var e=this.style,t=this._defaultStyle,a=e.align||t.align,n=e.verticalAlign||t.verticalAlign,r=e.x||0,i=e.y||0;nKe(RZe,t.overflowRect,r,i,a,n),r=RZe.baseX,i=RZe.baseY;var o=function(e,t,a,n,r){var i=new J$e,o=oKe(e);if(!o)return i;var s=t.padding,l=s?s[1]+s[3]:0,c=s?s[0]+s[2]:0,u=t.width;null==u&&null!=a&&(u=a-l);var d=t.height;null==d&&null!=n&&(d=n-c);for(var h,p=t.overflow,f="break"!==p&&"breakAll"!==p||null==u?null:{width:u,accumWidth:0,breakAll:"breakAll"===p},m=q$e.lastIndex=0;null!=(h=q$e.exec(o));){var v=h.index;v>m&&Q$e(i,o.substring(m,v),t,f),Q$e(i,h[2],t,f,h[1]),m=q$e.lastIndex}m<o.length&&Q$e(i,o.substring(m,o.length),t,f);var g=[],y=0,b=0,x="truncate"===p,w="truncate"===t.lineOverflow,_={};function S(e,t,a){e.width=t,e.lineHeight=a,y+=a,b=Math.max(b,t)}e:for(var M=0;M<i.lines.length;M++){for(var T=i.lines[M],k=0,C=0,A=0;A<T.tokens.length;A++){var E=(z=T.tokens[A]).styleName&&t.rich[z.styleName]||{},I=z.textPadding=E.padding,R=I?I[1]+I[3]:0,D=z.font=E.font||t.font;z.contentHeight=oXe(D);var P=FGe(E.height,z.contentHeight);if(z.innerHeight=P,I&&(P+=I[0]+I[2]),z.height=P,z.lineHeight=BGe(E.lineHeight,t.lineHeight,P),z.align=E&&E.align||r,z.verticalAlign=E&&E.verticalAlign||"middle",w&&null!=d&&y+z.lineHeight>d){var L=i.lines.length;A>0?(T.tokens=T.tokens.slice(0,A),S(T,C,k),i.lines=i.lines.slice(0,M+1)):i.lines=i.lines.slice(0,M),i.isTruncated=i.isTruncated||i.lines.length<L;break e}var N=E.width,O=null==N||"auto"===N;if("string"==typeof N&&"%"===N.charAt(N.length-1))z.percentWidth=N,g.push(z),z.contentWidth=tXe(Zje(D),z.text);else{if(O){var F=E.backgroundColor,B=F&&F.image;B&&W$e(B=V$e(B))&&(z.width=Math.max(z.width,B.width*P/B.height))}var U=x&&null!=u?u-C:null;null!=U&&U<z.width?!O||U<R?(z.text="",z.width=z.contentWidth=0):(Y$e(_,z.text,U-R,D,t.ellipsis,{minChar:t.truncateMinChar}),z.text=_.text,i.isTruncated=i.isTruncated||_.isTruncated,z.width=z.contentWidth=tXe(Zje(D),z.text)):z.contentWidth=tXe(Zje(D),z.text)}z.width+=R,C+=z.width,E&&(k=Math.max(k,z.lineHeight))}S(T,C,k)}for(i.outerWidth=i.width=FGe(u,b),i.outerHeight=i.height=FGe(d,y),i.contentHeight=y,i.contentWidth=b,i.outerWidth+=l,i.outerHeight+=c,M=0;M<g.length;M++){var z,V=(z=g[M]).percentWidth;z.width=parseInt(V,10)/100*i.width}return i}(WZe(e),e,RZe.outerWidth,RZe.outerHeight,a),s=o.width,l=o.outerWidth,c=o.outerHeight,u=e.padding;this.isTruncated=!!o.isTruncated;var d=rXe(r,l,a),h=iXe(i,c,n),p=d,f=h;u&&(p+=u[3],f+=u[0]);var m=p+s;qZe(e)&&this._renderBackground(e,e,d,h,l,c);for(var v=!!e.backgroundColor,g=0;g<o.lines.length;g++){for(var y=o.lines[g],b=y.tokens,x=b.length,w=y.lineHeight,_=y.width,S=0,M=p,T=m,k=x-1,C=void 0;S<x&&(!(C=b[S]).align||"left"===C.align);)this._placeToken(C,e,w,f,M,"left",v),_-=C.width,M+=C.width,S++;for(;k>=0&&"right"===(C=b[k]).align;)this._placeToken(C,e,w,f,T,"right",v),_-=C.width,T-=C.width,k--;for(M+=(s-(M-p)-(m-T)-_)/2;S<=k;)C=b[S],this._placeToken(C,e,w,f,M+C.width/2,"center",v),M+=C.width,S++;f+=w}},t.prototype._placeToken=function(e,t,a,n,r,i,o){var s=t.rich[e.styleName]||{};s.text=e.text;var l=e.verticalAlign,c=n+a/2;"top"===l?c=n+e.height/2:"bottom"===l&&(c=n+a-e.height/2),!e.isLineHolder&&qZe(s)&&this._renderBackground(s,t,"right"===i?r-e.width:"center"===i?r-e.width/2:r,c-e.height/2,e.width,e.height);var u=!!s.backgroundColor,d=e.textPadding;d&&(r=GZe(r,i,d),c-=e.height/2-d[0]-e.innerHeight/2);var h=this._getOrCreateChild(bZe),p=h.createStyle();h.useStyle(p);var f=this._defaultStyle,m=!1,v=0,g=!1,y=HZe("fill"in s?s.fill:"fill"in t?t.fill:(m=!0,f.fill)),b=VZe("stroke"in s?s.stroke:"stroke"in t?t.stroke:u||o||f.autoStroke&&!m?null:(v=2,g=!0,f.stroke)),x=s.textShadowBlur>0||t.textShadowBlur>0;p.text=e.text,p.x=r,p.y=c,x&&(p.shadowBlur=s.textShadowBlur||t.textShadowBlur||0,p.shadowColor=s.textShadowColor||t.textShadowColor||"transparent",p.shadowOffsetX=s.textShadowOffsetX||t.textShadowOffsetX||0,p.shadowOffsetY=s.textShadowOffsetY||t.textShadowOffsetY||0),p.textAlign=i,p.textBaseline="middle",p.font=e.font||WHe,p.opacity=BGe(s.opacity,t.opacity,1),BZe(p,s),b&&(p.lineWidth=BGe(s.lineWidth,t.lineWidth,v),p.lineDash=FGe(s.lineDash,t.lineDash),p.lineDashOffset=t.lineDashOffset||0,p.stroke=b),y&&(p.fill=y),h.setBoundingRect(sKe(p,e.contentWidth,e.contentHeight,g?0:null))},t.prototype._renderBackground=function(e,t,a,n,r,i){var o,s,l,c=e.backgroundColor,u=e.borderWidth,d=e.borderColor,h=c&&c.image,p=c&&!h,f=e.borderRadius,m=this;if(p||e.lineHeight||u&&d){(o=this._getOrCreateChild(EZe)).useStyle(o.createStyle()),o.style.fill=null;var v=o.shape;v.x=a,v.y=n,v.width=r,v.height=i,v.r=f,o.dirtyShape()}if(p)(l=o.style).fill=c||null,l.fillOpacity=FGe(e.fillOpacity,1);else if(h){(s=this._getOrCreateChild(_Ze)).onload=function(){m.dirtyStyle()};var g=s.style;g.image=c.image,g.x=a,g.y=n,g.width=r,g.height=i}u&&d&&((l=o.style).lineWidth=u,l.stroke=d,l.strokeOpacity=FGe(e.strokeOpacity,1),l.lineDash=e.borderDash,l.lineDashOffset=e.borderDashOffset||0,o.strokeContainThreshold=0,o.hasFill()&&o.hasStroke()&&(l.strokeFirst=!0,l.lineWidth*=2));var y=(o||s).style;y.shadowBlur=e.shadowBlur||0,y.shadowColor=e.shadowColor||"transparent",y.shadowOffsetX=e.shadowOffsetX||0,y.shadowOffsetY=e.shadowOffsetY||0,y.opacity=BGe(e.opacity,t.opacity,1)},t.makeFont=function(e){var t="";return UZe(e)&&(t=[e.fontStyle,e.fontWeight,FZe(e.fontSize),e.fontFamily||"sans-serif"].join(" ")),t&&HGe(t)||e.textFont||e.font},t}(fKe),LZe={left:!0,right:1,center:1},NZe={top:1,bottom:1,middle:1},OZe=["fontStyle","fontWeight","fontSize","fontFamily"];function FZe(e){return"string"!=typeof e||-1===e.indexOf("px")&&-1===e.indexOf("rem")&&-1===e.indexOf("em")?isNaN(+e)?"12px":e+"px":e}function BZe(e,t){for(var a=0;a<OZe.length;a++){var n=OZe[a],r=t[n];null!=r&&(e[n]=r)}}function UZe(e){return null!=e.fontSize||e.fontFamily||e.fontWeight}function zZe(e){if(e){e.font=PZe.makeFont(e);var t=e.align;"middle"===t&&(t="center"),e.align=null==t||LZe[t]?t:"left";var a=e.verticalAlign;"center"===a&&(a="middle"),e.verticalAlign=null==a||NZe[a]?a:"top",e.padding&&(e.padding=zGe(e.padding))}}function VZe(e,t){return null==e||t<=0||"transparent"===e||"none"===e?null:e.image||e.colorStops?"#000":e}function HZe(e){return null==e||"none"===e?null:e.image||e.colorStops?"#000":e}function GZe(e,t,a){return"right"===t?e-a[1]:"center"===t?e+a[3]/2-a[1]/2:e+a[3]}function WZe(e){var t=e.text;return null!=t&&(t+=""),t}function qZe(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}var YZe=v$e(),jZe=function(e,t,a,n){if(n){var r=YZe(n);r.dataIndex=a,r.dataType=t,r.seriesIndex=e,r.ssrType="chart","group"===n.type&&n.traverse(function(n){var r=YZe(n);r.seriesIndex=e,r.dataIndex=a,r.dataType=t,r.ssrType="chart"})}},XZe=1,$Ze={},KZe=v$e(),ZZe=v$e(),JZe=["emphasis","blur","select"],QZe=["normal","emphasis","blur","select"],eJe=10,tJe="highlight",aJe="downplay",nJe="select",rJe="unselect",iJe="toggleSelect",oJe="selectchanged";function sJe(e){return null!=e&&"none"!==e}function lJe(e,t,a){e.onHoverStateChange&&(e.hoverState||0)!==a&&e.onHoverStateChange(t),e.hoverState=a}function cJe(e){lJe(e,"emphasis",2)}function uJe(e){2===e.hoverState&&lJe(e,"normal",0)}function dJe(e){lJe(e,"blur",1)}function hJe(e){1===e.hoverState&&lJe(e,"normal",0)}function pJe(e){e.selected=!0}function fJe(e){e.selected=!1}function mJe(e,t,a){t(e,a)}function vJe(e,t,a){mJe(e,t,a),e.isGroup&&e.traverse(function(e){mJe(e,t,a)})}function gJe(e,t){switch(t){case"emphasis":e.hoverState=2;break;case"normal":e.hoverState=0;break;case"blur":e.hoverState=1;break;case"select":e.selected=!0}}function yJe(e,t){var a=this.states[e];if(this.style){if("emphasis"===e)return function(e,t,a,n){var r=a&&fGe(a,"select")>=0,i=!1;if(e instanceof gZe){var o=KZe(e),s=r&&o.selectFill||o.normalFill,l=r&&o.selectStroke||o.normalStroke;if(sJe(s)||sJe(l)){var c=(n=n||{}).style||{};"inherit"===c.fill?(i=!0,n=hGe({},n),(c=hGe({},c)).fill=s):!sJe(c.fill)&&sJe(s)?(i=!0,n=hGe({},n),(c=hGe({},c)).fill=BYe(s)):!sJe(c.stroke)&&sJe(l)&&(i||(n=hGe({},n),c=hGe({},c)),c.stroke=BYe(l)),n.style=c}}if(n&&null==n.z2){i||(n=hGe({},n));var u=e.z2EmphasisLift;n.z2=e.z2+(null!=u?u:eJe)}return n}(this,0,t,a);if("blur"===e)return function(e,t,a){var n=fGe(e.currentStates,t)>=0,r=e.style.opacity,i=n?null:function(e,t,a,n){for(var r=e.style,i={},o=0;o<t.length;o++){var s=t[o],l=r[s];i[s]=null==l?n&&n[s]:l}for(o=0;o<e.animators.length;o++){var c=e.animators[o];c.__fromStateTransition&&c.__fromStateTransition.indexOf(a)<0&&"style"===c.targetName&&c.saveTo(i,t)}return i}(e,["opacity"],t,{opacity:1}),o=(a=a||{}).style||{};return null==o.opacity&&(a=hGe({},a),o=hGe({opacity:n?r:.1*i.opacity},o),a.style=o),a}(this,e,a);if("select"===e)return function(e,t,a){if(a&&null==a.z2){a=hGe({},a);var n=e.z2SelectLift;a.z2=e.z2+(null!=n?n:9)}return a}(this,0,a)}return a}function bJe(e){e.stateProxy=yJe;var t=e.getTextContent(),a=e.getTextGuideLine();t&&(t.stateProxy=yJe),a&&(a.stateProxy=yJe)}function xJe(e,t){!AJe(e,t)&&!e.__highByOuter&&vJe(e,cJe)}function wJe(e,t){!AJe(e,t)&&!e.__highByOuter&&vJe(e,uJe)}function _Je(e,t){e.__highByOuter|=1<<(t||0),vJe(e,cJe)}function SJe(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&vJe(e,uJe)}function MJe(e){vJe(e,dJe)}function TJe(e){vJe(e,hJe)}function kJe(e){vJe(e,pJe)}function CJe(e){vJe(e,fJe)}function AJe(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function EJe(e){var t=e.getModel(),a=[],n=[];t.eachComponent(function(t,r){var i=ZZe(r),o="series"===t,s=o?e.getViewOfSeriesModel(r):e.getViewOfComponentModel(r);!o&&n.push(s),i.isBlured&&(s.group.traverse(function(e){hJe(e)}),o&&a.push(r)),i.isBlured=!1}),gGe(n,function(e){e&&e.toggleBlurSeries&&e.toggleBlurSeries(a,!1,t)})}function IJe(e,t,a,n){var r=n.getModel();function i(e,t){for(var a=0;a<t.length;a++){var n=e.getItemGraphicEl(t[a]);n&&TJe(n)}}if(a=a||"coordinateSystem",null!=e&&t&&"none"!==t){var o=r.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var l=[];r.eachSeries(function(e){var r=o===e,c=e.coordinateSystem;if(c&&c.master&&(c=c.master),!("series"===a&&!r||"coordinateSystem"===a&&!(c&&s?c===s:r)||"series"===t&&r)){if(n.getViewOfSeriesModel(e).group.traverse(function(e){e.__highByOuter&&r&&"self"===t||dJe(e)}),vGe(t))i(e.getData(),t);else if(IGe(t))for(var u=_Ge(t),d=0;d<u.length;d++)i(e.getData(u[d]),t[u[d]]);l.push(e),ZZe(e).isBlured=!0}}),r.eachComponent(function(e,t){if("series"!==e){var a=n.getViewOfComponentModel(t);a&&a.toggleBlurSeries&&a.toggleBlurSeries(l,!0,r)}})}}function RJe(e,t,a){if(null!=e&&null!=t){var n=a.getModel().getComponent(e,t);if(n){ZZe(n).isBlured=!0;var r=a.getViewOfComponentModel(n);r&&r.focusBlurEnabled&&r.group.traverse(function(e){dJe(e)})}}}function DJe(e,t,a,n){var r={focusSelf:!1,dispatchers:null};if(null==e||"series"===e||null==t||null==a)return r;var i=n.getModel().getComponent(e,t);if(!i)return r;var o=n.getViewOfComponentModel(i);if(!o||!o.findHighDownDispatchers)return r;for(var s,l=o.findHighDownDispatchers(a),c=0;c<l.length;c++)if("self"===YZe(l[c]).focus){s=!0;break}return{focusSelf:s,dispatchers:l}}function PJe(e){gGe(e.getAllData(),function(t){var a=t.data,n=t.type;a.eachItemGraphicEl(function(t,a){e.isSelected(a,n)?kJe(t):CJe(t)})})}function LJe(e){var t=[];return e.eachSeries(function(e){gGe(e.getAllData(),function(a){a.data;var n=a.type,r=e.getSelectedDataIndices();if(r.length>0){var i={dataIndex:r,seriesIndex:e.seriesIndex};null!=n&&(i.dataType=n),t.push(i)}})}),t}function NJe(e,t,a){VJe(e,!0),vJe(e,bJe),FJe(e,t,a)}function OJe(e,t,a,n){n?function(e){VJe(e,!1)}(e):NJe(e,t,a)}function FJe(e,t,a){var n=YZe(e);null!=t?(n.focus=t,n.blurScope=a):n.focus&&(n.focus=null)}var BJe=["emphasis","blur","select"],UJe={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function zJe(e,t,a,n){a=a||"itemStyle";for(var r=0;r<BJe.length;r++){var i=BJe[r],o=t.getModel([i,a]);e.ensureState(i).style=n?n(o):o[UJe[a]]()}}function VJe(e,t){var a=!1===t,n=e;e.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=e.highDownSilentOnTouch),a&&!n.__highDownDispatcher||(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!a)}function HJe(e){return!(!e||!e.__highDownDispatcher)}function GJe(e){var t=e.type;return t===nJe||t===rJe||t===iJe}function WJe(e){var t=e.type;return t===tJe||t===aJe}var qJe=KKe.CMD,YJe=[[],[],[]],jJe=Math.sqrt,XJe=Math.atan2;function $Je(e,t){if(t){var a,n,r,i,o,s,l=e.data,c=e.len(),u=qJe.M,d=qJe.C,h=qJe.L,p=qJe.R,f=qJe.A,m=qJe.Q;for(r=0,i=0;r<c;){switch(a=l[r++],i=r,n=0,a){case u:case h:n=1;break;case d:n=3;break;case m:n=2;break;case f:var v=t[4],g=t[5],y=jJe(t[0]*t[0]+t[1]*t[1]),b=jJe(t[2]*t[2]+t[3]*t[3]),x=XJe(-t[1]/b,t[0]/y);l[r]*=y,l[r++]+=v,l[r]*=b,l[r++]+=g,l[r++]*=y,l[r++]*=b,l[r++]+=x,l[r++]+=x,i=r+=2;break;case p:s[0]=l[r++],s[1]=l[r++],vWe(s,s,t),l[i++]=s[0],l[i++]=s[1],s[0]+=l[r++],s[1]+=l[r++],vWe(s,s,t),l[i++]=s[0],l[i++]=s[1]}for(o=0;o<n;o++){var w=YJe[o];w[0]=l[r++],w[1]=l[r++],vWe(w,w,t),l[i++]=w[0],l[i++]=w[1]}}e.increaseVersion()}}var KJe=Math.sqrt,ZJe=Math.sin,JJe=Math.cos,QJe=Math.PI;function eQe(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function tQe(e,t){return(e[0]*t[0]+e[1]*t[1])/(eQe(e)*eQe(t))}function aQe(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(tQe(e,t))}function nQe(e,t,a,n,r,i,o,s,l,c,u){var d=l*(QJe/180),h=JJe(d)*(e-a)/2+ZJe(d)*(t-n)/2,p=-1*ZJe(d)*(e-a)/2+JJe(d)*(t-n)/2,f=h*h/(o*o)+p*p/(s*s);f>1&&(o*=KJe(f),s*=KJe(f));var m=(r===i?-1:1)*KJe((o*o*(s*s)-o*o*(p*p)-s*s*(h*h))/(o*o*(p*p)+s*s*(h*h)))||0,v=m*o*p/s,g=m*-s*h/o,y=(e+a)/2+JJe(d)*v-ZJe(d)*g,b=(t+n)/2+ZJe(d)*v+JJe(d)*g,x=aQe([1,0],[(h-v)/o,(p-g)/s]),w=[(h-v)/o,(p-g)/s],_=[(-1*h-v)/o,(-1*p-g)/s],S=aQe(w,_);if(tQe(w,_)<=-1&&(S=QJe),tQe(w,_)>=1&&(S=0),S<0){var M=Math.round(S/QJe*1e6)/1e6;S=2*QJe+M%2*QJe}u.addData(c,y,b,o,s,x,S,d,i)}var rQe=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,iQe=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var oQe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.applyTransform=function(e){},t}(gZe);function sQe(e){return null!=e.setData}function lQe(e,t){var a=function(e){var t=new KKe;if(!e)return t;var a,n=0,r=0,i=n,o=r,s=KKe.CMD,l=e.match(rQe);if(!l)return t;for(var c=0;c<l.length;c++){for(var u=l[c],d=u.charAt(0),h=void 0,p=u.match(iQe)||[],f=p.length,m=0;m<f;m++)p[m]=parseFloat(p[m]);for(var v=0;v<f;){var g=void 0,y=void 0,b=void 0,x=void 0,w=void 0,_=void 0,S=void 0,M=n,T=r,k=void 0,C=void 0;switch(d){case"l":n+=p[v++],r+=p[v++],h=s.L,t.addData(h,n,r);break;case"L":n=p[v++],r=p[v++],h=s.L,t.addData(h,n,r);break;case"m":n+=p[v++],r+=p[v++],h=s.M,t.addData(h,n,r),i=n,o=r,d="l";break;case"M":n=p[v++],r=p[v++],h=s.M,t.addData(h,n,r),i=n,o=r,d="L";break;case"h":n+=p[v++],h=s.L,t.addData(h,n,r);break;case"H":n=p[v++],h=s.L,t.addData(h,n,r);break;case"v":r+=p[v++],h=s.L,t.addData(h,n,r);break;case"V":r=p[v++],h=s.L,t.addData(h,n,r);break;case"C":h=s.C,t.addData(h,p[v++],p[v++],p[v++],p[v++],p[v++],p[v++]),n=p[v-2],r=p[v-1];break;case"c":h=s.C,t.addData(h,p[v++]+n,p[v++]+r,p[v++]+n,p[v++]+r,p[v++]+n,p[v++]+r),n+=p[v-2],r+=p[v-1];break;case"S":g=n,y=r,k=t.len(),C=t.data,a===s.C&&(g+=n-C[k-4],y+=r-C[k-3]),h=s.C,M=p[v++],T=p[v++],n=p[v++],r=p[v++],t.addData(h,g,y,M,T,n,r);break;case"s":g=n,y=r,k=t.len(),C=t.data,a===s.C&&(g+=n-C[k-4],y+=r-C[k-3]),h=s.C,M=n+p[v++],T=r+p[v++],n+=p[v++],r+=p[v++],t.addData(h,g,y,M,T,n,r);break;case"Q":M=p[v++],T=p[v++],n=p[v++],r=p[v++],h=s.Q,t.addData(h,M,T,n,r);break;case"q":M=p[v++]+n,T=p[v++]+r,n+=p[v++],r+=p[v++],h=s.Q,t.addData(h,M,T,n,r);break;case"T":g=n,y=r,k=t.len(),C=t.data,a===s.Q&&(g+=n-C[k-4],y+=r-C[k-3]),n=p[v++],r=p[v++],h=s.Q,t.addData(h,g,y,n,r);break;case"t":g=n,y=r,k=t.len(),C=t.data,a===s.Q&&(g+=n-C[k-4],y+=r-C[k-3]),n+=p[v++],r+=p[v++],h=s.Q,t.addData(h,g,y,n,r);break;case"A":b=p[v++],x=p[v++],w=p[v++],_=p[v++],S=p[v++],nQe(M=n,T=r,n=p[v++],r=p[v++],_,S,b,x,w,h=s.A,t);break;case"a":b=p[v++],x=p[v++],w=p[v++],_=p[v++],S=p[v++],nQe(M=n,T=r,n+=p[v++],r+=p[v++],_,S,b,x,w,h=s.A,t)}}"z"!==d&&"Z"!==d||(h=s.Z,t.addData(h),n=i,r=o),a=h}return t.toStatic(),t}(e),n=hGe({},t);return n.buildPath=function(e){var t,n=sQe(e);n&&e.canSave()?(e.appendPath(a),(t=e.getContext())&&e.rebuildPath(t,1)):(t=n?e.getContext():e)&&a.rebuildPath(t,1)},n.applyTransform=function(e){$Je(a,e),this.dirtyShape()},n}function cQe(e,t){return new oQe(lQe(e,t))}function uQe(e,t){t=t||{};var a=new gZe;return e.shape&&a.setShape(e.shape),a.setStyle(e.style),t.bakeTransform?$Je(a.path,e.getComputedTransform()):t.toLocal?a.setLocalTransform(e.getComputedTransform()):a.copyTransform(e),a.buildPath=e.buildPath,a.applyTransform=a.applyTransform,a.z=e.z,a.z2=e.z2,a.zlevel=e.zlevel,a}var dQe=function(){this.cx=0,this.cy=0,this.r=0},hQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new dQe},t.prototype.buildPath=function(e,t){e.moveTo(t.cx+t.r,t.cy),e.arc(t.cx,t.cy,t.r,0,2*Math.PI)},t}(gZe);hQe.prototype.type="circle";var pQe=function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0},fQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new pQe},t.prototype.buildPath=function(e,t){var a=.5522848,n=t.cx,r=t.cy,i=t.rx,o=t.ry,s=i*a,l=o*a;e.moveTo(n-i,r),e.bezierCurveTo(n-i,r-l,n-s,r-o,n,r-o),e.bezierCurveTo(n+s,r-o,n+i,r-l,n+i,r),e.bezierCurveTo(n+i,r+l,n+s,r+o,n,r+o),e.bezierCurveTo(n-s,r+o,n-i,r+l,n-i,r),e.closePath()},t}(gZe);fQe.prototype.type="ellipse";var mQe=Math.PI,vQe=2*mQe,gQe=Math.sin,yQe=Math.cos,bQe=Math.acos,xQe=Math.atan2,wQe=Math.abs,_Qe=Math.sqrt,SQe=Math.max,MQe=Math.min,TQe=1e-4;function kQe(e,t,a,n,r,i,o){var s=e-a,l=t-n,c=(o?i:-i)/_Qe(s*s+l*l),u=c*l,d=-c*s,h=e+u,p=t+d,f=a+u,m=n+d,v=(h+f)/2,g=(p+m)/2,y=f-h,b=m-p,x=y*y+b*b,w=r-i,_=h*m-f*p,S=(b<0?-1:1)*_Qe(SQe(0,w*w*x-_*_)),M=(_*b-y*S)/x,T=(-_*y-b*S)/x,k=(_*b+y*S)/x,C=(-_*y+b*S)/x,A=M-v,E=T-g,I=k-v,R=C-g;return A*A+E*E>I*I+R*R&&(M=k,T=C),{cx:M,cy:T,x0:-u,y0:-d,x1:M*(r/w-1),y1:T*(r/w-1)}}function CQe(e,t){var a,n=SQe(t.r,0),r=SQe(t.r0||0,0),i=n>0;if(i||r>0){if(i||(n=r,r=0),r>n){var o=n;n=r,r=o}var s=t.startAngle,l=t.endAngle;if(!isNaN(s)&&!isNaN(l)){var c=t.cx,u=t.cy,d=!!t.clockwise,h=wQe(l-s),p=h>vQe&&h%vQe;if(p>TQe&&(h=p),n>TQe)if(h>vQe-TQe)e.moveTo(c+n*yQe(s),u+n*gQe(s)),e.arc(c,u,n,s,l,!d),r>TQe&&(e.moveTo(c+r*yQe(l),u+r*gQe(l)),e.arc(c,u,r,l,s,d));else{var f=void 0,m=void 0,v=void 0,g=void 0,y=void 0,b=void 0,x=void 0,w=void 0,_=void 0,S=void 0,M=void 0,T=void 0,k=void 0,C=void 0,A=void 0,E=void 0,I=n*yQe(s),R=n*gQe(s),D=r*yQe(l),P=r*gQe(l),L=h>TQe;if(L){var N=t.cornerRadius;N&&(a=function(e){var t;if(TGe(e)){var a=e.length;if(!a)return e;t=1===a?[e[0],e[0],0,0]:2===a?[e[0],e[0],e[1],e[1]]:3===a?e.concat(e[2]):e}else t=[e,e,e,e];return t}(N),f=a[0],m=a[1],v=a[2],g=a[3]);var O=wQe(n-r)/2;if(y=MQe(O,v),b=MQe(O,g),x=MQe(O,f),w=MQe(O,m),M=_=SQe(y,b),T=S=SQe(x,w),(_>TQe||S>TQe)&&(k=n*yQe(l),C=n*gQe(l),A=r*yQe(s),E=r*gQe(s),h<mQe)){var F=function(e,t,a,n,r,i,o,s){var l=a-e,c=n-t,u=o-r,d=s-i,h=d*l-u*c;if(!(h*h<TQe))return[e+(h=(u*(t-i)-d*(e-r))/h)*l,t+h*c]}(I,R,A,E,k,C,D,P);if(F){var B=I-F[0],U=R-F[1],z=k-F[0],V=C-F[1],H=1/gQe(bQe((B*z+U*V)/(_Qe(B*B+U*U)*_Qe(z*z+V*V)))/2),G=_Qe(F[0]*F[0]+F[1]*F[1]);M=MQe(_,(n-G)/(H+1)),T=MQe(S,(r-G)/(H-1))}}}if(L)if(M>TQe){var W=MQe(v,M),q=MQe(g,M),Y=kQe(A,E,I,R,n,W,d),j=kQe(k,C,D,P,n,q,d);e.moveTo(c+Y.cx+Y.x0,u+Y.cy+Y.y0),M<_&&W===q?e.arc(c+Y.cx,u+Y.cy,M,xQe(Y.y0,Y.x0),xQe(j.y0,j.x0),!d):(W>0&&e.arc(c+Y.cx,u+Y.cy,W,xQe(Y.y0,Y.x0),xQe(Y.y1,Y.x1),!d),e.arc(c,u,n,xQe(Y.cy+Y.y1,Y.cx+Y.x1),xQe(j.cy+j.y1,j.cx+j.x1),!d),q>0&&e.arc(c+j.cx,u+j.cy,q,xQe(j.y1,j.x1),xQe(j.y0,j.x0),!d))}else e.moveTo(c+I,u+R),e.arc(c,u,n,s,l,!d);else e.moveTo(c+I,u+R);if(r>TQe&&L)if(T>TQe){W=MQe(f,T),Y=kQe(D,P,k,C,r,-(q=MQe(m,T)),d),j=kQe(I,R,A,E,r,-W,d);e.lineTo(c+Y.cx+Y.x0,u+Y.cy+Y.y0),T<S&&W===q?e.arc(c+Y.cx,u+Y.cy,T,xQe(Y.y0,Y.x0),xQe(j.y0,j.x0),!d):(q>0&&e.arc(c+Y.cx,u+Y.cy,q,xQe(Y.y0,Y.x0),xQe(Y.y1,Y.x1),!d),e.arc(c,u,r,xQe(Y.cy+Y.y1,Y.cx+Y.x1),xQe(j.cy+j.y1,j.cx+j.x1),d),W>0&&e.arc(c+j.cx,u+j.cy,W,xQe(j.y1,j.x1),xQe(j.y0,j.x0),!d))}else e.lineTo(c+D,u+P),e.arc(c,u,r,l,s,d);else e.lineTo(c+D,u+P)}else e.moveTo(c,u);e.closePath()}}}var AQe=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0},EQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new AQe},t.prototype.buildPath=function(e,t){CQe(e,t)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(gZe);EQe.prototype.type="sector";var IQe=function(){this.cx=0,this.cy=0,this.r=0,this.r0=0},RQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new IQe},t.prototype.buildPath=function(e,t){var a=t.cx,n=t.cy,r=2*Math.PI;e.moveTo(a+t.r,n),e.arc(a,n,t.r,0,r,!1),e.moveTo(a+t.r0,n),e.arc(a,n,t.r0,0,r,!0)},t}(gZe);function DQe(e,t,a){var n=t.smooth,r=t.points;if(r&&r.length>=2){if(n){var i=function(e,t,a,n){var r,i,o,s,l=[],c=[],u=[],d=[];if(n){o=[1/0,1/0],s=[-1/0,-1/0];for(var h=0,p=e.length;h<p;h++)gWe(o,o,e[h]),yWe(s,s,e[h]);gWe(o,o,n[0]),yWe(s,s,n[1])}for(h=0,p=e.length;h<p;h++){var f=e[h];if(a)r=e[h?h-1:p-1],i=e[(h+1)%p];else{if(0===h||h===p-1){l.push(rWe(e[h]));continue}r=e[h-1],i=e[h+1]}lWe(c,i,r),uWe(c,c,t);var m=hWe(f,r),v=hWe(f,i),g=m+v;0!==g&&(m/=g,v/=g),uWe(u,c,-m),uWe(d,c,v);var y=oWe([],f,u),b=oWe([],f,d);n&&(yWe(y,y,o),gWe(y,y,s),yWe(b,b,o),gWe(b,b,s)),l.push(y),l.push(b)}return a&&l.push(l.shift()),l}(r,n,a,t.smoothConstraint);e.moveTo(r[0][0],r[0][1]);for(var o=r.length,s=0;s<(a?o:o-1);s++){var l=i[2*s],c=i[2*s+1],u=r[(s+1)%o];e.bezierCurveTo(l[0],l[1],c[0],c[1],u[0],u[1])}}else{e.moveTo(r[0][0],r[0][1]);s=1;for(var d=r.length;s<d;s++)e.lineTo(r[s][0],r[s][1])}a&&e.closePath()}}RQe.prototype.type="ring";var PQe=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},LQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new PQe},t.prototype.buildPath=function(e,t){DQe(e,t,!0)},t}(gZe);LQe.prototype.type="polygon";var NQe=function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null},OQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new NQe},t.prototype.buildPath=function(e,t){DQe(e,t,!1)},t}(gZe);OQe.prototype.type="polyline";var FQe={},BQe=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},UQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new BQe},t.prototype.buildPath=function(e,t){var a,n,r,i;if(this.subPixelOptimize){var o=MZe(FQe,t,this.style);a=o.x1,n=o.y1,r=o.x2,i=o.y2}else a=t.x1,n=t.y1,r=t.x2,i=t.y2;var s=t.percent;0!==s&&(e.moveTo(a,n),s<1&&(r=a*(1-s)+r*s,i=n*(1-s)+i*s),e.lineTo(r,i))},t.prototype.pointAt=function(e){var t=this.shape;return[t.x1*(1-e)+t.x2*e,t.y1*(1-e)+t.y2*e]},t}(gZe);UQe.prototype.type="line";var zQe=[],VQe=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function HQe(e,t,a){var n=e.cpx2,r=e.cpy2;return null!=n||null!=r?[(a?Qqe:Jqe)(e.x1,e.cpx1,e.cpx2,e.x2,t),(a?Qqe:Jqe)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(a?oYe:iYe)(e.x1,e.cpx1,e.x2,t),(a?oYe:iYe)(e.y1,e.cpy1,e.y2,t)]}var GQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new VQe},t.prototype.buildPath=function(e,t){var a=t.x1,n=t.y1,r=t.x2,i=t.y2,o=t.cpx1,s=t.cpy1,l=t.cpx2,c=t.cpy2,u=t.percent;0!==u&&(e.moveTo(a,n),null==l||null==c?(u<1&&(lYe(a,o,r,u,zQe),o=zQe[1],r=zQe[2],lYe(n,s,i,u,zQe),s=zQe[1],i=zQe[2]),e.quadraticCurveTo(o,s,r,i)):(u<1&&(aYe(a,o,l,r,u,zQe),o=zQe[1],l=zQe[2],r=zQe[3],aYe(n,s,c,i,u,zQe),s=zQe[1],c=zQe[2],i=zQe[3]),e.bezierCurveTo(o,s,l,c,r,i)))},t.prototype.pointAt=function(e){return HQe(this.shape,e,!1)},t.prototype.tangentAt=function(e){var t=HQe(this.shape,e,!0);return dWe(t,t)},t}(gZe);GQe.prototype.type="bezier-curve";var WQe=function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},qQe=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new WQe},t.prototype.buildPath=function(e,t){var a=t.cx,n=t.cy,r=Math.max(t.r,0),i=t.startAngle,o=t.endAngle,s=t.clockwise,l=Math.cos(i),c=Math.sin(i);e.moveTo(l*r+a,c*r+n),e.arc(a,n,r,i,o,!s)},t}(gZe);qQe.prototype.type="arc";var YQe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="compound",t}return zHe(t,e),t.prototype._updatePathDirty=function(){for(var e=this.shape.paths,t=this.shapeChanged(),a=0;a<e.length;a++)t=t||e[a].shapeChanged();t&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var e=this.shape.paths||[],t=this.getGlobalScale(),a=0;a<e.length;a++)e[a].path||e[a].createPathProxy(),e[a].path.setScale(t[0],t[1],e[a].segmentIgnoreThreshold)},t.prototype.buildPath=function(e,t){for(var a=t.paths||[],n=0;n<a.length;n++)a[n].buildPath(e,a[n].shape,!0)},t.prototype.afterBrush=function(){for(var e=this.shape.paths||[],t=0;t<e.length;t++)e[t].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),gZe.prototype.getBoundingRect.call(this)},t}(gZe),jQe=function(){function e(e){this.colorStops=e||[]}return e.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},e}(),XQe=function(e){function t(t,a,n,r,i,o){var s=e.call(this,i)||this;return s.x=null==t?0:t,s.y=null==a?0:a,s.x2=null==n?1:n,s.y2=null==r?0:r,s.type="linear",s.global=o||!1,s}return zHe(t,e),t}(jQe),$Qe=function(e){function t(t,a,n,r,i){var o=e.call(this,r)||this;return o.x=null==t?.5:t,o.y=null==a?.5:a,o.r=null==n?.5:n,o.type="radial",o.global=i||!1,o}return zHe(t,e),t}(jQe),KQe=Math.min,ZQe=Math.max,JQe=Math.abs,QQe=[0,0],e0e=[0,0],t0e=yqe(),a0e=t0e.minTv,n0e=t0e.maxTv,r0e=function(){function e(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var a=0;a<4;a++)this._corners[a]=new eqe;for(a=0;a<2;a++)this._axes[a]=new eqe;e&&this.fromBoundingRect(e,t)}return e.prototype.fromBoundingRect=function(e,t){var a=this._corners,n=this._axes,r=e.x,i=e.y,o=r+e.width,s=i+e.height;if(a[0].set(r,i),a[1].set(o,i),a[2].set(o,s),a[3].set(r,s),t)for(var l=0;l<4;l++)a[l].transform(t);eqe.sub(n[0],a[1],a[0]),eqe.sub(n[1],a[3],a[0]),n[0].normalize(),n[1].normalize();for(l=0;l<2;l++)this._origin[l]=n[l].dot(a[0])},e.prototype.intersect=function(e,t,a){var n=!0,r=!t;return t&&eqe.set(t,0,0),t0e.reset(a,!r),!this._intersectCheckOneSide(this,e,r,1)&&(n=!1,r)||!this._intersectCheckOneSide(e,this,r,-1)&&(n=!1,r)||r||t0e.negativeSize||eqe.copy(t,n?t0e.useDir?t0e.dirMinTv:a0e:n0e),n},e.prototype._intersectCheckOneSide=function(e,t,a,n){for(var r=!0,i=0;i<2;i++){var o=e._axes[i];if(e._getProjMinMaxOnAxis(i,e._corners,QQe),e._getProjMinMaxOnAxis(i,t._corners,e0e),t0e.negativeSize||QQe[1]<e0e[0]||QQe[0]>e0e[1]){if(r=!1,t0e.negativeSize||a)return r;var s=JQe(e0e[0]-QQe[1]),l=JQe(QQe[0]-e0e[1]);KQe(s,l)>n0e.len()&&(s<l?eqe.scale(n0e,o,-s*n):eqe.scale(n0e,o,l*n))}else if(!a){s=JQe(e0e[0]-QQe[1]),l=JQe(QQe[0]-e0e[1]);(t0e.useDir||KQe(s,l)<a0e.len())&&((s<l||!t0e.bidirectional)&&(eqe.scale(a0e,o,s*n),t0e.useDir&&t0e.calcDirMTV()),(s>=l||!t0e.bidirectional)&&(eqe.scale(a0e,o,-l*n),t0e.useDir&&t0e.calcDirMTV()))}}return r},e.prototype._getProjMinMaxOnAxis=function(e,t,a){for(var n=this._axes[e],r=this._origin,i=t[0].dot(n)+r[e],o=i,s=i,l=1;l<t.length;l++){var c=t[l].dot(n)+r[e];o=KQe(c,o),s=ZQe(c,s)}a[0]=o+t0e.touchThreshold,a[1]=s-t0e.touchThreshold,t0e.negativeSize=a[1]<a[0]},e}(),i0e=[],o0e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return zHe(t,e),t.prototype.traverse=function(e,t){e.call(t,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(e,t){t?this._temporaryDisplayables.push(e):this._displayables.push(e),this.markRedraw()},t.prototype.addDisplayables=function(e,t){t=t||!1;for(var a=0;a<e.length;a++)this.addDisplayable(e[a],t)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(e){for(var t=this._cursor;t<this._displayables.length;t++)e&&e(this._displayables[t]);for(t=0;t<this._temporaryDisplayables.length;t++)e&&e(this._temporaryDisplayables[t])},t.prototype.update=function(){this.updateTransform();for(var e=this._cursor;e<this._displayables.length;e++){(t=this._displayables[e]).parent=this,t.update(),t.parent=null}for(e=0;e<this._temporaryDisplayables.length;e++){var t;(t=this._temporaryDisplayables[e]).parent=this,t.update(),t.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var e=new fqe(1/0,1/0,-1/0,-1/0),t=0;t<this._displayables.length;t++){var a=this._displayables[t],n=a.getBoundingRect().clone();a.needLocalTransform()&&n.applyTransform(a.getLocalTransform(i0e)),e.union(n)}this._rect=e}return this._rect},t.prototype.contain=function(e,t){var a=this.transformCoordToLocal(e,t);if(this.getBoundingRect().contain(a[0],a[1]))for(var n=0;n<this._displayables.length;n++){if(this._displayables[n].contain(e,t))return!0}return!1},t}(fKe),s0e=v$e();function l0e(e,t,a,n,r){var i;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();i=o&&o.animation}var s="update"===e;if(t&&t.isAnimationEnabled()){var l=void 0,c=void 0,u=void 0;return n?(l=FGe(n.duration,200),c=FGe(n.easing,"cubicOut"),u=0):(l=t.getShallow(s?"animationDurationUpdate":"animationDuration"),c=t.getShallow(s?"animationEasingUpdate":"animationEasing"),u=t.getShallow(s?"animationDelayUpdate":"animationDelay")),i&&(null!=i.duration&&(l=i.duration),null!=i.easing&&(c=i.easing),null!=i.delay&&(u=i.delay)),kGe(u)&&(u=u(a,r)),kGe(l)&&(l=l(a)),{duration:l||0,delay:u,easing:c}}return null}function c0e(e,t,a,n,r,i,o){var s,l=!1;kGe(r)?(o=i,i=r,r=null):IGe(r)&&(i=r.cb,o=r.during,l=r.isFrom,s=r.removeOpt,r=r.dataIndex);var c="leave"===e;c||t.stopAnimation("leave");var u=l0e(e,n,r,c?s||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(t,r):null);if(u&&u.duration>0){var d={duration:u.duration,delay:u.delay||0,easing:u.easing,done:i,force:!!i||!!o,setToFinal:!c,scope:e,during:o};l?t.animateFrom(a,d):t.animateTo(a,d)}else t.stopAnimation(),!l&&t.attr(a),o&&o(1),i&&i()}function u0e(e,t,a,n,r,i){c0e("update",e,t,a,n,r,i)}function d0e(e,t,a,n,r,i){c0e("enter",e,t,a,n,r,i)}function h0e(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){if("leave"===e.animators[t].scope)return!0}return!1}function p0e(e,t,a,n,r,i){h0e(e)||c0e("leave",e,t,a,n,r,i)}function f0e(e,t,a,n){e.removeTextContent(),e.removeTextGuideLine(),p0e(e,{style:{opacity:0}},t,a,n)}function m0e(e,t,a){function n(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse(function(e){e.isGroup||f0e(e,t,a,n)}):f0e(e,t,a,n)}function v0e(e){s0e(e).oldStyle=e.style}var g0e={},y0e=["x","y"],b0e=["width","height"];var x0e=function(e,t){var a=lQe(e,t);return function(e){function t(t){var n=e.call(this,t)||this;return n.applyTransform=a.applyTransform,n.buildPath=a.buildPath,n}return zHe(t,e),t}(oQe)};function w0e(e,t){g0e[e]=t}function _0e(e){if(g0e.hasOwnProperty(e))return g0e[e]}function S0e(e,t,a,n){var r=cQe(e,t);return a&&("center"===n&&(a=T0e(a,r.getBoundingRect())),C0e(r,a)),r}function M0e(e,t,a){var n=new _Ze({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(e){if("center"===a){var r={width:e.width,height:e.height};n.setStyle(T0e(t,r))}}});return n}function T0e(e,t){var a,n=t.width/t.height,r=e.height*n;return a=r<=e.width?e.height:(r=e.width)/n,{x:e.x+e.width/2-r/2,y:e.y+e.height/2-a/2,width:r,height:a}}var k0e=function(e,t){for(var a=[],n=e.length,r=0;r<n;r++){var i=e[r];a.push(i.getUpdatedPathProxy(!0))}var o=new gZe(t);return o.createPathProxy(),o.buildPath=function(e){if(sQe(e)){e.appendPath(a);var t=e.getContext();t&&e.rebuildPath(t,1)}},o};function C0e(e,t){if(e.applyTransform){var a=e.getBoundingRect().calculateTransform(t);e.applyTransform(a)}}function A0e(e,t){return MZe(e,e,{lineWidth:t}),e}var E0e=kZe;function I0e(e,t){for(var a=jWe([]);e&&e!==t;)$We(a,e.getLocalTransform(),a),e=e.parent;return a}function R0e(e,t,a){return t&&!vGe(t)&&(t=Xje.getLocalTransform(t)),a&&(t=QWe([],t)),vWe([],e,t)}function D0e(e,t,a){var n=0===t[4]||0===t[5]||0===t[0]?1:EXe(2*t[4]/t[0]),r=0===t[4]||0===t[5]||0===t[2]?1:EXe(2*t[4]/t[2]),i=["left"===e?-n:"right"===e?n:0,"top"===e?-r:"bottom"===e?r:0];return i=R0e(i,t,a),EXe(i[0])>EXe(i[1])?i[0]>0?"right":"left":i[1]>0?"bottom":"top"}function P0e(e){return!e.isGroup}function L0e(e,t,a){if(e&&t){var n,r=(n={},e.traverse(function(e){P0e(e)&&e.anid&&(n[e.anid]=e)}),n);t.traverse(function(e){if(P0e(e)&&e.anid){var t=r[e.anid];if(t){var n=i(e);e.attr(i(t)),u0e(e,n,a,YZe(e).dataIndex)}}})}function i(e){var t={x:e.x,y:e.y,rotation:e.rotation};return function(e){return null!=e.shape}(e)&&(t.shape=cGe(e.shape)),t}}function N0e(e,t){return yGe(e,function(e){var a=e[0];a=AXe(a,t.x),a=CXe(a,t.x+t.width);var n=e[1];return n=AXe(n,t.y),[a,n=CXe(n,t.y+t.height)]})}function O0e(e,t,a){var n=hGe({rectHover:!0},t),r=n.style={strokeNoScale:!0};if(a=a||{x:-1,y:-1,width:2,height:2},e)return 0===e.indexOf("image://")?(r.image=e.slice(8),pGe(r,a),new _Ze(n)):S0e(e.replace("path://",""),n,a,"center")}function F0e(e,t,a,n,r){for(var i=0,o=r[r.length-1];i<r.length;i++){var s=r[i];if(B0e(e,t,a,n,s[0],s[1],o[0],o[1]))return!0;o=s}}function B0e(e,t,a,n,r,i,o,s){var l,c=a-e,u=n-t,d=o-r,h=s-i,p=U0e(d,h,c,u);if((l=p)<=1e-6&&l>=-1e-6)return!1;var f=e-r,m=t-i,v=U0e(f,m,c,u)/p;if(v<0||v>1)return!1;var g=U0e(f,m,d,h)/p;return!(g<0||g>1)}function U0e(e,t,a,n){return e*n-a*t}function z0e(e,t,a,n,r){return null==t||(EGe(t)?V0e[0]=V0e[1]=V0e[2]=V0e[3]=t:(V0e[0]=t[0],V0e[1]=t[1],V0e[2]=t[2],V0e[3]=t[3]),n&&(V0e[0]=AXe(0,V0e[0]),V0e[1]=AXe(0,V0e[1]),V0e[2]=AXe(0,V0e[2]),V0e[3]=AXe(0,V0e[3])),a&&(V0e[0]=-V0e[0],V0e[1]=-V0e[1],V0e[2]=-V0e[2],V0e[3]=-V0e[3]),H0e(e,V0e,"x","width",3,1,r&&r[0]||0),H0e(e,V0e,"y","height",0,2,r&&r[1]||0)),e}var V0e=[0,0,0,0];function H0e(e,t,a,n,r,i,o){var s=t[i]+t[r],l=e[n];e[n]+=s,o=AXe(0,CXe(o,l)),e[n]<o?(e[n]=o,e[a]+=t[r]>=0?-t[r]:t[i]>=0?l+t[i]:EXe(s)>1e-8?(l-o)*t[r]/s:0):e[a]-=t[r]}function G0e(e){var t=e.itemTooltipOption,a=e.componentModel,n=e.itemName,r=CGe(t)?{formatter:t}:t,i=a.mainType,o=a.componentIndex,s={componentType:i,name:n,$vars:["name"]};s[i+"Index"]=o;var l=e.formatterParamsExtra;l&&gGe(_Ge(l),function(e){QGe(s,e)||(s[e]=l[e],s.$vars.push(e))});var c=YZe(e.el);c.componentMainType=i,c.componentIndex=o,c.tooltipConfig={name:n,option:pGe({content:n,encodeHTMLContent:!0,formatterParams:s},r)}}function W0e(e,t){var a;e.isGroup&&(a=t(e)),a||e.traverse(t)}function q0e(e,t){if(e)if(TGe(e))for(var a=0;a<e.length;a++)W0e(e[a],t);else W0e(e,t)}function Y0e(e){return!e||EXe(e[1])<j0e&&EXe(e[2])<j0e||EXe(e[0])<j0e&&EXe(e[3])<j0e}var j0e=1e-5;function X0e(e,t){return e?fqe.copy(e,t):t.clone()}function $0e(e,t){return t?XWe(e||[1,0,0,1,0,0],t):void 0}function K0e(e){return{z:e.get("z")||0,zlevel:e.get("zlevel")||0}}function Z0e(e){var t=-1/0,a=1/0;function n(e){if(e&&!e.isGroup){var t=e.currentStates;if(t.length)for(var a=0;a<t.length;a++)r(e.states[t[a]]);r(e)}}function r(e){if(e){var n=e.z2;n>t&&(t=n),n<a&&(a=n)}}return W0e(e,function(e){n(e),n(e.getTextContent()),n(e.getTextGuideLine())}),a>t&&(a=t=0),{min:a,max:t}}function J0e(e,t,a){Q0e(e,t,a,-1/0)}function Q0e(e,t,a,n){if(e.ignoreModelZ)return n;var r=e.getTextContent(),i=e.getTextGuideLine();if(e.isGroup)for(var o=e.childrenRef(),s=0;s<o.length;s++)n=AXe(Q0e(o[s],t,a,n),n);else e.z=t,e.zlevel=a,n=AXe(e.z2||0,n);if(r&&(r.z=t,r.zlevel=a,isFinite(n)&&(r.z2=n+2)),i){var l=e.textGuideLineConfig;i.z=t,i.zlevel=a,isFinite(n)&&(i.z2=n+(l&&l.showAbove?1:-1))}return n}w0e("circle",hQe),w0e("ellipse",fQe),w0e("sector",EQe),w0e("ring",RQe),w0e("polygon",LQe),w0e("polyline",OQe),w0e("rect",EZe),w0e("line",UQe),w0e("bezierCurve",GQe),w0e("arc",qQe);const e1e=Object.freeze(Object.defineProperty({__proto__:null,Arc:qQe,BezierCurve:GQe,BoundingRect:fqe,Circle:hQe,CompoundPath:YQe,Ellipse:fQe,Group:xXe,Image:_Ze,IncrementalDisplayable:o0e,Line:UQe,LinearGradient:XQe,OrientedBoundingRect:r0e,Path:gZe,Point:eqe,Polygon:LQe,Polyline:OQe,RadialGradient:$Qe,Rect:EZe,Ring:RQe,Sector:EQe,Text:PZe,WH:b0e,XY:y0e,applyTransform:R0e,calcZ2Range:Z0e,clipPointsByRect:N0e,clipRectByRect:function(e,t){var a=AXe(e.x,t.x),n=CXe(e.x+e.width,t.x+t.width),r=AXe(e.y,t.y),i=CXe(e.y+e.height,t.y+t.height);if(n>=a&&i>=r)return{x:a,y:r,width:n-a,height:i-r}},createIcon:O0e,ensureCopyRect:X0e,ensureCopyTransform:$0e,expandOrShrinkRect:z0e,extendPath:function(e,t){return x0e(e,t)},extendShape:function(e){return gZe.extend(e)},getShapeClass:_0e,getTransform:I0e,groupTransition:L0e,initProps:d0e,isBoundingRectAxisAligned:Y0e,isElementRemoved:h0e,lineLineIntersect:B0e,linePolygonIntersect:F0e,makeImage:M0e,makePath:S0e,mergePath:k0e,registerShape:w0e,removeElement:p0e,removeElementWithFadeOut:m0e,resizePath:C0e,retrieveZInfo:K0e,setTooltipConfig:G0e,subPixelOptimize:E0e,subPixelOptimizeLine:A0e,subPixelOptimizeRect:function(e,t){return TZe(e,e,t),e},transformDirection:D0e,traverseElements:q0e,traverseUpdateZ:J0e,updateProps:u0e},Symbol.toStringTag,{value:"Module"}));var t1e={};function a1e(e,t){for(var a=0;a<JZe.length;a++){var n=JZe[a],r=t[n],i=e.ensureState(n);i.style=i.style||{},i.style.text=r}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function n1e(e,t,a){var n,r=e.labelFetcher,i=e.labelDataIndex,o=e.labelDimIndex,s=t.normal;r&&(n=r.getFormattedLabel(i,"normal",null,o,s&&s.get("formatter"),null!=a?{interpolatedValue:a}:null)),null==n&&(n=kGe(e.defaultText)?e.defaultText(i,e,a):e.defaultText);for(var l={normal:n},c=0;c<JZe.length;c++){var u=JZe[c],d=t[u];l[u]=FGe(r?r.getFormattedLabel(i,u,null,o,d&&d.get("formatter")):null,n)}return l}function r1e(e,t,a,n){a=a||t1e;for(var r=e instanceof PZe,i=!1,o=0;o<QZe.length;o++){if((h=t[QZe[o]])&&h.getShallow("show")){i=!0;break}}var s=r?e:e.getTextContent();if(i){r||(s||(s=new PZe,e.setTextContent(s)),e.stateProxy&&(s.stateProxy=e.stateProxy));var l=n1e(a,t),c=t.normal,u=!!c.getShallow("show"),d=o1e(c,n&&n.normal,a,!1,!r);d.text=l.normal,r||e.setTextConfig(s1e(c,a,!1));for(o=0;o<JZe.length;o++){var h,p=JZe[o];if(h=t[p]){var f=s.ensureState(p),m=!!FGe(h.getShallow("show"),u);if(m!==u&&(f.ignore=!m),f.style=o1e(h,n&&n[p],a,!0,!r),f.style.text=l[p],!r)e.ensureState(p).textConfig=s1e(h,a,!0)}}s.silent=!!c.getShallow("silent"),null!=s.style.x&&(d.x=s.style.x),null!=s.style.y&&(d.y=s.style.y),s.ignore=!u,s.useStyle(d),s.dirty(),a.enableTextSetter&&(p1e(s).setLabelText=function(e){var n=n1e(a,t,e);a1e(s,n)})}else s&&(s.ignore=!0);e.dirty()}function i1e(e,t){t=t||"label";for(var a={normal:e.getModel(t)},n=0;n<JZe.length;n++){var r=JZe[n];a[r]=e.getModel([r,t])}return a}function o1e(e,t,a,n,r){var i={};return function(e,t,a,n,r){a=a||t1e;var i,o=t.ecModel,s=o&&o.option.textStyle,l=function(e){var t;for(;e&&e!==e.ecModel;){var a=(e.option||t1e).rich;if(a){t=t||{};for(var n=_Ge(a),r=0;r<n.length;r++){t[n[r]]=1}}e=e.parentModel}return t}(t);if(l){i={};var c="richInheritPlainLabel",u=FGe(t.get(c),o?o.get(c):void 0);for(var d in l)if(l.hasOwnProperty(d)){var h=t.getModel(["rich",d]);d1e(i[d]={},h,s,t,u,a,n,r,!1,!0)}}i&&(e.rich=i);var p=t.get("overflow");p&&(e.overflow=p);var f=t.get("lineOverflow");f&&(e.lineOverflow=f);var m=e,v=t.get("minMargin");if(null!=v)v=EGe(v)?v/2:0,m.margin=[v,v,v,v],m.__marginType=y1e.minMargin;else{var g=t.get("textMargin");null!=g&&(m.margin=zGe(g),m.__marginType=y1e.textMargin)}d1e(e,t,s,null,null,a,n,r,!0,!1)}(i,e,a,n,r),t&&hGe(i,t),i}function s1e(e,t,a){t=t||{};var n,r={},i=e.getShallow("rotate"),o=FGe(e.getShallow("distance"),a?null:5),s=e.getShallow("offset");return"outside"===(n=e.getShallow("position")||(a?null:"inside"))&&(n=t.defaultOutsidePosition||"top"),null!=n&&(r.position=n),null!=s&&(r.offset=s),null!=i&&(i*=Math.PI/180,r.rotation=i),null!=o&&(r.distance=o),r.outsideFill="inherit"===e.get("color")?t.inheritColor||null:"auto",null!=t.autoOverflowArea&&(r.autoOverflowArea=t.autoOverflowArea),null!=t.layoutRect&&(r.layoutRect=t.layoutRect),r}var l1e=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],c1e=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],u1e=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function d1e(e,t,a,n,r,i,o,s,l,c){a=!o&&a||t1e;var u=i&&i.inheritColor,d=t.getShallow("color"),h=t.getShallow("textBorderColor"),p=FGe(t.getShallow("opacity"),a.opacity);"inherit"!==d&&"auto"!==d||(d=u||null),"inherit"!==h&&"auto"!==h||(h=u||null),s||(d=d||a.color,h=h||a.textBorderColor),null!=d&&(e.fill=d),null!=h&&(e.stroke=h);var f=FGe(t.getShallow("textBorderWidth"),a.textBorderWidth);null!=f&&(e.lineWidth=f);var m=FGe(t.getShallow("textBorderType"),a.textBorderType);null!=m&&(e.lineDash=m);var v=FGe(t.getShallow("textBorderDashOffset"),a.textBorderDashOffset);null!=v&&(e.lineDashOffset=v),o||null!=p||c||(p=i&&i.defaultOpacity),null!=p&&(e.opacity=p),o||s||null==e.fill&&i.inheritColor&&(e.fill=i.inheritColor);for(var g=0;g<l1e.length;g++){var y=l1e[g];null!=(x=!1!==r&&n?BGe(t.getShallow(y),n.getShallow(y),a[y]):FGe(t.getShallow(y),a[y]))&&(e[y]=x)}for(g=0;g<c1e.length;g++){y=c1e[g];null!=(x=t.getShallow(y))&&(e[y]=x)}if(null==e.verticalAlign){var b=t.getShallow("baseline");null!=b&&(e.verticalAlign=b)}if(!l||!i.disableBox){for(g=0;g<u1e.length;g++){var x;y=u1e[g];null!=(x=t.getShallow(y))&&(e[y]=x)}var w=t.getShallow("borderType");null!=w&&(e.borderDash=w),"auto"!==e.backgroundColor&&"inherit"!==e.backgroundColor||!u||(e.backgroundColor=u),"auto"!==e.borderColor&&"inherit"!==e.borderColor||!u||(e.borderColor=u)}}function h1e(e,t){var a=t&&t.getModel("textStyle");return HGe([e.fontStyle||a&&a.getShallow("fontStyle")||"",e.fontWeight||a&&a.getShallow("fontWeight")||"",(e.fontSize||a&&a.getShallow("fontSize")||12)+"px",e.fontFamily||a&&a.getShallow("fontFamily")||"sans-serif"].join(" "))}var p1e=v$e();function f1e(e,t,a,n){if(e){var r=p1e(e);r.prevValue=r.value,r.value=a;var i=t.normal;r.valueAnimation=i.get("valueAnimation"),r.valueAnimation&&(r.precision=i.get("precision"),r.defaultInterpolatedText=n,r.statesModels=t)}}function m1e(e,t,a,n,r){var i=p1e(e);if(i.valueAnimation&&i.prevValue!==i.value){var o=i.defaultInterpolatedText,s=FGe(i.interpolatedValue,i.prevValue),l=i.value;e.percent=0,(null==i.prevValue?d0e:u0e)(e,{percent:1},n,t,null,function(n){var c=T$e(a,i.precision,s,l,n);i.interpolatedValue=1===n?null:c;var u=n1e({labelDataIndex:t,labelFetcher:r,defaultText:o?o(c):c+""},i.statesModels,c);a1e(e,u)})}}var v1e,g1e,y1e={minMargin:1,textMargin:2},b1e=["textStyle","color"],x1e=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],w1e=new PZe,_1e=function(){function e(){}return e.prototype.getTextColor=function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(b1e):null)},e.prototype.getFont=function(){return h1e({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(e){for(var t={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},a=0;a<x1e.length;a++)t[x1e[a]]=this.getShallow(x1e[a]);return w1e.useStyle(t),w1e.update(),w1e.getBoundingRect()},e}(),S1e=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],M1e=F$e(S1e),T1e=function(){function e(){}return e.prototype.getLineStyle=function(e){return M1e(this,e)},e}(),k1e=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],C1e=F$e(k1e),A1e=function(){function e(){}return e.prototype.getItemStyle=function(e,t){return C1e(this,e,t)},e}(),E1e=function(){function e(e,t,a){this.parentModel=t,this.ecModel=a,this.option=e}return e.prototype.init=function(e,t,a){},e.prototype.mergeOption=function(e,t){uGe(this.option,e,!0)},e.prototype.get=function(e,t){return null==e?this.option:this._doGet(this.parsePath(e),!t&&this.parentModel)},e.prototype.getShallow=function(e,t){var a=this.option,n=null==a?a:a[e];if(null==n&&!t){var r=this.parentModel;r&&(n=r.getShallow(e))}return n},e.prototype.getModel=function(t,a){var n=null!=t,r=n?this.parsePath(t):null;return new e(n?this._doGet(r):this.option,a=a||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(r)),this.ecModel)},e.prototype.isEmpty=function(){return null==this.option},e.prototype.restoreData=function(){},e.prototype.clone=function(){return new(0,this.constructor)(cGe(this.option))},e.prototype.parsePath=function(e){return"string"==typeof e?e.split("."):e},e.prototype.resolveParentPath=function(e){return e},e.prototype.isAnimationEnabled=function(){if(!HHe.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(e,t){var a=this.option;if(!e)return a;for(var n=0;n<e.length&&(!e[n]||null!=(a=a&&"object"==typeof a?a[e[n]]:null));n++);return null==a&&t&&(a=t._doGet(this.resolveParentPath(e),t.parentModel)),a},e}();R$e(E1e),v1e=E1e,g1e=["__\0is_clz",P$e++].join("_"),v1e.prototype[g1e]=!0,v1e.isInstance=function(e){return!(!e||!e[g1e])},mGe(E1e,T1e),mGe(E1e,A1e),mGe(E1e,U$e),mGe(E1e,_1e);var I1e=Math.round(10*Math.random());function R1e(e){return[e||"",I1e++].join("_")}function D1e(e,t){return uGe(uGe({},e,!0),t,!0)}var P1e="ZH",L1e="EN",N1e=L1e,O1e={},F1e={},B1e=HHe.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage||N1e).toUpperCase().indexOf(P1e)>-1?P1e:N1e;function U1e(e,t){e=e.toUpperCase(),F1e[e]=new E1e(t),O1e[e]=t}function z1e(e){return F1e[e]}U1e(L1e,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),U1e(P1e,{time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图",custom:"自定义图表",chart:"图表"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}});var V1e=null;function H1e(){return V1e}var G1e=1e3,W1e=6e4,q1e=36e5,Y1e=864e5,j1e=31536e6,X1e={year:/({yyyy}|{yy})/,month:/({MMMM}|{MMM}|{MM}|{M})/,day:/({dd}|{d})/,hour:/({HH}|{H}|{hh}|{h})/,minute:/({mm}|{m})/,second:/({ss}|{s})/,millisecond:/({SSS}|{S})/},$1e={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}"},K1e="{yyyy}-{MM}-{dd}",Z1e={year:"{yyyy}",month:"{yyyy}-{MM}",day:K1e,hour:K1e+" "+$1e.hour,minute:K1e+" "+$1e.minute,second:K1e+" "+$1e.second,millisecond:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},J1e=["year","month","day","hour","minute","second","millisecond"],Q1e=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function e2e(e){return CGe(e)||kGe(e)?e:function(e){e=e||{};var t={},a=!0;return gGe(J1e,function(t){a&&(a=null==e[t])}),gGe(J1e,function(n,r){var i=e[n];t[n]={};for(var o=null,s=r;s>=0;s--){var l=J1e[s],c=IGe(i)&&!TGe(i)?i[l]:i,u=void 0;TGe(c)?o=(u=c.slice())[0]||"":CGe(c)?u=[o=c]:(null==o?o=$1e[n]:X1e[l].test(o)||(o=t[l][l][0]+" "+o),u=[o],a&&(u[1]="{primary|"+o+"}")),t[n][l]=u}}),t}(e)}function t2e(e,t){return"0000".substr(0,t-(e+="").length)+e}function a2e(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function n2e(e){return e===a2e(e)}function r2e(e,t,a,n){var r=HXe(e),i=r[s2e(a)](),o=r[l2e(a)]()+1,s=Math.floor((o-1)/3)+1,l=r[c2e(a)](),c=r["get"+(a?"UTC":"")+"Day"](),u=r[u2e(a)](),d=(u-1)%12+1,h=r[d2e(a)](),p=r[h2e(a)](),f=r[p2e(a)](),m=u>=12?"pm":"am",v=m.toUpperCase(),g=(n instanceof E1e?n:z1e(n||B1e)||F1e[N1e]).getModel("time"),y=g.get("month"),b=g.get("monthAbbr"),x=g.get("dayOfWeek"),w=g.get("dayOfWeekAbbr");return(t||"").replace(/{a}/g,m+"").replace(/{A}/g,v+"").replace(/{yyyy}/g,i+"").replace(/{yy}/g,t2e(i%100+"",2)).replace(/{Q}/g,s+"").replace(/{MMMM}/g,y[o-1]).replace(/{MMM}/g,b[o-1]).replace(/{MM}/g,t2e(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,t2e(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,x[c]).replace(/{ee}/g,w[c]).replace(/{e}/g,c+"").replace(/{HH}/g,t2e(u,2)).replace(/{H}/g,u+"").replace(/{hh}/g,t2e(d+"",2)).replace(/{h}/g,d+"").replace(/{mm}/g,t2e(h,2)).replace(/{m}/g,h+"").replace(/{ss}/g,t2e(p,2)).replace(/{s}/g,p+"").replace(/{SSS}/g,t2e(f,3)).replace(/{S}/g,f+"")}function i2e(e,t){var a=HXe(e),n=a[l2e(t)]()+1,r=a[c2e(t)](),i=a[u2e(t)](),o=a[d2e(t)](),s=a[h2e(t)](),l=0===a[p2e(t)](),c=l&&0===s,u=c&&0===o,d=u&&0===i,h=d&&1===r;return h&&1===n?"year":h?"month":d?"day":u?"hour":c?"minute":l?"second":"millisecond"}function o2e(e,t,a){switch(t){case"year":e[m2e(a)](0);case"month":e[v2e(a)](1);case"day":e[g2e(a)](0);case"hour":e[y2e(a)](0);case"minute":e[b2e(a)](0);case"second":e[x2e(a)](0)}return e}function s2e(e){return e?"getUTCFullYear":"getFullYear"}function l2e(e){return e?"getUTCMonth":"getMonth"}function c2e(e){return e?"getUTCDate":"getDate"}function u2e(e){return e?"getUTCHours":"getHours"}function d2e(e){return e?"getUTCMinutes":"getMinutes"}function h2e(e){return e?"getUTCSeconds":"getSeconds"}function p2e(e){return e?"getUTCMilliseconds":"getMilliseconds"}function f2e(e){return e?"setUTCFullYear":"setFullYear"}function m2e(e){return e?"setUTCMonth":"setMonth"}function v2e(e){return e?"setUTCDate":"setDate"}function g2e(e){return e?"setUTCHours":"setHours"}function y2e(e){return e?"setUTCMinutes":"setMinutes"}function b2e(e){return e?"setUTCSeconds":"setSeconds"}function x2e(e){return e?"setUTCMilliseconds":"setMilliseconds"}function w2e(e){if(!XXe(e))return CGe(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function _2e(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var S2e=zGe;function M2e(e,t,a){function n(e){return e&&HGe(e)?e:"-"}function r(e){return!(null==e||isNaN(e)||!isFinite(e))}var i="time"===t,o=e instanceof Date;if(i||o){var s=i?HXe(e):e;if(!isNaN(+s))return r2e(s,"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}",a);if(o)return"-"}if("ordinal"===t)return AGe(e)?n(e):EGe(e)&&r(e)?e+"":"-";var l=jXe(e);return r(l)?w2e(l):AGe(e)?n(e):"boolean"==typeof e?e+"":"-"}var T2e=["a","b","c","d","e","f","g"],k2e=function(e,t){return"{"+e+(null==t?"":t)+"}"};function C2e(e,t,a){TGe(t)||(t=[t]);var n=t.length;if(!n)return"";for(var r=t[0].$vars||[],i=0;i<r.length;i++){var o=T2e[i];e=e.replace(k2e(o),k2e(o,0))}for(var s=0;s<n;s++)for(var l=0;l<r.length;l++){var c=t[s][r[l]];e=e.replace(k2e(T2e[l],s),a?RWe(c):c)}return e}function A2e(e,t){return t=t||"transparent",CGe(e)?e:IGe(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function E2e(e,t){if("_blank"===t||"blank"===t){var a=window.open();a.opener=null,a.location.href=e}else window.open(e,t)}var I2e={},R2e={},D2e=function(){function e(){this._normalMasterList=[],this._nonSeriesBoxMasterList=[]}return e.prototype.create=function(e,t){function a(a,n){var r=[];return gGe(a,function(a,n){var i=a.create(e,t);r=r.concat(i||[])}),r}this._nonSeriesBoxMasterList=a(I2e),this._normalMasterList=a(R2e)},e.prototype.update=function(e,t){gGe(this._normalMasterList,function(a){a.update&&a.update(e,t)})},e.prototype.getCoordinateSystems=function(){return this._normalMasterList.concat(this._nonSeriesBoxMasterList)},e.register=function(e,t){"matrix"!==e&&"calendar"!==e?R2e[e]=t:I2e[e]=t},e.get=function(e){return R2e[e]||I2e[e]},e}();var P2e=1,L2e=2;var N2e=$Ge();var O2e=0,F2e=1,B2e=2;function U2e(e,t){var a=e.getShallow("coordinateSystem"),n=e.getShallow("coordinateSystemUsage",!0),r=O2e;if(a){var i="series"===e.mainType;null==n&&(n=i?"data":"box"),"data"===n?(r=F2e,i||(r=O2e)):"box"===n&&(r=B2e,i||function(e){return!!I2e[e]}(a)||(r=O2e))}return{coordSysType:a,kind:r}}function z2e(e){var t=e.targetModel,a=e.coordSysType,n=e.coordSysProvider,r=e.isDefaultDataCoordSys;e.allowNotFound;var i=U2e(t),o=i.kind,s=i.coordSysType;if(r&&o!==F2e&&(o=F2e,s=a),o===O2e||s!==a)return!1;var l=n(a,t);return!!l&&(o===F2e?t.coordinateSystem=l:t.boxCoordinateSystem=l,!0)}var V2e=function(e,t){var a=t.getReferringComponents(e,x$e).models[0];return a&&a.coordinateSystem},H2e=gGe,G2e=["left","right","top","bottom","width","height"],W2e=[["width","left","right"],["height","top","bottom"]];function q2e(e,t,a,n,r){var i=0,o=0;null==n&&(n=1/0),null==r&&(r=1/0);var s=0;t.eachChild(function(l,c){var u,d,h=l.getBoundingRect(),p=t.childAt(c+1),f=p&&p.getBoundingRect();if("horizontal"===e){var m=h.width+(f?-f.x+h.x:0);(u=i+m)>n||l.newline?(i=0,u=m,o+=s+a,s=h.height):s=Math.max(s,h.height)}else{var v=h.height+(f?-f.y+h.y:0);(d=o+v)>r||l.newline?(i+=s+a,o=0,d=v,s=h.width):s=Math.max(s,h.width)}l.newline||(l.x=i,l.y=o,l.markRedraw(),"horizontal"===e?i=u+a:o=d+a)})}var Y2e=q2e;function j2e(e,t){return{left:e.getShallow("left",t),top:e.getShallow("top",t),right:e.getShallow("right",t),bottom:e.getShallow("bottom",t),width:e.getShallow("width",t),height:e.getShallow("height",t)}}function X2e(e,t){var a=function(e,t){var a,n,r=J2e(e,t,{enableLayoutOnlyByCenter:!0}),i=e.getBoxLayoutParams();if(r.type===Z2e.point)n=r.refPoint,a=$2e(i,{width:t.getWidth(),height:t.getHeight()});else{var o=e.get("center"),s=TGe(o)?o:[o,o];a=$2e(i,r.refContainer),n=r.boxCoordFrom===L2e?r.refPoint:[RXe(s[0],a.width)+a.x,RXe(s[1],a.height)+a.y]}return{viewRect:a,center:n}}(e,t),n=a.viewRect,r=a.center,i=e.get("radius");TGe(i)||(i=[0,i]);var o=RXe(n.width,t.getWidth()),s=RXe(n.height,t.getHeight()),l=Math.min(o,s),c=RXe(i[0],l/2),u=RXe(i[1],l/2);return{cx:r[0],cy:r[1],r0:c,r:u,viewRect:n}}function $2e(e,t,a){a=S2e(a||0);var n=t.width,r=t.height,i=RXe(e.left,n),o=RXe(e.top,r),s=RXe(e.right,n),l=RXe(e.bottom,r),c=RXe(e.width,n),u=RXe(e.height,r),d=a[2]+a[0],h=a[1]+a[3],p=e.aspect;switch(isNaN(c)&&(c=n-s-h-i),isNaN(u)&&(u=r-l-d-o),null!=p&&(isNaN(c)&&isNaN(u)&&(p>n/r?c=.8*n:u=.8*r),isNaN(c)&&(c=p*u),isNaN(u)&&(u=c/p)),isNaN(i)&&(i=n-s-c-h),isNaN(o)&&(o=r-l-u-d),e.left||e.right){case"center":i=n/2-c/2-a[3];break;case"right":i=n-c-h}switch(e.top||e.bottom){case"middle":case"center":o=r/2-u/2-a[0];break;case"bottom":o=r-u-d}i=i||0,o=o||0,isNaN(c)&&(c=n-h-i-(s||0)),isNaN(u)&&(u=r-d-o-(l||0));var f=new fqe((t.x||0)+i+a[3],(t.y||0)+o+a[0],c,u);return f.margin=a,f}function K2e(e,t,a){var n=e.getShallow("preserveAspect",!0);if(!n)return t;var r=t.width/t.height;if(Math.abs(Math.atan(a)-Math.atan(r))<1e-9)return t;var i=e.getShallow("preserveAspectAlign",!0),o=e.getShallow("preserveAspectVerticalAlign",!0),s={width:t.width,height:t.height},l="cover"===n;return r>a&&!l||r<a&&l?(s.width=t.height*a,"left"===i?s.left=0:"right"===i?s.right=0:s.left="center"):(s.height=t.width/a,"top"===o?s.top=0:"bottom"===o?s.bottom=0:s.top="middle"),$2e(s,t)}MGe(q2e,"vertical"),MGe(q2e,"horizontal");var Z2e={rect:1,point:2};function J2e(e,t,a){var n,r,i,o,s=e.boxCoordinateSystem;if(s){var l=function(e){var t=e.getShallow("coord",!0),a=P2e;if(null==t){var n=N2e.get(e.type);n&&n.getCoord2&&(a=L2e,t=n.getCoord2(e))}return{coord:t,from:a}}(e),c=l.coord,u=l.from;if(s.dataToLayout){i=Z2e.rect,o=u;var d=s.dataToLayout(c);n=d.contentRect||d.rect}else a&&a.enableLayoutOnlyByCenter&&s.dataToPoint&&(i=Z2e.point,o=u,r=s.dataToPoint(c))}return null==i&&(i=Z2e.rect),i===Z2e.rect&&(n||(n={x:0,y:0,width:t.getWidth(),height:t.getHeight()}),r=[n.x+n.width/2,n.y+n.height/2]),{type:i,refContainer:n,refPoint:r,boxCoordFrom:o}}function Q2e(e,t,a,n,r,i){var o,s=!r||!r.hv||r.hv[0],l=!r||!r.hv||r.hv[1],c=r&&r.boundingMode||"all";if((i=i||e).x=e.x,i.y=e.y,!s&&!l)return!1;if("raw"===c)o="group"===e.type?new fqe(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(o=e.getBoundingRect(),e.needLocalTransform()){var u=e.getLocalTransform();(o=o.clone()).applyTransform(u)}var d=$2e(pGe({width:o.width,height:o.height},t),a,n),h=s?d.x-o.x:0,p=l?d.y-o.y:0;return"raw"===c?(i.x=h,i.y=p):(i.x+=h,i.y+=p),i===e&&e.markRedraw(),!0}function e5e(e){var t=e.layoutMode||e.constructor.layoutMode;return IGe(t)?t:t?{type:t}:null}function t5e(e,t,a){var n=a&&a.ignoreSize;!TGe(n)&&(n=[n,n]);var r=o(W2e[0],0),i=o(W2e[1],1);function o(a,r){var i={},o=0,l={},c=0;if(H2e(a,function(t){l[t]=e[t]}),H2e(a,function(e){QGe(t,e)&&(i[e]=l[e]=t[e]),s(i,e)&&o++,s(l,e)&&c++}),n[r])return s(t,a[1])?l[a[2]]=null:s(t,a[2])&&(l[a[1]]=null),l;if(2!==c&&o){if(o>=2)return i;for(var u=0;u<a.length;u++){var d=a[u];if(!QGe(i,d)&&QGe(e,d)){i[d]=e[d];break}}return i}return l}function s(e,t){return null!=e[t]&&"auto"!==e[t]}function l(e,t,a){H2e(e,function(e){t[e]=a[e]})}l(W2e[0],e,r),l(W2e[1],e,i)}function a5e(e){return n5e({},e)}function n5e(e,t){return t&&e&&H2e(G2e,function(a){QGe(t,a)&&(e[a]=t[a])}),e}var r5e=v$e(),i5e=function(e){function t(t,a,n){var r=e.call(this,t,a,n)||this;return r.uid=R1e("ec_cpt_model"),r}var a;return zHe(t,e),t.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a)},t.prototype.mergeDefaultAndTheme=function(e,t){var a=e5e(this),n=a?a5e(e):{};uGe(e,t.getTheme().get(this.mainType)),uGe(e,this.getDefaultOption()),a&&t5e(e,n,a)},t.prototype.mergeOption=function(e,t){uGe(this.option,e,!0);var a=e5e(this);a&&t5e(this.option,e,a)},t.prototype.optionUpdated=function(e,t){},t.prototype.getDefaultOption=function(){var e=this.constructor;if(!function(e){return!(!e||!e[E$e])}(e))return e.defaultOption;var t=r5e(this);if(!t.defaultOption){for(var a=[],n=e;n;){var r=n.prototype.defaultOption;r&&a.push(r),n=n.superClass}for(var i={},o=a.length-1;o>=0;o--)i=uGe(i,a[o],!0);t.defaultOption=i}return t.defaultOption},t.prototype.getReferringComponents=function(e,t){var a=e+"Index",n=e+"Id";return _$e(this.ecModel,e,{index:this.get(a,!0),id:this.get(n,!0)},t)},t.prototype.getBoxLayoutParams=function(){return j2e(this,!1)},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(e){this.option.zlevel=e},t.protoInitialize=((a=t.prototype).type="component",a.id="",a.name="",a.mainType="",a.subType="",void(a.componentIndex=0)),t}(E1e);D$e(i5e,E1e),O$e(i5e),function(e){var t={};e.registerSubTypeDefaulter=function(e,a){var n=I$e(e);t[n.main]=a},e.determineSubType=function(a,n){var r=n.type;if(!r){var i=I$e(a).main;e.hasSubTypes(a)&&t[i]&&(r=t[i](n))}return r}}(i5e),function(e,t){function a(e,t){return e[t]||(e[t]={predecessor:[],successor:[]}),e[t]}e.topologicalTravel=function(e,n,r,i){if(e.length){var o=function(e){var n={},r=[];return gGe(e,function(i){var o=a(n,i),s=function(e,t){var a=[];return gGe(e,function(e){fGe(t,e)>=0&&a.push(e)}),a}(o.originalDeps=t(i),e);o.entryCount=s.length,0===o.entryCount&&r.push(i),gGe(s,function(e){fGe(o.predecessor,e)<0&&o.predecessor.push(e);var t=a(n,e);fGe(t.successor,e)<0&&t.successor.push(i)})}),{graph:n,noEntryList:r}}(n),s=o.graph,l=o.noEntryList,c={};for(gGe(e,function(e){c[e]=!0});l.length;){var u=l.pop(),d=s[u],h=!!c[u];h&&(r.call(i,u,d.originalDeps.slice()),delete c[u]),gGe(d.successor,h?f:p)}gGe(c,function(){throw new Error("")})}function p(e){s[e].entryCount--,0===s[e].entryCount&&l.push(e)}function f(e){c[e]=!0,p(e)}}}(i5e,function(e){var t=[];gGe(i5e.getClassesByMainType(e),function(e){t=t.concat(e.dependencies||e.prototype.dependencies||[])}),t=yGe(t,function(e){return I$e(e).main}),"dataset"!==e&&fGe(t,"dataset")<=0&&t.unshift("dataset");return t});var o5e={color:{},darkColor:{},size:{}},s5e=o5e.color={theme:["#5070dd","#b6d634","#505372","#ff994d","#0ca8df","#ffd10a","#fb628b","#785db0","#3fbe95"],neutral00:"#fff",neutral05:"#f4f7fd",neutral10:"#e8ebf0",neutral15:"#dbdee4",neutral20:"#cfd2d7",neutral25:"#c3c5cb",neutral30:"#b7b9be",neutral35:"#aaacb2",neutral40:"#9ea0a5",neutral45:"#929399",neutral50:"#86878c",neutral55:"#797b7f",neutral60:"#6d6e73",neutral65:"#616266",neutral70:"#54555a",neutral75:"#48494d",neutral80:"#3c3c41",neutral85:"#303034",neutral90:"#232328",neutral95:"#17171b",neutral99:"#000",accent05:"#eff1f9",accent10:"#e0e4f2",accent15:"#d0d6ec",accent20:"#c0c9e6",accent25:"#b1bbdf",accent30:"#a1aed9",accent35:"#91a0d3",accent40:"#8292cc",accent45:"#7285c6",accent50:"#6578ba",accent55:"#5c6da9",accent60:"#536298",accent65:"#4a5787",accent70:"#404c76",accent75:"#374165",accent80:"#2e3654",accent85:"#252b43",accent90:"#1b2032",accent95:"#121521",transparent:"rgba(0,0,0,0)",highlight:"rgba(255,231,130,0.8)"};for(var l5e in hGe(s5e,{primary:s5e.neutral80,secondary:s5e.neutral70,tertiary:s5e.neutral60,quaternary:s5e.neutral50,disabled:s5e.neutral20,border:s5e.neutral30,borderTint:s5e.neutral20,borderShade:s5e.neutral40,background:s5e.neutral05,backgroundTint:"rgba(234,237,245,0.5)",backgroundTransparent:"rgba(255,255,255,0)",backgroundShade:s5e.neutral10,shadow:"rgba(0,0,0,0.2)",shadowTint:"rgba(129,130,136,0.2)",axisLine:s5e.neutral70,axisLineTint:s5e.neutral40,axisTick:s5e.neutral70,axisTickMinor:s5e.neutral60,axisLabel:s5e.neutral70,axisSplitLine:s5e.neutral15,axisMinorSplitLine:s5e.neutral05}),s5e)if(s5e.hasOwnProperty(l5e)){var c5e=s5e[l5e];"theme"===l5e?o5e.darkColor.theme=s5e.theme.slice():"highlight"===l5e?o5e.darkColor.highlight="rgba(255,231,130,0.4)":0===l5e.indexOf("accent")?o5e.darkColor[l5e]=PYe(c5e,null,function(e){return.5*e},function(e){return Math.min(1,1.3-e)}):o5e.darkColor[l5e]=PYe(c5e,null,function(e){return.9*e},function(e){return 1-Math.pow(e,1.5)})}o5e.size={xxs:2,xs:5,s:10,m:15,l:20,xl:30,xxl:40,xxxl:50};var u5e="";"undefined"!=typeof navigator&&(u5e=navigator.platform||"");var d5e="rgba(0, 0, 0, 0.2)",h5e=o5e.color.theme[0],p5e=PYe(h5e,null,null,.9);const f5e={darkMode:"auto",colorBy:"series",color:o5e.color.theme,gradientColor:[p5e,h5e],aria:{decal:{decals:[{color:d5e,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:d5e,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:d5e,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:d5e,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:d5e,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:d5e,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:u5e.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var m5e=$Ge(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),v5e="original",g5e="arrayRows",y5e="objectRows",b5e="keyedColumns",x5e="typedArray",w5e="unknown",_5e="column",S5e="row",M5e=1,T5e=2,k5e=3,C5e=v$e();function A5e(e,t,a){var n={},r=I5e(t);if(!r||!e)return n;var i,o,s=[],l=[],c=t.ecModel,u=C5e(c).datasetMap,d=r.uid+"_"+a.seriesLayoutBy;gGe(e=e.slice(),function(t,a){var r=IGe(t)?t:e[a]={name:t};"ordinal"===r.type&&null==i&&(i=a,o=f(r)),n[r.name]=[]});var h=u.get(d)||u.set(d,{categoryWayDim:o,valueWayDim:0});function p(e,t,a){for(var n=0;n<a;n++)e.push(t+n)}function f(e){var t=e.dimsDef;return t?t.length:1}return gGe(e,function(e,t){var a=e.name,r=f(e);if(null==i){var o=h.valueWayDim;p(n[a],o,r),p(l,o,r),h.valueWayDim+=r}else if(i===t)p(n[a],0,r),p(s,0,r);else{o=h.categoryWayDim;p(n[a],o,r),p(l,o,r),h.categoryWayDim+=r}}),s.length&&(n.itemName=s),l.length&&(n.seriesName=l),n}function E5e(e,t,a){var n={};if(!I5e(e))return n;var r,i=t.sourceFormat,o=t.dimensionsDefine;i!==y5e&&i!==b5e||gGe(o,function(e,t){"name"===(IGe(e)?e.name:e)&&(r=t)});var s=function(){for(var e={},n={},s=[],l=0,c=Math.min(5,a);l<c;l++){var u=D5e(t.data,i,t.seriesLayoutBy,o,t.startIndex,l);s.push(u);var d=u===k5e;if(d&&null==e.v&&l!==r&&(e.v=l),(null==e.n||e.n===e.v||!d&&s[e.n]===k5e)&&(e.n=l),h(e)&&s[e.n]!==k5e)return e;d||(u===T5e&&null==n.v&&l!==r&&(n.v=l),null!=n.n&&n.n!==n.v||(n.n=l))}function h(e){return null!=e.v&&null!=e.n}return h(e)?e:h(n)?n:null}();if(s){n.value=[s.v];var l=null!=r?r:s.n;n.itemName=[l],n.seriesName=[l]}return n}function I5e(e){if(!e.get("data",!0))return _$e(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},x$e).models[0]}function R5e(e,t){return D5e(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function D5e(e,t,a,n,r,i){var o,s,l;if(DGe(e))return k5e;if(n){var c=n[i];IGe(c)?(s=c.name,l=c.type):CGe(c)&&(s=c)}if(null!=l)return"ordinal"===l?M5e:k5e;if(t===g5e){var u=e;if(a===S5e){for(var d=u[i],h=0;h<(d||[]).length&&h<5;h++)if(null!=(o=y(d[r+h])))return o}else for(h=0;h<u.length&&h<5;h++){var p=u[r+h];if(p&&null!=(o=y(p[i])))return o}}else if(t===y5e){var f=e;if(!s)return k5e;for(h=0;h<f.length&&h<5;h++){if((v=f[h])&&null!=(o=y(v[s])))return o}}else if(t===b5e){if(!s)return k5e;if(!(d=e[s])||DGe(d))return k5e;for(h=0;h<d.length&&h<5;h++)if(null!=(o=y(d[h])))return o}else if(t===v5e){var m=e;for(h=0;h<m.length&&h<5;h++){var v,g=s$e(v=m[h]);if(!TGe(g))return k5e;if(null!=(o=y(g[i])))return o}}function y(e){var t=CGe(e);return null!=e&&Number.isFinite(Number(e))&&""!==e?t?T5e:k5e:t&&"-"!==e?M5e:void 0}return k5e}var P5e=$Ge();var L5e,N5e,O5e,F5e=v$e(),B5e=v$e(),U5e=function(){function e(){}return e.prototype.getColorFromPalette=function(e,t,a){var n=r$e(this.get("color",!0)),r=this.get("colorLayer",!0);return V5e(this,F5e,n,r,e,t,a)},e.prototype.clearColorPalette=function(){!function(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}(this,F5e)},e}();function z5e(e,t,a,n){var r=r$e(e.get(["aria","decal","decals"]));return V5e(e,B5e,r,null,t,a,n)}function V5e(e,t,a,n,r,i,o){var s=t(i=i||e),l=s.paletteIdx||0,c=s.paletteNameMap=s.paletteNameMap||{};if(c.hasOwnProperty(r))return c[r];var u=null!=o&&n?function(e,t){for(var a=e.length,n=0;n<a;n++)if(e[n].length>t)return e[n];return e[a-1]}(n,o):a;if((u=u||a)&&u.length){var d=u[l];return r&&(c[r]=d),s.paletteIdx=(l+1)%u.length,d}}var H5e="\0_ec_inner",G5e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.init=function(e,t,a,n,r,i){n=n||{},this.option=null,this._theme=new E1e(n),this._locale=new E1e(r),this._optionManager=i},t.prototype.setOption=function(e,t,a){var n=Y5e(t);this._optionManager.setOption(e,a,n),this._resetOption(null,n)},t.prototype.resetOption=function(e,t){return this._resetOption(e,Y5e(t))},t.prototype._resetOption=function(e,t){var a=!1,n=this._optionManager;if(!e||"recreate"===e){var r=n.mountOption("recreate"===e);this.option&&"recreate"!==e?(this.restoreData(),this._mergeOption(r,t)):O5e(this,r),a=!0}if("timeline"!==e&&"media"!==e||this.restoreData(),!e||"recreate"===e||"timeline"===e){var i=n.getTimelineOption(this);i&&(a=!0,this._mergeOption(i,t))}if(!e||"recreate"===e||"media"===e){var o=n.getMediaOption(this);o.length&&gGe(o,function(e){a=!0,this._mergeOption(e,t)},this)}return a},t.prototype.mergeOption=function(e){this._mergeOption(e,null)},t.prototype._mergeOption=function(e,t){var a=this.option,n=this._componentsMap,r=this._componentsCount,i=[],o=$Ge(),s=t&&t.replaceMergeMainTypeMap;C5e(this).datasetMap=$Ge(),gGe(e,function(e,t){null!=e&&(i5e.hasClass(t)?t&&(i.push(t),o.set(t,!0)):a[t]=null==a[t]?cGe(e):uGe(a[t],e,!0))}),s&&s.each(function(e,t){i5e.hasClass(t)&&!o.get(t)&&(i.push(t),o.set(t,!0))}),i5e.topologicalTravel(i,i5e.getAllClassMainTypes(),function(t){var i=function(e,t,a){var n=P5e.get(t);if(!n)return a;var r=n(e);return r?a.concat(r):a}(this,t,r$e(e[t])),o=n.get(t),l=o?s&&s.get(t)?"replaceMerge":"normalMerge":"replaceAll",c=c$e(o,i,l);(function(e,t,a){gGe(e,function(e){var n=e.newOption;IGe(n)&&(e.keyInfo.mainType=t,e.keyInfo.subType=function(e,t,a,n){return t.type?t.type:a?a.subType:n.determineSubType(e,t)}(t,n,e.existing,a))})})(c,t,i5e),a[t]=null,n.set(t,null),r.set(t,0);var u,d=[],h=[],p=0;gGe(c,function(e,a){var n=e.existing,r=e.newOption;if(r){var i="series"===t,o=i5e.getClass(t,e.keyInfo.subType,!i);if(!o)return;if("tooltip"===t){if(u)return;u=!0}if(n&&n.constructor===o)n.name=e.keyInfo.name,n.mergeOption(r,this),n.optionUpdated(r,!1);else{var s=hGe({componentIndex:a},e.keyInfo);hGe(n=new o(r,this,this,s),s),e.brandNew&&(n.__requireNewView=!0),n.init(r,this,this),n.optionUpdated(null,!0)}}else n&&(n.mergeOption({},this),n.optionUpdated({},!1));n?(d.push(n.option),h.push(n),p++):(d.push(void 0),h.push(void 0))},this),a[t]=d,n.set(t,h),r.set(t,p),"series"===t&&L5e(this)},this),this._seriesIndices||L5e(this)},t.prototype.getOption=function(){var e=cGe(this.option);return gGe(e,function(t,a){if(i5e.hasClass(a)){for(var n=r$e(t),r=n.length,i=!1,o=r-1;o>=0;o--)n[o]&&!f$e(n[o])?i=!0:(n[o]=null,!i&&r--);n.length=r,e[a]=n}}),delete e[H5e],e},t.prototype.setTheme=function(e){this._theme=new E1e(e),this._resetOption("recreate",null)},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(e){this._payload=e},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(e,t){var a=this._componentsMap.get(e);if(a){var n=a[t||0];if(n)return n;if(null==t)for(var r=0;r<a.length;r++)if(a[r])return a[r]}},t.prototype.queryComponents=function(e){var t=e.mainType;if(!t)return[];var a,n=e.index,r=e.id,i=e.name,o=this._componentsMap.get(t);return o&&o.length?(null!=n?(a=[],gGe(r$e(n),function(e){o[e]&&a.push(o[e])})):a=null!=r?W5e("id",r,o):null!=i?W5e("name",i,o):xGe(o,function(e){return!!e}),q5e(a,e)):[]},t.prototype.findComponents=function(e){var t,a,n,r,i,o=e.query,s=e.mainType,l=(a=s+"Index",n=s+"Id",r=s+"Name",!(t=o)||null==t[a]&&null==t[n]&&null==t[r]?null:{mainType:s,index:t[a],id:t[n],name:t[r]}),c=l?this.queryComponents(l):xGe(this._componentsMap.get(s),function(e){return!!e});return i=q5e(c,e),e.filter?xGe(i,e.filter):i},t.prototype.eachComponent=function(e,t,a){var n=this._componentsMap;if(kGe(e)){var r=t,i=e;n.each(function(e,t){for(var a=0;e&&a<e.length;a++){var n=e[a];n&&i.call(r,t,n,n.componentIndex)}})}else for(var o=CGe(e)?n.get(e):IGe(e)?this.findComponents(e):null,s=0;o&&s<o.length;s++){var l=o[s];l&&t.call(a,l,l.componentIndex)}},t.prototype.getSeriesByName=function(e){var t=h$e(e,null);return xGe(this._componentsMap.get("series"),function(e){return!!e&&null!=t&&e.name===t})},t.prototype.getSeriesByIndex=function(e){return this._componentsMap.get("series")[e]},t.prototype.getSeriesByType=function(e){return xGe(this._componentsMap.get("series"),function(t){return!!t&&t.subType===e})},t.prototype.getSeries=function(){return xGe(this._componentsMap.get("series"),function(e){return!!e})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(e,t){N5e(this),gGe(this._seriesIndices,function(a){var n=this._componentsMap.get("series")[a];e.call(t,n,a)},this)},t.prototype.eachRawSeries=function(e,t){gGe(this._componentsMap.get("series"),function(a){a&&e.call(t,a,a.componentIndex)})},t.prototype.eachSeriesByType=function(e,t,a){N5e(this),gGe(this._seriesIndices,function(n){var r=this._componentsMap.get("series")[n];r.subType===e&&t.call(a,r,n)},this)},t.prototype.eachRawSeriesByType=function(e,t,a){return gGe(this.getSeriesByType(e),t,a)},t.prototype.isSeriesFiltered=function(e){return N5e(this),null==this._seriesIndicesMap.get(e.componentIndex)},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(e,t){N5e(this);var a=[];gGe(this._seriesIndices,function(n){var r=this._componentsMap.get("series")[n];e.call(t,r,n)&&a.push(n)},this),this._seriesIndices=a,this._seriesIndicesMap=$Ge(a)},t.prototype.restoreData=function(e){L5e(this);var t=this._componentsMap,a=[];t.each(function(e,t){i5e.hasClass(t)&&a.push(t)}),i5e.topologicalTravel(a,i5e.getAllClassMainTypes(),function(a){gGe(t.get(a),function(t){!t||"series"===a&&function(e,t){if(t){var a=t.seriesIndex,n=t.seriesId,r=t.seriesName;return null!=a&&e.componentIndex!==a||null!=n&&e.id!==n||null!=r&&e.name!==r}}(t,e)||t.restoreData()})})},t.internalField=(L5e=function(e){var t=e._seriesIndices=[];gGe(e._componentsMap.get("series"),function(e){e&&t.push(e.componentIndex)}),e._seriesIndicesMap=$Ge(t)},N5e=function(e){},void(O5e=function(e,t){e.option={},e.option[H5e]=1,e._componentsMap=$Ge({series:[]}),e._componentsCount=$Ge();var a=t.aria;IGe(a)&&null==a.enabled&&(a.enabled=!0),function(e,t){var a=e.color&&!e.colorLayer;gGe(t,function(t,n){"colorLayer"===n&&a||"color"===n&&e.color||i5e.hasClass(n)||("object"==typeof t?e[n]=e[n]?uGe(e[n],t,!1):cGe(t):null==e[n]&&(e[n]=t))})}(t,e._theme.option),uGe(t,f5e,!1),e._mergeOption(t,null)})),t}(E1e);function W5e(e,t,a){if(TGe(t)){var n=$Ge();return gGe(t,function(e){null!=e&&(null!=h$e(e,null)&&n.set(e,!0))}),xGe(a,function(t){return t&&n.get(t[e])})}var r=h$e(t,null);return xGe(a,function(t){return t&&null!=r&&t[e]===r})}function q5e(e,t){return t.hasOwnProperty("subType")?xGe(e,function(e){return e&&e.subType===t.subType}):e}function Y5e(e){var t=$Ge();return e&&gGe(r$e(e.replaceMerge),function(e){t.set(e,!0)}),{replaceMergeMainTypeMap:t}}mGe(G5e,U5e);var j5e=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],X5e=function(e){gGe(j5e,function(t){this[t]=SGe(e[t],e)},this)},$5e=/^(min|max)?(.+)$/,K5e=function(){function e(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return e.prototype.setOption=function(e,t,a){e&&(gGe(r$e(e.series),function(e){e&&e.data&&DGe(e.data)&&WGe(e.data)}),gGe(r$e(e.dataset),function(e){e&&e.source&&DGe(e.source)&&WGe(e.source)})),e=cGe(e);var n=this._optionBackup,r=function(e,t,a){var n,r,i=[],o=e.baseOption,s=e.timeline,l=e.options,c=e.media,u=!!e.media,d=!!(l||s||o&&o.timeline);o?(r=o).timeline||(r.timeline=s):((d||u)&&(e.options=e.media=null),r=e);u&&TGe(c)&&gGe(c,function(e){e&&e.option&&(e.query?i.push(e):n||(n=e))});function h(e){gGe(t,function(t){t(e,a)})}return h(r),gGe(l,function(e){return h(e)}),gGe(i,function(e){return h(e.option)}),{baseOption:r,timelineOptions:l||[],mediaDefault:n,mediaList:i}}(e,t,!n);this._newBaseOption=r.baseOption,n?(r.timelineOptions.length&&(n.timelineOptions=r.timelineOptions),r.mediaList.length&&(n.mediaList=r.mediaList),r.mediaDefault&&(n.mediaDefault=r.mediaDefault)):this._optionBackup=r},e.prototype.mountOption=function(e){var t=this._optionBackup;return this._timelineOptions=t.timelineOptions,this._mediaList=t.mediaList,this._mediaDefault=t.mediaDefault,this._currentMediaIndices=[],cGe(e?t.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(e){var t,a=this._timelineOptions;if(a.length){var n=e.getComponent("timeline");n&&(t=cGe(a[n.getCurrentIndex()]))}return t},e.prototype.getMediaOption=function(e){var t,a,n=this._api.getWidth(),r=this._api.getHeight(),i=this._mediaList,o=this._mediaDefault,s=[],l=[];if(!i.length&&!o)return l;for(var c=0,u=i.length;c<u;c++)Z5e(i[c].query,n,r)&&s.push(c);return!s.length&&o&&(s=[-1]),s.length&&(t=s,a=this._currentMediaIndices,t.join(",")!==a.join(","))&&(l=yGe(s,function(e){return cGe(-1===e?o.option:i[e].option)})),this._currentMediaIndices=s,l},e}();function Z5e(e,t,a){var n={width:t,height:a,aspectratio:t/a},r=!0;return gGe(e,function(e,t){var a=t.match($5e);if(a&&a[1]&&a[2]){var i=a[1],o=a[2].toLowerCase();(function(e,t,a){return"min"===a?e>=t:"max"===a?e<=t:e===t})(n[o],e,i)||(r=!1)}}),r}var J5e=gGe,Q5e=IGe,e4e=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function t4e(e){var t=e&&e.itemStyle;if(t)for(var a=0,n=e4e.length;a<n;a++){var r=e4e[a],i=t.normal,o=t.emphasis;i&&i[r]&&(e[r]=e[r]||{},e[r].normal?uGe(e[r].normal,i[r]):e[r].normal=i[r],i[r]=null),o&&o[r]&&(e[r]=e[r]||{},e[r].emphasis?uGe(e[r].emphasis,o[r]):e[r].emphasis=o[r],o[r]=null)}}function a4e(e,t,a){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,r=e[t].emphasis;n&&(a?(e[t].normal=e[t].emphasis=null,pGe(e[t],n)):e[t]=n),r&&(e.emphasis=e.emphasis||{},e.emphasis[t]=r,r.focus&&(e.emphasis.focus=r.focus),r.blurScope&&(e.emphasis.blurScope=r.blurScope))}}function n4e(e){a4e(e,"itemStyle"),a4e(e,"lineStyle"),a4e(e,"areaStyle"),a4e(e,"label"),a4e(e,"labelLine"),a4e(e,"upperLabel"),a4e(e,"edgeLabel")}function r4e(e,t){var a=Q5e(e)&&e[t],n=Q5e(a)&&a.textStyle;if(n)for(var r=0,i=o$e.length;r<i;r++){var o=o$e[r];n.hasOwnProperty(o)&&(a[o]=n[o])}}function i4e(e){e&&(n4e(e),r4e(e,"label"),e.emphasis&&r4e(e.emphasis,"label"))}function o4e(e){return TGe(e)?e:e?[e]:[]}function s4e(e){return(TGe(e)?e[0]:e)||{}}function l4e(e,t){J5e(o4e(e.series),function(e){Q5e(e)&&function(e){if(Q5e(e)){t4e(e),n4e(e),r4e(e,"label"),r4e(e,"upperLabel"),r4e(e,"edgeLabel"),e.emphasis&&(r4e(e.emphasis,"label"),r4e(e.emphasis,"upperLabel"),r4e(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(t4e(t),i4e(t));var a=e.markLine;a&&(t4e(a),i4e(a));var n=e.markArea;n&&i4e(n);var r=e.data;if("graph"===e.type){r=r||e.nodes;var i=e.links||e.edges;if(i&&!DGe(i))for(var o=0;o<i.length;o++)i4e(i[o]);gGe(e.categories,function(e){n4e(e)})}if(r&&!DGe(r))for(o=0;o<r.length;o++)i4e(r[o]);if((t=e.markPoint)&&t.data){var s=t.data;for(o=0;o<s.length;o++)i4e(s[o])}if((a=e.markLine)&&a.data){var l=a.data;for(o=0;o<l.length;o++)TGe(l[o])?(i4e(l[o][0]),i4e(l[o][1])):i4e(l[o])}"gauge"===e.type?(r4e(e,"axisLabel"),r4e(e,"title"),r4e(e,"detail")):"treemap"===e.type?(a4e(e.breadcrumb,"itemStyle"),gGe(e.levels,function(e){n4e(e)})):"tree"===e.type&&n4e(e.leaves)}}(e)});var a=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&a.push("valueAxis","categoryAxis","logAxis","timeAxis"),J5e(a,function(t){J5e(o4e(e[t]),function(e){e&&(r4e(e,"axisLabel"),r4e(e.axisPointer,"label"))})}),J5e(o4e(e.parallel),function(e){var t=e&&e.parallelAxisDefault;r4e(t,"axisLabel"),r4e(t&&t.axisPointer,"label")}),J5e(o4e(e.calendar),function(e){a4e(e,"itemStyle"),r4e(e,"dayLabel"),r4e(e,"monthLabel"),r4e(e,"yearLabel")}),J5e(o4e(e.radar),function(e){r4e(e,"name"),e.name&&null==e.axisName&&(e.axisName=e.name,delete e.name),null!=e.nameGap&&null==e.axisNameGap&&(e.axisNameGap=e.nameGap,delete e.nameGap)}),J5e(o4e(e.geo),function(e){Q5e(e)&&(i4e(e),J5e(o4e(e.regions),function(e){i4e(e)}))}),J5e(o4e(e.timeline),function(e){i4e(e),a4e(e,"label"),a4e(e,"itemStyle"),a4e(e,"controlStyle",!0);var t=e.data;TGe(t)&&gGe(t,function(e){IGe(e)&&(a4e(e,"label"),a4e(e,"itemStyle"))})}),J5e(o4e(e.toolbox),function(e){a4e(e,"iconStyle"),J5e(e.feature,function(e){a4e(e,"iconStyle")})}),r4e(s4e(e.axisPointer),"label"),r4e(s4e(e.tooltip).axisPointer,"label")}function c4e(e){e&&gGe(u4e,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var u4e=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],d4e=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],h4e=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function p4e(e){var t=e&&e.itemStyle;if(t)for(var a=0;a<h4e.length;a++){var n=h4e[a][1],r=h4e[a][0];null!=t[n]&&(t[r]=t[n])}}function f4e(e){e&&"edge"===e.alignTo&&null!=e.margin&&null==e.edgeDistance&&(e.edgeDistance=e.margin)}function m4e(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function v4e(e,t){if(e)for(var a=0;a<e.length;a++)t(e[a]),e[a]&&v4e(e[a].children,t)}function g4e(e,t){l4e(e,t),e.series=r$e(e.series),gGe(e.series,function(e){if(IGe(e)){var t=e.type;if("line"===t)null!=e.clipOverflow&&(e.clip=e.clipOverflow);else if("pie"===t||"gauge"===t){if(null!=e.clockWise&&(e.clockwise=e.clockWise),f4e(e.label),(r=e.data)&&!DGe(r))for(var a=0;a<r.length;a++)f4e(r[a]);null!=e.hoverOffset&&(e.emphasis=e.emphasis||{},(e.emphasis.scaleSize=null)&&(e.emphasis.scaleSize=e.hoverOffset))}else if("gauge"===t){var n=function(e,t){for(var a=t.split(","),n=e,r=0;r<a.length&&null!=(n=n&&n[a[r]]);r++);return n}(e,"pointer.color");null!=n&&function(e,t,a){for(var n,r=t.split(","),i=e,o=0;o<r.length-1;o++)null==i[n=r[o]]&&(i[n]={}),i=i[n];null==i[r[o]]&&(i[r[o]]=a)}(e,"itemStyle.color",n)}else if("bar"===t){var r;if(p4e(e),p4e(e.backgroundStyle),p4e(e.emphasis),(r=e.data)&&!DGe(r))for(a=0;a<r.length;a++)"object"==typeof r[a]&&(p4e(r[a]),p4e(r[a]&&r[a].emphasis))}else if("sunburst"===t){var i=e.highlightPolicy;i&&(e.emphasis=e.emphasis||{},e.emphasis.focus||(e.emphasis.focus=i)),m4e(e),v4e(e.data,m4e)}else"graph"===t||"sankey"===t?function(e){e&&null!=e.focusNodeAdjacency&&(e.emphasis=e.emphasis||{},null==e.emphasis.focus&&(e.emphasis.focus="adjacency"))}(e):"map"===t&&(e.mapType&&!e.map&&(e.map=e.mapType),e.mapLocation&&pGe(e,e.mapLocation));null!=e.hoverAnimation&&(e.emphasis=e.emphasis||{},e.emphasis&&null==e.emphasis.scale&&(e.emphasis.scale=e.hoverAnimation)),c4e(e)}}),e.dataRange&&(e.visualMap=e.dataRange),gGe(d4e,function(t){var a=e[t];a&&(TGe(a)||(a=[a]),gGe(a,function(e){c4e(e)}))})}var y4e,b4e,x4e,w4e,_4e,S4e,M4e=function(){return function(e){this.data=e.data||(e.sourceFormat===b5e?{}:[]),this.sourceFormat=e.sourceFormat||w5e,this.seriesLayoutBy=e.seriesLayoutBy||_5e,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var t=this.dimensionsDefine=e.dimensionsDefine;if(t)for(var a=0;a<t.length;a++){var n=t[a];null==n.type&&R5e(this,a)===M5e&&(n.type="ordinal")}}}();function T4e(e){return e instanceof M4e}function k4e(e,t,a){a=a||A4e(e);var n=t.seriesLayoutBy,r=function(e,t,a,n,r){var i,o;if(!e)return{dimensionsDefine:E4e(r),startIndex:o,dimensionsDetectedCount:i};if(t===g5e){var s=e;"auto"===n||null==n?I4e(function(e){null!=e&&"-"!==e&&(CGe(e)?null==o&&(o=1):o=0)},a,s,10):o=EGe(n)?n:n?1:0,r||1!==o||(r=[],I4e(function(e,t){r[t]=null!=e?e+"":""},a,s,1/0)),i=r?r.length:a===S5e?s.length:s[0]?s[0].length:null}else if(t===y5e)r||(r=function(e){var t,a=0;for(;a<e.length&&!(t=e[a++]););if(t)return _Ge(t)}(e));else if(t===b5e)r||(r=[],gGe(e,function(e,t){r.push(t)}));else if(t===v5e){var l=s$e(e[0]);i=TGe(l)&&l.length||1}return{startIndex:o,dimensionsDefine:E4e(r),dimensionsDetectedCount:i}}(e,a,n,t.sourceHeader,t.dimensions);return new M4e({data:e,sourceFormat:a,seriesLayoutBy:n,dimensionsDefine:r.dimensionsDefine,startIndex:r.startIndex,dimensionsDetectedCount:r.dimensionsDetectedCount,metaRawOption:cGe(t)})}function C4e(e){return new M4e({data:e,sourceFormat:DGe(e)?x5e:v5e})}function A4e(e){var t=w5e;if(DGe(e))t=x5e;else if(TGe(e)){0===e.length&&(t=g5e);for(var a=0,n=e.length;a<n;a++){var r=e[a];if(null!=r){if(TGe(r)||DGe(r)){t=g5e;break}if(IGe(r)){t=y5e;break}}}}else if(IGe(e))for(var i in e)if(QGe(e,i)&&vGe(e[i])){t=b5e;break}return t}function E4e(e){if(e){var t=$Ge();return yGe(e,function(e,a){var n={name:(e=IGe(e)?e:{name:e}).name,displayName:e.displayName,type:e.type};if(null==n.name)return n;n.name+="",null==n.displayName&&(n.displayName=n.name);var r=t.get(n.name);return r?n.name+="-"+r.count++:t.set(n.name,{count:1}),n})}}function I4e(e,t,a,n){if(t===S5e)for(var r=0;r<a.length&&r<n;r++)e(a[r]?a[r][0]:null,r);else{var i=a[0]||[];for(r=0;r<i.length&&r<n;r++)e(i[r],r)}}function R4e(e){var t=e.sourceFormat;return t===y5e||t===b5e}var D4e=function(){function e(e,t){var a=T4e(e)?e:C4e(e);this._source=a;var n=this._data=a.data,r=a.sourceFormat;a.seriesLayoutBy,r===x5e&&(this._offset=0,this._dimSize=t,this._data=n),S4e(this,n,a)}var t;return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(e,t){},e.prototype.appendData=function(e){},e.prototype.clean=function(){},e.protoInitialize=((t=e.prototype).pure=!1,void(t.persistent=!0)),e.internalField=function(){var e;S4e=function(e,r,i){var o=i.sourceFormat,s=i.seriesLayoutBy,l=i.startIndex,c=i.dimensionsDefine;if(hGe(e,_4e[G4e(o,s)]),o===x5e)e.getItem=t,e.count=n,e.fillStorage=a;else{var u=O4e(o,s);e.getItem=SGe(u,null,r,l,c);var d=U4e(o,s);e.count=SGe(d,null,r,l,c)}};var t=function(e,t){e-=this._offset,t=t||[];for(var a=this._data,n=this._dimSize,r=n*e,i=0;i<n;i++)t[i]=a[r+i];return t},a=function(e,t,a,n){for(var r=this._data,i=this._dimSize,o=0;o<i;o++){for(var s=n[o],l=null==s[0]?1/0:s[0],c=null==s[1]?-1/0:s[1],u=t-e,d=a[o],h=0;h<u;h++){var p=r[h*i+o];d[e+h]=p,p<l&&(l=p),p>c&&(c=p)}s[0]=l,s[1]=c}},n=function(){return this._data?this._data.length/this._dimSize:0};function r(e){for(var t=0;t<e.length;t++)this._data.push(e[t])}(e={})[g5e+"_"+_5e]={pure:!0,appendData:r},e[g5e+"_"+S5e]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e[y5e]={pure:!0,appendData:r},e[b5e]={pure:!0,appendData:function(e){var t=this._data;gGe(e,function(e,a){for(var n=t[a]||(t[a]=[]),r=0;r<(e||[]).length;r++)n.push(e[r])})}},e[v5e]={appendData:r},e[x5e]={persistent:!1,pure:!0,appendData:function(e){this._data=e},clean:function(){this._offset+=this.count(),this._data=null}},_4e=e}(),e}(),P4e=function(e){TGe(e)||QXe("series.data or dataset.source must be an array.")};(y4e={})[g5e+"_"+_5e]=P4e,y4e[g5e+"_"+S5e]=P4e,y4e[y5e]=P4e,y4e[b5e]=function(e,t){for(var a=0;a<t.length;a++){null==t[a].name&&QXe("dimension name must not be null/undefined.")}},y4e[v5e]=P4e;var L4e=function(e,t,a,n){return e[n]},N4e=((b4e={})[g5e+"_"+_5e]=function(e,t,a,n){return e[n+t]},b4e[g5e+"_"+S5e]=function(e,t,a,n,r){n+=t;for(var i=r||[],o=e,s=0;s<o.length;s++){var l=o[s];i[s]=l?l[n]:null}return i},b4e[y5e]=L4e,b4e[b5e]=function(e,t,a,n,r){for(var i=r||[],o=0;o<a.length;o++){var s=a[o].name,l=null!=s?e[s]:null;i[o]=l?l[n]:null}return i},b4e[v5e]=L4e,b4e);function O4e(e,t){return N4e[G4e(e,t)]}var F4e=function(e,t,a){return e.length},B4e=((x4e={})[g5e+"_"+_5e]=function(e,t,a){return Math.max(0,e.length-t)},x4e[g5e+"_"+S5e]=function(e,t,a){var n=e[0];return n?Math.max(0,n.length-t):0},x4e[y5e]=F4e,x4e[b5e]=function(e,t,a){var n=a[0].name,r=null!=n?e[n]:null;return r?r.length:0},x4e[v5e]=F4e,x4e);function U4e(e,t){return B4e[G4e(e,t)]}var z4e=function(e,t,a){return e[t]},V4e=((w4e={})[g5e]=z4e,w4e[y5e]=function(e,t,a){return e[a]},w4e[b5e]=z4e,w4e[v5e]=function(e,t,a){var n=s$e(e);return n instanceof Array?n[t]:n},w4e[x5e]=z4e,w4e);function H4e(e){return V4e[e]}function G4e(e,t){return e===g5e?e+"_"+t:e}function W4e(e,t,a){if(e){var n=e.getRawDataItem(t);if(null!=n){var r=e.getStore(),i=r.getSource().sourceFormat;if(null!=a){var o=e.getDimensionIndex(a),s=r.getDimensionProperty(o);return H4e(i)(n,o,s)}var l=n;return i===v5e&&(l=s$e(n)),l}}}var q4e=/\{@(.+?)\}/g,Y4e=function(){function e(){}return e.prototype.getDataParams=function(e,t){var a=this.getData(t),n=this.getRawValue(e,t),r=a.getRawIndex(e),i=a.getName(e),o=a.getRawDataItem(e),s=a.getItemVisual(e,"style"),l=s&&s[a.getItemVisual(e,"drawType")||"fill"],c=s&&s.stroke,u=this.mainType,d="series"===u,h=a.userOutput&&a.userOutput.get();return{componentType:u,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:d?this.subType:null,seriesIndex:this.seriesIndex,seriesId:d?this.id:null,seriesName:d?this.name:null,name:i,dataIndex:r,data:o,dataType:t,value:n,color:l,borderColor:c,dimensionNames:h?h.fullDimensions:null,encode:h?h.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(e,t,a,n,r,i){t=t||"normal";var o=this.getData(a),s=this.getDataParams(e,a);(i&&(s.value=i.interpolatedValue),null!=n&&TGe(s.value)&&(s.value=s.value[n]),r)||(r=o.getItemModel(e).get("normal"===t?["label","formatter"]:[t,"label","formatter"]));return kGe(r)?(s.status=t,s.dimensionIndex=n,r(s)):CGe(r)?C2e(r,s).replace(q4e,function(t,a){var n=a.length,r=a;"["===r.charAt(0)&&"]"===r.charAt(n-1)&&(r=+r.slice(1,n-1));var s=W4e(o,e,r);if(i&&TGe(i.interpolatedValue)){var l=o.getDimensionIndex(r);l>=0&&(s=i.interpolatedValue[l])}return null!=s?s+"":""}):void 0},e.prototype.getRawValue=function(e,t){return W4e(this.getData(t),e)},e.prototype.formatTooltip=function(e,t,a){},e}();function j4e(e){var t,a;return IGe(e)?e.type&&(a=e):t=e,{text:t,frag:a}}function X4e(e){return new $4e(e)}var $4e=function(){function e(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return e.prototype.perform=function(e){var t,a=this._upstream,n=e&&e.skip;if(this._dirty&&a){var r=this.context;r.data=r.outputData=a.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!n&&(t=this._plan(this.context));var i,o=u(this._modBy),s=this._modDataCount||0,l=u(e&&e.modBy),c=e&&e.modDataCount||0;function u(e){return!(e>=1)&&(e=1),e}o===l&&s===c||(t="reset"),(this._dirty||"reset"===t)&&(this._dirty=!1,i=this._doReset(n)),this._modBy=l,this._modDataCount=c;var d=e&&e.step;if(this._dueEnd=a?a._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var h=this._dueIndex,p=Math.min(null!=d?this._dueIndex+d:1/0,this._dueEnd);if(!n&&(i||h<p)){var f=this._progress;if(TGe(f))for(var m=0;m<f.length;m++)this._doProgress(f[m],h,p,l,c);else this._doProgress(f,h,p,l,c)}this._dueIndex=p;var v=null!=this._settedOutputEnd?this._settedOutputEnd:p;this._outputDueEnd=v}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(e,t,a,n,r){K4e.reset(t,a,n,r),this._callingProgress=e,this._callingProgress({start:t,end:a,count:a-t,next:K4e.next},this.context)},e.prototype._doReset=function(e){var t,a;this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null,!e&&this._reset&&((t=this._reset(this.context))&&t.progress&&(a=t.forceFirstProgress,t=t.progress),TGe(t)&&!t.length&&(t=null)),this._progress=t,this._modBy=this._modDataCount=null;var n=this._downstream;return n&&n.dirty(),a},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},e}(),K4e=function(){var e,t,a,n,r,i={reset:function(l,c,u,d){t=l,e=c,a=u,n=d,r=Math.ceil(n/a),i.next=a>1&&n>0?s:o}};return i;function o(){return t<e?t++:null}function s(){var i=t%r*a+Math.ceil(t/r),o=t>=e?null:i<n?i:t;return t++,o}}();function Z4e(e,t){var a=t&&t.type;return"ordinal"===a?e:("time"!==a||EGe(e)||null==e||"-"===e||(e=+HXe(e)),null==e||""===e?NaN:Number(e))}var J4e=$Ge({number:function(e){return parseFloat(e)},time:function(e){return+HXe(e)},trim:function(e){return CGe(e)?HGe(e):e}});function Q4e(e){return J4e.get(e)}var e3e={lt:function(e,t){return e<t},lte:function(e,t){return e<=t},gt:function(e,t){return e>t},gte:function(e,t){return e>=t}},t3e=function(){function e(e,t){if(!EGe(t)){e$e("")}this._opFn=e3e[e],this._rvalFloat=jXe(t)}return e.prototype.evaluate=function(e){return EGe(e)?this._opFn(e,this._rvalFloat):this._opFn(jXe(e),this._rvalFloat)},e}(),a3e=function(){function e(e,t){var a="desc"===e;this._resultLT=a?1:-1,null==t&&(t=a?"min":"max"),this._incomparable="min"===t?-1/0:1/0}return e.prototype.evaluate=function(e,t){var a=EGe(e)?e:jXe(e),n=EGe(t)?t:jXe(t),r=isNaN(a),i=isNaN(n);if(r&&(a=this._incomparable),i&&(n=this._incomparable),r&&i){var o=CGe(e),s=CGe(t);o&&(a=s?e:0),s&&(n=o?t:0)}return a<n?this._resultLT:a>n?-this._resultLT:0},e}(),n3e=function(){function e(e,t){this._rval=t,this._isEQ=e,this._rvalTypeof=typeof t,this._rvalFloat=jXe(t)}return e.prototype.evaluate=function(e){var t=e===this._rval;if(!t){var a=typeof e;a===this._rvalTypeof||"number"!==a&&"number"!==this._rvalTypeof||(t=jXe(e)===this._rvalFloat)}return this._isEQ?t:!t},e}();function r3e(e,t){return"eq"===e||"ne"===e?new n3e("eq"===e,t):QGe(e3e,e)?new t3e(e,t):null}var i3e=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(e){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(e){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(e,t){},e.prototype.retrieveValueFromItem=function(e,t){},e.prototype.convertValue=function(e,t){return Z4e(e,t)},e}();function o3e(e){if(!h3e(e.sourceFormat)){e$e("")}return e.data}function s3e(e){var t=e.sourceFormat,a=e.data;if(!h3e(t)){e$e("")}if(t===g5e){for(var n=[],r=0,i=a.length;r<i;r++)n.push(a[r].slice());return n}if(t===y5e){for(n=[],r=0,i=a.length;r<i;r++)n.push(hGe({},a[r]));return n}}function l3e(e,t,a){if(null!=a)return EGe(a)||!isNaN(a)&&!QGe(t,a)?e[a]:QGe(t,a)?t[a]:void 0}function c3e(e){return cGe(e)}var u3e=$Ge();function d3e(e,t,a,n){t.length||e$e(""),IGe(e)||e$e("");var r=e.type,i=u3e.get(r);i||e$e("");var o=yGe(t,function(e){return function(e,t){var a=new i3e,n=e.data,r=a.sourceFormat=e.sourceFormat,i=e.startIndex;e.seriesLayoutBy!==_5e&&e$e("");var o=[],s={},l=e.dimensionsDefine;if(l)gGe(l,function(e,t){var a=e.name,n={index:t,name:a,displayName:e.displayName};o.push(n),null!=a&&(QGe(s,a)&&e$e(""),s[a]=n)});else for(var c=0;c<e.dimensionsDetectedCount;c++)o.push({index:c});var u=O4e(r,_5e);t.__isBuiltIn&&(a.getRawDataItem=function(e){return u(n,i,o,e)},a.getRawData=SGe(o3e,null,e)),a.cloneRawData=SGe(s3e,null,e);var d=U4e(r,_5e);a.count=SGe(d,null,n,i,o);var h=H4e(r);a.retrieveValue=function(e,t){var a=u(n,i,o,e);return p(a,t)};var p=a.retrieveValueFromItem=function(e,t){if(null!=e){var a=o[t];return a?h(e,t,a.name):void 0}};return a.getDimensionInfo=SGe(l3e,null,o,s),a.cloneAllDimensionInfo=SGe(c3e,null,o),a}(e,i)});return yGe(r$e(i.transform({upstream:o[0],upstreamList:o,config:cGe(e.config)})),function(e,a){var n;IGe(e)||e$e(""),e.data||e$e(""),h3e(A4e(e.data))||e$e("");var r=t[0];if(r&&0===a&&!e.dimensions){var i=r.startIndex;i&&(e.data=r.data.slice(0,i).concat(e.data)),n={seriesLayoutBy:_5e,sourceHeader:i,dimensions:r.metaRawOption.dimensions}}else n={seriesLayoutBy:_5e,sourceHeader:0,dimensions:e.dimensions};return k4e(e.data,n,null)})}function h3e(e){return e===g5e||e===y5e}var p3e,f3e="undefined",m3e=typeof Uint32Array===f3e?Array:Uint32Array,v3e=typeof Uint16Array===f3e?Array:Uint16Array,g3e=typeof Int32Array===f3e?Array:Int32Array,y3e=typeof Float64Array===f3e?Array:Float64Array,b3e={float:y3e,int:g3e,ordinal:Array,number:Array,time:y3e};function x3e(e){return e>65535?m3e:v3e}function w3e(){return[1/0,-1/0]}function _3e(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function S3e(e,t,a,n,r){var i=b3e[a||"float"];if(r){var o=e[t],s=o&&o.length;if(s!==n){for(var l=new i(n),c=0;c<s;c++)l[c]=o[c];e[t]=l}}else e[t]=new i(n)}var M3e=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=$Ge()}return e.prototype.initData=function(e,t,a){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var n=e.getSource(),r=this.defaultDimValueGetter=p3e[n.sourceFormat];this._dimValueGetter=a||r,this._rawExtent=[],R4e(n),this._dimensions=yGe(t,function(e){return{type:e.type,property:e.property}}),this._initDataFromProvider(0,e.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(e,t){var a=this._calcDimNameToIdx,n=this._dimensions,r=a.get(e);if(null!=r){if(n[r].type===t)return r}else r=n.length;return n[r]={type:t},a.set(e,r),this._chunks[r]=new b3e[t||"float"](this._rawCount),this._rawExtent[r]=[1/0,-1/0],r},e.prototype.collectOrdinalMeta=function(e,t){var a=this._chunks[e],n=this._dimensions[e],r=this._rawExtent,i=n.ordinalOffset||0,o=a.length;0===i&&(r[e]=[1/0,-1/0]);for(var s=r[e],l=i;l<o;l++){var c=a[l]=t.parseAndCollect(a[l]);isNaN(c)||(s[0]=Math.min(c,s[0]),s[1]=Math.max(c,s[1]))}n.ordinalMeta=t,n.ordinalOffset=o,n.type="ordinal"},e.prototype.getOrdinalMeta=function(e){return this._dimensions[e].ordinalMeta},e.prototype.getDimensionProperty=function(e){var t=this._dimensions[e];return t&&t.property},e.prototype.appendData=function(e){var t=this._provider,a=this.count();t.appendData(e);var n=t.count();return t.persistent||(n+=a),a<n&&this._initDataFromProvider(a,n,!0),[a,n]},e.prototype.appendValues=function(e,t){for(var a=this._chunks,n=this._dimensions,r=n.length,i=this._rawExtent,o=this.count(),s=o+Math.max(e.length,t||0),l=0;l<r;l++){S3e(a,l,(p=n[l]).type,s,!0)}for(var c=[],u=o;u<s;u++)for(var d=u-o,h=0;h<r;h++){var p=n[h],f=p3e.arrayRows.call(this,e[d]||c,p.property,d,h);a[h][u]=f;var m=i[h];f<m[0]&&(m[0]=f),f>m[1]&&(m[1]=f)}return this._rawCount=this._count=s,{start:o,end:s}},e.prototype._initDataFromProvider=function(e,t,a){for(var n=this._provider,r=this._chunks,i=this._dimensions,o=i.length,s=this._rawExtent,l=yGe(i,function(e){return e.property}),c=0;c<o;c++){var u=i[c];s[c]||(s[c]=w3e()),S3e(r,c,u.type,t,a)}if(n.fillStorage)n.fillStorage(e,t,r,s);else for(var d=[],h=e;h<t;h++){d=n.getItem(h,d);for(var p=0;p<o;p++){var f=r[p],m=this._dimValueGetter(d,l[p],h,p);f[h]=m;var v=s[p];m<v[0]&&(v[0]=m),m>v[1]&&(v[1]=m)}}!n.persistent&&n.clean&&n.clean(),this._rawCount=this._count=t,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var a=this._chunks[e];return a?a[this.getRawIndex(t)]:NaN},e.prototype.getValues=function(e,t){var a=[],n=[];if(null==t){t=e,e=[];for(var r=0;r<this._dimensions.length;r++)n.push(r)}else n=e;r=0;for(var i=n.length;r<i;r++)a.push(this.get(n[r],t));return a},e.prototype.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var a=this._chunks[e];return a?a[t]:NaN},e.prototype.getSum=function(e){var t=0;if(this._chunks[e])for(var a=0,n=this.count();a<n;a++){var r=this.get(e,a);isNaN(r)||(t+=r)}return t},e.prototype.getMedian=function(e){var t=[];this.each([e],function(e){isNaN(e)||t.push(e)});var a=t.sort(function(e,t){return e-t}),n=this.count();return 0===n?0:n%2==1?a[(n-1)/2]:(a[n/2]+a[n/2-1])/2},e.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,a=t[e];if(null!=a&&a<this._count&&a===e)return e;for(var n=0,r=this._count-1;n<=r;){var i=(n+r)/2|0;if(t[i]<e)n=i+1;else{if(!(t[i]>e))return i;r=i-1}}return-1},e.prototype.getIndices=function(){var e,t=this._indices;if(t){var a=t.constructor,n=this._count;if(a===Array){e=new a(n);for(var r=0;r<n;r++)e[r]=t[r]}else e=new a(t.buffer,0,n)}else{e=new(a=x3e(this._rawCount))(this.count());for(r=0;r<e.length;r++)e[r]=r}return e},e.prototype.filter=function(e,t){if(!this._count)return this;for(var a=this.clone(),n=a.count(),r=new(x3e(a._rawCount))(n),i=[],o=e.length,s=0,l=e[0],c=a._chunks,u=0;u<n;u++){var d=void 0,h=a.getRawIndex(u);if(0===o)d=t(u);else if(1===o){d=t(c[l][h],u)}else{for(var p=0;p<o;p++)i[p]=c[e[p]][h];i[p]=u,d=t.apply(null,i)}d&&(r[s++]=h)}return s<n&&(a._indices=r),a._count=s,a._extent=[],a._updateGetRawIdx(),a},e.prototype.selectRange=function(e){var t=this.clone(),a=t._count;if(!a)return this;var n=_Ge(e),r=n.length;if(!r)return this;var i=t.count(),o=new(x3e(t._rawCount))(i),s=0,l=n[0],c=e[l][0],u=e[l][1],d=t._chunks,h=!1;if(!t._indices){var p=0;if(1===r){for(var f=d[n[0]],m=0;m<a;m++){((b=f[m])>=c&&b<=u||isNaN(b))&&(o[s++]=p),p++}h=!0}else if(2===r){f=d[n[0]];var v=d[n[1]],g=e[n[1]][0],y=e[n[1]][1];for(m=0;m<a;m++){var b=f[m],x=v[m];(b>=c&&b<=u||isNaN(b))&&(x>=g&&x<=y||isNaN(x))&&(o[s++]=p),p++}h=!0}}if(!h)if(1===r)for(m=0;m<i;m++){var w=t.getRawIndex(m);((b=d[n[0]][w])>=c&&b<=u||isNaN(b))&&(o[s++]=w)}else for(m=0;m<i;m++){for(var _=!0,S=(w=t.getRawIndex(m),0);S<r;S++){var M=n[S];((b=d[M][w])<e[M][0]||b>e[M][1])&&(_=!1)}_&&(o[s++]=t.getRawIndex(m))}return s<i&&(t._indices=o),t._count=s,t._extent=[],t._updateGetRawIdx(),t},e.prototype.map=function(e,t){var a=this.clone(e);return this._updateDims(a,e,t),a},e.prototype.modify=function(e,t){this._updateDims(this,e,t)},e.prototype._updateDims=function(e,t,a){for(var n=e._chunks,r=[],i=t.length,o=e.count(),s=[],l=e._rawExtent,c=0;c<t.length;c++)l[t[c]]=w3e();for(var u=0;u<o;u++){for(var d=e.getRawIndex(u),h=0;h<i;h++)s[h]=n[t[h]][d];s[i]=u;var p=a&&a.apply(null,s);if(null!=p){"object"!=typeof p&&(r[0]=p,p=r);for(c=0;c<p.length;c++){var f=t[c],m=p[c],v=l[f],g=n[f];g&&(g[d]=m),m<v[0]&&(v[0]=m),m>v[1]&&(v[1]=m)}}}},e.prototype.lttbDownSample=function(e,t){var a,n,r,i=this.clone([e],!0),o=i._chunks[e],s=this.count(),l=0,c=Math.floor(1/t),u=this.getRawIndex(0),d=new(x3e(this._rawCount))(Math.min(2*(Math.ceil(s/c)+2),s));d[l++]=u;for(var h=1;h<s-1;h+=c){for(var p=Math.min(h+c,s-1),f=Math.min(h+2*c,s),m=(f+p)/2,v=0,g=p;g<f;g++){var y=o[T=this.getRawIndex(g)];isNaN(y)||(v+=y)}v/=f-p;var b=h,x=Math.min(h+c,s),w=h-1,_=o[u];a=-1,r=b;var S=-1,M=0;for(g=b;g<x;g++){var T;y=o[T=this.getRawIndex(g)];isNaN(y)?(M++,S<0&&(S=T)):(n=Math.abs((w-m)*(y-_)-(w-g)*(v-_)))>a&&(a=n,r=T)}M>0&&M<x-b&&(d[l++]=Math.min(S,r),r=Math.max(S,r)),d[l++]=r,u=r}return d[l++]=this.getRawIndex(s-1),i._count=l,i._indices=d,i.getRawIndex=this._getRawIdx,i},e.prototype.minmaxDownSample=function(e,t){for(var a=this.clone([e],!0),n=a._chunks,r=Math.floor(1/t),i=n[e],o=this.count(),s=new(x3e(this._rawCount))(2*Math.ceil(o/r)),l=0,c=0;c<o;c+=r){var u=c,d=i[this.getRawIndex(u)],h=c,p=i[this.getRawIndex(h)],f=r;c+r>o&&(f=o-c);for(var m=0;m<f;m++){var v=i[this.getRawIndex(c+m)];v<d&&(d=v,u=c+m),v>p&&(p=v,h=c+m)}var g=this.getRawIndex(u),y=this.getRawIndex(h);u<h?(s[l++]=g,s[l++]=y):(s[l++]=y,s[l++]=g)}return a._count=l,a._indices=s,a._updateGetRawIdx(),a},e.prototype.downSample=function(e,t,a,n){for(var r=this.clone([e],!0),i=r._chunks,o=[],s=Math.floor(1/t),l=i[e],c=this.count(),u=r._rawExtent[e]=[1/0,-1/0],d=new(x3e(this._rawCount))(Math.ceil(c/s)),h=0,p=0;p<c;p+=s){s>c-p&&(s=c-p,o.length=s);for(var f=0;f<s;f++){var m=this.getRawIndex(p+f);o[f]=l[m]}var v=a(o),g=this.getRawIndex(Math.min(p+n(o,v)||0,c-1));l[g]=v,v<u[0]&&(u[0]=v),v>u[1]&&(u[1]=v),d[h++]=g}return r._count=h,r._indices=d,r._updateGetRawIdx(),r},e.prototype.each=function(e,t){if(this._count)for(var a=e.length,n=this._chunks,r=0,i=this.count();r<i;r++){var o=this.getRawIndex(r);switch(a){case 0:t(r);break;case 1:t(n[e[0]][o],r);break;case 2:t(n[e[0]][o],n[e[1]][o],r);break;default:for(var s=0,l=[];s<a;s++)l[s]=n[e[s]][o];l[s]=r,t.apply(null,l)}}},e.prototype.getDataExtent=function(e){var t=this._chunks[e],a=[1/0,-1/0];if(!t)return a;var n,r=this.count();if(!this._indices)return this._rawExtent[e].slice();if(n=this._extent[e])return n.slice();for(var i=(n=a)[0],o=n[1],s=0;s<r;s++){var l=t[this.getRawIndex(s)];l<i&&(i=l),l>o&&(o=l)}return n=[i,o],this._extent[e]=n,n},e.prototype.getRawDataItem=function(e){var t=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(t);for(var a=[],n=this._chunks,r=0;r<n.length;r++)a.push(n[r][t]);return a},e.prototype.clone=function(t,a){var n=new e,r=this._chunks,i=t&&bGe(t,function(e,t){return e[t]=!0,e},{});if(i)for(var o=0;o<r.length;o++)n._chunks[o]=i[o]?_3e(r[o]):r[o];else n._chunks=r;return this._copyCommonProps(n),a||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},e.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=cGe(this._extent),e._rawExtent=cGe(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,t=void 0;if(e===Array){var a=this._indices.length;t=new e(a);for(var n=0;n<a;n++)t[n]=this._indices[n]}else t=new e(this._indices);return t}return null},e.prototype._getRawIdxIdentity=function(e){return e},e.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function e(e,t,a,n){return Z4e(e[n],this._dimensions[n])}p3e={arrayRows:e,objectRows:function(e,t,a,n){return Z4e(e[t],this._dimensions[n])},keyedColumns:e,original:function(e,t,a,n){var r=e&&(null==e.value?e:e.value);return Z4e(r instanceof Array?r[n]:r,this._dimensions[n])},typedArray:function(e,t,a,n){return e[n]}}}(),e}(),T3e=function(){function e(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(e,t){this._sourceList=e,this._upstreamSignList=t,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var e,t,a=this._sourceHost,n=this._getUpstreamSourceManagers(),r=!!n.length;if(C3e(a)){var i=a,o=void 0,s=void 0,l=void 0;if(r){var c=n[0];c.prepareSource(),o=(l=c.getSource()).data,s=l.sourceFormat,t=[c._getVersionSign()]}else s=DGe(o=i.get("data",!0))?x5e:v5e,t=[];var u=this._getSourceMetaRawOption()||{},d=l&&l.metaRawOption||{},h=FGe(u.seriesLayoutBy,d.seriesLayoutBy)||null,p=FGe(u.sourceHeader,d.sourceHeader),f=FGe(u.dimensions,d.dimensions);e=h!==d.seriesLayoutBy||!!p!=!!d.sourceHeader||f?[k4e(o,{seriesLayoutBy:h,sourceHeader:p,dimensions:f},s)]:[]}else{var m=a;if(r){var v=this._applyTransform(n);e=v.sourceList,t=v.upstreamSignList}else{e=[k4e(m.get("source",!0),this._getSourceMetaRawOption(),null)],t=[]}}this._setLocalSource(e,t)},e.prototype._applyTransform=function(e){var t,a=this._sourceHost,n=a.get("transform",!0),r=a.get("fromTransformResult",!0);if(null!=r){1!==e.length&&A3e("")}var i,o=[],s=[];return gGe(e,function(e){e.prepareSource();var t=e.getSource(r||0);null==r||t||A3e(""),o.push(t),s.push(e._getVersionSign())}),n?t=function(e,t){var a=r$e(e),n=a.length;n||e$e("");for(var r=0,i=n;r<i;r++)t=d3e(a[r],t),r!==i-1&&(t.length=Math.max(t.length,1));return t}(n,o,a.componentIndex):null!=r&&(t=[(i=o[0],new M4e({data:i.data,sourceFormat:i.sourceFormat,seriesLayoutBy:i.seriesLayoutBy,dimensionsDefine:cGe(i.dimensionsDefine),startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount}))]),{sourceList:t,upstreamSignList:s}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),t=0;t<e.length;t++){var a=e[t];if(a._isDirty()||this._upstreamSignList[t]!==a._getVersionSign())return!0}},e.prototype.getSource=function(e){e=e||0;var t=this._sourceList[e];if(!t){var a=this._getUpstreamSourceManagers();return a[0]&&a[0].getSource(e)}return t},e.prototype.getSharedDataStore=function(e){var t=e.makeStoreSchema();return this._innerGetDataStore(t.dimensions,e.source,t.hash)},e.prototype._innerGetDataStore=function(e,t,a){var n=this._storeList,r=n[0];r||(r=n[0]={});var i=r[a];if(!i){var o=this._getUpstreamSourceManagers()[0];C3e(this._sourceHost)&&o?i=o._innerGetDataStore(e,t,a):(i=new M3e).initData(new D4e(t,e.length),e),r[a]=i}return i},e.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if(C3e(e)){var t=I5e(e);return t?[t.getSourceManager()]:[]}return yGe(function(e){return e.get("transform",!0)||e.get("fromTransformResult",!0)?_$e(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},x$e).models:[]}(e),function(e){return e.getSourceManager()})},e.prototype._getSourceMetaRawOption=function(){var e,t,a,n=this._sourceHost;if(C3e(n))e=n.get("seriesLayoutBy",!0),t=n.get("sourceHeader",!0),a=n.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var r=n;e=r.get("seriesLayoutBy",!0),t=r.get("sourceHeader",!0),a=r.get("dimensions",!0)}return{seriesLayoutBy:e,sourceHeader:t,dimensions:a}},e}();function k3e(e){e.option.transform&&WGe(e.option.transform)}function C3e(e){return"series"===e.mainType}function A3e(e){throw new Error(e)}function E3e(e){var t=e.lineHeight;return null==t?"line-height:1":"line-height:"+RWe(t+"")+"px"}function I3e(e,t){var a=e.color||o5e.color.tertiary,n=e.fontSize||12,r=e.fontWeight||"400",i=e.color||o5e.color.secondary,o=e.fontSize||14,s=e.fontWeight||"900";return"html"===t?{nameStyle:"font-size:"+RWe(n+"")+"px;color:"+RWe(a)+";font-weight:"+RWe(r+""),valueStyle:"font-size:"+RWe(o+"")+"px;color:"+RWe(i)+";font-weight:"+RWe(s+"")}:{nameStyle:{fontSize:n,fill:a,fontWeight:r},valueStyle:{fontSize:o,fill:i,fontWeight:s}}}var R3e=[0,10,20,30],D3e=["","\n","\n\n","\n\n\n"];function P3e(e,t){return t.type=e,t}function L3e(e){return"section"===e.type}function N3e(e){return L3e(e)?F3e:B3e}function O3e(e){if(L3e(e)){var t=0,a=e.blocks.length,n=a>1||a>0&&!e.noHeader;return gGe(e.blocks,function(e){var a=O3e(e);a>=t&&(t=a+ +(n&&(!a||L3e(e)&&!e.noHeader)))}),t}return 0}function F3e(e,t,a,n){var r,i=t.noHeader,o=(r=O3e(t),{html:R3e[r],richText:D3e[r]}),s=[],l=t.blocks||[];VGe(!l||TGe(l)),l=l||[];var c=e.orderMode;if(t.sortBlocks&&c){l=l.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(QGe(u,c)){var d=new a3e(u[c],null);l.sort(function(e,t){return d.evaluate(e.sortParam,t.sortParam)})}else"seriesDesc"===c&&l.reverse()}gGe(l,function(a,r){var i=t.valueFormatter,l=N3e(a)(i?hGe(hGe({},e),{valueFormatter:i}):e,a,r>0?o.html:0,n);null!=l&&s.push(l)});var h="richText"===e.renderMode?s.join(o.richText):z3e(n,s.join(""),i?a:o.html);if(i)return h;var p=M2e(t.header,"ordinal",e.useUTC),f=I3e(n,e.renderMode).nameStyle,m=E3e(n);return"richText"===e.renderMode?V3e(e,p,f)+o.richText+h:z3e(n,'<div style="'+f+";"+m+';">'+RWe(p)+"</div>"+h,a)}function B3e(e,t,a,n){var r=e.renderMode,i=t.noName,o=t.noValue,s=!t.markerType,l=t.name,c=e.useUTC,u=t.valueFormatter||e.valueFormatter||function(e){return yGe(e=TGe(e)?e:[e],function(e,t){return M2e(e,TGe(p)?p[t]:p,c)})};if(!i||!o){var d=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||o5e.color.secondary,r),h=i?"":M2e(l,"ordinal",c),p=t.valueType,f=o?[]:u(t.value,t.dataIndex),m=!s||!i,v=!s&&i,g=I3e(n,r),y=g.nameStyle,b=g.valueStyle;return"richText"===r?(s?"":d)+(i?"":V3e(e,h,y))+(o?"":function(e,t,a,n,r){var i=[r],o=n?10:20;return a&&i.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(TGe(t)?t.join("  "):t,i)}(e,f,m,v,b)):z3e(n,(s?"":d)+(i?"":function(e,t,a){return'<span style="'+a+";"+(t?"margin-left:2px":"")+'">'+RWe(e)+"</span>"}(h,!s,y))+(o?"":function(e,t,a,n){var r=a?"10px":"20px",i=t?"float:right;margin-left:"+r:"";return e=TGe(e)?e:[e],'<span style="'+i+";"+n+'">'+yGe(e,function(e){return RWe(e)}).join("&nbsp;&nbsp;")+"</span>"}(f,m,v,b)),a)}}function U3e(e,t,a,n,r,i){if(e)return N3e(e)({useUTC:r,renderMode:a,orderMode:n,markupStyleCreator:t,valueFormatter:e.valueFormatter},e,0,i)}function z3e(e,t,a){return'<div style="'+("margin: "+a+"px 0 0")+";"+E3e(e)+';">'+t+'<div style="clear:both"></div></div>'}function V3e(e,t,a){return e.markupStyleCreator.wrapRichTextStyle(t,a)}function H3e(e,t){return A2e(e.getData().getItemVisual(t,"style")[e.visualDrawType])}function G3e(e,t){var a=e.get("padding");return null!=a?a:"richText"===t?[8,10]:10}var W3e=function(){function e(){this.richTextStyles={},this._nextStyleNameId=$Xe()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(e,t,a){var n="richText"===a?this._generateStyleName():null,r=function(e,t){var a=CGe(e)?{color:e,extraCssText:t}:e||{},n=a.color,r=a.type;t=a.extraCssText;var i=a.renderMode||"html";return n?"html"===i?"subItem"===r?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+RWe(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+RWe(n)+";"+(t||"")+'"></span>':{renderMode:i,content:"{"+(a.markerId||"markerX")+"|}  ",style:"subItem"===r?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}:""}({color:t,type:e,renderMode:a,markerId:n});return CGe(r)?r:(this.richTextStyles[n]=r.style,r.content)},e.prototype.wrapRichTextStyle=function(e,t){var a={};TGe(t)?gGe(t,function(e){return hGe(a,e)}):hGe(a,t);var n=this._generateStyleName();return this.richTextStyles[n]=a,"{"+n+"|"+e+"}"},e}();function q3e(e){var t,a,n,r,i=e.series,o=e.dataIndex,s=e.multipleSeries,l=i.getData(),c=l.mapDimensionsAll("defaultedTooltip"),u=c.length,d=i.getRawValue(o),h=TGe(d),p=H3e(i,o);if(u>1||h&&!u){var f=function(e,t,a,n,r){var i=t.getData(),o=bGe(e,function(e,t,a){var n=i.getDimensionInfo(a);return e||n&&!1!==n.tooltip&&null!=n.displayName},!1),s=[],l=[],c=[];function u(e,t){var a=i.getDimensionInfo(t);a&&!1!==a.otherDims.tooltip&&(o?c.push(P3e("nameValue",{markerType:"subItem",markerColor:r,name:a.displayName,value:e,valueType:a.type})):(s.push(e),l.push(a.type)))}return n.length?gGe(n,function(e){u(W4e(i,a,e),e)}):gGe(e,u),{inlineValues:s,inlineValueTypes:l,blocks:c}}(d,i,o,c,p);t=f.inlineValues,a=f.inlineValueTypes,n=f.blocks,r=f.inlineValues[0]}else if(u){var m=l.getDimensionInfo(c[0]);r=t=W4e(l,o,c[0]),a=m.type}else r=t=h?d[0]:d;var v=p$e(i),g=v&&i.name||"",y=l.getName(o),b=s?g:y;return P3e("section",{header:g,noHeader:s||!v,sortParam:r,blocks:[P3e("nameValue",{markerType:"item",markerColor:p,name:b,noName:!HGe(b),value:t,valueType:a,dataIndex:o})].concat(n||[])})}var Y3e=v$e();function j3e(e,t){return e.getName(t)||e.getId(t)}var X3e="__universalTransitionEnabled",$3e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectedDataIndicesMap={},t}var a;return zHe(t,e),t.prototype.init=function(e,t,a){this.seriesIndex=this.componentIndex,this.dataTask=X4e({count:Z3e,reset:J3e}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(e,a),(Y3e(this).sourceManager=new T3e(this)).prepareSource();var n=this.getInitialData(e,a);e6e(n,this),this.dataTask.context.data=n,Y3e(this).dataBeforeProcessed=n,K3e(this),this._initSelectedMapFromData(n)},t.prototype.mergeDefaultAndTheme=function(e,t){var a=e5e(this),n=a?a5e(e):{},r=this.subType;i5e.hasClass(r)&&(r+="Series"),uGe(e,t.getTheme().get(this.subType)),uGe(e,this.getDefaultOption()),i$e(e,"label",["show"]),this.fillDataTextStyle(e.data),a&&t5e(e,n,a)},t.prototype.mergeOption=function(e,t){e=uGe(this.option,e,!0),this.fillDataTextStyle(e.data);var a=e5e(this);a&&t5e(this.option,e,a);var n=Y3e(this).sourceManager;n.dirty(),n.prepareSource();var r=this.getInitialData(e,t);e6e(r,this),this.dataTask.dirty(),this.dataTask.context.data=r,Y3e(this).dataBeforeProcessed=r,K3e(this),this._initSelectedMapFromData(r)},t.prototype.fillDataTextStyle=function(e){if(e&&!DGe(e))for(var t=["show"],a=0;a<e.length;a++)e[a]&&e[a].label&&i$e(e[a],"label",t)},t.prototype.getInitialData=function(e,t){},t.prototype.appendData=function(e){this.getRawData().appendData(e.data)},t.prototype.getData=function(e){var t=a6e(this);if(t){var a=t.context.data;return null!=e&&a.getLinkedData?a.getLinkedData(e):a}return Y3e(this).data},t.prototype.getAllData=function(){var e=this.getData();return e&&e.getLinkedDataAll?e.getLinkedDataAll():[{data:e}]},t.prototype.setData=function(e){var t=a6e(this);if(t){var a=t.context;a.outputData=e,t!==this.dataTask&&(a.data=e)}Y3e(this).data=e},t.prototype.getEncode=function(){var e=this.get("encode",!0);if(e)return $Ge(e)},t.prototype.getSourceManager=function(){return Y3e(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return Y3e(this).dataBeforeProcessed},t.prototype.getColorBy=function(){return this.get("colorBy")||"series"},t.prototype.isColorBySeries=function(){return"series"===this.getColorBy()},t.prototype.getBaseAxis=function(){var e=this.coordinateSystem;return e&&e.getBaseAxis&&e.getBaseAxis()},t.prototype.indicesOfNearest=function(e,t,a,n){var r=this.getData(),i=this.coordinateSystem,o=i&&i.getAxis(e);if(!i||!o)return[];var s=o.dataToCoord(a);null==n&&(n=1/0);var l=[],c=1/0,u=-1,d=0;return r.each(t,function(e,t){var a=o.dataToCoord(e),r=s-a,i=Math.abs(r);i<=n&&((i<c||i===c&&r>=0&&u<0)&&(c=i,u=r,d=0),r===u&&(l[d++]=t))}),l.length=d,l},t.prototype.formatTooltip=function(e,t,a){return q3e({series:this,dataIndex:e,multipleSeries:t})},t.prototype.isAnimationEnabled=function(){var e=this.ecModel;if(HHe.node&&(!e||!e.ssr))return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),!!t},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(e,t,a){var n=this.ecModel,r=U5e.prototype.getColorFromPalette.call(this,e,t,a);return r||(r=n.getColorFromPalette(e,t,a)),r},t.prototype.coordDimToDataDim=function(e){return this.getRawData().mapDimensionsAll(e)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(e,t){this._innerSelect(this.getData(t),e)},t.prototype.unselect=function(e,t){var a=this.option.selectedMap;if(a){var n=this.option.selectedMode,r=this.getData(t);if("series"===n||"all"===a)return this.option.selectedMap={},void(this._selectedDataIndicesMap={});for(var i=0;i<e.length;i++){var o=j3e(r,e[i]);a[o]=!1,this._selectedDataIndicesMap[o]=-1}}},t.prototype.toggleSelect=function(e,t){for(var a=[],n=0;n<e.length;n++)a[0]=e[n],this.isSelected(e[n],t)?this.unselect(a,t):this.select(a,t)},t.prototype.getSelectedDataIndices=function(){if("all"===this.option.selectedMap)return[].slice.call(this.getData().getIndices());for(var e=this._selectedDataIndicesMap,t=_Ge(e),a=[],n=0;n<t.length;n++){var r=e[t[n]];r>=0&&a.push(r)}return a},t.prototype.isSelected=function(e,t){var a=this.option.selectedMap;if(!a)return!1;var n=this.getData(t);return("all"===a||a[j3e(n,e)])&&!n.getItemModel(e).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[X3e])return!0;var e=this.option.universalTransition;return!!e&&(!0===e||e&&e.enabled)},t.prototype._innerSelect=function(e,t){var a,n,r=this.option,i=r.selectedMode,o=t.length;if(i&&o)if("series"===i)r.selectedMap="all";else if("multiple"===i){IGe(r.selectedMap)||(r.selectedMap={});for(var s=r.selectedMap,l=0;l<o;l++){var c=t[l];s[d=j3e(e,c)]=!0,this._selectedDataIndicesMap[d]=e.getRawIndex(c)}}else if("single"===i||!0===i){var u=t[o-1],d=j3e(e,u);r.selectedMap=((a={})[d]=!0,a),this._selectedDataIndicesMap=((n={})[d]=e.getRawIndex(u),n)}},t.prototype._initSelectedMapFromData=function(e){if(!this.option.selectedMap){var t=[];e.hasItemOption&&e.each(function(a){var n=e.getRawDataItem(a);n&&n.selected&&t.push(a)}),t.length>0&&this._innerSelect(e,t)}},t.registerClass=function(e){return i5e.registerClass(e)},t.protoInitialize=((a=t.prototype).type="series.__base__",a.seriesIndex=0,a.ignoreStyleOnData=!1,a.hasSymbolVisual=!1,a.defaultSymbol="circle",a.visualStyleAccessPath="itemStyle",void(a.visualDrawType="fill")),t}(i5e);function K3e(e){var t=e.name;p$e(e)||(e.name=function(e){var t=e.getRawData(),a=t.mapDimensionsAll("seriesName"),n=[];return gGe(a,function(e){var a=t.getDimensionInfo(e);a.displayName&&n.push(a.displayName)}),n.join(" ")}(e)||t)}function Z3e(e){return e.model.getRawData().count()}function J3e(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),Q3e}function Q3e(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function e6e(e,t){gGe(KGe(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),function(a){e.wrapMethod(a,MGe(t6e,t))})}function t6e(e,t){var a=a6e(e);return a&&a.setOutputEnd((t||this).count()),t}function a6e(e){var t=(e.ecModel||{}).scheduler,a=t&&t.getPipeline(e.uid);if(a){var n=a.currentTask;if(n){var r=n.agentStubMap;r&&(n=r.get(e.uid))}return n}}mGe($3e,Y4e),mGe($3e,U5e),D$e($3e,i5e);var n6e=function(){function e(){this.group=new xXe,this.uid=R1e("viewComponent")}return e.prototype.init=function(e,t){},e.prototype.render=function(e,t,a,n){},e.prototype.dispose=function(e,t){},e.prototype.updateView=function(e,t,a,n){},e.prototype.updateLayout=function(e,t,a,n){},e.prototype.updateVisual=function(e,t,a,n){},e.prototype.toggleBlurSeries=function(e,t,a){},e.prototype.eachRendered=function(e){var t=this.group;t&&t.traverse(e)},e}();function r6e(){var e=v$e();return function(t){var a=e(t),n=t.pipelineContext,r=!!a.large,i=!!a.progressiveRender,o=a.large=!(!n||!n.large),s=a.progressiveRender=!(!n||!n.progressiveRender);return!(r===o&&i===s)&&"reset"}}R$e(n6e),O$e(n6e);var i6e=v$e(),o6e=r6e(),s6e=function(){function e(){this.group=new xXe,this.uid=R1e("viewChart"),this.renderTask=X4e({plan:u6e,reset:d6e}),this.renderTask.context={view:this}}return e.prototype.init=function(e,t){},e.prototype.render=function(e,t,a,n){},e.prototype.highlight=function(e,t,a,n){var r=e.getData(n&&n.dataType);r&&c6e(r,n,"emphasis")},e.prototype.downplay=function(e,t,a,n){var r=e.getData(n&&n.dataType);r&&c6e(r,n,"normal")},e.prototype.remove=function(e,t){this.group.removeAll()},e.prototype.dispose=function(e,t){},e.prototype.updateView=function(e,t,a,n){this.render(e,t,a,n)},e.prototype.updateLayout=function(e,t,a,n){this.render(e,t,a,n)},e.prototype.updateVisual=function(e,t,a,n){this.render(e,t,a,n)},e.prototype.eachRendered=function(e){q0e(this.group,e)},e.markUpdateMethod=function(e,t){i6e(e).updateMethod=t},e.protoInitialize=void(e.prototype.type="chart"),e}();function l6e(e,t,a){e&&HJe(e)&&("emphasis"===t?_Je:SJe)(e,a)}function c6e(e,t,a){var n=m$e(e,t),r=t&&null!=t.highlightKey?function(e){var t=$Ze[e];return null==t&&XZe<=32&&(t=$Ze[e]=XZe++),t}(t.highlightKey):null;null!=n?gGe(r$e(n),function(t){l6e(e.getItemGraphicEl(t),a,r)}):e.eachItemGraphicEl(function(e){l6e(e,a,r)})}function u6e(e){return o6e(e.model)}function d6e(e){var t=e.model,a=e.ecModel,n=e.api,r=e.payload,i=t.pipelineContext.progressiveRender,o=e.view,s=r&&i6e(r).updateMethod,l=i?"incrementalPrepareRender":s&&o[s]?s:"render";return"render"!==l&&o[l](t,a,n,r),h6e[l]}R$e(s6e),O$e(s6e);var h6e={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},p6e="\0__throttleOriginMethod",f6e="\0__throttleRate",m6e="\0__throttleType";function v6e(e,t,a){var n,r,i,o,s,l=0,c=0,u=null;function d(){c=(new Date).getTime(),u=null,e.apply(i,o||[])}t=t||0;var h=function(){for(var e=[],h=0;h<arguments.length;h++)e[h]=arguments[h];n=(new Date).getTime(),i=this,o=e;var p=s||t,f=s||a;s=null,r=n-(f?l:c)-p,clearTimeout(u),f?u=setTimeout(d,p):r>=0?d():u=setTimeout(d,-r),l=n};return h.clear=function(){u&&(clearTimeout(u),u=null)},h.debounceNextCall=function(e){s=e},h}function g6e(e,t,a,n){var r=e[t];if(r){var i=r[p6e]||r,o=r[m6e];if(r[f6e]!==a||o!==n){if(null==a||!n)return e[t]=i;(r=e[t]=v6e(i,a,"debounce"===n))[p6e]=i,r[m6e]=n,r[f6e]=a}return r}}function y6e(e,t){var a=e[t];a&&a[p6e]&&(a.clear&&a.clear(),e[t]=a[p6e])}var b6e=v$e(),x6e={itemStyle:F$e(k1e,!0),lineStyle:F$e(S1e,!0)},w6e={lineStyle:"stroke",itemStyle:"fill"};function _6e(e,t){var a=e.visualStyleMapper||x6e[t];return a||(console.warn("Unknown style type '"+t+"'."),x6e.itemStyle)}function S6e(e,t){var a=e.visualDrawType||w6e[t];return a||(console.warn("Unknown style type '"+t+"'."),"fill")}var M6e={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var a=e.getData(),n=e.visualStyleAccessPath||"itemStyle",r=e.getModel(n),i=_6e(e,n)(r),o=r.getShallow("decal");o&&(a.setVisual("decal",o),o.dirty=!0);var s=S6e(e,n),l=i[s],c=kGe(l)?l:null,u="auto"===i.fill||"auto"===i.stroke;if(!i[s]||c||u){var d=e.getColorFromPalette(e.name,null,t.getSeriesCount());i[s]||(i[s]=d,a.setVisual("colorFromPalette",!0)),i.fill="auto"===i.fill||kGe(i.fill)?d:i.fill,i.stroke="auto"===i.stroke||kGe(i.stroke)?d:i.stroke}if(a.setVisual("style",i),a.setVisual("drawType",s),!t.isSeriesFiltered(e)&&c)return a.setVisual("colorFromPalette",!1),{dataEach:function(t,a){var n=e.getDataParams(a),r=hGe({},i);r[s]=c(n),t.setItemVisual(a,"style",r)}}}},T6e=new E1e,k6e={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.ignoreStyleOnData&&!t.isSeriesFiltered(e)){var a=e.getData(),n=e.visualStyleAccessPath||"itemStyle",r=_6e(e,n),i=a.getVisual("drawType");return{dataEach:a.hasItemOption?function(e,t){var a=e.getRawDataItem(t);if(a&&a[n]){T6e.option=a[n];var o=r(T6e);hGe(e.ensureUniqueItemVisual(t,"style"),o),T6e.option.decal&&(e.setItemVisual(t,"decal",T6e.option.decal),T6e.option.decal.dirty=!0),i in o&&e.setItemVisual(t,"colorFromPalette",!1)}}:null}}}},C6e={performRawSeries:!0,overallReset:function(e){var t=$Ge();e.eachSeries(function(e){var a=e.getColorBy();if(!e.isColorBySeries()){var n=e.type+"-"+a,r=t.get(n);r||(r={},t.set(n,r)),b6e(e).scope=r}}),e.eachSeries(function(t){if(!t.isColorBySeries()&&!e.isSeriesFiltered(t)){var a=t.getRawData(),n={},r=t.getData(),i=b6e(t).scope,o=t.visualStyleAccessPath||"itemStyle",s=S6e(t,o);r.each(function(e){var t=r.getRawIndex(e);n[t]=e}),a.each(function(e){var o=n[e];if(r.getItemVisual(o,"colorFromPalette")){var l=r.ensureUniqueItemVisual(o,"style"),c=a.getName(e)||e+"",u=a.count();l[s]=t.getColorFromPalette(c,i,u)}})}})}},A6e=Math.PI;var E6e=function(){function e(e,t,a,n){this._stageTaskMap=$Ge(),this.ecInstance=e,this.api=t,a=this._dataProcessorHandlers=a.slice(),n=this._visualHandlers=n.slice(),this._allHandlers=a.concat(n)}return e.prototype.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each(function(e){var t=e.overallTask;t&&t.dirty()})},e.prototype.getPerformArgs=function(e,t){if(e.__pipeline){var a=this._pipelineMap.get(e.__pipeline.id),n=a.context,r=!t&&a.progressiveEnabled&&(!n||n.progressiveRender)&&e.__idxInPipeline>a.blockIndex?a.step:null,i=n&&n.modDataCount;return{step:r,modBy:null!=i?Math.ceil(i/r):null,modDataCount:i}}},e.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},e.prototype.updateStreamModes=function(e,t){var a=this._pipelineMap.get(e.uid),n=e.getData().count(),r=a.progressiveEnabled&&t.incrementalPrepareRender&&n>=a.threshold,i=e.get("large")&&n>=e.get("largeThreshold"),o="mod"===e.get("progressiveChunkMode")?n:null;e.pipelineContext=a.context={progressiveRender:r,modDataCount:o,large:i}},e.prototype.restorePipelines=function(e){var t=this,a=t._pipelineMap=$Ge();e.eachSeries(function(e){var n=e.getProgressive(),r=e.uid;a.set(r,{id:r,head:null,tail:null,threshold:e.getProgressiveThreshold(),progressiveEnabled:n&&!(e.preventIncremental&&e.preventIncremental()),blockIndex:-1,step:Math.round(n||700),count:0}),t._pipe(e,e.dataTask)})},e.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.api.getModel(),a=this.api;gGe(this._allHandlers,function(n){var r=e.get(n.uid)||e.set(n.uid,{});VGe(!(n.reset&&n.overallReset),""),n.reset&&this._createSeriesStageTask(n,r,t,a),n.overallReset&&this._createOverallStageTask(n,r,t,a)},this)},e.prototype.prepareView=function(e,t,a,n){var r=e.renderTask,i=r.context;i.model=t,i.ecModel=a,i.api=n,r.__block=!e.incrementalPrepareRender,this._pipe(t,r)},e.prototype.performDataProcessorTasks=function(e,t){this._performStageTasks(this._dataProcessorHandlers,e,t,{block:!0})},e.prototype.performVisualTasks=function(e,t,a){this._performStageTasks(this._visualHandlers,e,t,a)},e.prototype._performStageTasks=function(e,t,a,n){n=n||{};var r=!1,i=this;function o(e,t){return e.setDirty&&(!e.dirtyMap||e.dirtyMap.get(t.__pipeline.id))}gGe(e,function(e,s){if(!n.visualType||n.visualType===e.visualType){var l=i._stageTaskMap.get(e.uid),c=l.seriesTaskMap,u=l.overallTask;if(u){var d,h=u.agentStubMap;h.each(function(e){o(n,e)&&(e.dirty(),d=!0)}),d&&u.dirty(),i.updatePayload(u,a);var p=i.getPerformArgs(u,n.block);h.each(function(e){e.perform(p)}),u.perform(p)&&(r=!0)}else c&&c.each(function(s,l){o(n,s)&&s.dirty();var c=i.getPerformArgs(s,n.block);c.skip=!e.performRawSeries&&t.isSeriesFiltered(s.context.model),i.updatePayload(s,a),s.perform(c)&&(r=!0)})}}),this.unfinished=r||this.unfinished},e.prototype.performSeriesTasks=function(e){var t;e.eachSeries(function(e){t=e.dataTask.perform()||t}),this.unfinished=t||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each(function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)})},e.prototype.updatePayload=function(e,t){"remain"!==t&&(e.context.payload=t)},e.prototype._createSeriesStageTask=function(e,t,a,n){var r=this,i=t.seriesTaskMap,o=t.seriesTaskMap=$Ge(),s=e.seriesType,l=e.getTargetSeries;function c(t){var s=t.uid,l=o.set(s,i&&i.get(s)||X4e({plan:L6e,reset:N6e,count:B6e}));l.context={model:t,ecModel:a,api:n,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:r},r._pipe(t,l)}e.createOnAllSeries?a.eachRawSeries(c):s?a.eachRawSeriesByType(s,c):l&&l(a,n).each(c)},e.prototype._createOverallStageTask=function(e,t,a,n){var r=this,i=t.overallTask=t.overallTask||X4e({reset:I6e});i.context={ecModel:a,api:n,overallReset:e.overallReset,scheduler:r};var o=i.agentStubMap,s=i.agentStubMap=$Ge(),l=e.seriesType,c=e.getTargetSeries,u=!0,d=!1;function h(e){var t=e.uid,a=s.set(t,o&&o.get(t)||(d=!0,X4e({reset:R6e,onDirty:P6e})));a.context={model:e,overallProgress:u},a.agent=i,a.__block=u,r._pipe(e,a)}VGe(!e.createOnAllSeries,""),l?a.eachRawSeriesByType(l,h):c?c(a,n).each(h):(u=!1,gGe(a.getSeries(),h)),d&&i.dirty()},e.prototype._pipe=function(e,t){var a=e.uid,n=this._pipelineMap.get(a);!n.head&&(n.head=t),n.tail&&n.tail.pipe(t),n.tail=t,t.__idxInPipeline=n.count++,t.__pipeline=n},e.wrapStageHandler=function(e,t){return kGe(e)&&(e={overallReset:e,seriesType:U6e(e)}),e.uid=R1e("stageHandler"),t&&(e.visualType=t),e},e}();function I6e(e){e.overallReset(e.ecModel,e.api,e.payload)}function R6e(e){return e.overallProgress&&D6e}function D6e(){this.agent.dirty(),this.getDownstream().dirty()}function P6e(){this.agent&&this.agent.dirty()}function L6e(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function N6e(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=r$e(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?yGe(t,function(e,t){return F6e(t)}):O6e}var O6e=F6e(0);function F6e(e){return function(t,a){var n=a.data,r=a.resetDefines[e];if(r&&r.dataEach)for(var i=t.start;i<t.end;i++)r.dataEach(n,i);else r&&r.progress&&r.progress(t,n)}}function B6e(e){return e.data.count()}function U6e(e){z6e=null;try{e(V6e,H6e)}catch(TQe){}return z6e}var z6e,V6e={},H6e={};function G6e(e,t){for(var a in t.prototype)e[a]=eWe}G6e(V6e,G5e),G6e(H6e,X5e),V6e.eachSeriesByType=V6e.eachRawSeriesByType=function(e){z6e=e},V6e.eachComponent=function(e){"series"===e.mainType&&e.subType&&(z6e=e.subType)};var W6e,q6e=o5e.darkColor,Y6e=q6e.background,j6e=function(){return{axisLine:{lineStyle:{color:q6e.axisLine}},splitLine:{lineStyle:{color:q6e.axisSplitLine}},splitArea:{areaStyle:{color:[q6e.backgroundTint,q6e.backgroundTransparent]}},minorSplitLine:{lineStyle:{color:q6e.axisMinorSplitLine}},axisLabel:{color:q6e.axisLabel},axisName:{}}},X6e={label:{color:q6e.secondary},itemStyle:{borderColor:q6e.borderTint},dividerLineStyle:{color:q6e.border}},$6e={darkMode:!0,color:q6e.theme,backgroundColor:Y6e,axisPointer:{lineStyle:{color:q6e.border},crossStyle:{color:q6e.borderShade},label:{color:q6e.tertiary}},legend:{textStyle:{color:q6e.secondary},pageTextStyle:{color:q6e.tertiary}},textStyle:{color:q6e.secondary},title:{textStyle:{color:q6e.primary},subtextStyle:{color:q6e.quaternary}},toolbox:{iconStyle:{borderColor:q6e.accent50}},tooltip:{backgroundColor:q6e.neutral20,defaultBorderColor:q6e.border,textStyle:{color:q6e.tertiary}},dataZoom:{borderColor:q6e.accent10,textStyle:{color:q6e.tertiary},brushStyle:{color:q6e.backgroundTint},handleStyle:{color:q6e.neutral00,borderColor:q6e.accent20},moveHandleStyle:{color:q6e.accent40},emphasis:{handleStyle:{borderColor:q6e.accent50}},dataBackground:{lineStyle:{color:q6e.accent30},areaStyle:{color:q6e.accent20}},selectedDataBackground:{lineStyle:{color:q6e.accent50},areaStyle:{color:q6e.accent30}}},visualMap:{textStyle:{color:q6e.secondary},handleStyle:{borderColor:q6e.neutral30}},timeline:{lineStyle:{color:q6e.accent10},label:{color:q6e.tertiary},controlStyle:{color:q6e.accent30,borderColor:q6e.accent30}},calendar:{itemStyle:{color:q6e.neutral00,borderColor:q6e.neutral20},dayLabel:{color:q6e.tertiary},monthLabel:{color:q6e.secondary},yearLabel:{color:q6e.secondary}},matrix:{x:X6e,y:X6e,backgroundColor:{borderColor:q6e.axisLine},body:{itemStyle:{borderColor:q6e.borderTint}}},timeAxis:j6e(),logAxis:j6e(),valueAxis:j6e(),categoryAxis:j6e(),line:{symbol:"circle"},graph:{color:q6e.theme},gauge:{title:{color:q6e.secondary},axisLine:{lineStyle:{color:[[1,q6e.neutral05]]}},axisLabel:{color:q6e.axisLabel},detail:{color:q6e.primary}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}},funnel:{itemStyle:{borderColor:q6e.background}},radar:(W6e=j6e(),W6e.axisName={color:q6e.axisLabel},W6e.axisLine.lineStyle.color=q6e.neutral20,W6e),treemap:{breadcrumb:{itemStyle:{color:q6e.neutral20,textStyle:{color:q6e.secondary}},emphasis:{itemStyle:{color:q6e.neutral30}}}},sunburst:{itemStyle:{borderColor:q6e.background}},map:{itemStyle:{borderColor:q6e.border,areaColor:q6e.neutral10},label:{color:q6e.tertiary},emphasis:{label:{color:q6e.primary},itemStyle:{areaColor:q6e.highlight}},select:{label:{color:q6e.primary},itemStyle:{areaColor:q6e.highlight}}},geo:{itemStyle:{borderColor:q6e.border,areaColor:q6e.neutral10},emphasis:{label:{color:q6e.primary},itemStyle:{areaColor:q6e.highlight}},select:{label:{color:q6e.primary},itemStyle:{color:q6e.highlight}}}};$6e.categoryAxis.splitLine.show=!1;var K6e=function(){function e(){}return e.prototype.normalizeQuery=function(e){var t={},a={},n={};if(CGe(e)){var r=I$e(e);t.mainType=r.main||null,t.subType=r.sub||null}else{var i=["Index","Name","Id"],o={name:1,dataIndex:1,dataType:1};gGe(e,function(e,r){for(var s=!1,l=0;l<i.length;l++){var c=i[l],u=r.lastIndexOf(c);if(u>0&&u===r.length-c.length){var d=r.slice(0,u);"data"!==d&&(t.mainType=d,t[c.toLowerCase()]=e,s=!0)}}o.hasOwnProperty(r)&&(a[r]=e,s=!0),s||(n[r]=e)})}return{cptQuery:t,dataQuery:a,otherQuery:n}},e.prototype.filter=function(e,t){var a=this.eventInfo;if(!a)return!0;var n=a.targetEl,r=a.packedEvent,i=a.model,o=a.view;if(!i||!o)return!0;var s=t.cptQuery,l=t.dataQuery;return c(s,i,"mainType")&&c(s,i,"subType")&&c(s,i,"index","componentIndex")&&c(s,i,"name")&&c(s,i,"id")&&c(l,r,"name")&&c(l,r,"dataIndex")&&c(l,r,"dataType")&&(!o.filterForExposedEvent||o.filterForExposedEvent(e,t.otherQuery,n,r));function c(e,t,a,n){return null==e[a]||t[n||a]===e[a]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),Z6e=["symbol","symbolSize","symbolRotate","symbolOffset"],J6e=Z6e.concat(["symbolKeepAspect"]),Q6e={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var a=e.getData();if(e.legendIcon&&a.setVisual("legendIcon",e.legendIcon),e.hasSymbolVisual){for(var n={},r={},i=!1,o=0;o<Z6e.length;o++){var s=Z6e[o],l=e.get(s);kGe(l)?(i=!0,r[s]=l):n[s]=l}if(n.symbol=n.symbol||e.defaultSymbol,a.setVisual(hGe({legendIcon:e.legendIcon||n.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},n)),!t.isSeriesFiltered(e)){var c=_Ge(r);return{dataEach:i?function(t,a){for(var n=e.getRawValue(a),i=e.getDataParams(a),o=0;o<c.length;o++){var s=c[o];t.setItemVisual(a,s,r[s](n,i))}}:null}}}}},e8e={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(e.hasSymbolVisual&&!t.isSeriesFiltered(e))return{dataEach:e.getData().hasItemOption?function(e,t){for(var a=e.getItemModel(t),n=0;n<J6e.length;n++){var r=J6e[n],i=a.getShallow(r,!0);null!=i&&e.setItemVisual(t,r,i)}}:null}}};function t8e(e,t,a){switch(a){case"color":return e.getItemVisual(t,"style")[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,a)}}function a8e(e,t){switch(t){case"color":return e.getVisual("style")[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function n8e(e,t,a,n){switch(a){case"color":e.ensureUniqueItemVisual(t,"style")[e.getVisual("drawType")]=n,e.setItemVisual(t,"colorFromPalette",!1);break;case"opacity":e.ensureUniqueItemVisual(t,"style").opacity=n;break;case"symbol":case"symbolSize":case"liftZ":e.setItemVisual(t,a,n)}}function r8e(e,t){function a(t,a){var n=[];return t.eachComponent({mainType:"series",subType:e,query:a},function(e){n.push(e.seriesIndex)}),n}gGe([[e+"ToggleSelect","toggleSelect"],[e+"Select","select"],[e+"UnSelect","unselect"]],function(e){t(e[0],function(t,n,r){t=hGe({},t),r.dispatchAction(hGe(t,{type:e[1],seriesIndex:a(n,t)}))})})}function i8e(e,t,a,n,r){var i=e+t;a.isSilent(i)||n.eachComponent({mainType:"series",subType:"pie"},function(e){for(var t=e.seriesIndex,n=e.option.selectedMap,o=r.selected,s=0;s<o.length;s++)if(o[s].seriesIndex===t){var l=e.getData(),c=m$e(l,r.fromActionPayload);a.trigger(i,{type:i,seriesId:e.id,name:TGe(c)?l.getName(c[0]):l.getName(c),selected:CGe(n)?n:hGe({},n)})}})}function o8e(e,t,a){for(var n;e&&(!t(e)||(n=e,!a));)e=e.__hostTarget||e.parent;return n}var s8e=Math.round(9*Math.random()),l8e="function"==typeof Object.defineProperty,c8e=function(){function e(){this._id="__ec_inner_"+s8e++}return e.prototype.get=function(e){return this._guard(e)[this._id]},e.prototype.set=function(e,t){var a=this._guard(e);return l8e?Object.defineProperty(a,this._id,{value:t,enumerable:!1,configurable:!0}):a[this._id]=t,this},e.prototype.delete=function(e){return!!this.has(e)&&(delete this._guard(e)[this._id],!0)},e.prototype.has=function(e){return!!this._guard(e)[this._id]},e.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},e}(),u8e=gZe.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var a=t.cx,n=t.cy,r=t.width/2,i=t.height/2;e.moveTo(a,n-i),e.lineTo(a+r,n+i),e.lineTo(a-r,n+i),e.closePath()}}),d8e=gZe.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var a=t.cx,n=t.cy,r=t.width/2,i=t.height/2;e.moveTo(a,n-i),e.lineTo(a+r,n),e.lineTo(a,n+i),e.lineTo(a-r,n),e.closePath()}}),h8e=gZe.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var a=t.x,n=t.y,r=t.width/5*3,i=Math.max(r,t.height),o=r/2,s=o*o/(i-o),l=n-i+o+s,c=Math.asin(s/o),u=Math.cos(c)*o,d=Math.sin(c),h=Math.cos(c),p=.6*o,f=.7*o;e.moveTo(a-u,l+s),e.arc(a,l,o,Math.PI-c,2*Math.PI+c),e.bezierCurveTo(a+u-d*p,l+s+h*p,a,n-f,a,n),e.bezierCurveTo(a,n-f,a-u+d*p,l+s+h*p,a-u,l+s),e.closePath()}}),p8e=gZe.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var a=t.height,n=t.width,r=t.x,i=t.y,o=n/3*2;e.moveTo(r,i),e.lineTo(r+o,i+a),e.lineTo(r,i+a/4*3),e.lineTo(r-o,i+a),e.lineTo(r,i),e.closePath()}}),f8e={line:function(e,t,a,n,r){r.x1=e,r.y1=t+n/2,r.x2=e+a,r.y2=t+n/2},rect:function(e,t,a,n,r){r.x=e,r.y=t,r.width=a,r.height=n},roundRect:function(e,t,a,n,r){r.x=e,r.y=t,r.width=a,r.height=n,r.r=Math.min(a,n)/4},square:function(e,t,a,n,r){var i=Math.min(a,n);r.x=e,r.y=t,r.width=i,r.height=i},circle:function(e,t,a,n,r){r.cx=e+a/2,r.cy=t+n/2,r.r=Math.min(a,n)/2},diamond:function(e,t,a,n,r){r.cx=e+a/2,r.cy=t+n/2,r.width=a,r.height=n},pin:function(e,t,a,n,r){r.x=e+a/2,r.y=t+n/2,r.width=a,r.height=n},arrow:function(e,t,a,n,r){r.x=e+a/2,r.y=t+n/2,r.width=a,r.height=n},triangle:function(e,t,a,n,r){r.cx=e+a/2,r.cy=t+n/2,r.width=a,r.height=n}},m8e={};gGe({line:UQe,rect:EZe,roundRect:EZe,square:EZe,circle:hQe,diamond:d8e,pin:h8e,arrow:p8e,triangle:u8e},function(e,t){m8e[t]=new e});var v8e=gZe.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,a){var n=lXe(e,t,a),r=this.shape;return r&&"pin"===r.symbolType&&"inside"===t.position&&(n.y=a.y+.4*a.height),n},buildPath:function(e,t,a){var n=t.symbolType;if("none"!==n){var r=m8e[n];r||(r=m8e[n="rect"]),f8e[n](t.x,t.y,t.width,t.height,r.shape),r.buildPath(e,r.shape,a)}}});function g8e(e,t){if("image"!==this.type){var a=this.style;this.__isEmptyBrush?(a.stroke=e,a.fill=t||o5e.color.neutral00,a.lineWidth=2):"line"===this.shape.symbolType?a.stroke=e:a.fill=e,this.markRedraw()}}function y8e(e,t,a,n,r,i,o){var s,l=0===e.indexOf("empty");return l&&(e=e.substr(5,1).toLowerCase()+e.substr(6)),(s=0===e.indexOf("image://")?M0e(e.slice(8),new fqe(t,a,n,r),o?"center":"cover"):0===e.indexOf("path://")?S0e(e.slice(7),{},new fqe(t,a,n,r),o?"center":"cover"):new v8e({shape:{symbolType:e,x:t,y:a,width:n,height:r}})).__isEmptyBrush=l,s.setColor=g8e,i&&s.setColor(i),s}function b8e(e){return TGe(e)||(e=[+e,+e]),[e[0]||0,e[1]||0]}function x8e(e,t){if(null!=e)return TGe(e)||(e=[e,e]),[RXe(e[0],t[0])||0,RXe(FGe(e[1],e[0]),t[1])||0]}function w8e(e){return isFinite(e)}function _8e(e,t,a){for(var n="radial"===t.type?function(e,t,a){var n=a.width,r=a.height,i=Math.min(n,r),o=null==t.x?.5:t.x,s=null==t.y?.5:t.y,l=null==t.r?.5:t.r;return t.global||(o=o*n+a.x,s=s*r+a.y,l*=i),o=w8e(o)?o:.5,s=w8e(s)?s:.5,l=l>=0&&w8e(l)?l:.5,e.createRadialGradient(o,s,0,o,s,l)}(e,t,a):function(e,t,a){var n=null==t.x?0:t.x,r=null==t.x2?1:t.x2,i=null==t.y?0:t.y,o=null==t.y2?0:t.y2;return t.global||(n=n*a.width+a.x,r=r*a.width+a.x,i=i*a.height+a.y,o=o*a.height+a.y),n=w8e(n)?n:0,r=w8e(r)?r:1,i=w8e(i)?i:0,o=w8e(o)?o:0,e.createLinearGradient(n,i,r,o)}(e,t,a),r=t.colorStops,i=0;i<r.length;i++)n.addColorStop(r[i].offset,r[i].color);return n}function S8e(e){return parseInt(e,10)}function M8e(e,t,a){var n=["width","height"][t],r=["clientWidth","clientHeight"][t],i=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=a[n]&&"auto"!==a[n])return parseFloat(a[n]);var s=document.defaultView.getComputedStyle(e);return(e[r]||S8e(s[n])||S8e(e.style[n]))-(S8e(s[i])||0)-(S8e(s[o])||0)|0}function T8e(e){var t,a,n=e.style,r=n.lineDash&&n.lineWidth>0&&(t=n.lineDash,a=n.lineWidth,t&&"solid"!==t&&a>0?"dashed"===t?[4*a,2*a]:"dotted"===t?[a]:EGe(t)?[t]:TGe(t)?t:null:null),i=n.lineDashOffset;if(r){var o=n.strokeNoScale&&e.getLineScale?e.getLineScale():1;o&&1!==o&&(r=yGe(r,function(e){return e/o}),i/=o)}return[r,i]}var k8e=new KKe(!0);function C8e(e){var t=e.stroke;return!(null==t||"none"===t||!(e.lineWidth>0))}function A8e(e){return"string"==typeof e&&"none"!==e}function E8e(e){var t=e.fill;return null!=t&&"none"!==t}function I8e(e,t){if(null!=t.fillOpacity&&1!==t.fillOpacity){var a=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=a}else e.fill()}function R8e(e,t){if(null!=t.strokeOpacity&&1!==t.strokeOpacity){var a=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=a}else e.stroke()}function D8e(e,t,a){var n=H$e(t.image,t.__image,a);if(W$e(n)){var r=e.createPattern(n,t.repeat||"repeat");if("function"==typeof DOMMatrix&&r&&r.setTransform){var i=new DOMMatrix;i.translateSelf(t.x||0,t.y||0),i.rotateSelf(0,0,(t.rotation||0)*tWe),i.scaleSelf(t.scaleX||1,t.scaleY||1),r.setTransform(i)}return r}}var P8e=["shadowBlur","shadowOffsetX","shadowOffsetY"],L8e=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function N8e(e,t,a,n,r){var i=!1;if(!n&&t===(a=a||{}))return!1;if(n||t.opacity!==a.opacity){B8e(e,r),i=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?uKe.opacity:o}(n||t.blend!==a.blend)&&(i||(B8e(e,r),i=!0),e.globalCompositeOperation=t.blend||uKe.blend);for(var s=0;s<P8e.length;s++){var l=P8e[s];(n||t[l]!==a[l])&&(i||(B8e(e,r),i=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==a.shadowColor)&&(i||(B8e(e,r),i=!0),e.shadowColor=t.shadowColor||uKe.shadowColor),i}function O8e(e,t,a,n,r){var i=U8e(t,r.inHover),o=n?null:a&&U8e(a,r.inHover)||{};if(i===o)return!1;var s=N8e(e,i,o,n,r);if((n||i.fill!==o.fill)&&(s||(B8e(e,r),s=!0),A8e(i.fill)&&(e.fillStyle=i.fill)),(n||i.stroke!==o.stroke)&&(s||(B8e(e,r),s=!0),A8e(i.stroke)&&(e.strokeStyle=i.stroke)),(n||i.opacity!==o.opacity)&&(s||(B8e(e,r),s=!0),e.globalAlpha=null==i.opacity?1:i.opacity),t.hasStroke()){var l=i.lineWidth/(i.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==l&&(s||(B8e(e,r),s=!0),e.lineWidth=l)}for(var c=0;c<L8e.length;c++){var u=L8e[c],d=u[0];(n||i[d]!==o[d])&&(s||(B8e(e,r),s=!0),e[d]=i[d]||u[1])}return s}function F8e(e,t){var a=t.transform,n=e.dpr||1;a?e.setTransform(n*a[0],n*a[1],n*a[2],n*a[3],n*a[4],n*a[5]):e.setTransform(n,0,0,n,0,0)}function B8e(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function U8e(e,t){return t&&e.__hoverStyle||e.style}function z8e(e,t){V8e(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function V8e(e,t,a,n){var r=t.transform;if(!t.shouldBePainted(a.viewWidth,a.viewHeight,!1,!1))return t.__dirty&=-2,void(t.__isRendered=!1);var i=t.__clipPaths,o=a.prevElClipPaths,s=!1,l=!1;if(o&&!function(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!0;return!1}(i,o)||(o&&o.length&&(B8e(e,a),e.restore(),l=s=!0,a.prevElClipPaths=null,a.allClipped=!1,a.prevEl=null),i&&i.length&&(B8e(e,a),e.save(),function(e,t,a){for(var n=!1,r=0;r<e.length;r++){var i=e[r];n=n||i.isZeroArea(),F8e(t,i),t.beginPath(),i.buildPath(t,i.shape),t.clip()}a.allClipped=n}(i,e,a),s=!0),a.prevElClipPaths=i),a.allClipped)t.__isRendered=!1;else{t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var c=a.prevEl;c||(l=s=!0);var u,d,h=t instanceof gZe&&t.autoBatch&&function(e){var t=E8e(e),a=C8e(e);return!(e.lineDash||!(+t^+a)||t&&"string"!=typeof e.fill||a&&"string"!=typeof e.stroke||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}(t.style);s||(u=r,d=c.transform,u&&d?u[0]!==d[0]||u[1]!==d[1]||u[2]!==d[2]||u[3]!==d[3]||u[4]!==d[4]||u[5]!==d[5]:u||d)?(B8e(e,a),F8e(e,t)):h||B8e(e,a);var p=U8e(t,a.inHover);t instanceof gZe?(1!==a.lastDrawType&&(l=!0,a.lastDrawType=1),O8e(e,t,c,l,a),h&&(a.batchFill||a.batchStroke)||e.beginPath(),function(e,t,a,n){var r,i=C8e(a),o=E8e(a),s=a.strokePercent,l=s<1,c=!t.path;t.silent&&!l||!c||t.createPathProxy();var u=t.path||k8e,d=t.__dirty;if(!n){var h=a.fill,p=a.stroke,f=o&&!!h.colorStops,m=i&&!!p.colorStops,v=o&&!!h.image,g=i&&!!p.image,y=void 0,b=void 0,x=void 0,w=void 0,_=void 0;(f||m)&&(_=t.getBoundingRect()),f&&(y=d?_8e(e,h,_):t.__canvasFillGradient,t.__canvasFillGradient=y),m&&(b=d?_8e(e,p,_):t.__canvasStrokeGradient,t.__canvasStrokeGradient=b),v&&(x=d||!t.__canvasFillPattern?D8e(e,h,t):t.__canvasFillPattern,t.__canvasFillPattern=x),g&&(w=d||!t.__canvasStrokePattern?D8e(e,p,t):t.__canvasStrokePattern,t.__canvasStrokePattern=w),f?e.fillStyle=y:v&&(x?e.fillStyle=x:o=!1),m?e.strokeStyle=b:g&&(w?e.strokeStyle=w:i=!1)}var S,M,T=t.getGlobalScale();u.setScale(T[0],T[1],t.segmentIgnoreThreshold),e.setLineDash&&a.lineDash&&(S=(r=T8e(t))[0],M=r[1]);var k=!0;(c||4&d)&&(u.setDPR(e.dpr),l?u.setContext(null):(u.setContext(e),k=!1),u.reset(),t.buildPath(u,t.shape,n),u.toStatic(),t.pathUpdated()),k&&u.rebuildPath(e,l?s:1),S&&(e.setLineDash(S),e.lineDashOffset=M),n||(a.strokeFirst?(i&&R8e(e,a),o&&I8e(e,a)):(o&&I8e(e,a),i&&R8e(e,a))),S&&e.setLineDash([])}(e,t,p,h),h&&(a.batchFill=p.fill||"",a.batchStroke=p.stroke||"")):t instanceof bZe?(3!==a.lastDrawType&&(l=!0,a.lastDrawType=3),O8e(e,t,c,l,a),function(e,t,a){var n,r=a.text;if(null!=r&&(r+=""),r){e.font=a.font||WHe,e.textAlign=a.textAlign,e.textBaseline=a.textBaseline;var i=void 0,o=void 0;e.setLineDash&&a.lineDash&&(i=(n=T8e(t))[0],o=n[1]),i&&(e.setLineDash(i),e.lineDashOffset=o),a.strokeFirst?(C8e(a)&&e.strokeText(r,a.x,a.y),E8e(a)&&e.fillText(r,a.x,a.y)):(E8e(a)&&e.fillText(r,a.x,a.y),C8e(a)&&e.strokeText(r,a.x,a.y)),i&&e.setLineDash([])}}(e,t,p)):t instanceof _Ze?(2!==a.lastDrawType&&(l=!0,a.lastDrawType=2),function(e,t,a,n,r){N8e(e,U8e(t,r.inHover),a&&U8e(a,r.inHover),n,r)}(e,t,c,l,a),function(e,t,a){var n=t.__image=H$e(a.image,t.__image,t,t.onload);if(n&&W$e(n)){var r=a.x||0,i=a.y||0,o=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(null==o&&null!=s?o=s*l:null==s&&null!=o?s=o/l:null==o&&null==s&&(o=n.width,s=n.height),a.sWidth&&a.sHeight){var c=a.sx||0,u=a.sy||0;e.drawImage(n,c,u,a.sWidth,a.sHeight,r,i,o,s)}else if(a.sx&&a.sy){var d=o-(c=a.sx),h=s-(u=a.sy);e.drawImage(n,c,u,d,h,r,i,o,s)}else e.drawImage(n,r,i,o,s)}}(e,t,p)):t.getTemporalDisplayables&&(4!==a.lastDrawType&&(l=!0,a.lastDrawType=4),function(e,t,a){var n=t.getDisplayables(),r=t.getTemporalDisplayables();e.save();var i,o,s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:a.viewWidth,viewHeight:a.viewHeight,inHover:a.inHover};for(i=t.getCursor(),o=n.length;i<o;i++){(u=n[i]).beforeBrush&&u.beforeBrush(),u.innerBeforeBrush(),V8e(e,u,s,i===o-1),u.innerAfterBrush(),u.afterBrush&&u.afterBrush(),s.prevEl=u}for(var l=0,c=r.length;l<c;l++){var u;(u=r[l]).beforeBrush&&u.beforeBrush(),u.innerBeforeBrush(),V8e(e,u,s,l===c-1),u.innerAfterBrush(),u.afterBrush&&u.afterBrush(),s.prevEl=u}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}(e,t,a)),h&&n&&B8e(e,a),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),a.prevEl=t,t.__dirty=0,t.__isRendered=!0}}var H8e=new c8e,G8e=new vYe(100),W8e=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function q8e(e,t){if("none"===e)return null;var a=t.getDevicePixelRatio(),n=t.getZr(),r="svg"===n.painter.type;e.dirty&&H8e.delete(e);var i=H8e.get(e);if(i)return i;var o=pGe(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});"none"===o.backgroundColor&&(o.backgroundColor=null);var s={repeat:"repeat"};return function(e){for(var t,i=[a],s=!0,l=0;l<W8e.length;++l){var c=o[W8e[l]];if(null!=c&&!TGe(c)&&!CGe(c)&&!EGe(c)&&"boolean"!=typeof c){s=!1;break}i.push(c)}if(s){t=i.join(",")+(r?"-svg":"");var u=G8e.get(t);u&&(r?e.svgElement=u:e.image=u)}var d,h=j8e(o.dashArrayX),p=function(e){if(!e||"object"==typeof e&&0===e.length)return[0,0];if(EGe(e)){var t=Math.ceil(e);return[t,t]}var a=yGe(e,function(e){return Math.ceil(e)});return e.length%2?a.concat(a):a}(o.dashArrayY),f=Y8e(o.symbol),m=(x=h,yGe(x,function(e){return X8e(e)})),v=X8e(p),g=!r&&XHe.createCanvas(),y=r&&{tag:"g",attrs:{},key:"dcl",children:[]},b=function(){for(var e=1,t=0,a=m.length;t<a;++t)e=ZXe(e,m[t]);var n=1;for(t=0,a=f.length;t<a;++t)n=ZXe(n,f[t].length);e*=n;var r=v*m.length*f.length;return{width:Math.max(1,Math.min(e,o.maxTileWidth)),height:Math.max(1,Math.min(r,o.maxTileHeight))}}();var x;g&&(g.width=b.width*a,g.height=b.height*a,d=g.getContext("2d"));(function(){d&&(d.clearRect(0,0,g.width,g.height),o.backgroundColor&&(d.fillStyle=o.backgroundColor,d.fillRect(0,0,g.width,g.height)));for(var e=0,t=0;t<p.length;++t)e+=p[t];if(e<=0)return;var i=-v,s=0,l=0,c=0;for(;i<b.height;){if(s%2==0){for(var u=l/2%f.length,m=0,x=0,w=0;m<2*b.width;){var _=0;for(t=0;t<h[c].length;++t)_+=h[c][t];if(_<=0)break;if(x%2==0){var S=.5*(1-o.symbolSize),M=m+h[c][x]*S,T=i+p[s]*S,k=h[c][x]*o.symbolSize,C=p[s]*o.symbolSize,A=w/2%f[u].length;E(M,T,k,C,f[u][A])}m+=h[c][x],++w,++x===h[c].length&&(x=0)}++c===h.length&&(c=0)}i+=p[s],++l,++s===p.length&&(s=0)}function E(e,t,i,s,l){var c=r?1:a,u=y8e(l,e*c,t*c,i*c,s*c,o.color,o.symbolKeepAspect);if(r){var h=n.painter.renderOneToVNode(u);h&&y.children.push(h)}else z8e(d,u)}})(),s&&G8e.put(t,g||y);e.image=g,e.svgElement=y,e.svgWidth=b.width,e.svgHeight=b.height}(s),s.rotation=o.rotation,s.scaleX=s.scaleY=r?1:1/a,H8e.set(e,s),e.dirty=!1,s}function Y8e(e){if(!e||0===e.length)return[["rect"]];if(CGe(e))return[[e]];for(var t=!0,a=0;a<e.length;++a)if(!CGe(e[a])){t=!1;break}if(t)return Y8e([e]);var n=[];for(a=0;a<e.length;++a)CGe(e[a])?n.push([e[a]]):n.push(e[a]);return n}function j8e(e){if(!e||0===e.length)return[[0,0]];if(EGe(e))return[[r=Math.ceil(e),r]];for(var t=!0,a=0;a<e.length;++a)if(!EGe(e[a])){t=!1;break}if(t)return j8e([e]);var n=[];for(a=0;a<e.length;++a)if(EGe(e[a])){var r=Math.ceil(e[a]);n.push([r,r])}else{r=yGe(e[a],function(e){return Math.ceil(e)});r.length%2==1?n.push(r.concat(r)):n.push(r)}return n}function X8e(e){for(var t=0,a=0;a<e.length;++a)t+=e[a];return e.length%2==1?2*t:t}var $8e=new wWe,K8e={};var Z8e={};var J8e=2e3,Q8e=4500,e7e={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:J8e,CHART:3e3,POST_CHART_LAYOUT:4600,COMPONENT:4e3,BRUSH:5e3,CHART_ITEM:Q8e,ARIA:6e3,DECAL:7e3}},t7e="__flagInMainProcess",a7e="__mainProcessVersion",n7e="__pendingUpdate",r7e="__needsUpdateStatus",i7e=/^[a-zA-Z0-9_]+$/,o7e="__connectUpdateStatus";function s7e(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];if(!this.isDisposed())return c7e(this,e,t);this.id}}function l7e(e){return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return c7e(this,e,t)}}function c7e(e,t,a){return a[0]=a[0]&&a[0].toLowerCase(),wWe.prototype[t].apply(e,a)}var u7e,d7e,h7e,p7e,f7e,m7e,v7e,g7e,y7e,b7e,x7e,w7e,_7e,S7e,M7e,T7e,k7e,C7e,A7e,E7e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t}(wWe),I7e=E7e.prototype;I7e.on=l7e("on"),I7e.off=l7e("off");var R7e=function(e){function t(t,a,n){var r=e.call(this,new K6e)||this;r._chartsViews=[],r._chartsMap={},r._componentsViews=[],r._componentsMap={},r._pendingActions=[],n=n||{},r._dom=t;r[a7e]=1,n.ssr&&(SXe=function(e){var t=YZe(e),a=t.dataIndex;if(null!=a){var n=$Ge();return n.set("series_index",t.seriesIndex),n.set("data_index",a),t.ssrType&&n.set("ssr_type",t.ssrType),n}});var i=r._zr=TXe(t,{renderer:n.renderer||"canvas",devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height,ssr:n.ssr,useDirtyRect:FGe(n.useDirtyRect,!1),useCoarsePointer:FGe(n.useCoarsePointer,"auto"),pointerSize:n.pointerSize});r._ssr=n.ssr,r._throttledZrFlush=v6e(SGe(i.flush,i),17),r._updateTheme(a),r._locale=function(e){if(CGe(e)){var t=O1e[e.toUpperCase()]||{};return e===P1e||e===L1e?cGe(t):uGe(cGe(t),cGe(O1e[N1e]),!1)}return uGe(cGe(e),cGe(O1e[N1e]),!1)}(n.locale||B1e),r._coordSysMgr=new D2e;var o=r._api=M7e(r);function s(e,t){return e.__prio-t.__prio}return Lqe(U7e,s),Lqe(F7e,s),r._scheduler=new E6e(r,o,F7e,U7e),r._messageCenter=new E7e,r._initEvents(),r.resize=SGe(r.resize,r),i.animation.on("frame",r._onframe,r),b7e(i,r),x7e(i,r),WGe(r),r}return zHe(t,e),t.prototype._onframe=function(){if(!this._disposed){C7e(this);var e=this._scheduler;if(this[n7e]){var t=this[n7e].silent;this[t7e]=!0,A7e(this);try{u7e(this),p7e.update.call(this,null,this[n7e].updateParams)}catch(TQe){throw this[t7e]=!1,this[n7e]=null,TQe}this._zr.flush(),this[t7e]=!1,this[n7e]=null,g7e.call(this,t),y7e.call(this,t)}else if(e.unfinished){var a=1,n=this._model,r=this._api;e.unfinished=!1;do{var i=+new Date;e.performSeriesTasks(n),e.performDataProcessorTasks(n),m7e(this,n),e.performVisualTasks(n),S7e(this,this._model,r,"remain",{}),a-=+new Date-i}while(a>0&&e.unfinished);e.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(e,t,a){if(!this[t7e])if(this._disposed)this.id;else{var n,r,i;if(IGe(t)&&(a=t.lazyUpdate,n=t.silent,r=t.replaceMerge,i=t.transition,t=t.notMerge),this[t7e]=!0,A7e(this),!this._model||t){var o=new K5e(this._api),s=this._theme,l=this._model=new G5e;l.scheduler=this._scheduler,l.ssr=this._ssr,l.init(null,null,null,s,this._locale,o)}this._model.setOption(e,{replaceMerge:r},B7e);var c={seriesTransition:i,optionChanged:!0};if(a)this[n7e]={silent:n,updateParams:c},this[t7e]=!1,this.getZr().wakeUp();else{try{u7e(this),p7e.update.call(this,null,c)}catch(TQe){throw this[n7e]=null,this[t7e]=!1,TQe}this._ssr||this._zr.flush(),this[n7e]=null,this[t7e]=!1,g7e.call(this,n),y7e.call(this,n)}}},t.prototype.setTheme=function(e,t){if(!this[t7e])if(this._disposed)this.id;else{var a=this._model;if(a){var n=t&&t.silent,r=null;this[n7e]&&(null==n&&(n=this[n7e].silent),r=this[n7e].updateParams,this[n7e]=null),this[t7e]=!0,A7e(this);try{this._updateTheme(e),a.setTheme(this._theme),u7e(this),p7e.update.call(this,{type:"setTheme"},r)}catch(TQe){throw this[t7e]=!1,TQe}this[t7e]=!1,g7e.call(this,n),y7e.call(this,n)}}},t.prototype._updateTheme=function(e){CGe(e)&&(e=z7e[e]),e&&((e=cGe(e))&&g4e(e,!0),this._theme=e)},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||HHe.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(e){return this.renderToCanvas(e)},t.prototype.renderToCanvas=function(e){return e=e||{},this._zr.painter.getRenderedCanvas({backgroundColor:e.backgroundColor||this._model.get("backgroundColor"),pixelRatio:e.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(e){return e=e||{},this._zr.painter.renderToString({useViewBox:e.useViewBox})},t.prototype.getSvgDataURL=function(){var e=this._zr;return gGe(e.storage.getDisplayList(),function(e){e.stopAnimation(null,!0)}),e.painter.toDataURL()},t.prototype.getDataURL=function(e){if(!this._disposed){var t=(e=e||{}).excludeComponents,a=this._model,n=[],r=this;gGe(t,function(e){a.eachComponent({mainType:e},function(e){var t=r._componentsMap[e.__viewId];t.group.ignore||(n.push(t),t.group.ignore=!0)})});var i="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.renderToCanvas(e).toDataURL("image/"+(e&&e.type||"png"));return gGe(n,function(e){e.group.ignore=!1}),i}this.id},t.prototype.getConnectedDataURL=function(e){if(!this._disposed){var t="svg"===e.type,a=this.group,n=Math.min,r=Math.max,i=1/0;if(G7e[a]){var o=i,s=i,l=-1/0,c=-1/0,u=[],d=e&&e.pixelRatio||this.getDevicePixelRatio();gGe(H7e,function(i,d){if(i.group===a){var h=t?i.getZr().painter.getSvgDom().innerHTML:i.renderToCanvas(cGe(e)),p=i.getDom().getBoundingClientRect();o=n(p.left,o),s=n(p.top,s),l=r(p.right,l),c=r(p.bottom,c),u.push({dom:h,left:p.left,top:p.top})}});var h=(l*=d)-(o*=d),p=(c*=d)-(s*=d),f=XHe.createCanvas(),m=TXe(f,{renderer:t?"svg":"canvas"});if(m.resize({width:h,height:p}),t){var v="";return gGe(u,function(e){var t=e.left-o,a=e.top-s;v+='<g transform="translate('+t+","+a+')">'+e.dom+"</g>"}),m.painter.getSvgRoot().innerHTML=v,e.connectedBackgroundColor&&m.painter.setBackgroundColor(e.connectedBackgroundColor),m.refreshImmediately(),m.painter.toDataURL()}return e.connectedBackgroundColor&&m.add(new EZe({shape:{x:0,y:0,width:h,height:p},style:{fill:e.connectedBackgroundColor}})),gGe(u,function(e){var t=new _Ze({style:{x:e.left*d-o,y:e.top*d-s,image:e.dom}});m.add(t)}),m.refreshImmediately(),f.toDataURL("image/"+(e&&e.type||"png"))}return this.getDataURL(e)}this.id},t.prototype.convertToPixel=function(e,t,a){return f7e(this,"convertToPixel",e,t,a)},t.prototype.convertToLayout=function(e,t,a){return f7e(this,"convertToLayout",e,t,a)},t.prototype.convertFromPixel=function(e,t,a){return f7e(this,"convertFromPixel",e,t,a)},t.prototype.containPixel=function(e,t){var a;if(!this._disposed)return gGe(y$e(this._model,e),function(e,n){n.indexOf("Models")>=0&&gGe(e,function(e){var r=e.coordinateSystem;if(r&&r.containPoint)a=a||!!r.containPoint(t);else if("seriesModels"===n){var i=this._chartsMap[e.__viewId];i&&i.containPoint&&(a=a||i.containPoint(t,e))}},this)},this),!!a;this.id},t.prototype.getVisual=function(e,t){var a=y$e(this._model,e,{defaultMainType:"series"}),n=a.seriesModel.getData(),r=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?n.indexOfRawIndex(a.dataIndex):null;return null!=r?t8e(n,r,t):a8e(n,t)},t.prototype.getViewOfComponentModel=function(e){return this._componentsMap[e.__viewId]},t.prototype.getViewOfSeriesModel=function(e){return this._chartsMap[e.__viewId]},t.prototype._initEvents=function(){var e=this;gGe(P7e,function(t){var a=function(a){var n,r=e.getModel(),i=a.target;if("globalout"===t?n={}:i&&o8e(i,function(e){var t=YZe(e);if(t&&null!=t.dataIndex){var a=t.dataModel||r.getSeriesByIndex(t.seriesIndex);return n=a&&a.getDataParams(t.dataIndex,t.dataType,i)||{},!0}if(t.eventData)return n=hGe({},t.eventData),!0},!0),n){var o=n.componentType,s=n.componentIndex;"markLine"!==o&&"markPoint"!==o&&"markArea"!==o||(o="series",s=n.seriesIndex);var l=o&&null!=s&&r.getComponent(o,s),c=l&&e["series"===l.mainType?"_chartsMap":"_componentsMap"][l.__viewId];n.event=a,n.type=t,e._$eventProcessor.eventInfo={targetEl:i,packedEvent:n,model:l,view:c},e.trigger(t,n)}};a.zrEventfulCallAtLast=!0,e._zr.on(t,a,e)});var t=this._messageCenter;gGe(O7e,function(a,n){t.on(n,function(t){e.trigger(n,t)})}),function(e,t,a){e.on("selectchanged",function(e){var n=a.getModel();e.isFromClick?(i8e("map","selectchanged",t,n,e),i8e("pie","selectchanged",t,n,e)):"select"===e.fromAction?(i8e("map","selected",t,n,e),i8e("pie","selected",t,n,e)):"unselect"===e.fromAction&&(i8e("map","unselected",t,n,e),i8e("pie","unselected",t,n,e))})}(t,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){this._disposed?this.id:this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed)this.id;else{this._disposed=!0,this.getDom()&&S$e(this.getDom(),q7e,"");var e=this,t=e._api,a=e._model;gGe(e._componentsViews,function(e){e.dispose(a,t)}),gGe(e._chartsViews,function(e){e.dispose(a,t)}),e._zr.dispose(),e._dom=e._model=e._chartsMap=e._componentsMap=e._chartsViews=e._componentsViews=e._scheduler=e._api=e._zr=e._throttledZrFlush=e._theme=e._coordSysMgr=e._messageCenter=null,delete H7e[e.id]}},t.prototype.resize=function(e){if(!this[t7e])if(this._disposed)this.id;else{this._zr.resize(e);var t=this._model;if(this._loadingFX&&this._loadingFX.resize(),t){var a=t.resetOption("media"),n=e&&e.silent;this[n7e]&&(null==n&&(n=this[n7e].silent),a=!0,this[n7e]=null),this[t7e]=!0,A7e(this);try{a&&u7e(this),p7e.update.call(this,{type:"resize",animation:hGe({duration:0},e&&e.animation)})}catch(TQe){throw this[t7e]=!1,TQe}this[t7e]=!1,g7e.call(this,n),y7e.call(this,n)}}},t.prototype.showLoading=function(e,t){if(this._disposed)this.id;else if(IGe(e)&&(t=e,e=""),e=e||"default",this.hideLoading(),V7e[e]){var a=V7e[e](this._api,t),n=this._zr;this._loadingFX=a,n.add(a)}},t.prototype.hideLoading=function(){this._disposed?this.id:(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},t.prototype.makeActionFromEvent=function(e){var t=hGe({},e);return t.type=N7e[e.type],t},t.prototype.dispatchAction=function(e,t){if(this._disposed)this.id;else if(IGe(t)||(t={silent:!!t}),L7e[e.type]&&this._model)if(this[t7e])this._pendingActions.push(e);else{var a=t.silent;v7e.call(this,e,a);var n=t.flush;n?this._zr.flush():!1!==n&&HHe.browser.weChat&&this._throttledZrFlush(),g7e.call(this,a),y7e.call(this,a)}},t.prototype.updateLabelLayout=function(){$8e.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(e){if(this._disposed)this.id;else{var t=e.seriesIndex;this.getModel().getSeriesByIndex(t).appendData(e),this._scheduler.unfinished=!0,this.getZr().wakeUp()}},t.internalField=function(){function e(e){e.clearColorPalette(),e.eachSeries(function(e){e.clearColorPalette()})}function t(e){for(var t=[],a=e.currentStates,n=0;n<a.length;n++){var r=a[n];"emphasis"!==r&&"blur"!==r&&"select"!==r&&t.push(r)}e.selected&&e.states.select&&t.push("select"),2===e.hoverState&&e.states.emphasis?t.push("emphasis"):1===e.hoverState&&e.states.blur&&t.push("blur"),e.useStates(t)}function a(e,t){if(!e.preventAutoZ){var a=K0e(e);t.eachRendered(function(e){return J0e(e,a.z,a.zlevel),!0})}}function n(e,t){t.eachRendered(function(e){if(!h0e(e)){var t=e.getTextContent(),a=e.getTextGuideLine();e.stateTransition&&(e.stateTransition=null),t&&t.stateTransition&&(t.stateTransition=null),a&&a.stateTransition&&(a.stateTransition=null),e.hasState()?(e.prevStates=e.currentStates,e.clearStates()):e.prevStates&&(e.prevStates=null)}})}function r(e,a){var n=e.getModel("stateAnimation"),r=e.isAnimationEnabled(),i=n.get("duration"),o=i>0?{duration:i,delay:n.get("delay"),easing:n.get("easing")}:null;a.eachRendered(function(e){if(e.states&&e.states.emphasis){if(h0e(e))return;if(e instanceof gZe&&function(e){var t=KZe(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var a=e.states.select||{};t.selectFill=a.style&&a.style.fill||null,t.selectStroke=a.style&&a.style.stroke||null}(e),e.__dirty){var a=e.prevStates;a&&e.useStates(a)}if(r){e.stateTransition=o;var n=e.getTextContent(),i=e.getTextGuideLine();n&&(n.stateTransition=o),i&&(i.stateTransition=o)}e.__dirty&&t(e)}})}u7e=function(e){var t=e._scheduler;t.restorePipelines(e._model),t.prepareStageTasks(),d7e(e,!0),d7e(e,!1),t.plan()},d7e=function(e,t){for(var a=e._model,n=e._scheduler,r=t?e._componentsViews:e._chartsViews,i=t?e._componentsMap:e._chartsMap,o=e._zr,s=e._api,l=0;l<r.length;l++)r[l].__alive=!1;function c(e){var l=e.__requireNewView;e.__requireNewView=!1;var c="_ec_"+e.id+"_"+e.type,u=!l&&i[c];if(!u){var d=I$e(e.type);(u=new(t?n6e.getClass(d.main,d.sub):s6e.getClass(d.sub))).init(a,s),i[c]=u,r.push(u),o.add(u.group)}e.__viewId=u.__id=c,u.__alive=!0,u.__model=e,u.group.__ecComponentInfo={mainType:e.mainType,index:e.componentIndex},!t&&n.prepareView(u,e,a,s)}t?a.eachComponent(function(e,t){"series"!==e&&c(t)}):a.eachSeries(c);for(l=0;l<r.length;){var u=r[l];u.__alive?l++:(!t&&u.renderTask.dispose(),o.remove(u.group),u.dispose(a,s),r.splice(l,1),i[u.__id]===u&&delete i[u.__id],u.__id=u.group.__ecComponentInfo=null)}},h7e=function(e,t,a,n,r){var i=e._model;if(i.setUpdatePayload(a),n){var o={};o[n+"Id"]=a[n+"Id"],o[n+"Index"]=a[n+"Index"],o[n+"Name"]=a[n+"Name"];var s={mainType:n,query:o};r&&(s.subType=r);var l,c=a.excludeSeriesId;null!=c&&(l=$Ge(),gGe(r$e(c),function(e){var t=h$e(e,null);null!=t&&l.set(t,!0)})),i&&i.eachComponent(s,function(t){if(!(l&&null!=l.get(t.id)))if(WJe(a))if(t instanceof $3e)a.type!==tJe||a.notBlur||t.get(["emphasis","disabled"])||function(e,t,a){var n=e.seriesIndex,r=e.getData(t.dataType);if(r){var i=m$e(r,t);i=(TGe(i)?i[0]:i)||0;var o=r.getItemGraphicEl(i);if(!o)for(var s=r.count(),l=0;!o&&l<s;)o=r.getItemGraphicEl(l++);if(o){var c=YZe(o);IJe(n,c.focus,c.blurScope,a)}else{var u=e.get(["emphasis","focus"]),d=e.get(["emphasis","blurScope"]);null!=u&&IJe(n,u,d,a)}}}(t,a,e._api);else{var n=DJe(t.mainType,t.componentIndex,a.name,e._api),r=n.focusSelf,i=n.dispatchers;a.type===tJe&&r&&!a.notBlur&&RJe(t.mainType,t.componentIndex,e._api),i&&gGe(i,function(e){a.type===tJe?_Je(e):SJe(e)})}else GJe(a)&&t instanceof $3e&&(!function(e,t){if(GJe(t)){var a=t.dataType,n=m$e(e.getData(a),t);TGe(n)||(n=[n]),e[t.type===iJe?"toggleSelect":t.type===nJe?"select":"unselect"](n,a)}}(t,a,e._api),PJe(t),k7e(e))},e),i&&i.eachComponent(s,function(t){l&&null!=l.get(t.id)||u(e["series"===n?"_chartsMap":"_componentsMap"][t.__viewId])},e)}else gGe([].concat(e._componentsViews).concat(e._chartsViews),u);function u(n){n&&n.__alive&&n[t]&&n[t](n.__model,i,e._api,a)}},p7e={prepareAndUpdate:function(e){u7e(this),p7e.update.call(this,e,e&&{optionChanged:null!=e.newOption})},update:function(t,a){var n=this._model,r=this._api,i=this._zr,o=this._coordSysMgr,s=this._scheduler;if(n){n.setUpdatePayload(t),s.restoreData(n,t),s.performSeriesTasks(n),o.create(n,r),s.performDataProcessorTasks(n,t),m7e(this,n),o.update(n,r),e(n),s.performVisualTasks(n,t);var l=n.get("backgroundColor")||"transparent";i.setBackgroundColor(l);var c=n.get("darkMode");null!=c&&"auto"!==c&&i.setDarkMode(c),w7e(this,n,r,t,a),$8e.trigger("afterupdate",n,r)}},updateTransform:function(t){var a=this,n=this._model,r=this._api;if(n){n.setUpdatePayload(t);var i=[];n.eachComponent(function(e,o){if("series"!==e){var s=a.getViewOfComponentModel(o);if(s&&s.__alive)if(s.updateTransform){var l=s.updateTransform(o,n,r,t);l&&l.update&&i.push(s)}else i.push(s)}});var o=$Ge();n.eachSeries(function(e){var i=a._chartsMap[e.__viewId];if(i.updateTransform){var s=i.updateTransform(e,n,r,t);s&&s.update&&o.set(e.uid,1)}else o.set(e.uid,1)}),e(n),this._scheduler.performVisualTasks(n,t,{setDirty:!0,dirtyMap:o}),S7e(this,n,r,t,{},o),$8e.trigger("afterupdate",n,r)}},updateView:function(t){var a=this._model;a&&(a.setUpdatePayload(t),s6e.markUpdateMethod(t,"updateView"),e(a),this._scheduler.performVisualTasks(a,t,{setDirty:!0}),w7e(this,a,this._api,t,{}),$8e.trigger("afterupdate",a,this._api))},updateVisual:function(t){var a=this,n=this._model;n&&(n.setUpdatePayload(t),n.eachSeries(function(e){e.getData().clearAllVisual()}),s6e.markUpdateMethod(t,"updateVisual"),e(n),this._scheduler.performVisualTasks(n,t,{visualType:"visual",setDirty:!0}),n.eachComponent(function(e,r){if("series"!==e){var i=a.getViewOfComponentModel(r);i&&i.__alive&&i.updateVisual(r,n,a._api,t)}}),n.eachSeries(function(e){a._chartsMap[e.__viewId].updateVisual(e,n,a._api,t)}),$8e.trigger("afterupdate",n,this._api))},updateLayout:function(e){p7e.update.call(this,e)}},f7e=function(e,t,a,n,r){if(e._disposed)e.id;else for(var i,o=e._model,s=e._coordSysMgr.getCoordinateSystems(),l=y$e(o,a),c=0;c<s.length;c++){var u=s[c];if(u[t]&&null!=(i=u[t](o,l,n,r)))return i}},m7e=function(e,t){var a=e._chartsMap,n=e._scheduler;t.eachSeries(function(e){n.updateStreamModes(e,a[e.__viewId])})},v7e=function(e,t){var a=this,n=this.getModel(),r=e.type,i=e.escapeConnect,o=L7e[r],s=(o.update||"update").split(":"),l=s.pop(),c=null!=s[0]&&I$e(s[0]);this[t7e]=!0,A7e(this);var u=[e],d=!1;e.batch&&(d=!0,u=yGe(e.batch,function(t){return(t=pGe(hGe({},t),e)).batch=null,t}));var h,p=[],f=[],m=o.nonRefinedEventType,v=GJe(e),g=WJe(e);if(g&&EJe(this._api),gGe(u,function(t){var r=o.action(t,n,a._api);if(o.refineEvent?f.push(r):h=r,(h=h||hGe({},t)).type=m,p.push(h),g){var i=b$e(e),s=i.queryOptionMap,u=i.mainTypeSpecified?s.keys()[0]:"series";h7e(a,l,t,u),k7e(a)}else v?(h7e(a,l,t,"series"),k7e(a)):c&&h7e(a,l,t,c.main,c.sub)}),"none"!==l&&!g&&!v&&!c)try{this[n7e]?(u7e(this),p7e.update.call(this,e),this[n7e]=null):p7e[l].call(this,e)}catch(TQe){throw this[t7e]=!1,TQe}if(h=d?{type:m,escapeConnect:i,batch:p}:p[0],this[t7e]=!1,!t){var y=void 0;if(o.refineEvent){var b=o.refineEvent(f,e,n,this._api).eventContent;VGe(IGe(b)),(y=pGe({type:o.refinedEventType},b)).fromAction=e.type,y.fromActionPayload=e,y.escapeConnect=!0}var x=this._messageCenter;x.trigger(h.type,h),y&&x.trigger(y.type,y)}},g7e=function(e){for(var t=this._pendingActions;t.length;){var a=t.shift();v7e.call(this,a,e)}},y7e=function(e){!e&&this.trigger("updated")},b7e=function(e,t){e.on("rendered",function(a){t.trigger("rendered",a),!e.animation.isFinished()||t[n7e]||t._scheduler.unfinished||t._pendingActions.length||t.trigger("finished")})},x7e=function(e,t){e.on("mouseover",function(e){var a=o8e(e.target,HJe);a&&(!function(e,t,a){var n=YZe(e),r=DJe(n.componentMainType,n.componentIndex,n.componentHighDownName,a),i=r.dispatchers,o=r.focusSelf;i?(o&&RJe(n.componentMainType,n.componentIndex,a),gGe(i,function(e){return xJe(e,t)})):(IJe(n.seriesIndex,n.focus,n.blurScope,a),"self"===n.focus&&RJe(n.componentMainType,n.componentIndex,a),xJe(e,t))}(a,e,t._api),k7e(t))}).on("mouseout",function(e){var a=o8e(e.target,HJe);a&&(!function(e,t,a){EJe(a);var n=YZe(e),r=DJe(n.componentMainType,n.componentIndex,n.componentHighDownName,a).dispatchers;r?gGe(r,function(e){return wJe(e,t)}):wJe(e,t)}(a,e,t._api),k7e(t))}).on("click",function(e){var a=o8e(e.target,function(e){return null!=YZe(e).dataIndex},!0);if(a){var n=a.selected?"unselect":"select",r=YZe(a);t._api.dispatchAction({type:n,dataType:r.dataType,dataIndexInside:r.dataIndex,seriesIndex:r.seriesIndex,isFromClick:!0})}})},w7e=function(e,t,a,n,r){!function(e){var t=[],a=[],n=!1;if(e.eachComponent(function(e,r){var i=r.get("zlevel")||0,o=r.get("z")||0,s=r.getZLevelKey();n=n||!!s,("series"===e?a:t).push({zlevel:i,z:o,idx:r.componentIndex,type:e,key:s})}),n){var r,i,o=t.concat(a);Lqe(o,function(e,t){return e.zlevel===t.zlevel?e.z-t.z:e.zlevel-t.zlevel}),gGe(o,function(t){var a=e.getComponent(t.type,t.idx),n=t.zlevel,o=t.key;null!=r&&(n=Math.max(r,n)),o?(n===r&&o!==i&&n++,i=o):i&&(n===r&&n++,i=""),r=n,a.setZLevel(n)})}}(t),_7e(e,t,a,n,r),gGe(e._chartsViews,function(e){e.__alive=!1}),S7e(e,t,a,n,r),gGe(e._chartsViews,function(e){e.__alive||e.remove(t,a)})},_7e=function(e,t,i,o,s,l){gGe(l||e._componentsViews,function(e){var s=e.__model;n(s,e),e.render(s,t,i,o),a(s,e),r(s,e)})},S7e=function(e,t,i,o,s,l){var c=e._scheduler;s=hGe(s||{},{updatedSeries:t.getSeries()}),$8e.trigger("series:beforeupdate",t,i,s);var u=!1;t.eachSeries(function(t){var a=e._chartsMap[t.__viewId];a.__alive=!0;var r=a.renderTask;c.updatePayload(r,o),n(t,a),l&&l.get(t.uid)&&r.dirty(),r.perform(c.getPerformArgs(r))&&(u=!0),a.group.silent=!!t.get("silent"),function(e,t){var a=e.get("blendMode")||null;t.eachRendered(function(e){e.isGroup||(e.style.blend=a)})}(t,a),PJe(t)}),c.unfinished=u||c.unfinished,$8e.trigger("series:layoutlabels",t,i,s),$8e.trigger("series:transition",t,i,s),t.eachSeries(function(t){var n=e._chartsMap[t.__viewId];a(t,n),r(t,n)}),function(e,t){var a=e._zr,n=a.storage,r=0;n.traverse(function(e){e.isGroup||r++}),r>t.get("hoverLayerThreshold")&&!HHe.node&&!HHe.worker&&t.eachSeries(function(t){if(!t.preventUsingHoverLayer){var a=e._chartsMap[t.__viewId];a.__alive&&a.eachRendered(function(e){e.states.emphasis&&(e.states.emphasis.hoverLayer=!0)})}})}(e,t),$8e.trigger("series:afterupdate",t,i,s)},k7e=function(e){e[r7e]=!0,e.getZr().wakeUp()},A7e=function(e){e[a7e]=(e[a7e]+1)%1e3},C7e=function(e){e[r7e]&&(e.getZr().storage.traverse(function(e){h0e(e)||t(e)}),e[r7e]=!1)},M7e=function(e){return new(function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return zHe(a,t),a.prototype.getCoordinateSystems=function(){return e._coordSysMgr.getCoordinateSystems()},a.prototype.getComponentByElement=function(t){for(;t;){var a=t.__ecComponentInfo;if(null!=a)return e._model.getComponent(a.mainType,a.index);t=t.parent}},a.prototype.enterEmphasis=function(t,a){_Je(t,a),k7e(e)},a.prototype.leaveEmphasis=function(t,a){SJe(t,a),k7e(e)},a.prototype.enterBlur=function(t){MJe(t),k7e(e)},a.prototype.leaveBlur=function(t){TJe(t),k7e(e)},a.prototype.enterSelect=function(t){kJe(t),k7e(e)},a.prototype.leaveSelect=function(t){CJe(t),k7e(e)},a.prototype.getModel=function(){return e.getModel()},a.prototype.getViewOfComponentModel=function(t){return e.getViewOfComponentModel(t)},a.prototype.getViewOfSeriesModel=function(t){return e.getViewOfSeriesModel(t)},a.prototype.getMainProcessVersion=function(){return e[a7e]},a}(X5e))(e)},T7e=function(e){function t(e,t){for(var a=0;a<e.length;a++){e[a][o7e]=t}}gGe(N7e,function(a,n){e._messageCenter.on(n,function(a){if(G7e[e.group]&&0!==e[o7e]){if(a&&a.escapeConnect)return;var n=e.makeActionFromEvent(a),r=[];gGe(H7e,function(t){t!==e&&t.group===e.group&&r.push(t)}),t(r,0),gGe(r,function(e){1!==e[o7e]&&e.dispatchAction(n)}),t(r,2)}})})}}(),t}(wWe),D7e=R7e.prototype;D7e.on=s7e("on"),D7e.off=s7e("off"),D7e.one=function(e,t,a){var n=this;this.on.call(this,e,function a(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];t&&t.apply&&t.apply(this,r),n.off(e,a)},a)};var P7e=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var L7e={},N7e={},O7e={},F7e=[],B7e=[],U7e=[],z7e={},V7e={},H7e={},G7e={},W7e=+new Date-0,q7e="_echarts_instance_";function Y7e(e,t,a){var n=!(a&&a.ssr);if(n){var r=function(e){return H7e[function(e,t){return e.getAttribute?e.getAttribute(t):e[t]}(e,q7e)]}(e);if(r)return r}var i=new R7e(e,t,a);return i.id="ec_"+W7e++,H7e[i.id]=i,n&&S$e(e,q7e,i.id),T7e(i),$8e.trigger("afterinit",i),i}function j7e(e,t){z7e[e]=t}function X7e(e){fGe(B7e,e)<0&&B7e.push(e)}function $7e(e,t){e9e(F7e,e,t,2e3)}function K7e(e,t){$8e.on(e,t)}function Z7e(e,t,a){var n,r,i,o,s;function l(e){return e.toLowerCase()}kGe(t)&&(a=t,t=""),IGe(e)?(n=e.type,r=e.event,o=e.update,s=e.publishNonRefinedEvent,a||(a=e.action),i=e.refineEvent):(n=e,r=t),r=l(r||n);var c=i?l(n):r;L7e[n]||(VGe(i7e.test(n)&&i7e.test(r)),i&&VGe(r!==n),L7e[n]={actionType:n,refinedEventType:r,nonRefinedEventType:c,update:o,action:a,refineEvent:i},O7e[r]=1,i&&s&&(O7e[c]=1),N7e[c]=n)}function J7e(e,t){e9e(U7e,e,t,3e3,"visual")}var Q7e=[];function e9e(e,t,a,n,r){if((kGe(t)||IGe(t))&&(a=t,t=n),!(fGe(Q7e,a)>=0)){Q7e.push(a);var i=E6e.wrapStageHandler(a,r);i.__prio=t,i.__raw=a,e.push(i)}}function t9e(e,t){V7e[e]=t}var a9e=function(e){var t=(e=cGe(e)).type;t||e$e("");var a=t.split(":");2!==a.length&&e$e("");var n=!1;"echarts"===a[0]&&(t=a[1],n=!0),e.__isBuiltIn=n,u3e.set(t,e)};function n9e(e,t,a,n){return{eventContent:{selected:LJe(a),isFromClick:t.isFromClick||!1}}}function r9e(e){return null==e?0:e.length||1}function i9e(e){return e}J7e(J8e,M6e),J7e(Q8e,k6e),J7e(Q8e,C6e),J7e(J8e,Q6e),J7e(Q8e,e8e),J7e(7e3,function(e,t){e.eachRawSeries(function(a){if(!e.isSeriesFiltered(a)){var n=a.getData();n.hasItemVisual()&&n.each(function(e){var a=n.getItemVisual(e,"decal");a&&(n.ensureUniqueItemVisual(e,"style").decal=q8e(a,t))});var r=n.getVisual("decal");if(r)n.getVisual("style").decal=q8e(r,t)}})}),X7e(g4e),$7e(900,function(e){var t=$Ge();e.eachSeries(function(e){var a=e.get("stack");if(a){var n=t.get(a)||t.set(a,[]),r=e.getData(),i={stackResultDimension:r.getCalculationInfo("stackResultDimension"),stackedOverDimension:r.getCalculationInfo("stackedOverDimension"),stackedDimension:r.getCalculationInfo("stackedDimension"),stackedByDimension:r.getCalculationInfo("stackedByDimension"),isStackedByIndex:r.getCalculationInfo("isStackedByIndex"),data:r,seriesModel:e};if(!i.stackedDimension||!i.isStackedByIndex&&!i.stackedByDimension)return;n.push(i)}}),t.each(function(e){0!==e.length&&("seriesDesc"===(e[0].seriesModel.get("stackOrder")||"seriesAsc")&&e.reverse(),gGe(e,function(t,a){t.data.setCalculationInfo("stackedOnSeries",a>0?e[a-1].seriesModel:null)}),function(e){gGe(e,function(t,a){var n=[],r=[NaN,NaN],i=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";o.modify(i,function(i,c,u){var d,h,p=o.get(t.stackedDimension,u);if(isNaN(p))return r;s?h=o.getRawIndex(u):d=o.get(t.stackedByDimension,u);for(var f=NaN,m=a-1;m>=0;m--){var v=e[m];if(s||(h=v.data.rawIndexOf(v.stackedByDimension,d)),h>=0){var g=v.data.getByRawIndex(v.stackResultDimension,h);if("all"===l||"positive"===l&&g>0||"negative"===l&&g<0||"samesign"===l&&p>=0&&g>0||"samesign"===l&&p<=0&&g<0){p=FXe(p,g),f=g;break}}}return n[0]=p,n[1]=f,n})})}(e))})}),t9e("default",function(e,t){pGe(t=t||{},{text:"loading",textColor:o5e.color.primary,fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255,255,255,0.8)",showSpinner:!0,color:o5e.color.theme[0],spinnerRadius:10,lineWidth:5,zlevel:0});var a=new xXe,n=new EZe({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});a.add(n);var r,i=new PZe({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),o=new EZe({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});return a.add(o),t.showSpinner&&((r=new qQe({shape:{startAngle:-A6e/2,endAngle:-A6e/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001})).animateShape(!0).when(1e3,{endAngle:3*A6e/2}).start("circularInOut"),r.animateShape(!0).when(1e3,{startAngle:3*A6e/2}).delay(300).start("circularInOut"),a.add(r)),a.resize=function(){var a=i.getBoundingRect().width,s=t.showSpinner?t.spinnerRadius:0,l=(e.getWidth()-2*s-(t.showSpinner&&a?10:0)-a)/2-(t.showSpinner&&a?0:5+a/2)+(t.showSpinner?0:a/2)+(a?0:s),c=e.getHeight()/2;t.showSpinner&&r.setShape({cx:l,cy:c}),o.setShape({x:l-s,y:c-s,width:2*s,height:2*s}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},a.resize(),a}),Z7e({type:tJe,event:tJe,update:tJe},eWe),Z7e({type:aJe,event:aJe,update:aJe},eWe),Z7e({type:nJe,event:oJe,update:nJe,action:eWe,refineEvent:n9e,publishNonRefinedEvent:!0}),Z7e({type:rJe,event:oJe,update:rJe,action:eWe,refineEvent:n9e,publishNonRefinedEvent:!0}),Z7e({type:iJe,event:oJe,update:iJe,action:eWe,refineEvent:n9e,publishNonRefinedEvent:!0}),j7e("default",{}),j7e("dark",$6e);var o9e=function(){function e(e,t,a,n,r,i){this._old=e,this._new=t,this._oldKeyGetter=a||i9e,this._newKeyGetter=n||i9e,this.context=r,this._diffModeMultiple="multiple"===i}return e.prototype.add=function(e){return this._add=e,this},e.prototype.update=function(e){return this._update=e,this},e.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},e.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},e.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},e.prototype.remove=function(e){return this._remove=e,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var e=this._old,t=this._new,a={},n=new Array(e.length),r=new Array(t.length);this._initIndexMap(e,null,n,"_oldKeyGetter"),this._initIndexMap(t,a,r,"_newKeyGetter");for(var i=0;i<e.length;i++){var o=n[i],s=a[o],l=r9e(s);if(l>1){var c=s.shift();1===s.length&&(a[o]=s[0]),this._update&&this._update(c,i)}else 1===l?(a[o]=null,this._update&&this._update(s,i)):this._remove&&this._remove(i)}this._performRestAdd(r,a)},e.prototype._executeMultiple=function(){var e=this._old,t=this._new,a={},n={},r=[],i=[];this._initIndexMap(e,a,r,"_oldKeyGetter"),this._initIndexMap(t,n,i,"_newKeyGetter");for(var o=0;o<r.length;o++){var s=r[o],l=a[s],c=n[s],u=r9e(l),d=r9e(c);if(u>1&&1===d)this._updateManyToOne&&this._updateManyToOne(c,l),n[s]=null;else if(1===u&&d>1)this._updateOneToMany&&this._updateOneToMany(c,l),n[s]=null;else if(1===u&&1===d)this._update&&this._update(c,l),n[s]=null;else if(u>1&&d>1)this._updateManyToMany&&this._updateManyToMany(c,l),n[s]=null;else if(u>1)for(var h=0;h<u;h++)this._remove&&this._remove(l[h]);else this._remove&&this._remove(l)}this._performRestAdd(i,n)},e.prototype._performRestAdd=function(e,t){for(var a=0;a<e.length;a++){var n=e[a],r=t[n],i=r9e(r);if(i>1)for(var o=0;o<i;o++)this._add&&this._add(r[o]);else 1===i&&this._add&&this._add(r);t[n]=null}},e.prototype._initIndexMap=function(e,t,a,n){for(var r=this._diffModeMultiple,i=0;i<e.length;i++){var o="_ec_"+this[n](e[i],i);if(r||(a[i]=o),t){var s=t[o],l=r9e(s);0===l?(t[o]=i,r&&a.push(o)):1===l?t[o]=[s,i]:s.push(i)}}},e}(),s9e=function(){function e(e,t){this._encode=e,this._schema=t}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function l9e(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function c9e(e){return"category"===e?"ordinal":"time"===e?"time":"float"}var u9e=function(e){this.otherDims={},null!=e&&hGe(this,e)},d9e=v$e(),h9e={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},p9e=function(){function e(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=v9e(this.source)))},e.prototype.getSourceDimensionIndex=function(e){return FGe(this._dimNameMap.get(e),-1)},e.prototype.getSourceDimension=function(e){var t=this.source.dimensionsDefine;if(t)return t[e]},e.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,t=R4e(this.source),a=!g9e(e),n="",r=[],i=0,o=0;i<e;i++){var s=void 0,l=void 0,c=void 0,u=this.dimensions[o];if(u&&u.storeDimIndex===i)s=t?u.name:null,l=u.type,c=u.ordinalMeta,o++;else{var d=this.getSourceDimension(i);d&&(s=t?d.name:null,l=d.type)}r.push({property:s,type:l,ordinalMeta:c}),!t||null==s||u&&u.isCalculationCoord||(n+=a?s.replace(/\`/g,"`1").replace(/\$/g,"`2"):s),n+="$",n+=h9e[l]||"f",c&&(n+=c.uid),n+="$"}var h=this.source;return{dimensions:r,hash:[h.seriesLayoutBy,h.startIndex,n].join("$$")}},e.prototype.makeOutputDimensionNames=function(){for(var e=[],t=0,a=0;t<this._fullDimCount;t++){var n=void 0,r=this.dimensions[a];if(r&&r.storeDimIndex===t)r.isCalculationCoord||(n=r.name),a++;else{var i=this.getSourceDimension(t);i&&(n=i.name)}e.push(n)}return e},e.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function f9e(e){return e instanceof p9e}function m9e(e){for(var t=$Ge(),a=0;a<(e||[]).length;a++){var n=e[a],r=IGe(n)?n.name:n;null!=r&&null==t.get(r)&&t.set(r,a)}return t}function v9e(e){var t=d9e(e);return t.dimNameMap||(t.dimNameMap=m9e(e.dimensionsDefine))}function g9e(e){return e>30}var y9e,b9e,x9e,w9e,_9e,S9e,M9e,T9e=IGe,k9e=yGe,C9e="undefined"==typeof Int32Array?Array:Int32Array,A9e=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],E9e=["_approximateExtent"],I9e=function(){function e(e,t){var a;this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var n=!1;f9e(e)?(a=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(n=!0,a=e),a=a||["x","y"];for(var r={},i=[],o={},s=!1,l={},c=0;c<a.length;c++){var u=a[c],d=CGe(u)?new u9e({name:u}):u instanceof u9e?u:new u9e(u),h=d.name;d.type=d.type||"float",d.coordDim||(d.coordDim=h,d.coordDimIndex=0);var p=d.otherDims=d.otherDims||{};i.push(h),r[h]=d,null!=l[h]&&(s=!0),d.createInvertedIndices&&(o[h]=[]);var f=c;EGe(d.storeDimIndex)&&(f=d.storeDimIndex),0===p.itemName&&(this._nameDimIdx=f),0===p.itemId&&(this._idDimIdx=f),n&&(d.storeDimIndex=c)}if(this.dimensions=i,this._dimInfos=r,this._initGetDimensionInfo(s),this.hostModel=t,this._invertedIndicesMap=o,this._dimOmitted){var m=this._dimIdxToName=$Ge();gGe(i,function(e){m.set(r[e].storeDimIndex,e)})}}return e.prototype.getDimension=function(e){var t=this._recognizeDimIndex(e);if(null==t)return e;if(t=e,!this._dimOmitted)return this.dimensions[t];var a=this._dimIdxToName.get(t);if(null!=a)return a;var n=this._schema.getSourceDimension(t);return n?n.name:void 0},e.prototype.getDimensionIndex=function(e){var t=this._recognizeDimIndex(e);if(null!=t)return t;if(null==e)return-1;var a=this._getDimInfo(e);return a?a.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},e.prototype._recognizeDimIndex=function(e){if(EGe(e)||null!=e&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},e.prototype._getStoreDimIndex=function(e){return this.getDimensionIndex(e)},e.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},e.prototype._initGetDimensionInfo=function(e){var t=this._dimInfos;this._getDimInfo=e?function(e){return t.hasOwnProperty(e)?t[e]:void 0}:function(e){return t[e]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(e,t){var a=this._dimSummary;if(null==t)return a.encodeFirstDimNotExtra[e];var n=a.encode[e];return n?n[t]:null},e.prototype.mapDimensionsAll=function(e){return(this._dimSummary.encode[e]||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(e,t,a){var n,r=this;if(e instanceof M3e&&(n=e),!n){var i=this.dimensions,o=T4e(e)||vGe(e)?new D4e(e,i.length):e;n=new M3e;var s=k9e(i,function(e){return{type:r._dimInfos[e].type,property:e}});n.initData(o,s,a)}this._store=n,this._nameList=(t||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,n.count()),this._dimSummary=function(e,t){var a={},n=a.encode={},r=$Ge(),i=[],o=[],s={};gGe(e.dimensions,function(t){var a,l=e.getDimensionInfo(t),c=l.coordDim;if(c){var u=l.coordDimIndex;l9e(n,c)[u]=t,l.isExtraCoord||(r.set(c,1),"ordinal"!==(a=l.type)&&"time"!==a&&(i[0]=t),l9e(s,c)[u]=e.getDimensionIndex(l.name)),l.defaultTooltip&&o.push(t)}m5e.each(function(e,t){var a=l9e(n,t),r=l.otherDims[t];null!=r&&!1!==r&&(a[r]=l.name)})});var l=[],c={};r.each(function(e,t){var a=n[t];c[t]=a[0],l=l.concat(a)}),a.dataDimsOnCoord=l,a.dataDimIndicesOnCoord=yGe(l,function(t){return e.getDimensionInfo(t).storeDimIndex}),a.encodeFirstDimNotExtra=c;var u=n.label;u&&u.length&&(i=u.slice());var d=n.tooltip;return d&&d.length?o=d.slice():o.length||(o=i.slice()),n.defaultedLabel=i,n.defaultedTooltip=o,a.userOutput=new s9e(s,t),a}(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(e){var t=this._store.appendData(e);this._doInit(t[0],t[1])},e.prototype.appendValues=function(e,t){var a=this._store.appendValues(e,t&&t.length),n=a.start,r=a.end,i=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),t)for(var o=n;o<r;o++){var s=o-n;this._nameList[o]=t[s],i&&M9e(this,o)}},e.prototype._updateOrdinalMeta=function(){for(var e=this._store,t=this.dimensions,a=0;a<t.length;a++){var n=this._dimInfos[t[a]];n.ordinalMeta&&e.collectOrdinalMeta(n.storeDimIndex,n.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return null==this._idDimIdx&&e.getSource().sourceFormat!==x5e&&!e.fillStorage},e.prototype._doInit=function(e,t){if(!(e>=t)){var a=this._store.getProvider();this._updateOrdinalMeta();var n=this._nameList,r=this._idList;if(a.getSource().sourceFormat===v5e&&!a.pure)for(var i=[],o=e;o<t;o++){var s=a.getItem(o,i);if(!this.hasItemOption&&l$e(s)&&(this.hasItemOption=!0),s){var l=s.name;null==n[o]&&null!=l&&(n[o]=h$e(l,null));var c=s.id;null==r[o]&&null!=c&&(r[o]=h$e(c,null))}}if(this._shouldMakeIdFromName())for(o=e;o<t;o++)M9e(this,o);y9e(this)}},e.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},e.prototype.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},e.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},e.prototype.setCalculationInfo=function(e,t){T9e(e)?hGe(this._calculationInfo,e):this._calculationInfo[e]=t},e.prototype.getName=function(e){var t=this.getRawIndex(e),a=this._nameList[t];return null==a&&null!=this._nameDimIdx&&(a=x9e(this,this._nameDimIdx,t)),null==a&&(a=""),a},e.prototype._getCategory=function(e,t){var a=this._store.get(e,t),n=this._store.getOrdinalMeta(e);return n?n.categories[a]:a},e.prototype.getId=function(e){return b9e(this,this.getRawIndex(e))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(e,t){var a=this._store,n=this._dimInfos[e];if(n)return a.get(n.storeDimIndex,t)},e.prototype.getByRawIndex=function(e,t){var a=this._store,n=this._dimInfos[e];if(n)return a.getByRawIndex(n.storeDimIndex,t)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},e.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},e.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},e.prototype.getValues=function(e,t){var a=this,n=this._store;return TGe(e)?n.getValues(k9e(e,function(e){return a._getStoreDimIndex(e)}),t):n.getValues(e)},e.prototype.hasValue=function(e){for(var t=this._dimSummary.dataDimIndicesOnCoord,a=0,n=t.length;a<n;a++)if(isNaN(this._store.get(t[a],e)))return!1;return!0},e.prototype.indexOfName=function(e){for(var t=0,a=this._store.count();t<a;t++)if(this.getName(t)===e)return t;return-1},e.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},e.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},e.prototype.rawIndexOf=function(e,t){var a=e&&this._invertedIndicesMap[e],n=a&&a[t];return null==n||isNaN(n)?-1:n},e.prototype.each=function(e,t,a){kGe(e)&&(a=t,t=e,e=[]);var n=a||this,r=k9e(w9e(e),this._getStoreDimIndex,this);this._store.each(r,n?SGe(t,n):t)},e.prototype.filterSelf=function(e,t,a){kGe(e)&&(a=t,t=e,e=[]);var n=a||this,r=k9e(w9e(e),this._getStoreDimIndex,this);return this._store=this._store.filter(r,n?SGe(t,n):t),this},e.prototype.selectRange=function(e){var t=this,a={};return gGe(_Ge(e),function(n){var r=t._getStoreDimIndex(n);a[r]=e[n]}),this._store=this._store.selectRange(a),this},e.prototype.mapArray=function(e,t,a){kGe(e)&&(a=t,t=e,e=[]),a=a||this;var n=[];return this.each(e,function(){n.push(t&&t.apply(this,arguments))},a),n},e.prototype.map=function(e,t,a,n){var r=a||n||this,i=k9e(w9e(e),this._getStoreDimIndex,this),o=S9e(this);return o._store=this._store.map(i,r?SGe(t,r):t),o},e.prototype.modify=function(e,t,a,n){var r=a||n||this,i=k9e(w9e(e),this._getStoreDimIndex,this);this._store.modify(i,r?SGe(t,r):t)},e.prototype.downSample=function(e,t,a,n){var r=S9e(this);return r._store=this._store.downSample(this._getStoreDimIndex(e),t,a,n),r},e.prototype.minmaxDownSample=function(e,t){var a=S9e(this);return a._store=this._store.minmaxDownSample(this._getStoreDimIndex(e),t),a},e.prototype.lttbDownSample=function(e,t){var a=S9e(this);return a._store=this._store.lttbDownSample(this._getStoreDimIndex(e),t),a},e.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},e.prototype.getItemModel=function(e){var t=this.hostModel,a=this.getRawDataItem(e);return new E1e(a,t,t&&t.ecModel)},e.prototype.diff=function(e){var t=this;return new o9e(e?e.getStore().getIndices():[],this.getStore().getIndices(),function(t){return b9e(e,t)},function(e){return b9e(t,e)})},e.prototype.getVisual=function(e){var t=this._visual;return t&&t[e]},e.prototype.setVisual=function(e,t){this._visual=this._visual||{},T9e(e)?hGe(this._visual,e):this._visual[e]=t},e.prototype.getItemVisual=function(e,t){var a=this._itemVisuals[e],n=a&&a[t];return null==n?this.getVisual(t):n},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(e,t){var a=this._itemVisuals,n=a[e];n||(n=a[e]={});var r=n[t];return null==r&&(TGe(r=this.getVisual(t))?r=r.slice():T9e(r)&&(r=hGe({},r)),n[t]=r),r},e.prototype.setItemVisual=function(e,t,a){var n=this._itemVisuals[e]||{};this._itemVisuals[e]=n,T9e(t)?hGe(n,t):n[t]=a},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(e,t){T9e(e)?hGe(this._layout,e):this._layout[e]=t},e.prototype.getLayout=function(e){return this._layout[e]},e.prototype.getItemLayout=function(e){return this._itemLayouts[e]},e.prototype.setItemLayout=function(e,t,a){this._itemLayouts[e]=a?hGe(this._itemLayouts[e]||{},t):t},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(e,t){var a=this.hostModel&&this.hostModel.seriesIndex;jZe(a,this.dataType,e,t),this._graphicEls[e]=t},e.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},e.prototype.eachItemGraphicEl=function(e,t){gGe(this._graphicEls,function(a,n){a&&e&&e.call(t,a,n)})},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:k9e(this.dimensions,this._getDimInfo,this),this.hostModel)),_9e(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(e,t){var a=this[e];kGe(a)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var e=a.apply(this,arguments);return t.apply(this,[e].concat(UGe(arguments)))})},e.internalField=(y9e=function(e){var t=e._invertedIndicesMap;gGe(t,function(a,n){var r=e._dimInfos[n],i=r.ordinalMeta,o=e._store;if(i){a=t[n]=new C9e(i.categories.length);for(var s=0;s<a.length;s++)a[s]=-1;for(s=0;s<o.count();s++)a[o.get(r.storeDimIndex,s)]=s}})},x9e=function(e,t,a){return h$e(e._getCategory(t,a),null)},b9e=function(e,t){var a=e._idList[t];return null==a&&null!=e._idDimIdx&&(a=x9e(e,e._idDimIdx,t)),null==a&&(a="e\0\0"+t),a},w9e=function(e){return TGe(e)||(e=null!=e?[e]:[]),e},S9e=function(t){var a=new e(t._schema?t._schema:k9e(t.dimensions,t._getDimInfo,t),t.hostModel);return _9e(a,t),a},_9e=function(e,t){gGe(A9e.concat(t.__wrappedMethods||[]),function(a){t.hasOwnProperty(a)&&(e[a]=t[a])}),e.__wrappedMethods=t.__wrappedMethods,gGe(E9e,function(a){e[a]=cGe(t[a])}),e._calculationInfo=hGe({},t._calculationInfo)},void(M9e=function(e,t){var a=e._nameList,n=e._idList,r=e._nameDimIdx,i=e._idDimIdx,o=a[t],s=n[t];if(null==o&&null!=r&&(a[t]=o=x9e(e,r,t)),null==s&&null!=i&&(n[t]=s=x9e(e,i,t)),null==s&&null!=o){var l=e._nameRepeatCount,c=l[o]=(l[o]||0)+1;s=o,c>1&&(s+="__ec__"+c),n[t]=s}})),e}();function R9e(e,t){T4e(e)||(e=C4e(e));var a=(t=t||{}).coordDimensions||[],n=t.dimensionsDefine||e.dimensionsDefine||[],r=$Ge(),i=[],o=function(e,t,a,n){var r=Math.max(e.dimensionsDetectedCount||1,t.length,a.length,n||0);return gGe(t,function(e){var t;IGe(e)&&(t=e.dimsDef)&&(r=Math.max(r,t.length))}),r}(e,a,n,t.dimensionsCount),s=t.canOmitUnusedDimensions&&g9e(o),l=n===e.dimensionsDefine,c=l?v9e(e):m9e(n),u=t.encodeDefine;!u&&t.encodeDefaulter&&(u=t.encodeDefaulter(e,o));for(var d=$Ge(u),h=new g3e(o),p=0;p<h.length;p++)h[p]=-1;function f(e){var t=h[e];if(t<0){var a=n[e],r=IGe(a)?a:{name:a},o=new u9e,s=r.name;null!=s&&null!=c.get(s)&&(o.name=o.displayName=s),null!=r.type&&(o.type=r.type),null!=r.displayName&&(o.displayName=r.displayName);var l=i.length;return h[e]=l,o.storeDimIndex=e,i.push(o),o}return i[t]}if(!s)for(p=0;p<o;p++)f(p);d.each(function(e,t){var a=r$e(e).slice();if(1===a.length&&!CGe(a[0])&&a[0]<0)d.set(t,!1);else{var n=d.set(t,[]);gGe(a,function(e,a){var r=CGe(e)?c.get(e):e;null!=r&&r<o&&(n[a]=r,v(f(r),t,a))})}});var m=0;function v(e,t,a){null!=m5e.get(t)?e.otherDims[t]=a:(e.coordDim=t,e.coordDimIndex=a,r.set(t,!0))}gGe(a,function(e){var t,a,n,r;if(CGe(e))t=e,r={};else{t=(r=e).name;var i=r.ordinalMeta;r.ordinalMeta=null,(r=hGe({},r)).ordinalMeta=i,a=r.dimsDef,n=r.otherDims,r.name=r.coordDim=r.coordDimIndex=r.dimsDef=r.otherDims=null}var s=d.get(t);if(!1!==s){if(!(s=r$e(s)).length)for(var c=0;c<(a&&a.length||1);c++){for(;m<o&&null!=f(m).coordDim;)m++;m<o&&s.push(m++)}gGe(s,function(e,i){var o=f(e);if(l&&null!=r.type&&(o.type=r.type),v(pGe(o,r),t,i),null==o.name&&a){var s=a[i];!IGe(s)&&(s={name:s}),o.name=o.displayName=s.name,o.defaultTooltip=s.defaultTooltip}n&&pGe(o.otherDims,n)})}});var g=t.generateCoord,y=t.generateCoordCount,b=null!=y;y=g?y||1:0;var x=g||"value";function w(e){null==e.name&&(e.name=e.coordDim)}if(s)gGe(i,function(e){w(e)}),i.sort(function(e,t){return e.storeDimIndex-t.storeDimIndex});else for(var _=0;_<o;_++){var S=f(_);null==S.coordDim&&(S.coordDim=D9e(x,r,b),S.coordDimIndex=0,(!g||y<=0)&&(S.isExtraCoord=!0),y--),w(S),null!=S.type||R5e(e,_)!==M5e&&(!S.isExtraCoord||null==S.otherDims.itemName&&null==S.otherDims.seriesName)||(S.type="ordinal")}return function(e){for(var t=$Ge(),a=0;a<e.length;a++){var n=e[a],r=n.name,i=t.get(r)||0;i>0&&(n.name=r+(i-1)),i++,t.set(r,i)}}(i),new p9e({source:e,dimensions:i,fullDimensionCount:o,dimensionOmitted:s})}function D9e(e,t,a){if(a||t.hasKey(e)){for(var n=0;t.hasKey(e+n);)n++;e+=n}return t.set(e,!0),e}var P9e=function(){return function(e){this.coordSysDims=[],this.axisMap=$Ge(),this.categoryAxisMap=$Ge(),this.coordSysName=e}}();var L9e={cartesian2d:function(e,t,a,n){var r=e.getReferringComponents("xAxis",x$e).models[0],i=e.getReferringComponents("yAxis",x$e).models[0];t.coordSysDims=["x","y"],a.set("x",r),a.set("y",i),N9e(r)&&(n.set("x",r),t.firstCategoryDimIndex=0),N9e(i)&&(n.set("y",i),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,a,n){var r=e.getReferringComponents("singleAxis",x$e).models[0];t.coordSysDims=["single"],a.set("single",r),N9e(r)&&(n.set("single",r),t.firstCategoryDimIndex=0)},polar:function(e,t,a,n){var r=e.getReferringComponents("polar",x$e).models[0],i=r.findAxisModel("radiusAxis"),o=r.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],a.set("radius",i),a.set("angle",o),N9e(i)&&(n.set("radius",i),t.firstCategoryDimIndex=0),N9e(o)&&(n.set("angle",o),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=1))},geo:function(e,t,a,n){t.coordSysDims=["lng","lat"]},parallel:function(e,t,a,n){var r=e.ecModel,i=r.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=i.dimensions.slice();gGe(i.parallelAxisIndex,function(e,i){var s=r.getComponent("parallelAxis",e),l=o[i];a.set(l,s),N9e(s)&&(n.set(l,s),null==t.firstCategoryDimIndex&&(t.firstCategoryDimIndex=i))})},matrix:function(e,t,a,n){var r=e.getReferringComponents("matrix",x$e).models[0];t.coordSysDims=["x","y"];var i=r.getDimensionModel("x"),o=r.getDimensionModel("y");a.set("x",i),a.set("y",o),n.set("x",i),n.set("y",o)}};function N9e(e){return"category"===e.get("type")}function O9e(e,t,a){var n,r,i,o=(a=a||{}).byIndex,s=a.stackedCoordDimension;!function(e){return!f9e(e.schema)}(t)?(r=t.schema,n=r.dimensions,i=t.store):n=t;var l,c,u,d,h=!(!e||!e.get("stack"));if(gGe(n,function(e,t){CGe(e)&&(n[t]=e={name:e}),h&&!e.isExtraCoord&&(o||l||!e.ordinalMeta||(l=e),c||"ordinal"===e.type||"time"===e.type||s&&s!==e.coordDim||(c=e))}),!c||o||l||(o=!0),c){u="__\0ecstackresult_"+e.id,d="__\0ecstackedover_"+e.id,l&&(l.createInvertedIndices=!0);var p=c.coordDim,f=c.type,m=0;gGe(n,function(e){e.coordDim===p&&m++});var v={name:u,coordDim:p,coordDimIndex:m,type:f,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:n.length},g={name:d,coordDim:d,coordDimIndex:m+1,type:f,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:n.length+1};r?(i&&(v.storeDimIndex=i.ensureCalculationDimension(d,f),g.storeDimIndex=i.ensureCalculationDimension(u,f)),r.appendCalculationDimension(v),r.appendCalculationDimension(g)):(n.push(v),n.push(g))}return{stackedDimension:c&&c.name,stackedByDimension:l&&l.name,isStackedByIndex:o,stackedOverDimension:d,stackResultDimension:u}}function F9e(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function B9e(e,t){return F9e(e,t)?e.getCalculationInfo("stackResultDimension"):t}function U9e(e,t,a){a=a||{};var n,r=t.getSourceManager(),i=!1;e?(i=!0,n=C4e(e)):i=(n=r.getSource()).sourceFormat===v5e;var o=function(e){var t=e.get("coordinateSystem"),a=new P9e(t),n=L9e[t];if(n)return n(e,a,a.axisMap,a.categoryAxisMap),a}(t),s=function(e,t){var a,n=e.get("coordinateSystem"),r=D2e.get(n);return t&&t.coordSysDims&&(a=yGe(t.coordSysDims,function(e){var a={name:e},n=t.axisMap.get(e);if(n){var r=n.get("type");a.type=c9e(r)}return a})),a||(a=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),a}(t,o),l=a.useEncodeDefaulter,c=kGe(l)?l:l?MGe(A5e,s,t):null,u=R9e(n,{coordDimensions:s,generateCoord:a.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:c,canOmitUnusedDimensions:!i}),d=function(e,t,a){var n,r;return a&&gGe(e,function(e,i){var o=e.coordDim,s=a.categoryAxisMap.get(o);s&&(null==n&&(n=i),e.ordinalMeta=s.getOrdinalMeta(),t&&(e.createInvertedIndices=!0)),null!=e.otherDims.itemName&&(r=!0)}),r||null==n||(e[n].otherDims.itemName=0),n}(u.dimensions,a.createInvertedIndices,o),h=i?null:r.getSharedDataStore(u),p=O9e(t,{schema:u,store:h}),f=new I9e(u,t);f.setCalculationInfo(p);var m=null!=d&&function(e){if(e.sourceFormat===v5e){var t=function(e){var t=0;for(;t<e.length&&null==e[t];)t++;return e[t]}(e.data||[]);return!TGe(s$e(t))}}(n)?function(e,t,a,n){return n===d?a:this.defaultDimValueGetter(e,t,a,n)}:null;return f.hasItemOption=!1,f.initData(i?n:h,null,m),f}function z9e(e){return"interval"===e.type||"log"===e.type}function V9e(e,t,a,n,r){var i={},o=i.interval=WXe(t/a);null!=n&&o<n&&(o=i.interval=n),null!=r&&o>r&&(o=i.interval=r);var s=i.intervalPrecision=G9e(o);return function(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),W9e(e,0,t),W9e(e,1,t),e[0]>e[1]&&(e[0]=e[1])}(i.niceTickExtent=[PXe(Math.ceil(e[0]/o)*o,s),PXe(Math.floor(e[1]/o)*o,s)],e),i}function H9e(e){var t=Math.pow(10,GXe(e)),a=e/t;return a?2===a?a=3:3===a?a=5:a*=2:a=1,PXe(a*t)}function G9e(e){return NXe(e)+2}function W9e(e,t,a){e[t]=Math.max(Math.min(e[t],a[1]),a[0])}function q9e(e,t){return e>=t[0]&&e<=t[1]}var Y9e=function(){function e(){this.normalize=j9e,this.scale=X9e}return e.prototype.updateMethods=function(e){e.hasBreaks()?(this.normalize=SGe(e.normalize,e),this.scale=SGe(e.scale,e)):(this.normalize=j9e,this.scale=X9e)},e}();function j9e(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function X9e(e,t){return e*(t[1]-t[0])+t[0]}function $9e(e,t,a){var n=Math.log(e);return[Math.log(a?t[0]:Math.max(0,t[0]))/n,Math.log(a?t[1]:Math.max(0,t[1]))/n]}var K9e=function(){function e(e){this._calculator=new Y9e,this._setting=e||{},this._extent=[1/0,-1/0];var t=H1e();t&&(this._brkCtx=t.createScaleBreakContext(),this._brkCtx.update(this._extent))}return e.prototype.getSetting=function(e){return this._setting[e]},e.prototype._innerUnionExtent=function(e){var t=this._extent;this._innerSetExtent(e[0]<t[0]?e[0]:t[0],e[1]>t[1]?e[1]:t[1])},e.prototype.unionExtentFromData=function(e,t){this._innerUnionExtent(e.getApproximateExtent(t))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(e,t){this._innerSetExtent(e,t)},e.prototype._innerSetExtent=function(e,t){var a=this._extent;isNaN(e)||(a[0]=e),isNaN(t)||(a[1]=t),this._brkCtx&&this._brkCtx.update(a)},e.prototype.setBreaksFromOption=function(e){var t=H1e();t&&this._innerSetBreak(t.parseAxisBreakOption(e,SGe(this.parse,this)))},e.prototype._innerSetBreak=function(e){this._brkCtx&&(this._brkCtx.setBreaks(e),this._calculator.updateMethods(this._brkCtx),this._brkCtx.update(this._extent))},e.prototype._innerGetBreaks=function(){return this._brkCtx?this._brkCtx.breaks:[]},e.prototype.hasBreaks=function(){return!!this._brkCtx&&this._brkCtx.hasBreaks()},e.prototype._getExtentSpanWithBreaks=function(){return this._brkCtx&&this._brkCtx.hasBreaks()?this._brkCtx.getExtentSpan():this._extent[1]-this._extent[0]},e.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(e){this._isBlank=e},e}();O$e(K9e);var Z9e=0,J9e=function(){function e(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++Z9e,this._onCollect=e.onCollect}return e.createByAxisModel=function(t){var a=t.option,n=a.data,r=n&&yGe(n,Q9e);return new e({categories:r,needCollect:!r,deduplication:!1!==a.dedplication})},e.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},e.prototype.parseAndCollect=function(e){var t,a=this._needCollect;if(!CGe(e)&&!a)return e;if(a&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,this._onCollect&&this._onCollect(e,t),t;var n=this._getOrCreateMap();return null==(t=n.get(e))&&(a?(t=this.categories.length,this.categories[t]=e,n.set(e,t),this._onCollect&&this._onCollect(e,t)):t=NaN),t},e.prototype._getOrCreateMap=function(){return this._map||(this._map=$Ge(this.categories))},e}();function Q9e(e){return IGe(e)&&null!=e.value?e.value:e+""}var eet=function(e){function t(t){var a=e.call(this,t)||this;a.type="ordinal";var n=a.getSetting("ordinalMeta");return n||(n=new J9e({})),TGe(n)&&(n=new J9e({categories:yGe(n,function(e){return IGe(e)?e.value:e})})),a._ordinalMeta=n,a._extent=a.getSetting("extent")||[0,n.categories.length-1],a}return zHe(t,e),t.prototype.parse=function(e){return null==e?NaN:CGe(e)?this._ordinalMeta.getOrdinal(e):Math.round(e)},t.prototype.contain=function(e){return q9e(e,this._extent)&&e>=0&&e<this._ordinalMeta.categories.length},t.prototype.normalize=function(e){return e=this._getTickNumber(e),this._calculator.normalize(e,this._extent)},t.prototype.scale=function(e){return e=Math.round(this._calculator.scale(e,this._extent)),this.getRawOrdinalNumber(e)},t.prototype.getTicks=function(){for(var e=[],t=this._extent,a=t[0];a<=t[1];)e.push({value:a}),a++;return e},t.prototype.getMinorTicks=function(e){},t.prototype.setSortInfo=function(e){if(null!=e){for(var t=e.ordinalNumbers,a=this._ordinalNumbersByTick=[],n=this._ticksByOrdinalNumber=[],r=0,i=this._ordinalMeta.categories.length,o=Math.min(i,t.length);r<o;++r){var s=t[r];a[r]=s,n[s]=r}for(var l=0;r<i;++r){for(;null!=n[l];)l++;a.push(l),n[l]=r}}else this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null},t.prototype._getTickNumber=function(e){var t=this._ticksByOrdinalNumber;return t&&e>=0&&e<t.length?t[e]:e},t.prototype.getRawOrdinalNumber=function(e){var t=this._ordinalNumbersByTick;return t&&e>=0&&e<t.length?t[e]:e},t.prototype.getLabel=function(e){if(!this.isBlank()){var t=this.getRawOrdinalNumber(e.value),a=this._ordinalMeta.categories[t];return null==a?"":a+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.isInExtentRange=function(e){return e=this._getTickNumber(e),this._extent[0]<=e&&this._extent[1]>=e},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(K9e);K9e.registerClass(eet);var tet=PXe,aet=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="interval",t._interval=0,t._intervalPrecision=2,t}return zHe(t,e),t.prototype.parse=function(e){return null==e||""===e?NaN:Number(e)},t.prototype.contain=function(e){return q9e(e,this._extent)},t.prototype.normalize=function(e){return this._calculator.normalize(e,this._extent)},t.prototype.scale=function(e){return this._calculator.scale(e,this._extent)},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(e){this._interval=e,this._niceExtent=this._extent.slice(),this._intervalPrecision=G9e(e)},t.prototype.getTicks=function(e){e=e||{};var t=this._interval,a=this._extent,n=this._niceExtent,r=this._intervalPrecision,i=H1e(),o=[];if(!t)return o;if("only_break"===e.breakTicks&&i)return i.addBreaksToTicks(o,this._brkCtx.breaks,this._extent),o;a[0]<n[0]&&(e.expandToNicedExtent?o.push({value:tet(n[0]-t,r)}):o.push({value:a[0]}));for(var s=function(e,a){return Math.round((a-e)/t)},l=n[0];l<=n[1];){if(o.push({value:l}),l=tet(l+t,r),this._brkCtx){var c=this._brkCtx.calcNiceTickMultiple(l,s);c>=0&&(l=tet(l+c*t,r))}if(o.length>0&&l===o[o.length-1].value)break;if(o.length>1e4)return[]}var u=o.length?o[o.length-1].value:n[1];return a[1]>u&&(e.expandToNicedExtent?o.push({value:tet(u+t,r)}):o.push({value:a[1]})),i&&i.pruneTicksByBreak(e.pruneByBreak,o,this._brkCtx.breaks,function(e){return e.value},this._interval,this._extent),"none"!==e.breakTicks&&i&&i.addBreaksToTicks(o,this._brkCtx.breaks,this._extent),o},t.prototype.getMinorTicks=function(e){for(var t=this.getTicks({expandToNicedExtent:!0}),a=[],n=this.getExtent(),r=1;r<t.length;r++){var i=t[r],o=t[r-1];if(!o.break&&!i.break){for(var s=0,l=[],c=(i.value-o.value)/e,u=G9e(c);s<e-1;){var d=tet(o.value+(s+1)*c,u);d>n[0]&&d<n[1]&&l.push(d),s++}var h=H1e();h&&h.pruneTicksByBreak("auto",l,this._getNonTransBreaks(),function(e){return e},this._interval,n),a.push(l)}}return a},t.prototype._getNonTransBreaks=function(){return this._brkCtx?this._brkCtx.breaks:[]},t.prototype.getLabel=function(e,t){if(null==e)return"";var a=t&&t.precision;return null==a?a=NXe(e.value)||0:"auto"===a&&(a=this._intervalPrecision),w2e(tet(e.value,a,!0))},t.prototype.calcNiceTicks=function(e,t,a){e=e||5;var n=this._extent.slice(),r=this._getExtentSpanWithBreaks();if(isFinite(r)){r<0&&(r=-r,n.reverse(),this._innerSetExtent(n[0],n[1]),n=this._extent.slice());var i=V9e(n,r,e,t,a);this._intervalPrecision=i.intervalPrecision,this._interval=i.interval,this._niceExtent=i.niceTickExtent}},t.prototype.calcNiceExtent=function(e){var t=this._extent.slice();if(t[0]===t[1])if(0!==t[0]){var a=Math.abs(t[0]);e.fixMax||(t[1]+=a/2),t[0]-=a/2}else t[1]=1;var n=t[1]-t[0];isFinite(n)||(t[0]=0,t[1]=1),this._innerSetExtent(t[0],t[1]),t=this._extent.slice(),this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval);var r=this._interval,i=this._intervalPrecision;e.fixMin||(t[0]=tet(Math.floor(t[0]/r)*r,i)),e.fixMax||(t[1]=tet(Math.ceil(t[1]/r)*r,i)),this._innerSetExtent(t[0],t[1])},t.prototype.setNiceExtent=function(e,t){this._niceExtent=[e,t]},t.type="interval",t}(K9e);K9e.registerClass(aet);var net="undefined"!=typeof Float32Array,ret=net?Float32Array:Array;function iet(e){return TGe(e)?net?new Float32Array(e):e:new ret(e)}var oet="__ec_stack_";function set(e){return e.get("stack")||oet+e.seriesIndex}function cet(e){return e.dim+e.index}function uet(e,t){var a=[];return t.eachSeriesByType(e,function(e){met(e)&&a.push(e)}),a}function det(e){var t=function(e){var t={};gGe(e,function(e){var a=e.coordinateSystem.getBaseAxis();if("time"===a.type||"value"===a.type)for(var n=e.getData(),r=a.dim+"_"+a.index,i=n.getDimensionIndex(n.mapDimension(a.dim)),o=n.getStore(),s=0,l=o.count();s<l;++s){var c=o.get(i,s);t[r]?t[r].push(c):t[r]=[c]}});var a={};for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(r){r.sort(function(e,t){return e-t});for(var i=null,o=1;o<r.length;++o){var s=r[o]-r[o-1];s>0&&(i=null===i?s:Math.min(i,s))}a[n]=i}}return a}(e),a=[];return gGe(e,function(e){var n,r=e.coordinateSystem.getBaseAxis(),i=r.getExtent();if("category"===r.type)n=r.getBandWidth();else if("value"===r.type||"time"===r.type){var o=r.dim+"_"+r.index,s=t[o],l=Math.abs(i[1]-i[0]),c=r.scale.getExtent(),u=Math.abs(c[1]-c[0]);n=s?l/u*s:l}else{var d=e.getData();n=Math.abs(i[1]-i[0])/d.count()}var h=RXe(e.get("barWidth"),n),p=RXe(e.get("barMaxWidth"),n),f=RXe(e.get("barMinWidth")||(vet(e)?.5:1),n),m=e.get("barGap"),v=e.get("barCategoryGap"),g=e.get("defaultBarGap");a.push({bandWidth:n,barWidth:h,barMaxWidth:p,barMinWidth:f,barGap:m,barCategoryGap:v,defaultBarGap:g,axisKey:cet(r),stackId:set(e)})}),het(a)}function het(e){var t={};gGe(e,function(e,a){var n=e.axisKey,r=e.bandWidth,i=t[n]||{bandWidth:r,remainedWidth:r,autoWidthCount:0,categoryGap:null,gap:e.defaultBarGap||0,stacks:{}},o=i.stacks;t[n]=i;var s=e.stackId;o[s]||i.autoWidthCount++,o[s]=o[s]||{width:0,maxWidth:0};var l=e.barWidth;l&&!o[s].width&&(o[s].width=l,l=Math.min(i.remainedWidth,l),i.remainedWidth-=l);var c=e.barMaxWidth;c&&(o[s].maxWidth=c);var u=e.barMinWidth;u&&(o[s].minWidth=u);var d=e.barGap;null!=d&&(i.gap=d);var h=e.barCategoryGap;null!=h&&(i.categoryGap=h)});var a={};return gGe(t,function(e,t){a[t]={};var n=e.stacks,r=e.bandWidth,i=e.categoryGap;if(null==i){var o=_Ge(n).length;i=Math.max(35-4*o,15)+"%"}var s=RXe(i,r),l=RXe(e.gap,1),c=e.remainedWidth,u=e.autoWidthCount,d=(c-s)/(u+(u-1)*l);d=Math.max(d,0),gGe(n,function(e){var t=e.maxWidth,a=e.minWidth;if(e.width){n=e.width;t&&(n=Math.min(n,t)),a&&(n=Math.max(n,a)),e.width=n,c-=n+l*n,u--}else{var n=d;t&&t<n&&(n=Math.min(t,c)),a&&a>n&&(n=a),n!==d&&(e.width=n,c-=n+l*n,u--)}}),d=(c-s)/(u+(u-1)*l),d=Math.max(d,0);var h,p=0;gGe(n,function(e,t){e.width||(e.width=d),h=e,p+=e.width*(1+l)}),h&&(p-=h.width*l);var f=-p/2;gGe(n,function(e,n){a[t][n]=a[t][n]||{bandWidth:r,offset:f,width:e.width},f+=e.width*(1+l)})}),a}function pet(e,t){var a=uet(e,t),n=det(a);gGe(a,function(e){var t=e.getData(),a=e.coordinateSystem.getBaseAxis(),r=set(e),i=n[cet(a)][r],o=i.offset,s=i.width;t.setLayout({bandWidth:i.bandWidth,offset:o,size:s})})}function fet(e){return{seriesType:e,plan:r6e(),reset:function(e){if(met(e)){var t=e.getData(),a=e.coordinateSystem,n=a.getBaseAxis(),r=a.getOtherAxis(n),i=t.getDimensionIndex(t.mapDimension(r.dim)),o=t.getDimensionIndex(t.mapDimension(n.dim)),s=e.get("showBackground",!0),l=t.mapDimension(r.dim),c=t.getCalculationInfo("stackResultDimension"),u=F9e(t,l)&&!!t.getCalculationInfo("stackedOnSeries"),d=r.isHorizontal(),h=function(e,t){var a=t.model.get("startValue");a||(a=0);return t.toGlobalCoord(t.dataToCoord("log"===t.type?a>0?a:1:a))}(0,r),p=vet(e),f=e.get("barMinHeight")||0,m=c&&t.getDimensionIndex(c),v=t.getLayout("size"),g=t.getLayout("offset");return{progress:function(e,t){for(var n,r=e.count,l=p&&iet(3*r),c=p&&s&&iet(3*r),y=p&&iet(r),b=a.master.getRect(),x=d?b.width:b.height,w=t.getStore(),_=0;null!=(n=e.next());){var S=w.get(u?m:i,n),M=w.get(o,n),T=h,k=void 0;u&&(k=+S-w.get(i,n));var C=void 0,A=void 0,E=void 0,I=void 0;if(d){var R=a.dataToPoint([S,M]);if(u)T=a.dataToPoint([k,M])[0];C=T,A=R[1]+g,E=R[0]-T,I=v,Math.abs(E)<f&&(E=(E<0?-1:1)*f)}else{R=a.dataToPoint([M,S]);if(u)T=a.dataToPoint([M,k])[1];C=R[0]+g,A=T,E=v,I=R[1]-T,Math.abs(I)<f&&(I=(I<=0?-1:1)*f)}p?(l[_]=C,l[_+1]=A,l[_+2]=d?E:I,c&&(c[_]=d?b.x:C,c[_+1]=d?A:b.y,c[_+2]=x),y[n]=n):t.setItemLayout(n,{x:C,y:A,width:E,height:I}),_+=3}p&&t.setLayout({largePoints:l,largeDataIndices:y,largeBackgroundPoints:c,valueAxisHorizontal:d})}}}}}}function met(e){return e.coordinateSystem&&"cartesian2d"===e.coordinateSystem.type}function vet(e){return e.pipelineContext&&e.pipelineContext.large}var get=function(e){function t(t){var a=e.call(this,t)||this;return a.type="time",a}return zHe(t,e),t.prototype.getLabel=function(e){var t=this.getSetting("useUTC");return r2e(e.value,Z1e[function(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}(a2e(this._minLevelUnit))]||Z1e.second,t,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(e,t,a){var n=this.getSetting("useUTC");return function(e,t,a,n,r){var i=null;if(CGe(a))i=a;else if(kGe(a)){var o={time:e.time,level:e.time.level},s=H1e();s&&s.makeAxisLabelFormatterParamBreak(o,e.break),i=a(e.value,t,o)}else{var l=e.time;if(l){var c=a[l.lowerTimeUnit][l.upperTimeUnit];i=c[Math.min(l.level,c.length-1)]||""}else{var u=i2e(e.value,r);i=a[u][u][0]}}return r2e(new Date(e.value),i,r,n)}(e,t,a,this.getSetting("locale"),n)},t.prototype.getTicks=function(e){e=e||{};var t=this._interval,a=this._extent,n=H1e(),r=[];if(!t)return r;var i=this.getSetting("useUTC");if(n&&"only_break"===e.breakTicks)return H1e().addBreaksToTicks(r,this._brkCtx.breaks,this._extent),r;var o=i2e(a[1],i);r.push({value:a[0],time:{level:0,upperTimeUnit:o,lowerTimeUnit:o}});var s=function(e,t,a,n,r,i){var o=1e4,s=Q1e,l=0;function c(e,t,a,r,s,c,u){for(var d=function(e,t){var a=new Date(0);a[e](1);var n=a.getTime();a[e](1+t);var r=a.getTime()-n;return function(e,t){return Math.max(0,Math.round((t-e)/r))}}(s,e),h=t,p=new Date(h);h<a&&h<=n[1]&&(u.push({value:h}),!(l++>o));)if(p[s](p[r]()+e),h=p.getTime(),i){var f=i.calcNiceTickMultiple(h,d);f>0&&(p[s](p[r]()+f*e),h=p.getTime())}u.push({value:h,notAdd:!0})}function u(e,r,i){var o=[],s=!r.length;if(!bet(a2e(e),n[0],n[1],a)){s&&(r=[{value:ket(n[0],e,a)},{value:n[1]}]);for(var l=0;l<r.length-1;l++){var u=r[l].value,d=r[l+1].value;if(u!==d){var h=void 0,p=void 0,f=void 0,m=!1;switch(e){case"year":h=Math.max(1,Math.round(t/Y1e/365)),p=s2e(a),f=f2e(a);break;case"half-year":case"quarter":case"month":h=wet(t),p=l2e(a),f=m2e(a);break;case"week":case"half-week":case"day":h=xet(t),p=c2e(a),f=v2e(a),m=!0;break;case"half-day":case"quarter-day":case"hour":h=_et(t),p=u2e(a),f=g2e(a);break;case"minute":h=Met(t,!0),p=d2e(a),f=y2e(a);break;case"second":h=Met(t,!1),p=h2e(a),f=b2e(a);break;case"millisecond":h=Tet(t),p=p2e(a),f=x2e(a)}d>=n[0]&&u<=n[1]&&c(h,u,d,p,f,m,o),"year"===e&&i.length>1&&0===l&&i.unshift({value:i[0].value-h})}}for(l=0;l<o.length;l++)i.push(o[l])}}for(var d=[],h=[],p=0,f=0,m=0;m<s.length;++m){var v=a2e(s[m]);if(n2e(s[m]))if(u(s[m],d[d.length-1]||[],h),v!==(s[m+1]?a2e(s[m+1]):null)){if(h.length){f=p,h.sort(function(e,t){return e.value-t.value});for(var g=[],y=0;y<h.length;++y){var b=h[y].value;0!==y&&h[y-1].value===b||(g.push(h[y]),b>=n[0]&&b<=n[1]&&p++)}var x=r/t;if(p>1.5*x&&f>x/1.5)break;if(d.push(g),p>x||e===s[m])break}h=[]}}var w=xGe(yGe(d,function(e){return xGe(e,function(e){return e.value>=n[0]&&e.value<=n[1]&&!e.notAdd})}),function(e){return e.length>0}),_=[],S=w.length-1;for(m=0;m<w.length;++m)for(var M=w[m],T=0;T<M.length;++T){var k=i2e(M[T].value,a);_.push({value:M[T].value,time:{level:S-m,upperTimeUnit:k,lowerTimeUnit:k}})}_.sort(function(e,t){return e.value-t.value});var C=[];for(m=0;m<_.length;++m)0!==m&&_[m].value===_[m-1].value||C.push(_[m]);return C}(this._minLevelUnit,this._approxInterval,i,a,this._getExtentSpanWithBreaks(),this._brkCtx);r=r.concat(s);var l=i2e(a[1],i);r.push({value:a[1],time:{level:0,upperTimeUnit:l,lowerTimeUnit:l}});var c=this.getSetting("useUTC"),u=J1e.length-1,d=0;return gGe(r,function(e){u=Math.min(u,fGe(J1e,e.time.upperTimeUnit)),d=Math.max(d,e.time.level)}),n&&H1e().pruneTicksByBreak(e.pruneByBreak,r,this._brkCtx.breaks,function(e){return e.value},this._approxInterval,this._extent),n&&"none"!==e.breakTicks&&H1e().addBreaksToTicks(r,this._brkCtx.breaks,this._extent,function(e){for(var t=Math.max(fGe(J1e,i2e(e.vmin,c)),fGe(J1e,i2e(e.vmax,c))),a=0,n=0;n<J1e.length;n++)if(!bet(J1e[n],e.vmin,e.vmax,c)){a=n;break}var r=Math.min(a,u),i=Math.max(r,t);return{level:d,lowerTimeUnit:J1e[i],upperTimeUnit:J1e[r]}}),r},t.prototype.calcNiceExtent=function(e){var t=this.getExtent();if(t[0]===t[1]&&(t[0]-=Y1e,t[1]+=Y1e),t[1]===-1/0&&t[0]===1/0){var a=new Date;t[1]=+new Date(a.getFullYear(),a.getMonth(),a.getDate()),t[0]=t[1]-Y1e}this._innerSetExtent(t[0],t[1]),this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval)},t.prototype.calcNiceTicks=function(e,t,a){e=e||10;var n=this._getExtentSpanWithBreaks();this._approxInterval=n/e,null!=t&&this._approxInterval<t&&(this._approxInterval=t),null!=a&&this._approxInterval>a&&(this._approxInterval=a);var r=yet.length,i=Math.min(function(e,t,a,n){for(;a<n;){var r=a+n>>>1;e[r][1]<t?a=r+1:n=r}return a}(yet,this._approxInterval,0,r),r-1);this._interval=yet[i][1],this._intervalPrecision=G9e(this._interval),this._minLevelUnit=yet[Math.max(i-1,0)][0]},t.prototype.parse=function(e){return EGe(e)?e:+HXe(e)},t.prototype.contain=function(e){return q9e(e,this._extent)},t.prototype.normalize=function(e){return this._calculator.normalize(e,this._extent)},t.prototype.scale=function(e){return this._calculator.scale(e,this._extent)},t.type="time",t}(aet),yet=[["second",G1e],["minute",W1e],["hour",q1e],["quarter-day",216e5],["half-day",432e5],["day",10368e4],["half-week",3024e5],["week",6048e5],["month",26784e5],["quarter",8208e6],["half-year",j1e/2],["year",j1e]];function bet(e,t,a,n){return o2e(new Date(t),e,n).getTime()===o2e(new Date(a),e,n).getTime()}function xet(e,t){return(e/=Y1e)>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function wet(e){return(e/=2592e6)>6?6:e>3?3:e>2?2:1}function _et(e){return(e/=q1e)>12?12:e>6?6:e>3.5?4:e>2?2:1}function Met(e,t){return(e/=t?W1e:G1e)>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function Tet(e){return WXe(e)}function ket(e,t,a){var n=Math.max(0,fGe(J1e,t)-1);return o2e(new Date(e),J1e[n],a).getTime()}K9e.registerClass(get);var Cet=PXe,Aet=Math.floor,Eet=Math.ceil,Iet=Math.pow,Ret=Math.log,Det=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="log",t.base=10,t._originalScale=new aet,t}return zHe(t,e),t.prototype.getTicks=function(t){t=t||{};var a=this._extent.slice(),n=this._originalScale.getExtent(),r=e.prototype.getTicks.call(this,t),i=this.base,o=this._originalScale._innerGetBreaks(),s=H1e();return yGe(r,function(e){var t,r=e.value,l=null,c=Iet(i,r);if(r===a[0]&&this._fixMin?l=n[0]:r===a[1]&&this._fixMax&&(l=n[1]),s){var u=s.getTicksLogTransformBreak(e,i,o,Pet);t=u.vBreak,null==l&&(l=u.brkRoundingCriterion)}return null!=l&&(c=Pet(c,l)),{value:c,break:t}},this)},t.prototype._getNonTransBreaks=function(){return this._originalScale._innerGetBreaks()},t.prototype.setExtent=function(t,a){this._originalScale.setExtent(t,a);var n=$9e(this.base,[t,a]);e.prototype.setExtent.call(this,n[0],n[1])},t.prototype.getExtent=function(){var t=this.base,a=e.prototype.getExtent.call(this);a[0]=Iet(t,a[0]),a[1]=Iet(t,a[1]);var n=this._originalScale.getExtent();return this._fixMin&&(a[0]=Pet(a[0],n[0])),this._fixMax&&(a[1]=Pet(a[1],n[1])),a},t.prototype.unionExtentFromData=function(e,t){this._originalScale.unionExtentFromData(e,t);var a=$9e(this.base,e.getApproximateExtent(t),!0);this._innerUnionExtent(a)},t.prototype.calcNiceTicks=function(e){e=e||10;var t=this._extent.slice(),a=this._getExtentSpanWithBreaks();if(isFinite(a)&&!(a<=0)){var n,r=(n=a,Math.pow(10,GXe(n)));for(e/a*r<=.5&&(r*=10);!isNaN(r)&&Math.abs(r)<1&&Math.abs(r)>0;)r*=10;var i=[Cet(Eet(t[0]/r)*r),Cet(Aet(t[1]/r)*r)];this._interval=r,this._intervalPrecision=G9e(r),this._niceExtent=i}},t.prototype.calcNiceExtent=function(t){e.prototype.calcNiceExtent.call(this,t),this._fixMin=t.fixMin,this._fixMax=t.fixMax},t.prototype.contain=function(t){return t=Ret(t)/Ret(this.base),e.prototype.contain.call(this,t)},t.prototype.normalize=function(t){return t=Ret(t)/Ret(this.base),e.prototype.normalize.call(this,t)},t.prototype.scale=function(t){return t=e.prototype.scale.call(this,t),Iet(this.base,t)},t.prototype.setBreaksFromOption=function(e){var t=H1e();if(t){var a=t.logarithmicParseBreaksFromOption(e,this.base,SGe(this.parse,this)),n=a.parsedOriginal,r=a.parsedLogged;this._originalScale._innerSetBreak(n),this._innerSetBreak(r)}},t.type="log",t}(aet);function Pet(e,t){return Cet(e,NXe(t))}K9e.registerClass(Det);var Let=function(){function e(e,t,a){this._prepareParams(e,t,a)}return e.prototype._prepareParams=function(e,t,a){a[1]<a[0]&&(a=[NaN,NaN]),this._dataMin=a[0],this._dataMax=a[1];var n=this._isOrdinal="ordinal"===e.type;this._needCrossZero="interval"===e.type&&t.getNeedCrossZero&&t.getNeedCrossZero();var r=t.get("min",!0);null==r&&(r=t.get("startValue",!0));var i=this._modelMinRaw=r;kGe(i)?this._modelMinNum=Bet(e,i({min:a[0],max:a[1]})):"dataMin"!==i&&(this._modelMinNum=Bet(e,i));var o=this._modelMaxRaw=t.get("max",!0);if(kGe(o)?this._modelMaxNum=Bet(e,o({min:a[0],max:a[1]})):"dataMax"!==o&&(this._modelMaxNum=Bet(e,o)),n)this._axisDataLen=t.getCategories().length;else{var s=t.get("boundaryGap"),l=TGe(s)?s:[s||0,s||0];"boolean"==typeof l[0]||"boolean"==typeof l[1]?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[sXe(l[0],1),sXe(l[1],1)]}},e.prototype.calculate=function(){var e=this._isOrdinal,t=this._dataMin,a=this._dataMax,n=this._axisDataLen,r=this._boundaryGapInner,i=e?null:a-t||Math.abs(t),o="dataMin"===this._modelMinRaw?t:this._modelMinNum,s="dataMax"===this._modelMaxRaw?a:this._modelMaxNum,l=null!=o,c=null!=s;null==o&&(o=e?n?0:NaN:t-r[0]*i),null==s&&(s=e?n?n-1:NaN:a+r[1]*i),(null==o||!isFinite(o))&&(o=NaN),(null==s||!isFinite(s))&&(s=NaN);var u=NGe(o)||NGe(s)||e&&!n;this._needCrossZero&&(o>0&&s>0&&!l&&(o=0),o<0&&s<0&&!c&&(s=0));var d=this._determinedMin,h=this._determinedMax;return null!=d&&(o=d,l=!0),null!=h&&(s=h,c=!0),{min:o,max:s,minFixed:l,maxFixed:c,isBlank:u}},e.prototype.modifyDataMinMax=function(e,t){this[Oet[e]]=t},e.prototype.setDeterminedMinMax=function(e,t){this[Net[e]]=t},e.prototype.freeze=function(){this.frozen=!0},e}(),Net={min:"_determinedMin",max:"_determinedMax"},Oet={min:"_dataMin",max:"_dataMax"};function Fet(e,t,a){var n=e.rawExtentInfo;return n||(n=new Let(e,t,a),e.rawExtentInfo=n,n)}function Bet(e,t){return null==t?null:NGe(t)?NaN:e.parse(t)}function Uet(e,t){var a=e.type,n=Fet(e,t,e.getExtent()).calculate();e.setBlank(n.isBlank);var r=n.min,i=n.max,o=t.ecModel;if(o&&"time"===a){var s=uet("bar",o),l=!1;if(gGe(s,function(e){l=l||e.getBaseAxis()===t.axis}),l){var c=det(s),u=function(e,t,a,n){var r=a.axis.getExtent(),i=Math.abs(r[1]-r[0]),o=function(e,t){if(e&&t)return e[cet(t)]}(n,a.axis);if(void 0===o)return{min:e,max:t};var s=1/0;gGe(o,function(e){s=Math.min(e.offset,s)});var l=-1/0;gGe(o,function(e){l=Math.max(e.offset+e.width,l)}),s=Math.abs(s),l=Math.abs(l);var c=s+l,u=t-e,d=u/(1-(s+l)/i)-u;return t+=d*(l/c),e-=d*(s/c),{min:e,max:t}}(r,i,t,c);r=u.min,i=u.max}}return{extent:[r,i],fixMin:n.minFixed,fixMax:n.maxFixed}}function zet(e,t){var a=t,n=Uet(e,a),r=n.extent,i=a.get("splitNumber");e instanceof Det&&(e.base=a.get("logBase"));var o=e.type,s=a.get("interval"),l="interval"===o||"time"===o;e.setBreaksFromOption($et(a)),e.setExtent(r[0],r[1]),e.calcNiceExtent({splitNumber:i,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:l?a.get("minInterval"):null,maxInterval:l?a.get("maxInterval"):null}),null!=s&&e.setInterval&&e.setInterval(s)}function Vet(e,t){if(t=t||e.get("type"))switch(t){case"category":return new eet({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new get({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(K9e.getClass(t)||aet)}}function Het(e){var t=e.getLabelModel().get("formatter");if("time"===e.type){var a=e2e(t);return function(t,n){return e.scale.getFormattedLabel(t,n,a)}}if(CGe(t))return function(a){var n=e.scale.getLabel(a);return t.replace("{value}",null!=n?n:"")};if(kGe(t)){if("category"===e.type)return function(a,n){return t(Get(e,a),a.value-e.scale.getExtent()[0],null)};var n=H1e();return function(a,r){var i=null;return n&&(i=n.makeAxisLabelFormatterParamBreak(i,a.break)),t(Get(e,a),r,i)}}return function(t){return e.scale.getLabel(t)}}function Get(e,t){return"category"===e.type?e.scale.getLabel(t):t.value}function Wet(e){var t=e.get("interval");return null==t?"auto":t}function qet(e){return"category"===e.type&&0===Wet(e.getLabelModel())}function Yet(e,t){var a={};return gGe(e.mapDimensionsAll(t),function(t){a[B9e(e,t)]=!0}),_Ge(a)}function jet(e){return"middle"===e||"center"===e}function Xet(e){return e.getShallow("show")}function $et(e){var t,a=e.get("breaks",!0);if(null!=a){if(!H1e())return;if("x"!==(t=e.axis).dim&&"y"!==t.dim&&"z"!==t.dim&&"single"!==t.dim||"category"===t.type)return;return a}}var Ket=function(){function e(){}return e.prototype.getNeedCrossZero=function(){return!this.option.scale},e.prototype.getCoordSysModel=function(){},e}(),Zet=[],Jet={registerPreprocessor:X7e,registerProcessor:$7e,registerPostInit:function(e){K7e("afterinit",e)},registerPostUpdate:function(e){K7e("afterupdate",e)},registerUpdateLifecycle:K7e,registerAction:Z7e,registerCoordinateSystem:function(e,t){D2e.register(e,t)},registerLayout:function(e,t){e9e(U7e,e,t,1e3,"layout")},registerVisual:J7e,registerTransform:a9e,registerLoading:t9e,registerMap:function(e,t,a){var n=K8e["registerMap"];n&&n(e,t,a)},registerImpl:function(e,t){K8e[e]=t},PRIORITY:e7e,ComponentModel:i5e,ComponentView:n6e,SeriesModel:$3e,ChartView:s6e,registerComponentModel:function(e){i5e.registerClass(e)},registerComponentView:function(e){n6e.registerClass(e)},registerSeriesModel:function(e){$3e.registerClass(e)},registerChartView:function(e){s6e.registerClass(e)},registerCustomSeries:function(e,t){!function(e,t){Z8e[e]=t}(e,t)},registerSubTypeDefaulter:function(e,t){i5e.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){var a;a=t,wXe[e]=a}};function Qet(e){TGe(e)?gGe(e,function(e){Qet(e)}):fGe(Zet,e)>=0||(Zet.push(e),kGe(e)&&(e={install:e}),e.install(Jet))}function ett(e,t){return Math.abs(e-t)<1e-8}function ttt(e,t,a){var n=0,r=e[0];if(!r)return!1;for(var i=1;i<e.length;i++){var o=e[i];n+=rZe(r[0],r[1],o[0],o[1],t,a),r=o}var s=e[0];return ett(r[0],s[0])&&ett(r[1],s[1])||(n+=rZe(r[0],r[1],s[0],s[1],t,a)),0!==n}var att=[];function ntt(e,t){for(var a=0;a<e.length;a++)vWe(e[a],e[a],t)}function rtt(e,t,a,n){for(var r=0;r<e.length;r++){var i=e[r];n&&(i=n.project(i)),i&&isFinite(i[0])&&isFinite(i[1])&&(gWe(t,t,i),yWe(a,a,i))}}var itt=function(){function e(e){this.name=e}return e.prototype.setCenter=function(e){this._center=e},e.prototype.getCenter=function(){var e=this._center;return e||(e=this._center=this.calcCenter()),e},e}(),ott=function(e,t){this.type="polygon",this.exterior=e,this.interiors=t},stt=function(e){this.type="linestring",this.points=e},ltt=function(e){function t(t,a,n){var r=e.call(this,t)||this;return r.type="geoJSON",r.geometries=a,r._center=n&&[n[0],n[1]],r}return zHe(t,e),t.prototype.calcCenter=function(){for(var e,t=this.geometries,a=0,n=0;n<t.length;n++){var r=t[n],i=r.exterior,o=i&&i.length;o>a&&(e=r,a=o)}if(e)return function(e){for(var t=0,a=0,n=0,r=e.length,i=e[r-1][0],o=e[r-1][1],s=0;s<r;s++){var l=e[s][0],c=e[s][1],u=i*c-l*o;t+=u,a+=(i+l)*u,n+=(o+c)*u,i=l,o=c}return t?[a/t/3,n/t/3,t]:[e[0][0]||0,e[0][1]||0]}(e.exterior);var s=this.getBoundingRect();return[s.x+s.width/2,s.y+s.height/2]},t.prototype.getBoundingRect=function(e){var t=this._rect;if(t&&!e)return t;var a=[1/0,1/0],n=[-1/0,-1/0];return gGe(this.geometries,function(t){"polygon"===t.type?rtt(t.exterior,a,n,e):gGe(t.points,function(t){rtt(t,a,n,e)})}),isFinite(a[0])&&isFinite(a[1])&&isFinite(n[0])&&isFinite(n[1])||(a[0]=a[1]=n[0]=n[1]=0),t=new fqe(a[0],a[1],n[0]-a[0],n[1]-a[1]),e||(this._rect=t),t},t.prototype.contain=function(e){var t=this.getBoundingRect(),a=this.geometries;if(!t.contain(e[0],e[1]))return!1;e:for(var n=0,r=a.length;n<r;n++){var i=a[n];if("polygon"===i.type){var o=i.exterior,s=i.interiors;if(ttt(o,e[0],e[1])){for(var l=0;l<(s?s.length:0);l++)if(ttt(s[l],e[0],e[1]))continue e;return!0}}}return!1},t.prototype.transformTo=function(e,t,a,n){var r=this.getBoundingRect(),i=r.width/r.height;a?n||(n=a/i):a=i*n;for(var o=new fqe(e,t,a,n),s=r.calculateTransform(o),l=this.geometries,c=0;c<l.length;c++){var u=l[c];"polygon"===u.type?(ntt(u.exterior,s),gGe(u.interiors,function(e){ntt(e,s)})):gGe(u.points,function(e){ntt(e,s)})}(r=this._rect).copy(o),this._center=[r.x+r.width/2,r.y+r.height/2]},t.prototype.cloneShallow=function(e){null==e&&(e=this.name);var a=new t(e,this.geometries,this._center);return a._rect=this._rect,a.transformTo=null,a},t}(itt),ctt=function(e){function t(t,a){var n=e.call(this,t)||this;return n.type="geoSVG",n._elOnlyForCalculate=a,n}return zHe(t,e),t.prototype.calcCenter=function(){for(var e=this._elOnlyForCalculate,t=e.getBoundingRect(),a=[t.x+t.width/2,t.y+t.height/2],n=jWe(att),r=e;r&&!r.isGeoSVGGraphicRoot;)$We(n,r.getLocalTransform(),n),r=r.parent;return QWe(n,n),vWe(a,a,n),a},t}(itt);function utt(e,t,a){for(var n=0;n<e.length;n++)e[n]=dtt(e[n],t[n],a)}function dtt(e,t,a){for(var n=[],r=t[0],i=t[1],o=0;o<e.length;o+=2){var s=e.charCodeAt(o)-64,l=e.charCodeAt(o+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),r=s+=r,i=l+=i,n.push([s/a,l/a])}return n}function htt(e,t){return yGe(xGe((e=function(e){if(!e.UTF8Encoding)return e;var t=e,a=t.UTF8Scale;return null==a&&(a=1024),gGe(t.features,function(e){var t=e.geometry,n=t.encodeOffsets,r=t.coordinates;if(n)switch(t.type){case"LineString":t.coordinates=dtt(r,n,a);break;case"Polygon":case"MultiLineString":utt(r,n,a);break;case"MultiPolygon":gGe(r,function(e,t){return utt(e,n[t],a)})}}),t.UTF8Encoding=!1,t}(e)).features,function(e){return e.geometry&&e.properties&&e.geometry.coordinates.length>0}),function(e){var a=e.properties,n=e.geometry,r=[];switch(n.type){case"Polygon":var i=n.coordinates;r.push(new ott(i[0],i.slice(1)));break;case"MultiPolygon":gGe(n.coordinates,function(e){e[0]&&r.push(new ott(e[0],e.slice(1)))});break;case"LineString":r.push(new stt([n.coordinates]));break;case"MultiLineString":r.push(new stt(n.coordinates))}var o=new ltt(a[t||"name"],r,a.cp);return o.properties=a,o})}var ptt=v$e(),ftt=v$e(),mtt=1,vtt=2;function gtt(e){return{out:{noPxChangeTryDetermine:[]},kind:e}}function ytt(e,t){var a=yGe(t,function(t){return e.scale.parse(t)});return"time"===e.type&&a.length>0&&(a.sort(),a.unshift(a[0]),a.push(a[a.length-1])),a}function btt(e,t){var a=e.getLabelModel().get("customValues");if(a){var n=Het(e),r=e.scale.getExtent();return{labels:yGe(xGe(ytt(e,a),function(e){return e>=r[0]&&e<=r[1]}),function(t){var a={value:t};return{formattedLabel:n(a),rawLabel:e.scale.getLabel(a),tickValue:t,time:void 0,break:void 0}})}}return"category"===e.type?function(e,t){var a=e.getLabelModel(),n=wtt(e,a,t);return!a.get("show")||e.scale.isBlank()?{labels:[]}:n}(e,t):function(e){var t=e.scale.getTicks(),a=Het(e);return{labels:yGe(t,function(t,n){return{formattedLabel:a(t,n),rawLabel:e.scale.getLabel(t),tickValue:t.value,time:t.time,break:t.break}})}}(e)}function xtt(e,t,a){var n=e.getTickModel().get("customValues");if(n){var r=e.scale.getExtent();return{ticks:xGe(ytt(e,n),function(e){return e>=r[0]&&e<=r[1]})}}return"category"===e.type?function(e,t){var a,n,r=_tt(e),i=Wet(t),o=Ttt(r,i);if(o)return o;t.get("show")&&!e.scale.isBlank()||(a=[]);if(kGe(i))a=Itt(e,i,!0);else if("auto"===i){var s=wtt(e,e.getLabelModel(),gtt(vtt));n=s.labelCategoryInterval,a=yGe(s.labels,function(e){return e.tickValue})}else a=Ett(e,n=i,!0);return ktt(r,i,{ticks:a,tickCategoryInterval:n})}(e,t):{ticks:yGe(e.scale.getTicks(a),function(e){return e.value})}}function wtt(e,t,a){var n,r,i=Stt(e),o=Wet(t),s=a.kind===mtt;if(!s){var l=Ttt(i,o);if(l)return l}kGe(o)?n=Itt(e,o):(r="auto"===o?function(e,t){if(t.kind===mtt){var a=e.calculateCategoryInterval(t);return t.out.noPxChangeTryDetermine.push(function(){return ftt(e).autoInterval=a,!0}),a}var n=ftt(e).autoInterval;return null!=n?n:ftt(e).autoInterval=e.calculateCategoryInterval(t)}(e,a):o,n=Ett(e,r));var c={labels:n,labelCategoryInterval:r};return s?a.out.noPxChangeTryDetermine.push(function(){return ktt(i,o,c),!0}):ktt(i,o,c),c}var _tt=Mtt("axisTick"),Stt=Mtt("axisLabel");function Mtt(e){return function(t){return ftt(t)[e]||(ftt(t)[e]={list:[]})}}function Ttt(e,t){for(var a=0;a<e.list.length;a++)if(e.list[a].key===t)return e.list[a].value}function ktt(e,t,a){return e.list.push({key:t,value:a}),a}function Ctt(e,t,a){return null==Att(e,t,a)}function Att(e,t,a){var n=ptt(e.model),r=e.getExtent(),i=n.lastAutoInterval,o=n.lastTickCount;if(null!=i&&null!=o&&Math.abs(i-t)<=1&&Math.abs(o-a)<=1&&i>t&&n.axisExtent0===r[0]&&n.axisExtent1===r[1])return i;n.lastTickCount=a,n.lastAutoInterval=t,n.axisExtent0=r[0],n.axisExtent1=r[1]}function Ett(e,t,a){var n=Het(e),r=e.scale,i=r.getExtent(),o=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),c=i[0],u=r.count();0!==c&&l>1&&u/l>2&&(c=Math.round(Math.ceil(c/l)*l));var d=qet(e),h=o.get("showMinLabel")||d,p=o.get("showMaxLabel")||d;h&&c!==i[0]&&m(i[0]);for(var f=c;f<=i[1];f+=l)m(f);function m(e){var t={value:e};s.push(a?e:{formattedLabel:n(t),rawLabel:r.getLabel(t),tickValue:e,time:void 0,break:void 0})}return p&&f-l!==i[1]&&m(i[1]),s}function Itt(e,t,a){var n=e.scale,r=Het(e),i=[];return gGe(n.getTicks(),function(e){var o=n.getLabel(e),s=e.value;t(e.value,o)&&i.push(a?s:{formattedLabel:r(e),rawLabel:o,tickValue:s,time:void 0,break:void 0})}),i}var Rtt=[0,1],Dtt=function(){function e(e,t,a){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=t,this._extent=a||[0,0]}return e.prototype.contain=function(e){var t=this._extent,a=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]);return e>=a&&e<=n},e.prototype.containData=function(e){return this.scale.contain(this.scale.parse(e))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(e){return OXe(e||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(e,t){var a=this._extent;a[0]=e,a[1]=t},e.prototype.dataToCoord=function(e,t){var a=this._extent,n=this.scale;return e=n.normalize(n.parse(e)),this.onBand&&"ordinal"===n.type&&Ptt(a=a.slice(),n.count()),IXe(e,Rtt,a,t)},e.prototype.coordToData=function(e,t){var a=this._extent,n=this.scale;this.onBand&&"ordinal"===n.type&&Ptt(a=a.slice(),n.count());var r=IXe(e,a,Rtt,t);return this.scale.scale(r)},e.prototype.pointToData=function(e,t){},e.prototype.getTicksCoords=function(e){var t=(e=e||{}).tickModel||this.getTickModel(),a=yGe(xtt(this,t,{breakTicks:e.breakTicks,pruneByBreak:e.pruneByBreak}).ticks,function(e){return{coord:this.dataToCoord("ordinal"===this.scale.type?this.scale.getRawOrdinalNumber(e):e),tickValue:e}},this);return function(e,t,a,n){var r=t.length;if(!e.onBand||a||!r)return;var i,o,s=e.getExtent();if(1===r)t[0].coord=s[0],t[0].onBand=!0,i=t[1]={coord:s[1],tickValue:t[0].tickValue,onBand:!0};else{var l=t[r-1].tickValue-t[0].tickValue,c=(t[r-1].coord-t[0].coord)/l;gGe(t,function(e){e.coord-=c/2,e.onBand=!0});var u=e.scale.getExtent();o=1+u[1]-t[r-1].tickValue,i={coord:t[r-1].coord+c*o,tickValue:u[1]+1,onBand:!0},t.push(i)}var d=s[0]>s[1];h(t[0].coord,s[0])&&(n?t[0].coord=s[0]:t.shift());n&&h(s[0],t[0].coord)&&t.unshift({coord:s[0],onBand:!0});h(s[1],i.coord)&&(n?i.coord=s[1]:t.pop());n&&h(i.coord,s[1])&&t.push({coord:s[1],onBand:!0});function h(e,t){return e=PXe(e),t=PXe(t),d?e>t:e<t}}(this,a,t.get("alignWithLabel"),e.clamp),a},e.prototype.getMinorTicksCoords=function(){if("ordinal"===this.scale.type)return[];var e=this.model.getModel("minorTick").get("splitNumber");return e>0&&e<100||(e=5),yGe(this.scale.getMinorTicks(e),function(e){return yGe(e,function(e){return{coord:this.dataToCoord(e),tickValue:e}},this)},this)},e.prototype.getViewLabels=function(e){return btt(this,e=e||gtt(vtt)).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var e=this._extent,t=this.scale.getExtent(),a=t[1]-t[0]+(this.onBand?1:0);0===a&&(a=1);var n=Math.abs(e[1]-e[0]);return Math.abs(n)/a},e.prototype.calculateCategoryInterval=function(e){return function(e,t){var a=t.kind,n=function(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}(e),r=Het(e),i=(n.axisRotate-n.labelRotate)/180*Math.PI,o=e.scale,s=o.getExtent(),l=o.count();if(s[1]-s[0]<1)return 0;var c=1;l>40&&(c=Math.max(1,Math.floor(l/40)));for(var u=s[0],d=e.dataToCoord(u+1)-e.dataToCoord(u),h=Math.abs(d*Math.cos(i)),p=Math.abs(d*Math.sin(i)),f=0,m=0;u<=s[1];u+=c){var v,g,y=nXe(r({value:u}),n.font,"center","top");v=1.3*y.width,g=1.3*y.height,f=Math.max(f,v,7),m=Math.max(m,g,7)}var b=f/h,x=m/p;isNaN(b)&&(b=1/0),isNaN(x)&&(x=1/0);var w=Math.max(0,Math.floor(Math.min(b,x)));if(a===mtt)return t.out.noPxChangeTryDetermine.push(SGe(Ctt,null,e,w,l)),w;var _=Att(e,w,l);return null!=_?_:w}(this,e=e||gtt(vtt))},e}();function Ptt(e,t){var a=(e[1]-e[0])/t/2;e[0]+=a,e[1]-=a}var Ltt=2*Math.PI,Ntt=KKe.CMD,Ott=["top","right","bottom","left"];function Ftt(e,t,a,n,r){var i=a.width,o=a.height;switch(e){case"top":n.set(a.x+i/2,a.y-t),r.set(0,-1);break;case"bottom":n.set(a.x+i/2,a.y+o+t),r.set(0,1);break;case"left":n.set(a.x-t,a.y+o/2),r.set(-1,0);break;case"right":n.set(a.x+i+t,a.y+o/2),r.set(1,0)}}function Btt(e,t,a,n,r,i,o,s,l){o-=e,s-=t;var c=Math.sqrt(o*o+s*s),u=(o/=c)*a+e,d=(s/=c)*a+t;if(Math.abs(n-r)%Ltt<1e-4)return l[0]=u,l[1]=d,c-a;if(i){var h=n;n=tZe(r),r=tZe(h)}else n=tZe(n),r=tZe(r);n>r&&(r+=Ltt);var p=Math.atan2(s,o);if(p<0&&(p+=Ltt),p>=n&&p<=r||p+Ltt>=n&&p+Ltt<=r)return l[0]=u,l[1]=d,c-a;var f=a*Math.cos(n)+e,m=a*Math.sin(n)+t,v=a*Math.cos(r)+e,g=a*Math.sin(r)+t,y=(f-o)*(f-o)+(m-s)*(m-s),b=(v-o)*(v-o)+(g-s)*(g-s);return y<b?(l[0]=f,l[1]=m,Math.sqrt(y)):(l[0]=v,l[1]=g,Math.sqrt(b))}function Utt(e,t,a,n,r,i,o,s){var l=r-e,c=i-t,u=a-e,d=n-t,h=Math.sqrt(u*u+d*d),p=(l*(u/=h)+c*(d/=h))/h;s&&(p=Math.min(Math.max(p,0),1)),p*=h;var f=o[0]=e+p*u,m=o[1]=t+p*d;return Math.sqrt((f-r)*(f-r)+(m-i)*(m-i))}function ztt(e,t,a,n,r,i,o){a<0&&(e+=a,a=-a),n<0&&(t+=n,n=-n);var s=e+a,l=t+n,c=o[0]=Math.min(Math.max(r,e),s),u=o[1]=Math.min(Math.max(i,t),l);return Math.sqrt((c-r)*(c-r)+(u-i)*(u-i))}var Vtt=[];function Htt(e,t,a){var n=ztt(t.x,t.y,t.width,t.height,e.x,e.y,Vtt);return a.set(Vtt[0],Vtt[1]),n}function Gtt(e,t,a){for(var n,r,i=0,o=0,s=0,l=0,c=1/0,u=t.data,d=e.x,h=e.y,p=0;p<u.length;){var f=u[p++];1===p&&(s=i=u[p],l=o=u[p+1]);var m=c;switch(f){case Ntt.M:i=s=u[p++],o=l=u[p++];break;case Ntt.L:m=Utt(i,o,u[p],u[p+1],d,h,Vtt,!0),i=u[p++],o=u[p++];break;case Ntt.C:m=nYe(i,o,u[p++],u[p++],u[p++],u[p++],u[p],u[p+1],d,h,Vtt),i=u[p++],o=u[p++];break;case Ntt.Q:m=cYe(i,o,u[p++],u[p++],u[p],u[p+1],d,h,Vtt),i=u[p++],o=u[p++];break;case Ntt.A:var v=u[p++],g=u[p++],y=u[p++],b=u[p++],x=u[p++],w=u[p++];p+=1;var _=!!(1-u[p++]);n=Math.cos(x)*y+v,r=Math.sin(x)*b+g,p<=1&&(s=n,l=r),m=Btt(v,g,b,x,x+w,_,(d-v)*b/y+v,h,Vtt),i=Math.cos(x+w)*y+v,o=Math.sin(x+w)*b+g;break;case Ntt.R:m=ztt(s=i=u[p++],l=o=u[p++],u[p++],u[p++],d,h,Vtt);break;case Ntt.Z:m=Utt(i,o,s,l,d,h,Vtt,!0),i=s,o=l}m<c&&(c=m,a.set(Vtt[0],Vtt[1]))}return c}var Wtt=new eqe,qtt=new eqe,Ytt=new eqe,jtt=new eqe,Xtt=new eqe;function $tt(e,t){if(e){var a=e.getTextGuideLine(),n=e.getTextContent();if(n&&a){var r=e.textGuideLineConfig||{},i=[[0,0],[0,0],[0,0]],o=r.candidates||Ott,s=n.getBoundingRect().clone();s.applyTransform(n.getComputedTransform());var l=1/0,c=r.anchor,u=e.getComputedTransform(),d=u&&QWe([],u),h=t.get("length2")||0;c&&Ytt.copy(c);for(var p=0;p<o.length;p++){Ftt(o[p],0,s,Wtt,jtt),eqe.scaleAndAdd(qtt,Wtt,jtt,h),qtt.transform(d);var f=e.getBoundingRect(),m=c?c.distance(qtt):e instanceof gZe?Gtt(qtt,e.path,Ytt):Htt(qtt,f,Ytt);m<l&&(l=m,qtt.transform(u),Ytt.transform(u),Ytt.toArray(i[0]),qtt.toArray(i[1]),Wtt.toArray(i[2]))}Jtt(i,t.get("minTurnAngle")),a.setShape({points:i})}}}var Ktt=[],Ztt=new eqe;function Jtt(e,t){if(t<=180&&t>0){t=t/180*Math.PI,Wtt.fromArray(e[0]),qtt.fromArray(e[1]),Ytt.fromArray(e[2]),eqe.sub(jtt,Wtt,qtt),eqe.sub(Xtt,Ytt,qtt);var a=jtt.len(),n=Xtt.len();if(!(a<.001||n<.001)){jtt.scale(1/a),Xtt.scale(1/n);var r=jtt.dot(Xtt);if(Math.cos(t)<r){var i=Utt(qtt.x,qtt.y,Ytt.x,Ytt.y,Wtt.x,Wtt.y,Ktt,!1);Ztt.fromArray(Ktt),Ztt.scaleAndAdd(Xtt,i/Math.tan(Math.PI-t));var o=Ytt.x!==qtt.x?(Ztt.x-qtt.x)/(Ytt.x-qtt.x):(Ztt.y-qtt.y)/(Ytt.y-qtt.y);if(isNaN(o))return;o<0?eqe.copy(Ztt,qtt):o>1&&eqe.copy(Ztt,Ytt),Ztt.toArray(e[1])}}}}function Qtt(e,t,a){if(a<=180&&a>0){a=a/180*Math.PI,Wtt.fromArray(e[0]),qtt.fromArray(e[1]),Ytt.fromArray(e[2]),eqe.sub(jtt,qtt,Wtt),eqe.sub(Xtt,Ytt,qtt);var n=jtt.len(),r=Xtt.len();if(!(n<.001||r<.001))if(jtt.scale(1/n),Xtt.scale(1/r),jtt.dot(t)<Math.cos(a)){var i=Utt(qtt.x,qtt.y,Ytt.x,Ytt.y,Wtt.x,Wtt.y,Ktt,!1);Ztt.fromArray(Ktt);var o=Math.PI/2,s=o+Math.acos(Xtt.dot(t))-a;if(s>=o)eqe.copy(Ztt,Ytt);else{Ztt.scaleAndAdd(Xtt,i/Math.tan(Math.PI/2-s));var l=Ytt.x!==qtt.x?(Ztt.x-qtt.x)/(Ytt.x-qtt.x):(Ztt.y-qtt.y)/(Ytt.y-qtt.y);if(isNaN(l))return;l<0?eqe.copy(Ztt,qtt):l>1&&eqe.copy(Ztt,Ytt)}Ztt.toArray(e[1])}}}function eat(e,t,a,n){var r="normal"===a,i=r?e:e.ensureState(a);i.ignore=t;var o=n.get("smooth");o&&!0===o&&(o=.3),i.shape=i.shape||{},o>0&&(i.shape.smooth=o);var s=n.getModel("lineStyle").getLineStyle();r?e.useStyle(s):i.style=s}function tat(e,t){var a=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),a>0&&n.length>=3){var r=pWe(n[0],n[1]),i=pWe(n[1],n[2]);if(!r||!i)return e.lineTo(n[1][0],n[1][1]),void e.lineTo(n[2][0],n[2][1]);var o=Math.min(r,i)*a,s=mWe([],n[1],n[0],o/r),l=mWe([],n[1],n[2],o/i),c=mWe([],s,l,.5);e.bezierCurveTo(s[0],s[1],s[0],s[1],c[0],c[1]),e.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var u=1;u<n.length;u++)e.lineTo(n[u][0],n[u][1])}function aat(e,t,a){var n=e.getTextGuideLine(),r=e.getTextContent();if(r){for(var i=t.normal,o=i.get("show"),s=r.ignore,l=0;l<QZe.length;l++){var c=QZe[l],u=t[c],d="normal"===c;if(u){var h=u.get("show");if((d?s:FGe(r.states[c]&&r.states[c].ignore,s))||!FGe(h,o)){var p=d?n:n&&n.states[c];p&&(p.ignore=!0),n&&eat(n,!0,c,u);continue}n||(n=new OQe,e.setTextGuideLine(n),d||!s&&o||eat(n,!0,"normal",t.normal),e.stateProxy&&(n.stateProxy=e.stateProxy)),eat(n,!1,c,u)}}if(n){pGe(n.style,a),n.style.fill=null;var f=i.get("showAbove");(e.textGuideLineConfig=e.textGuideLineConfig||{}).showAbove=f||!1,n.buildPath=tat}}else n&&e.removeTextGuideLine()}function nat(e,t){t=t||"labelLine";for(var a={normal:e.getModel(t)},n=0;n<JZe.length;n++){var r=JZe[n];a[r]=e.getModel([r,t])}return a}var rat=["label","labelLine","layoutOption","priority","defaultAttr","marginForce","minMarginForce","marginDefault","suggestIgnore"];function iat(e,t,a){a=a||3,t?e.dirty|=a:e.dirty&=~a}function oat(e,t){return t=t||3,null==e.dirty||!!(e.dirty&t)}function sat(e){if(e)return oat(e)&&lat(e,e.label,e),e}function lat(e,t,a){var n=t.getComputedTransform();e.transform=$0e(e.transform,n);var r=e.localRect=X0e(e.localRect,t.getBoundingRect()),i=t.style,o=i.margin,s=a&&a.marginForce,l=a&&a.minMarginForce,c=a&&a.marginDefault,u=i.__marginType;null==u&&c&&(o=c,u=y1e.textMargin);for(var d=0;d<4;d++)cat[d]=u===y1e.minMargin&&l&&null!=l[d]?l[d]:s&&null!=s[d]?s[d]:o?o[d]:0;u===y1e.textMargin&&z0e(r,cat,!1,!1);var h=e.rect=X0e(e.rect,r);return n&&h.applyTransform(n),u===y1e.minMargin&&z0e(h,cat,!1,!1),e.axisAligned=Y0e(n),(e.label=e.label||{}).ignore=t.ignore,iat(e,!1),iat(e,!0,2),e}var cat=[0,0,0,0];function uat(e,t){if(e){e.label.x+=t.x,e.label.y+=t.y,e.label.markRedraw();var a=e.transform;a&&(a[4]+=t.x,a[5]+=t.y);var n=e.rect;n&&(n.x+=t.x,n.y+=t.y);var r=e.obb;r&&r.fromBoundingRect(e.localRect,a)}}function dat(e,t){for(var a=0;a<rat.length;a++){var n=rat[a];null==e[n]&&(e[n]=t[n])}return sat(e)}function hat(e){var t=e.obb;return t&&!oat(e,2)||(e.obb=t=t||new r0e,t.fromBoundingRect(e.localRect,e.transform),iat(e,!1,2)),t}function pat(e,t,a,n,r){var i=e.length,o=y0e[t],s=b0e[t];if(i<2)return!1;e.sort(function(e,t){return e.rect[o]-t.rect[o]});for(var l,c=0,u=!1,d=0;d<i;d++){var h=e[d],p=h.rect;(l=p[o]-c)<0&&(p[o]-=l,h.label[o]-=l,u=!0),c=p[o]+p[s]}var f,m,v=e[0],g=e[i-1];function y(){f=v.rect[o]-a,m=n-g.rect[o]-g.rect[s]}function b(e,t,a){if(e<0){var n=Math.min(t,-e);if(n>0){x(n*a,0,i);var r=n+e;r<0&&w(-r*a,1)}else w(-e*a,1)}}function x(t,a,n){0!==t&&(u=!0);for(var r=a;r<n;r++){var i=e[r];i.rect[o]+=t,i.label[o]+=t}}function w(t,a){for(var n=[],r=0,l=1;l<i;l++){var c=e[l-1].rect,u=Math.max(e[l].rect[o]-c[o]-c[s],0);n.push(u),r+=u}if(r){var d=Math.min(Math.abs(t)/r,a);if(t>0)for(l=0;l<i-1;l++){x(n[l]*d,0,l+1)}else for(l=i-1;l>0;l--){x(-(n[l-1]*d),l,i)}}}function _(e){var t=e<0?-1:1;e=Math.abs(e);for(var a=Math.ceil(e/(i-1)),n=0;n<i-1;n++)if(t>0?x(a,0,n+1):x(-a,i-n-1,i),(e-=a)<=0)return}return y(),f<0&&w(-f,.8),m<0&&w(m,.8),y(),b(f,m,1),b(m,f,-1),y(),f<0&&_(-f),m<0&&_(m),u}function fat(e){var t=[];function a(e){if(!e.ignore){var t=e.ensureState("emphasis");null==t.ignore&&(t.ignore=!1)}e.ignore=!0}e.sort(function(e,t){return(t.suggestIgnore?1:0)-(e.suggestIgnore?1:0)||t.priority-e.priority});for(var n=0;n<e.length;n++){var r=sat(e[n]);if(!r.label.ignore){for(var i=r.label,o=r.labelLine,s=!1,l=0;l<t.length;l++)if(mat(r,t[l],null,{touchThreshold:.05})){s=!0;break}s?(a(i),o&&a(o)):t.push(r)}}}function mat(e,t,a,n){return!(!e||!t)&&(!(e.label&&e.label.ignore||t.label&&t.label.ignore)&&(!!e.rect.intersect(t.rect,a,n)&&(!(!e.axisAligned||!t.axisAligned)||hat(e).intersect(hat(t),a,n))))}function vat(e){if(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].slice());return t}}function gat(e,t){var a=e.label,n=t&&t.getTextGuideLine();return{dataIndex:e.dataIndex,dataType:e.dataType,seriesIndex:e.seriesModel.seriesIndex,text:e.label.style.text,rect:e.hostRect,labelRect:e.rect,align:a.style.align,verticalAlign:a.style.verticalAlign,labelLinePoints:vat(n&&n.shape.points)}}var yat=["align","verticalAlign","width","height","fontSize"],bat=new Xje,xat=v$e(),wat=v$e();function _at(e,t,a){for(var n=0;n<a.length;n++){var r=a[n];null!=t[r]&&(e[r]=t[r])}}var Sat=["x","y","rotation"],Mat=function(){function e(){this._labelList=[],this._chartViewList=[]}return e.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},e.prototype._addLabel=function(e,t,a,n,r){var i=n.style,o=n.__hostTarget.textConfig||{},s=n.getComputedTransform(),l=n.getBoundingRect().plain();fqe.applyTransform(l,l,s),s?bat.setLocalTransform(s):(bat.x=bat.y=bat.rotation=bat.originX=bat.originY=0,bat.scaleX=bat.scaleY=1),bat.rotation=tZe(bat.rotation);var c,u=n.__hostTarget;if(u){c=u.getBoundingRect().plain();var d=u.getComputedTransform();fqe.applyTransform(c,c,d)}var h=c&&u.getTextGuideLine();this._labelList.push({label:n,labelLine:h,seriesModel:a,dataIndex:e,dataType:t,layoutOptionOrCb:r,layoutOption:null,rect:l,hostRect:c,priority:c?c.width*c.height:0,defaultAttr:{ignore:n.ignore,labelGuideIgnore:h&&h.ignore,x:bat.x,y:bat.y,scaleX:bat.scaleX,scaleY:bat.scaleY,rotation:bat.rotation,style:{x:i.x,y:i.y,align:i.align,verticalAlign:i.verticalAlign,width:i.width,height:i.height,fontSize:i.fontSize},cursor:n.cursor,attachedPos:o.position,attachedRot:o.rotation}})},e.prototype.addLabelsOfSeries=function(e){var t=this;this._chartViewList.push(e);var a=e.__model,n=a.get("labelLayout");(kGe(n)||_Ge(n).length)&&e.group.traverse(function(e){if(e.ignore)return!0;var r=e.getTextContent(),i=YZe(e);r&&!r.disableLabelLayout&&t._addLabel(i.dataIndex,i.dataType,a,r,n)})},e.prototype.updateLayoutConfig=function(e){var t=e.getWidth(),a=e.getHeight();function n(e,t){return function(){$tt(e,t)}}for(var r=0;r<this._labelList.length;r++){var i=this._labelList[r],o=i.label,s=o.__hostTarget,l=i.defaultAttr,c=void 0;c=(c=kGe(i.layoutOptionOrCb)?i.layoutOptionOrCb(gat(i,s)):i.layoutOptionOrCb)||{},i.layoutOption=c;var u=Math.PI/180;s&&s.setTextConfig({local:!1,position:null!=c.x||null!=c.y?null:l.attachedPos,rotation:null!=c.rotate?c.rotate*u:l.attachedRot,offset:[c.dx||0,c.dy||0]});var d=!1;if(null!=c.x?(o.x=RXe(c.x,t),o.setStyle("x",0),d=!0):(o.x=l.x,o.setStyle("x",l.style.x)),null!=c.y?(o.y=RXe(c.y,a),o.setStyle("y",0),d=!0):(o.y=l.y,o.setStyle("y",l.style.y)),c.labelLinePoints){var h=s.getTextGuideLine();h&&(h.setShape({points:c.labelLinePoints}),d=!1)}xat(o).needsUpdateLabelLine=d,o.rotation=null!=c.rotate?c.rotate*u:l.rotation,o.scaleX=l.scaleX,o.scaleY=l.scaleY;for(var p=0;p<yat.length;p++){var f=yat[p];o.setStyle(f,null!=c[f]?c[f]:l.style[f])}if(c.draggable){if(o.draggable=!0,o.cursor="move",s){var m=i.seriesModel;if(null!=i.dataIndex)m=i.seriesModel.getData(i.dataType).getItemModel(i.dataIndex);o.on("drag",n(s,m.getModel("labelLine")))}}else o.off("drag"),o.cursor=l.cursor}},e.prototype.layout=function(e){var t=e.getWidth(),a=e.getHeight(),n=[];gGe(this._labelList,function(e){e.defaultAttr.ignore||n.push(dat({},e))});var r=xGe(n,function(e){return"shiftX"===e.layoutOption.moveOverlap}),i=xGe(n,function(e){return"shiftY"===e.layoutOption.moveOverlap});pat(r,0,0,t),pat(i,1,0,a);var o=xGe(n,function(e){return e.layoutOption.hideOverlap});!function(e){for(var t=0;t<e.length;t++){var a=e[t],n=a.defaultAttr,r=a.labelLine;a.label.attr("ignore",n.ignore),r&&r.attr("ignore",n.labelGuideIgnore)}}(o),fat(o)},e.prototype.processLabelsOverall=function(){var e=this;gGe(this._chartViewList,function(t){var a=t.__model,n=t.ignoreLabelLineUpdate,r=a.isAnimationEnabled();t.group.traverse(function(t){if(t.ignore&&!t.forceLabelAnimation)return!0;var i=!n,o=t.getTextContent();!i&&o&&(i=xat(o).needsUpdateLabelLine),i&&e._updateLabelLine(t,a),r&&e._animateLabels(t,a)})})},e.prototype._updateLabelLine=function(e,t){var a=e.getTextContent(),n=YZe(e),r=n.dataIndex;if(a&&null!=r){var i=t.getData(n.dataType),o=i.getItemModel(r),s={},l=i.getItemVisual(r,"style");if(l){var c=i.getVisual("drawType");s.stroke=l[c]}var u=o.getModel("labelLine");aat(e,nat(o),s),$tt(e,u)}},e.prototype._animateLabels=function(e,t){var a=e.getTextContent(),n=e.getTextGuideLine();if(a&&(e.forceLabelAnimation||!a.ignore&&!a.invisible&&!e.disableLabelAnimation&&!h0e(e))){var r=(p=xat(a)).oldLayout,i=YZe(e),o=i.dataIndex,s={x:a.x,y:a.y,rotation:a.rotation},l=t.getData(i.dataType);if(r){a.attr(r);var c=e.prevStates;c&&(fGe(c,"select")>=0&&a.attr(p.oldLayoutSelect),fGe(c,"emphasis")>=0&&a.attr(p.oldLayoutEmphasis)),u0e(a,s,t,o)}else if(a.attr(s),!p1e(a).valueAnimation){var u=FGe(a.style.opacity,1);a.style.opacity=0,d0e(a,{style:{opacity:u}},t,o)}if(p.oldLayout=s,a.states.select){var d=p.oldLayoutSelect={};_at(d,s,Sat),_at(d,a.states.select,Sat)}if(a.states.emphasis){var h=p.oldLayoutEmphasis={};_at(h,s,Sat),_at(h,a.states.emphasis,Sat)}m1e(a,o,l,t,t)}if(n&&!n.ignore&&!n.invisible){r=(p=wat(n)).oldLayout;var p,f={points:n.shape.points};r?(n.attr({shape:r}),u0e(n,{shape:f},t)):(n.setShape(f),n.style.strokePercent=0,d0e(n,{style:{strokePercent:1}},t)),p.oldLayout=f}},e}(),Tat=v$e();var kat=Math.sin,Cat=Math.cos,Aat=Math.PI,Eat=2*Math.PI,Iat=180/Aat,Rat=function(){function e(){}return e.prototype.reset=function(e){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,e||4)},e.prototype.moveTo=function(e,t){this._add("M",e,t)},e.prototype.lineTo=function(e,t){this._add("L",e,t)},e.prototype.bezierCurveTo=function(e,t,a,n,r,i){this._add("C",e,t,a,n,r,i)},e.prototype.quadraticCurveTo=function(e,t,a,n){this._add("Q",e,t,a,n)},e.prototype.arc=function(e,t,a,n,r,i){this.ellipse(e,t,a,a,0,n,r,i)},e.prototype.ellipse=function(e,t,a,n,r,i,o,s){var l=o-i,c=!s,u=Math.abs(l),d=HYe(u-Eat)||(c?l>=Eat:-l>=Eat),h=l>0?l%Eat:l%Eat+Eat,p=!1;p=!!d||!HYe(u)&&h>=Aat==!!c;var f=e+a*Cat(i),m=t+n*kat(i);this._start&&this._add("M",f,m);var v=Math.round(r*Iat);if(d){var g=1/this._p,y=(c?1:-1)*(Eat-g);this._add("A",a,n,v,1,+c,e+a*Cat(i+y),t+n*kat(i+y)),g>.01&&this._add("A",a,n,v,0,+c,f,m)}else{var b=e+a*Cat(o),x=t+n*kat(o);this._add("A",a,n,v,+p,+c,b,x)}},e.prototype.rect=function(e,t,a,n){this._add("M",e,t),this._add("l",a,0),this._add("l",0,n),this._add("l",-a,0),this._add("Z")},e.prototype.closePath=function(){this._d.length>0&&this._add("Z")},e.prototype._add=function(e,t,a,n,r,i,o,s,l){for(var c=[],u=this._p,d=1;d<arguments.length;d++){var h=arguments[d];if(isNaN(h))return void(this._invalid=!0);c.push(Math.round(h*u)/u)}this._d.push(e+c.join(" ")),this._start="Z"===e},e.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},e.prototype.getStr=function(){return this._str},e}(),Dat="none",Pat=Math.round;var Lat=["lineCap","miterLimit","lineJoin"],Nat=yGe(Lat,function(e){return"stroke-"+e.toLowerCase()});function Oat(e,t,a,n){var r=null==t.opacity?1:t.opacity;if(a instanceof _Ze)e("opacity",r);else{if(function(e){var t=e.fill;return null!=t&&t!==Dat}(t)){var i=zYe(t.fill);e("fill",i.color);var o=null!=t.fillOpacity?t.fillOpacity*i.opacity*r:i.opacity*r;o<1&&e("fill-opacity",o)}else e("fill",Dat);if(function(e){var t=e.stroke;return null!=t&&t!==Dat}(t)){var s=zYe(t.stroke);e("stroke",s.color);var l=t.strokeNoScale?a.getLineScale():1,c=l?(t.lineWidth||0)/l:0,u=null!=t.strokeOpacity?t.strokeOpacity*s.opacity*r:s.opacity*r,d=t.strokeFirst;if(1!==c&&e("stroke-width",c),d&&e("paint-order",d?"stroke":"fill"),u<1&&e("stroke-opacity",u),t.lineDash){var h=T8e(a),p=h[0],f=h[1];p&&(f=Pat(f||0),e("stroke-dasharray",p.join(",")),(f||n)&&e("stroke-dashoffset",f))}for(var m=0;m<Lat.length;m++){var v=Lat[m];if(t[v]!==fZe[v]){var g=t[v]||fZe[v];g&&e(Nat[m],g)}}}}}var Fat="http://www.w3.org/2000/svg",Bat="http://www.w3.org/1999/xlink",Uat="ecmeta_";function zat(e){return document.createElementNS(Fat,e)}function Vat(e,t,a,n,r){return{tag:e,attrs:a||{},children:n,text:r,key:t}}function Hat(e,t){var a=(t=t||{}).newline?"\n":"";return function e(t){var n=t.children,r=t.tag,i=t.attrs,o=t.text;return function(e,t){var a=[];if(t)for(var n in t){var r=t[n],i=n;!1!==r&&(!0!==r&&null!=r&&(i+='="'+r+'"'),a.push(i))}return"<"+e+" "+a.join(" ")+">"}(r,i)+("style"!==r?RWe(o):o||"")+(n?""+a+yGe(n,function(t){return e(t)}).join(a)+a:"")+("</"+r+">")}(e)}function Gat(e){return{zrId:e,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssStyleCache:{},cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function Wat(e,t,a,n){return Vat("svg","root",{width:e,height:t,xmlns:Fat,"xmlns:xlink":Bat,version:"1.1",baseProfile:"full",viewBox:!!n&&"0 0 "+e+" "+t},a)}var qat=0;function Yat(){return qat++}var jat={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"},Xat="transform-origin";function $at(e,t,a){var n=hGe({},e.shape);hGe(n,t),e.buildPath(a,n);var r=new Rat;return r.reset(JYe(e)),a.rebuildPath(r,1),r.generateStr(),r.getStr()}function Kat(e,t){var a=t.originX,n=t.originY;(a||n)&&(e[Xat]=a+"px "+n+"px")}var Zat={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function Jat(e,t){var a=t.zrId+"-ani-"+t.cssAnimIdx++;return t.cssAnims[a]=e,a}function Qat(e){return CGe(e)?jat[e]?"cubic-bezier("+jat[e]+")":hYe(e)?e:"":""}function ent(e,t,a,n){var r=e.animators,i=r.length,o=[];if(e instanceof YQe){var s=function(e,t,a){var n,r,i=e.shape.paths,o={};if(gGe(i,function(e){var t=Gat(a.zrId);t.animation=!0,ent(e,{},t,!0);var i=t.cssAnims,s=t.cssNodes,l=_Ge(i),c=l.length;if(c){var u=i[r=l[c-1]];for(var d in u){var h=u[d];o[d]=o[d]||{d:""},o[d].d+=h.d||""}for(var p in s){var f=s[p].animation;f.indexOf(r)>=0&&(n=f)}}}),n){t.d=!1;var s=Jat(o,a);return n.replace(r,s)}}(e,t,a);if(s)o.push(s);else if(!i)return}else if(!i)return;for(var l={},c=0;c<i;c++){var u=r[c],d=[u.getMaxTime()/1e3+"s"],h=Qat(u.getClip().easing),p=u.getDelay();h?d.push(h):d.push("linear"),p&&d.push(p/1e3+"s"),u.getLoop()&&d.push("infinite");var f=d.join(" ");l[f]=l[f]||[f,[]],l[f][1].push(u)}function m(r){var i,o=r[1],s=o.length,l={},c={},u={},d="animation-timing-function";function h(e,t,a){for(var n=e.getTracks(),r=e.getMaxTime(),i=0;i<n.length;i++){var o=n[i];if(o.needsAnimate()){var s=o.keyframes,l=o.propName;if(a&&(l=a(l)),l)for(var c=0;c<s.length;c++){var u=s[c],h=Math.round(u.time/r*100)+"%",p=Qat(u.easing),f=u.rawValue;(CGe(f)||EGe(f))&&(t[h]=t[h]||{},t[h][l]=u.rawValue,p&&(t[h][d]=p))}}}}for(var p=0;p<s;p++){(S=(_=o[p]).targetName)?"shape"===S&&h(_,c):!n&&h(_,l)}for(var f in l){var m={};Kje(m,e),hGe(m,l[f]);var v=QYe(m),g=l[f][d];u[f]=v?{transform:v}:{},Kat(u[f],m),g&&(u[f][d]=g)}var y=!0;for(var f in c){u[f]=u[f]||{};var b=!i;g=c[f][d];b&&(i=new KKe);var x=i.len();i.reset(),u[f].d=$at(e,c[f],i);var w=i.len();if(!b&&x!==w){y=!1;break}g&&(u[f][d]=g)}if(!y)for(var f in u)delete u[f].d;if(!n)for(p=0;p<s;p++){var _,S;"style"===(S=(_=o[p]).targetName)&&h(_,u,function(e){return Zat[e]})}var M,T=_Ge(u),k=!0;for(p=1;p<T.length;p++){var C=T[p-1],A=T[p];if(u[C][Xat]!==u[A][Xat]){k=!1;break}M=u[C][Xat]}if(k&&M){for(var f in u)u[f][Xat]&&delete u[f][Xat];t[Xat]=M}if(xGe(T,function(e){return _Ge(u[e]).length>0}).length)return Jat(u,a)+" "+r[0]+" both"}for(var v in l){(s=m(l[v]))&&o.push(s)}if(o.length){var g=a.zrId+"-cls-"+Yat();a.cssNodes["."+g]={animation:o.join(",")},t.class=g}}function tnt(e,t,a,n){var r=JSON.stringify(e),i=a.cssStyleCache[r];i||(i=a.zrId+"-cls-"+Yat(),a.cssStyleCache[r]=i,a.cssNodes["."+i+":hover"]=e),t.class=t.class?t.class+" "+i:i}var ant=Math.round;function nnt(e){return e&&CGe(e.src)}function rnt(e){return e&&kGe(e.toDataURL)}function int(e,t,a,n){Oat(function(r,i){var o="fill"===r||"stroke"===r;o&&KYe(i)?vnt(t,e,r,n):o&&jYe(i)?gnt(a,e,r,n):e[r]=i,o&&n.ssr&&"none"===i&&(e["pointer-events"]="visible")},t,a,!1),function(e,t,a){var n=e.style;if(function(e){return e&&(e.shadowBlur||e.shadowOffsetX||e.shadowOffsetY)}(n)){var r=function(e){var t=e.style,a=e.getGlobalScale();return[t.shadowColor,(t.shadowBlur||0).toFixed(2),(t.shadowOffsetX||0).toFixed(2),(t.shadowOffsetY||0).toFixed(2),a[0],a[1]].join(",")}(e),i=a.shadowCache,o=i[r];if(!o){var s=e.getGlobalScale(),l=s[0],c=s[1];if(!l||!c)return;var u=n.shadowOffsetX||0,d=n.shadowOffsetY||0,h=n.shadowBlur,p=zYe(n.shadowColor),f=p.opacity,m=p.color,v=h/2/l+" "+h/2/c;o=a.zrId+"-s"+a.shadowIdx++,a.defs[o]=Vat("filter",o,{id:o,x:"-100%",y:"-100%",width:"300%",height:"300%"},[Vat("feDropShadow","",{dx:u/l,dy:d/c,stdDeviation:v,"flood-color":m,"flood-opacity":f})]),i[r]=o}t.filter=ZYe(o)}}(a,e,n)}function ont(e,t){var a=function(e){if("function"==typeof SXe)return SXe(e)}(t);a&&(a.each(function(t,a){null!=t&&(e[(Uat+a).toLowerCase()]=t+"")}),t.isSilent()&&(e[Uat+"silent"]="true"))}function snt(e){return HYe(e[0]-1)&&HYe(e[1])&&HYe(e[2])&&HYe(e[3]-1)}function lnt(e,t,a){if(t&&(!function(e){return HYe(e[4])&&HYe(e[5])}(t)||!snt(t))){var n=1e4;e.transform=snt(t)?"translate("+ant(t[4]*n)/n+" "+ant(t[5]*n)/n+")":function(e){return"matrix("+GYe(e[0])+","+GYe(e[1])+","+GYe(e[2])+","+GYe(e[3])+","+WYe(e[4])+","+WYe(e[5])+")"}(t)}}function cnt(e,t,a){for(var n=e.points,r=[],i=0;i<n.length;i++)r.push(ant(n[i][0]*a)/a),r.push(ant(n[i][1]*a)/a);t.points=r.join(" ")}function unt(e){return!e.smooth}var dnt,hnt,pnt={circle:[(dnt=["cx","cy","r"],hnt=yGe(dnt,function(e){return"string"==typeof e?[e,e]:e}),function(e,t,a){for(var n=0;n<hnt.length;n++){var r=hnt[n],i=e[r[0]];null!=i&&(t[r[1]]=ant(i*a)/a)}})],polyline:[cnt,unt],polygon:[cnt,unt]};function fnt(e,t){var a=e.style,n=e.shape,r=pnt[e.type],i={},o=t.animation,s="path",l=e.style.strokePercent,c=t.compress&&JYe(e)||4;if(!r||t.willUpdate||r[1]&&!r[1](n)||o&&function(e){for(var t=e.animators,a=0;a<t.length;a++)if("shape"===t[a].targetName)return!0;return!1}(e)||l<1){var u=!e.path||e.shapeChanged();e.path||e.createPathProxy();var d=e.path;u&&(d.beginPath(),e.buildPath(d,e.shape),e.pathUpdated());var h=d.getVersion(),p=e,f=p.__svgPathBuilder;p.__svgPathVersion===h&&f&&l===p.__svgPathStrokePercent||(f||(f=p.__svgPathBuilder=new Rat),f.reset(c),d.rebuildPath(f,l),f.generateStr(),p.__svgPathVersion=h,p.__svgPathStrokePercent=l),i.d=f.getStr()}else{s=e.type;var m=Math.pow(10,c);r[0](n,i,m)}return lnt(i,e.transform),int(i,a,e,t),ont(i,e),t.animation&&ent(e,i,t),t.emphasis&&function(e,t,a){if(!e.ignore)if(e.isSilent())tnt(c={"pointer-events":"none"},t,a);else{var n=e.states.emphasis&&e.states.emphasis.style?e.states.emphasis.style:{},r=n.fill;if(!r){var i=e.style&&e.style.fill,o=e.states.select&&e.states.select.style&&e.states.select.style.fill,s=e.currentStates.indexOf("select")>=0&&o||i;s&&(r=BYe(s))}var l=n.lineWidth;l&&(l/=!n.strokeNoScale&&e.transform?e.transform[0]:1);var c={cursor:"pointer"};r&&(c.fill=r),n.stroke&&(c.stroke=n.stroke),l&&(c["stroke-width"]=l),tnt(c,t,a)}}(e,i,t),Vat(s,e.id+"",i)}function mnt(e,t){return e instanceof gZe?fnt(e,t):e instanceof _Ze?function(e,t){var a=e.style,n=a.image;if(n&&!CGe(n)&&(nnt(n)?n=n.src:rnt(n)&&(n=n.toDataURL())),n){var r=a.x||0,i=a.y||0,o={href:n,width:a.width,height:a.height};return r&&(o.x=r),i&&(o.y=i),lnt(o,e.transform),int(o,a,e,t),ont(o,e),t.animation&&ent(e,o,t),Vat("image",e.id+"",o)}}(e,t):e instanceof bZe?function(e,t){var a=e.style,n=a.text;if(null!=n&&(n+=""),n&&!isNaN(a.x)&&!isNaN(a.y)){var r=a.font||WHe,i=a.x||0,o=function(e,t,a){return"top"===a?e+=t/2:"bottom"===a&&(e-=t/2),e}(a.y||0,oXe(r),a.textBaseline),s={"dominant-baseline":"central","text-anchor":qYe[a.textAlign]||a.textAlign};if(UZe(a)){var l="",c=a.fontStyle,u=FZe(a.fontSize);if(!parseFloat(u))return;var d=a.fontFamily||GHe,h=a.fontWeight;l+="font-size:"+u+";font-family:"+d+";",c&&"normal"!==c&&(l+="font-style:"+c+";"),h&&"normal"!==h&&(l+="font-weight:"+h+";"),s.style=l}else s.style="font: "+r;return n.match(/\s/)&&(s["xml:space"]="preserve"),i&&(s.x=i),o&&(s.y=o),lnt(s,e.transform),int(s,a,e,t),ont(s,e),t.animation&&ent(e,s,t),Vat("text",e.id+"",s,void 0,n)}}(e,t):void 0}function vnt(e,t,a,n){var r,i=e[a],o={gradientUnits:i.global?"userSpaceOnUse":"objectBoundingBox"};if(XYe(i))r="linearGradient",o.x1=i.x,o.y1=i.y,o.x2=i.x2,o.y2=i.y2;else{if(!$Ye(i))return;r="radialGradient",o.cx=FGe(i.x,.5),o.cy=FGe(i.y,.5),o.r=FGe(i.r,.5)}for(var s=i.colorStops,l=[],c=0,u=s.length;c<u;++c){var d=100*WYe(s[c].offset)+"%",h=zYe(s[c].color),p=h.color,f=h.opacity,m={offset:d};m["stop-color"]=p,f<1&&(m["stop-opacity"]=f),l.push(Vat("stop",c+"",m))}var v=Hat(Vat(r,"",o,l)),g=n.gradientCache,y=g[v];y||(y=n.zrId+"-g"+n.gradientIdx++,g[v]=y,o.id=y,n.defs[y]=Vat(r,y,o,l)),t[a]=ZYe(y)}function gnt(e,t,a,n){var r,i=e.style[a],o=e.getBoundingRect(),s={},l=i.repeat,c="no-repeat"===l,u="repeat-x"===l,d="repeat-y"===l;if(YYe(i)){var h=i.imageWidth,p=i.imageHeight,f=void 0,m=i.image;if(CGe(m)?f=m:nnt(m)?f=m.src:rnt(m)&&(f=m.toDataURL()),"undefined"==typeof Image){var v="Image width/height must been given explictly in svg-ssr renderer.";VGe(h,v),VGe(p,v)}else if(null==h||null==p){var g=function(e,t){if(e){var a=e.elm,n=h||t.width,r=p||t.height;"pattern"===e.tag&&(u?(r=1,n/=o.width):d&&(n=1,r/=o.height)),e.attrs.width=n,e.attrs.height=r,a&&(a.setAttribute("width",n),a.setAttribute("height",r))}},y=H$e(f,null,e,function(e){c||g(_,e),g(r,e)});y&&y.width&&y.height&&(h=h||y.width,p=p||y.height)}r=Vat("image","img",{href:f,width:h,height:p}),s.width=h,s.height=p}else i.svgElement&&(r=cGe(i.svgElement),s.width=i.svgWidth,s.height=i.svgHeight);if(r){var b,x;c?b=x=1:u?(x=1,b=s.width/o.width):d?(b=1,x=s.height/o.height):s.patternUnits="userSpaceOnUse",null==b||isNaN(b)||(s.width=b),null==x||isNaN(x)||(s.height=x);var w=QYe(i);w&&(s.patternTransform=w);var _=Vat("pattern","",s,[r]),S=Hat(_),M=n.patternCache,T=M[S];T||(T=n.zrId+"-p"+n.patternIdx++,M[S]=T,s.id=T,_=n.defs[T]=Vat("pattern",T,s,[r])),t[a]=ZYe(T)}}function ynt(e,t,a){var n=a.clipPathCache,r=a.defs,i=n[e.id];if(!i){var o={id:i=a.zrId+"-c"+a.clipPathIdx++};n[e.id]=i,r[i]=Vat("clipPath",i,o,[fnt(e,a)])}t["clip-path"]=ZYe(i)}function bnt(e){return document.createTextNode(e)}function xnt(e,t,a){e.insertBefore(t,a)}function wnt(e,t){e.removeChild(t)}function _nt(e,t){e.appendChild(t)}function Snt(e){return e.parentNode}function Mnt(e){return e.nextSibling}function Tnt(e,t){e.textContent=t}var knt=Vat("","");function Cnt(e){return void 0===e}function Ant(e){return void 0!==e}function Ent(e,t,a){for(var n={},r=t;r<=a;++r){var i=e[r].key;void 0!==i&&(n[i]=r)}return n}function Int(e,t){var a=e.key===t.key;return e.tag===t.tag&&a}function Rnt(e){var t,a=e.children,n=e.tag;if(Ant(n)){var r=e.elm=zat(n);if(Lnt(knt,e),TGe(a))for(t=0;t<a.length;++t){var i=a[t];null!=i&&_nt(r,Rnt(i))}else Ant(e.text)&&!IGe(e.text)&&_nt(r,bnt(e.text))}else e.elm=bnt(e.text);return e.elm}function Dnt(e,t,a,n,r){for(;n<=r;++n){var i=a[n];null!=i&&xnt(e,Rnt(i),t)}}function Pnt(e,t,a,n){for(;a<=n;++a){var r=t[a];if(null!=r)if(Ant(r.tag))wnt(Snt(r.elm),r.elm);else wnt(e,r.elm)}}function Lnt(e,t){var a,n=t.elm,r=e&&e.attrs||{},i=t.attrs||{};if(r!==i){for(a in i){var o=i[a];r[a]!==o&&(!0===o?n.setAttribute(a,""):!1===o?n.removeAttribute(a):"style"===a?n.style.cssText=o:120!==a.charCodeAt(0)?n.setAttribute(a,o):"xmlns:xlink"===a||"xmlns"===a?n.setAttributeNS("http://www.w3.org/2000/xmlns/",a,o):58===a.charCodeAt(3)?n.setAttributeNS("http://www.w3.org/XML/1998/namespace",a,o):58===a.charCodeAt(5)?n.setAttributeNS(Bat,a,o):n.setAttribute(a,o))}for(a in r)a in i||n.removeAttribute(a)}}function Nnt(e,t){var a=t.elm=e.elm,n=e.children,r=t.children;e!==t&&(Lnt(e,t),Cnt(t.text)?Ant(n)&&Ant(r)?n!==r&&function(e,t,a){for(var n,r,i,o=0,s=0,l=t.length-1,c=t[0],u=t[l],d=a.length-1,h=a[0],p=a[d];o<=l&&s<=d;)null==c?c=t[++o]:null==u?u=t[--l]:null==h?h=a[++s]:null==p?p=a[--d]:Int(c,h)?(Nnt(c,h),c=t[++o],h=a[++s]):Int(u,p)?(Nnt(u,p),u=t[--l],p=a[--d]):Int(c,p)?(Nnt(c,p),xnt(e,c.elm,Mnt(u.elm)),c=t[++o],p=a[--d]):Int(u,h)?(Nnt(u,h),xnt(e,u.elm,c.elm),u=t[--l],h=a[++s]):(Cnt(n)&&(n=Ent(t,o,l)),Cnt(r=n[h.key])||(i=t[r]).tag!==h.tag?xnt(e,Rnt(h),c.elm):(Nnt(i,h),t[r]=void 0,xnt(e,i.elm,c.elm)),h=a[++s]);(o<=l||s<=d)&&(o>l?Dnt(e,null==a[d+1]?null:a[d+1].elm,a,s,d):Pnt(e,t,o,l))}(a,n,r):Ant(r)?(Ant(e.text)&&Tnt(a,""),Dnt(a,null,r,0,r.length-1)):Ant(n)?Pnt(a,n,0,n.length-1):Ant(e.text)&&Tnt(a,""):e.text!==t.text&&(Ant(n)&&Pnt(a,n,0,n.length-1),Tnt(a,t.text)))}var Ont=0,Fnt=function(){function e(e,t,a){if(this.type="svg",this.refreshHover=function(){},this.configLayer=function(){},this.storage=t,this._opts=a=hGe({},a),this.root=e,this._id="zr"+Ont++,this._oldVNode=Wat(a.width,a.height),e&&!a.ssr){var n=this._viewport=document.createElement("div");n.style.cssText="position:relative;overflow:hidden";var r=this._svgDom=this._oldVNode.elm=zat("svg");Lnt(null,this._oldVNode),n.appendChild(r),e.appendChild(n)}this.resize(a.width,a.height)}return e.prototype.getType=function(){return this.type},e.prototype.getViewportRoot=function(){return this._viewport},e.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},e.prototype.getSvgDom=function(){return this._svgDom},e.prototype.refresh=function(){if(this.root){var e=this.renderToVNode({willUpdate:!0});e.attrs.style="position:absolute;left:0;top:0;user-select:none",function(e,t){if(Int(e,t))Nnt(e,t);else{var a=e.elm,n=Snt(a);Rnt(t),null!==n&&(xnt(n,t.elm,Mnt(a)),Pnt(n,[e],0,0))}}(this._oldVNode,e),this._oldVNode=e}},e.prototype.renderOneToVNode=function(e){return mnt(e,Gat(this._id))},e.prototype.renderToVNode=function(e){e=e||{};var t=this.storage.getDisplayList(!0),a=this._width,n=this._height,r=Gat(this._id);r.animation=e.animation,r.willUpdate=e.willUpdate,r.compress=e.compress,r.emphasis=e.emphasis,r.ssr=this._opts.ssr;var i=[],o=this._bgVNode=function(e,t,a,n){var r;if(a&&"none"!==a)if(r=Vat("rect","bg",{width:e,height:t,x:"0",y:"0"}),KYe(a))vnt({fill:a},r.attrs,"fill",n);else if(jYe(a))gnt({style:{fill:a},dirty:eWe,getBoundingRect:function(){return{width:e,height:t}}},r.attrs,"fill",n);else{var i=zYe(a),o=i.color,s=i.opacity;r.attrs.fill=o,s<1&&(r.attrs["fill-opacity"]=s)}return r}(a,n,this._backgroundColor,r);o&&i.push(o);var s=e.compress?null:this._mainVNode=Vat("g","main",{},[]);this._paintList(t,r,s?s.children:i),s&&i.push(s);var l=yGe(_Ge(r.defs),function(e){return r.defs[e]});if(l.length&&i.push(Vat("defs","defs",{},l)),e.animation){var c=function(e,t,a){var n=(a=a||{}).newline?"\n":"",r=" {"+n,i=n+"}",o=yGe(_Ge(e),function(t){return t+r+yGe(_Ge(e[t]),function(a){return a+":"+e[t][a]+";"}).join(n)+i}).join(n),s=yGe(_Ge(t),function(e){return"@keyframes "+e+r+yGe(_Ge(t[e]),function(a){return a+r+yGe(_Ge(t[e][a]),function(n){var r=t[e][a][n];return"d"===n&&(r='path("'+r+'")'),n+":"+r+";"}).join(n)+i}).join(n)+i}).join(n);return o||s?["<![CDATA[",o,s,"]]>"].join(n):""}(r.cssNodes,r.cssAnims,{newline:!0});if(c){var u=Vat("style","stl",{},[],c);i.push(u)}}return Wat(a,n,i,e.useViewBox)},e.prototype.renderToString=function(e){return e=e||{},Hat(this.renderToVNode({animation:FGe(e.cssAnimation,!0),emphasis:FGe(e.cssEmphasis,!0),willUpdate:!1,compress:!0,useViewBox:FGe(e.useViewBox,!0)}),{newline:!0})},e.prototype.setBackgroundColor=function(e){this._backgroundColor=e},e.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},e.prototype._paintList=function(e,t,a){for(var n,r,i=e.length,o=[],s=0,l=0,c=0;c<i;c++){var u=e[c];if(!u.invisible){var d=u.__clipPaths,h=d&&d.length||0,p=r&&r.length||0,f=void 0;for(f=Math.max(h-1,p-1);f>=0&&(!d||!r||d[f]!==r[f]);f--);for(var m=p-1;m>f;m--)n=o[--s-1];for(var v=f+1;v<h;v++){var g={};ynt(d[v],g,t);var y=Vat("g","clip-g-"+l++,g,[]);(n?n.children:a).push(y),o[s++]=y,n=y}r=d;var b=mnt(u,t);b&&(n?n.children:a).push(b)}}},e.prototype.resize=function(e,t){var a=this._opts,n=this.root,r=this._viewport;if(null!=e&&(a.width=e),null!=t&&(a.height=t),n&&r&&(r.style.display="none",e=M8e(n,0,a),t=M8e(n,1,a),r.style.display=""),this._width!==e||this._height!==t){if(this._width=e,this._height=t,r){var i=r.style;i.width=e+"px",i.height=t+"px"}if(jYe(this._backgroundColor))this.refresh();else{var o=this._svgDom;o&&(o.setAttribute("width",e),o.setAttribute("height",t));var s=this._bgVNode&&this._bgVNode.elm;s&&(s.setAttribute("width",e),s.setAttribute("height",t))}}},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},e.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},e.prototype.toDataURL=function(e){var t=this.renderToString(),a="data:image/svg+xml;";return e?(t=eje(t))&&a+"base64,"+t:a+"charset=UTF-8,"+encodeURIComponent(t)},e}();function Bnt(e,t,a){var n=XHe.createCanvas(),r=t.getWidth(),i=t.getHeight(),o=n.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=r+"px",o.height=i+"px",n.setAttribute("data-zr-dom-id",e)),n.width=r*a,n.height=i*a,n}var Unt=function(e){function t(t,a,n){var r,i=e.call(this)||this;i.motionBlur=!1,i.lastFrameAlpha=.7,i.dpr=1,i.virtual=!1,i.config={},i.incremental=!1,i.zlevel=0,i.maxRepaintRectCount=5,i.__dirty=!0,i.__firstTimePaint=!0,i.__used=!1,i.__drawIndex=0,i.__startIndex=0,i.__endIndex=0,i.__prevStartIndex=null,i.__prevEndIndex=null,n=n||Fje,"string"==typeof t?r=Bnt(t,a,n):IGe(t)&&(t=(r=t).id),i.id=t,i.dom=r;var o=r.style;return o&&(JGe(r),r.onselectstart=function(){return!1},o.padding="0",o.margin="0",o.borderWidth="0"),i.painter=a,i.dpr=n,i}return zHe(t,e),t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var e=this.dpr;this.domBack=Bnt("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),1!==e&&this.ctxBack.scale(e,e)},t.prototype.createRepaintRects=function(e,t,a,n){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var r,i=[],o=this.maxRepaintRectCount,s=!1,l=new fqe(0,0,0,0);function c(e){if(e.isFinite()&&!e.isZero())if(0===i.length){(t=new fqe(0,0,0,0)).copy(e),i.push(t)}else{for(var t,a=!1,n=1/0,r=0,c=0;c<i.length;++c){var u=i[c];if(u.intersect(e)){var d=new fqe(0,0,0,0);d.copy(u),d.union(e),i[c]=d,a=!0;break}if(s){l.copy(e),l.union(u);var h=e.width*e.height,p=u.width*u.height,f=l.width*l.height-h-p;f<n&&(n=f,r=c)}}if(s&&(i[r].union(e),a=!0),!a)(t=new fqe(0,0,0,0)).copy(e),i.push(t);s||(s=i.length>=o)}}for(var u=this.__startIndex;u<this.__endIndex;++u){if(p=e[u]){var d=p.shouldBePainted(a,n,!0,!0);(f=p.__isRendered&&(1&p.__dirty||!d)?p.getPrevPaintRect():null)&&c(f);var h=d&&(1&p.__dirty||!p.__isRendered)?p.getPaintRect():null;h&&c(h)}}for(u=this.__prevStartIndex;u<this.__prevEndIndex;++u){var p,f;d=(p=t[u])&&p.shouldBePainted(a,n,!0,!0);if(p&&(!d||!p.__zr)&&p.__isRendered)(f=p.getPrevPaintRect())&&c(f)}do{r=!1;for(u=0;u<i.length;)if(i[u].isZero())i.splice(u,1);else{for(var m=u+1;m<i.length;)i[u].intersect(i[m])?(r=!0,i[u].union(i[m]),i.splice(m,1)):m++;u++}}while(r);return this._paintRects=i,i},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(e,t){var a=this.dpr,n=this.dom,r=n.style,i=this.domBack;r&&(r.width=e+"px",r.height=t+"px"),n.width=e*a,n.height=t*a,i&&(i.width=e*a,i.height=t*a,1!==a&&this.ctxBack.scale(a,a))},t.prototype.clear=function(e,t,a){var n=this.dom,r=this.ctx,i=n.width,o=n.height;t=t||this.clearColor;var s=this.motionBlur&&!e,l=this.lastFrameAlpha,c=this.dpr,u=this;s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(n,0,0,i/c,o/c));var d=this.domBack;function h(e,a,n,i){if(r.clearRect(e,a,n,i),t&&"transparent"!==t){var o=void 0;if(LGe(t))o=(t.global||t.__width===n&&t.__height===i)&&t.__canvasGradient||_8e(r,t,{x:0,y:0,width:n,height:i}),t.__canvasGradient=o,t.__width=n,t.__height=i;else null!=t.image&&(t.scaleX=t.scaleX||c,t.scaleY=t.scaleY||c,o=D8e(r,t,{dirty:function(){u.setUnpainted(),u.painter.refresh()}}));r.save(),r.fillStyle=o||t,r.fillRect(e,a,n,i),r.restore()}s&&(r.save(),r.globalAlpha=l,r.drawImage(d,e,a,n,i),r.restore())}!a||s?h(0,0,i,o):a.length&&gGe(a,function(e){h(e.x*c,e.y*c,e.width*c,e.height*c)})},t}(wWe),znt=1e5,Vnt=314159,Hnt=.01;var Gnt=function(){function e(e,t,a,n){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var r=!e.nodeName||"CANVAS"===e.nodeName.toUpperCase();this._opts=a=hGe({},a||{}),this.dpr=a.devicePixelRatio||Fje,this._singleCanvas=r,this.root=e,e.style&&(JGe(e),e.innerHTML=""),this.storage=t;var i=this._zlevelList;this._prevDisplayList=[];var o=this._layers;if(r){var s=e,l=s.width,c=s.height;null!=a.width&&(l=a.width),null!=a.height&&(c=a.height),this.dpr=a.devicePixelRatio||1,s.width=l*this.dpr,s.height=c*this.dpr,this._width=l,this._height=c;var u=new Unt(s,this,this.dpr);u.__builtin__=!0,u.initContext(),o[314159]=u,u.zlevel=Vnt,i.push(Vnt),this._domRoot=e}else{this._width=M8e(e,0,a),this._height=M8e(e,1,a);var d=this._domRoot=function(e,t){var a=document.createElement("div");return a.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",a}(this._width,this._height);e.appendChild(d)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},e.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),a=this._prevDisplayList,n=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,a,e,this._redrawId);for(var r=0;r<n.length;r++){var i=n[r],o=this._layers[i];if(!o.__builtin__&&o.refresh){var s=0===r?this._backgroundColor:null;o.refresh(s)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(e){var t=e.length,a=this._hoverlayer;if(a&&a.clear(),t){for(var n,r={inHover:!0,viewWidth:this._width,viewHeight:this._height},i=0;i<t;i++){var o=e[i];o.__inHover&&(a||(a=this._hoverlayer=this.getLayer(znt)),n||(n=a.ctx).save(),V8e(n,o,r,i===t-1))}n&&n.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(znt)},e.prototype.paintOne=function(e,t){z8e(e,t)},e.prototype._paintList=function(e,t,a,n){if(this._redrawId===n){a=a||!1,this._updateLayerStatus(e);var r=this._doPaintList(e,t,a),i=r.finished,o=r.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),o&&this._paintHoverList(e),i)this.eachLayer(function(e){e.afterBrush&&e.afterBrush()});else{var s=this;Bqe(function(){s._paintList(e,t,a,n)})}}},e.prototype._compositeManually=function(){var e=this.getLayer(Vnt).ctx,t=this._domRoot.width,a=this._domRoot.height;e.clearRect(0,0,t,a),this.eachBuiltinLayer(function(n){n.virtual&&e.drawImage(n.dom,0,0,t,a)})},e.prototype._doPaintList=function(e,t,a){for(var n=this,r=[],i=this._opts.useDirtyRect,o=0;o<this._zlevelList.length;o++){var s=this._zlevelList[o],l=this._layers[s];l.__builtin__&&l!==this._hoverlayer&&(l.__dirty||a)&&r.push(l)}for(var c=!0,u=!1,d=function(o){var s,l=r[o],d=l.ctx,p=i&&l.createRepaintRects(e,t,h._width,h._height),f=a?l.__startIndex:l.__drawIndex,m=!a&&l.incremental&&Date.now,v=m&&Date.now(),g=l.zlevel===h._zlevelList[0]?h._backgroundColor:null;if(l.__startIndex===l.__endIndex)l.clear(!1,g,p);else if(f===l.__startIndex){var y=e[f];y.incremental&&y.notClear&&!a||l.clear(!1,g,p)}-1===f&&(console.error("For some unknown reason. drawIndex is -1"),f=l.__startIndex);var b=function(t){var a={inHover:!1,allClipped:!1,prevEl:null,viewWidth:n._width,viewHeight:n._height};for(s=f;s<l.__endIndex;s++){var r=e[s];if(r.__inHover&&(u=!0),n._doPaintEl(r,l,i,t,a,s===l.__endIndex-1),m)if(Date.now()-v>15)break}a.prevElClipPaths&&d.restore()};if(p)if(0===p.length)s=l.__endIndex;else for(var x=h.dpr,w=0;w<p.length;++w){var _=p[w];d.save(),d.beginPath(),d.rect(_.x*x,_.y*x,_.width*x,_.height*x),d.clip(),b(_),d.restore()}else d.save(),b(),d.restore();l.__drawIndex=s,l.__drawIndex<l.__endIndex&&(c=!1)},h=this,p=0;p<r.length;p++)d(p);return HHe.wxa&&gGe(this._layers,function(e){e&&e.ctx&&e.ctx.draw&&e.ctx.draw()}),{finished:c,needsRefreshHover:u}},e.prototype._doPaintEl=function(e,t,a,n,r,i){var o=t.ctx;if(a){var s=e.getPaintRect();(!n||s&&s.intersect(n))&&(V8e(o,e,r,i),e.setPrevPaintRect(s))}else V8e(o,e,r,i)},e.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=Vnt);var a=this._layers[e];return a||((a=new Unt("zr_"+e,this,this.dpr)).zlevel=e,a.__builtin__=!0,this._layerConfig[e]?uGe(a,this._layerConfig[e],!0):this._layerConfig[e-Hnt]&&uGe(a,this._layerConfig[e-Hnt],!0),t&&(a.virtual=t),this.insertLayer(e,a),a.initContext()),a},e.prototype.insertLayer=function(e,t){var a=this._layers,n=this._zlevelList,r=n.length,i=this._domRoot,o=null,s=-1;if(!a[e]&&function(e){return!!e&&(!!e.__builtin__||"function"==typeof e.resize&&"function"==typeof e.refresh)}(t)){if(r>0&&e>n[0]){for(s=0;s<r-1&&!(n[s]<e&&n[s+1]>e);s++);o=a[n[s]]}if(n.splice(s+1,0,e),a[e]=t,!t.virtual)if(o){var l=o.dom;l.nextSibling?i.insertBefore(t.dom,l.nextSibling):i.appendChild(t.dom)}else i.firstChild?i.insertBefore(t.dom,i.firstChild):i.appendChild(t.dom);t.painter||(t.painter=this)}},e.prototype.eachLayer=function(e,t){for(var a=this._zlevelList,n=0;n<a.length;n++){var r=a[n];e.call(t,this._layers[r],r)}},e.prototype.eachBuiltinLayer=function(e,t){for(var a=this._zlevelList,n=0;n<a.length;n++){var r=a[n],i=this._layers[r];i.__builtin__&&e.call(t,i,r)}},e.prototype.eachOtherLayer=function(e,t){for(var a=this._zlevelList,n=0;n<a.length;n++){var r=a[n],i=this._layers[r];i.__builtin__||e.call(t,i,r)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(e){function t(e){i&&(i.__endIndex!==e&&(i.__dirty=!0),i.__endIndex=e)}if(this.eachBuiltinLayer(function(e,t){e.__dirty=e.__used=!1}),this._singleCanvas)for(var a=1;a<e.length;a++){if((s=e[a]).zlevel!==e[a-1].zlevel||s.incremental){this._needsManuallyCompositing=!0;break}}var n,r,i=null,o=0;for(r=0;r<e.length;r++){var s,l=(s=e[r]).zlevel,c=void 0;n!==l&&(n=l,o=0),s.incremental?((c=this.getLayer(l+.001,this._needsManuallyCompositing)).incremental=!0,o=1):c=this.getLayer(l+(o>0?Hnt:0),this._needsManuallyCompositing),c.__builtin__||lGe("ZLevel "+l+" has been used by unkown layer "+c.id),c!==i&&(c.__used=!0,c.__startIndex!==r&&(c.__dirty=!0),c.__startIndex=r,c.incremental?c.__drawIndex=-1:c.__drawIndex=r,t(r),i=c),1&s.__dirty&&!s.__inHover&&(c.__dirty=!0,c.incremental&&c.__drawIndex<0&&(c.__drawIndex=r))}t(r),this.eachBuiltinLayer(function(e,t){!e.__used&&e.getElementCount()>0&&(e.__dirty=!0,e.__startIndex=e.__endIndex=e.__drawIndex=0),e.__dirty&&e.__drawIndex<0&&(e.__drawIndex=e.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(e){e.clear()},e.prototype.setBackgroundColor=function(e){this._backgroundColor=e,gGe(this._layers,function(e){e.setUnpainted()})},e.prototype.configLayer=function(e,t){if(t){var a=this._layerConfig;a[e]?uGe(a[e],t,!0):a[e]=t;for(var n=0;n<this._zlevelList.length;n++){var r=this._zlevelList[n];if(r===e||r===e+Hnt)uGe(this._layers[r],a[e],!0)}}},e.prototype.delLayer=function(e){var t=this._layers,a=this._zlevelList,n=t[e];n&&(n.dom.parentNode.removeChild(n.dom),delete t[e],a.splice(fGe(a,e),1))},e.prototype.resize=function(e,t){if(this._domRoot.style){var a=this._domRoot;a.style.display="none";var n=this._opts,r=this.root;if(null!=e&&(n.width=e),null!=t&&(n.height=t),e=M8e(r,0,n),t=M8e(r,1,n),a.style.display="",this._width!==e||t!==this._height){for(var i in a.style.width=e+"px",a.style.height=t+"px",this._layers)this._layers.hasOwnProperty(i)&&this._layers[i].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(null==e||null==t)return;this._width=e,this._height=t,this.getLayer(Vnt).resize(e,t)}return this},e.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[314159].dom;var t=new Unt("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var a=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var n=t.dom.width,r=t.dom.height;this.eachLayer(function(e){e.__builtin__?a.drawImage(e.dom,0,0,n,r):e.renderToCanvas&&(a.save(),e.renderToCanvas(a),a.restore())})}else for(var i={inHover:!1,viewWidth:this._width,viewHeight:this._height},o=this.storage.getDisplayList(!0),s=0,l=o.length;s<l;s++){var c=o[s];V8e(a,c,i,s===l-1)}return t.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();function Wnt(e){e.registerPainter("canvas",Gnt)}var qnt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a}return zHe(t,e),t.prototype.getInitialData=function(e){return U9e(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(e){var t=new xXe,a=y8e("line",0,e.itemHeight/2,e.itemWidth,0,e.lineStyle.stroke,!1);t.add(a),a.setStyle(e.lineStyle);var n=this.getData().getVisual("symbol"),r=this.getData().getVisual("symbolRotate"),i="none"===n?"circle":n,o=.8*e.itemHeight,s=y8e(i,(e.itemWidth-o)/2,(e.itemHeight-o)/2,o,o,e.itemStyle.fill);t.add(s),s.setStyle(e.itemStyle);var l="inherit"===e.iconRotate?r:e.iconRotate||0;return s.rotation=l*Math.PI/180,s.setOrigin([e.itemWidth/2,e.itemHeight/2]),i.indexOf("empty")>-1&&(s.style.stroke=s.style.fill,s.style.fill=o5e.color.neutral00,s.style.lineWidth=2),t},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:6,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}($3e);function Ynt(e,t){var a=e.mapDimensionsAll("defaultedLabel"),n=a.length;if(1===n){var r=W4e(e,t,a[0]);return null!=r?r+"":null}if(n){for(var i=[],o=0;o<a.length;o++)i.push(W4e(e,t,a[o]));return i.join(" ")}}function jnt(e,t){var a=e.mapDimensionsAll("defaultedLabel");if(!TGe(t))return t+"";for(var n=[],r=0;r<a.length;r++){var i=e.getDimensionIndex(a[r]);i>=0&&n.push(t[i])}return n.join(" ")}var Xnt=function(e){function t(t,a,n,r){var i=e.call(this)||this;return i.updateData(t,a,n,r),i}return zHe(t,e),t.prototype._createSymbol=function(e,t,a,n,r,i){this.removeAll();var o=y8e(e,-1,-1,2,2,null,i);o.attr({z2:FGe(r,100),culling:!0,scaleX:n[0]/2,scaleY:n[1]/2}),o.drift=$nt,this._symbolType=e,this.add(o)},t.prototype.stopSymbolAnimation=function(e){this.childAt(0).stopAnimation(null,e)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){_Je(this.childAt(0))},t.prototype.downplay=function(){SJe(this.childAt(0))},t.prototype.setZ=function(e,t){var a=this.childAt(0);a.zlevel=e,a.z=t},t.prototype.setDraggable=function(e,t){var a=this.childAt(0);a.draggable=e,a.cursor=!t&&e?"move":a.cursor},t.prototype.updateData=function(e,a,n,r){this.silent=!1;var i=e.getItemVisual(a,"symbol")||"circle",o=e.hostModel,s=t.getSymbolSize(e,a),l=t.getSymbolZ2(e,a),c=i!==this._symbolType,u=r&&r.disableAnimation;if(c){var d=e.getItemVisual(a,"symbolKeepAspect");this._createSymbol(i,e,a,s,l,d)}else{(p=this.childAt(0)).silent=!1;var h={scaleX:s[0]/2,scaleY:s[1]/2};u?p.attr(h):u0e(p,h,o,a),v0e(p)}if(this._updateCommon(e,a,s,n,r),c){var p=this.childAt(0);if(!u){h={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:p.style.opacity}};p.scaleX=p.scaleY=0,p.style.opacity=0,d0e(p,h,o,a)}}u&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(e,t,a,n,r){var i,o,s,l,c,u,d,h,p,f=this.childAt(0),m=e.hostModel;if(n&&(i=n.emphasisItemStyle,o=n.blurItemStyle,s=n.selectItemStyle,l=n.focus,c=n.blurScope,d=n.labelStatesModels,h=n.hoverScale,p=n.cursorStyle,u=n.emphasisDisabled),!n||e.hasItemOption){var v=n&&n.itemModel?n.itemModel:e.getItemModel(t),g=v.getModel("emphasis");i=g.getModel("itemStyle").getItemStyle(),s=v.getModel(["select","itemStyle"]).getItemStyle(),o=v.getModel(["blur","itemStyle"]).getItemStyle(),l=g.get("focus"),c=g.get("blurScope"),u=g.get("disabled"),d=i1e(v),h=g.getShallow("scale"),p=v.getShallow("cursor")}var y=e.getItemVisual(t,"symbolRotate");f.attr("rotation",(y||0)*Math.PI/180||0);var b=x8e(e.getItemVisual(t,"symbolOffset"),a);b&&(f.x=b[0],f.y=b[1]),p&&f.attr("cursor",p);var x=e.getItemVisual(t,"style"),w=x.fill;if(f instanceof _Ze){var _=f.style;f.useStyle(hGe({image:_.image,x:_.x,y:_.y,width:_.width,height:_.height},x))}else f.__isEmptyBrush?f.useStyle(hGe({},x)):f.useStyle(x),f.style.decal=null,f.setColor(w,r&&r.symbolInnerColor),f.style.strokeNoScale=!0;var S=e.getItemVisual(t,"liftZ"),M=this._z2;null!=S?null==M&&(this._z2=f.z2,f.z2+=S):null!=M&&(f.z2=M,this._z2=null);var T=r&&r.useNameLabel;r1e(f,d,{labelFetcher:m,labelDataIndex:t,defaultText:function(t){return T?e.getName(t):Ynt(e,t)},inheritColor:w,defaultOpacity:x.opacity}),this._sizeX=a[0]/2,this._sizeY=a[1]/2;var k=f.ensureState("emphasis");k.style=i,f.ensureState("select").style=s,f.ensureState("blur").style=o;var C=null==h||!0===h?Math.max(1.1,3/this._sizeY):isFinite(h)&&h>0?+h:1;k.scaleX=this._sizeX*C,k.scaleY=this._sizeY*C,this.setSymbolScale(1),OJe(this,l,c,u)},t.prototype.setSymbolScale=function(e){this.scaleX=this.scaleY=e},t.prototype.fadeOut=function(e,t,a){var n=this.childAt(0),r=YZe(this).dataIndex,i=a&&a.animation;if(this.silent=n.silent=!0,a&&a.fadeLabel){var o=n.getTextContent();o&&p0e(o,{style:{opacity:0}},t,{dataIndex:r,removeOpt:i,cb:function(){n.removeTextContent()}})}else n.removeTextContent();p0e(n,{style:{opacity:0},scaleX:0,scaleY:0},t,{dataIndex:r,cb:e,removeOpt:i})},t.getSymbolSize=function(e,t){return b8e(e.getItemVisual(t,"symbolSize"))},t.getSymbolZ2=function(e,t){return e.getItemVisual(t,"z2")},t}(xXe);function $nt(e,t){this.parent.drift(e,t)}function Knt(e,t,a,n){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(n.isIgnore&&n.isIgnore(a))&&!(n.clipShape&&!n.clipShape.contain(t[0],t[1]))&&"none"!==e.getItemVisual(a,"symbol")}function Znt(e){return null==e||IGe(e)||(e={isIgnore:e}),e||{}}function Jnt(e){var t=e.hostModel,a=t.getModel("emphasis");return{emphasisItemStyle:a.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:a.get("focus"),blurScope:a.get("blurScope"),emphasisDisabled:a.get("disabled"),hoverScale:a.get("scale"),labelStatesModels:i1e(t),cursorStyle:t.get("cursor")}}var Qnt=function(){function e(e){this.group=new xXe,this._SymbolCtor=e||Xnt}return e.prototype.updateData=function(e,t){this._progressiveEls=null,t=Znt(t);var a=this.group,n=e.hostModel,r=this._data,i=this._SymbolCtor,o=t.disableAnimation,s=Jnt(e),l={disableAnimation:o},c=t.getSymbolPoint||function(t){return e.getItemLayout(t)};r||a.removeAll(),e.diff(r).add(function(n){var r=c(n);if(Knt(e,r,n,t)){var o=new i(e,n,s,l);o.setPosition(r),e.setItemGraphicEl(n,o),a.add(o)}}).update(function(u,d){var h=r.getItemGraphicEl(d),p=c(u);if(Knt(e,p,u,t)){var f=e.getItemVisual(u,"symbol")||"circle",m=h&&h.getSymbolType&&h.getSymbolType();if(!h||m&&m!==f)a.remove(h),(h=new i(e,u,s,l)).setPosition(p);else{h.updateData(e,u,s,l);var v={x:p[0],y:p[1]};o?h.attr(v):u0e(h,v,n)}a.add(h),e.setItemGraphicEl(u,h)}else a.remove(h)}).remove(function(e){var t=r.getItemGraphicEl(e);t&&t.fadeOut(function(){a.remove(t)},n)}).execute(),this._getSymbolPoint=c,this._data=e},e.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl(function(t,a){var n=e._getSymbolPoint(a);t.setPosition(n),t.markRedraw()})},e.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=Jnt(e),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(e,t,a){function n(e){e.isGroup||(e.incremental=!0,e.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[],a=Znt(a);for(var r=e.start;r<e.end;r++){var i=t.getItemLayout(r);if(Knt(t,i,r,a)){var o=new this._SymbolCtor(t,r,this._seriesScope);o.traverse(n),o.setPosition(i),this.group.add(o),t.setItemGraphicEl(r,o),this._progressiveEls.push(o)}}},e.prototype.eachRendered=function(e){q0e(this._progressiveEls||this.group,e)},e.prototype.remove=function(e){var t=this.group,a=this._data;a&&e?a.eachItemGraphicEl(function(e){e.fadeOut(function(){t.remove(e)},a.hostModel)}):t.removeAll()},e}();function ert(e,t,a){var n=e.getBaseAxis(),r=e.getOtherAxis(n),i=function(e,t){var a=0,n=e.scale.getExtent();"start"===t?a=n[0]:"end"===t?a=n[1]:EGe(t)&&!isNaN(t)?a=t:n[0]>0?a=n[0]:n[1]<0&&(a=n[1]);return a}(r,a),o=n.dim,s=r.dim,l=t.mapDimension(s),c=t.mapDimension(o),u="x"===s||"radius"===s?1:0,d=yGe(e.dimensions,function(e){return t.mapDimension(e)}),h=!1,p=t.getCalculationInfo("stackResultDimension");return F9e(t,d[0])&&(h=!0,d[0]=p),F9e(t,d[1])&&(h=!0,d[1]=p),{dataDimsForPoint:d,valueStart:i,valueAxisDim:s,baseAxisDim:o,stacked:!!h,valueDim:l,baseDim:c,baseDataOffset:u,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function trt(e,t,a,n){var r=NaN;e.stacked&&(r=a.get(a.getCalculationInfo("stackedOverDimension"),n)),isNaN(r)&&(r=e.valueStart);var i=e.baseDataOffset,o=[];return o[i]=a.get(e.baseDim,n),o[1-i]=r,t.dataToPoint(o)}var art=Math.min,nrt=Math.max;function rrt(e,t){return isNaN(e)||isNaN(t)}function irt(e,t,a,n,r,i,o,s,l){for(var c,u,d,h,p,f,m=a,v=0;v<n;v++){var g=t[2*m],y=t[2*m+1];if(m>=r||m<0)break;if(rrt(g,y)){if(l){m+=i;continue}break}if(m===a)e[i>0?"moveTo":"lineTo"](g,y),d=g,h=y;else{var b=g-c,x=y-u;if(b*b+x*x<.5){m+=i;continue}if(o>0){for(var w=m+i,_=t[2*w],S=t[2*w+1];_===g&&S===y&&v<n;)v++,m+=i,_=t[2*(w+=i)],S=t[2*w+1],b=(g=t[2*m])-c,x=(y=t[2*m+1])-u;var M=v+1;if(l)for(;rrt(_,S)&&M<n;)M++,_=t[2*(w+=i)],S=t[2*w+1];var T=.5,k=0,C=0,A=void 0,E=void 0;if(M>=n||rrt(_,S))p=g,f=y;else{k=_-c,C=S-u;var I=g-c,R=_-g,D=y-u,P=S-y,L=void 0,N=void 0;if("x"===s){var O=k>0?1:-1;p=g-O*(L=Math.abs(I))*o,f=y,A=g+O*(N=Math.abs(R))*o,E=y}else if("y"===s){var F=C>0?1:-1;p=g,f=y-F*(L=Math.abs(D))*o,A=g,E=y+F*(N=Math.abs(P))*o}else L=Math.sqrt(I*I+D*D),p=g-k*o*(1-(T=(N=Math.sqrt(R*R+P*P))/(N+L))),f=y-C*o*(1-T),E=y+C*o*T,A=art(A=g+k*o*T,nrt(_,g)),E=art(E,nrt(S,y)),A=nrt(A,art(_,g)),f=y-(C=(E=nrt(E,art(S,y)))-y)*L/N,p=art(p=g-(k=A-g)*L/N,nrt(c,g)),f=art(f,nrt(u,y)),A=g+(k=g-(p=nrt(p,art(c,g))))*N/L,E=y+(C=y-(f=nrt(f,art(u,y))))*N/L}e.bezierCurveTo(d,h,p,f,g,y),d=A,h=E}else e.lineTo(g,y)}c=g,u=y,m+=i}return v}var ort=function(){this.smooth=0,this.smoothConstraint=!0},srt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="ec-polyline",a}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:o5e.color.neutral99,fill:null}},t.prototype.getDefaultShape=function(){return new ort},t.prototype.buildPath=function(e,t){var a=t.points,n=0,r=a.length/2;if(t.connectNulls){for(;r>0&&rrt(a[2*r-2],a[2*r-1]);r--);for(;n<r&&rrt(a[2*n],a[2*n+1]);n++);}for(;n<r;)n+=irt(e,a,n,r,r,1,t.smooth,t.smoothMonotone,t.connectNulls)+1},t.prototype.getPointOn=function(e,t){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var a,n,r=this.path.data,i=KKe.CMD,o="x"===t,s=[],l=0;l<r.length;){var c=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,m=void 0;switch(r[l++]){case i.M:a=r[l++],n=r[l++];break;case i.L:if(c=r[l++],u=r[l++],(m=o?(e-a)/(c-a):(e-n)/(u-n))<=1&&m>=0){var v=o?(u-n)*m+n:(c-a)*m+a;return o?[e,v]:[v,e]}a=c,n=u;break;case i.C:c=r[l++],u=r[l++],d=r[l++],h=r[l++],p=r[l++],f=r[l++];var g=o?eYe(a,c,d,p,e,s):eYe(n,u,h,f,e,s);if(g>0)for(var y=0;y<g;y++){var b=s[y];if(b<=1&&b>=0){v=o?Jqe(n,u,h,f,b):Jqe(a,c,d,p,b);return o?[e,v]:[v,e]}}a=p,n=f}}},t}(gZe),lrt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t}(ort),crt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="ec-polygon",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new lrt},t.prototype.buildPath=function(e,t){var a=t.points,n=t.stackedOnPoints,r=0,i=a.length/2,o=t.smoothMonotone;if(t.connectNulls){for(;i>0&&rrt(a[2*i-2],a[2*i-1]);i--);for(;r<i&&rrt(a[2*r],a[2*r+1]);r++);}for(;r<i;){var s=irt(e,a,r,i,i,1,t.smooth,o,t.connectNulls);irt(e,n,r+s-1,s,i,-1,t.stackedOnSmooth,o,t.connectNulls),r+=s+1,e.closePath()}},t}(gZe);function urt(e,t,a,n,r){var i=e.getArea(),o=i.x,s=i.y,l=i.width,c=i.height,u=a.get(["lineStyle","width"])||0;o-=u/2,s-=u/2,l+=u,c+=u,l=Math.ceil(l),o!==Math.floor(o)&&(o=Math.floor(o),l++);var d=new EZe({shape:{x:o,y:s,width:l,height:c}});if(t){var h=e.getBaseAxis(),p=h.isHorizontal(),f=h.inverse;p?(f&&(d.shape.x+=l),d.shape.width=0):(f||(d.shape.y+=c),d.shape.height=0);var m=kGe(r)?function(e){r(e,d)}:null;d0e(d,{shape:{width:l,height:c,x:o,y:s}},a,null,n,m)}return d}function drt(e,t,a){var n=e.getArea(),r=PXe(n.r0,1),i=PXe(n.r,1),o=new EQe({shape:{cx:PXe(e.cx,1),cy:PXe(e.cy,1),r0:r,r:i,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});t&&("angle"===e.getBaseAxis().dim?o.shape.endAngle=n.startAngle:o.shape.r=r,d0e(o,{shape:{endAngle:n.endAngle,r:i}},a));return o}function hrt(e,t,a,n,r){return e?"polar"===e.type?drt(e,t,a):"cartesian2d"===e.type?urt(e,t,a,n,r):null:null}function prt(e,t){return e.type===t}function frt(e,t){if(e.length===t.length){for(var a=0;a<e.length;a++)if(e[a]!==t[a])return;return!0}}function mrt(e){for(var t=1/0,a=1/0,n=-1/0,r=-1/0,i=0;i<e.length;){var o=e[i++],s=e[i++];isNaN(o)||(t=Math.min(o,t),n=Math.max(o,n)),isNaN(s)||(a=Math.min(s,a),r=Math.max(s,r))}return[[t,a],[n,r]]}function vrt(e,t){var a=mrt(e),n=a[0],r=a[1],i=mrt(t),o=i[0],s=i[1];return Math.max(Math.abs(n[0]-o[0]),Math.abs(n[1]-o[1]),Math.abs(r[0]-s[0]),Math.abs(r[1]-s[1]))}function grt(e){return EGe(e)?e:e?.5:0}function yrt(e,t,a,n,r){var i=a.getBaseAxis(),o="x"===i.dim||"radius"===i.dim?0:1,s=[],l=0,c=[],u=[],d=[],h=[];if(r){for(l=0;l<e.length;l+=2){var p=t||e;isNaN(p[l])||isNaN(p[l+1])||h.push(e[l],e[l+1])}e=h}for(l=0;l<e.length-2;l+=2)switch(d[0]=e[l+2],d[1]=e[l+3],u[0]=e[l],u[1]=e[l+1],s.push(u[0],u[1]),n){case"end":c[o]=d[o],c[1-o]=u[1-o],s.push(c[0],c[1]);break;case"middle":var f=(u[o]+d[o])/2,m=[];c[o]=m[o]=f,c[1-o]=u[1-o],m[1-o]=d[1-o],s.push(c[0],c[1]),s.push(m[0],m[1]);break;default:c[o]=u[o],c[1-o]=d[1-o],s.push(c[0],c[1])}return s.push(e[l++],e[l++]),s}function brt(e,t){var a,n,r=[],i=e.length;function o(e,t,a){var n=e.coord;return{coord:a,color:function(e,t,a){if(t&&t.length&&e>=0&&e<=1){var n=e*(t.length-1),r=Math.floor(n),i=Math.ceil(n),o=EYe(t[r]),s=EYe(t[i]),l=n-r,c=NYe([yYe(SYe(o[0],s[0],l)),yYe(SYe(o[1],s[1],l)),yYe(SYe(o[2],s[2],l)),bYe(SYe(o[3],s[3],l))],"rgba");return a?{color:c,leftIndex:r,rightIndex:i,value:n}:c}}((a-n)/(t.coord-n),[e.color,t.color])}}for(var s=0;s<i;s++){var l=e[s],c=l.coord;if(c<0)a=l;else{if(c>t){n?r.push(o(n,l,t)):a&&r.push(o(a,l,0),o(a,l,t));break}a&&(r.push(o(a,l,0)),a=null),r.push(l),n=l}}return r}function xrt(e,t,a){var n=e.get("showAllSymbol"),r="auto"===n;if(!n||r){var i=a.getAxesByScale("ordinal")[0];if(i&&(!r||!function(e,t){var a=e.getExtent(),n=Math.abs(a[1]-a[0])/e.scale.count();isNaN(n)&&(n=0);for(var r=t.count(),i=Math.max(1,Math.round(r/5)),o=0;o<r;o+=i)if(1.5*Xnt.getSymbolSize(t,o)[e.isHorizontal()?1:0]>n)return!1;return!0}(i,t))){var o=t.mapDimension(i.dim),s={};return gGe(i.getViewLabels(),function(e){var t=i.scale.getRawOrdinalNumber(e.tickValue);s[t]=1}),function(e){return!s.hasOwnProperty(t.get(o,e))}}}}function wrt(e,t){return isNaN(e)||isNaN(t)}function _rt(e,t){return[e[2*t],e[2*t+1]]}function Srt(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<JZe.length;t++)if(e.get([JZe[t],"endLabel","show"]))return!0;return!1}function Mrt(e,t,a,n){if(prt(t,"cartesian2d")){var r=n.getModel("endLabel"),i=r.get("valueAnimation"),o=n.getData(),s={lastFrameIndex:0},l=Srt(n)?function(a,n){e._endLabelOnDuring(a,n,o,s,i,r,t)}:null,c=t.getBaseAxis().isHorizontal(),u=urt(t,a,n,function(){var t=e._endLabel;t&&a&&null!=s.originalX&&t.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var d=u.shape,h=Math.max(d.width,d.height);c?(d.y-=h,d.height+=2*h):(d.x-=h,d.width+=2*h)}return l&&l(1,u),u}return drt(t,a,n)}var Trt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.init=function(){var e=new xXe,t=new Qnt;this.group.add(t.group),this._symbolDraw=t,this._lineGroup=e,this._changePolyState=SGe(this._changePolyState,this)},t.prototype.render=function(e,t,a){var n=e.coordinateSystem,r=this.group,i=e.getData(),o=e.getModel("lineStyle"),s=e.getModel("areaStyle"),l=i.getLayout("points")||[],c="polar"===n.type,u=this._coordSys,d=this._symbolDraw,h=this._polyline,p=this._polygon,f=this._lineGroup,m=!t.ssr&&e.get("animation"),v=!s.isEmpty(),g=s.get("origin"),y=ert(n,i,g),b=v&&function(e,t,a){if(!a.valueDim)return[];for(var n=t.count(),r=iet(2*n),i=0;i<n;i++){var o=trt(a,e,t,i);r[2*i]=o[0],r[2*i+1]=o[1]}return r}(n,i,y),x=e.get("showSymbol"),w=e.get("connectNulls"),_=x&&!c&&xrt(e,i,n),S=this._data;S&&S.eachItemGraphicEl(function(e,t){e.__temp&&(r.remove(e),S.setItemGraphicEl(t,null))}),x||d.remove(),r.add(f);var M,T=!c&&e.get("step");n&&n.getArea&&e.get("clip",!0)&&(null!=(M=n.getArea()).width?(M.x-=.1,M.y-=.1,M.width+=.2,M.height+=.2):M.r0&&(M.r0-=.5,M.r+=.5)),this._clipShapeForSymbol=M;var k=function(e,t,a){var n=e.getVisual("visualMeta");if(n&&n.length&&e.count()&&"cartesian2d"===t.type){for(var r,i,o=n.length-1;o>=0;o--){var s=e.getDimensionInfo(n[o].dimension);if("x"===(r=s&&s.coordDim)||"y"===r){i=n[o];break}}if(i){var l=t.getAxis(r),c=yGe(i.stops,function(e){return{coord:l.toGlobalCoord(l.dataToCoord(e.value)),color:e.color}}),u=c.length,d=i.outerColors.slice();u&&c[0].coord>c[u-1].coord&&(c.reverse(),d.reverse());var h=brt(c,"x"===r?a.getWidth():a.getHeight()),p=h.length;if(!p&&u)return c[0].coord<0?d[1]?d[1]:c[u-1].color:d[0]?d[0]:c[0].color;var f=h[0].coord-10,m=h[p-1].coord+10,v=m-f;if(v<.001)return"transparent";gGe(h,function(e){e.offset=(e.coord-f)/v}),h.push({offset:p?h[p-1].offset:.5,color:d[1]||"transparent"}),h.unshift({offset:p?h[0].offset:.5,color:d[0]||"transparent"});var g=new XQe(0,0,0,0,h,!0);return g[r]=f,g[r+"2"]=m,g}}}(i,n,a)||i.getVisual("style")[i.getVisual("drawType")];if(h&&u.type===n.type&&T===this._step){v&&!p?p=this._newPolygon(l,b):p&&!v&&(f.remove(p),p=this._polygon=null),c||this._initOrUpdateEndLabel(e,n,A2e(k));var C=f.getClipPath();if(C)d0e(C,{shape:Mrt(this,n,!1,e).shape},e);else f.setClipPath(Mrt(this,n,!0,e));x&&d.updateData(i,{isIgnore:_,clipShape:M,disableAnimation:!0,getSymbolPoint:function(e){return[l[2*e],l[2*e+1]]}}),frt(this._stackedOnPoints,b)&&frt(this._points,l)||(m?this._doUpdateAnimation(i,b,n,a,T,g,w):(T&&(b&&(b=yrt(b,l,n,T,w)),l=yrt(l,null,n,T,w)),h.setShape({points:l}),p&&p.setShape({points:l,stackedOnPoints:b})))}else x&&d.updateData(i,{isIgnore:_,clipShape:M,disableAnimation:!0,getSymbolPoint:function(e){return[l[2*e],l[2*e+1]]}}),m&&this._initSymbolLabelAnimation(i,n,M),T&&(b&&(b=yrt(b,l,n,T,w)),l=yrt(l,null,n,T,w)),h=this._newPolyline(l),v?p=this._newPolygon(l,b):p&&(f.remove(p),p=this._polygon=null),c||this._initOrUpdateEndLabel(e,n,A2e(k)),f.setClipPath(Mrt(this,n,!0,e));var A=e.getModel("emphasis"),E=A.get("focus"),I=A.get("blurScope"),R=A.get("disabled");(h.useStyle(pGe(o.getLineStyle(),{fill:"none",stroke:k,lineJoin:"bevel"})),zJe(h,e,"lineStyle"),h.style.lineWidth>0&&"bolder"===e.get(["emphasis","lineStyle","width"]))&&(h.getState("emphasis").style.lineWidth=+h.style.lineWidth+1);YZe(h).seriesIndex=e.seriesIndex,OJe(h,E,I,R);var D=grt(e.get("smooth")),P=e.get("smoothMonotone");if(h.setShape({smooth:D,smoothMonotone:P,connectNulls:w}),p){var L=i.getCalculationInfo("stackedOnSeries"),N=0;p.useStyle(pGe(s.getAreaStyle(),{fill:k,opacity:.7,lineJoin:"bevel",decal:i.getVisual("style").decal})),L&&(N=grt(L.get("smooth"))),p.setShape({smooth:D,stackedOnSmooth:N,smoothMonotone:P,connectNulls:w}),zJe(p,e,"areaStyle"),YZe(p).seriesIndex=e.seriesIndex,OJe(p,E,I,R)}var O=this._changePolyState;i.eachItemGraphicEl(function(e){e&&(e.onHoverStateChange=O)}),this._polyline.onHoverStateChange=O,this._data=i,this._coordSys=n,this._stackedOnPoints=b,this._points=l,this._step=T,this._valueOrigin=g,e.get("triggerLineEvent")&&(this.packEventData(e,h),p&&this.packEventData(e,p))},t.prototype.packEventData=function(e,t){YZe(t).eventData={componentType:"series",componentSubType:"line",componentIndex:e.componentIndex,seriesIndex:e.seriesIndex,seriesName:e.name,seriesType:"line"}},t.prototype.highlight=function(e,t,a,n){var r=e.getData(),i=m$e(r,n);if(this._changePolyState("emphasis"),!(i instanceof Array)&&null!=i&&i>=0){var o=r.getLayout("points"),s=r.getItemGraphicEl(i);if(!s){var l=o[2*i],c=o[2*i+1];if(isNaN(l)||isNaN(c))return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(l,c))return;var u=e.get("zlevel")||0,d=e.get("z")||0;(s=new Xnt(r,i)).x=l,s.y=c,s.setZ(u,d);var h=s.getSymbolPath().getTextContent();h&&(h.zlevel=u,h.z=d,h.z2=this._polyline.z2+1),s.__temp=!0,r.setItemGraphicEl(i,s),s.stopSymbolAnimation(!0),this.group.add(s)}s.highlight()}else s6e.prototype.highlight.call(this,e,t,a,n)},t.prototype.downplay=function(e,t,a,n){var r=e.getData(),i=m$e(r,n);if(this._changePolyState("normal"),null!=i&&i>=0){var o=r.getItemGraphicEl(i);o&&(o.__temp?(r.setItemGraphicEl(i,null),this.group.remove(o)):o.downplay())}else s6e.prototype.downplay.call(this,e,t,a,n)},t.prototype._changePolyState=function(e){var t=this._polygon;gJe(this._polyline,e),t&&gJe(t,e)},t.prototype._newPolyline=function(e){var t=this._polyline;return t&&this._lineGroup.remove(t),t=new srt({shape:{points:e},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(t),this._polyline=t,t},t.prototype._newPolygon=function(e,t){var a=this._polygon;return a&&this._lineGroup.remove(a),a=new crt({shape:{points:e,stackedOnPoints:t},segmentIgnoreThreshold:2}),this._lineGroup.add(a),this._polygon=a,a},t.prototype._initSymbolLabelAnimation=function(e,t,a){var n,r,i=t.getBaseAxis(),o=i.inverse;"cartesian2d"===t.type?(n=i.isHorizontal(),r=!1):"polar"===t.type&&(n="angle"===i.dim,r=!0);var s=e.hostModel,l=s.get("animationDuration");kGe(l)&&(l=l(null));var c=s.get("animationDelay")||0,u=kGe(c)?c(null):c;e.eachItemGraphicEl(function(e,i){var s=e;if(s){var d=[e.x,e.y],h=void 0,p=void 0,f=void 0;if(a)if(r){var m=a,v=t.pointToCoord(d);n?(h=m.startAngle,p=m.endAngle,f=-v[1]/180*Math.PI):(h=m.r0,p=m.r,f=v[0])}else{var g=a;n?(h=g.x,p=g.x+g.width,f=e.x):(h=g.y+g.height,p=g.y,f=e.y)}var y=p===h?0:(f-h)/(p-h);o&&(y=1-y);var b=kGe(c)?c(i):l*y+u,x=s.getSymbolPath(),w=x.getTextContent();s.attr({scaleX:0,scaleY:0}),s.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:b}),w&&w.animateFrom({style:{opacity:0}},{duration:300,delay:b}),x.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(e,t,a){var n=e.getModel("endLabel");if(Srt(e)){var r=e.getData(),i=this._polyline,o=r.getLayout("points");if(!o)return i.removeTextContent(),void(this._endLabel=null);var s=this._endLabel;s||((s=this._endLabel=new PZe({z2:200})).ignoreClip=!0,i.setTextContent(this._endLabel),i.disableLabelAnimation=!0);var l=function(e){for(var t=e.length/2;t>0&&wrt(e[2*t-2],e[2*t-1]);t--);return t-1}(o);l>=0&&(r1e(i,i1e(e,"endLabel"),{inheritColor:a,labelFetcher:e,labelDataIndex:l,defaultText:function(e,t,a){return null!=a?jnt(r,a):Ynt(r,e)},enableTextSetter:!0},function(e,t){var a=t.getBaseAxis(),n=a.isHorizontal(),r=a.inverse,i=n?r?"right":"left":"center",o=n?"middle":r?"top":"bottom";return{normal:{align:e.get("align")||i,verticalAlign:e.get("verticalAlign")||o}}}(n,t)),i.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(e,t,a,n,r,i,o){var s=this._endLabel,l=this._polyline;if(s){e<1&&null==n.originalX&&(n.originalX=s.x,n.originalY=s.y);var c=a.getLayout("points"),u=a.hostModel,d=u.get("connectNulls"),h=i.get("precision"),p=i.get("distance")||0,f=o.getBaseAxis(),m=f.isHorizontal(),v=f.inverse,g=t.shape,y=v?m?g.x:g.y+g.height:m?g.x+g.width:g.y,b=(m?p:0)*(v?-1:1),x=(m?0:-p)*(v?-1:1),w=m?"x":"y",_=function(e,t,a){for(var n,r,i=e.length/2,o="x"===a?0:1,s=0,l=-1,c=0;c<i;c++)if(r=e[2*c+o],!isNaN(r)&&!isNaN(e[2*c+1-o]))if(0!==c){if(n<=t&&r>=t||n>=t&&r<=t){l=c;break}s=c,n=r}else n=r;return{range:[s,l],t:(t-n)/(r-n)}}(c,y,w),S=_.range,M=S[1]-S[0],T=void 0;if(M>=1){if(M>1&&!d){var k=_rt(c,S[0]);s.attr({x:k[0]+b,y:k[1]+x}),r&&(T=u.getRawValue(S[0]))}else{(k=l.getPointOn(y,w))&&s.attr({x:k[0]+b,y:k[1]+x});var C=u.getRawValue(S[0]),A=u.getRawValue(S[1]);r&&(T=T$e(a,h,C,A,_.t))}n.lastFrameIndex=S[0]}else{var E=1===e||n.lastFrameIndex>0?S[0]:0;k=_rt(c,E);r&&(T=u.getRawValue(E)),s.attr({x:k[0]+b,y:k[1]+x})}if(r){var I=p1e(s);"function"==typeof I.setLabelText&&I.setLabelText(T)}}},t.prototype._doUpdateAnimation=function(e,t,a,n,r,i,o){var s=this._polyline,l=this._polygon,c=e.hostModel,u=function(e,t,a,n,r,i,o){for(var s=function(e,t){var a=[];return t.diff(e).add(function(e){a.push({cmd:"+",idx:e})}).update(function(e,t){a.push({cmd:"=",idx:t,idx1:e})}).remove(function(e){a.push({cmd:"-",idx:e})}).execute(),a}(e,t),l=[],c=[],u=[],d=[],h=[],p=[],f=[],m=ert(r,t,o),v=e.getLayout("points")||[],g=t.getLayout("points")||[],y=0;y<s.length;y++){var b=s[y],x=!0,w=void 0,_=void 0;switch(b.cmd){case"=":w=2*b.idx,_=2*b.idx1;var S=v[w],M=v[w+1],T=g[_],k=g[_+1];(isNaN(S)||isNaN(M))&&(S=T,M=k),l.push(S,M),c.push(T,k),u.push(a[w],a[w+1]),d.push(n[_],n[_+1]),f.push(t.getRawIndex(b.idx1));break;case"+":var C=b.idx,A=m.dataDimsForPoint,E=r.dataToPoint([t.get(A[0],C),t.get(A[1],C)]);_=2*C,l.push(E[0],E[1]),c.push(g[_],g[_+1]);var I=trt(m,r,t,C);u.push(I[0],I[1]),d.push(n[_],n[_+1]),f.push(t.getRawIndex(C));break;case"-":x=!1}x&&(h.push(b),p.push(p.length))}p.sort(function(e,t){return f[e]-f[t]});var R=l.length,D=iet(R),P=iet(R),L=iet(R),N=iet(R),O=[];for(y=0;y<p.length;y++){var F=p[y],B=2*y,U=2*F;D[B]=l[U],D[B+1]=l[U+1],P[B]=c[U],P[B+1]=c[U+1],L[B]=u[U],L[B+1]=u[U+1],N[B]=d[U],N[B+1]=d[U+1],O[y]=h[F]}return{current:D,next:P,stackedOnCurrent:L,stackedOnNext:N,status:O}}(this._data,e,this._stackedOnPoints,t,this._coordSys,0,this._valueOrigin),d=u.current,h=u.stackedOnCurrent,p=u.next,f=u.stackedOnNext;if(r&&(h=yrt(u.stackedOnCurrent,u.current,a,r,o),d=yrt(u.current,null,a,r,o),f=yrt(u.stackedOnNext,u.next,a,r,o),p=yrt(u.next,null,a,r,o)),vrt(d,p)>3e3||l&&vrt(h,f)>3e3)return s.stopAnimation(),s.setShape({points:p}),void(l&&(l.stopAnimation(),l.setShape({points:p,stackedOnPoints:f})));s.shape.__points=u.current,s.shape.points=d;var m={shape:{points:p}};u.current!==d&&(m.shape.__points=u.next),s.stopAnimation(),u0e(s,m,c),l&&(l.setShape({points:d,stackedOnPoints:h}),l.stopAnimation(),u0e(l,{shape:{stackedOnPoints:f}},c),s.shape.points!==l.shape.points&&(l.shape.points=s.shape.points));for(var v=[],g=u.status,y=0;y<g.length;y++){if("="===g[y].cmd){var b=e.getItemGraphicEl(g[y].idx1);b&&v.push({el:b,ptIdx:y})}}s.animators&&s.animators.length&&s.animators[0].during(function(){l&&l.dirtyShape();for(var e=s.shape.__points,t=0;t<v.length;t++){var a=v[t].el,n=2*v[t].ptIdx;a.x=e[n],a.y=e[n+1],a.markRedraw()}})},t.prototype.remove=function(e){var t=this.group,a=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),a&&a.eachItemGraphicEl(function(e,n){e.__temp&&(t.remove(e),a.setItemGraphicEl(n,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(s6e);function krt(e,t){return{seriesType:e,plan:r6e(),reset:function(e){var a=e.getData(),n=e.coordinateSystem,r=e.pipelineContext,i=t||r.large;if(n){var o=yGe(n.dimensions,function(e){return a.mapDimension(e)}).slice(0,2),s=o.length,l=a.getCalculationInfo("stackResultDimension");F9e(a,o[0])&&(o[0]=l),F9e(a,o[1])&&(o[1]=l);var c=a.getStore(),u=a.getDimensionIndex(o[0]),d=a.getDimensionIndex(o[1]);return s&&{progress:function(e,t){for(var a=e.end-e.start,r=i&&iet(a*s),o=[],l=[],h=e.start,p=0;h<e.end;h++){var f=void 0;if(1===s){var m=c.get(u,h);f=n.dataToPoint(m,null,l)}else o[0]=c.get(u,h),o[1]=c.get(d,h),f=n.dataToPoint(o,null,l);i?(r[p++]=f[0],r[p++]=f[1]):t.setItemLayout(h,f.slice())}i&&t.setLayout("points",r)}}}}}}var Crt={average:function(e){for(var t=0,a=0,n=0;n<e.length;n++)isNaN(e[n])||(t+=e[n],a++);return 0===a?NaN:t/a},sum:function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a]||0;return t},max:function(e){for(var t=-1/0,a=0;a<e.length;a++)e[a]>t&&(t=e[a]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,a=0;a<e.length;a++)e[a]<t&&(t=e[a]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},Art=function(e){return Math.round(e.length/2)};function Ert(e){return{seriesType:e,reset:function(e,t,a){var n=e.getData(),r=e.get("sampling"),i=e.coordinateSystem,o=n.count();if(o>10&&"cartesian2d"===i.type&&r){var s=i.getBaseAxis(),l=i.getOtherAxis(s),c=s.getExtent(),u=a.getDevicePixelRatio(),d=Math.abs(c[1]-c[0])*(u||1),h=Math.round(o/d);if(isFinite(h)&&h>1){"lttb"===r?e.setData(n.lttbDownSample(n.mapDimension(l.dim),1/h)):"minmax"===r&&e.setData(n.minmaxDownSample(n.mapDimension(l.dim),1/h));var p=void 0;CGe(r)?p=Crt[r]:kGe(r)&&(p=r),p&&e.setData(n.downSample(n.mapDimension(l.dim),1/h,p,Art))}}}}}function Irt(e){e.registerChartView(Trt),e.registerSeriesModel(qnt),e.registerLayout(krt("line",!0)),e.registerVisual({seriesType:"line",reset:function(e){var t=e.getData(),a=e.getModel("lineStyle").getLineStyle();a&&!a.stroke&&(a.stroke=t.getVisual("style").fill),t.setVisual("legendLineStyle",a)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Ert("line"))}var Rrt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){return U9e(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(e,t,a){var n=this.coordinateSystem;if(n&&n.clampData){var r=n.clampData(e),i=n.dataToPoint(r);if(a)gGe(n.getAxes(),function(e,a){if("category"===e.type&&null!=t){var n=e.getTicksCoords(),o=e.getTickModel().get("alignWithLabel"),s=r[a],l="x1"===t[a]||"y1"===t[a];if(l&&!o&&(s+=1),n.length<2)return;if(2===n.length)return void(i[a]=e.toGlobalCoord(e.getExtent()[l?1:0]));for(var c=void 0,u=void 0,d=1,h=0;h<n.length;h++){var p=n[h].coord,f=h===n.length-1?n[h-1].tickValue+d:n[h].tickValue;if(f===s){u=p;break}if(f<s)c=p;else if(null!=c&&f>s){u=(p+c)/2;break}1===h&&(d=f-n[0].tickValue)}null==u&&(c?c&&(u=n[n.length-1].coord):u=n[0].coord),i[a]=e.toGlobalCoord(u)}});else{var o=this.getData(),s=o.getLayout("offset"),l=o.getLayout("size"),c=n.getBaseAxis().isHorizontal()?0:1;i[c]+=s+l/2}return i}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod",defaultBarGap:"10%"},t}($3e);$3e.registerClass(Rrt);var Drt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.getInitialData=function(){return U9e(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},t.prototype.getProgressiveThreshold=function(){var e=this.get("progressiveThreshold"),t=this.get("largeThreshold");return t>e&&(e=t),e},t.prototype.brushSelector=function(e,t,a){return a.rect(t.getItemLayout(e))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=D1e(Rrt.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:o5e.color.primary,borderWidth:2}},realtimeSort:!1}),t}(Rrt),Prt=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},Lrt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="sausage",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Prt},t.prototype.buildPath=function(e,t){var a=t.cx,n=t.cy,r=Math.max(t.r0||0,0),i=Math.max(t.r,0),o=.5*(i-r),s=r+o,l=t.startAngle,c=t.endAngle,u=t.clockwise,d=2*Math.PI,h=u?c-l<d:l-c<d;h||(l=c-(u?d:-d));var p=Math.cos(l),f=Math.sin(l),m=Math.cos(c),v=Math.sin(c);h?(e.moveTo(p*r+a,f*r+n),e.arc(p*s+a,f*s+n,o,-Math.PI+l,l,!u)):e.moveTo(p*i+a,f*i+n),e.arc(a,n,i,l,c,!u),e.arc(m*s+a,v*s+n,o,c-2*Math.PI,c-Math.PI,!u),0!==r&&e.arc(a,n,r,c,l,u)},t}(gZe);function Nrt(e,t,a){return t*Math.sin(e)*(a?-1:1)}function Ort(e,t,a){return t*Math.cos(e)*(a?1:-1)}function Frt(e,t,a){var n=e.get("borderRadius");if(null==n)return a?{cornerRadius:0}:null;TGe(n)||(n=[n,n,n,n]);var r=Math.abs(t.r||0-t.r0||0);return{cornerRadius:yGe(n,function(e){return sXe(e,r)})}}var Brt=Math.max,Urt=Math.min;var zrt=function(e){function t(){var a=e.call(this)||this;return a.type=t.type,a._isFirstFrame=!0,a}return zHe(t,e),t.prototype.render=function(e,t,a,n){this._model=e,this._removeOnRenderedListener(a),this._updateDrawMode(e);var r=e.get("coordinateSystem");"cartesian2d"!==r&&"polar"!==r||(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(e,t,a):this._renderNormal(e,t,a,n))},t.prototype.incrementalPrepareRender=function(e){this._clear(),this._updateDrawMode(e),this._updateLargeClip(e)},t.prototype.incrementalRender=function(e,t){this._progressiveEls=[],this._incrementalRenderLarge(e,t)},t.prototype.eachRendered=function(e){q0e(this._progressiveEls||this.group,e)},t.prototype._updateDrawMode=function(e){var t=e.pipelineContext.large;null!=this._isLargeDraw&&t===this._isLargeDraw||(this._isLargeDraw=t,this._clear())},t.prototype._renderNormal=function(e,t,a,n){var r,i=this.group,o=e.getData(),s=this._data,l=e.coordinateSystem,c=l.getBaseAxis();"cartesian2d"===l.type?r=c.isHorizontal():"polar"===l.type&&(r="angle"===c.dim);var u=e.isAnimationEnabled()?e:null,d=function(e,t){var a=e.get("realtimeSort",!0),n=t.getBaseAxis();if(a&&"category"===n.type&&"cartesian2d"===t.type)return{baseAxis:n,otherAxis:t.getOtherAxis(n)}}(e,l);d&&this._enableRealtimeSort(d,o,a);var h=e.get("clip",!0)||d,p=function(e,t){var a=e.getArea&&e.getArea();if(prt(e,"cartesian2d")){var n=e.getBaseAxis();if("category"!==n.type||!n.onBand){var r=t.getLayout("bandWidth");n.isHorizontal()?(a.x-=r,a.width+=2*r):(a.y-=r,a.height+=2*r)}}return a}(l,o);i.removeClipPath();var f=e.get("roundCap",!0),m=e.get("showBackground",!0),v=e.getModel("backgroundStyle"),g=v.get("borderRadius")||0,y=[],b=this._backgroundEls,x=n&&n.isInitSort,w=n&&"changeAxisOrder"===n.type;function _(e){var t=Xrt[l.type](o,e);if(!t)return null;var a=function(e,t,a){var n="polar"===e.type?EQe:EZe;return new n({shape:tit(t,a,e),silent:!0,z2:0})}(l,r,t);return a.useStyle(v.getItemStyle()),"cartesian2d"===l.type?a.setShape("r",g):a.setShape("cornerRadius",g),y[e]=a,a}o.diff(s).add(function(t){var a=o.getItemModel(t),n=Xrt[l.type](o,t,a);if(n&&(m&&_(t),o.hasValue(t)&&jrt[l.type](n))){var s=!1;h&&(s=Vrt[l.type](p,n));var v=Hrt[l.type](e,o,t,n,r,u,c.model,!1,f);d&&(v.forceLabelAnimation=!0),Krt(v,o,t,a,n,e,r,"polar"===l.type),x?v.attr({shape:n}):d?Grt(d,u,v,n,t,r,!1,!1):d0e(v,{shape:n},e,t),o.setItemGraphicEl(t,v),i.add(v),v.ignore=s}}).update(function(t,a){var n=o.getItemModel(t),S=Xrt[l.type](o,t,n);if(S){if(m){var M=void 0;0===b.length?M=_(a):((M=b[a]).useStyle(v.getItemStyle()),"cartesian2d"===l.type?M.setShape("r",g):M.setShape("cornerRadius",g),y[t]=M);var T=Xrt[l.type](o,t);u0e(M,{shape:tit(r,T,l)},u,t)}var k=s.getItemGraphicEl(a);if(o.hasValue(t)&&jrt[l.type](S)){var C=!1;if(h&&(C=Vrt[l.type](p,S))&&i.remove(k),k&&("sector"===k.type&&f||"sausage"===k.type&&!f)&&(k&&m0e(k,e,a),k=null),k?v0e(k):k=Hrt[l.type](e,o,t,S,r,u,c.model,!0,f),d&&(k.forceLabelAnimation=!0),w){var A=k.getTextContent();if(A){var E=p1e(A);null!=E.prevValue&&(E.prevValue=E.value)}}else Krt(k,o,t,n,S,e,r,"polar"===l.type);x?k.attr({shape:S}):d?Grt(d,u,k,S,t,r,!0,w):u0e(k,{shape:S},e,t,null),o.setItemGraphicEl(t,k),k.ignore=C,i.add(k)}else i.remove(k)}}).remove(function(t){var a=s.getItemGraphicEl(t);a&&m0e(a,e,t)}).execute();var S=this._backgroundGroup||(this._backgroundGroup=new xXe);S.removeAll();for(var M=0;M<y.length;++M)S.add(y[M]);i.add(S),this._backgroundEls=y,this._data=o},t.prototype._renderLarge=function(e,t,a){this._clear(),Qrt(e,this.group),this._updateLargeClip(e)},t.prototype._incrementalRenderLarge=function(e,t){this._removeBackground(),Qrt(t,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(e){var t=e.get("clip",!0)&&hrt(e.coordinateSystem,!1,e),a=this.group;t?a.setClipPath(t):a.removeClipPath()},t.prototype._enableRealtimeSort=function(e,t,a){var n=this;if(t.count()){var r=e.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(t,e,a),this._isFirstFrame=!1;else{var i=function(e){var a=t.getItemGraphicEl(e),n=a&&a.shape;return n&&Math.abs(r.isHorizontal()?n.height:n.width)||0};this._onRendered=function(){n._updateSortWithinSameData(t,i,r,a)},a.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(e,t,a){var n=[];return e.each(e.mapDimension(t.dim),function(e,t){var r=a(t);r=null==r?NaN:r,n.push({dataIndex:t,mappedValue:r,ordinalNumber:e})}),n.sort(function(e,t){return t.mappedValue-e.mappedValue}),{ordinalNumbers:yGe(n,function(e){return e.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(e,t,a){for(var n=a.scale,r=e.mapDimension(a.dim),i=Number.MAX_VALUE,o=0,s=n.getOrdinalMeta().categories.length;o<s;++o){var l=e.rawIndexOf(r,n.getRawOrdinalNumber(o)),c=l<0?Number.MIN_VALUE:t(e.indexOfRawIndex(l));if(c>i)return!0;i=c}return!1},t.prototype._isOrderDifferentInView=function(e,t){for(var a=t.scale,n=a.getExtent(),r=Math.max(0,n[0]),i=Math.min(n[1],a.getOrdinalMeta().categories.length-1);r<=i;++r)if(e.ordinalNumbers[r]!==a.getRawOrdinalNumber(r))return!0},t.prototype._updateSortWithinSameData=function(e,t,a,n){if(this._isOrderChangedWithinSameData(e,t,a)){var r=this._dataSort(e,a,t);this._isOrderDifferentInView(r,a)&&(this._removeOnRenderedListener(n),n.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",axisId:a.index,sortInfo:r}))}},t.prototype._dispatchInitSort=function(e,t,a){var n=t.baseAxis,r=this._dataSort(e,n,function(a){return e.get(e.mapDimension(t.otherAxis.dim),a)});a.dispatchAction({type:"changeAxisOrder",componentType:n.dim+"Axis",isInitSort:!0,axisId:n.index,sortInfo:r})},t.prototype.remove=function(e,t){this._clear(this._model),this._removeOnRenderedListener(t)},t.prototype.dispose=function(e,t){this._removeOnRenderedListener(t)},t.prototype._removeOnRenderedListener=function(e){this._onRendered&&(e.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(e){var t=this.group,a=this._data;e&&e.isAnimationEnabled()&&a&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],a.eachItemGraphicEl(function(t){m0e(t,e,YZe(t).dataIndex)})):t.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(s6e),Vrt={cartesian2d:function(e,t){var a=t.width<0?-1:1,n=t.height<0?-1:1;a<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height);var r=e.x+e.width,i=e.y+e.height,o=Brt(t.x,e.x),s=Urt(t.x+t.width,r),l=Brt(t.y,e.y),c=Urt(t.y+t.height,i),u=s<o,d=c<l;return t.x=u&&o>r?s:o,t.y=d&&l>i?c:l,t.width=u?0:s-o,t.height=d?0:c-l,a<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height),u||d},polar:function(e,t){var a=t.r0<=t.r?1:-1;if(a<0){var n=t.r;t.r=t.r0,t.r0=n}var r=Urt(t.r,e.r),i=Brt(t.r0,e.r0);t.r=r,t.r0=i;var o=r-i<0;if(a<0){n=t.r;t.r=t.r0,t.r0=n}return o}},Hrt={cartesian2d:function(e,t,a,n,r,i,o,s,l){var c=new EZe({shape:hGe({},n),z2:1});(c.__dataIndex=a,c.name="item",i)&&(c.shape[r?"height":"width"]=0);return c},polar:function(e,t,a,n,r,i,o,s,l){var c=!r&&l?Lrt:EQe,u=new c({shape:n,z2:1});u.name="item";var d,h,p=$rt(r);if(u.calculateTextPosition=(d=p,h=({isRoundCap:c===Lrt}||{}).isRoundCap,function(e,t,a){var n=t.position;if(!n||n instanceof Array)return lXe(e,t,a);var r=d(n),i=null!=t.distance?t.distance:5,o=this.shape,s=o.cx,l=o.cy,c=o.r,u=o.r0,p=(c+u)/2,f=o.startAngle,m=o.endAngle,v=(f+m)/2,g=h?Math.abs(c-u)/2:0,y=Math.cos,b=Math.sin,x=s+c*y(f),w=l+c*b(f),_="left",S="top";switch(r){case"startArc":x=s+(u-i)*y(v),w=l+(u-i)*b(v),_="center",S="top";break;case"insideStartArc":x=s+(u+i)*y(v),w=l+(u+i)*b(v),_="center",S="bottom";break;case"startAngle":x=s+p*y(f)+Nrt(f,i+g,!1),w=l+p*b(f)+Ort(f,i+g,!1),_="right",S="middle";break;case"insideStartAngle":x=s+p*y(f)+Nrt(f,-i+g,!1),w=l+p*b(f)+Ort(f,-i+g,!1),_="left",S="middle";break;case"middle":x=s+p*y(v),w=l+p*b(v),_="center",S="middle";break;case"endArc":x=s+(c+i)*y(v),w=l+(c+i)*b(v),_="center",S="bottom";break;case"insideEndArc":x=s+(c-i)*y(v),w=l+(c-i)*b(v),_="center",S="top";break;case"endAngle":x=s+p*y(m)+Nrt(m,i+g,!0),w=l+p*b(m)+Ort(m,i+g,!0),_="left",S="middle";break;case"insideEndAngle":x=s+p*y(m)+Nrt(m,-i+g,!0),w=l+p*b(m)+Ort(m,-i+g,!0),_="right",S="middle";break;default:return lXe(e,t,a)}return(e=e||{}).x=x,e.y=w,e.align=_,e.verticalAlign=S,e}),i){var f=r?"r":"endAngle",m={};u.shape[f]=r?n.r0:n.startAngle,m[f]=n[f],(s?u0e:d0e)(u,{shape:m},i)}return u}};function Grt(e,t,a,n,r,i,o,s){var l,c;i?(c={x:n.x,width:n.width},l={y:n.y,height:n.height}):(c={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(o?u0e:d0e)(a,{shape:l},t,r,null),(o?u0e:d0e)(a,{shape:c},t?e.baseAxis.model:null,r)}function Wrt(e,t){for(var a=0;a<t.length;a++)if(!isFinite(e[t[a]]))return!0;return!1}var qrt=["x","y","width","height"],Yrt=["cx","cy","r","startAngle","endAngle"],jrt={cartesian2d:function(e){return!Wrt(e,qrt)},polar:function(e){return!Wrt(e,Yrt)}},Xrt={cartesian2d:function(e,t,a){var n=e.getItemLayout(t);if(!n)return null;var r=a?function(e,t){var a=e.get(["itemStyle","borderColor"]);if(!a||"none"===a)return 0;var n=e.get(["itemStyle","borderWidth"])||0,r=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),i=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,r,i)}(a,n):0,i=n.width>0?1:-1,o=n.height>0?1:-1;return{x:n.x+i*r/2,y:n.y+o*r/2,width:n.width-i*r,height:n.height-o*r}},polar:function(e,t,a){var n=e.getItemLayout(t);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function $rt(e){return function(e){var t=e?"Arc":"Angle";return function(e){switch(e){case"start":case"insideStart":case"end":case"insideEnd":return e+t;default:return e}}}(e)}function Krt(e,t,a,n,r,i,o,s){var l=t.getItemVisual(a,"style");if(s){if(!i.get("roundCap")){var c=e.shape;hGe(c,Frt(n.getModel("itemStyle"),c,!0)),e.setShape(c)}}else{var u=n.get(["itemStyle","borderRadius"])||0;e.setShape("r",u)}e.useStyle(l);var d=n.getShallow("cursor");d&&e.attr("cursor",d);var h=s?o?r.r>=r.r0?"endArc":"startArc":r.endAngle>=r.startAngle?"endAngle":"startAngle":o?r.height>=0?"bottom":"top":r.width>=0?"right":"left",p=i1e(n);r1e(e,p,{labelFetcher:i,labelDataIndex:a,defaultText:Ynt(i.getData(),a),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:h});var f=e.getTextContent();if(s&&f){var m=n.get(["label","position"]);e.textConfig.inside="middle"===m||null,function(e,t,a,n){if(EGe(n))e.setTextConfig({rotation:n});else if(TGe(t))e.setTextConfig({rotation:0});else{var r,i=e.shape,o=i.clockwise?i.startAngle:i.endAngle,s=i.clockwise?i.endAngle:i.startAngle,l=(o+s)/2,c=a(t);switch(c){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":r=l;break;case"startAngle":case"insideStartAngle":r=o;break;case"endAngle":case"insideEndAngle":r=s;break;default:return void e.setTextConfig({rotation:0})}var u=1.5*Math.PI-r;"middle"===c&&u>Math.PI/2&&u<1.5*Math.PI&&(u-=Math.PI),e.setTextConfig({rotation:u})}}(e,"outside"===m?h:m,$rt(o),n.get(["label","rotate"]))}f1e(f,p,i.getRawValue(a),function(e){return jnt(t,e)});var v=n.getModel(["emphasis"]);OJe(e,v.get("focus"),v.get("blurScope"),v.get("disabled")),zJe(e,n),function(e){return null!=e.startAngle&&null!=e.endAngle&&e.startAngle===e.endAngle}(r)&&(e.style.fill="none",e.style.stroke="none",gGe(e.states,function(e){e.style&&(e.style.fill=e.style.stroke="none")}))}var Zrt=function(){return function(){}}(),Jrt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="largeBar",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Zrt},t.prototype.buildPath=function(e,t){for(var a=t.points,n=this.baseDimIdx,r=1-this.baseDimIdx,i=[],o=[],s=this.barWidth,l=0;l<a.length;l+=3)o[n]=s,o[r]=a[l+2],i[n]=a[l+n],i[r]=a[l+r],e.rect(i[0],i[1],o[0],o[1])},t}(gZe);function Qrt(e,t,a,n){var r=e.getData(),i=r.getLayout("valueAxisHorizontal")?1:0,o=r.getLayout("largeDataIndices"),s=r.getLayout("size"),l=e.getModel("backgroundStyle"),c=r.getLayout("largeBackgroundPoints");if(c){var u=new Jrt({shape:{points:c},incremental:!!n,silent:!0,z2:0});u.baseDimIdx=i,u.largeDataIndices=o,u.barWidth=s,u.useStyle(l.getItemStyle()),t.add(u),a&&a.push(u)}var d=new Jrt({shape:{points:r.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});d.baseDimIdx=i,d.largeDataIndices=o,d.barWidth=s,t.add(d),d.useStyle(r.getVisual("style")),d.style.stroke=null,YZe(d).seriesIndex=e.seriesIndex,e.get("silent")||(d.on("mousedown",eit),d.on("mousemove",eit)),a&&a.push(d)}var eit=v6e(function(e){var t=function(e,t,a){for(var n=e.baseDimIdx,r=1-n,i=e.shape.points,o=e.largeDataIndices,s=[],l=[],c=e.barWidth,u=0,d=i.length/3;u<d;u++){var h=3*u;if(l[n]=c,l[r]=i[h+2],s[n]=i[h+n],s[r]=i[h+r],l[r]<0&&(s[r]+=l[r],l[r]=-l[r]),t>=s[0]&&t<=s[0]+l[0]&&a>=s[1]&&a<=s[1]+l[1])return o[u]}return-1}(this,e.offsetX,e.offsetY);YZe(this).dataIndex=t>=0?t:null},30,!1);function tit(e,t,a){if(prt(a,"cartesian2d")){var n=t,r=a.getArea();return{x:e?n.x:r.x,y:e?r.y:n.y,width:e?n.width:r.width,height:e?r.height:n.height}}var i=t;return{cx:(r=a.getArea()).cx,cy:r.cy,r0:e?r.r0:i.r0,r:e?r.r:i.r,startAngle:e?i.startAngle:0,endAngle:e?i.endAngle:2*Math.PI}}function ait(e){e.registerChartView(zrt),e.registerSeriesModel(Drt),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,MGe(pet,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,fet("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Ert("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(e,t){var a=e.componentType||"series";t.eachComponent({mainType:a,query:e},function(t){e.sortInfo&&t.axis.setCategorySortInfo(e.sortInfo)})})}var nit=2*Math.PI,rit=Math.PI/180;function iit(e,t,a){t.eachSeriesByType(e,function(e){var t=e.getData(),n=t.mapDimension("value"),r=X2e(e,a),i=r.cx,o=r.cy,s=r.r,l=r.r0,c=r.viewRect,u=-e.get("startAngle")*rit,d=e.get("endAngle"),h=e.get("padAngle")*rit;d="auto"===d?u-nit:-d*rit;var p=e.get("minAngle")*rit+h,f=0;t.each(n,function(e){!isNaN(e)&&f++});var m=t.getSum(n),v=Math.PI/(m||f)*2,g=e.get("clockwise"),y=e.get("roseType"),b=e.get("stillShowZeroSum"),x=t.getDataExtent(n);x[0]=0;var w=g?1:-1,_=[u,d],S=w*h/2;$Ke(_,!g),u=_[0],d=_[1];var M=oit(e);M.startAngle=u,M.endAngle=d,M.clockwise=g,M.cx=i,M.cy=o,M.r=s,M.r0=l;var T=Math.abs(d-u),k=T,C=0,A=u;if(t.setLayout({viewRect:c,r:s}),t.each(n,function(e,a){var n;if(isNaN(e))t.setItemLayout(a,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:g,cx:i,cy:o,r0:l,r:y?NaN:s});else{(n="area"!==y?0===m&&b?v:e*v:T/f)<p?(n=p,k-=p):C+=e;var r=A+w*n,c=0,u=0;h>n?u=c=A+w*n/2:(c=A+S,u=r-S),t.setItemLayout(a,{angle:n,startAngle:c,endAngle:u,clockwise:g,cx:i,cy:o,r0:l,r:y?IXe(e,x,[l,s]):s}),A=r}}),k<nit&&f)if(k<=.001){var E=T/f;t.each(n,function(e,a){if(!isNaN(e)){var n=t.getItemLayout(a);n.angle=E;var r=0,i=0;E<h?i=r=u+w*(a+.5)*E:(r=u+w*a*E+S,i=u+w*(a+1)*E-S),n.startAngle=r,n.endAngle=i}})}else v=k/C,A=u,t.each(n,function(e,a){if(!isNaN(e)){var n=t.getItemLayout(a),r=n.angle===p?p:e*v,i=0,o=0;r<h?o=i=A+w*r/2:(i=A+S,o=A+w*r-S),n.startAngle=i,n.endAngle=o,A+=w*r}})})}var oit=v$e();function sit(e){return{seriesType:e,reset:function(e,t){var a=t.findComponents({mainType:"legend"});if(a&&a.length){var n=e.getData();n.filterSelf(function(e){for(var t=n.getName(e),r=0;r<a.length;r++)if(!a[r].isSelected(t))return!1;return!0})}}}}var lit=Math.PI/180;function cit(e,t,a,n,r,i,o,s,l,c){if(!(e.length<2)){for(var u=e.length,d=0;d<u;d++)if("outer"===e[d].position&&"labelLine"===e[d].labelAlignTo){var h=e[d].label.x-c;e[d].linePoints[1][0]+=h,e[d].label.x=c}pat(e,1,l,l+o)&&function(e){for(var i={list:[],maxY:0},o={list:[],maxY:0},s=0;s<e.length;s++)if("none"===e[s].labelAlignTo){var l=e[s],c=l.label.y>a?o:i,u=Math.abs(l.label.y-a);if(u>=c.maxY){var d=l.label.x-t-l.len2*r,h=n+l.len,f=Math.abs(d)<h?Math.sqrt(u*u/(1-d*d/h/h)):h;c.rB=f,c.maxY=u}c.list.push(l)}p(i),p(o)}(e)}function p(e){for(var i=e.rB,o=i*i,s=0;s<e.list.length;s++){var l=e.list[s],c=Math.abs(l.label.y-a),u=n+l.len,d=u*u,h=Math.sqrt(Math.abs((1-c*c/o)*d)),p=t+(h+l.len2)*r,f=p-l.label.x;uit(l,l.targetTextWidth-f*r,!0),l.label.x=p}}}function uit(e,t,a){if(null==e.labelStyleWidth){var n=e.label,r=n.style,i=e.rect,o=r.backgroundColor,s=r.padding,l=s?s[1]+s[3]:0,c=r.overflow,u=i.width+(o?0:l);if(t<u||a){if(c&&c.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-l);var d=n.getBoundingRect();n.setStyle("width",Math.ceil(d.width)),n.setStyle("backgroundColor",o)}else{var h=t-l,p=t<u?h:a?h>e.unconstrainedWidth?null:h:null;n.setStyle("width",p)}dit(i,n)}}}function dit(e,t){pit.rect=e,lat(pit,t,hit)}var hit={minMarginForce:[null,0,null,0],marginDefault:[1,0,1,0]},pit={};function fit(e){return"center"===e.position}function mit(e){var t,a,n=e.getData(),r=[],i=!1,o=(e.get("minShowLabelAngle")||0)*lit,s=n.getLayout("viewRect"),l=n.getLayout("r"),c=s.width,u=s.x,d=s.y,h=s.height;function p(e){e.ignore=!0}n.each(function(e){var s=n.getItemGraphicEl(e),d=s.shape,f=s.getTextContent(),m=s.getTextGuideLine(),v=n.getItemModel(e),g=v.getModel("label"),y=g.get("position")||v.get(["emphasis","label","position"]),b=g.get("distanceToLabelLine"),x=g.get("alignTo"),w=RXe(g.get("edgeDistance"),c),_=g.get("bleedMargin");null==_&&(_=Math.min(c,h)>200?10:2);var S=v.getModel("labelLine"),M=S.get("length");M=RXe(M,c);var T=S.get("length2");if(T=RXe(T,c),Math.abs(d.endAngle-d.startAngle)<o)return gGe(f.states,p),f.ignore=!0,void(m&&(gGe(m.states,p),m.ignore=!0));if(function(e){if(!e.ignore)return!0;for(var t in e.states)if(!1===e.states[t].ignore)return!0;return!1}(f)){var k,C,A,E,I=(d.startAngle+d.endAngle)/2,R=Math.cos(I),D=Math.sin(I);t=d.cx,a=d.cy;var P="inside"===y||"inner"===y;if("center"===y)k=d.cx,C=d.cy,E="center";else{var L=(P?(d.r+d.r0)/2*R:d.r*R)+t,N=(P?(d.r+d.r0)/2*D:d.r*D)+a;if(k=L+3*R,C=N+3*D,!P){var O=L+R*(M+l-d.r),F=N+D*(M+l-d.r),B=O+(R<0?-1:1)*T;k="edge"===x?R<0?u+w:u+c-w:B+(R<0?-b:b),C=F,A=[[L,N],[O,F],[B,F]]}E=P?"center":"edge"===x?R>0?"right":"left":R>0?"left":"right"}var U=Math.PI,z=0,V=g.get("rotate");if(EGe(V))z=V*(U/180);else if("center"===y)z=0;else if("radial"===V||!0===V){z=R<0?-I+U:-I}else if("tangential"===V&&"outside"!==y&&"outer"!==y){var H=Math.atan2(R,D);H<0&&(H=2*U+H),D>0&&(H=U+H),z=H-U}if(i=!!z,f.x=k,f.y=C,f.rotation=z,f.setStyle({verticalAlign:"middle"}),P){f.setStyle({align:E});var G=f.states.select;G&&(G.x+=f.x,G.y+=f.y)}else{var W=new fqe(0,0,0,0);dit(W,f),r.push({label:f,labelLine:m,position:y,len:M,len2:T,minTurnAngle:S.get("minTurnAngle"),maxSurfaceAngle:S.get("maxSurfaceAngle"),surfaceNormal:new eqe(R,D),linePoints:A,textAlign:E,labelDistance:b,labelAlignTo:x,edgeDistance:w,bleedMargin:_,rect:W,unconstrainedWidth:W.width,labelStyleWidth:f.style.width})}s.setTextConfig({inside:P})}}),!i&&e.get("avoidLabelOverlap")&&function(e,t,a,n,r,i,o,s){for(var l=[],c=[],u=Number.MAX_VALUE,d=-Number.MAX_VALUE,h=0;h<e.length;h++){var p=e[h].label;fit(e[h])||(p.x<t?(u=Math.min(u,p.x),l.push(e[h])):(d=Math.max(d,p.x),c.push(e[h])))}for(h=0;h<e.length;h++)if(!fit(v=e[h])&&v.linePoints){if(null!=v.labelStyleWidth)continue;p=v.label;var f=v.linePoints,m=void 0;m="edge"===v.labelAlignTo?p.x<t?f[2][0]-v.labelDistance-o-v.edgeDistance:o+r-v.edgeDistance-f[2][0]-v.labelDistance:"labelLine"===v.labelAlignTo?p.x<t?u-o-v.bleedMargin:o+r-d-v.bleedMargin:p.x<t?p.x-o-v.bleedMargin:o+r-p.x-v.bleedMargin,v.targetTextWidth=m,uit(v,m,!1)}for(cit(c,t,a,n,1,0,i,0,s,d),cit(l,t,a,n,-1,0,i,0,s,u),h=0;h<e.length;h++){var v;if(!fit(v=e[h])&&v.linePoints){p=v.label,f=v.linePoints;var g="edge"===v.labelAlignTo,y=p.style.padding,b=y?y[1]+y[3]:0,x=p.style.backgroundColor?0:b,w=v.rect.width+x,_=f[1][0]-f[2][0];g?p.x<t?f[2][0]=o+v.edgeDistance+w+v.labelDistance:f[2][0]=o+r-v.edgeDistance-w-v.labelDistance:(p.x<t?f[2][0]=p.x+v.labelDistance:f[2][0]=p.x-v.labelDistance,f[1][0]=f[2][0]+_),f[1][1]=f[2][1]=p.y}}}(r,t,a,l,c,h,u,d);for(var f=0;f<r.length;f++){var m=r[f],v=m.label,g=m.labelLine,y=isNaN(v.x)||isNaN(v.y);if(v){v.setStyle({align:m.textAlign}),y&&(gGe(v.states,p),v.ignore=!0);var b=v.states.select;b&&(b.x+=v.x,b.y+=v.y)}if(g){var x=m.linePoints;y||!x?(gGe(g.states,p),g.ignore=!0):(Jtt(x,m.minTurnAngle),Qtt(x,m.surfaceNormal,m.maxSurfaceAngle),g.setShape({points:x}),v.__hostTarget.textGuideLineConfig={anchor:new eqe(x[0][0],x[0][1])})}}}var vit=function(e){function t(t,a,n){var r=e.call(this)||this;r.z2=2;var i=new PZe;return r.setTextContent(i),r.updateData(t,a,n,!0),r}return zHe(t,e),t.prototype.updateData=function(e,t,a,n){var r=this,i=e.hostModel,o=e.getItemModel(t),s=o.getModel("emphasis"),l=e.getItemLayout(t),c=hGe(Frt(o.getModel("itemStyle"),l,!0),l);if(isNaN(c.startAngle))r.setShape(c);else{if(n){r.setShape(c);var u=i.getShallow("animationType");i.ecModel.ssr?(d0e(r,{scaleX:0,scaleY:0},i,{dataIndex:t,isFrom:!0}),r.originX=c.cx,r.originY=c.cy):"scale"===u?(r.shape.r=l.r0,d0e(r,{shape:{r:l.r}},i,t)):null!=a?(r.setShape({startAngle:a,endAngle:a}),d0e(r,{shape:{startAngle:l.startAngle,endAngle:l.endAngle}},i,t)):(r.shape.endAngle=l.startAngle,u0e(r,{shape:{endAngle:l.endAngle}},i,t))}else v0e(r),u0e(r,{shape:c},i,t);r.useStyle(e.getItemVisual(t,"style")),zJe(r,o);var d=(l.startAngle+l.endAngle)/2,h=i.get("selectedOffset"),p=Math.cos(d)*h,f=Math.sin(d)*h,m=o.getShallow("cursor");m&&r.attr("cursor",m),this._updateLabel(i,e,t),r.ensureState("emphasis").shape=hGe({r:l.r+(s.get("scale")&&s.get("scaleSize")||0)},Frt(s.getModel("itemStyle"),l)),hGe(r.ensureState("select"),{x:p,y:f,shape:Frt(o.getModel(["select","itemStyle"]),l)}),hGe(r.ensureState("blur"),{shape:Frt(o.getModel(["blur","itemStyle"]),l)});var v=r.getTextGuideLine(),g=r.getTextContent();v&&hGe(v.ensureState("select"),{x:p,y:f}),hGe(g.ensureState("select"),{x:p,y:f}),OJe(this,s.get("focus"),s.get("blurScope"),s.get("disabled"))}},t.prototype._updateLabel=function(e,t,a){var n=this,r=t.getItemModel(a),i=r.getModel("labelLine"),o=t.getItemVisual(a,"style"),s=o&&o.fill,l=o&&o.opacity;r1e(n,i1e(r),{labelFetcher:t.hostModel,labelDataIndex:a,inheritColor:s,defaultOpacity:l,defaultText:e.getFormattedLabel(a,"normal")||t.getName(a)});var c=n.getTextContent();n.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var u=r.get(["label","position"]);if("outside"!==u&&"outer"!==u)n.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new OQe,this.setTextGuideLine(d)),aat(this,nat(r),{stroke:s,opacity:BGe(i.get(["lineStyle","opacity"]),l,1)})}},t}(EQe),git=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return zHe(t,e),t.prototype.render=function(e,t,a,n){var r,i=e.getData(),o=this._data,s=this.group;if(!o&&i.count()>0){for(var l=i.getItemLayout(0),c=1;isNaN(l&&l.startAngle)&&c<i.count();++c)l=i.getItemLayout(c);l&&(r=l.startAngle)}if(this._emptyCircleSector&&s.remove(this._emptyCircleSector),0===i.count()&&e.get("showEmptyCircle")){var u=oit(e),d=new EQe({shape:cGe(u)});d.useStyle(e.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=d,s.add(d)}i.diff(o).add(function(e){var t=new vit(i,e,r);i.setItemGraphicEl(e,t),s.add(t)}).update(function(e,t){var a=o.getItemGraphicEl(t);a.updateData(i,e,r),a.off("click"),s.add(a),i.setItemGraphicEl(e,a)}).remove(function(t){m0e(o.getItemGraphicEl(t),e,t)}).execute(),mit(e),"expansion"!==e.get("animationTypeUpdate")&&(this._data=i)},t.prototype.dispose=function(){},t.prototype.containPoint=function(e,t){var a=t.getData().getItemLayout(0);if(a){var n=e[0]-a.cx,r=e[1]-a.cy,i=Math.sqrt(n*n+r*r);return i<=a.r&&i>=a.r0}},t.type="pie",t}(s6e);function yit(e,t,a){t=TGe(t)&&{coordDimensions:t}||hGe({encodeDefine:e.getEncode()},t);var n=e.getSource(),r=R9e(n,t).dimensions,i=new I9e(r,e);return i.initData(n,a),i}var bit,xit=function(){function e(e,t){this._getDataWithEncodedVisual=e,this._getRawData=t}return e.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},e.prototype.containName=function(e){return this._getRawData().indexOfName(e)>=0},e.prototype.indexOfName=function(e){return this._getDataWithEncodedVisual().indexOfName(e)},e.prototype.getItemVisual=function(e,t){return this._getDataWithEncodedVisual().getItemVisual(e,t)},e}(),wit=v$e(),_it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new xit(SGe(this.getData,this),SGe(this.getRawData,this)),this._defaultLabelLine(t)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return yit(this,{coordDimensions:["value"],encodeDefaulter:MGe(E5e,this)})},t.prototype.getDataParams=function(t){var a=this.getData(),n=wit(a),r=n.seats;if(!r){var i=[];a.each(a.mapDimension("value"),function(e){i.push(e)}),r=n.seats=function(e,t){var a=bGe(e,function(e,t){return e+(isNaN(t)?0:t)},0);if(0===a)return[];for(var n=Math.pow(10,t),r=yGe(e,function(e){return(isNaN(e)?0:e)/a*n*100}),i=100*n,o=yGe(r,function(e){return Math.floor(e)}),s=bGe(o,function(e,t){return e+t},0),l=yGe(r,function(e,t){return e-o[t]});s<i;){for(var c=Number.NEGATIVE_INFINITY,u=null,d=0,h=l.length;d<h;++d)l[d]>c&&(c=l[d],u=d);++o[u],l[u]=0,++s}return yGe(o,function(e){return e/n})}(i,a.hostModel.get("percentPrecision"))}var o=e.prototype.getDataParams.call(this,t);return o.percent=r[t]||0,o.$vars.push("percent"),o},t.prototype._defaultLabelLine=function(e){i$e(e,"labelLine",["show"]);var t=e.labelLine,a=e.emphasis.labelLine;t.show=t.show&&e.label.show,a.show=a.show&&e.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"50%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,coordinateSystemUsage:"box",left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:30,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}($3e);function Sit(e){e.registerChartView(git),e.registerSeriesModel(_it),r8e("pie",e.registerAction),e.registerLayout(MGe(iit,"pie")),e.registerProcessor(sit("pie")),e.registerProcessor(function(e){return{seriesType:e,reset:function(e,t){var a=e.getData();a.filterSelf(function(e){var t=a.mapDimension("value"),n=a.get(t,e);return!(EGe(n)&&!isNaN(n)&&n<0)})}}}("pie"))}bit={fullType:_it.type,getCoord2:function(e){return e.getShallow("center")}},N2e.set(bit.fullType,{getCoord2:void 0}).getCoord2=bit.getCoord2;var Mit=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){return U9e(null,this,{useEncodeDefaulter:!0})},t.prototype.getProgressive=function(){var e=this.option.progressive;return null==e?this.option.large?5e3:this.get("progressive"):e},t.prototype.getProgressiveThreshold=function(){var e=this.option.progressiveThreshold;return null==e?this.option.large?1e4:this.get("progressiveThreshold"):e},t.prototype.brushSelector=function(e,t,a){return a.point(t.getItemLayout(e))},t.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},t.type="series.scatter",t.dependencies=["grid","polar","geo","singleAxis","calendar","matrix"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:o5e.color.primary}},universalTransition:{divideShape:"clone"}},t}($3e),Tit=function(){},kit=function(e){function t(t){var a=e.call(this,t)||this;return a._off=0,a.hoverDataIdx=-1,a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Tit},t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.buildPath=function(e,t){var a,n=t.points,r=t.size,i=this.symbolProxy,o=i.shape,s=e.getContext?e.getContext():e,l=s&&r[0]<4,c=this.softClipShape;if(l)this._ctx=s;else{for(this._ctx=null,a=this._off;a<n.length;){var u=n[a++],d=n[a++];isNaN(u)||isNaN(d)||(c&&!c.contain(u,d)||(o.x=u-r[0]/2,o.y=d-r[1]/2,o.width=r[0],o.height=r[1],i.buildPath(e,o,!0)))}this.incremental&&(this._off=a,this.notClear=!0)}},t.prototype.afterBrush=function(){var e,t=this.shape,a=t.points,n=t.size,r=this._ctx,i=this.softClipShape;if(r){for(e=this._off;e<a.length;){var o=a[e++],s=a[e++];isNaN(o)||isNaN(s)||(i&&!i.contain(o,s)||r.fillRect(o-n[0]/2,s-n[1]/2,n[0],n[1]))}this.incremental&&(this._off=e,this.notClear=!0)}},t.prototype.findDataIndex=function(e,t){for(var a=this.shape,n=a.points,r=a.size,i=Math.max(r[0],4),o=Math.max(r[1],4),s=n.length/2-1;s>=0;s--){var l=2*s,c=n[l]-i/2,u=n[l+1]-o/2;if(e>=c&&t>=u&&e<=c+i&&t<=u+o)return s}return-1},t.prototype.contain=function(e,t){var a=this.transformCoordToLocal(e,t),n=this.getBoundingRect();return e=a[0],t=a[1],n.contain(e,t)?(this.hoverDataIdx=this.findDataIndex(e,t))>=0:(this.hoverDataIdx=-1,!1)},t.prototype.getBoundingRect=function(){var e=this._rect;if(!e){for(var t=this.shape,a=t.points,n=t.size,r=n[0],i=n[1],o=1/0,s=1/0,l=-1/0,c=-1/0,u=0;u<a.length;){var d=a[u++],h=a[u++];o=Math.min(d,o),l=Math.max(d,l),s=Math.min(h,s),c=Math.max(h,c)}e=this._rect=new fqe(o-r/2,s-i/2,l-o+r,c-s+i)}return e},t}(gZe),Cit=function(){function e(){this.group=new xXe}return e.prototype.updateData=function(e,t){this._clear();var a=this._create();a.setShape({points:e.getLayout("points")}),this._setCommon(a,e,t)},e.prototype.updateLayout=function(e){var t=e.getLayout("points");this.group.eachChild(function(e){if(null!=e.startIndex){var a=2*(e.endIndex-e.startIndex),n=4*e.startIndex*2;t=new Float32Array(t.buffer,n,a)}e.setShape("points",t),e.reset()})},e.prototype.incrementalPrepareUpdate=function(e){this._clear()},e.prototype.incrementalUpdate=function(e,t,a){var n=this._newAdded[0],r=t.getLayout("points"),i=n&&n.shape.points;if(i&&i.length<2e4){var o=i.length,s=new Float32Array(o+r.length);s.set(i),s.set(r,o),n.endIndex=e.end,n.setShape({points:s})}else{this._newAdded=[];var l=this._create();l.startIndex=e.start,l.endIndex=e.end,l.incremental=!0,l.setShape({points:r}),this._setCommon(l,t,a)}},e.prototype.eachRendered=function(e){this._newAdded[0]&&e(this._newAdded[0])},e.prototype._create=function(){var e=new kit({cursor:"default"});return e.ignoreCoarsePointer=!0,this.group.add(e),this._newAdded.push(e),e},e.prototype._setCommon=function(e,t,a){var n=t.hostModel;a=a||{};var r=t.getVisual("symbolSize");e.setShape("size",r instanceof Array?r:[r,r]),e.softClipShape=a.clipShape||null,e.symbolProxy=y8e(t.getVisual("symbol"),0,0,0,0),e.setColor=e.symbolProxy.setColor;var i=e.shape.size[0]<4;e.useStyle(n.getModel("itemStyle").getItemStyle(i?["color","shadowBlur","shadowColor"]:["color"]));var o=t.getVisual("style"),s=o&&o.fill;s&&e.setColor(s);var l=YZe(e);l.seriesIndex=n.seriesIndex,e.on("mousemove",function(t){l.dataIndex=null;var a=e.hoverDataIdx;a>=0&&(l.dataIndex=a+(e.startIndex||0))})},e.prototype.remove=function(){this._clear()},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),Ait=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=e.getData();this._updateSymbolDraw(n,e).updateData(n,{clipShape:this._getClipShape(e)}),this._finished=!0},t.prototype.incrementalPrepareRender=function(e,t,a){var n=e.getData();this._updateSymbolDraw(n,e).incrementalPrepareUpdate(n),this._finished=!1},t.prototype.incrementalRender=function(e,t,a){this._symbolDraw.incrementalUpdate(e,t.getData(),{clipShape:this._getClipShape(t)}),this._finished=e.end===t.getData().count()},t.prototype.updateTransform=function(e,t,a){var n=e.getData();if(this.group.dirty(),!this._finished||n.count()>1e4)return{update:!0};var r=krt("").reset(e,t,a);r.progress&&r.progress({start:0,end:n.count(),count:n.count()},n),this._symbolDraw.updateLayout(n)},t.prototype.eachRendered=function(e){this._symbolDraw&&this._symbolDraw.eachRendered(e)},t.prototype._getClipShape=function(e){if(e.get("clip",!0)){var t=e.coordinateSystem;return t&&t.getArea&&t.getArea(.1)}},t.prototype._updateSymbolDraw=function(e,t){var a=this._symbolDraw,n=t.pipelineContext.large;return a&&n===this._isLargeDraw||(a&&a.remove(),a=this._symbolDraw=n?new Cit:new Qnt,this._isLargeDraw=n,this.group.removeAll()),this.group.add(a.group),a},t.prototype.remove=function(e,t){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},t.prototype.dispose=function(){},t.type="scatter",t}(s6e),Eit={left:0,right:0,top:0,bottom:0},Iit=["25%","25%"],Rit=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.mergeDefaultAndTheme=function(t,a){var n=a5e(t.outerBounds);e.prototype.mergeDefaultAndTheme.apply(this,arguments),n&&t.outerBounds&&t5e(t.outerBounds,n)},t.prototype.mergeOption=function(t,a){e.prototype.mergeOption.apply(this,arguments),this.option.outerBounds&&t.outerBounds&&t5e(this.option.outerBounds,t.outerBounds)},t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"15%",top:65,right:"10%",bottom:80,containLabel:!1,outerBoundsMode:"auto",outerBounds:Eit,outerBoundsContain:"all",outerBoundsClampWidth:Iit[0],outerBoundsClampHeight:Iit[1],backgroundColor:o5e.color.transparent,borderWidth:1,borderColor:o5e.color.neutral30},t}(i5e),Dit=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",x$e).models[0]},t.type="cartesian2dAxis",t}(i5e);mGe(Dit,Ket);var Pit={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:o5e.color.axisLine,width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15],breakLine:!0},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12,color:o5e.color.axisLabel,textMargin:[0,3]},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:o5e.color.axisSplitLine,width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:[o5e.color.backgroundTint,o5e.color.backgroundTransparent]}},breakArea:{show:!0,itemStyle:{color:o5e.color.neutral00,borderColor:o5e.color.border,borderWidth:1,borderType:[3,3],opacity:.6},zigzagAmplitude:4,zigzagMinSpan:4,zigzagMaxSpan:20,zigzagZ:100,expandOnClick:!0},breakLabelLayout:{moveOverlap:"auto"}},Lit=uGe({boundaryGap:!0,deduplication:null,jitter:0,jitterOverlap:!0,jitterMargin:2,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto",show:"auto"},axisLabel:{interval:"auto"}},Pit),Nit=uGe({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:o5e.color.axisMinorSplitLine,width:1}}},Pit);const Oit={category:Lit,value:Nit,time:uGe({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},Nit),log:pGe({logBase:10},Nit)};var Fit={value:1,category:1,time:1,log:1},Bit=null;function Uit(){return Bit}function zit(e,t,a,n){gGe(Fit,function(r,i){var o=uGe(uGe({},Oit[i],!0),n,!0),s=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t+"Axis."+i,a}return zHe(a,e),a.prototype.mergeDefaultAndTheme=function(e,t){var a=e5e(this),n=a?a5e(e):{};uGe(e,t.getTheme().get(i+"Axis")),uGe(e,this.getDefaultOption()),e.type=Vit(e),a&&t5e(e,n,a)},a.prototype.optionUpdated=function(){"category"===this.option.type&&(this.__ordinalMeta=J9e.createByAxisModel(this))},a.prototype.getCategories=function(e){var t=this.option;if("category"===t.type)return e?t.data:this.__ordinalMeta.categories},a.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},a.prototype.updateAxisBreaks=function(e){var t=Uit();return t?t.updateModelAxisBreak(this,e):{breaks:[]}},a.type=t+"Axis."+i,a.defaultOption=o,a}(a);e.registerComponentModel(s)}),e.registerSubTypeDefaulter(t+"Axis",Vit)}function Vit(e){return e.type||(e.data?"category":"value")}var Hit=function(){function e(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return e.prototype.getAxis=function(e){return this._axes[e]},e.prototype.getAxes=function(){return yGe(this._dimList,function(e){return this._axes[e]},this)},e.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),xGe(this.getAxes(),function(t){return t.scale.type===e})},e.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},e}(),Git=["x","y"];function Wit(e){return("interval"===e.type||"time"===e.type)&&!e.hasBreaks()}var qit=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=Git,t}return zHe(t,e),t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var e=this.getAxis("x").scale,t=this.getAxis("y").scale;if(Wit(e)&&Wit(t)){var a=e.getExtent(),n=t.getExtent(),r=this.dataToPoint([a[0],n[0]]),i=this.dataToPoint([a[1],n[1]]),o=a[1]-a[0],s=n[1]-n[0];if(o&&s){var l=(i[0]-r[0])/o,c=(i[1]-r[1])/s,u=r[0]-a[0]*l,d=r[1]-n[0]*c,h=this._transform=[l,0,0,c,u,d];this._invTransform=QWe([],h)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(e){var t=this.getAxis("x"),a=this.getAxis("y");return t.contain(t.toLocalCoord(e[0]))&&a.contain(a.toLocalCoord(e[1]))},t.prototype.containData=function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])},t.prototype.containZone=function(e,t){var a=this.dataToPoint(e),n=this.dataToPoint(t),r=this.getArea(),i=new fqe(a[0],a[1],n[0]-a[0],n[1]-a[1]);return r.intersect(i)},t.prototype.dataToPoint=function(e,t,a){a=a||[];var n=e[0],r=e[1];if(this._transform&&null!=n&&isFinite(n)&&null!=r&&isFinite(r))return vWe(a,e,this._transform);var i=this.getAxis("x"),o=this.getAxis("y");return a[0]=i.toGlobalCoord(i.dataToCoord(n,t)),a[1]=o.toGlobalCoord(o.dataToCoord(r,t)),a},t.prototype.clampData=function(e,t){var a=this.getAxis("x").scale,n=this.getAxis("y").scale,r=a.getExtent(),i=n.getExtent(),o=a.parse(e[0]),s=n.parse(e[1]);return(t=t||[])[0]=Math.min(Math.max(Math.min(r[0],r[1]),o),Math.max(r[0],r[1])),t[1]=Math.min(Math.max(Math.min(i[0],i[1]),s),Math.max(i[0],i[1])),t},t.prototype.pointToData=function(e,t,a){if(a=a||[],this._invTransform)return vWe(a,e,this._invTransform);var n=this.getAxis("x"),r=this.getAxis("y");return a[0]=n.coordToData(n.toLocalCoord(e[0]),t),a[1]=r.coordToData(r.toLocalCoord(e[1]),t),a},t.prototype.getOtherAxis=function(e){return this.getAxis("x"===e.dim?"y":"x")},t.prototype.getArea=function(e){e=e||0;var t=this.getAxis("x").getGlobalExtent(),a=this.getAxis("y").getGlobalExtent(),n=Math.min(t[0],t[1])-e,r=Math.min(a[0],a[1])-e,i=Math.max(t[0],t[1])-n+e,o=Math.max(a[0],a[1])-r+e;return new fqe(n,r,i,o)},t}(Hit),Yit=function(e){function t(t,a,n,r,i){var o=e.call(this,t,a,n)||this;return o.index=0,o.type=r||"value",o.position=i||"bottom",o}return zHe(t,e),t.prototype.isHorizontal=function(){var e=this.position;return"top"===e||"bottom"===e},t.prototype.getGlobalExtent=function(e){var t=this.getExtent();return t[0]=this.toGlobalCoord(t[0]),t[1]=this.toGlobalCoord(t[1]),e&&t[0]>t[1]&&t.reverse(),t},t.prototype.pointToData=function(e,t){return this.coordToData(this.toLocalCoord(e["x"===this.dim?0:1]),t)},t.prototype.setCategorySortInfo=function(e){if("category"!==this.type)return!1;this.model.option.categorySortInfo=e,this.scale.setSortInfo(e)},t}(Dtt),jit="expandAxisBreak",Xit="collapseAxisBreak",$it="toggleAxisBreak",Kit="axisbreakchanged",Zit={type:jit,event:Kit,update:"update",refineEvent:eot},Jit={type:Xit,event:Kit,update:"update",refineEvent:eot},Qit={type:$it,event:Kit,update:"update",refineEvent:eot};function eot(e,t,a,n){var r=[];return gGe(e,function(e){r=r.concat(e.eventBreaks)}),{eventContent:{breaks:r}}}var tot=Math.PI,aot=[[1,2,1,2],[5,3,5,3],[8,3,8,3]],not=[[0,1,0,1],[0,3,0,3],[0,3,0,3]],rot=v$e(),iot=v$e(),oot=function(){function e(e){this.recordMap={},this.resolveAxisNameOverlap=e}return e.prototype.ensureRecord=function(e){var t=e.axis.dim,a=e.componentIndex,n=this.recordMap,r=n[t]||(n[t]=[]);return r[a]||(r[a]={ready:{}})},e}();var sot=[1,0,0,1,0,0],lot=new fqe(0,0,0,0),cot=function(e,t,a,n,r,i){if(jet(e.nameLocation)){var o=i.stOccupiedRect;o&&uot(function(e,t,a){return e.transform=$0e(e.transform,a),e.localRect=X0e(e.localRect,t),e.rect=X0e(e.rect,t),a&&e.rect.applyTransform(a),e.axisAligned=Y0e(a),e.obb=void 0,(e.label=e.label||{}).ignore=!1,e}({},o,i.transGroup.transform),n,r)}else dot(i.labelInfoList,i.dirVec,n,r)};function uot(e,t,a){var n=new eqe;mat(e,t,n,{direction:Math.atan2(a.y,a.x),bidirectional:!1,touchThreshold:.05})&&uat(t,n)}function dot(e,t,a,n){for(var r=eqe.dot(n,t)>=0,i=0,o=e.length;i<o;i++){var s=e[r?i:o-1-i];s.label.ignore||uot(s,a,n)}}var hot=function(){function e(e,t,a,n){this.group=new xXe,this._axisModel=e,this._api=t,this._local={},this._shared=n||new oot(cot),this._resetCfgDetermined(a)}return e.prototype.updateCfg=function(e){var t=this._cfg.raw;t.position=e.position,t.labelOffset=e.labelOffset,this._resetCfgDetermined(t)},e.prototype.__getRawCfg=function(){return this._cfg.raw},e.prototype._resetCfgDetermined=function(e){var t=this._axisModel,a=t.getDefaultOption?t.getDefaultOption():{},n=FGe(e.axisName,t.get("name")),r=t.get("nameMoveOverlap");null!=r&&"auto"!==r||(r=FGe(e.defaultNameMoveOverlap,!0));var i={raw:e,position:e.position,rotation:e.rotation,nameDirection:FGe(e.nameDirection,1),tickDirection:FGe(e.tickDirection,1),labelDirection:FGe(e.labelDirection,1),labelOffset:FGe(e.labelOffset,0),silent:FGe(e.silent,!0),axisName:n,nameLocation:BGe(t.get("nameLocation"),a.nameLocation,"end"),shouldNameMoveOverlap:Sot(n)&&r,optionHideOverlap:t.get(["axisLabel","hideOverlap"]),showMinorTicks:t.get(["minorTick","show"])};this._cfg=i;var o=new xXe({x:i.position[0],y:i.position[1],rotation:i.rotation});o.updateTransform(),this._transformGroup=o;var s=this._shared.ensureRecord(t);s.transGroup=this._transformGroup,s.dirVec=new eqe(Math.cos(-i.rotation),Math.sin(-i.rotation))},e.prototype.build=function(e,t){var a=this;return e||(e={axisLine:!0,axisTickLabelEstimate:!1,axisTickLabelDetermine:!0,axisName:!0}),gGe(pot,function(n){e[n]&&fot[n](a._cfg,a._local,a._shared,a._axisModel,a.group,a._transformGroup,a._api,t||{})}),this},e.innerTextLayout=function(e,t,a){var n,r,i=UXe(t-e);return zXe(i)?(r=a>0?"top":"bottom",n="center"):zXe(i-tot)?(r=a>0?"bottom":"top",n="center"):(r="middle",n=i>0&&i<tot?a>0?"right":"left":a>0?"left":"right"),{rotation:i,textAlign:n,textVerticalAlign:r}},e.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},e.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},e}(),pot=["axisLine","axisTickLabelEstimate","axisTickLabelDetermine","axisName"],fot={axisLine:function(e,t,a,n,r,i,o){var s=n.get(["axisLine","show"]);if("auto"===s&&(s=!0,null!=e.raw.axisLineAutoShow&&(s=!!e.raw.axisLineAutoShow)),s){var l=n.axis.getExtent(),c=i.transform,u=[l[0],0],d=[l[1],0],h=u[0]>d[0];c&&(vWe(u,u,c),vWe(d,d,c));var p=hGe({lineCap:"round"},n.getModel(["axisLine","lineStyle"]).getLineStyle()),f={strokeContainThreshold:e.raw.strokeContainThreshold||5,silent:!0,z2:1,style:p};if(n.get(["axisLine","breakLine"])&&n.axis.scale.hasBreaks())Uit().buildAxisBreakLine(n,r,i,f);else{var m=new UQe(hGe({shape:{x1:u[0],y1:u[1],x2:d[0],y2:d[1]}},f));A0e(m.shape,m.style.lineWidth),m.anid="line",r.add(m)}var v=n.get(["axisLine","symbol"]);if(null!=v){var g=n.get(["axisLine","symbolSize"]);CGe(v)&&(v=[v,v]),(CGe(g)||EGe(g))&&(g=[g,g]);var y=x8e(n.get(["axisLine","symbolOffset"])||0,g),b=g[0],x=g[1];gGe([{rotate:e.rotation+Math.PI/2,offset:y[0],r:0},{rotate:e.rotation-Math.PI/2,offset:y[1],r:Math.sqrt((u[0]-d[0])*(u[0]-d[0])+(u[1]-d[1])*(u[1]-d[1]))}],function(t,a){if("none"!==v[a]&&null!=v[a]){var n=y8e(v[a],-b/2,-x/2,b,x,p.stroke,!0),i=t.r+t.offset,o=h?d:u;n.attr({rotation:t.rotate,x:o[0]+i*Math.cos(e.rotation),y:o[1]-i*Math.sin(e.rotation),silent:!0,z2:11}),r.add(n)}})}}},axisTickLabelEstimate:function(e,t,a,n,r,i,o,s){yot(t,r,s)&&mot(e,t,a,n,r,i,o,mtt)},axisTickLabelDetermine:function(e,t,a,n,r,i,o,s){yot(t,r,s)&&mot(e,t,a,n,r,i,o,vtt);var l=function(e,t,a,n){var r=n.axis,i=n.getModel("axisTick"),o=i.get("show");"auto"===o&&(o=!0,null!=e.raw.axisTickAutoShow&&(o=!!e.raw.axisTickAutoShow));if(!o||r.scale.isBlank())return[];for(var s=i.getModel("lineStyle"),l=e.tickDirection*i.get("length"),c=got(r.getTicksCoords(),a.transform,l,pGe(s.getLineStyle(),{stroke:n.get(["axisLine","lineStyle","color"])}),"ticks"),u=0;u<c.length;u++)t.add(c[u]);return c}(e,r,i,n);!function(e,t,a){if(e.showMinorTicks)return;gGe(t,function(e){if(e&&e.label.ignore)for(var t=0;t<a.length;t++){var n=a[t],r=iot(n),i=rot(e.label);if(null!=r.tickValue&&!r.onBand&&r.tickValue===i.tickValue)return void vot(n)}})}(e,t.labelLayoutList,l),function(e,t,a,n,r){var i=n.axis,o=n.getModel("minorTick");if(!e.showMinorTicks||i.scale.isBlank())return;var s=i.getMinorTicksCoords();if(!s.length)return;for(var l=o.getModel("lineStyle"),c=r*o.get("length"),u=pGe(l.getLineStyle(),pGe(n.getModel("axisTick").getLineStyle(),{stroke:n.get(["axisLine","lineStyle","color"])})),d=0;d<s.length;d++)for(var h=got(s[d],a.transform,c,u,"minorticks_"+d),p=0;p<h.length;p++)t.add(h[p])}(e,r,i,n,e.tickDirection)},axisName:function(e,t,a,n,r,i,o,s){var l=a.ensureRecord(n);t.nameEl&&(r.remove(t.nameEl),t.nameEl=l.nameLayout=l.nameLocation=null);var c=e.axisName;if(Sot(c)){var u=e.nameLocation,d=e.nameDirection,h=n.getModel("nameTextStyle"),p=n.get("nameGap")||0,f=n.axis.getExtent(),m=n.axis.inverse?-1:1,v=new eqe(0,0),g=new eqe(0,0);"start"===u?(v.x=f[0]-m*p,g.x=-m):"end"===u?(v.x=f[1]+m*p,g.x=m):(v.x=(f[0]+f[1])/2,v.y=e.labelOffset+d*p,g.y=d);var y=[1,0,0,1,0,0];g.transform(ZWe(y,y,e.rotation));var b,x,w=n.get("nameRotate");null!=w&&(w=w*tot/180),jet(u)?b=hot.innerTextLayout(e.rotation,null!=w?w:e.rotation,d):(b=function(e,t,a,n){var r,i,o=UXe(a-e),s=n[0]>n[1],l="start"===t&&!s||"start"!==t&&s;zXe(o-tot/2)?(i=l?"bottom":"top",r="center"):zXe(o-1.5*tot)?(i=l?"top":"bottom",r="center"):(i="middle",r=o<1.5*tot&&o>tot/2?l?"left":"right":l?"right":"left");return{rotation:o,textAlign:r,textVerticalAlign:i}}(e.rotation,u,w||0,f),null!=(x=e.raw.axisNameAvailableWidth)&&(x=Math.abs(x/Math.sin(b.rotation)),!isFinite(x)&&(x=null)));var _=h.getFont(),S=n.get("nameTruncate",!0)||{},M=S.ellipsis,T=OGe(e.raw.nameTruncateMaxWidth,S.maxWidth,x),k=s.nameMarginLevel||0,C=new PZe({x:v.x,y:v.y,rotation:b.rotation,silent:hot.isLabelSilent(n),style:o1e(h,{text:c,font:_,overflow:"truncate",width:T,ellipsis:M,fill:h.getTextColor()||n.get(["axisLine","lineStyle","color"]),align:h.get("align")||b.textAlign,verticalAlign:h.get("verticalAlign")||b.textVerticalAlign}),z2:1});if(G0e({el:C,componentModel:n,itemName:c}),C.__fullText=c,C.anid="name",n.get("triggerEvent")){var A=hot.makeAxisEventDataBase(n);A.targetType="axisName",A.name=c,YZe(C).eventData=A}i.add(C),C.updateTransform(),t.nameEl=C;var E=l.nameLayout=sat({label:C,priority:C.z2,defaultAttr:{ignore:C.ignore},marginDefault:jet(u)?aot[k]:not[k]});if(l.nameLocation=u,r.add(C),C.decomposeTransform(),e.shouldNameMoveOverlap&&E){var I=a.ensureRecord(n);a.resolveAxisNameOverlap(e,a,n,E,g,I)}}}};function mot(e,t,a,n,r,i,o,s){bot(t)||function(e,t,a,n,r,i){var o=r.axis,s=OGe(e.raw.axisLabelShow,r.get(["axisLabel","show"])),l=new xXe;a.add(l);var c=gtt(n);if(!s||o.scale.isBlank())return void xot(t,[],l,c);var u=r.getModel("axisLabel"),d=o.getViewLabels(c),h=(OGe(e.raw.labelRotate,u.get("rotate"))||0)*tot/180,p=hot.innerTextLayout(e.rotation,h,e.labelDirection),f=r.getCategories&&r.getCategories(!0),m=[],v=r.get("triggerEvent"),g=1/0,y=-1/0;gGe(d,function(e,t){var a,n="ordinal"===o.scale.type?o.scale.getRawOrdinalNumber(e.tickValue):e.tickValue,s=e.formattedLabel,c=e.rawLabel,h=u;if(f&&f[n]){var b=f[n];IGe(b)&&b.textStyle&&(h=new E1e(b.textStyle,u,r.ecModel))}var x=h.getTextColor()||r.get(["axisLine","lineStyle","color"]),w=h.getShallow("align",!0)||p.textAlign,_=FGe(h.getShallow("alignMinLabel",!0),w),S=FGe(h.getShallow("alignMaxLabel",!0),w),M=h.getShallow("verticalAlign",!0)||h.getShallow("baseline",!0)||p.textVerticalAlign,T=FGe(h.getShallow("verticalAlignMinLabel",!0),M),k=FGe(h.getShallow("verticalAlignMaxLabel",!0),M),C=10+((null===(a=e.time)||void 0===a?void 0:a.level)||0);g=Math.min(g,C),y=Math.max(y,C);var A=new PZe({x:0,y:0,rotation:0,silent:hot.isLabelSilent(r),z2:C,style:o1e(h,{text:s,align:0===t?_:t===d.length-1?S:w,verticalAlign:0===t?T:t===d.length-1?k:M,fill:kGe(x)?x("category"===o.type?c:"value"===o.type?n+"":n,t):x})});A.anid="label_"+n;var E=rot(A);if(E.break=e.break,E.tickValue=n,E.layoutRotation=p.rotation,G0e({el:A,componentModel:r,itemName:s,formatterParamsExtra:{isTruncated:function(){return A.isTruncated},value:c,tickIndex:t}}),v){var I=hot.makeAxisEventDataBase(r);I.targetType="axisLabel",I.value=c,I.tickIndex=t,e.break&&(I.break={start:e.break.parsedBreak.vmin,end:e.break.parsedBreak.vmax}),"category"===o.type&&(I.dataIndex=n),YZe(A).eventData=I,e.break&&function(e,t,a,n){a.on("click",function(a){var r={type:jit,breaks:[{start:n.parsedBreak.breakOption.start,end:n.parsedBreak.breakOption.end}]};r[e.axis.dim+"AxisIndex"]=e.componentIndex,t.dispatchAction(r)})}(r,i,A,e.break)}m.push(A),l.add(A)});var b=yGe(m,function(e){return{label:e,priority:rot(e).break?e.z2+(y-g+1):e.z2,defaultAttr:{ignore:e.ignore}}});xot(t,b,l,c)}(e,t,r,s,n,o);var l=t.labelLayoutList;!function(e,t,a,n){var r=t.get(["axisLabel","margin"]);gGe(a,function(a,i){var o=sat(a);if(o){var s=o.label,l=rot(s);o.suggestIgnore=s.ignore,s.ignore=!1,Kje(wot,_ot),wot.x=t.axis.dataToCoord(l.tickValue),wot.y=e.labelOffset+e.labelDirection*r,wot.rotation=l.layoutRotation,n.add(wot),wot.updateTransform(),n.remove(wot),wot.decomposeTransform(),Kje(s,wot),s.markRedraw(),iat(o,!0),sat(o)}})}(e,n,l,i),function(e,t,a){var n=H1e();if(!n)return;var r=n.retrieveAxisBreakPairs(a,function(e){return e&&rot(e.label).break},!0),i=e.get(["breakLabelLayout","moveOverlap"],!0);!0!==i&&"auto"!==i||gGe(r,function(n){Uit().adjustBreakLabelPair(e.axis.inverse,t,[sat(a[n[0]]),sat(a[n[1]])])})}(n,e.rotation,l);var c=e.optionHideOverlap;!function(e,t,a){if(qet(e.axis))return;function n(e,n,r){var i=sat(t[n]),o=sat(t[r]);if(i&&o)if(!1===e||i.suggestIgnore)vot(i.label);else if(o.suggestIgnore)vot(o.label);else{var s=.1;if(!a){var l=[0,0,0,0];i=dat({marginForce:l},i),o=dat({marginForce:l},o)}mat(i,o,null,{touchThreshold:s})&&vot(e?o.label:i.label)}}var r=e.get(["axisLabel","showMinLabel"]),i=e.get(["axisLabel","showMaxLabel"]),o=t.length;n(r,0,1),n(i,o-1,o-2)}(n,l,c),c&&fat(xGe(l,function(e){return e&&!e.label.ignore})),function(e,t,a,n){var r,i=a.axis,o=t.ensureRecord(a),s=[],l=Sot(e.axisName)&&jet(e.nameLocation);gGe(n,function(e){var t=sat(e);if(t&&!t.label.ignore){s.push(t);var a=o.transGroup;l&&(a.transform?QWe(sot,a.transform):jWe(sot),t.transform&&$We(sot,sot,t.transform),fqe.copy(lot,t.localRect),lot.applyTransform(sot),r?r.union(lot):fqe.copy(r=new fqe(0,0,0,0),lot))}});var c=Math.abs(o.dirVec.x)>.1?"x":"y",u=o.transGroup[c];if(s.sort(function(e,t){return Math.abs(e.label[c]-u)-Math.abs(t.label[c]-u)}),l&&r){var d=i.getExtent(),h=Math.min(d[0],d[1]),p=Math.max(d[0],d[1])-h;r.union(new fqe(h,0,p,1))}o.stOccupiedRect=r,o.labelInfoList=s}(e,a,n,l)}function vot(e){e&&(e.ignore=!0)}function got(e,t,a,n,r){for(var i=[],o=[],s=[],l=0;l<e.length;l++){var c=e[l].coord;o[0]=c,o[1]=0,s[0]=c,s[1]=a,t&&(vWe(o,o,t),vWe(s,s,t));var u=new UQe({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});A0e(u.shape,u.style.lineWidth),u.anid=r+"_"+e[l].tickValue,i.push(u);var d=iot(u);d.onBand=!!e[l].onBand,d.tickValue=e[l].tickValue}return i}function yot(e,t,a){if(bot(e)){var n=e.axisLabelsCreationContext.out.noPxChangeTryDetermine;if(a.noPxChange){for(var r=!0,i=0;i<n.length;i++)r=r&&n[i]();if(r)return!1}n.length&&(t.remove(e.labelGroup),xot(e,null,null,null))}return!0}function bot(e){return!!e.labelLayoutList}function xot(e,t,a,n){e.labelLayoutList=t,e.labelGroup=a,e.axisLabelsCreationContext=n}var wot=new EZe,_ot=new EZe;function Sot(e){return!!e}function Mot(e,t,a){a=a||{};var n=t.axis,r={},i=n.getAxesOnZeroOf()[0],o=n.position,s=i?"onZero":o,l=n.dim,c=[e.x,e.x+e.width,e.y,e.y+e.height],u={left:0,right:1,top:0,bottom:1,onZero:2},d=t.get("offset")||0,h="x"===l?[c[2]-d,c[3]+d]:[c[0]-d,c[1]+d];if(i){var p=i.toGlobalCoord(i.dataToCoord(0));h[u.onZero]=Math.max(Math.min(p,h[1]),h[0])}r.position=["y"===l?h[u[s]]:c[0],"x"===l?h[u[s]]:c[3]],r.rotation=Math.PI/2*("x"===l?0:1);r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,left:-1,right:1}[o],r.labelOffset=i?h[u[o]]-h[u.onZero]:0,t.get(["axisTick","inside"])&&(r.tickDirection=-r.tickDirection),OGe(a.labelInside,t.get(["axisLabel","inside"]))&&(r.labelDirection=-r.labelDirection);var f=t.get(["axisLabel","rotate"]);return r.labelRotate="top"===s?-f:f,r.z2=1,r}function Tot(e){var t={xAxisModel:null,yAxisModel:null};return gGe(t,function(a,n){var r=n.replace(/Model$/,""),i=e.getReferringComponents(r,x$e).models[0];t[n]=i}),t}function kot(e,t,a){var n=aet.prototype,r=n.getTicks.call(a),i=n.getTicks.call(a,{expandToNicedExtent:!0}),o=r.length-1,s=n.getInterval.call(a),l=Uet(e,t),c=l.extent,u=l.fixMin,d=l.fixMax;"log"===e.type&&(c=$9e(e.base,c,!0)),e.setBreaksFromOption($et(t)),e.setExtent(c[0],c[1]),e.calcNiceExtent({splitNumber:o,fixMin:u,fixMax:d});var h=n.getExtent.call(e);u&&(c[0]=h[0]),d&&(c[1]=h[1]);var p=n.getInterval.call(e),f=c[0],m=c[1];if(u&&d)p=(m-f)/o;else if(u)for(m=c[0]+p*o;m<c[1]&&isFinite(m)&&isFinite(c[1]);)p=H9e(p),m=c[0]+p*o;else if(d)for(f=c[1]-p*o;f>c[0]&&isFinite(f)&&isFinite(c[0]);)p=H9e(p),f=c[1]-p*o;else{e.getTicks().length-1>o&&(p=H9e(p));var v=p*o;(f=PXe((m=Math.ceil(c[1]/p)*p)-v))<0&&c[0]>=0?(f=0,m=PXe(v)):m>0&&c[1]<=0&&(m=0,f=-PXe(v))}var g=(r[0].value-i[0].value)/s,y=(r[o].value-i[o].value)/s;n.setExtent.call(e,f+p*g,m+p*y),n.setInterval.call(e,p),(g||y)&&n.setNiceExtent.call(e,f+p,m-p)}var Cot,Aot=[[3,1],[0,2]],Eot=function(){function e(e,t,a){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=Git,this._initCartesian(e,t,a),this.model=e}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(e,t){var a=this._axesMap;function n(e){var t,a=_Ge(e),n=a.length;if(n){for(var r=[],i=n-1;i>=0;i--){var o=e[+a[i]],s=o.model,l=o.scale;z9e(l)&&s.get("alignTicks")&&null==s.get("interval")?r.push(o):(zet(l,s),z9e(l)&&(t=o))}r.length&&(t||zet((t=r.pop()).scale,t.model),gGe(r,function(e){kot(e.scale,e.model,t.scale)}))}}this._updateScale(e,this.model),n(a.x),n(a.y);var r={};gGe(a.x,function(e){Rot(a,"y",e,r)}),gGe(a.y,function(e){Rot(a,"x",e,r)}),this.resize(this.model,t)},e.prototype.resize=function(e,t,a){var n=J2e(e,t),r=this._rect=$2e(e.getBoxLayoutParams(),n.refContainer),i=this._axesMap,o=this._coordsList,s=e.get("containLabel");if(Pot(i,r),!a){var l=function(e,t,a,n,r){var i=new oot(Fot);return gGe(a,function(a){return gGe(a,function(a){if(Xet(a.model)){var o=!n;a.axisBuilder=function(e,t,a,n,r,i){for(var o=Mot(e,a),s=!1,l=!1,c=0;c<t.length;c++)z9e(t[c].getOtherAxis(a.axis).scale)&&(s=l=!0,"category"===a.axis.type&&a.axis.onBand&&(l=!1));return o.axisLineAutoShow=s,o.axisTickAutoShow=l,o.defaultNameMoveOverlap=i,new hot(a,n,o,r)}(e,t,a.model,r,i,o)}})}),i}(r,o,i,s,t),c=void 0;if(s)Cot?(Cot(this._axesList,r),Pot(i,r)):c=Not(r.clone(),"axisLabel",null,r,i,l,n);else{var u=function(e,t,a){var n,r=e.get("outerBoundsMode",!0);"same"===r?n=t.clone():null!=r&&"auto"!==r||(n=$2e(e.get("outerBounds",!0)||Eit,a.refContainer));var i,o=e.get("outerBoundsContain",!0);i=null==o||"auto"===o||fGe(["all","axisLabel"],o)<0?"all":o;var s=[DXe(FGe(e.get("outerBoundsClampWidth",!0),Iit[0]),t.width),DXe(FGe(e.get("outerBoundsClampHeight",!0),Iit[1]),t.height)];return{outerBoundsRect:n,parsedOuterBoundsContain:i,outerBoundsClamp:s}}(e,r,n),d=u.outerBoundsRect,h=u.parsedOuterBoundsContain,p=u.outerBoundsClamp;d&&(c=Not(d,h,p,r,i,l,n))}Oot(r,i,vtt,null,c,n)}gGe(this._coordsList,function(e){e.calcAffineTransform()})},e.prototype.getAxis=function(e,t){var a=this._axesMap[e];if(null!=a)return a[t||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(e,t){if(null!=e&&null!=t){var a="x"+e+"y"+t;return this._coordsMap[a]}IGe(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var n=0,r=this._coordsList;n<r.length;n++)if(r[n].getAxis("x").index===e||r[n].getAxis("y").index===t)return r[n]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(e,t,a){var n=this._findConvertTarget(t);return n.cartesian?n.cartesian.dataToPoint(a):n.axis?n.axis.toGlobalCoord(n.axis.dataToCoord(a)):null},e.prototype.convertFromPixel=function(e,t,a){var n=this._findConvertTarget(t);return n.cartesian?n.cartesian.pointToData(a):n.axis?n.axis.coordToData(n.axis.toLocalCoord(a)):null},e.prototype._findConvertTarget=function(e){var t,a,n=e.seriesModel,r=e.xAxisModel||n&&n.getReferringComponents("xAxis",x$e).models[0],i=e.yAxisModel||n&&n.getReferringComponents("yAxis",x$e).models[0],o=e.gridModel,s=this._coordsList;if(n)fGe(s,t=n.coordinateSystem)<0&&(t=null);else if(r&&i)t=this.getCartesian(r.componentIndex,i.componentIndex);else if(r)a=this.getAxis("x",r.componentIndex);else if(i)a=this.getAxis("y",i.componentIndex);else if(o){o.coordinateSystem===this&&(t=this._coordsList[0])}return{cartesian:t,axis:a}},e.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},e.prototype._initCartesian=function(e,t,a){var n=this,r=this,i={left:!1,right:!1,top:!1,bottom:!1},o={x:{},y:{}},s={x:0,y:0};if(t.eachComponent("xAxis",l("x"),this),t.eachComponent("yAxis",l("y"),this),!s.x||!s.y)return this._axesMap={},void(this._axesList=[]);function l(t){return function(a,n){if(Iot(a,e)){var l=a.get("position");"x"===t?"top"!==l&&"bottom"!==l&&(l=i.bottom?"top":"bottom"):"left"!==l&&"right"!==l&&(l=i.left?"right":"left"),i[l]=!0;var c=new Yit(t,Vet(a),[0,0],a.get("type"),l),u="category"===c.type;c.onBand=u&&a.get("boundaryGap"),c.inverse=a.get("inverse"),a.axis=c,c.model=a,c.grid=r,c.index=n,r._axesList.push(c),o[t][n]=c,s[t]++}}}this._axesMap=o,gGe(o.x,function(t,a){gGe(o.y,function(r,i){var o="x"+a+"y"+i,s=new qit(o);s.master=n,s.model=e,n._coordsMap[o]=s,n._coordsList.push(s),s.addAxis(t),s.addAxis(r)})})},e.prototype._updateScale=function(e,t){function a(e,t){gGe(Yet(e,t.dim),function(a){t.scale.unionExtentFromData(e,a)})}gGe(this._axesList,function(e){if(e.scale.setExtent(1/0,-1/0),"category"===e.type){var t=e.model.get("categorySortInfo");e.scale.setSortInfo(t)}}),e.eachSeries(function(e){if(function(e){return e.coordinateSystem&&"cartesian2d"===e.coordinateSystem.type}(e)){var n=Tot(e),r=n.xAxisModel,i=n.yAxisModel;if(!Iot(r,t)||!Iot(i,t))return;var o=this.getCartesian(r.componentIndex,i.componentIndex),s=e.getData(),l=o.getAxis("x"),c=o.getAxis("y");a(s,l),a(s,c)}},this)},e.prototype.getTooltipAxes=function(e){var t=[],a=[];return gGe(this.getCartesians(),function(n){var r=null!=e&&"auto"!==e?n.getAxis(e):n.getBaseAxis(),i=n.getOtherAxis(r);fGe(t,r)<0&&t.push(r),fGe(a,i)<0&&a.push(i)}),{baseAxes:t,otherAxes:a}},e.create=function(t,a){var n=[];return t.eachComponent("grid",function(r,i){var o=new e(r,t,a);o.name="grid_"+i,o.resize(r,a,!0),r.coordinateSystem=o,n.push(o)}),t.eachSeries(function(e){z2e({targetModel:e,coordSysType:"cartesian2d",coordSysProvider:function(){var t=Tot(e),a=t.xAxisModel,n=t.yAxisModel;return a.getCoordSysModel().coordinateSystem.getCartesian(a.componentIndex,n.componentIndex)}})}),n},e.dimensions=Git,e}();function Iot(e,t){return e.getCoordSysModel()===t}function Rot(e,t,a,n){a.getAxesOnZeroOf=function(){return r?[r]:[]};var r,i=e[t],o=a.model,s=o.get(["axisLine","onZero"]),l=o.get(["axisLine","onZeroAxisIndex"]);if(s){if(null!=l)Dot(i[l])&&(r=i[l]);else for(var c in i)if(i.hasOwnProperty(c)&&Dot(i[c])&&!n[u(i[c])]){r=i[c];break}r&&(n[u(r)]=!0)}function u(e){return e.dim+"_"+e.index}}function Dot(e){return e&&"category"!==e.type&&"time"!==e.type&&function(e){var t=e.scale.getExtent(),a=t[0],n=t[1];return!(a>0&&n>0||a<0&&n<0)}(e)}function Pot(e,t){gGe(e.x,function(e){return Lot(e,t.x,t.width)}),gGe(e.y,function(e){return Lot(e,t.y,t.height)})}function Lot(e,t,a){var n=[0,a],r=e.inverse?1:0;e.setExtent(n[r],n[1-r]),function(e,t){var a=e.getExtent(),n=a[0]+a[1];e.toGlobalCoord="x"===e.dim?function(e){return e+t}:function(e){return n-e+t},e.toLocalCoord="x"===e.dim?function(e){return e-t}:function(e){return n-e+t}}(e,t)}function Not(e,t,a,n,r,i,o){Oot(n,r,mtt,t,!1,o);var s=[0,0,0,0];c(0),c(1),u(n,0,NaN),u(n,1,NaN);var l=null==wGe(s,function(e){return e>0});return z0e(n,s,!0,!0,a),Pot(r,n),l;function c(e){gGe(r[y0e[e]],function(t){if(Xet(t.model)){var a=i.ensureRecord(t.model),n=a.labelInfoList;if(n)for(var r=0;r<n.length;r++){var o=n[r],s=t.scale.normalize(rot(o.label).tickValue);s=1===e?1-s:s,u(o.rect,e,s),u(o.rect,1-e,NaN)}var l=a.nameLayout;if(l){s=jet(a.nameLocation)?.5:NaN;u(l.rect,e,s),u(l.rect,1-e,NaN)}}})}function u(t,a,n){var r=e[y0e[a]]-t[y0e[a]],i=t[b0e[a]]+t[y0e[a]]-(e[b0e[a]]+e[y0e[a]]);r=d(r,1-n),i=d(i,n);var o=Aot[a][0],l=Aot[a][1];s[o]=AXe(s[o],r),s[l]=AXe(s[l],i)}function d(e,t){return e>0&&!NGe(t)&&t>1e-4&&(e/=t),e}}function Oot(e,t,a,n,r,i){var o=a===vtt;gGe(t,function(t){return gGe(t,function(t){Xet(t.model)&&(!function(e,t,a){var n=Mot(t,a);e.updateCfg(n)}(t.axisBuilder,e,t.model),t.axisBuilder.build(o?{axisTickLabelDetermine:!0}:{axisTickLabelEstimate:!0},{noPxChange:r}))})});var s={x:0,y:0};function l(t){s[y0e[1-t]]=e[b0e[t]]<=.5*i.refContainer[b0e[t]]?0:1-t==1?2:1}l(0),l(1),gGe(t,function(e,t){return gGe(e,function(e){Xet(e.model)&&(("all"===n||o)&&e.axisBuilder.build({axisName:!0},{nameMarginLevel:s[t]}),o&&e.axisBuilder.build({axisLine:!0}))})})}var Fot=function(e,t,a,n,r,i){var o="x"===a.axis.dim?"y":"x";cot(e,0,0,n,r,i),jet(e.nameLocation)||gGe(t.recordMap[o],function(e){e&&e.labelInfoList&&e.dirVec&&dot(e.labelInfoList,e.dirVec,n,r)})};function Bot(e,t){var a={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(e,t,a){var n=t.getComponent("tooltip"),r=t.getComponent("axisPointer"),i=r.get("link",!0)||[],o=[];gGe(a.getCoordinateSystems(),function(a){if(a.axisPointerEnabled){var s=Hot(a.model),l=e.coordSysAxesInfo[s]={};e.coordSysMap[s]=a;var c=a.model.getModel("tooltip",n);if(gGe(a.getAxes(),MGe(p,!1,null)),a.getTooltipAxes&&n&&c.get("show")){var u="axis"===c.get("trigger"),d="cross"===c.get(["axisPointer","type"]),h=a.getTooltipAxes(c.get(["axisPointer","axis"]));(u||d)&&gGe(h.baseAxes,MGe(p,!d||"cross",u)),d&&gGe(h.otherAxes,MGe(p,"cross",!1))}}function p(n,s,u){var d=u.model.getModel("axisPointer",r),h=d.get("show");if(h&&("auto"!==h||n||Vot(d))){null==s&&(s=d.get("triggerTooltip")),d=n?function(e,t,a,n,r,i){var o=t.getModel("axisPointer"),s={};gGe(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(e){s[e]=cGe(o.get(e))}),s.snap="category"!==e.type&&!!i,"cross"===o.get("type")&&(s.type="line");var l=s.label||(s.label={});if(null==l.show&&(l.show=!1),"cross"===r){var c=o.get(["label","show"]);if(l.show=null==c||c,!i){var u=s.lineStyle=o.get("crossStyle");u&&pGe(l,u.textStyle)}}return e.model.getModel("axisPointer",new E1e(s,a,n))}(u,c,r,t,n,s):d;var p=d.get("snap"),f=d.get("triggerEmphasis"),m=Hot(u.model),v=s||p||"category"===u.type,g=e.axesInfo[m]={key:m,axis:u,coordSys:a,axisPointerModel:d,triggerTooltip:s,triggerEmphasis:f,involveSeries:v,snap:p,useHandle:Vot(d),seriesModels:[],linkGroup:null};l[m]=g,e.seriesInvolved=e.seriesInvolved||v;var y=function(e,t){for(var a=t.model,n=t.dim,r=0;r<e.length;r++){var i=e[r]||{};if(Uot(i[n+"AxisId"],a.id)||Uot(i[n+"AxisIndex"],a.componentIndex)||Uot(i[n+"AxisName"],a.name))return r}}(i,u);if(null!=y){var b=o[y]||(o[y]={axesInfo:{}});b.axesInfo[m]=g,b.mapper=i[y].mapper,g.linkGroup=b}}}})}(a,e,t),a.seriesInvolved&&function(e,t){t.eachSeries(function(t){var a=t.coordinateSystem,n=t.get(["tooltip","trigger"],!0),r=t.get(["tooltip","show"],!0);a&&a.model&&"none"!==n&&!1!==n&&"item"!==n&&!1!==r&&!1!==t.get(["axisPointer","show"],!0)&&gGe(e.coordSysAxesInfo[Hot(a.model)],function(e){var n=e.axis;a.getAxis(n.dim)===n&&(e.seriesModels.push(t),null==e.seriesDataCount&&(e.seriesDataCount=0),e.seriesDataCount+=t.getData().count())})})}(a,e),a}function Uot(e,t){return"all"===e||TGe(e)&&fGe(e,t)>=0||e===t}function zot(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[Hot(e)]}function Vot(e){return!!e.get(["handle","show"])}function Hot(e){return e.type+"||"+e.id}var Got={},Wot=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(t,a,n,r){this.axisPointerClass&&function(e){var t=zot(e);if(t){var a=t.axisPointerModel,n=t.axis.scale,r=a.option,i=a.get("status"),o=a.get("value");null!=o&&(o=n.parse(o));var s=Vot(a);null==i&&(r.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==o||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),r.value=o,s&&(r.status=t.axis.scale.isBlank()?"hide":"show")}}(t),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,n,!0)},t.prototype.updateAxisPointer=function(e,t,a,n){this._doUpdateAxisPointerClass(e,a,!1)},t.prototype.remove=function(e,t){var a=this._axisPointer;a&&a.remove(t)},t.prototype.dispose=function(t,a){this._disposeAxisPointer(a),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(e,a,n){var r=t.getAxisPointerClass(this.axisPointerClass);if(r){var i=function(e){var t=zot(e);return t&&t.axisPointerModel}(e);i?(this._axisPointer||(this._axisPointer=new r)).render(e,i,a,n):this._disposeAxisPointer(a)}},t.prototype._disposeAxisPointer=function(e){this._axisPointer&&this._axisPointer.dispose(e),this._axisPointer=null},t.registerAxisPointerClass=function(e,t){Got[e]=t},t.getAxisPointerClass=function(e){return e&&Got[e]},t.type="axis",t}(n6e),qot=v$e();function Yot(e,t,a,n){var r=a.axis;if(!r.scale.isBlank()){var i=a.getModel("splitArea"),o=i.getModel("areaStyle"),s=o.get("color"),l=n.coordinateSystem.getRect(),c=r.getTicksCoords({tickModel:i,clamp:!0,breakTicks:"none",pruneByBreak:"preserve_extent_bound"});if(c.length){var u=s.length,d=qot(e).splitAreaColors,h=$Ge(),p=0;if(d)for(var f=0;f<c.length;f++){var m=d.get(c[f].tickValue);if(null!=m){p=(m+(u-1)*f)%u;break}}var v=r.toGlobalCoord(c[0].coord),g=o.getAreaStyle();s=TGe(s)?s:[s];for(f=1;f<c.length;f++){var y=r.toGlobalCoord(c[f].coord),b=void 0,x=void 0,w=void 0,_=void 0;r.isHorizontal()?(b=v,x=l.y,w=y-b,_=l.height,v=b+w):(b=l.x,x=v,w=l.width,v=x+(_=y-x));var S=c[f-1].tickValue;null!=S&&h.set(S,p),t.add(new EZe({anid:null!=S?"area_"+S:null,shape:{x:b,y:x,width:w,height:_},style:pGe({fill:s[p]},g),autoBatch:!0,silent:!0})),p=(p+1)%u}qot(e).splitAreaColors=h}}}function jot(e){qot(e).splitAreaColors=null}var Xot=["splitArea","splitLine","minorSplitLine","breakArea"],$ot=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.axisPointerClass="CartesianAxisPointer",a}return zHe(t,e),t.prototype.render=function(t,a,n,r){this.group.removeAll();var i=this._axisGroup;(this._axisGroup=new xXe,this.group.add(this._axisGroup),Xet(t))&&(this._axisGroup.add(t.axis.axisBuilder.group),gGe(Xot,function(e){t.get([e,"show"])&&Kot[e](this,this._axisGroup,t,t.getCoordSysModel(),n)},this),r&&"changeAxisOrder"===r.type&&r.isInitSort||L0e(i,this._axisGroup,t),e.prototype.render.call(this,t,a,n,r))},t.prototype.remove=function(){jot(this)},t.type="cartesianAxis",t}(Wot),Kot={splitLine:function(e,t,a,n,r){var i=a.axis;if(!i.scale.isBlank()){var o=a.getModel("splitLine"),s=o.getModel("lineStyle"),l=s.get("color"),c=!1!==o.get("showMinLine"),u=!1!==o.get("showMaxLine");l=TGe(l)?l:[l];for(var d=n.coordinateSystem.getRect(),h=i.isHorizontal(),p=0,f=i.getTicksCoords({tickModel:o,breakTicks:"none",pruneByBreak:"preserve_extent_bound"}),m=[],v=[],g=s.getLineStyle(),y=0;y<f.length;y++){var b=i.toGlobalCoord(f[y].coord);if((0!==y||c)&&(y!==f.length-1||u)){var x=f[y].tickValue;h?(m[0]=b,m[1]=d.y,v[0]=b,v[1]=d.y+d.height):(m[0]=d.x,m[1]=b,v[0]=d.x+d.width,v[1]=b);var w=p++%l.length,_=new UQe({anid:null!=x?"line_"+x:null,autoBatch:!0,shape:{x1:m[0],y1:m[1],x2:v[0],y2:v[1]},style:pGe({stroke:l[w]},g),silent:!0});A0e(_.shape,g.lineWidth),t.add(_)}}}},minorSplitLine:function(e,t,a,n,r){var i=a.axis,o=a.getModel("minorSplitLine").getModel("lineStyle"),s=n.coordinateSystem.getRect(),l=i.isHorizontal(),c=i.getMinorTicksCoords();if(c.length)for(var u=[],d=[],h=o.getLineStyle(),p=0;p<c.length;p++)for(var f=0;f<c[p].length;f++){var m=i.toGlobalCoord(c[p][f].coord);l?(u[0]=m,u[1]=s.y,d[0]=m,d[1]=s.y+s.height):(u[0]=s.x,u[1]=m,d[0]=s.x+s.width,d[1]=m);var v=new UQe({anid:"minor_line_"+c[p][f].tickValue,autoBatch:!0,shape:{x1:u[0],y1:u[1],x2:d[0],y2:d[1]},style:h,silent:!0});A0e(v.shape,h.lineWidth),t.add(v)}},splitArea:function(e,t,a,n,r){Yot(e,t,a,n)},breakArea:function(e,t,a,n,r){var i=Uit(),o=a.axis.scale;i&&"ordinal"!==o.type&&i.rectCoordBuildBreakAxis(t,e,a,n.coordinateSystem.getRect(),r)}},Zot=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="xAxis",t}($ot),Jot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Zot.type,t}return zHe(t,e),t.type="yAxis",t}($ot),Qot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="grid",t}return zHe(t,e),t.prototype.render=function(e,t){this.group.removeAll(),e.get("show")&&this.group.add(new EZe({shape:e.coordinateSystem.getRect(),style:pGe({fill:e.get("backgroundColor")},e.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(n6e),est={offset:0};function tst(e){e.registerComponentView(Qot),e.registerComponentModel(Rit),e.registerCoordinateSystem("cartesian2d",Eot),zit(e,"x",Dit,est),zit(e,"y",Dit,est),e.registerComponentView(Zot),e.registerComponentView(Jot),e.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}var ast=v$e();function nst(e,t,a,n){if(e instanceof Yit){var r=e.scale.type;if("category"!==r&&"ordinal"!==r)return a}var i=e.model,o=i.get("jitter"),s=i.get("jitterOverlap"),l=i.get("jitterMargin")||0,c="ordinal"===e.scale.type?e.getBandWidth():null;return o>0?s?rst(a,o,c,n):function(e,t,a,n,r,i){var o=ast(e);o.items||(o.items=[]);var s=o.items,l=ist(s,t,a,n,r,i,1),c=ist(s,t,a,n,r,i,-1),u=Math.abs(l-a)<Math.abs(c-a)?l:c,d="ordinal"===e.scale.type?e.getBandWidth():null,h=Math.abs(u-a);if(h>r/2||d&&h>d/2-n)return rst(a,r,d,n);return s.push({fixedCoord:t,floatCoord:u,r:n}),u}(e,t,a,n,o,l):a}function rst(e,t,a,n){if(null===a)return e+(Math.random()-.5)*t;var r=a-2*n,i=Math.min(Math.max(0,t),r);return e+(Math.random()-.5)*i}function ist(e,t,a,n,r,i,o){for(var s=a,l=0;l<e.length;l++){var c=e[l],u=t-c.fixedCoord,d=s-c.floatCoord,h=u*u+d*d,p=n+c.r+i;if(h<p*p){var f=c.floatCoord+Math.sqrt(p*p-u*u)*o;if(Math.abs(f-a)>r/2)return Number.MAX_VALUE;if(1===o&&f>s||-1===o&&f<s){s=f,l=-1;continue}}}return s}function ost(e){e.eachSeriesByType("scatter",function(e){var t=e.coordinateSystem;if(t&&("cartesian2d"===t.type||"single"===t.type)){var a=t.getBaseAxis?t.getBaseAxis():null,n=a&&function(e,t){var a=e.coordinateSystem,n=a&&a.type,r=a&&a.getBaseAxis&&a.getBaseAxis(),i=r&&r.scale&&r.scale.type,o="cartesian2d"===n&&"ordinal"===i||"single"===n,s=t.model.get("jitter")>0;return o&&s}(e,a);if(n){var r=e.getData();r.each(function(e){var t=a.dim,n=a.orient,i="horizontal"===n&&"category"!==a.type||"vertical"===n&&"category"===a.type,o=r.getItemLayout(e),s=r.getItemVisual(e,"symbolSize"),l=s instanceof Array?(s[1]+s[0])/2:s;if("y"===t||"single"===t&&i){var c=nst(a,o[0],o[1],l/2);r.setItemLayout(e,[o[0],c])}else if("x"===t||"single"===t&&!i){c=nst(a,o[1],o[0],l/2);r.setItemLayout(e,[c,o[1]])}})}}})}function sst(e){Qet(tst),e.registerSeriesModel(Mit),e.registerChartView(Ait),e.registerLayout(krt("scatter"))}function lst(e){e.eachSeriesByType("radar",function(e){var t=e.getData(),a=[],n=e.coordinateSystem;if(n){var r=n.getIndicatorAxes();gGe(r,function(e,i){t.each(t.mapDimension(r[i].dim),function(e,t){a[t]=a[t]||[];var r=n.dataToPoint(e,i);a[t][i]=cst(r)?r:ust(n)})}),t.each(function(e){var r=wGe(a[e],function(e){return cst(e)})||ust(n);a[e].push(r.slice()),t.setItemLayout(e,a[e])})}})}function cst(e){return!isNaN(e[0])&&!isNaN(e[1])}function ust(e){return[e.cx,e.cy]}function dst(e){var t=e.polar;if(t){TGe(t)||(t=[t]);var a=[];gGe(t,function(t,n){t.indicator?(t.type&&!t.shape&&(t.shape=t.type),e.radar=e.radar||[],TGe(e.radar)||(e.radar=[e.radar]),e.radar.push(t)):a.push(t)}),e.polar=a}gGe(e.series,function(e){e&&"radar"===e.type&&e.polarIndex&&(e.radarIndex=e.polarIndex)})}var hst=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=e.coordinateSystem,r=this.group,i=e.getData(),o=this._data;function s(e,t){var a=e.getItemVisual(t,"symbol")||"circle";if("none"!==a){var n=b8e(e.getItemVisual(t,"symbolSize")),r=y8e(a,-1,-1,2,2),i=e.getItemVisual(t,"symbolRotate")||0;return r.attr({style:{strokeNoScale:!0},z2:100,scaleX:n[0]/2,scaleY:n[1]/2,rotation:i*Math.PI/180||0}),r}}function l(t,a,n,r,i,o){n.removeAll();for(var l=0;l<a.length-1;l++){var c=s(r,i);c&&(c.__dimIdx=l,t[l]?(c.setPosition(t[l]),e1e[o?"initProps":"updateProps"](c,{x:a[l][0],y:a[l][1]},e,i)):c.setPosition(a[l]),n.add(c))}}function c(e){return yGe(e,function(e){return[n.cx,n.cy]})}i.diff(o).add(function(t){var a=i.getItemLayout(t);if(a){var n=new LQe,r=new OQe,o={shape:{points:a}};n.shape.points=c(a),r.shape.points=c(a),d0e(n,o,e,t),d0e(r,o,e,t);var s=new xXe,u=new xXe;s.add(r),s.add(n),s.add(u),l(r.shape.points,a,u,i,t,!0),i.setItemGraphicEl(t,s)}}).update(function(t,a){var n=o.getItemGraphicEl(a),r=n.childAt(0),s=n.childAt(1),c=n.childAt(2),u={shape:{points:i.getItemLayout(t)}};u.shape.points&&(l(r.shape.points,u.shape.points,c,i,t,!1),v0e(s),v0e(r),u0e(r,u,e),u0e(s,u,e),i.setItemGraphicEl(t,n))}).remove(function(e){r.remove(o.getItemGraphicEl(e))}).execute(),i.eachItemGraphicEl(function(e,t){var a=i.getItemModel(t),n=e.childAt(0),o=e.childAt(1),s=e.childAt(2),l=i.getItemVisual(t,"style"),c=l.fill;r.add(e),n.useStyle(pGe(a.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:c})),zJe(n,a,"lineStyle"),zJe(o,a,"areaStyle");var u=a.getModel("areaStyle"),d=u.isEmpty()&&u.parentModel.isEmpty();o.ignore=d,gGe(["emphasis","select","blur"],function(e){var t=a.getModel([e,"areaStyle"]),r=t.isEmpty()&&t.parentModel.isEmpty();o.ensureState(e).ignore=r&&d;var i=a.getModel([e,"lineStyle"]).getLineStyle();n.ensureState(e).style=i;var l=t.getAreaStyle();o.ensureState(e).style=l;var c=a.getModel([e,"itemStyle"]).getItemStyle();s.eachChild(function(t){t.ensureState(e).style=cGe(c)})}),o.useStyle(pGe(a.getModel("areaStyle").getAreaStyle(),{fill:c,opacity:.7,decal:l.decal}));var h=a.getModel("emphasis");s.eachChild(function(e){if(e instanceof _Ze){var n=e.style;e.useStyle(hGe({image:n.image,x:n.x,y:n.y,width:n.width,height:n.height},l))}else e.useStyle(l),e.setColor(c),e.style.strokeNoScale=!0;var r=i.getStore().get(i.getDimensionIndex(e.__dimIdx),t);(null==r||isNaN(r))&&(r=""),r1e(e,i1e(a),{labelFetcher:i.hostModel,labelDataIndex:t,labelDimIndex:e.__dimIdx,defaultText:r,inheritColor:c,defaultOpacity:l.opacity})}),OJe(e,h.get("focus"),h.get("blurScope"),h.get("disabled"))}),this._data=i},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.type="radar",t}(s6e),pst=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a}return zHe(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new xit(SGe(this.getData,this),SGe(this.getRawData,this))},t.prototype.getInitialData=function(e,t){return yit(this,{generateCoord:"indicator_",generateCoordCount:1/0})},t.prototype.formatTooltip=function(e,t,a){var n=this.getData(),r=this.coordinateSystem.getIndicatorAxes(),i=this.getData().getName(e),o=""===i?this.name:i,s=H3e(this,e);return P3e("section",{header:o,sortBlocks:!0,blocks:yGe(r,function(t){var a=n.get(n.mapDimension(t.dim),e);return P3e("nameValue",{markerType:"subItem",markerColor:s,name:t.name,value:a,sortParam:a})})})},t.prototype.getTooltipPosition=function(e){if(null!=e)for(var t=this.getData(),a=this.coordinateSystem,n=t.getValues(yGe(a.dimensions,function(e){return t.mapDimension(e)}),e),r=0,i=n.length;r<i;r++)if(!isNaN(n[r])){var o=a.getIndicatorAxes();return a.coordToPoint(o[r].dataToCoord(n[r]),r)}},t.type="series.radar",t.dependencies=["radar"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},t}($3e),fst=Oit.value;function mst(e,t){return pGe({show:t},e)}var vst=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.optionUpdated=function(){var e=this.get("boundaryGap"),t=this.get("splitNumber"),a=this.get("scale"),n=this.get("axisLine"),r=this.get("axisTick"),i=this.get("axisLabel"),o=this.get("axisName"),s=this.get(["axisName","show"]),l=this.get(["axisName","formatter"]),c=this.get("axisNameGap"),u=this.get("triggerEvent"),d=yGe(this.get("indicator")||[],function(d){null!=d.max&&d.max>0&&!d.min?d.min=0:null!=d.min&&d.min<0&&!d.max&&(d.max=0);var h=o;null!=d.color&&(h=pGe({color:d.color},o));var p=uGe(cGe(d),{boundaryGap:e,splitNumber:t,scale:a,axisLine:n,axisTick:r,axisLabel:i,name:d.text,showName:s,nameLocation:"end",nameGap:c,nameTextStyle:h,triggerEvent:u},!1);if(CGe(l)){var f=p.name;p.name=l.replace("{value}",null!=f?f:"")}else kGe(l)&&(p.name=l(p.name,p));var m=new E1e(p,null,this.ecModel);return mGe(m,Ket.prototype),m.mainType="radar",m.componentIndex=this.componentIndex,m},this);this._indicatorModels=d},t.prototype.getIndicatorModels=function(){return this._indicatorModels},t.type="radar",t.defaultOption={z:0,center:["50%","50%"],radius:"50%",startAngle:90,axisName:{show:!0,color:o5e.color.axisLabel},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:uGe({lineStyle:{color:o5e.color.neutral20}},fst.axisLine),axisLabel:mst(fst.axisLabel,!1),axisTick:mst(fst.axisTick,!1),splitLine:mst(fst.splitLine,!0),splitArea:mst(fst.splitArea,!0),indicator:[]},t}(i5e),gst=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){this.group.removeAll(),this._buildAxes(e,a),this._buildSplitLineAndArea(e)},t.prototype._buildAxes=function(e,t){var a=e.coordinateSystem;gGe(yGe(a.getIndicatorAxes(),function(e){var n=e.model.get("showName")?e.name:"";return new hot(e.model,t,{axisName:n,position:[a.cx,a.cy],rotation:e.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}),function(e){e.build(),this.group.add(e.group)},this)},t.prototype._buildSplitLineAndArea=function(e){var t=e.coordinateSystem,a=t.getIndicatorAxes();if(a.length){var n=e.get("shape"),r=e.getModel("splitLine"),i=e.getModel("splitArea"),o=r.getModel("lineStyle"),s=i.getModel("areaStyle"),l=r.get("show"),c=i.get("show"),u=o.get("color"),d=s.get("color"),h=TGe(u)?u:[u],p=TGe(d)?d:[d],f=[],m=[];if("circle"===n)for(var v=a[0].getTicksCoords(),g=t.cx,y=t.cy,b=0;b<v.length;b++){if(l)f[C(f,h,b)].push(new hQe({shape:{cx:g,cy:y,r:v[b].coord}}));if(c&&b<v.length-1)m[C(m,p,b)].push(new RQe({shape:{cx:g,cy:y,r0:v[b].coord,r:v[b+1].coord}}))}else{var x,w=yGe(a,function(e,a){var n=e.getTicksCoords();return x=null==x?n.length-1:Math.min(n.length-1,x),yGe(n,function(e){return t.coordToPoint(e.coord,a)})}),_=[];for(b=0;b<=x;b++){for(var S=[],M=0;M<a.length;M++)S.push(w[M][b]);if(S[0]&&S.push(S[0].slice()),l)f[C(f,h,b)].push(new OQe({shape:{points:S}}));if(c&&_)m[C(m,p,b-1)].push(new LQe({shape:{points:S.concat(_)}}));_=S.slice().reverse()}}var T=o.getLineStyle(),k=s.getAreaStyle();gGe(m,function(e,t){this.group.add(k0e(e,{style:pGe({stroke:"none",fill:p[t%p.length]},k),silent:!0}))},this),gGe(f,function(e,t){this.group.add(k0e(e,{style:pGe({fill:"none",stroke:h[t%h.length]},T),silent:!0}))},this)}function C(e,t,a){var n=a%t.length;return e[n]=e[n]||[],n}},t.type="radar",t}(n6e),yst=function(e){function t(t,a,n){var r=e.call(this,t,a,n)||this;return r.type="value",r.angle=0,r.name="",r}return zHe(t,e),t}(Dtt),bst=function(){function e(e,t,a){this.dimensions=[],this._model=e,this._indicatorAxes=yGe(e.getIndicatorModels(),function(e,t){var a="indicator_"+t,n=new yst(a,new aet);return n.name=e.get("name"),n.model=e,e.axis=n,this.dimensions.push(a),n},this),this.resize(e,a)}return e.prototype.getIndicatorAxes=function(){return this._indicatorAxes},e.prototype.dataToPoint=function(e,t){var a=this._indicatorAxes[t];return this.coordToPoint(a.dataToCoord(e),t)},e.prototype.coordToPoint=function(e,t){var a=this._indicatorAxes[t].angle;return[this.cx+e*Math.cos(a),this.cy-e*Math.sin(a)]},e.prototype.pointToData=function(e){var t=e[0]-this.cx,a=e[1]-this.cy,n=Math.sqrt(t*t+a*a);t/=n,a/=n;for(var r,i=Math.atan2(-a,t),o=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var c=this._indicatorAxes[l],u=Math.abs(i-c.angle);u<o&&(r=c,s=l,o=u)}return[s,+(r&&r.coordToData(n))]},e.prototype.resize=function(e,t){var a=J2e(e,t).refContainer,n=e.get("center"),r=Math.min(a.width,a.height)/2;this.cx=RXe(n[0],a.width)+a.x,this.cy=RXe(n[1],a.height)+a.y,this.startAngle=e.get("startAngle")*Math.PI/180;var i=e.get("radius");(CGe(i)||EGe(i))&&(i=[0,i]),this.r0=RXe(i[0],r),this.r=RXe(i[1],r),gGe(this._indicatorAxes,function(e,t){e.setExtent(this.r0,this.r);var a=this.startAngle+t*Math.PI*2/this._indicatorAxes.length;a=Math.atan2(Math.sin(a),Math.cos(a)),e.angle=a},this)},e.prototype.update=function(e,t){var a=this._indicatorAxes,n=this._model;gGe(a,function(e){e.scale.setExtent(1/0,-1/0)}),e.eachSeriesByType("radar",function(t,r){if("radar"===t.get("coordinateSystem")&&e.getComponent("radar",t.get("radarIndex"))===n){var i=t.getData();gGe(a,function(e){e.scale.unionExtentFromData(i,i.mapDimension(e.dim))})}},this);var r=n.get("splitNumber"),i=new aet;i.setExtent(0,r),i.setInterval(1),gGe(a,function(e,t){kot(e.scale,e.model,i)})},e.prototype.convertToPixel=function(e,t,a){return console.warn("Not implemented."),null},e.prototype.convertFromPixel=function(e,t,a){return console.warn("Not implemented."),null},e.prototype.containPoint=function(e){return console.warn("Not implemented."),!1},e.create=function(t,a){var n=[];return t.eachComponent("radar",function(r){var i=new e(r,t,a);n.push(i),r.coordinateSystem=i}),t.eachSeriesByType("radar",function(e){"radar"===e.get("coordinateSystem")&&(e.coordinateSystem=n[e.get("radarIndex")||0])}),n},e.dimensions=[],e}();function xst(e){e.registerCoordinateSystem("radar",bst),e.registerComponentModel(vst),e.registerComponentView(gst),e.registerVisual({seriesType:"radar",reset:function(e){var t=e.getData();t.each(function(e){t.setItemVisual(e,"legendIcon","roundRect")}),t.setVisual("legendIcon","roundRect")}})}var wst=v$e();function _st(e,t){return!!wst(e)[t]}Z7e({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},eWe);var Sst={axisPointer:1,tooltip:1,brush:1};function Mst(e,t,a){var n=t.getComponentByElement(e.topTarget);if(!n||n===a||Sst.hasOwnProperty(n.mainType))return!1;var r=n.coordinateSystem;if(!r||r.model===a)return!1;var i=K0e(n),o=K0e(a);return!((i.zlevel-o.zlevel||i.z-o.z)<=0)}var Tst=function(e){function t(t){var a=e.call(this)||this;a._zr=t;var n=SGe(a._mousedownHandler,a),r=SGe(a._mousemoveHandler,a),i=SGe(a._mouseupHandler,a),o=SGe(a._mousewheelHandler,a),s=SGe(a._pinchHandler,a);return a.enable=function(e,a){var l=a.zInfo,c=K0e(l.component),u=c.z,d=c.zlevel,h={component:l.component,z:u,zlevel:d,z2:FGe(l.z2,-1/0)},p=hGe({},a.triggerInfo);this._opt=pGe(hGe({},a),{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0,zInfoParsed:h,triggerInfo:p}),null==e&&(e=!0),this._enabled&&this._controlType===e||(this._enabled=!0,this.disable(),!0!==e&&"move"!==e&&"pan"!==e||(Ist(t,"mousedown",n,h),Ist(t,"mousemove",r,h),Ist(t,"mouseup",i,h)),!0!==e&&"scale"!==e&&"zoom"!==e||(Ist(t,"mousewheel",o,h),Ist(t,"pinch",s,h)))},a.disable=function(){this._enabled=!1,Rst(t,"mousedown",n),Rst(t,"mousemove",r),Rst(t,"mouseup",i),Rst(t,"mousewheel",o),Rst(t,"pinch",s)},a}return zHe(t,e),t.prototype.isDragging=function(){return this._dragging},t.prototype.isPinching=function(){return this._pinching},t.prototype._checkPointer=function(e,t,a){var n=this._opt,r=n.zInfoParsed;if(Mst(e,n.api,r.component))return!1;var i=n.triggerInfo,o=!1;return"global"===i.roamTrigger&&(o=!0),o||(o=i.isInSelf(e,t,a)),o&&i.isInClip&&!i.isInClip(e,t,a)&&(o=!1),o},t.prototype._decideCursorStyle=function(e,t,a,n){var r=e.target;return!r&&this._checkPointer(e,t,a)?"grab":n?r&&r.cursor||"default":void 0},t.prototype.dispose=function(){this.disable()},t.prototype._mousedownHandler=function(e){if(!HWe(e)&&!kst(e)){for(var t=e.target;t;){if(t.draggable)return;t=t.__hostTarget||t.parent}var a=e.offsetX,n=e.offsetY;this._checkPointer(e,a,n)&&(this._x=a,this._y=n,this._dragging=!0)}},t.prototype._mousemoveHandler=function(e){var t=this._zr;if("pinch"!==e.gestureEvent&&!_st(t,"globalPan")&&!kst(e)){var a=e.offsetX,n=e.offsetY;if(this._dragging&&Lst("moveOnMouseMove",e,this._opt)){t.setCursorStyle("grabbing");var r=this._x,i=this._y,o=a-r,s=n-i;this._x=a,this._y=n,this._opt.preventDefaultMouseMove&&VWe(e.event),e.__ecRoamConsumed=!0,Pst(this,"pan","moveOnMouseMove",e,{dx:o,dy:s,oldX:r,oldY:i,newX:a,newY:n,isAvailableBehavior:null})}else{var l=this._decideCursorStyle(e,a,n,!1);l&&t.setCursorStyle(l)}}},t.prototype._mouseupHandler=function(e){if(!kst(e)){var t=this._zr;if(!HWe(e)){this._dragging=!1;var a=this._decideCursorStyle(e,e.offsetX,e.offsetY,!0);a&&t.setCursorStyle(a)}}},t.prototype._mousewheelHandler=function(e){if(!kst(e)){var t=Lst("zoomOnMouseWheel",e,this._opt),a=Lst("moveOnMouseWheel",e,this._opt),n=e.wheelDelta,r=Math.abs(n),i=e.offsetX,o=e.offsetY;if(0!==n&&(t||a)){if(t){var s=r>3?1.4:r>1?1.2:1.1,l=n>0?s:1/s;this._checkTriggerMoveZoom(this,"zoom","zoomOnMouseWheel",e,{scale:l,originX:i,originY:o,isAvailableBehavior:null})}if(a){var c=Math.abs(n),u=(n>0?1:-1)*(c>3?.4:c>1?.15:.05);this._checkTriggerMoveZoom(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:u,originX:i,originY:o,isAvailableBehavior:null})}}}},t.prototype._pinchHandler=function(e){if(!_st(this._zr,"globalPan")&&!kst(e)){var t=e.pinchScale>1?1.1:1/1.1;this._checkTriggerMoveZoom(this,"zoom",null,e,{scale:t,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})}},t.prototype._checkTriggerMoveZoom=function(e,t,a,n,r){e._checkPointer(n,r.originX,r.originY)&&(VWe(n.event),n.__ecRoamConsumed=!0,Pst(e,t,a,n,r))},t}(wWe);function kst(e){return e.__ecRoamConsumed}var Cst,Ast=v$e();function Est(e){var t=Ast(e);return t.roam=t.roam||{},t.uniform=t.uniform||{},t}function Ist(e,t,a,n){for(var r=Est(e).roam,i=r[t]=r[t]||[],o=0;o<i.length;o++){var s=i[o].zInfoParsed;if((s.zlevel-n.zlevel||s.z-n.z||s.z2-n.z2)<=0)break}i.splice(o,0,{listener:a,zInfoParsed:n}),function(e,t){var a=Est(e);a.uniform[t]||e.on(t,a.uniform[t]=function(e){var n=a.roam[t];if(n)for(var r=0;r<n.length;r++)n[r].listener(e)})}(e,t)}function Rst(e,t,a){for(var n=Est(e).roam[t]||[],r=0;r<n.length;r++)if(n[r].listener===a)return n.splice(r,1),void(n.length||Dst(e,t))}function Dst(e,t){var a=Est(e).uniform;a[t]&&(e.off(t,a[t]),a[t]=null)}function Pst(e,t,a,n,r){r.isAvailableBehavior=SGe(Lst,null,a,n),e.trigger(t,r)}function Lst(e,t,a){var n=a[e];return!e||n&&(!CGe(n)||t.event[n+"Key"])}function Nst(e,t,a){var n=e.target;n.x+=t,n.y+=a,n.dirty()}function Ost(e,t,a,n){var r=e.target,i=e.zoomLimit,o=e.zoom=e.zoom||1,s=(o=Vst(o*=t,i))/e.zoom;e.zoom=o,zst(r,a,n,s),r.dirty()}function Fst(e,t,a,n,r,i){var o=new fqe(0,0,0,0);n.enable(e.get("roam"),{api:t,zInfo:{component:e},triggerInfo:{roamTrigger:e.get("roamTrigger"),isInSelf:function(e,t,n){return o.copy(a.getBoundingRect()),o.applyTransform(a.getComputedTransform()),o.contain(t,n)},isInClip:function(e,t,a){return!i||i.contain(t,a)}}}),r.zoomLimit=e.get("scaleLimit");var s=e.coordinateSystem;r.zoom=s?s.getZoom():1;var l=e.subType+"Roam";n.off("pan").off("zoom").on("pan",function(a){Nst(r,a.dx,a.dy),t.dispatchAction({seriesId:e.id,type:l,dx:a.dx,dy:a.dy})}).on("zoom",function(a){Ost(r,a.scale,a.originX,a.originY),t.dispatchAction({seriesId:e.id,type:l,zoom:a.scale,originX:a.originX,originY:a.originY}),t.updateLabelLayout()})}function Bst(e,t){return e.pointToProjected?e.pointToProjected(t):e.pointToData(t)}function Ust(e,t,a){var n=e.getZoom(),r=e.getCenter(),i=t.zoom,o=e.projectedToPoint?e.projectedToPoint(r):e.dataToPoint(r);return null!=t.dx&&null!=t.dy&&(o[0]-=t.dx,o[1]-=t.dy,e.setCenter(Bst(e,o))),null!=i&&(i=Vst(n*i,a)/n,zst(e,t.originX,t.originY,i),e.updateTransform(),e.setCenter(Bst(e,o)),e.setZoom(i*n)),{center:e.getCenter(),zoom:e.getZoom()}}function zst(e,t,a,n){e.x-=(t-e.x)*(n-1),e.y-=(a-e.y)*(n-1),e.scaleX*=n,e.scaleY*=n}function Vst(e,t){if(t){var a=t.min||0,n=t.max||1/0;e=Math.max(Math.min(n,e),a)}return e}function Hst(e){CGe(e)&&(e=(new DOMParser).parseFromString(e,"text/xml"));var t=e;for(9===t.nodeType&&(t=t.firstChild);"svg"!==t.nodeName.toLowerCase()||1!==t.nodeType;)t=t.nextSibling;return t}var Gst={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},Wst=_Ge(Gst),qst={"alignment-baseline":"textBaseline","stop-color":"stopColor"},Yst=_Ge(qst),jst=function(){function e(){this._defs={},this._root=null}return e.prototype.parse=function(e,t){t=t||{};var a=Hst(e);this._defsUsePending=[];var n=new xXe;this._root=n;var r=[],i=a.getAttribute("viewBox")||"",o=parseFloat(a.getAttribute("width")||t.width),s=parseFloat(a.getAttribute("height")||t.height);isNaN(o)&&(o=null),isNaN(s)&&(s=null),Qst(a,n,null,!0,!1);for(var l,c,u=a.firstChild;u;)this._parseNode(u,n,r,null,!1,!1),u=u.nextSibling;if(function(e,t){for(var a=0;a<t.length;a++){var n=t[a];n[0].style[n[1]]=e[n[2]]}}(this._defs,this._defsUsePending),this._defsUsePending=[],i){var d=nlt(i);d.length>=4&&(l={x:parseFloat(d[0]||0),y:parseFloat(d[1]||0),width:parseFloat(d[2]),height:parseFloat(d[3])})}if(l&&null!=o&&null!=s&&(c=llt(l,{x:0,y:0,width:o,height:s}),!t.ignoreViewBox)){var h=n;(n=new xXe).add(h),h.scaleX=h.scaleY=c.scale,h.x=c.x,h.y=c.y}return t.ignoreRootClip||null==o||null==s||n.setClipPath(new EZe({shape:{x:0,y:0,width:o,height:s}})),{root:n,width:o,height:s,viewBoxRect:l,viewBoxTransform:c,named:r}},e.prototype._parseNode=function(e,t,a,n,r,i){var o,s=e.nodeName.toLowerCase(),l=n;if("defs"===s&&(r=!0),"text"===s&&(i=!0),"defs"===s||"switch"===s)o=t;else{if(!r){var c=Cst[s];if(c&&QGe(Cst,s)){o=c.call(this,e,t);var u=e.getAttribute("name");if(u){var d={name:u,namedFrom:null,svgNodeTagLower:s,el:o};a.push(d),"g"===s&&(l=d)}else n&&a.push({name:n.name,namedFrom:n,svgNodeTagLower:s,el:o});t.add(o)}}var h=Xst[s];if(h&&QGe(Xst,s)){var p=h.call(this,e),f=e.getAttribute("id");f&&(this._defs[f]=p)}}if(o&&o.isGroup)for(var m=e.firstChild;m;)1===m.nodeType?this._parseNode(m,o,a,l,r,i):3===m.nodeType&&i&&this._parseText(m,o),m=m.nextSibling},e.prototype._parseText=function(e,t){var a=new bZe({style:{text:e.textContent},silent:!0,x:this._textX||0,y:this._textY||0});Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),function(e,t){var a=t.__selfStyle;if(a){var n=a.textBaseline,r=n;n&&"auto"!==n?"baseline"===n?r="alphabetic":"before-edge"===n||"text-before-edge"===n?r="top":"after-edge"===n||"text-after-edge"===n?r="bottom":"central"!==n&&"mathematical"!==n||(r="middle"):r="alphabetic",e.style.textBaseline=r}var i=t.__inheritedStyle;if(i){var o=i.textAlign,s=o;o&&("middle"===o&&(s="center"),e.style.textAlign=s)}}(a,t);var n=a.style,r=n.fontSize;r&&r<9&&(n.fontSize=9,a.scaleX*=r/9,a.scaleY*=r/9);var i=(n.fontSize||n.fontFamily)&&[n.fontStyle,n.fontWeight,(n.fontSize||12)+"px",n.fontFamily||"sans-serif"].join(" ");n.font=i;var o=a.getBoundingRect();return this._textX+=o.width,t.add(a),a},e.internalField=void(Cst={g:function(e,t){var a=new xXe;return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a},rect:function(e,t){var a=new EZe;return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a.setShape({x:parseFloat(e.getAttribute("x")||"0"),y:parseFloat(e.getAttribute("y")||"0"),width:parseFloat(e.getAttribute("width")||"0"),height:parseFloat(e.getAttribute("height")||"0")}),a.silent=!0,a},circle:function(e,t){var a=new hQe;return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),r:parseFloat(e.getAttribute("r")||"0")}),a.silent=!0,a},line:function(e,t){var a=new UQe;return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a.setShape({x1:parseFloat(e.getAttribute("x1")||"0"),y1:parseFloat(e.getAttribute("y1")||"0"),x2:parseFloat(e.getAttribute("x2")||"0"),y2:parseFloat(e.getAttribute("y2")||"0")}),a.silent=!0,a},ellipse:function(e,t){var a=new fQe;return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a.setShape({cx:parseFloat(e.getAttribute("cx")||"0"),cy:parseFloat(e.getAttribute("cy")||"0"),rx:parseFloat(e.getAttribute("rx")||"0"),ry:parseFloat(e.getAttribute("ry")||"0")}),a.silent=!0,a},polygon:function(e,t){var a,n=e.getAttribute("points");n&&(a=Jst(n));var r=new LQe({shape:{points:a||[]},silent:!0});return Zst(t,r),Qst(e,r,this._defsUsePending,!1,!1),r},polyline:function(e,t){var a,n=e.getAttribute("points");n&&(a=Jst(n));var r=new OQe({shape:{points:a||[]},silent:!0});return Zst(t,r),Qst(e,r,this._defsUsePending,!1,!1),r},image:function(e,t){var a=new _Ze;return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a.setStyle({image:e.getAttribute("xlink:href")||e.getAttribute("href"),x:+e.getAttribute("x"),y:+e.getAttribute("y"),width:+e.getAttribute("width"),height:+e.getAttribute("height")}),a.silent=!0,a},text:function(e,t){var a=e.getAttribute("x")||"0",n=e.getAttribute("y")||"0",r=e.getAttribute("dx")||"0",i=e.getAttribute("dy")||"0";this._textX=parseFloat(a)+parseFloat(r),this._textY=parseFloat(n)+parseFloat(i);var o=new xXe;return Zst(t,o),Qst(e,o,this._defsUsePending,!1,!0),o},tspan:function(e,t){var a=e.getAttribute("x"),n=e.getAttribute("y");null!=a&&(this._textX=parseFloat(a)),null!=n&&(this._textY=parseFloat(n));var r=e.getAttribute("dx")||"0",i=e.getAttribute("dy")||"0",o=new xXe;return Zst(t,o),Qst(e,o,this._defsUsePending,!1,!0),this._textX+=parseFloat(r),this._textY+=parseFloat(i),o},path:function(e,t){var a=cQe(e.getAttribute("d")||"");return Zst(t,a),Qst(e,a,this._defsUsePending,!1,!1),a.silent=!0,a}}),e}(),Xst={lineargradient:function(e){var t=parseInt(e.getAttribute("x1")||"0",10),a=parseInt(e.getAttribute("y1")||"0",10),n=parseInt(e.getAttribute("x2")||"10",10),r=parseInt(e.getAttribute("y2")||"0",10),i=new XQe(t,a,n,r);return $st(e,i),Kst(e,i),i},radialgradient:function(e){var t=parseInt(e.getAttribute("cx")||"0",10),a=parseInt(e.getAttribute("cy")||"0",10),n=parseInt(e.getAttribute("r")||"0",10),r=new $Qe(t,a,n);return $st(e,r),Kst(e,r),r}};function $st(e,t){"userSpaceOnUse"===e.getAttribute("gradientUnits")&&(t.global=!0)}function Kst(e,t){for(var a=e.firstChild;a;){if(1===a.nodeType&&"stop"===a.nodeName.toLocaleLowerCase()){var n=a.getAttribute("offset"),r=void 0;r=n&&n.indexOf("%")>0?parseInt(n,10)/100:n?parseFloat(n):0;var i={};slt(a,i,i);var o=i.stopColor||a.getAttribute("stop-color")||"#000000",s=i.stopOpacity||a.getAttribute("stop-opacity");if(s){var l=EYe(o);l&&l[3]&&(l[3]*=wYe(s),o=NYe(l,"rgba"))}t.colorStops.push({offset:r,color:o})}a=a.nextSibling}}function Zst(e,t){e&&e.__inheritedStyle&&(t.__inheritedStyle||(t.__inheritedStyle={}),pGe(t.__inheritedStyle,e.__inheritedStyle))}function Jst(e){for(var t=nlt(e),a=[],n=0;n<t.length;n+=2){var r=parseFloat(t[n]),i=parseFloat(t[n+1]);a.push([r,i])}return a}function Qst(e,t,a,n,r){var i=t,o=i.__inheritedStyle=i.__inheritedStyle||{},s={};1===e.nodeType&&(function(e,t){var a=e.getAttribute("transform");if(a){a=a.replace(/,/g," ");var n=[],r=null;a.replace(rlt,function(e,t,a){return n.push(t,a),""});for(var i=n.length-1;i>0;i-=2){var o=n[i],s=n[i-1],l=nlt(o);switch(r=r||YWe(),s){case"translate":KWe(r,r,[parseFloat(l[0]),parseFloat(l[1]||"0")]);break;case"scale":JWe(r,r,[parseFloat(l[0]),parseFloat(l[1]||l[0])]);break;case"rotate":ZWe(r,r,-parseFloat(l[0])*ilt,[parseFloat(l[1]||"0"),parseFloat(l[2]||"0")]);break;case"skewX":$We(r,[1,0,Math.tan(parseFloat(l[0])*ilt),1,0,0],r);break;case"skewY":$We(r,[1,Math.tan(parseFloat(l[0])*ilt),0,1,0,0],r);break;case"matrix":r[0]=parseFloat(l[0]),r[1]=parseFloat(l[1]),r[2]=parseFloat(l[2]),r[3]=parseFloat(l[3]),r[4]=parseFloat(l[4]),r[5]=parseFloat(l[5])}}t.setLocalTransform(r)}}(e,t),slt(e,o,s),n||function(e,t,a){for(var n=0;n<Wst.length;n++){var r=Wst[n];null!=(i=e.getAttribute(r))&&(t[Gst[r]]=i)}for(n=0;n<Yst.length;n++){var i;r=Yst[n];null!=(i=e.getAttribute(r))&&(a[qst[r]]=i)}}(e,o,s)),i.style=i.style||{},null!=o.fill&&(i.style.fill=tlt(i,"fill",o.fill,a)),null!=o.stroke&&(i.style.stroke=tlt(i,"stroke",o.stroke,a)),gGe(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(e){null!=o[e]&&(i.style[e]=parseFloat(o[e]))}),gGe(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(e){null!=o[e]&&(i.style[e]=o[e])}),r&&(i.__selfStyle=s),o.lineDash&&(i.style.lineDash=yGe(nlt(o.lineDash),function(e){return parseFloat(e)})),"hidden"!==o.visibility&&"collapse"!==o.visibility||(i.invisible=!0),"none"===o.display&&(i.ignore=!0)}var elt=/^url\(\s*#(.*?)\)/;function tlt(e,t,a,n){var r=a&&a.match(elt);if(!r)return"none"===a&&(a=null),a;var i=HGe(r[1]);n.push([e,t,i])}var alt=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function nlt(e){return e.match(alt)||[]}var rlt=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,ilt=Math.PI/180;var olt=/([^\s:;]+)\s*:\s*([^:;]+)/g;function slt(e,t,a){var n,r=e.getAttribute("style");if(r)for(olt.lastIndex=0;null!=(n=olt.exec(r));){var i=n[1],o=QGe(Gst,i)?Gst[i]:null;o&&(t[o]=n[2]);var s=QGe(qst,i)?qst[i]:null;s&&(a[s]=n[2])}}function llt(e,t){var a=t.width/e.width,n=t.height/e.height,r=Math.min(a,n);return{scale:r,x:-(e.x+e.width/2)*r+(t.x+t.width/2),y:-(e.y+e.height/2)*r+(t.y+t.height/2)}}var clt=$Ge(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),ult=function(){function e(e,t){this.type="geoSVG",this._usedGraphicMap=$Ge(),this._freedGraphics=[],this._mapName=e,this._parsedXML=Hst(t)}return e.prototype.load=function(){var e=this._firstGraphic;if(!e){e=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(e),this._boundingRect=this._firstGraphic.boundingRect.clone();var t=function(e){var t=[],a=$Ge();return gGe(e,function(e){if(null==e.namedFrom){var n=new ctt(e.name,e.el);t.push(n),a.set(e.name,n)}}),{regions:t,regionsMap:a}}(e.named),a=t.regions,n=t.regionsMap;this._regions=a,this._regionsMap=n}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},e.prototype._buildGraphic=function(e){var t,a;try{t=e&&function(e,t){return(new jst).parse(e,t)}(e,{ignoreViewBox:!0,ignoreRootClip:!0})||{},VGe(null!=(a=t.root))}catch(TQe){throw new Error("Invalid svg format\n"+TQe.message)}var n=new xXe;n.add(a),n.isGeoSVGGraphicRoot=!0;var r=t.width,i=t.height,o=t.viewBoxRect,s=this._boundingRect;if(!s){var l=void 0,c=void 0,u=void 0,d=void 0;if(null!=r?(l=0,u=r):o&&(l=o.x,u=o.width),null!=i?(c=0,d=i):o&&(c=o.y,d=o.height),null==l||null==c){var h=a.getBoundingRect();null==l&&(l=h.x,u=h.width),null==c&&(c=h.y,d=h.height)}s=this._boundingRect=new fqe(l,c,u,d)}if(o){var p=llt(o,s);a.scaleX=a.scaleY=p.scale,a.x=p.x,a.y=p.y}n.setClipPath(new EZe({shape:s.plain()}));var f=[];return gGe(t.named,function(e){var t;null!=clt.get(e.svgNodeTagLower)&&(f.push(e),(t=e.el).silent=!1,t.isGroup&&t.traverse(function(e){e.silent=!1}))}),{root:n,boundingRect:s,named:f}},e.prototype.useGraphic=function(e){var t=this._usedGraphicMap,a=t.get(e);return a||(a=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),t.set(e,a),a)},e.prototype.freeGraphic=function(e){var t=this._usedGraphicMap,a=t.get(e);a&&(t.removeKey(e),this._freedGraphics.push(a))},e}();for(var dlt=[126,25],hlt="南海诸岛",plt=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],flt=0;flt<plt.length;flt++)for(var mlt=0;mlt<plt[flt].length;mlt++)plt[flt][mlt][0]/=10.5,plt[flt][mlt][1]/=-14,plt[flt][mlt][0]+=dlt[0],plt[flt][mlt][1]+=dlt[1];var vlt={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]};var glt=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];var ylt=function(){function e(e,t,a){var n;this.type="geoJSON",this._parsedMap=$Ge(),this._mapName=e,this._specialAreas=a,this._geoJSON=CGe(n=t)?"undefined"!=typeof JSON&&JSON.parse?JSON.parse(n):new Function("return ("+n+");")():n}return e.prototype.load=function(e,t){t=t||"name";var a=this._parsedMap.get(t);if(!a){var n=this._parseToRegions(t);a=this._parsedMap.set(t,{regions:n,boundingRect:blt(n)})}var r=$Ge(),i=[];return gGe(a.regions,function(t){var a=t.name;e&&QGe(e,a)&&(t=t.cloneShallow(a=e[a])),i.push(t),r.set(a,t)}),{regions:i,boundingRect:a.boundingRect||new fqe(0,0,0,0),regionsMap:r}},e.prototype._parseToRegions=function(e){var t,a=this._mapName,n=this._geoJSON;try{t=n?htt(n,e):[]}catch(TQe){throw new Error("Invalid geoJson format\n"+TQe.message)}return function(e,t){if("china"===e){for(var a=0;a<t.length;a++)if(t[a].name===hlt)return;t.push(new ltt(hlt,yGe(plt,function(e){return{type:"polygon",exterior:e}}),dlt))}}(a,t),gGe(t,function(e){var t=e.name;!function(e,t){if("china"===e){var a=vlt[t.name];if(a){var n=t.getCenter();n[0]+=a[0]/10.5,n[1]+=-a[1]/14,t.setCenter(n)}}}(a,e),function(e,t){"china"===e&&"台湾"===t.name&&t.geometries.push({type:"polygon",exterior:glt[0]})}(a,e);var n=this._specialAreas&&this._specialAreas[t];n&&e.transformTo(n.left,n.top,n.width,n.height)},this),t},e.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},e}();function blt(e){for(var t,a=0;a<e.length;a++){var n=e[a].getBoundingRect();(t=t||n.clone()).union(n)}return t}var xlt=$Ge();const wlt=function(e,t,a){if(t.svg){var n=new ult(e,t.svg);xlt.set(e,n)}else{var r=t.geoJson||t.geoJSON;r&&!t.features?a=t.specialAreas:r=t;n=new ylt(e,r,a);xlt.set(e,n)}},_lt=function(e){return xlt.get(e)},Slt=function(e){var t=xlt.get(e);return t&&"geoJSON"===t.type&&t.getMapForUser()},Mlt=function(e,t,a){var n=xlt.get(e);if(n)return n.load(t,a)};var Tlt=["rect","circle","line","ellipse","polygon","polyline","path"],klt=$Ge(Tlt),Clt=$Ge(Tlt.concat(["g"])),Alt=$Ge(Tlt.concat(["g"])),Elt=v$e();function Ilt(e){var t=e.getItemStyle(),a=e.get("areaColor");return null!=a&&(t.fill=a),t}function Rlt(e){var t=e.style;t&&(t.stroke=t.stroke||t.fill,t.fill=null)}var Dlt=function(){function e(e){var t=this.group=new xXe,a=this._transformGroup=new xXe;t.add(a),this.uid=R1e("ec_map_draw"),this._controller=new Tst(e.getZr()),this._controllerHost={target:a},a.add(this._regionsGroup=new xXe),a.add(this._svgGroup=new xXe)}return e.prototype.draw=function(e,t,a,n,r){var i="geo"===e.mainType,o=e.getData&&e.getData();i&&t.eachComponent({mainType:"series",subType:"map"},function(t){o||t.getHostGeoModel()!==e||(o=t.getData())});var s,l=e.coordinateSystem,c=this._regionsGroup,u=this._transformGroup,d=l.getTransformInfo(),h=d.raw,p=d.roam,f=!c.childAt(0)||r;e.getShallow("clip",!0)?(s=l.getViewRect().clone(),this.group.setClipPath(new EZe({shape:s.clone()}))):this.group.removeClipPath(),f?(u.x=p.x,u.y=p.y,u.scaleX=p.scaleX,u.scaleY=p.scaleY,u.dirty()):u0e(u,p,e);var m=o&&o.getVisual("visualMeta")&&o.getVisual("visualMeta").length>0,v={api:a,geo:l,mapOrGeoModel:e,data:o,isVisualEncodedByVisualMap:m,isGeo:i,transformInfoRaw:h};"geoJSON"===l.resourceType?this._buildGeoJSON(v):"geoSVG"===l.resourceType&&this._buildSVG(v),this._updateController(e,s,t,a),this._updateMapSelectHandler(e,c,a,n)},e.prototype._buildGeoJSON=function(e){var t=this._regionsGroupByName=$Ge(),a=$Ge(),n=this._regionsGroup,r=e.transformInfoRaw,i=e.mapOrGeoModel,o=e.data,s=e.geo.projection,l=s&&s.stream;function c(e,t){return t&&(e=t(e)),e&&[e[0]*r.scaleX+r.x,e[1]*r.scaleY+r.y]}function u(e){for(var t=[],a=!l&&s&&s.project,n=0;n<e.length;++n){var r=c(e[n],a);r&&t.push(r)}return t}function d(e){return{shape:{points:u(e)}}}n.removeAll(),gGe(e.geo.regions,function(r){var u=r.name,h=t.get(u),p=a.get(u)||{},f=p.dataIdx,m=p.regionModel;if(!h){h=t.set(u,new xXe),n.add(h),f=o?o.indexOfName(u):null;var v=(m=e.isGeo?i.getRegionModel(u):o?o.getItemModel(f):null).get("silent",!0);null!=v&&(h.silent=v),a.set(u,{dataIdx:f,regionModel:m})}var g=[],y=[];gGe(r.geometries,function(e){if("polygon"===e.type){var t=[e.exterior].concat(e.interiors||[]);l&&(t=Blt(t,l)),gGe(t,function(e){g.push(new LQe(d(e)))})}else{var a=e.points;l&&(a=Blt(a,l,!0)),gGe(a,function(e){y.push(new OQe(d(e)))})}});var b=c(r.getCenter(),s&&s.project);function x(t,a){if(t.length){var n=new YQe({culling:!0,segmentIgnoreThreshold:1,shape:{paths:t}});h.add(n),Plt(e,n,f,m),Llt(e,n,u,m,i,f,b),a&&(Rlt(n),gGe(n.states,Rlt))}}x(g),x(y,!0)}),t.each(function(t,n){var r=a.get(n),o=r.dataIdx,s=r.regionModel;Nlt(e,t,n,s,i,o),Olt(e,t,n,s,i),Flt(e,t,n,s,i)},this)},e.prototype._buildSVG=function(e){var t=e.geo.map,a=e.transformInfoRaw;this._svgGroup.x=a.x,this._svgGroup.y=a.y,this._svgGroup.scaleX=a.scaleX,this._svgGroup.scaleY=a.scaleY,this._svgResourceChanged(t)&&(this._freeSVG(),this._useSVG(t));var n=this._svgDispatcherMap=$Ge(),r=!1;gGe(this._svgGraphicRecord.named,function(t){var a=t.name,i=e.mapOrGeoModel,o=e.data,s=t.svgNodeTagLower,l=t.el,c=o?o.indexOfName(a):null,u=i.getRegionModel(a);null!=klt.get(s)&&l instanceof fKe&&Plt(e,l,c,u),l instanceof fKe&&(l.culling=!0);var d=u.get("silent",!0);(null!=d&&(l.silent=d),l.z2EmphasisLift=0,t.namedFrom)||(null!=Alt.get(s)&&Llt(e,l,a,u,i,c,null),Nlt(e,l,a,u,i,c),Olt(e,l,a,u,i),null!=Clt.get(s)&&("self"===Flt(e,l,a,u,i)&&(r=!0),(n.get(a)||n.set(a,[])).push(l)))},this),this._enableBlurEntireSVG(r,e)},e.prototype._enableBlurEntireSVG=function(e,t){if(e&&t.isGeo){var a=t.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle().opacity;this._svgGraphicRecord.root.traverse(function(e){if(!e.isGroup){bJe(e);var t=e.ensureState("blur").style||{};null==t.opacity&&null!=a&&(t.opacity=a),e.ensureState("emphasis")}})}},e.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},e.prototype.findHighDownDispatchers=function(e,t){if(null==e)return[];var a=t.coordinateSystem;if("geoJSON"===a.resourceType){var n=this._regionsGroupByName;if(n){var r=n.get(e);return r?[r]:[]}}else if("geoSVG"===a.resourceType)return this._svgDispatcherMap&&this._svgDispatcherMap.get(e)||[]},e.prototype._svgResourceChanged=function(e){return this._svgMapName!==e},e.prototype._useSVG=function(e){var t=_lt(e);if(t&&"geoSVG"===t.type){var a=t.useGraphic(this.uid);this._svgGroup.add(a.root),this._svgGraphicRecord=a,this._svgMapName=e}},e.prototype._freeSVG=function(){var e=this._svgMapName;if(null!=e){var t=_lt(e);t&&"geoSVG"===t.type&&t.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},e.prototype._updateController=function(e,t,a,n){var r=e.coordinateSystem,i=this._controller,o=this._controllerHost;o.zoomLimit=e.get("scaleLimit"),o.zoom=r.getZoom(),i.enable(e.get("roam")||!1,{api:n,zInfo:{component:e},triggerInfo:{roamTrigger:e.get("roamTrigger"),isInSelf:function(e,t,a){return r.containPoint([t,a])},isInClip:function(e,a,n){return!t||t.contain(a,n)}}});var s=e.mainType;function l(){var t={type:"geoRoam",componentType:s};return t[s+"Id"]=e.id,t}i.off("pan").on("pan",function(e){this._mouseDownFlag=!1,Nst(o,e.dx,e.dy),n.dispatchAction(hGe(l(),{dx:e.dx,dy:e.dy,animation:{duration:0}}))},this),i.off("zoom").on("zoom",function(e){this._mouseDownFlag=!1,Ost(o,e.scale,e.originX,e.originY),n.dispatchAction(hGe(l(),{totalZoom:o.zoom,zoom:e.scale,originX:e.originX,originY:e.originY,animation:{duration:0}}))},this)},e.prototype.resetForLabelLayout=function(){this.group.traverse(function(e){var t=e.getTextContent();t&&(t.ignore=Elt(t).ignore)})},e.prototype._updateMapSelectHandler=function(e,t,a,n){var r=this;t.off("mousedown"),t.off("click"),e.get("selectedMode")&&(t.on("mousedown",function(){r._mouseDownFlag=!0}),t.on("click",function(e){r._mouseDownFlag&&(r._mouseDownFlag=!1)}))},e}();function Plt(e,t,a,n){var r=n.getModel("itemStyle"),i=n.getModel(["emphasis","itemStyle"]),o=n.getModel(["blur","itemStyle"]),s=n.getModel(["select","itemStyle"]),l=Ilt(r),c=Ilt(i),u=Ilt(s),d=Ilt(o),h=e.data;if(h){var p=h.getItemVisual(a,"style"),f=h.getItemVisual(a,"decal");e.isVisualEncodedByVisualMap&&p.fill&&(l.fill=p.fill),f&&(l.decal=q8e(f,e.api))}t.setStyle(l),t.style.strokeNoScale=!0,t.ensureState("emphasis").style=c,t.ensureState("select").style=u,t.ensureState("blur").style=d,bJe(t)}function Llt(e,t,a,n,r,i,o){var s=e.data,l=e.isGeo,c=s&&isNaN(s.get(s.mapDimension("value"),i)),u=s&&s.getItemLayout(i);if(l||c||u&&u.showLabel){var d=l?a:i,h=void 0;(!s||i>=0)&&(h=r);var p=o?{normal:{align:"center",verticalAlign:"middle"}}:null;r1e(t,i1e(n),{labelFetcher:h,labelDataIndex:d,defaultText:a},p);var f=t.getTextContent();if(f&&(Elt(f).ignore=f.ignore,t.textConfig&&o)){var m=t.getBoundingRect().clone();t.textConfig.layoutRect=m,t.textConfig.position=[(o[0]-m.x)/m.width*100+"%",(o[1]-m.y)/m.height*100+"%"]}t.disableLabelAnimation=!0}else t.removeTextContent(),t.removeTextConfig(),t.disableLabelAnimation=null}function Nlt(e,t,a,n,r,i){e.data?e.data.setItemGraphicEl(i,t):YZe(t).eventData={componentType:"geo",componentIndex:r.componentIndex,geoIndex:r.componentIndex,name:a,region:n&&n.option||{}}}function Olt(e,t,a,n,r){e.data||G0e({el:t,componentModel:r,itemName:a,itemTooltipOption:n.get("tooltip")})}function Flt(e,t,a,n,r){t.highDownSilentOnTouch=!!r.get("selectedMode");var i=n.getModel("emphasis"),o=i.get("focus");return OJe(t,o,i.get("blurScope"),i.get("disabled")),e.isGeo&&function(e,t,a){var n=YZe(e);n.componentMainType=t.mainType,n.componentIndex=t.componentIndex,n.componentHighDownName=a}(t,r,a),o}function Blt(e,t,a){var n,r=[];function i(){n=[]}function o(){n.length&&(r.push(n),n=[])}var s=t({polygonStart:i,polygonEnd:o,lineStart:i,lineEnd:o,point:function(e,t){isFinite(e)&&isFinite(t)&&n.push([e,t])},sphere:function(){}});return!a&&s.polygonStart(),gGe(e,function(e){s.lineStart();for(var t=0;t<e.length;t++)s.point(e[t][0],e[t][1]);s.lineEnd()}),!a&&s.polygonEnd(),r}var Ult=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a,n){if(!n||"mapToggleSelect"!==n.type||n.from!==this.uid){var r=this.group;if(r.removeAll(),!e.getHostGeoModel()){if(this._mapDraw&&n&&"geoRoam"===n.type&&this._mapDraw.resetForLabelLayout(),n&&"geoRoam"===n.type&&"series"===n.componentType&&n.seriesId===e.id)(i=this._mapDraw)&&r.add(i.group);else if(e.needsDrawMap){var i=this._mapDraw||new Dlt(a);r.add(i.group),i.draw(e,t,a,this,n),this._mapDraw=i}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;e.get("showLegendSymbol")&&t.getComponent("legend")&&this._renderSymbols(e,t,a)}}},t.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},t.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},t.prototype._renderSymbols=function(e,t,a){var n=e.originalData,r=this.group;n.each(n.mapDimension("value"),function(t,a){if(!isNaN(t)){var i=n.getItemLayout(a);if(i&&i.point){var o=i.point,s=i.offset,l=new hQe({style:{fill:e.getData().getVisual("style").fill},shape:{cx:o[0]+9*s,cy:o[1],r:3},silent:!0,z2:8+(s?0:11)});if(!s){var c=e.mainSeries.getData(),u=n.getName(a),d=c.indexOfName(u),h=n.getItemModel(a),p=h.getModel("label"),f=c.getItemGraphicEl(d);r1e(l,i1e(h),{labelFetcher:{getFormattedLabel:function(t,a){return e.getFormattedLabel(d,a)}},defaultText:u}),l.disableLabelAnimation=!0,p.get("position")||l.setTextConfig({position:"bottom"}),f.onHoverStateChange=function(e){gJe(l,e)}}r.add(l)}}})},t.type="map",t}(s6e),zlt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.needsDrawMap=!1,a.seriesGroup=[],a.getTooltipPosition=function(e){if(null!=e){var t=this.getData().getName(e),a=this.coordinateSystem,n=a.getRegion(t);return n&&a.dataToPoint(n.getCenter())}},a}return zHe(t,e),t.prototype.getInitialData=function(e){for(var t=yit(this,{coordDimensions:["value"],encodeDefaulter:MGe(E5e,this)}),a=$Ge(),n=[],r=0,i=t.count();r<i;r++){var o=t.getName(r);a.set(o,r)}return gGe(Mlt(this.getMapType(),this.option.nameMap,this.option.nameProperty).regions,function(e){var r,i=e.name,o=a.get(i),s=e.properties&&e.properties.echartsStyle;null==o?(r={name:i},n.push(r)):r=t.getRawDataItem(o),s&&uGe(r,s)}),t.appendData(n),t},t.prototype.getHostGeoModel=function(){if(U2e(this).kind!==B2e)return this.getReferringComponents("geo",{useDefault:!1,enableAll:!1,enableNone:!1}).models[0]},t.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},t.prototype.getRawValue=function(e){var t=this.getData();return t.get(t.mapDimension("value"),e)},t.prototype.getRegionModel=function(e){var t=this.getData();return t.getItemModel(t.indexOfName(e))},t.prototype.formatTooltip=function(e,t,a){for(var n=this.getData(),r=this.getRawValue(e),i=n.getName(e),o=this.seriesGroup,s=[],l=0;l<o.length;l++){var c=o[l].originalData.indexOfName(i),u=n.mapDimension("value");isNaN(o[l].originalData.get(u,c))||s.push(o[l].name)}return P3e("section",{header:s.join(", "),noHeader:!s.length,blocks:[P3e("nameValue",{name:i,value:r})]})},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.getLegendIcon=function(e){var t=e.icon||"roundRect",a=y8e(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill);return a.setStyle(e.itemStyle),a.style.stroke="none",t.indexOf("empty")>-1&&(a.style.stroke=a.style.fill,a.style.fill=o5e.color.neutral00,a.style.lineWidth=2),a},t.type="series.map",t.dependencies=["geo"],t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:o5e.color.tertiary},itemStyle:{borderWidth:.5,borderColor:o5e.color.border,areaColor:o5e.color.background},emphasis:{label:{show:!0,color:o5e.color.primary},itemStyle:{areaColor:o5e.color.highlight}},select:{label:{show:!0,color:o5e.color.primary},itemStyle:{color:o5e.color.highlight}},nameProperty:"name"},t}($3e);function Vlt(e){var t={};e.eachSeriesByType("map",function(e){var a=e.getHostGeoModel(),n=a?"o"+a.id:"i"+e.getMapType();(t[n]=t[n]||[]).push(e)}),gGe(t,function(e,t){for(var a,n,r,i=(a=yGe(e,function(e){return e.getData()}),n=e[0].get("mapValueCalculation"),r={},gGe(a,function(e){e.each(e.mapDimension("value"),function(t,a){var n="ec-"+e.getName(a);r[n]=r[n]||[],isNaN(t)||r[n].push(t)})}),a[0].map(a[0].mapDimension("value"),function(e,t){for(var i="ec-"+a[0].getName(t),o=0,s=1/0,l=-1/0,c=r[i].length,u=0;u<c;u++)s=Math.min(s,r[i][u]),l=Math.max(l,r[i][u]),o+=r[i][u];return 0===c?NaN:"min"===n?s:"max"===n?l:"average"===n?o/c:o})),o=0;o<e.length;o++)e[o].originalData=e[o].getData();for(o=0;o<e.length;o++)e[o].seriesGroup=e,e[o].needsDrawMap=0===o&&!e[o].getHostGeoModel(),e[o].setData(i.cloneShallow()),e[o].mainSeries=e[0]})}function Hlt(e){var t={};e.eachSeriesByType("map",function(a){var n=a.getMapType();if(!a.getHostGeoModel()&&!t[n]){var r={};gGe(a.seriesGroup,function(t){var a=t.coordinateSystem,n=t.originalData;t.get("showLegendSymbol")&&e.getComponent("legend")&&n.each(n.mapDimension("value"),function(e,t){var i=n.getName(t),o=a.getRegion(i);if(o&&!isNaN(e)){var s=r[i]||0,l=a.dataToPoint(o.getCenter());r[i]=s+1,n.setItemLayout(t,{point:l,offset:s})}})});var i=a.getData();i.each(function(e){var t=i.getName(e),a=i.getItemLayout(e)||{};a.showLabel=!r[t],i.setItemLayout(e,a)}),t[n]=!0}})}var Glt=vWe,Wlt=function(e){function t(t,a){var n=e.call(this)||this;return n.type="view",n.dimensions=["x","y"],n._roamTransformable=new Xje,n._rawTransformable=new Xje,n.name=t,n._opt=a,n}return zHe(t,e),t.prototype.setBoundingRect=function(e,t,a,n){return this._rect=new fqe(e,t,a,n),this._updateCenterAndZoom(),this._rect},t.prototype.getBoundingRect=function(){return this._rect},t.prototype.setViewRect=function(e,t,a,n){this._transformTo(e,t,a,n),this._viewRect=new fqe(e,t,a,n)},t.prototype._transformTo=function(e,t,a,n){var r=this.getBoundingRect(),i=this._rawTransformable;i.transform=r.calculateTransform(new fqe(e,t,a,n));var o=i.parent;i.parent=null,i.decomposeTransform(),i.parent=o,this._updateTransform()},t.prototype.setCenter=function(e){var t=this._opt;t&&t.api&&t.ecModel&&t.ecModel.getShallow("legacyViewCoordSysCenterBase")&&e&&(e=[RXe(e[0],t.api.getWidth()),RXe(e[1],t.api.getWidth())]),this._centerOption=cGe(e),this._updateCenterAndZoom()},t.prototype.setZoom=function(e){this._zoom=Vst(e||1,this.zoomLimit),this._updateCenterAndZoom()},t.prototype.getDefaultCenter=function(){var e=this.getBoundingRect();return[e.x+e.width/2,e.y+e.height/2]},t.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},t.prototype.getZoom=function(){return this._zoom||1},t.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},t.prototype._updateCenterAndZoom=function(){var e=this._centerOption,t=this._rect;e&&t&&(this._center=[RXe(e[0],t.width,t.x),RXe(e[1],t.height,t.y)]);var a=this._rawTransformable.getLocalTransform(),n=this._roamTransformable,r=this.getDefaultCenter(),i=this.getCenter(),o=this.getZoom();i=vWe([],i,a),r=vWe([],r,a),n.originX=i[0],n.originY=i[1],n.x=r[0]-i[0],n.y=r[1]-i[1],n.scaleX=n.scaleY=o,this._updateTransform()},t.prototype._updateTransform=function(){var e=this._roamTransformable,t=this._rawTransformable;t.parent=e,e.updateTransform(),t.updateTransform(),XWe(this.transform||(this.transform=[]),t.transform||[1,0,0,1,0,0]),this._rawTransform=t.getLocalTransform(),this.invTransform=this.invTransform||[],QWe(this.invTransform,this.transform),this.decomposeTransform()},t.prototype.getTransformInfo=function(){var e=this._rawTransformable,t=this._roamTransformable,a=new Xje;return a.transform=t.transform,a.decomposeTransform(),{roam:{x:a.x,y:a.y,scaleX:a.scaleX,scaleY:a.scaleY},raw:{x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY}}},t.prototype.getViewRect=function(){return this._viewRect},t.prototype.getViewRectAfterRoam=function(){var e=this.getBoundingRect().clone();return e.applyTransform(this.transform),e},t.prototype.dataToPoint=function(e,t,a){var n=t?this._rawTransform:this.transform;return a=a||[],n?Glt(a,e,n):nWe(a,e)},t.prototype.pointToData=function(e,t,a){a=a||[];var n=this.invTransform;return n?Glt(a,e,n):(a[0]=e[0],a[1]=e[1],a)},t.prototype.convertToPixel=function(e,t,a){var n=qlt(t);return n===this?n.dataToPoint(a):null},t.prototype.convertFromPixel=function(e,t,a){var n=qlt(t);return n===this?n.pointToData(a):null},t.prototype.containPoint=function(e){return this.getViewRectAfterRoam().contain(e[0],e[1])},t.dimensions=["x","y"],t}(Xje);function qlt(e){var t=e.seriesModel;return t?t.coordinateSystem:null}var Ylt={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},jlt=["lng","lat"],Xlt=function(e){function t(t,a,n){var r=e.call(this,t,{api:n.api,ecModel:n.ecModel})||this;r.dimensions=jlt,r.type="geo",r._nameCoordMap=$Ge(),r.map=a;var i=n.projection,o=Mlt(a,n.nameMap,n.nameProperty),s=_lt(a);r.resourceType=s?s.type:null;var l,c=r.regions=o.regions,u=Ylt[s.type];if(r._regionsMap=o.regionsMap,r.regions=o.regions,r.projection=i,i)for(var d=0;d<c.length;d++){var h=c[d].getBoundingRect(i);(l=l||h.clone()).union(h)}else l=o.boundingRect;return r.setBoundingRect(l.x,l.y,l.width,l.height),r.aspectScale=i?1:FGe(n.aspectScale,u.aspectScale),r._invertLongitute=!i&&u.invertLongitute,r}return zHe(t,e),t.prototype._transformTo=function(e,t,a,n){var r=this.getBoundingRect(),i=this._invertLongitute;r=r.clone(),i&&(r.y=-r.y-r.height);var o=this._rawTransformable;o.transform=r.calculateTransform(new fqe(e,t,a,n));var s=o.parent;o.parent=null,o.decomposeTransform(),o.parent=s,i&&(o.scaleY=-o.scaleY),this._updateTransform()},t.prototype.getRegion=function(e){return this._regionsMap.get(e)},t.prototype.getRegionByCoord=function(e){for(var t=this.regions,a=0;a<t.length;a++){var n=t[a];if("geoJSON"===n.type&&n.contain(e))return t[a]}},t.prototype.addGeoCoord=function(e,t){this._nameCoordMap.set(e,t)},t.prototype.getGeoCoord=function(e){var t=this._regionsMap.get(e);return this._nameCoordMap.get(e)||t&&t.getCenter()},t.prototype.dataToPoint=function(e,t,a){if(CGe(e)&&(e=this.getGeoCoord(e)),e){var n=this.projection;return n&&(e=n.project(e)),e&&this.projectedToPoint(e,t,a)}},t.prototype.pointToData=function(e,t,a){var n=this.projection;return n&&(e=n.unproject(e)),e&&this.pointToProjected(e,a)},t.prototype.pointToProjected=function(t,a){return e.prototype.pointToData.call(this,t,0,a)},t.prototype.projectedToPoint=function(t,a,n){return e.prototype.dataToPoint.call(this,t,a,n)},t.prototype.convertToPixel=function(e,t,a){var n=$lt(t);return n===this?n.dataToPoint(a):null},t.prototype.convertFromPixel=function(e,t,a){var n=$lt(t);return n===this?n.pointToData(a):null},t}(Wlt);function $lt(e){var t=e.geoModel,a=e.seriesModel;return t?t.coordinateSystem:a?a.coordinateSystem||(a.getReferringComponents("geo",x$e).models[0]||{}).coordinateSystem:null}function Klt(e,t){var a=e.get("boundingCoords");if(null!=a){var n=a[0],r=a[1];if(isFinite(n[0])&&isFinite(n[1])&&isFinite(r[0])&&isFinite(r[1])){var i=this.projection;if(i){var o=n[0],s=n[1],l=r[0],c=r[1];n=[1/0,1/0],r=[-1/0,-1/0];var u=function(e,t,a,o){for(var s=a-e,l=o-t,c=0;c<=100;c++){var u=c/100,d=i.project([e+s*u,t+l*u]);gWe(n,n,d),yWe(r,r,d)}};u(o,s,l,s),u(l,s,l,c),u(l,c,o,c),u(o,c,l,s)}this.setBoundingRect(n[0],n[1],r[0]-n[0],r[1]-n[1])}else;}var d,h,p,f=this.getBoundingRect(),m=e.get("layoutCenter"),v=e.get("layoutSize"),g=J2e(e,t).refContainer,y=f.width/f.height*this.aspectScale,b=!1;if(m&&v&&(d=[RXe(m[0],g.width)+g.x,RXe(m[1],g.height)+g.y],h=RXe(v,Math.min(g.width,g.height)),isNaN(d[0])||isNaN(d[1])||isNaN(h)||(b=!0)),b)p={},y>1?(p.width=h,p.height=h/y):(p.height=h,p.width=h*y),p.y=d[1]-p.height/2,p.x=d[0]-p.width/2;else{var x=e.getBoxLayoutParams();x.aspect=y,p=K2e(e,p=$2e(x,g),y)}this.setViewRect(p.x,p.y,p.width,p.height),this.setCenter(e.get("center")),this.setZoom(e.get("zoom"))}mGe(Xlt,Wlt);var Zlt=function(){function e(){this.dimensions=jlt}return e.prototype.create=function(e,t){var a=[];function n(e){return{nameProperty:e.get("nameProperty"),aspectScale:e.get("aspectScale"),projection:e.get("projection")}}e.eachComponent("geo",function(r,i){var o=r.get("map"),s=new Xlt(o+i,o,hGe({nameMap:r.get("nameMap"),api:t,ecModel:e},n(r)));s.zoomLimit=r.get("scaleLimit"),a.push(s),r.coordinateSystem=s,s.model=r,s.resize=Klt,s.resize(r,t)}),e.eachSeries(function(e){z2e({targetModel:e,coordSysType:"geo",coordSysProvider:function(){var t="map"===e.subType?e.getHostGeoModel():e.getReferringComponents("geo",x$e).models[0];return t&&t.coordinateSystem},allowNotFound:!0})});var r={};return e.eachSeriesByType("map",function(e){if(!e.getHostGeoModel()){var t=e.getMapType();r[t]=r[t]||[],r[t].push(e)}}),gGe(r,function(r,i){var o=yGe(r,function(e){return e.get("nameMap")}),s=new Xlt(i,i,hGe({nameMap:dGe(o),api:t,ecModel:e},n(r[0])));s.zoomLimit=OGe.apply(null,yGe(r,function(e){return e.get("scaleLimit")})),a.push(s),s.resize=Klt,s.resize(r[0],t),gGe(r,function(e){e.coordinateSystem=s,function(e,t){gGe(t.get("geoCoord"),function(t,a){e.addGeoCoord(a,t)})}(s,e)})}),a},e.prototype.getFilledRegions=function(e,t,a,n){for(var r=(e||[]).slice(),i=$Ge(),o=0;o<r.length;o++)i.set(r[o].name,r[o]);return gGe(Mlt(t,a,n).regions,function(e){var t=e.name,a=i.get(t),n=e.properties&&e.properties.echartsStyle;a||(a={name:t},r.push(a)),n&&uGe(a,n)}),r},e}(),Jlt=new Zlt,Qlt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a);var n=_lt(e.map);if(n&&"geoJSON"===n.type){var r=e.itemStyle=e.itemStyle||{};"color"in r||(r.color=e.defaultItemStyleColor||o5e.color.backgroundTint)}i$e(e,"label",["show"])},t.prototype.optionUpdated=function(){var e=this,t=this.option;t.regions=Jlt.getFilledRegions(t.regions,t.map,t.nameMap,t.nameProperty);var a={};this._optionModelMap=bGe(t.regions||[],function(t,n){var r=n.name;return r&&(t.set(r,new E1e(n,e,e.ecModel)),n.selected&&(a[r]=!0)),t},$Ge()),t.selectedMap||(t.selectedMap=a)},t.prototype.getRegionModel=function(e){return this._optionModelMap.get(e)||new E1e(null,this,this.ecModel)},t.prototype.getFormattedLabel=function(e,t){var a=this.getRegionModel(e),n="normal"===t?a.get(["label","formatter"]):a.get(["emphasis","label","formatter"]),r={name:e};return kGe(n)?(r.status=t,n(r)):CGe(n)?n.replace("{a}",null!=e?e:""):void 0},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.select=function(e){var t=this.option,a=t.selectedMode;a&&("multiple"!==a&&(t.selectedMap=null),(t.selectedMap||(t.selectedMap={}))[e]=!0)},t.prototype.unSelect=function(e){var t=this.option.selectedMap;t&&(t[e]=!1)},t.prototype.toggleSelected=function(e){this[this.isSelected(e)?"unSelect":"select"](e)},t.prototype.isSelected=function(e){var t=this.option.selectedMap;return!(!t||!t[e])},t.type="geo",t.layoutMode="box",t.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:o5e.color.tertiary},itemStyle:{borderWidth:.5,borderColor:o5e.color.border},emphasis:{label:{show:!0,color:o5e.color.primary},itemStyle:{color:o5e.color.highlight}},select:{label:{show:!0,color:o5e.color.primary},itemStyle:{color:o5e.color.highlight}},regions:[]},t}(i5e),ect=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.focusBlurEnabled=!0,a}return zHe(t,e),t.prototype.init=function(e,t){this._api=t},t.prototype.render=function(e,t,a,n){if(this._model=e,!e.get("show"))return this._mapDraw&&this._mapDraw.remove(),void(this._mapDraw=null);this._mapDraw||(this._mapDraw=new Dlt(a));var r=this._mapDraw;r.draw(e,t,a,this,n),r.group.on("click",this._handleRegionClick,this),r.group.silent=e.get("silent"),this.group.add(r.group),this.updateSelectStatus(e,t,a)},t.prototype._handleRegionClick=function(e){var t;o8e(e.target,function(e){return null!=(t=YZe(e).eventData)},!0),t&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:t.name})},t.prototype.updateSelectStatus=function(e,t,a){var n=this;this._mapDraw.group.traverse(function(e){var t=YZe(e).eventData;if(t)return n._model.isSelected(t.name)?a.enterSelect(e):a.leaveSelect(e),!0})},t.prototype.findHighDownDispatchers=function(e){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(e,this._model)},t.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},t.type="geo",t}(n6e);function tct(e,t,a){wlt(e,t,a)}function act(e){function t(t,a){a.update="geo:updateSelectStatus",e.registerAction(a,function(e,a){var n={},r=[];return a.eachComponent({mainType:"geo",query:e},function(a){a[t](e.name),gGe(a.coordinateSystem.regions,function(e){n[e.name]=a.isSelected(e.name)||!1});var i=[];gGe(n,function(e,t){n[t]&&i.push(t)}),r.push({geoIndex:a.componentIndex,name:i})}),{selected:n,allSelected:r,name:e.name}})}e.registerCoordinateSystem("geo",Jlt),e.registerComponentModel(Qlt),e.registerComponentView(ect),e.registerImpl("registerMap",tct),e.registerImpl("getMap",function(e){return Slt(e)}),t("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),t("select",{type:"geoSelect",event:"geoselected"}),t("unSelect",{type:"geoUnSelect",event:"geounselected"}),e.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(e,t,a){var n=e.componentType;n||(null!=e.geoId?n="geo":null!=e.seriesId&&(n="series")),n||(n="series"),t.eachComponent({mainType:n,query:e},function(t){var a=t.coordinateSystem;if("geo"===a.type){var r=Ust(a,e,t.get("scaleLimit"));t.setCenter&&t.setCenter(r.center),t.setZoom&&t.setZoom(r.zoom),"series"===n&&gGe(t.seriesGroup,function(e){e.setCenter(r.center),e.setZoom(r.zoom)})}})})}function nct(e,t){var a=e.isExpand?e.children:[],n=e.parentNode.children,r=e.hierNode.i?n[e.hierNode.i-1]:null;if(a.length){!function(e){var t=e.children,a=t.length,n=0,r=0;for(;--a>=0;){var i=t[a];i.hierNode.prelim+=n,i.hierNode.modifier+=n,r+=i.hierNode.change,n+=i.hierNode.shift+r}}(e);var i=(a[0].hierNode.prelim+a[a.length-1].hierNode.prelim)/2;r?(e.hierNode.prelim=r.hierNode.prelim+t(e,r),e.hierNode.modifier=e.hierNode.prelim-i):e.hierNode.prelim=i}else r&&(e.hierNode.prelim=r.hierNode.prelim+t(e,r));e.parentNode.hierNode.defaultAncestor=function(e,t,a,n){if(t){for(var r=e,i=e,o=i.parentNode.children[0],s=t,l=r.hierNode.modifier,c=i.hierNode.modifier,u=o.hierNode.modifier,d=s.hierNode.modifier;s=sct(s),i=lct(i),s&&i;){r=sct(r),o=lct(o),r.hierNode.ancestor=e;var h=s.hierNode.prelim+d-i.hierNode.prelim-c+n(s,i);h>0&&(uct(cct(s,e,a),e,h),c+=h,l+=h),d+=s.hierNode.modifier,c+=i.hierNode.modifier,l+=r.hierNode.modifier,u+=o.hierNode.modifier}s&&!sct(r)&&(r.hierNode.thread=s,r.hierNode.modifier+=d-l),i&&!lct(o)&&(o.hierNode.thread=i,o.hierNode.modifier+=c-u,a=e)}return a}(e,r,e.parentNode.hierNode.defaultAncestor||n[0],t)}function rct(e){var t=e.hierNode.prelim+e.parentNode.hierNode.modifier;e.setLayout({x:t},!0),e.hierNode.modifier+=e.parentNode.hierNode.modifier}function ict(e){return arguments.length?e:dct}function oct(e,t){return e-=Math.PI/2,{x:t*Math.cos(e),y:t*Math.sin(e)}}function sct(e){var t=e.children;return t.length&&e.isExpand?t[t.length-1]:e.hierNode.thread}function lct(e){var t=e.children;return t.length&&e.isExpand?t[0]:e.hierNode.thread}function cct(e,t,a){return e.hierNode.ancestor.parentNode===t.parentNode?e.hierNode.ancestor:a}function uct(e,t,a){var n=a/(t.hierNode.i-e.hierNode.i);t.hierNode.change-=n,t.hierNode.shift+=a,t.hierNode.modifier+=a,t.hierNode.prelim+=a,e.hierNode.change+=n}function dct(e,t){return e.parentNode===t.parentNode?1:2}var hct=function(){return function(){this.parentPoint=[],this.childPoints=[]}}(),pct=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:o5e.color.neutral99,fill:null}},t.prototype.getDefaultShape=function(){return new hct},t.prototype.buildPath=function(e,t){var a=t.childPoints,n=a.length,r=t.parentPoint,i=a[0],o=a[n-1];if(1===n)return e.moveTo(r[0],r[1]),void e.lineTo(i[0],i[1]);var s=t.orient,l="TB"===s||"BT"===s?0:1,c=1-l,u=RXe(t.forkPosition,1),d=[];d[l]=r[l],d[c]=r[c]+(o[c]-r[c])*u,e.moveTo(r[0],r[1]),e.lineTo(d[0],d[1]),e.moveTo(i[0],i[1]),d[l]=i[l],e.lineTo(d[0],d[1]),d[l]=o[l],e.lineTo(d[0],d[1]),e.lineTo(o[0],o[1]);for(var h=1;h<n-1;h++){var p=a[h];e.moveTo(p[0],p[1]),d[l]=p[l],e.lineTo(d[0],d[1])}},t}(gZe),fct=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._mainGroup=new xXe,a}return zHe(t,e),t.prototype.init=function(e,t){this._controller=new Tst(t.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},t.prototype.render=function(e,t,a){var n=e.getData(),r=e.layoutInfo,i=this._mainGroup;"radial"===e.get("layout")?(i.x=r.x+r.width/2,i.y=r.y+r.height/2):(i.x=r.x,i.y=r.y),this._updateViewCoordSys(e,a),this._updateController(e,null,t,a);var o=this._data;n.diff(o).add(function(t){mct(n,t)&&vct(n,t,null,i,e)}).update(function(t,a){var r=o.getItemGraphicEl(a);mct(n,t)?vct(n,t,r,i,e):r&&bct(o,a,r,i,e)}).remove(function(t){var a=o.getItemGraphicEl(t);a&&bct(o,t,a,i,e)}).execute(),this._nodeScaleRatio=e.get("nodeScaleRatio"),this._updateNodeAndLinkScale(e),!0===e.get("expandAndCollapse")&&n.eachItemGraphicEl(function(t,n){t.off("click").on("click",function(){a.dispatchAction({type:"treeExpandAndCollapse",seriesId:e.id,dataIndex:n})})}),this._data=n},t.prototype._updateViewCoordSys=function(e,t){var a=e.getData(),n=[];a.each(function(e){var t=a.getItemLayout(e);!t||isNaN(t.x)||isNaN(t.y)||n.push([+t.x,+t.y])});var r=[],i=[];TKe(n,r,i);var o=this._min,s=this._max;i[0]-r[0]===0&&(r[0]=o?o[0]:r[0]-1,i[0]=s?s[0]:i[0]+1),i[1]-r[1]===0&&(r[1]=o?o[1]:r[1]-1,i[1]=s?s[1]:i[1]+1);var l=e.coordinateSystem=new Wlt(null,{api:t,ecModel:e.ecModel});l.zoomLimit=e.get("scaleLimit"),l.setBoundingRect(r[0],r[1],i[0]-r[0],i[1]-r[1]),l.setCenter(e.get("center")),l.setZoom(e.get("zoom")),this.group.attr({x:l.x,y:l.y,scaleX:l.scaleX,scaleY:l.scaleY}),this._min=r,this._max=i},t.prototype._updateController=function(e,t,a,n){var r=this;Fst(e,n,this.group,this._controller,this._controllerHost,t),this._controller.on("zoom",function(t){r._updateNodeAndLinkScale(e)})},t.prototype._updateNodeAndLinkScale=function(e){var t=e.getData(),a=this._getNodeGlobalScale(e);t.eachItemGraphicEl(function(e,t){e.setSymbolScale(a)})},t.prototype._getNodeGlobalScale=function(e){var t=e.coordinateSystem;if("view"!==t.type)return 1;var a=this._nodeScaleRatio,n=t.scaleX||1;return((t.getZoom()-1)*a+1)/n},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},t.type="tree",t}(s6e);function mct(e,t){var a=e.getItemLayout(t);return a&&!isNaN(a.x)&&!isNaN(a.y)}function vct(e,t,a,n,r){var i=!a,o=e.tree.getNodeByDataIndex(t),s=o.getModel(),l=o.getVisual("style").fill,c=!1===o.isExpand&&0!==o.children.length?l:o5e.color.neutral00,u=e.tree.root,d=o.parentNode===u?o:o.parentNode||o,h=e.getItemGraphicEl(d.dataIndex),p=d.getLayout(),f=h?{x:h.__oldX,y:h.__oldY,rawX:h.__radialOldRawX,rawY:h.__radialOldRawY}:p,m=o.getLayout();i?((a=new Xnt(e,t,null,{symbolInnerColor:c,useNameLabel:!0})).x=f.x,a.y=f.y):a.updateData(e,t,null,{symbolInnerColor:c,useNameLabel:!0}),a.__radialOldRawX=a.__radialRawX,a.__radialOldRawY=a.__radialRawY,a.__radialRawX=m.rawX,a.__radialRawY=m.rawY,n.add(a),e.setItemGraphicEl(t,a),a.__oldX=a.x,a.__oldY=a.y,u0e(a,{x:m.x,y:m.y},r);var v=a.getSymbolPath();if("radial"===r.get("layout")){var g=u.children[0],y=g.getLayout(),b=g.children.length,x=void 0,w=void 0;if(m.x===y.x&&!0===o.isExpand&&g.children.length){var _={x:(g.children[0].getLayout().x+g.children[b-1].getLayout().x)/2,y:(g.children[0].getLayout().y+g.children[b-1].getLayout().y)/2};(x=Math.atan2(_.y-y.y,_.x-y.x))<0&&(x=2*Math.PI+x),(w=_.x<y.x)&&(x-=Math.PI)}else(x=Math.atan2(m.y-y.y,m.x-y.x))<0&&(x=2*Math.PI+x),0===o.children.length||0!==o.children.length&&!1===o.isExpand?(w=m.x<y.x)&&(x-=Math.PI):(w=m.x>y.x)||(x-=Math.PI);var S=w?"left":"right",M=s.getModel("label"),T=M.get("rotate"),k=T*(Math.PI/180),C=v.getTextContent();C&&(v.setTextConfig({position:M.get("position")||S,rotation:null==T?-x:k,origin:"center"}),C.setStyle("verticalAlign","middle"))}var A=s.get(["emphasis","focus"]),E="relative"===A?KGe(o.getAncestorsIndices(),o.getDescendantIndices()):"ancestor"===A?o.getAncestorsIndices():"descendant"===A?o.getDescendantIndices():null;E&&(YZe(a).focus=E),function(e,t,a,n,r,i,o,s){var l=t.getModel(),c=e.get("edgeShape"),u=e.get("layout"),d=e.getOrient(),h=e.get(["lineStyle","curveness"]),p=e.get("edgeForkPosition"),f=l.getModel("lineStyle").getLineStyle(),m=n.__edge;if("curve"===c)t.parentNode&&t.parentNode!==a&&(m||(m=n.__edge=new GQe({shape:xct(u,d,h,r,r)})),u0e(m,{shape:xct(u,d,h,i,o)},e));else if("polyline"===c&&"orthogonal"===u&&t!==a&&t.children&&0!==t.children.length&&!0===t.isExpand){for(var v=t.children,g=[],y=0;y<v.length;y++){var b=v[y].getLayout();g.push([b.x,b.y])}m||(m=n.__edge=new pct({shape:{parentPoint:[o.x,o.y],childPoints:[[o.x,o.y]],orient:d,forkPosition:p}})),u0e(m,{shape:{parentPoint:[o.x,o.y],childPoints:g}},e)}m&&("polyline"!==c||t.isExpand)&&(m.useStyle(pGe({strokeNoScale:!0,fill:null},f)),zJe(m,l,"lineStyle"),bJe(m),s.add(m))}(r,o,u,a,f,p,m,n),a.__edge&&(a.onHoverStateChange=function(t){if("blur"!==t){var n=o.parentNode&&e.getItemGraphicEl(o.parentNode.dataIndex);n&&1===n.hoverState||gJe(a.__edge,t)}})}function gct(e,t,a,n,r){var i=yct(t.tree.root,e),o=i.source,s=i.sourceLayout,l=t.getItemGraphicEl(e.dataIndex);if(l){var c=t.getItemGraphicEl(o.dataIndex).__edge,u=l.__edge||(!1===o.isExpand||1===o.children.length?c:void 0),d=n.get("edgeShape"),h=n.get("layout"),p=n.get("orient"),f=n.get(["lineStyle","curveness"]);u&&("curve"===d?p0e(u,{shape:xct(h,p,f,s,s),style:{opacity:0}},n,{cb:function(){a.remove(u)},removeOpt:r}):"polyline"===d&&"orthogonal"===n.get("layout")&&p0e(u,{shape:{parentPoint:[s.x,s.y],childPoints:[[s.x,s.y]]},style:{opacity:0}},n,{cb:function(){a.remove(u)},removeOpt:r}))}}function yct(e,t){for(var a,n=t.parentNode===e?t:t.parentNode||t;null==(a=n.getLayout());)n=n.parentNode===e?n:n.parentNode||n;return{source:n,sourceLayout:a}}function bct(e,t,a,n,r){var i=e.tree.getNodeByDataIndex(t),o=yct(e.tree.root,i).sourceLayout,s={duration:r.get("animationDurationUpdate"),easing:r.get("animationEasingUpdate")};p0e(a,{x:o.x+1,y:o.y+1},r,{cb:function(){n.remove(a),e.setItemGraphicEl(t,null)},removeOpt:s}),a.fadeOut(null,e.hostModel,{fadeLabel:!0,animation:s}),i.children.forEach(function(t){gct(t,e,n,r,s)}),gct(i,e,n,r,s)}function xct(e,t,a,n,r){var i,o,s,l,c,u,d,h;if("radial"===e){c=n.rawX,d=n.rawY,u=r.rawX,h=r.rawY;var p=oct(c,d),f=oct(c,d+(h-d)*a),m=oct(u,h+(d-h)*a),v=oct(u,h);return{x1:p.x||0,y1:p.y||0,x2:v.x||0,y2:v.y||0,cpx1:f.x||0,cpy1:f.y||0,cpx2:m.x||0,cpy2:m.y||0}}return c=n.x,d=n.y,u=r.x,h=r.y,"LR"!==t&&"RL"!==t||(i=c+(u-c)*a,o=d,s=u+(c-u)*a,l=h),"TB"!==t&&"BT"!==t||(i=c,o=d+(h-d)*a,s=u,l=h+(d-h)*a),{x1:c,y1:d,x2:u,y2:h,cpx1:i,cpy1:o,cpx2:s,cpy2:l}}var wct=v$e();function _ct(e){var t=e.mainData,a=e.datas;a||(a={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,Act(t,a,e),gGe(a,function(a){gGe(t.TRANSFERABLE_METHODS,function(t){a.wrapMethod(t,MGe(Sct,e))})}),t.wrapMethod("cloneShallow",MGe(Tct,e)),gGe(t.CHANGABLE_METHODS,function(a){t.wrapMethod(a,MGe(Mct,e))}),VGe(a[t.dataType]===t)}function Sct(e,t){if(wct(n=this).mainData===n){var a=hGe({},wct(this).datas);a[this.dataType]=t,Act(t,a,e)}else Ect(t,this.dataType,wct(this).mainData,e);var n;return t}function Mct(e,t){return e.struct&&e.struct.update(),t}function Tct(e,t){return gGe(wct(t).datas,function(a,n){a!==t&&Ect(a.cloneShallow(),n,t,e)}),t}function kct(e){var t=wct(this).mainData;return null==e||null==t?t:wct(t).datas[e]}function Cct(){var e=wct(this).mainData;return null==e?[{data:e}]:yGe(_Ge(wct(e).datas),function(t){return{type:t,data:wct(e).datas[t]}})}function Act(e,t,a){wct(e).datas={},gGe(t,function(t,n){Ect(t,n,e,a)})}function Ect(e,t,a,n){wct(a).datas[t]=e,wct(e).mainData=a,e.dataType=t,n.struct&&(e[n.structAttr]=n.struct,n.struct[n.datasAttr[t]]=e),e.getLinkedData=kct,e.getLinkedDataAll=Cct}var Ict=function(){function e(e,t){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=e||"",this.hostTree=t}return e.prototype.isRemoved=function(){return this.dataIndex<0},e.prototype.eachNode=function(e,t,a){kGe(e)&&(a=t,t=e,e=null),CGe(e=e||{})&&(e={order:e});var n,r=e.order||"preorder",i=this[e.attr||"children"];"preorder"===r&&(n=t.call(a,this));for(var o=0;!n&&o<i.length;o++)i[o].eachNode(e,t,a);"postorder"===r&&t.call(a,this)},e.prototype.updateDepthAndHeight=function(e){var t=0;this.depth=e;for(var a=0;a<this.children.length;a++){var n=this.children[a];n.updateDepthAndHeight(e+1),n.height>t&&(t=n.height)}this.height=t+1},e.prototype.getNodeById=function(e){if(this.getId()===e)return this;for(var t=0,a=this.children,n=a.length;t<n;t++){var r=a[t].getNodeById(e);if(r)return r}},e.prototype.contains=function(e){if(e===this)return!0;for(var t=0,a=this.children,n=a.length;t<n;t++){var r=a[t].contains(e);if(r)return r}},e.prototype.getAncestors=function(e){for(var t=[],a=e?this:this.parentNode;a;)t.push(a),a=a.parentNode;return t.reverse(),t},e.prototype.getAncestorsIndices=function(){for(var e=[],t=this;t;)e.push(t.dataIndex),t=t.parentNode;return e.reverse(),e},e.prototype.getDescendantIndices=function(){var e=[];return this.eachNode(function(t){e.push(t.dataIndex)}),e},e.prototype.getValue=function(e){var t=this.hostTree.data;return t.getStore().get(t.getDimensionIndex(e||"value"),this.dataIndex)},e.prototype.setLayout=function(e,t){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,e,t)},e.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},e.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostTree.data.getItemModel(this.dataIndex).getModel(e)},e.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},e.prototype.setVisual=function(e,t){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,e,t)},e.prototype.getVisual=function(e){return this.hostTree.data.getItemVisual(this.dataIndex,e)},e.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},e.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},e.prototype.getChildIndex=function(){if(this.parentNode){for(var e=this.parentNode.children,t=0;t<e.length;++t)if(e[t]===this)return t;return-1}return-1},e.prototype.isAncestorOf=function(e){for(var t=e.parentNode;t;){if(t===this)return!0;t=t.parentNode}return!1},e.prototype.isDescendantOf=function(e){return e!==this&&e.isAncestorOf(this)},e}(),Rct=function(){function e(e){this.type="tree",this._nodes=[],this.hostModel=e}return e.prototype.eachNode=function(e,t,a){this.root.eachNode(e,t,a)},e.prototype.getNodeByDataIndex=function(e){var t=this.data.getRawIndex(e);return this._nodes[t]},e.prototype.getNodeById=function(e){return this.root.getNodeById(e)},e.prototype.update=function(){for(var e=this.data,t=this._nodes,a=0,n=t.length;a<n;a++)t[a].dataIndex=-1;for(a=0,n=e.count();a<n;a++)t[e.getRawIndex(a)].dataIndex=a},e.prototype.clearLayouts=function(){this.data.clearItemLayouts()},e.createTree=function(t,a,n){var r=new e(a),i=[],o=1;!function e(t,a){var n=t.value;o=Math.max(o,TGe(n)?n.length:1),i.push(t);var s=new Ict(h$e(t.name,""),r);a?function(e,t){var a=t.children;if(e.parentNode===t)return;a.push(e),e.parentNode=t}(s,a):r.root=s,r._nodes.push(s);var l=t.children;if(l)for(var c=0;c<l.length;c++)e(l[c],s)}(t),r.root.updateDepthAndHeight(0);var s=R9e(i,{coordDimensions:["value"],dimensionsCount:o}).dimensions,l=new I9e(s,a);return l.initData(i),n&&n(l),_ct({mainData:l,struct:r,structAttr:"tree"}),r.update(),r},e}();function Dct(e,t,a){if(e&&fGe(t,e.type)>=0){var n=a.getData().tree.root,r=e.targetNode;if(CGe(r)&&(r=n.getNodeById(r)),r&&n.contains(r))return{node:r};var i=e.targetNodeId;if(null!=i&&(r=n.getNodeById(i)))return{node:r}}}function Pct(e){for(var t=[];e;)(e=e.parentNode)&&t.push(e);return t.reverse()}function Lct(e,t){return fGe(Pct(e),t)>=0}function Nct(e,t){for(var a=[];e;){var n=e.dataIndex;a.push({name:e.name,dataIndex:n,value:t.getRawValue(n)}),e=e.parentNode}return a.reverse(),a}var Oct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasSymbolVisual=!0,t.ignoreStyleOnData=!0,t}return zHe(t,e),t.prototype.getInitialData=function(e){var t={name:e.name,children:e.data},a=e.leaves||{},n=new E1e(a,this,this.ecModel),r=Rct.createTree(t,this,function(e){e.wrapMethod("getItemModel",function(e,t){var a=r.getNodeByDataIndex(t);return a&&a.children.length&&a.isExpand||(e.parentModel=n),e})});var i=0;r.eachNode("preorder",function(e){e.depth>i&&(i=e.depth)});var o=e.expandAndCollapse&&e.initialTreeDepth>=0?e.initialTreeDepth:i;return r.root.eachNode("preorder",function(e){var t=e.hostTree.data.getRawDataItem(e.dataIndex);e.isExpand=t&&null!=t.collapsed?!t.collapsed:e.depth<=o}),r.data},t.prototype.getOrient=function(){var e=this.get("orient");return"horizontal"===e?e="LR":"vertical"===e&&(e="TB"),e},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.formatTooltip=function(e,t,a){for(var n=this.getData().tree,r=n.root.children[0],i=n.getNodeByDataIndex(e),o=i.getValue(),s=i.name;i&&i!==r;)s=i.parentNode.name+"."+s,i=i.parentNode;return P3e("nameValue",{name:s,value:o,noValue:isNaN(o)||null==o})},t.prototype.getDataParams=function(t){var a=e.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return a.treeAncestors=Nct(n,this),a.collapsed=!n.isExpand,a},t.type="series.tree",t.layoutMode="box",t.defaultOption={z:2,coordinateSystemUsage:"box",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,roamTrigger:"global",nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:o5e.color.borderTint,width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},t}($3e);function Fct(e,t){for(var a,n=[e];a=n.pop();)if(t(a),a.isExpand){var r=a.children;if(r.length)for(var i=r.length-1;i>=0;i--)n.push(r[i])}}function Bct(e,t){e.eachSeriesByType("tree",function(e){!function(e,t){var a=J2e(e,t).refContainer,n=$2e(e.getBoxLayoutParams(),a);e.layoutInfo=n;var r=e.get("layout"),i=0,o=0,s=null;"radial"===r?(i=2*Math.PI,o=Math.min(n.height,n.width)/2,s=ict(function(e,t){return(e.parentNode===t.parentNode?1:2)/e.depth})):(i=n.width,o=n.height,s=ict());var l=e.getData().tree.root,c=l.children[0];if(c){!function(e){var t=e;t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var a,n,r=[t];a=r.pop();)if(n=a.children,a.isExpand&&n.length)for(var i=n.length-1;i>=0;i--){var o=n[i];o.hierNode={defaultAncestor:null,ancestor:o,prelim:0,modifier:0,change:0,shift:0,i:i,thread:null},r.push(o)}}(l),function(e,t,a){for(var n,r=[e],i=[];n=r.pop();)if(i.push(n),n.isExpand){var o=n.children;if(o.length)for(var s=0;s<o.length;s++)r.push(o[s])}for(;n=i.pop();)t(n,a)}(c,nct,s),l.hierNode.modifier=-c.hierNode.prelim,Fct(c,rct);var u=c,d=c,h=c;Fct(c,function(e){var t=e.getLayout().x;t<u.getLayout().x&&(u=e),t>d.getLayout().x&&(d=e),e.depth>h.depth&&(h=e)});var p=u===d?1:s(u,d)/2,f=p-u.getLayout().x,m=0,v=0,g=0,y=0;if("radial"===r)m=i/(d.getLayout().x+p+f),v=o/(h.depth-1||1),Fct(c,function(e){g=(e.getLayout().x+f)*m,y=(e.depth-1)*v;var t=oct(g,y);e.setLayout({x:t.x,y:t.y,rawX:g,rawY:y},!0)});else{var b=e.getOrient();"RL"===b||"LR"===b?(v=o/(d.getLayout().x+p+f),m=i/(h.depth-1||1),Fct(c,function(e){y=(e.getLayout().x+f)*v,g="LR"===b?(e.depth-1)*m:i-(e.depth-1)*m,e.setLayout({x:g,y:y},!0)})):"TB"!==b&&"BT"!==b||(m=i/(d.getLayout().x+p+f),v=o/(h.depth-1||1),Fct(c,function(e){g=(e.getLayout().x+f)*m,y="TB"===b?(e.depth-1)*v:o-(e.depth-1)*v,e.setLayout({x:g,y:y},!0)}))}}}(e,t)})}function Uct(e){e.eachSeriesByType("tree",function(e){var t=e.getData();t.tree.eachNode(function(e){var a=e.getModel().getModel("itemStyle").getItemStyle();hGe(t.ensureUniqueItemVisual(e.dataIndex,"style"),a)})})}var zct=["treemapZoomToNode","treemapRender","treemapMove"];function Vct(e){var t=e.getData().tree,a={};t.eachNode(function(t){for(var n=t;n&&n.depth>1;)n=n.parentNode;var r=z5e(e.ecModel,n.name||n.dataIndex+"",a);t.setVisual("decal",r)})}var Hct=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.preventUsingHoverLayer=!0,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){var a={name:e.name,children:e.data};Gct(a);var n=e.levels||[],r=this.designatedVisualItemStyle={},i=new E1e({itemStyle:r},this,t);n=e.levels=function(e,t){var a,n,r=r$e(t.get("color")),i=r$e(t.get(["aria","decal","decals"]));if(!r)return;e=e||[],gGe(e,function(e){var t=new E1e(e),r=t.get("color"),i=t.get("decal");(t.get(["itemStyle","color"])||r&&"none"!==r)&&(a=!0),(t.get(["itemStyle","decal"])||i&&"none"!==i)&&(n=!0)});var o=e[0]||(e[0]={});a||(o.color=r.slice());!n&&i&&(o.decal=i.slice());return e}(n,t);var o=yGe(n||[],function(e){return new E1e(e,i,t)},this),s=Rct.createTree(a,this,function(e){e.wrapMethod("getItemModel",function(e,t){var a=s.getNodeByDataIndex(t),n=a?o[a.depth]:null;return e.parentModel=n||i,e})});return s.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.formatTooltip=function(e,t,a){var n=this.getData(),r=this.getRawValue(e);return P3e("nameValue",{name:n.getName(e),value:r})},t.prototype.getDataParams=function(t){var a=e.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return a.treeAncestors=Nct(n,this),a.treePathInfo=a.treeAncestors,a},t.prototype.setLayoutInfo=function(e){this.layoutInfo=this.layoutInfo||{},hGe(this.layoutInfo,e)},t.prototype.mapIdToIndex=function(e){var t=this._idIndexMap;t||(t=this._idIndexMap=$Ge(),this._idIndexMapCount=0);var a=t.get(e);return null==a&&t.set(e,a=this._idIndexMapCount++),a},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var t=this.getRawData().tree.root;e&&(e===t||t.contains(e))||(this._viewRoot=t)},t.prototype.enableAriaDecal=function(){Vct(this)},t.type="series.treemap",t.layoutMode="box",t.defaultOption={progressive:0,coordinateSystemUsage:"box",left:o5e.size.l,top:o5e.size.xxxl,right:o5e.size.l,bottom:o5e.size.xxxl,sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,scaleLimit:{max:5,min:.2},roam:!0,roamTrigger:"global",nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",bottom:o5e.size.m,emptyItemWidth:25,itemStyle:{color:o5e.color.backgroundShade,textStyle:{color:o5e.color.secondary}},emphasis:{itemStyle:{color:o5e.color.background}}},label:{show:!0,distance:0,padding:5,position:"inside",color:o5e.color.neutral00,overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:o5e.color.neutral00,borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},t}($3e);function Gct(e){var t=0;gGe(e.children,function(e){Gct(e);var a=e.value;TGe(a)&&(a=a[0]),t+=a});var a=e.value;TGe(a)&&(a=a[0]),(null==a||isNaN(a))&&(a=t),a<0&&(a=0),TGe(e.value)?e.value[0]=a:e.value=a}var Wct=function(){function e(e){this.group=new xXe,e.add(this.group)}return e.prototype.render=function(e,t,a,n){var r=e.getModel("breadcrumb"),i=this.group;if(i.removeAll(),r.get("show")&&a){var o=r.getModel("itemStyle"),s=r.getModel("emphasis"),l=o.getModel("textStyle"),c=s.getModel(["itemStyle","textStyle"]),u=J2e(e,t).refContainer,d={left:r.get("left"),right:r.get("right"),top:r.get("top"),bottom:r.get("bottom")},h={emptyItemWidth:r.get("emptyItemWidth"),totalWidth:0,renderList:[]},p=$2e(d,u);this._prepare(a,h,l),this._renderContent(e,h,p,o,s,l,c,n),Q2e(i,d,u)}},e.prototype._prepare=function(e,t,a){for(var n=e;n;n=n.parentNode){var r=h$e(n.getModel().get("name"),""),i=a.getTextRect(r),o=Math.max(i.width+16,t.emptyItemWidth);t.totalWidth+=o+8,t.renderList.push({node:n,text:r,width:o})}},e.prototype._renderContent=function(e,t,a,n,r,i,o,s){for(var l=0,c=t.emptyItemWidth,u=e.get(["breadcrumb","height"]),d=t.totalWidth,h=t.renderList,p=r.getModel("itemStyle").getItemStyle(),f=h.length-1;f>=0;f--){var m=h[f],v=m.node,g=m.width,y=m.text;d>a.width&&(d-=g-c,g=c,y=null);var b=new LQe({shape:{points:qct(l,0,g,u,f===h.length-1,0===f)},style:pGe(n.getItemStyle(),{lineJoin:"bevel"}),textContent:new PZe({style:o1e(i,{text:y})}),textConfig:{position:"inside"},z2:1e5,onclick:MGe(s,v)});b.disableLabelAnimation=!0,b.getTextContent().ensureState("emphasis").style=o1e(o,{text:y}),b.ensureState("emphasis").style=p,OJe(b,r.get("focus"),r.get("blurScope"),r.get("disabled")),this.group.add(b),Yct(b,e,v),l+=g+8}},e.prototype.remove=function(){this.group.removeAll()},e}();function qct(e,t,a,n,r,i){var o=[[r?e:e-5,t],[e+a,t],[e+a,t+n],[r?e:e-5,t+n]];return!i&&o.splice(2,0,[e+a+5,t+n/2]),!r&&o.push([e,t+n/2]),o}function Yct(e,t,a){YZe(e).eventData={componentType:"series",componentSubType:"treemap",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:a&&a.dataIndex,name:a&&a.name},treePathInfo:a&&Nct(a,t)}}var jct=function(){function e(){this._storage=[],this._elExistsMap={}}return e.prototype.add=function(e,t,a,n,r){return!this._elExistsMap[e.id]&&(this._elExistsMap[e.id]=!0,this._storage.push({el:e,target:t,duration:a,delay:n,easing:r}),!0)},e.prototype.finished=function(e){return this._finishedCallback=e,this},e.prototype.start=function(){for(var e=this,t=this._storage.length,a=function(){--t<=0&&(e._storage.length=0,e._elExistsMap={},e._finishedCallback&&e._finishedCallback())},n=0,r=this._storage.length;n<r;n++){var i=this._storage[n];i.el.animateTo(i.target,{duration:i.duration,delay:i.delay,easing:i.easing,setToFinal:!0,done:a,aborted:a})}return this},e}();var Xct=xXe,$ct=EZe,Kct="label",Zct="upperLabel",Jct=F$e([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),Qct=function(e){var t=Jct(e);return t.stroke=t.fill=t.lineWidth=null,t},eut=v$e(),tut=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._state="ready",a._storage={nodeGroup:[],background:[],content:[]},a}return zHe(t,e),t.prototype.render=function(e,t,a,n){if(!(fGe(t.findComponents({mainType:"series",subType:"treemap",query:n}),e)<0)){this.seriesModel=e,this.api=a,this.ecModel=t;var r=Dct(n,["treemapZoomToNode","treemapRootToNode"],e),i=n&&n.type,o=e.layoutInfo,s=!this._oldTree,l=this._storage,c="treemapRootToNode"===i&&r&&l?{rootNodeGroup:l.nodeGroup[r.node.getRawIndex()],direction:n.direction}:null,u=this._giveContainerGroup(o),d=e.get("animation"),h=this._doRender(u,e,c);!d||s||i&&"treemapZoomToNode"!==i&&"treemapRootToNode"!==i?h.renderFinally():this._doAnimation(u,h,e,c),this._resetController(a),this._renderBreadcrumb(e,a,r)}},t.prototype._giveContainerGroup=function(e){var t=this._containerGroup;return t||(t=this._containerGroup=new Xct,this._initEvents(t),this.group.add(t)),t.x=e.x,t.y=e.y,t},t.prototype._doRender=function(e,t,a){var n=t.getData().tree,r=this._oldTree,i={nodeGroup:[],background:[],content:[]},o={nodeGroup:[],background:[],content:[]},s=this._storage,l=[];function c(e,n,r,c){return function(e,t,a,n,r,i,o,s,l,c){if(!o)return;var u=o.getLayout(),d=e.getData(),h=o.getModel();if(d.setItemGraphicEl(o.dataIndex,null),!u||!u.isInView)return;var p=u.width,f=u.height,m=u.borderWidth,v=u.invisible,g=o.getRawIndex(),y=s&&s.getRawIndex(),b=o.viewChildren,x=u.upperHeight,w=b&&b.length,_=h.getModel("itemStyle"),S=h.getModel(["emphasis","itemStyle"]),M=h.getModel(["blur","itemStyle"]),T=h.getModel(["select","itemStyle"]),k=_.get("borderRadius")||0,C=V("nodeGroup",Xct);if(!C)return;if(l.add(C),C.x=u.x||0,C.y=u.y||0,C.markRedraw(),eut(C).nodeWidth=p,eut(C).nodeHeight=f,u.isAboveViewRoot)return C;var A=V("background",$ct,c,20);A&&O(C,A,w&&u.upperLabelHeight);var E=h.getModel("emphasis"),I=E.get("focus"),R=E.get("blurScope"),D=E.get("disabled"),P="ancestor"===I?o.getAncestorsIndices():"descendant"===I?o.getDescendantIndices():I;if(w)HJe(C)&&VJe(C,!1),A&&(VJe(A,!D),d.setItemGraphicEl(o.dataIndex,A),FJe(A,P,R));else{var L=V("content",$ct,c,30);L&&F(C,L),A.disableMorphing=!0,A&&HJe(A)&&VJe(A,!1),VJe(C,!D),d.setItemGraphicEl(o.dataIndex,C);var N=h.getShallow("cursor");N&&L.attr("cursor",N),FJe(C,P,R)}return C;function O(t,a,n){var r=YZe(a);if(r.dataIndex=o.dataIndex,r.seriesIndex=e.seriesIndex,a.setShape({x:0,y:0,width:p,height:f,r:k}),v)B(a);else{a.invisible=!1;var i=o.getVisual("style"),s=i.stroke,l=Qct(_);l.fill=s;var c=Jct(S);c.fill=S.get("borderColor");var u=Jct(M);u.fill=M.get("borderColor");var d=Jct(T);if(d.fill=T.get("borderColor"),n){var h=p-2*m;U(a,s,i.opacity,{x:m,y:0,width:h,height:x})}else a.removeTextContent();a.setStyle(l),a.ensureState("emphasis").style=c,a.ensureState("blur").style=u,a.ensureState("select").style=d,bJe(a)}t.add(a)}function F(t,a){var n=YZe(a);n.dataIndex=o.dataIndex,n.seriesIndex=e.seriesIndex;var r=Math.max(p-2*m,0),i=Math.max(f-2*m,0);if(a.culling=!0,a.setShape({x:m,y:m,width:r,height:i,r:k}),v)B(a);else{a.invisible=!1;var s=o.getVisual("style"),l=s.fill,c=Qct(_);c.fill=l,c.decal=s.decal;var u=Jct(S),d=Jct(M),h=Jct(T);U(a,l,s.opacity,null),a.setStyle(c),a.ensureState("emphasis").style=u,a.ensureState("blur").style=d,a.ensureState("select").style=h,bJe(a)}t.add(a)}function B(e){!e.invisible&&i.push(e)}function U(t,a,n,r){var i=h.getModel(r?Zct:Kct),s=h$e(h.get("name"),null),l=i.getShallow("show");r1e(t,i1e(h,r?Zct:Kct),{defaultText:l?s:null,inheritColor:a,defaultOpacity:n,labelFetcher:e,labelDataIndex:o.dataIndex});var c=t.getTextContent();if(c){var d=c.style,p=zGe(d.padding||0);r&&(t.setTextConfig({layoutRect:r}),c.disableLabelLayout=!0),c.beforeUpdate=function(){var e=Math.max((r?r.width:t.shape.width)-p[1]-p[3],0),a=Math.max((r?r.height:t.shape.height)-p[0]-p[2],0);d.width===e&&d.height===a||c.setStyle({width:e,height:a})},d.truncateMinChar=2,d.lineOverflow="truncate",z(d,r,u);var f=c.getState("emphasis");z(f?f.style:null,r,u)}}function z(t,a,n){var r=t?t.text:null;if(!a&&n.isLeafRoot&&null!=r){var i=e.get("drillDownIcon",!0);t.text=i?i+" "+r:r}}function V(e,n,i,o){var s=null!=y&&a[e][y],l=r[e];return s?(a[e][y]=null,H(l,s)):v||((s=new n)instanceof fKe&&(s.z2=function(e,t){return 100*e+t}(i,o)),G(l,s)),t[e][g]=s}function H(e,t){var a=e[g]={};t instanceof Xct?(a.oldX=t.x,a.oldY=t.y):a.oldShape=hGe({},t.shape)}function G(e,t){var a=e[g]={},i=o.parentNode,s=t instanceof xXe;if(i&&(!n||"drillDown"===n.direction)){var l=0,c=0,u=r.background[i.getRawIndex()];!n&&u&&u.oldShape&&(l=u.oldShape.width,c=u.oldShape.height),s?(a.oldX=0,a.oldY=c):a.oldShape={x:l,y:c,width:0,height:0}}a.fadein=!s}}(t,o,s,a,i,l,e,n,r,c)}!function e(t,a,n,r,i){r?(a=t,gGe(t,function(e,t){!e.isRemoved()&&s(t,t)})):new o9e(a,t,o,o).add(s).update(s).remove(MGe(s,null)).execute();function o(e){return e.getId()}function s(o,s){var l=null!=o?t[o]:null,u=null!=s?a[s]:null,d=c(l,u,n,i);d&&e(l&&l.viewChildren||[],u&&u.viewChildren||[],d,r,i+1)}}(n.root?[n.root]:[],r&&r.root?[r.root]:[],e,n===r||!r,0);var u=function(e){var t={nodeGroup:[],background:[],content:[]};return e&&gGe(e,function(e,a){var n=t[a];gGe(e,function(e){e&&(n.push(e),eut(e).willDelete=!0)})}),t}(s);if(this._oldTree=n,this._storage=o,this._controllerHost){var d=this.seriesModel.layoutInfo,h=n.root.getLayout();h.width===d.width&&h.height===d.height&&(this._controllerHost.zoom=1)}return{lastsForAnimation:i,willDeleteEls:u,renderFinally:function(){gGe(u,function(e){gGe(e,function(e){e.parent&&e.parent.remove(e)})}),gGe(l,function(e){e.invisible=!0,e.dirty()})}}},t.prototype._doAnimation=function(e,t,a,n){var r=a.get("animationDurationUpdate"),i=a.get("animationEasing"),o=(kGe(r)?0:r)||0,s=(kGe(i)?null:i)||"cubicOut",l=new jct;gGe(t.willDeleteEls,function(e,t){gGe(e,function(e,a){if(!e.invisible){var r,i=e.parent,c=eut(i);if(n&&"drillDown"===n.direction)r=i===n.rootNodeGroup?{shape:{x:0,y:0,width:c.nodeWidth,height:c.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var u=0,d=0;c.willDelete||(u=c.nodeWidth/2,d=c.nodeHeight/2),r="nodeGroup"===t?{x:u,y:d,style:{opacity:0}}:{shape:{x:u,y:d,width:0,height:0},style:{opacity:0}}}r&&l.add(e,r,o,0,s)}})}),gGe(this._storage,function(e,a){gGe(e,function(e,n){var r=t.lastsForAnimation[a][n],i={};r&&(e instanceof xXe?null!=r.oldX&&(i.x=e.x,i.y=e.y,e.x=r.oldX,e.y=r.oldY):(r.oldShape&&(i.shape=hGe({},e.shape),e.setShape(r.oldShape)),r.fadein?(e.setStyle("opacity",0),i.style={opacity:1}):1!==e.style.opacity&&(i.style={opacity:1})),l.add(e,i,o,0,s))})},this),this._state="animating",l.finished(SGe(function(){this._state="ready",t.renderFinally()},this)).start()},t.prototype._resetController=function(e){var t=this,a=this._controller,n=this._controllerHost;n||(this._controllerHost={target:this.group},n=this._controllerHost);var r=this.seriesModel;a||((a=this._controller=new Tst(e.getZr())).on("pan",SGe(this._onPan,this)),a.on("zoom",SGe(this._onZoom,this))),a.enable(r.get("roam"),{api:e,zInfo:{component:r},triggerInfo:{roamTrigger:r.get("roamTrigger"),isInSelf:function(e,a,n){var r=t._containerGroup;return!!r&&r.getBoundingRect().contain(a-r.x,n-r.y)}}}),n.zoomLimit=r.get("scaleLimit"),n.zoom=r.get("zoom")},t.prototype._clearController=function(){var e=this._controller;this._controllerHost=null,e&&(e.dispose(),e=null)},t.prototype._onPan=function(e){if("animating"!==this._state&&(Math.abs(e.dx)>3||Math.abs(e.dy)>3)){var t=this.seriesModel.getData().tree.root;if(!t)return;var a=t.getLayout();if(!a)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:a.x+e.dx,y:a.y+e.dy,width:a.width,height:a.height}})}},t.prototype._onZoom=function(e){var t=e.originX,a=e.originY,n=e.scale;if("animating"!==this._state){var r=this.seriesModel.getData().tree.root;if(!r)return;var i=r.getLayout();if(!i)return;var o,s=new fqe(i.x,i.y,i.width,i.height),l=this._controllerHost;o=l.zoomLimit;var c=l.zoom=l.zoom||1;if(c*=n,o){var u=o.min||0,d=o.max||1/0;c=Math.max(Math.min(d,c),u)}var h=c/l.zoom;l.zoom=c;var p=this.seriesModel.layoutInfo,f=[1,0,0,1,0,0];KWe(f,f,[-(t-=p.x),-(a-=p.y)]),JWe(f,f,[h,h]),KWe(f,f,[t,a]),s.applyTransform(f),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:s.x,y:s.y,width:s.width,height:s.height}})}},t.prototype._initEvents=function(e){var t=this;e.on("click",function(e){if("ready"===t._state){var a=t.seriesModel.get("nodeClick",!0);if(a){var n=t.findTarget(e.offsetX,e.offsetY);if(n){var r=n.node;if(r.getLayout().isLeafRoot)t._rootToNode(n);else if("zoomToNode"===a)t._zoomToNode(n);else if("link"===a){var i=r.hostTree.data.getItemModel(r.dataIndex),o=i.get("link",!0),s=i.get("target",!0)||"blank";o&&E2e(o,s)}}}}},this)},t.prototype._renderBreadcrumb=function(e,t,a){var n=this;a||(a=null!=e.get("leafDepth",!0)?{node:e.getViewRoot()}:this.findTarget(t.getWidth()/2,t.getHeight()/2))||(a={node:e.getData().tree.root}),(this._breadcrumb||(this._breadcrumb=new Wct(this.group))).render(e,t,a.node,function(t){"animating"!==n._state&&(Lct(e.getViewRoot(),t)?n._rootToNode({node:t}):n._zoomToNode({node:t}))})},t.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage={nodeGroup:[],background:[],content:[]},this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},t.prototype.dispose=function(){this._clearController()},t.prototype._zoomToNode=function(e){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},t.prototype._rootToNode=function(e){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},t.prototype.findTarget=function(e,t){var a;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(n){var r=this._storage.background[n.getRawIndex()];if(r){var i=r.transformCoordToLocal(e,t),o=r.shape;if(!(o.x<=i[0]&&i[0]<=o.x+o.width&&o.y<=i[1]&&i[1]<=o.y+o.height))return!1;a={node:n,offsetX:i[0],offsetY:i[1]}}},this),a},t.type="treemap",t}(s6e);var aut=gGe,nut=IGe,rut=-1,iut=function(){function e(t){var a=t.mappingMethod,n=t.type,r=this.option=cGe(t);this.type=n,this.mappingMethod=a,this._normalizeData=mut[a];var i=e.visualHandlers[n];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._normalizedToVisual=i._normalizedToVisual[a],"piecewise"===a?(out(r),function(e){var t=e.pieceList;e.hasSpecialVisual=!1,gGe(t,function(t,a){t.originIndex=a,null!=t.visual&&(e.hasSpecialVisual=!0)})}(r)):"category"===a?r.categories?function(e){var t=e.categories,a=e.categoryMap={},n=e.visual;if(aut(t,function(e,t){a[e]=t}),!TGe(n)){var r=[];IGe(n)?aut(n,function(e,t){var n=a[t];r[null!=n?n:rut]=e}):r[-1]=n,n=fut(e,r)}for(var i=t.length-1;i>=0;i--)null==n[i]&&(delete a[t[i]],t.pop())}(r):out(r,!0):(VGe("linear"!==a||r.dataExtent),out(r))}return e.prototype.mapValueToVisual=function(e){var t=this._normalizeData(e);return this._normalizedToVisual(t,e)},e.prototype.getNormalizer=function(){return SGe(this._normalizeData,this)},e.listVisualTypes=function(){return _Ge(e.visualHandlers)},e.isValidType=function(t){return e.visualHandlers.hasOwnProperty(t)},e.eachVisual=function(e,t,a){IGe(e)?gGe(e,t,a):t.call(a,e)},e.mapVisual=function(t,a,n){var r,i=TGe(t)?[]:IGe(t)?{}:(r=!0,null);return e.eachVisual(t,function(e,t){var o=a.call(n,e,t);r?i=o:i[t]=o}),i},e.retrieveVisuals=function(t){var a,n={};return t&&aut(e.visualHandlers,function(e,r){t.hasOwnProperty(r)&&(n[r]=t[r],a=!0)}),a?n:null},e.prepareVisualTypes=function(e){if(TGe(e))e=e.slice();else{if(!nut(e))return[];var t=[];aut(e,function(e,a){t.push(a)}),e=t}return e.sort(function(e,t){return"color"===t&&"color"!==e&&0===e.indexOf("color")?1:-1}),e},e.dependsOn=function(e,t){return"color"===t?!(!e||0!==e.indexOf(t)):e===t},e.findPieceIndex=function(e,t,a){for(var n,r=1/0,i=0,o=t.length;i<o;i++){var s=t[i].value;if(null!=s){if(s===e||CGe(s)&&s===e+"")return i;a&&d(s,i)}}for(i=0,o=t.length;i<o;i++){var l=t[i],c=l.interval,u=l.close;if(c){if(c[0]===-1/0){if(vut(u[1],e,c[1]))return i}else if(c[1]===1/0){if(vut(u[0],c[0],e))return i}else if(vut(u[0],c[0],e)&&vut(u[1],e,c[1]))return i;a&&d(c[0],i),a&&d(c[1],i)}}if(a)return e===1/0?t.length-1:e===-1/0?0:n;function d(t,a){var i=Math.abs(t-e);i<r&&(r=i,n=a)}},e.visualHandlers={color:{applyVisual:cut("color"),getColorMapper:function(){var e=this.option;return SGe("category"===e.mappingMethod?function(e,t){return!t&&(e=this._normalizeData(e)),uut.call(this,e)}:function(t,a,n){var r=!!n;return!a&&(t=this._normalizeData(t)),n=DYe(t,e.parsedVisual,n),r?n:NYe(n,"rgba")},this)},_normalizedToVisual:{linear:function(e){return NYe(DYe(e,this.option.parsedVisual),"rgba")},category:uut,piecewise:function(e,t){var a=put.call(this,t);return null==a&&(a=NYe(DYe(e,this.option.parsedVisual),"rgba")),a},fixed:dut}},colorHue:sut(function(e,t){return PYe(e,t)}),colorSaturation:sut(function(e,t){return PYe(e,null,t)}),colorLightness:sut(function(e,t){return PYe(e,null,null,t)}),colorAlpha:sut(function(e,t){return LYe(e,t)}),decal:{applyVisual:cut("decal"),_normalizedToVisual:{linear:null,category:uut,piecewise:null,fixed:null}},opacity:{applyVisual:cut("opacity"),_normalizedToVisual:hut([0,1])},liftZ:{applyVisual:cut("liftZ"),_normalizedToVisual:{linear:dut,category:dut,piecewise:dut,fixed:dut}},symbol:{applyVisual:function(e,t,a){a("symbol",this.mapValueToVisual(e))},_normalizedToVisual:{linear:lut,category:uut,piecewise:function(e,t){var a=put.call(this,t);return null==a&&(a=lut.call(this,e)),a},fixed:dut}},symbolSize:{applyVisual:cut("symbolSize"),_normalizedToVisual:hut([0,1])}},e}();function out(e,t){var a=e.visual,n=[];IGe(a)?aut(a,function(e){n.push(e)}):null!=a&&n.push(a);t||1!==n.length||{color:1,symbol:1}.hasOwnProperty(e.type)||(n[1]=n[0]),fut(e,n)}function sut(e){return{applyVisual:function(t,a,n){var r=this.mapValueToVisual(t);n("color",e(a("color"),r))},_normalizedToVisual:hut([0,1])}}function lut(e){var t=this.option.visual;return t[Math.round(IXe(e,[0,1],[0,t.length-1],!0))]||{}}function cut(e){return function(t,a,n){n(e,this.mapValueToVisual(t))}}function uut(e){var t=this.option.visual;return t[this.option.loop&&e!==rut?e%t.length:e]}function dut(){return this.option.visual[0]}function hut(e){return{linear:function(t){return IXe(t,e,this.option.visual,!0)},category:uut,piecewise:function(t,a){var n=put.call(this,a);return null==n&&(n=IXe(t,e,this.option.visual,!0)),n},fixed:dut}}function put(e){var t=this.option,a=t.pieceList;if(t.hasSpecialVisual){var n=a[iut.findPieceIndex(e,a)];if(n&&n.visual)return n.visual[this.type]}}function fut(e,t){return e.visual=t,"color"===e.type&&(e.parsedVisual=yGe(t,function(e){return EYe(e)||[0,0,0,1]})),t}var mut={linear:function(e){return IXe(e,this.option.dataExtent,[0,1],!0)},piecewise:function(e){var t=this.option.pieceList,a=iut.findPieceIndex(e,t,!0);if(null!=a)return IXe(a,[0,t.length-1],[0,1],!0)},category:function(e){var t=this.option.categories?this.option.categoryMap[e]:e;return null==t?rut:t},fixed:eWe};function vut(e,t,a){return e?t<=a:t<a}var gut=v$e();const yut={seriesType:"treemap",reset:function(e){var t=e.getData().tree.root;t.isRemoved()||but(t,{},e.getViewRoot().getAncestors(),e)}};function but(e,t,a,n){var r=e.getModel(),i=e.getLayout(),o=e.hostTree.data;if(i&&!i.invisible&&i.isInView){var s,l=r.getModel("itemStyle"),c=function(e,t,a){var n=hGe({},t),r=a.designatedVisualItemStyle;return gGe(["color","colorAlpha","colorSaturation"],function(a){r[a]=t[a];var i=e.get(a);r[a]=null,null!=i&&(n[a]=i)}),n}(l,t,n),u=o.ensureUniqueItemVisual(e.dataIndex,"style"),d=l.get("borderColor"),h=l.get("borderColorSaturation");null!=h&&(d=function(e,t){return null!=t?PYe(t,null,null,e):null}(h,s=xut(c))),u.stroke=d;var p=e.viewChildren;if(p&&p.length){var f=function(e,t,a,n,r,i){if(!i||!i.length)return;var o=_ut(t,"color")||null!=r.color&&"none"!==r.color&&(_ut(t,"colorAlpha")||_ut(t,"colorSaturation"));if(!o)return;var s=t.get("visualMin"),l=t.get("visualMax"),c=a.dataExtent.slice();null!=s&&s<c[0]&&(c[0]=s),null!=l&&l>c[1]&&(c[1]=l);var u=t.get("colorMappingBy"),d={type:o.name,dataExtent:c,visual:o.range};"color"!==d.type||"index"!==u&&"id"!==u?d.mappingMethod="linear":(d.mappingMethod="category",d.loop=!0);var h=new iut(d);return gut(h).drColorMappingBy=u,h}(0,r,i,0,c,p);gGe(p,function(e,t){if(e.depth>=a.length||e===a[e.depth]){var i=function(e,t,a,n,r,i){var o=hGe({},t);if(r){var s=r.type,l="color"===s&&gut(r).drColorMappingBy,c="index"===l?n:"id"===l?i.mapIdToIndex(a.getId()):a.getValue(e.get("visualDimension"));o[s]=r.mapValueToVisual(c)}return o}(r,c,e,t,f,n);but(e,i,a,n)}})}else s=xut(c),u.fill=s}}function xut(e){var t=wut(e,"color");if(t){var a=wut(e,"colorAlpha"),n=wut(e,"colorSaturation");return n&&(t=PYe(t,null,null,n)),a&&(t=LYe(t,a)),t}}function wut(e,t){var a=e[t];if(null!=a&&"none"!==a)return a}function _ut(e,t){var a=e.get(t);return TGe(a)&&a.length?{name:t,range:a}:null}var Sut=Math.max,Mut=Math.min,Tut=OGe,kut=gGe,Cut=["itemStyle","borderWidth"],Aut=["itemStyle","gapWidth"],Eut=["upperLabel","show"],Iut=["upperLabel","height"];const Rut={seriesType:"treemap",reset:function(e,t,a,n){var r=e.option,i=J2e(e,a).refContainer,o=$2e(e.getBoxLayoutParams(),i),s=r.size||[],l=RXe(Tut(o.width,s[0]),i.width),c=RXe(Tut(o.height,s[1]),i.height),u=n&&n.type,d=Dct(n,["treemapZoomToNode","treemapRootToNode"],e),h="treemapRender"===u||"treemapMove"===u?n.rootRect:null,p=e.getViewRoot(),f=Pct(p);if("treemapMove"!==u){var m="treemapZoomToNode"===u?function(e,t,a,n,r){var i,o=(t||{}).node,s=[n,r];if(!o||o===a)return s;var l=n*r,c=l*e.option.zoomToNodeRatio;for(;i=o.parentNode;){for(var u=0,d=i.children,h=0,p=d.length;h<p;h++)u+=d[h].getValue();var f=o.getValue();if(0===f)return s;c*=u/f;var m=i.getModel(),v=m.get(Cut);(c+=4*v*v+(3*v+Math.max(v,Out(m)))*Math.pow(c,.5))>BXe&&(c=BXe),o=i}c<l&&(c=l);var g=Math.pow(c/l,.5);return[n*g,r*g]}(e,d,p,l,c):h?[h.width,h.height]:[l,c],v=r.sort;v&&"asc"!==v&&"desc"!==v&&(v="desc");var g={squareRatio:r.squareRatio,sort:v,leafDepth:r.leafDepth};p.hostTree.clearLayouts();var y={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};p.setLayout(y),Dut(p,g,!1,0),y=p.getLayout(),kut(f,function(e,t){var a=(f[t+1]||p).getValue();e.setLayout(hGe({dataExtent:[a,a],borderWidth:0,upperHeight:0},y))})}var b=e.getData().tree.root;b.setLayout(function(e,t,a){if(t)return{x:t.x,y:t.y};var n={x:0,y:0};if(!a)return n;var r=a.node,i=r.getLayout();if(!i)return n;var o=[i.width/2,i.height/2],s=r;for(;s;){var l=s.getLayout();o[0]+=l.x,o[1]+=l.y,s=s.parentNode}return{x:e.width/2-o[0],y:e.height/2-o[1]}}(o,h,d),!0),e.setLayoutInfo(o),Nut(b,new fqe(-o.x,-o.y,a.getWidth(),a.getHeight()),f,p,0)}};function Dut(e,t,a,n){var r,i;if(!e.isRemoved()){var o=e.getLayout();r=o.width,i=o.height;var s=e.getModel(),l=s.get(Cut),c=s.get(Aut)/2,u=Out(s),d=Math.max(l,u),h=l-c,p=d-c;e.setLayout({borderWidth:l,upperHeight:d,upperLabelHeight:u},!0);var f=(r=Sut(r-2*h,0))*(i=Sut(i-h-p,0)),m=function(e,t,a,n,r,i){var o=e.children||[],s=n.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=n.leafDepth&&n.leafDepth<=i;if(r&&!l)return e.viewChildren=[];o=xGe(o,function(e){return!e.isRemoved()}),function(e,t){t&&e.sort(function(e,a){var n="asc"===t?e.getValue()-a.getValue():a.getValue()-e.getValue();return 0===n?"asc"===t?e.dataIndex-a.dataIndex:a.dataIndex-e.dataIndex:n})}(o,s);var c=function(e,t,a){for(var n=0,r=0,i=t.length;r<i;r++)n+=t[r].getValue();var o,s=e.get("visualDimension");t&&t.length?"value"===s&&a?(o=[t[t.length-1].getValue(),t[0].getValue()],"asc"===a&&o.reverse()):(o=[1/0,-1/0],kut(t,function(e){var t=e.getValue(s);t<o[0]&&(o[0]=t),t>o[1]&&(o[1]=t)})):o=[NaN,NaN];return{sum:n,dataExtent:o}}(t,o,s);if(0===c.sum)return e.viewChildren=[];if(c.sum=function(e,t,a,n,r){if(!n)return a;for(var i=e.get("visibleMin"),o=r.length,s=o,l=o-1;l>=0;l--){var c=r["asc"===n?o-l-1:l].getValue();c/a*t<i&&(s=l,a-=c)}return"asc"===n?r.splice(0,o-s):r.splice(s,o-s),a}(t,a,c.sum,s,o),0===c.sum)return e.viewChildren=[];for(var u=0,d=o.length;u<d;u++){var h=o[u].getValue()/c.sum*a;o[u].setLayout({area:h})}l&&(o.length&&e.setLayout({isLeafRoot:!0},!0),o.length=0);return e.viewChildren=o,e.setLayout({dataExtent:c.dataExtent},!0),o}(e,s,f,t,a,n);if(m.length){var v={x:h,y:p,width:r,height:i},g=Mut(r,i),y=1/0,b=[];b.area=0;for(var x=0,w=m.length;x<w;){var _=m[x];b.push(_),b.area+=_.getLayout().area;var S=Put(b,g,t.squareRatio);S<=y?(x++,y=S):(b.area-=b.pop().getLayout().area,Lut(b,g,v,c,!1),g=Mut(v.width,v.height),b.length=b.area=0,y=1/0)}if(b.length&&Lut(b,g,v,c,!0),!a){var M=s.get("childrenVisibleMin");null!=M&&f<M&&(a=!0)}for(x=0,w=m.length;x<w;x++)Dut(m[x],t,a,n+1)}}}function Put(e,t,a){for(var n=0,r=1/0,i=0,o=void 0,s=e.length;i<s;i++)(o=e[i].getLayout().area)&&(o<r&&(r=o),o>n&&(n=o));var l=e.area*e.area,c=t*t*a;return l?Sut(c*n/l,l/(c*r)):1/0}function Lut(e,t,a,n,r){var i=t===a.width?0:1,o=1-i,s=["x","y"],l=["width","height"],c=a[s[i]],u=t?e.area/t:0;(r||u>a[l[o]])&&(u=a[l[o]]);for(var d=0,h=e.length;d<h;d++){var p=e[d],f={},m=u?p.getLayout().area/u:0,v=f[l[o]]=Sut(u-2*n,0),g=a[s[i]]+a[l[i]]-c,y=d===h-1||g<m?g:m,b=f[l[i]]=Sut(y-2*n,0);f[s[o]]=a[s[o]]+Mut(n,v/2),f[s[i]]=c+Mut(n,b/2),c+=y,p.setLayout(f,!0)}a[s[o]]+=u,a[l[o]]-=u}function Nut(e,t,a,n,r){var i=e.getLayout(),o=a[r],s=o&&o===e;if(!(o&&!s||r===a.length&&e!==n)){e.setLayout({isInView:!0,invisible:!s&&!t.intersect(i),isAboveViewRoot:s},!0);var l=new fqe(t.x-i.x,t.y-i.y,t.width,t.height);kut(e.viewChildren||[],function(e){Nut(e,l,a,n,r+1)})}}function Out(e){return e.get(Eut)?e.get(Iut):0}function Fut(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.eachSeriesByType("graph",function(e){var a=e.getCategoriesData(),n=e.getGraph().data,r=a.mapArray(a.getName);n.filterSelf(function(e){var a=n.getItemModel(e).getShallow("category");if(null!=a){EGe(a)&&(a=r[a]);for(var i=0;i<t.length;i++)if(!t[i].isSelected(a))return!1}return!0})})}function But(e){var t={};e.eachSeriesByType("graph",function(e){var a=e.getCategoriesData(),n=e.getData(),r={};a.each(function(n){var i=a.getName(n);r["ec-"+i]=n;var o=a.getItemModel(n),s=o.getModel("itemStyle").getItemStyle();s.fill||(s.fill=e.getColorFromPalette(i,t)),a.setItemVisual(n,"style",s);for(var l=["symbol","symbolSize","symbolKeepAspect"],c=0;c<l.length;c++){var u=o.getShallow(l[c],!0);null!=u&&a.setItemVisual(n,l[c],u)}}),a.count()&&n.each(function(e){var t=n.getItemModel(e).getShallow("category");if(null!=t){CGe(t)&&(t=r["ec-"+t]);var i=a.getItemVisual(t,"style");hGe(n.ensureUniqueItemVisual(e,"style"),i);for(var o=["symbol","symbolSize","symbolKeepAspect"],s=0;s<o.length;s++)n.setItemVisual(e,o[s],a.getItemVisual(t,o[s]))}})})}function Uut(e){return e instanceof Array||(e=[e,e]),e}function zut(e){e.eachSeriesByType("graph",function(e){var t=e.getGraph(),a=e.getEdgeData(),n=Uut(e.get("edgeSymbol")),r=Uut(e.get("edgeSymbolSize"));a.setVisual("fromSymbol",n&&n[0]),a.setVisual("toSymbol",n&&n[1]),a.setVisual("fromSymbolSize",r&&r[0]),a.setVisual("toSymbolSize",r&&r[1]),a.setVisual("style",e.getModel("lineStyle").getLineStyle()),a.each(function(e){var n=a.getItemModel(e),r=t.getEdgeByIndex(e),i=Uut(n.getShallow("symbol",!0)),o=Uut(n.getShallow("symbolSize",!0)),s=n.getModel("lineStyle").getLineStyle(),l=a.ensureUniqueItemVisual(e,"style");switch(hGe(l,s),l.stroke){case"source":var c=r.node1.getVisual("style");l.stroke=c&&c.fill;break;case"target":c=r.node2.getVisual("style");l.stroke=c&&c.fill}i[0]&&r.setVisual("fromSymbol",i[0]),i[1]&&r.setVisual("toSymbol",i[1]),o[0]&&r.setVisual("fromSymbolSize",o[0]),o[1]&&r.setVisual("toSymbolSize",o[1])})})}var Vut="--\x3e",Hut=function(e){return e.get("autoCurveness")||null},Gut=function(e,t){var a=Hut(e),n=20,r=[];if(EGe(a))n=a;else if(TGe(a))return void(e.__curvenessList=a);t>n&&(n=t);var i=n%2?n+2:n+3;r=[];for(var o=0;o<i;o++)r.push((o%2?o+1:o)/10*(o%2?-1:1));e.__curvenessList=r},Wut=function(e,t,a){var n=[e.id,e.dataIndex].join("."),r=[t.id,t.dataIndex].join(".");return[a.uid,n,r].join(Vut)},qut=function(e){var t=e.split(Vut);return[t[0],t[2],t[1]].join(Vut)},Yut=function(e,t){var a=t.__edgeMap;return a[e]?a[e].length:0};function jut(e,t,a,n){var r=Hut(t),i=TGe(r);if(!r)return null;var o=function(e,t){var a=Wut(e.node1,e.node2,t);return t.__edgeMap[a]}(e,t);if(!o)return null;for(var s=-1,l=0;l<o.length;l++)if(o[l]===a){s=l;break}var c=function(e,t){return Yut(Wut(e.node1,e.node2,t),t)+Yut(Wut(e.node2,e.node1,t),t)}(e,t);Gut(t,c),e.lineStyle=e.lineStyle||{};var u=Wut(e.node1,e.node2,t),d=t.__curvenessList,h=i||c%2?0:1;if(o.isForward)return d[h+s];var p=qut(u),f=Yut(p,t),m=d[s+f+h];return n?i?r&&0===r[0]?(f+h)%2?m:-m:((f%2?0:1)+h)%2?m:-m:(f+h)%2?m:-m:d[s+f+h]}function Xut(e){var t=e.coordinateSystem;if(!t||"view"===t.type){var a=e.getGraph();a.eachNode(function(e){var t=e.getModel();e.setLayout([+t.get("x"),+t.get("y")])}),$ut(a,e)}}function $ut(e,t){e.eachEdge(function(e,a){var n=BGe(e.getModel().get(["lineStyle","curveness"]),-jut(e,t,a,!0),0),r=rWe(e.node1.getLayout()),i=rWe(e.node2.getLayout()),o=[r,i];+n&&o.push([(r[0]+i[0])/2-(r[1]-i[1])*n,(r[1]+i[1])/2-(i[0]-r[0])*n]),e.setLayout(o)})}function Kut(e,t){e.eachSeriesByType("graph",function(e){var t=e.get("layout"),a=e.coordinateSystem;if(a&&"view"!==a.type){var n=e.getData(),r=[];gGe(a.dimensions,function(e){r=r.concat(n.mapDimensionsAll(e))});for(var i=0;i<n.count();i++){for(var o=[],s=!1,l=0;l<r.length;l++){var c=n.get(r[l],i);isNaN(c)||(s=!0),o.push(c)}s?n.setItemLayout(i,a.dataToPoint(o)):n.setItemLayout(i,[NaN,NaN])}$ut(n.graph,e)}else t&&"none"!==t||Xut(e)})}function Zut(e){var t=e.coordinateSystem;if("view"!==t.type)return 1;var a=e.option.nodeScaleRatio,n=t.scaleX;return((t.getZoom()-1)*a+1)/n}function Jut(e){var t=e.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),+t}var Qut=Math.PI,edt=[];function tdt(e,t,a,n){var r=e.coordinateSystem;if(!r||"view"===r.type){var i=r.getBoundingRect(),o=e.getData(),s=o.graph,l=i.width/2+i.x,c=i.height/2+i.y,u=Math.min(i.width,i.height)/2,d=o.count();if(o.setLayout({cx:l,cy:c}),d){if(a){var h=r.pointToData(n),p=h[0],f=h[1],m=[p-l,f-c];dWe(m,m),uWe(m,m,u),a.setLayout([l+m[0],c+m[1]],!0),ndt(a,e.get(["circular","rotateLabel"]),l,c)}adt[t](e,s,o,u,l,c,d),s.eachEdge(function(t,a){var n,r=BGe(t.getModel().get(["lineStyle","curveness"]),jut(t,e,a),0),i=rWe(t.node1.getLayout()),o=rWe(t.node2.getLayout()),s=(i[0]+o[0])/2,u=(i[1]+o[1])/2;+r&&(n=[l*(r*=3)+s*(1-r),c*r+u*(1-r)]),t.setLayout([i,o,n])})}}}var adt={value:function(e,t,a,n,r,i,o){var s=0,l=a.getSum("value"),c=2*Math.PI/(l||o);t.eachNode(function(e){var t=e.getValue("value"),a=c*(l?t:1)/2;s+=a,e.setLayout([n*Math.cos(s)+r,n*Math.sin(s)+i]),s+=a})},symbolSize:function(e,t,a,n,r,i,o){var s=0;edt.length=o;var l=Zut(e);t.eachNode(function(e){var t=Jut(e);isNaN(t)&&(t=2),t<0&&(t=0),t*=l;var a=Math.asin(t/2/n);isNaN(a)&&(a=Qut/2),edt[e.dataIndex]=a,s+=2*a});var c=(2*Qut-s)/o/2,u=0;t.eachNode(function(e){var t=c+edt[e.dataIndex];u+=t,(!e.getLayout()||!e.getLayout().fixed)&&e.setLayout([n*Math.cos(u)+r,n*Math.sin(u)+i]),u+=t})}};function ndt(e,t,a,n){var r=e.getGraphicEl();if(r){var i=e.getModel().get(["label","rotate"])||0,o=r.getSymbolPath();if(t){var s=e.getLayout(),l=Math.atan2(s[1]-n,s[0]-a);l<0&&(l=2*Math.PI+l);var c=s[0]<a;c&&(l-=Math.PI);var u=c?"left":"right";o.setTextConfig({rotation:-l,position:u,origin:"center"});var d=o.ensureState("emphasis");hGe(d.textConfig||(d.textConfig={}),{position:u})}else o.setTextConfig({rotation:i*=Math.PI/180})}}function rdt(e){e.eachSeriesByType("graph",function(e){"circular"===e.get("layout")&&tdt(e,"symbolSize")})}var idt=sWe;function odt(e){e.eachSeriesByType("graph",function(e){var t=e.coordinateSystem;if(!t||"view"===t.type)if("force"===e.get("layout")){var a=e.preservedPoints||{},n=e.getGraph(),r=n.data,i=n.edgeData,o=e.getModel("force"),s=o.get("initLayout");e.preservedPoints?r.each(function(e){var t=r.getId(e);r.setItemLayout(e,a[t]||[NaN,NaN])}):s&&"none"!==s?"circular"===s&&tdt(e,"value"):Xut(e);var l=r.getDataExtent("value"),c=i.getDataExtent("value"),u=o.get("repulsion"),d=o.get("edgeLength"),h=TGe(u)?u:[u,u],p=TGe(d)?d:[d,d];p=[p[1],p[0]];var f=r.mapArray("value",function(e,t){var a=r.getItemLayout(t),n=IXe(e,l,h);return isNaN(n)&&(n=(h[0]+h[1])/2),{w:n,rep:n,fixed:r.getItemModel(t).get("fixed"),p:!a||isNaN(a[0])||isNaN(a[1])?null:a}}),m=i.mapArray("value",function(t,a){var r=n.getEdgeByIndex(a),i=IXe(t,c,p);isNaN(i)&&(i=(p[0]+p[1])/2);var o=r.getModel(),s=BGe(r.getModel().get(["lineStyle","curveness"]),-jut(r,e,a,!0),0);return{n1:f[r.node1.dataIndex],n2:f[r.node2.dataIndex],d:i,curveness:s,ignoreForceLayout:o.get("ignoreForceLayout")}}),v=t.getBoundingRect(),g=function(e,t,a){for(var n=e,r=t,i=a.rect,o=i.width,s=i.height,l=[i.x+o/2,i.y+s/2],c=null==a.gravity?.1:a.gravity,u=0;u<n.length;u++){var d=n[u];d.p||(d.p=aWe(o*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),d.pp=rWe(d.p),d.edges=null}var h,p,f=null==a.friction?.6:a.friction,m=f;return{warmUp:function(){m=.8*f},setFixed:function(e){n[e].fixed=!0},setUnfixed:function(e){n[e].fixed=!1},beforeStep:function(e){h=e},afterStep:function(e){p=e},step:function(e){h&&h(n,r);for(var t=[],a=n.length,i=0;i<r.length;i++){var o=r[i];if(!o.ignoreForceLayout){var s=o.n1;lWe(t,(v=o.n2).p,s.p);var u=cWe(t)-o.d,d=v.w/(s.w+v.w);isNaN(d)&&(d=0),dWe(t,t),!s.fixed&&idt(s.p,s.p,t,d*u*m),!v.fixed&&idt(v.p,v.p,t,-(1-d)*u*m)}}for(i=0;i<a;i++)(b=n[i]).fixed||(lWe(t,l,b.p),idt(b.p,b.p,t,c*m));for(i=0;i<a;i++){s=n[i];for(var f=i+1;f<a;f++){var v;lWe(t,(v=n[f]).p,s.p),0===(u=cWe(t))&&(iWe(t,Math.random()-.5,Math.random()-.5),u=1);var g=(s.rep+v.rep)/u/u;!s.fixed&&idt(s.pp,s.pp,t,g),!v.fixed&&idt(v.pp,v.pp,t,-g)}}var y=[];for(i=0;i<a;i++){var b;(b=n[i]).fixed||(lWe(y,b.p,b.pp),idt(b.p,b.p,y,m),nWe(b.pp,b.p))}var x=(m*=.992)<.01;p&&p(n,r,x),e&&e(x)}}}(f,m,{rect:v,gravity:o.get("gravity"),friction:o.get("friction")});g.beforeStep(function(e,t){for(var a=0,r=e.length;a<r;a++)e[a].fixed&&nWe(e[a].p,n.getNodeByIndex(a).getLayout())}),g.afterStep(function(e,t,i){for(var o=0,s=e.length;o<s;o++)e[o].fixed||n.getNodeByIndex(o).setLayout(e[o].p),a[r.getId(o)]=e[o].p;for(o=0,s=t.length;o<s;o++){var l=t[o],c=n.getEdgeByIndex(o),u=l.n1.p,d=l.n2.p,h=c.getLayout();(h=h?h.slice():[])[0]=h[0]||[],h[1]=h[1]||[],nWe(h[0],u),nWe(h[1],d),+l.curveness&&(h[2]=[(u[0]+d[0])/2-(u[1]-d[1])*l.curveness,(u[1]+d[1])/2-(d[0]-u[0])*l.curveness]),c.setLayout(h)}}),e.forceLayout=g,e.preservedPoints=a,g.step()}else e.forceLayout=null})}function sdt(e,t){var a=[];return e.eachSeriesByType("graph",function(n){z2e({targetModel:n,coordSysType:"view",coordSysProvider:function(){var r=n.getData(),i=r.mapArray(function(e){var t=r.getItemModel(e);return[+t.get("x"),+t.get("y")]}),o=[],s=[];TKe(i,o,s),s[0]-o[0]===0&&(s[0]+=1,o[0]-=1);s[1]-o[1]===0&&(s[1]+=1,o[1]-=1);var l=(s[0]-o[0])/(s[1]-o[1]),c=function(e,t,a){var n=J2e(e,t),r=hGe(e.getBoxLayoutParams(),{aspect:a});return K2e(e,$2e(r,n.refContainer),a)}(n,t,l);isNaN(l)&&(o=[c.x,c.y],s=[c.x+c.width,c.y+c.height]);var u=s[0]-o[0],d=s[1]-o[1],h=new Wlt(null,{api:t,ecModel:e});return h.zoomLimit=n.get("scaleLimit"),h.setBoundingRect(o[0],o[1],u,d),h.setViewRect(c.x,c.y,c.width,c.height),h.setCenter(n.get("center")),h.setZoom(n.get("zoom")),a.push(h),h},isDefaultDataCoordSys:!0})}),a}var ldt=UQe.prototype,cdt=GQe.prototype,udt=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1};function ddt(e){return isNaN(+e.cpx1)||isNaN(+e.cpy1)}!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}zHe(t,e)}(udt);var hdt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="ec-line",a}return zHe(t,e),t.prototype.getDefaultStyle=function(){return{stroke:o5e.color.neutral99,fill:null}},t.prototype.getDefaultShape=function(){return new udt},t.prototype.buildPath=function(e,t){ddt(t)?ldt.buildPath.call(this,e,t):cdt.buildPath.call(this,e,t)},t.prototype.pointAt=function(e){return ddt(this.shape)?ldt.pointAt.call(this,e):cdt.pointAt.call(this,e)},t.prototype.tangentAt=function(e){var t=this.shape,a=ddt(t)?[t.x2-t.x1,t.y2-t.y1]:cdt.tangentAt.call(this,e);return dWe(a,a)},t}(gZe),pdt=["fromSymbol","toSymbol"];function fdt(e){return"_"+e+"Type"}function mdt(e,t,a){var n=t.getItemVisual(a,e);if(!n||"none"===n)return n;var r=t.getItemVisual(a,e+"Size"),i=t.getItemVisual(a,e+"Rotate"),o=t.getItemVisual(a,e+"Offset"),s=t.getItemVisual(a,e+"KeepAspect"),l=b8e(r);return n+l+x8e(o||0,l)+(i||"")+(s||"")}function vdt(e,t,a){var n=t.getItemVisual(a,e);if(n&&"none"!==n){var r=t.getItemVisual(a,e+"Size"),i=t.getItemVisual(a,e+"Rotate"),o=t.getItemVisual(a,e+"Offset"),s=t.getItemVisual(a,e+"KeepAspect"),l=b8e(r),c=x8e(o||0,l),u=y8e(n,-l[0]/2+c[0],-l[1]/2+c[1],l[0],l[1],null,s);return u.__specifiedRotation=null==i||isNaN(i)?void 0:+i*Math.PI/180||0,u.name=e,u}}function gdt(e,t){e.x1=t[0][0],e.y1=t[0][1],e.x2=t[1][0],e.y2=t[1][1],e.percent=1;var a=t[2];a?(e.cpx1=a[0],e.cpy1=a[1]):(e.cpx1=NaN,e.cpy1=NaN)}var ydt=function(e){function t(t,a,n){var r=e.call(this)||this;return r._createLine(t,a,n),r}return zHe(t,e),t.prototype._createLine=function(e,t,a){var n=e.hostModel,r=e.getItemLayout(t),i=e.getItemVisual(t,"z2"),o=function(e){var t=new hdt({name:"line",subPixelOptimize:!0});return gdt(t.shape,e),t}(r);o.shape.percent=0,d0e(o,{z2:FGe(i,0),shape:{percent:1}},n,t),this.add(o),gGe(pdt,function(a){var n=vdt(a,e,t);this.add(n),this[fdt(a)]=mdt(a,e,t)},this),this._updateCommonStl(e,t,a)},t.prototype.updateData=function(e,t,a){var n=e.hostModel,r=this.childOfName("line"),i=e.getItemLayout(t),o={shape:{}};gdt(o.shape,i),u0e(r,o,n,t),gGe(pdt,function(a){var n=mdt(a,e,t),r=fdt(a);if(this[r]!==n){this.remove(this.childOfName(a));var i=vdt(a,e,t);this.add(i)}this[r]=n},this),this._updateCommonStl(e,t,a)},t.prototype.getLinePath=function(){return this.childAt(0)},t.prototype._updateCommonStl=function(e,t,a){var n=e.hostModel,r=this.childOfName("line"),i=a&&a.emphasisLineStyle,o=a&&a.blurLineStyle,s=a&&a.selectLineStyle,l=a&&a.labelStatesModels,c=a&&a.emphasisDisabled,u=a&&a.focus,d=a&&a.blurScope;if(!a||e.hasItemOption){var h=e.getItemModel(t),p=h.getModel("emphasis");i=p.getModel("lineStyle").getLineStyle(),o=h.getModel(["blur","lineStyle"]).getLineStyle(),s=h.getModel(["select","lineStyle"]).getLineStyle(),c=p.get("disabled"),u=p.get("focus"),d=p.get("blurScope"),l=i1e(h)}var f=e.getItemVisual(t,"style"),m=f.stroke;r.useStyle(f),r.style.fill=null,r.style.strokeNoScale=!0,r.ensureState("emphasis").style=i,r.ensureState("blur").style=o,r.ensureState("select").style=s,gGe(pdt,function(e){var t=this.childOfName(e);if(t){t.setColor(m),t.style.opacity=f.opacity;for(var a=0;a<JZe.length;a++){var n=JZe[a],i=r.getState(n);if(i){var o=i.style||{},s=t.ensureState(n),l=s.style||(s.style={});null!=o.stroke&&(l[t.__isEmptyBrush?"stroke":"fill"]=o.stroke),null!=o.opacity&&(l.opacity=o.opacity)}}t.markRedraw()}},this);var v=n.getRawValue(t);r1e(this,l,{labelDataIndex:t,labelFetcher:{getFormattedLabel:function(t,a){return n.getFormattedLabel(t,a,e.dataType)}},inheritColor:m||o5e.color.neutral99,defaultOpacity:f.opacity,defaultText:(null==v?e.getName(t):isFinite(v)?PXe(v):v)+""});var g=this.getTextContent();if(g){var y=l.normal;g.__align=g.style.align,g.__verticalAlign=g.style.verticalAlign,g.__position=y.get("position")||"middle";var b=y.get("distance");TGe(b)||(b=[b,b]),g.__labelDistance=b}this.setTextConfig({position:null,local:!0,inside:!1}),OJe(this,u,d,c)},t.prototype.highlight=function(){_Je(this)},t.prototype.downplay=function(){SJe(this)},t.prototype.updateLayout=function(e,t){this.setLinePoints(e.getItemLayout(t))},t.prototype.setLinePoints=function(e){var t=this.childOfName("line");gdt(t.shape,e),t.dirty()},t.prototype.beforeUpdate=function(){var e=this,t=e.childOfName("fromSymbol"),a=e.childOfName("toSymbol"),n=e.getTextContent();if(t||a||n&&!n.ignore){for(var r=1,i=this.parent;i;)i.scaleX&&(r/=i.scaleX),i=i.parent;var o=e.childOfName("line");if(this.__dirty||o.__dirty){var s=o.shape.percent,l=o.pointAt(0),c=o.pointAt(s),u=lWe([],c,l);if(dWe(u,u),t&&(t.setPosition(l),S(t,0),t.scaleX=t.scaleY=r*s,t.markRedraw()),a&&(a.setPosition(c),S(a,1),a.scaleX=a.scaleY=r*s,a.markRedraw()),n&&!n.ignore){n.x=n.y=0,n.originX=n.originY=0;var d=void 0,h=void 0,p=n.__labelDistance,f=p[0]*r,m=p[1]*r,v=s/2,g=o.tangentAt(v),y=[g[1],-g[0]],b=o.pointAt(v);y[1]>0&&(y[0]=-y[0],y[1]=-y[1]);var x=g[0]<0?-1:1;if("start"!==n.__position&&"end"!==n.__position){var w=-Math.atan2(g[1],g[0]);c[0]<l[0]&&(w=Math.PI+w),n.rotation=w}var _=void 0;switch(n.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":_=-m,h="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":_=m,h="top";break;default:_=0,h="middle"}switch(n.__position){case"end":n.x=u[0]*f+c[0],n.y=u[1]*m+c[1],d=u[0]>.8?"left":u[0]<-.8?"right":"center",h=u[1]>.8?"top":u[1]<-.8?"bottom":"middle";break;case"start":n.x=-u[0]*f+l[0],n.y=-u[1]*m+l[1],d=u[0]>.8?"right":u[0]<-.8?"left":"center",h=u[1]>.8?"bottom":u[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":n.x=f*x+l[0],n.y=l[1]+_,d=g[0]<0?"right":"left",n.originX=-f*x,n.originY=-_;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":n.x=b[0],n.y=b[1]+_,d="center",n.originY=-_;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":n.x=-f*x+c[0],n.y=c[1]+_,d=g[0]>=0?"right":"left",n.originX=f*x,n.originY=-_}n.scaleX=n.scaleY=r,n.setStyle({verticalAlign:n.__verticalAlign||h,align:n.__align||d})}}}function S(e,t){var a=e.__specifiedRotation;if(null==a){var n=o.tangentAt(t);e.attr("rotation",(1===t?-1:1)*Math.PI/2-Math.atan2(n[1],n[0]))}else e.attr("rotation",a)}},t}(xXe),bdt=function(){function e(e){this.group=new xXe,this._LineCtor=e||ydt}return e.prototype.updateData=function(e){var t=this;this._progressiveEls=null;var a=this,n=a.group,r=a._lineData;a._lineData=e,r||n.removeAll();var i=xdt(e);e.diff(r).add(function(a){t._doAdd(e,a,i)}).update(function(a,n){t._doUpdate(r,e,n,a,i)}).remove(function(e){n.remove(r.getItemGraphicEl(e))}).execute()},e.prototype.updateLayout=function(){var e=this._lineData;e&&e.eachItemGraphicEl(function(t,a){t.updateLayout(e,a)},this)},e.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=xdt(e),this._lineData=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(e,t){function a(e){e.isGroup||function(e){return e.animators&&e.animators.length>0}(e)||(e.incremental=!0,e.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[];for(var n=e.start;n<e.end;n++){if(_dt(t.getItemLayout(n))){var r=new this._LineCtor(t,n,this._seriesScope);r.traverse(a),this.group.add(r),t.setItemGraphicEl(n,r),this._progressiveEls.push(r)}}},e.prototype.remove=function(){this.group.removeAll()},e.prototype.eachRendered=function(e){q0e(this._progressiveEls||this.group,e)},e.prototype._doAdd=function(e,t,a){if(_dt(e.getItemLayout(t))){var n=new this._LineCtor(e,t,a);e.setItemGraphicEl(t,n),this.group.add(n)}},e.prototype._doUpdate=function(e,t,a,n,r){var i=e.getItemGraphicEl(a);_dt(t.getItemLayout(n))?(i?i.updateData(t,n,r):i=new this._LineCtor(t,n,r),t.setItemGraphicEl(n,i),this.group.add(i)):this.group.remove(i)},e}();function xdt(e){var t=e.hostModel,a=t.getModel("emphasis");return{lineStyle:t.getModel("lineStyle").getLineStyle(),emphasisLineStyle:a.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:t.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:t.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:a.get("disabled"),blurScope:a.get("blurScope"),focus:a.get("focus"),labelStatesModels:i1e(t)}}function wdt(e){return isNaN(e[0])||isNaN(e[1])}function _dt(e){return e&&!wdt(e[0])&&!wdt(e[1])}var Sdt=[],Mdt=[],Tdt=[],kdt=iYe,Cdt=fWe,Adt=Math.abs;function Edt(e,t,a){for(var n,r=e[0],i=e[1],o=e[2],s=1/0,l=a*a,c=.1,u=.1;u<=.9;u+=.1){Sdt[0]=kdt(r[0],i[0],o[0],u),Sdt[1]=kdt(r[1],i[1],o[1],u),(p=Adt(Cdt(Sdt,t)-l))<s&&(s=p,n=u)}for(var d=0;d<32;d++){var h=n+c;Mdt[0]=kdt(r[0],i[0],o[0],n),Mdt[1]=kdt(r[1],i[1],o[1],n),Tdt[0]=kdt(r[0],i[0],o[0],h),Tdt[1]=kdt(r[1],i[1],o[1],h);var p=Cdt(Mdt,t)-l;if(Adt(p)<.01)break;var f=Cdt(Tdt,t)-l;c/=2,p<0?f>=0?n+=c:n-=c:f>=0?n-=c:n+=c}return n}function Idt(e,t){var a=[],n=lYe,r=[[],[],[]],i=[[],[]],o=[];t/=2,e.eachEdge(function(e,s){var l=e.getLayout(),c=e.getVisual("fromSymbol"),u=e.getVisual("toSymbol");l.__original||(l.__original=[rWe(l[0]),rWe(l[1])],l[2]&&l.__original.push(rWe(l[2])));var d=l.__original;if(null!=l[2]){if(nWe(r[0],d[0]),nWe(r[1],d[2]),nWe(r[2],d[1]),c&&"none"!==c){var h=Jut(e.node1),p=Edt(r,d[0],h*t);n(r[0][0],r[1][0],r[2][0],p,a),r[0][0]=a[3],r[1][0]=a[4],n(r[0][1],r[1][1],r[2][1],p,a),r[0][1]=a[3],r[1][1]=a[4]}if(u&&"none"!==u){h=Jut(e.node2),p=Edt(r,d[1],h*t);n(r[0][0],r[1][0],r[2][0],p,a),r[1][0]=a[1],r[2][0]=a[2],n(r[0][1],r[1][1],r[2][1],p,a),r[1][1]=a[1],r[2][1]=a[2]}nWe(l[0],r[0]),nWe(l[1],r[2]),nWe(l[2],r[1])}else{if(nWe(i[0],d[0]),nWe(i[1],d[1]),lWe(o,i[1],i[0]),dWe(o,o),c&&"none"!==c){h=Jut(e.node1);sWe(i[0],i[0],o,h*t)}if(u&&"none"!==u){h=Jut(e.node2);sWe(i[1],i[1],o,-h*t)}nWe(l[0],i[0]),nWe(l[1],i[1])}})}var Rdt=v$e();function Ddt(e,t){e&&(Rdt(e).bridge=t)}function Pdt(e){return"view"===e.type}var Ldt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(e,t){var a=new Qnt,n=new bdt,r=this.group,i=new xXe;this._controller=new Tst(t.getZr()),this._controllerHost={target:i},i.add(a.group),i.add(n.group),r.add(i),this._symbolDraw=a,this._lineDraw=n,this._mainGroup=i,this._firstRender=!0},t.prototype.render=function(e,t,a){var n=this,r=e.coordinateSystem,i=!1;this._model=e,this._api=a,this._active=!0;var o=this._getThumbnailInfo();o&&o.bridge.reset(a);var s=this._symbolDraw,l=this._lineDraw;if(Pdt(r)){var c={x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY};this._firstRender?this._mainGroup.attr(c):u0e(this._mainGroup,c,e)}Idt(e.getGraph(),Zut(e));var u=e.getData();s.updateData(u);var d=e.getEdgeData();l.updateData(d),this._updateNodeAndLinkScale(),this._updateController(null,e,a),clearTimeout(this._layoutTimeout);var h=e.forceLayout,p=e.get(["force","layoutAnimation"]);h&&(i=!0,this._startForceLayoutIteration(h,a,p));var f=e.get("layout");u.graph.eachNode(function(t){var r=t.dataIndex,i=t.getGraphicEl(),o=t.getModel();if(i){i.off("drag").off("dragend");var s=o.get("draggable");s&&i.on("drag",function(o){switch(f){case"force":h.warmUp(),!n._layouting&&n._startForceLayoutIteration(h,a,p),h.setFixed(r),u.setItemLayout(r,[i.x,i.y]);break;case"circular":u.setItemLayout(r,[i.x,i.y]),t.setLayout({fixed:!0},!0),tdt(e,"symbolSize",t,[o.offsetX,o.offsetY]),n.updateLayout(e);break;default:u.setItemLayout(r,[i.x,i.y]),$ut(e.getGraph(),e),n.updateLayout(e)}}).on("dragend",function(){h&&h.setUnfixed(r)}),i.setDraggable(s,!!o.get("cursor")),"adjacency"===o.get(["emphasis","focus"])&&(YZe(i).focus=t.getAdjacentDataIndices())}}),u.graph.eachEdge(function(e){var t=e.getGraphicEl(),a=e.getModel().get(["emphasis","focus"]);t&&"adjacency"===a&&(YZe(t).focus={edge:[e.dataIndex],node:[e.node1.dataIndex,e.node2.dataIndex]})});var m="circular"===e.get("layout")&&e.get(["circular","rotateLabel"]),v=u.getLayout("cx"),g=u.getLayout("cy");u.graph.eachNode(function(e){ndt(e,m,v,g)}),this._firstRender=!1,i||this._renderThumbnail(e,a,this._symbolDraw,this._lineDraw)},t.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype._startForceLayoutIteration=function(e,t,a){var n=this,r=!1;!function i(){e.step(function(e){n.updateLayout(n._model),!e&&r||(r=!0,n._renderThumbnail(n._model,t,n._symbolDraw,n._lineDraw)),(n._layouting=!e)&&(a?n._layoutTimeout=setTimeout(i,16):i())})}()},t.prototype._updateController=function(e,t,a){var n=this._controller,r=this._controllerHost,i=t.coordinateSystem;Pdt(i)?(n.enable(t.get("roam"),{api:a,zInfo:{component:t},triggerInfo:{roamTrigger:t.get("roamTrigger"),isInSelf:function(e,t,a){return i.containPoint([t,a])},isInClip:function(t,a,n){return!e||e.contain(a,n)}}}),r.zoomLimit=t.get("scaleLimit"),r.zoom=i.getZoom(),n.off("pan").off("zoom").on("pan",function(e){a.dispatchAction({seriesId:t.id,type:"graphRoam",dx:e.dx,dy:e.dy})}).on("zoom",function(e){a.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:e.scale,originX:e.originX,originY:e.originY})})):n.disable()},t.prototype.updateViewOnPan=function(e,t,a){this._active&&(Nst(this._controllerHost,a.dx,a.dy),this._updateThumbnailWindow())},t.prototype.updateViewOnZoom=function(e,t,a){this._active&&(Ost(this._controllerHost,a.zoom,a.originX,a.originY),this._updateNodeAndLinkScale(),Idt(e.getGraph(),Zut(e)),this._lineDraw.updateLayout(),t.updateLabelLayout(),this._updateThumbnailWindow())},t.prototype._updateNodeAndLinkScale=function(){var e=this._model,t=e.getData(),a=Zut(e);t.eachItemGraphicEl(function(e,t){e&&e.setSymbolScale(a)})},t.prototype.updateLayout=function(e){this._active&&(Idt(e.getGraph(),Zut(e)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout())},t.prototype.remove=function(){this._active=!1,clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove(),this._controller&&this._controller.disable()},t.prototype._getThumbnailInfo=function(){var e=this._model,t=e.coordinateSystem;if("view"===t.type){var a=function(e){if(e)return Rdt(e).bridge}(e);if(a)return{bridge:a,coordSys:t}}},t.prototype._updateThumbnailWindow=function(){var e=this._getThumbnailInfo();e&&e.bridge.updateWindow(e.coordSys.transform,this._api)},t.prototype._renderThumbnail=function(e,t,a,n){var r=this._getThumbnailInfo();if(r){var i=new xXe,o=a.group.children(),s=n.group.children(),l=new xXe,c=new xXe;i.add(c),i.add(l);for(var u=0;u<o.length;u++){var d=(g=o[u]).children()[0],h=g.x,p=g.y,f=hGe(cGe(d.shape),{width:d.scaleX,height:d.scaleY,x:h-d.scaleX/2,y:p-d.scaleY/2}),m=cGe(d.style),v=new d.constructor({shape:f,style:m,z2:151});c.add(v)}for(u=0;u<s.length;u++){var g,y=(g=s[u]).children()[0],b=(m=cGe(y.style),f=cGe(y.shape),new hdt({style:m,shape:f,z2:151}));l.add(b)}r.bridge.renderContent({api:t,roamType:e.get("roam"),viewportRect:null,group:i,targetTrans:r.coordSys.transform})}},t.type="graph",t}(s6e);function Ndt(e){return"_EC_"+e}var Odt=function(){function e(e){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=e||!1}return e.prototype.isDirected=function(){return this._directed},e.prototype.addNode=function(e,t){e=null==e?""+t:""+e;var a=this._nodesMap;if(!a[Ndt(e)]){var n=new Fdt(e,t);return n.hostGraph=this,this.nodes.push(n),a[Ndt(e)]=n,n}},e.prototype.getNodeByIndex=function(e){var t=this.data.getRawIndex(e);return this.nodes[t]},e.prototype.getNodeById=function(e){return this._nodesMap[Ndt(e)]},e.prototype.addEdge=function(e,t,a){var n=this._nodesMap,r=this._edgesMap;if(EGe(e)&&(e=this.nodes[e]),EGe(t)&&(t=this.nodes[t]),e instanceof Fdt||(e=n[Ndt(e)]),t instanceof Fdt||(t=n[Ndt(t)]),e&&t){var i=e.id+"-"+t.id,o=new Bdt(e,t,a);return o.hostGraph=this,this._directed&&(e.outEdges.push(o),t.inEdges.push(o)),e.edges.push(o),e!==t&&t.edges.push(o),this.edges.push(o),r[i]=o,o}},e.prototype.getEdgeByIndex=function(e){var t=this.edgeData.getRawIndex(e);return this.edges[t]},e.prototype.getEdge=function(e,t){e instanceof Fdt&&(e=e.id),t instanceof Fdt&&(t=t.id);var a=this._edgesMap;return this._directed?a[e+"-"+t]:a[e+"-"+t]||a[t+"-"+e]},e.prototype.eachNode=function(e,t){for(var a=this.nodes,n=a.length,r=0;r<n;r++)a[r].dataIndex>=0&&e.call(t,a[r],r)},e.prototype.eachEdge=function(e,t){for(var a=this.edges,n=a.length,r=0;r<n;r++)a[r].dataIndex>=0&&a[r].node1.dataIndex>=0&&a[r].node2.dataIndex>=0&&e.call(t,a[r],r)},e.prototype.breadthFirstTraverse=function(e,t,a,n){if(t instanceof Fdt||(t=this._nodesMap[Ndt(t)]),t){for(var r="out"===a?"outEdges":"in"===a?"inEdges":"edges",i=0;i<this.nodes.length;i++)this.nodes[i].__visited=!1;if(!e.call(n,t,null))for(var o=[t];o.length;){var s=o.shift(),l=s[r];for(i=0;i<l.length;i++){var c=l[i],u=c.node1===s?c.node2:c.node1;if(!u.__visited){if(e.call(n,u,s))return;o.push(u),u.__visited=!0}}}}},e.prototype.update=function(){for(var e=this.data,t=this.edgeData,a=this.nodes,n=this.edges,r=0,i=a.length;r<i;r++)a[r].dataIndex=-1;for(r=0,i=e.count();r<i;r++)a[e.getRawIndex(r)].dataIndex=r;t.filterSelf(function(e){var a=n[t.getRawIndex(e)];return a.node1.dataIndex>=0&&a.node2.dataIndex>=0});for(r=0,i=n.length;r<i;r++)n[r].dataIndex=-1;for(r=0,i=t.count();r<i;r++)n[t.getRawIndex(r)].dataIndex=r},e.prototype.clone=function(){for(var t=new e(this._directed),a=this.nodes,n=this.edges,r=0;r<a.length;r++)t.addNode(a[r].id,a[r].dataIndex);for(r=0;r<n.length;r++){var i=n[r];t.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return t},e}(),Fdt=function(){function e(e,t){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=null==e?"":e,this.dataIndex=null==t?-1:t}return e.prototype.degree=function(){return this.edges.length},e.prototype.inDegree=function(){return this.inEdges.length},e.prototype.outDegree=function(){return this.outEdges.length},e.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(e)},e.prototype.getAdjacentDataIndices=function(){for(var e={edge:[],node:[]},t=0;t<this.edges.length;t++){var a=this.edges[t];a.dataIndex<0||(e.edge.push(a.dataIndex),e.node.push(a.node1.dataIndex,a.node2.dataIndex))}return e},e.prototype.getTrajectoryDataIndices=function(){for(var e=$Ge(),t=$Ge(),a=0,n=this.edges.length;a<n;a++){var r=this.edges[a];if(!(r.dataIndex<0)){e.set(r.dataIndex,!0);for(var i=[r.node1],o=[r.node2],s=0;s<i.length;){var l=i[s];s++,t.set(l.dataIndex,!0);for(var c=l.inEdges,u=0,d=c.length,h=void 0,p=void 0;u<d;u++)(p=(h=c[u]).dataIndex)>=0&&!e.hasKey(p)&&(e.set(p,!0),i.push(h.node1))}for(s=0;s<o.length;){var f=o[s];s++,t.set(f.dataIndex,!0);for(var m=f.outEdges,v=(u=0,m.length),g=void 0,y=void 0;u<v;u++)(y=(g=m[u]).dataIndex)>=0&&!e.hasKey(y)&&(e.set(y,!0),o.push(g.node2))}}}return{edge:e.keys(),node:t.keys()}},e}(),Bdt=function(){function e(e,t,a){this.dataIndex=-1,this.node1=e,this.node2=t,this.dataIndex=null==a?-1:a}return e.prototype.getModel=function(e){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(e)},e.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},e.prototype.getTrajectoryDataIndices=function(){var e=$Ge(),t=$Ge();e.set(this.dataIndex,!0);for(var a=[this.node1],n=[this.node2],r=0;r<a.length;){var i=a[r];r++,t.set(i.dataIndex,!0);for(var o=0,s=i.inEdges.length,l=void 0,c=void 0;o<s;o++)(c=(l=i.inEdges[o]).dataIndex)>=0&&!e.hasKey(c)&&(e.set(c,!0),a.push(l.node1))}for(r=0;r<n.length;){var u=n[r];r++,t.set(u.dataIndex,!0);o=0,s=u.outEdges.length;for(var d=void 0,h=void 0;o<s;o++)(h=(d=u.outEdges[o]).dataIndex)>=0&&!e.hasKey(h)&&(e.set(h,!0),n.push(d.node2))}return{edge:e.keys(),node:t.keys()}},e}();function Udt(e,t){return{getValue:function(a){var n=this[e][t];return n.getStore().get(n.getDimensionIndex(a||"value"),this.dataIndex)},setVisual:function(a,n){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,a,n)},getVisual:function(a){return this[e][t].getItemVisual(this.dataIndex,a)},setLayout:function(a,n){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,a,n)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}}function zdt(e,t,a,n,r){for(var i=new Odt(n),o=0;o<e.length;o++)i.addNode(OGe(e[o].id,e[o].name,o),o);var s=[],l=[],c=0;for(o=0;o<t.length;o++){var u=t[o],d=u.source,h=u.target;i.addEdge(d,h,c)&&(l.push(u),s.push(OGe(h$e(u.id,null),d+" > "+h)),c++)}var p,f=a.get("coordinateSystem");if("cartesian2d"===f||"polar"===f||"matrix"===f)p=U9e(e,a);else{var m=D2e.get(f),v=m&&m.dimensions||[];fGe(v,"value")<0&&v.concat(["value"]);var g=R9e(e,{coordDimensions:v,encodeDefine:a.getEncode()}).dimensions;(p=new I9e(g,a)).initData(e)}var y=new I9e(["value"],a);return y.initData(l,s),r&&r(p,y),_ct({mainData:p,struct:i,structAttr:"graph",datas:{node:p,edge:y},datasAttr:{node:"data",edge:"edgeData"}}),i.update(),i}mGe(Fdt,Udt("hostGraph","data")),mGe(Bdt,Udt("hostGraph","edgeData"));var Vdt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a}return zHe(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments);var a=this;function n(){return a._categoriesData}this.legendVisualProvider=new xit(n,n),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},t.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(t.edges||t.links),this._updateCategoriesData()},t.prototype.mergeDefaultAndTheme=function(t){e.prototype.mergeDefaultAndTheme.apply(this,arguments),i$e(t,"edgeLabel",["show"])},t.prototype.getInitialData=function(e,t){var a,n=e.edges||e.links||[],r=e.data||e.nodes||[],i=this;if(r&&n){Hut(a=this)&&(a.__curvenessList=[],a.__edgeMap={},Gut(a));var o=zdt(r,n,this,!0,function(e,t){e.wrapMethod("getItemModel",function(e){var t=i._categoriesModels[e.getShallow("category")];return t&&(t.parentModel=e.parentModel,e.parentModel=t),e});var a=E1e.prototype.getModel;function n(e,t){var n=a.call(this,e,t);return n.resolveParentPath=r,n}function r(e){if(e&&("label"===e[0]||"label"===e[1])){var t=e.slice();return"label"===e[0]?t[0]="edgeLabel":"label"===e[1]&&(t[1]="edgeLabel"),t}return e}t.wrapMethod("getItemModel",function(e){return e.resolveParentPath=r,e.getModel=n,e})});return gGe(o.edges,function(e){!function(e,t,a,n){if(Hut(a)){var r=Wut(e,t,a),i=a.__edgeMap,o=i[qut(r)];i[r]&&!o?i[r].isForward=!0:o&&i[r]&&(o.isForward=!0,i[r].isForward=!1),i[r]=i[r]||[],i[r].push(n)}}(e.node1,e.node2,this,e.dataIndex)},this),o.data}},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.getCategoriesData=function(){return this._categoriesData},t.prototype.formatTooltip=function(e,t,a){if("edge"===a){var n=this.getData(),r=this.getDataParams(e,a),i=n.graph.getEdgeByIndex(e),o=n.getName(i.node1.dataIndex),s=n.getName(i.node2.dataIndex),l=[];return null!=o&&l.push(o),null!=s&&l.push(s),P3e("nameValue",{name:l.join(" > "),value:r.value,noValue:null==r.value})}return q3e({series:this,dataIndex:e,multipleSeries:t})},t.prototype._updateCategoriesData=function(){var e=yGe(this.option.categories||[],function(e){return null!=e.value?e:hGe({value:0},e)}),t=new I9e(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(e){return t.getItemModel(e)})},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.isAnimationEnabled=function(){return e.prototype.isAnimationEnabled.call(this)&&!("force"===this.get("layout")&&this.get(["force","layoutAnimation"]))},t.type="series.graph",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:o5e.color.neutral50,width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:o5e.color.primary}}},t}($3e);var Hdt=function(e){function t(t,a,n){var r=e.call(this)||this;YZe(r).dataType="node",r.z2=2;var i=new PZe;return r.setTextContent(i),r.updateData(t,a,n,!0),r}return zHe(t,e),t.prototype.updateData=function(e,t,a,n){var r=this,i=e.graph.getNodeByIndex(t),o=e.hostModel,s=i.getModel(),l=s.getModel("emphasis"),c=e.getItemLayout(t),u=hGe(Frt(s.getModel("itemStyle"),c,!0),c),d=this;if(isNaN(u.startAngle))d.setShape(u);else{n?d.setShape(u):u0e(d,{shape:u},o,t);var h=hGe(Frt(s.getModel("itemStyle"),c,!0),c);r.setShape(h),r.useStyle(e.getItemVisual(t,"style")),zJe(r,s),this._updateLabel(o,s,i),e.setItemGraphicEl(t,d),zJe(d,s,"itemStyle");var p=l.get("focus");OJe(this,"adjacency"===p?i.getAdjacentDataIndices():p,l.get("blurScope"),l.get("disabled"))}},t.prototype._updateLabel=function(e,t,a){var n=this.getTextContent(),r=a.getLayout(),i=(r.startAngle+r.endAngle)/2,o=Math.cos(i),s=Math.sin(i),l=t.getModel("label");n.ignore=!l.get("show");var c=i1e(t),u=a.getVisual("style");r1e(n,c,{labelFetcher:{getFormattedLabel:function(a,n,r,i,o,s){return e.getFormattedLabel(a,n,"node",i,BGe(o,c.normal&&c.normal.get("formatter"),t.get("name")),s)}},labelDataIndex:a.dataIndex,defaultText:a.dataIndex+"",inheritColor:u.fill,defaultOpacity:u.opacity,defaultOutsidePosition:"startArc"});var d,h=l.get("position")||"outside",p=l.get("distance")||0;d="outside"===h?r.r+p:(r.r+r.r0)/2,this.textConfig={inside:"outside"!==h};var f="outside"!==h?l.get("align")||"center":o>0?"left":"right",m="outside"!==h?l.get("verticalAlign")||"middle":s>0?"top":"bottom";n.attr({x:o*d+r.cx,y:s*d+r.cy,rotation:0,style:{align:f,verticalAlign:m}})},t}(EQe),Gdt=function(e){function t(t,a,n,r){var i=e.call(this)||this;return YZe(i).dataType="edge",i.updateData(t,a,n,r,!0),i}return zHe(t,e),t.prototype.buildPath=function(e,t){e.moveTo(t.s1[0],t.s1[1]);var a=.7,n=t.clockwise;e.arc(t.cx,t.cy,t.r,t.sStartAngle,t.sEndAngle,!n),e.bezierCurveTo((t.cx-t.s2[0])*a+t.s2[0],(t.cy-t.s2[1])*a+t.s2[1],(t.cx-t.t1[0])*a+t.t1[0],(t.cy-t.t1[1])*a+t.t1[1],t.t1[0],t.t1[1]),e.arc(t.cx,t.cy,t.r,t.tStartAngle,t.tEndAngle,!n),e.bezierCurveTo((t.cx-t.t2[0])*a+t.t2[0],(t.cy-t.t2[1])*a+t.t2[1],(t.cx-t.s1[0])*a+t.s1[0],(t.cy-t.s1[1])*a+t.s1[1],t.s1[0],t.s1[1]),e.closePath()},t.prototype.updateData=function(e,t,a,n,r){var i=e.hostModel,o=t.graph.getEdgeByIndex(a),s=o.getLayout(),l=o.node1.getModel(),c=t.getItemModel(o.dataIndex),u=c.getModel("lineStyle"),d=c.getModel("emphasis"),h=d.get("focus"),p=hGe(Frt(l.getModel("itemStyle"),s,!0),s),f=this;isNaN(p.sStartAngle)||isNaN(p.tStartAngle)?f.setShape(p):(r?(f.setShape(p),Wdt(f,o,e,u)):(v0e(f),Wdt(f,o,e,u),u0e(f,{shape:p},i,a)),OJe(this,"adjacency"===h?o.getAdjacentDataIndices():h,d.get("blurScope"),d.get("disabled")),zJe(f,c,"lineStyle"),t.setItemGraphicEl(o.dataIndex,f))},t}(gZe);function Wdt(e,t,a,n){var r=t.node1,i=t.node2,o=e.style;switch(e.setStyle(n.getLineStyle()),n.get("color")){case"source":o.fill=a.getItemVisual(r.dataIndex,"style").fill,o.decal=r.getVisual("style").decal;break;case"target":o.fill=a.getItemVisual(i.dataIndex,"style").fill,o.decal=i.getVisual("style").decal;break;case"gradient":var s=a.getItemVisual(r.dataIndex,"style").fill,l=a.getItemVisual(i.dataIndex,"style").fill;if(CGe(s)&&CGe(l)){var c=e.shape,u=(c.s1[0]+c.s2[0])/2,d=(c.s1[1]+c.s2[1])/2,h=(c.t1[0]+c.t2[0])/2,p=(c.t1[1]+c.t2[1])/2;o.fill=new XQe(u,d,h,p,[{offset:0,color:s},{offset:1,color:l}],!0)}}}var qdt=Math.PI/180,Ydt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(e,t){},t.prototype.render=function(e,t,a){var n=e.getData(),r=this._data,i=this.group,o=-e.get("startAngle")*qdt;if(n.diff(r).add(function(e){if(n.getItemLayout(e)){var t=new Hdt(n,e,o);YZe(t).dataIndex=e,i.add(t)}}).update(function(t,a){var s=r.getItemGraphicEl(a);n.getItemLayout(t)?(s?s.updateData(n,t,o):s=new Hdt(n,t,o),i.add(s)):s&&m0e(s,e,a)}).remove(function(t){var a=r.getItemGraphicEl(t);a&&m0e(a,e,t)}).execute(),!r){var s=e.get("center");this.group.scaleX=.01,this.group.scaleY=.01,this.group.originX=RXe(s[0],a.getWidth()),this.group.originY=RXe(s[1],a.getHeight()),d0e(this.group,{scaleX:1,scaleY:1},e)}this._data=n,this.renderEdges(e,o)},t.prototype.renderEdges=function(e,t){var a=e.getData(),n=e.getEdgeData(),r=this._edgeData,i=this.group;n.diff(r).add(function(e){var r=new Gdt(a,n,e,t);YZe(r).dataIndex=e,i.add(r)}).update(function(e,o){var s=r.getItemGraphicEl(o);s.updateData(a,n,e,t),i.add(s)}).remove(function(t){var a=r.getItemGraphicEl(t);a&&m0e(a,e,t)}).execute(),this._edgeData=n},t.prototype.dispose=function(){},t.type="chord",t}(s6e),jdt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments),this.fillDataTextStyle(t.edges||t.links),this.legendVisualProvider=new xit(SGe(this.getData,this),SGe(this.getRawData,this))},t.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(t.edges||t.links)},t.prototype.getInitialData=function(e,t){var a=e.edges||e.links||[],n=e.data||e.nodes||[];if(n&&a){var r=zdt(n,a,this,!0,function(e,t){var a=E1e.prototype.getModel;function n(e,t){var n=a.call(this,e,t);return n.resolveParentPath=r,n}function r(e){if(e&&("label"===e[0]||"label"===e[1])){var t=e.slice();return"label"===e[0]?t[0]="edgeLabel":"label"===e[1]&&(t[1]="edgeLabel"),t}return e}t.wrapMethod("getItemModel",function(e){return e.resolveParentPath=r,e.getModel=n,e})});return r.data}},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(e,t,a){var n=this.getDataParams(e,a);if("edge"===a){var r=this.getData(),i=r.graph.getEdgeByIndex(e),o=r.getName(i.node1.dataIndex),s=r.getName(i.node2.dataIndex),l=[];return null!=o&&l.push(o),null!=s&&l.push(s),P3e("nameValue",{name:l.join(" > "),value:n.value,noValue:null==n.value})}return P3e("nameValue",{name:n.name,value:n.value,noValue:null==n.value})},t.prototype.getDataParams=function(t,a){var n=e.prototype.getDataParams.call(this,t,a);if("node"===a){var r=this.getData(),i=this.getGraph().getNodeByIndex(t);if(null==n.name&&(n.name=r.getName(t)),null==n.value){var o=i.getLayout().value;n.value=o}}return n},t.type="series.chord",t.defaultOption={z:2,coordinateSystem:"none",legendHoverLink:!0,colorBy:"data",left:0,top:0,right:0,bottom:0,width:null,height:null,center:["50%","50%"],radius:["70%","80%"],clockwise:!0,startAngle:90,endAngle:"auto",minAngle:0,padAngle:3,itemStyle:{borderRadius:[0,0,5,5]},lineStyle:{width:0,color:"source",opacity:.2},label:{show:!0,position:"outside",distance:5},emphasis:{focus:"adjacency",lineStyle:{opacity:.5}}},t}($3e),Xdt=Math.PI/180;function $dt(e,t){e.eachSeriesByType("chord",function(e){!function(e,t){var a=e.getData(),n=a.graph,r=e.getEdgeData();if(!r.count())return;var i=X2e(e,t),o=i.cx,s=i.cy,l=i.r,c=i.r0,u=Math.max((e.get("padAngle")||0)*Xdt,0),d=Math.max((e.get("minAngle")||0)*Xdt,0),h=-e.get("startAngle")*Xdt,p=h+2*Math.PI,f=e.get("clockwise"),m=f?1:-1,v=[h,p];$Ke(v,!f);var g=v[0],y=v[1]-g,b=0===a.getSum("value")&&0===r.getSum("value"),x=[],w=0;n.eachEdge(function(e){var t=b?1:e.getValue("value");b&&(t>0||d)&&(w+=2);var a=e.node1.dataIndex,n=e.node2.dataIndex;x[a]=(x[a]||0)+t,x[n]=(x[n]||0)+t});var _=0;if(n.eachNode(function(e){var t=e.getValue("value");isNaN(t)||(x[e.dataIndex]=Math.max(t,x[e.dataIndex]||0)),!b&&(x[e.dataIndex]>0||d)&&w++,_+=x[e.dataIndex]||0}),0===w||0===_)return;u*w>=Math.abs(y)&&(u=Math.max(0,(Math.abs(y)-d*w)/w));(u+d)*w>=Math.abs(y)&&(d=(Math.abs(y)-u*w)/w);var S=(y-u*w*m)/_,M=0,T=0,k=0;n.eachNode(function(e){var t=x[e.dataIndex]||0,a=S*(_?t:1)*m;Math.abs(a)<d?M+=d-Math.abs(a):(T+=Math.abs(a)-d,k+=Math.abs(a)),e.setLayout({angle:a,value:t})});var C=!1;if(M>T){var A=M/T;n.eachNode(function(e){var t=e.getLayout().angle;Math.abs(t)>=d?e.setLayout({angle:t*A,ratio:A},!0):e.setLayout({angle:d,ratio:0===d?1:t/d},!0)})}else n.eachNode(function(e){if(!C){var t=e.getLayout().angle;t-Math.min(t/k,1)*M<d&&(C=!0)}});var E=M;n.eachNode(function(e){if(!(E<=0)){var t=e.getLayout().angle;if(t>d&&d>0){var a=C?1:Math.min(t/k,1),n=t-d,r=Math.min(n,Math.min(E,M*a));E-=r,e.setLayout({angle:t-r,ratio:(t-r)/t},!0)}else d>0&&e.setLayout({angle:d,ratio:0===t?1:d/t},!0)}});var I=g,R=[];n.eachNode(function(e){var t=Math.max(e.getLayout().angle,d);e.setLayout({cx:o,cy:s,r0:c,r:l,startAngle:I,endAngle:I+t*m,clockwise:f},!0),R[e.dataIndex]=I,I+=(t+u)*m}),n.eachEdge(function(e){var t=b?1:e.getValue("value"),a=S*(_?t:1)*m,n=e.node1.dataIndex,r=R[n]||0,i=r+Math.abs((e.node1.getLayout().ratio||1)*a)*m,l=[o+c*Math.cos(r),s+c*Math.sin(r)],u=[o+c*Math.cos(i),s+c*Math.sin(i)],d=e.node2.dataIndex,h=R[d]||0,p=h+Math.abs((e.node2.getLayout().ratio||1)*a)*m,v=[o+c*Math.cos(h),s+c*Math.sin(h)],g=[o+c*Math.cos(p),s+c*Math.sin(p)];e.setLayout({s1:l,s2:u,sStartAngle:r,sEndAngle:i,t1:v,t2:g,tStartAngle:h,tEndAngle:p,cx:o,cy:s,r:c,value:t,clockwise:f}),R[n]=i,R[d]=p})}(e,t)})}var Kdt=function(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0},Zdt=function(e){function t(t){var a=e.call(this,t)||this;return a.type="pointer",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Kdt},t.prototype.buildPath=function(e,t){var a=Math.cos,n=Math.sin,r=t.r,i=t.width,o=t.angle,s=t.x-a(o)*i*(i>=r/3?1:2),l=t.y-n(o)*i*(i>=r/3?1:2);o=t.angle-Math.PI/2,e.moveTo(s,l),e.lineTo(t.x+a(o)*i,t.y+n(o)*i),e.lineTo(t.x+a(t.angle)*r,t.y+n(t.angle)*r),e.lineTo(t.x-a(o)*i,t.y-n(o)*i),e.lineTo(s,l)},t}(gZe);function Jdt(e,t){var a=null==e?"":e+"";return t&&(CGe(t)?a=t.replace("{value}",a):kGe(t)&&(a=t(e))),a}var Qdt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){this.group.removeAll();var n=e.get(["axisLine","lineStyle","color"]),r=function(e,t){var a=e.get("center"),n=t.getWidth(),r=t.getHeight(),i=Math.min(n,r);return{cx:RXe(a[0],t.getWidth()),cy:RXe(a[1],t.getHeight()),r:RXe(e.get("radius"),i/2)}}(e,a);this._renderMain(e,t,a,n,r),this._data=e.getData()},t.prototype.dispose=function(){},t.prototype._renderMain=function(e,t,a,n,r){var i=this.group,o=e.get("clockwise"),s=-e.get("startAngle")/180*Math.PI,l=-e.get("endAngle")/180*Math.PI,c=e.getModel("axisLine"),u=c.get("roundCap")?Lrt:EQe,d=c.get("show"),h=c.getModel("lineStyle"),p=h.get("width"),f=[s,l];$Ke(f,!o);for(var m=(l=f[1])-(s=f[0]),v=s,g=[],y=0;d&&y<n.length;y++){var b=new u({shape:{startAngle:v,endAngle:l=s+m*Math.min(Math.max(n[y][0],0),1),cx:r.cx,cy:r.cy,clockwise:o,r0:r.r-p,r:r.r},silent:!0});b.setStyle({fill:n[y][1]}),b.setStyle(h.getLineStyle(["color","width"])),g.push(b),v=l}g.reverse(),gGe(g,function(e){return i.add(e)});var x=function(e){if(e<=0)return n[0][1];var t;for(t=0;t<n.length;t++)if(n[t][0]>=e&&(0===t?0:n[t-1][0])<e)return n[t][1];return n[t-1][1]};this._renderTicks(e,t,a,x,r,s,l,o,p),this._renderTitleAndDetail(e,t,a,x,r),this._renderAnchor(e,r),this._renderPointer(e,t,a,x,r,s,l,o,p)},t.prototype._renderTicks=function(e,t,a,n,r,i,o,s,l){for(var c,u,d=this.group,h=r.cx,p=r.cy,f=r.r,m=+e.get("min"),v=+e.get("max"),g=e.getModel("splitLine"),y=e.getModel("axisTick"),b=e.getModel("axisLabel"),x=e.get("splitNumber"),w=y.get("splitNumber"),_=RXe(g.get("length"),f),S=RXe(y.get("length"),f),M=i,T=(o-i)/x,k=T/w,C=g.getModel("lineStyle").getLineStyle(),A=y.getModel("lineStyle").getLineStyle(),E=g.get("distance"),I=0;I<=x;I++){if(c=Math.cos(M),u=Math.sin(M),g.get("show")){var R=new UQe({shape:{x1:c*(f-(D=E?E+l:l))+h,y1:u*(f-D)+p,x2:c*(f-_-D)+h,y2:u*(f-_-D)+p},style:C,silent:!0});"auto"===C.stroke&&R.setStyle({stroke:n(I/x)}),d.add(R)}if(b.get("show")){var D=b.get("distance")+E,P=Jdt(PXe(I/x*(v-m)+m),b.get("formatter")),L=n(I/x),N=c*(f-_-D)+h,O=u*(f-_-D)+p,F=b.get("rotate"),B=0;"radial"===F?(B=-M+2*Math.PI)>Math.PI/2&&(B+=Math.PI):"tangential"===F?B=-M-Math.PI/2:EGe(F)&&(B=F*Math.PI/180),0===B?d.add(new PZe({style:o1e(b,{text:P,x:N,y:O,verticalAlign:u<-.8?"top":u>.8?"bottom":"middle",align:c<-.4?"left":c>.4?"right":"center"},{inheritColor:L}),silent:!0})):d.add(new PZe({style:o1e(b,{text:P,x:N,y:O,verticalAlign:"middle",align:"center"},{inheritColor:L}),silent:!0,originX:N,originY:O,rotation:B}))}if(y.get("show")&&I!==x){D=(D=y.get("distance"))?D+l:l;for(var U=0;U<=w;U++){c=Math.cos(M),u=Math.sin(M);var z=new UQe({shape:{x1:c*(f-D)+h,y1:u*(f-D)+p,x2:c*(f-S-D)+h,y2:u*(f-S-D)+p},silent:!0,style:A});"auto"===A.stroke&&z.setStyle({stroke:n((I+U/w)/x)}),d.add(z),M+=k}M-=k}else M+=T}},t.prototype._renderPointer=function(e,t,a,n,r,i,o,s,l){var c=this.group,u=this._data,d=this._progressEls,h=[],p=e.get(["pointer","show"]),f=e.getModel("progress"),m=f.get("show"),v=e.getData(),g=v.mapDimension("value"),y=+e.get("min"),b=+e.get("max"),x=[y,b],w=[i,o];function _(t,a){var n,i=v.getItemModel(t).getModel("pointer"),o=RXe(i.get("width"),r.r),s=RXe(i.get("length"),r.r),l=e.get(["pointer","icon"]),c=i.get("offsetCenter"),u=RXe(c[0],r.r),d=RXe(c[1],r.r),h=i.get("keepAspect");return(n=l?y8e(l,u-o/2,d-s,o,s,null,h):new Zdt({shape:{angle:-Math.PI/2,width:o,r:s,x:u,y:d}})).rotation=-(a+Math.PI/2),n.x=r.cx,n.y=r.cy,n}function S(e,t){var a=f.get("roundCap")?Lrt:EQe,n=f.get("overlap"),o=n?f.get("width"):l/v.count(),c=n?r.r-o:r.r-(e+1)*o,u=n?r.r:r.r-e*o,d=new a({shape:{startAngle:i,endAngle:t,cx:r.cx,cy:r.cy,clockwise:s,r0:c,r:u}});return n&&(d.z2=IXe(v.get(g,e),[y,b],[100,0],!0)),d}(m||p)&&(v.diff(u).add(function(t){var a=v.get(g,t);if(p){var n=_(t,i);d0e(n,{rotation:-((isNaN(+a)?w[0]:IXe(a,x,w,!0))+Math.PI/2)},e),c.add(n),v.setItemGraphicEl(t,n)}if(m){var r=S(t,i),o=f.get("clip");d0e(r,{shape:{endAngle:IXe(a,x,w,o)}},e),c.add(r),jZe(e.seriesIndex,v.dataType,t,r),h[t]=r}}).update(function(t,a){var n=v.get(g,t);if(p){var r=u.getItemGraphicEl(a),o=r?r.rotation:i,s=_(t,o);s.rotation=o,u0e(s,{rotation:-((isNaN(+n)?w[0]:IXe(n,x,w,!0))+Math.PI/2)},e),c.add(s),v.setItemGraphicEl(t,s)}if(m){var l=d[a],y=S(t,l?l.shape.endAngle:i),b=f.get("clip");u0e(y,{shape:{endAngle:IXe(n,x,w,b)}},e),c.add(y),jZe(e.seriesIndex,v.dataType,t,y),h[t]=y}}).execute(),v.each(function(e){var t=v.getItemModel(e),a=t.getModel("emphasis"),r=a.get("focus"),i=a.get("blurScope"),o=a.get("disabled");if(p){var s=v.getItemGraphicEl(e),l=v.getItemVisual(e,"style"),c=l.fill;if(s instanceof _Ze){var u=s.style;s.useStyle(hGe({image:u.image,x:u.x,y:u.y,width:u.width,height:u.height},l))}else s.useStyle(l),"pointer"!==s.type&&s.setColor(c);s.setStyle(t.getModel(["pointer","itemStyle"]).getItemStyle()),"auto"===s.style.fill&&s.setStyle("fill",n(IXe(v.get(g,e),x,[0,1],!0))),s.z2EmphasisLift=0,zJe(s,t),OJe(s,r,i,o)}if(m){var d=h[e];d.useStyle(v.getItemVisual(e,"style")),d.setStyle(t.getModel(["progress","itemStyle"]).getItemStyle()),d.z2EmphasisLift=0,zJe(d,t),OJe(d,r,i,o)}}),this._progressEls=h)},t.prototype._renderAnchor=function(e,t){var a=e.getModel("anchor");if(a.get("show")){var n=a.get("size"),r=a.get("icon"),i=a.get("offsetCenter"),o=a.get("keepAspect"),s=y8e(r,t.cx-n/2+RXe(i[0],t.r),t.cy-n/2+RXe(i[1],t.r),n,n,null,o);s.z2=a.get("showAbove")?1:0,s.setStyle(a.getModel("itemStyle").getItemStyle()),this.group.add(s)}},t.prototype._renderTitleAndDetail=function(e,t,a,n,r){var i=this,o=e.getData(),s=o.mapDimension("value"),l=+e.get("min"),c=+e.get("max"),u=new xXe,d=[],h=[],p=e.isAnimationEnabled(),f=e.get(["pointer","showAbove"]);o.diff(this._data).add(function(e){d[e]=new PZe({silent:!0}),h[e]=new PZe({silent:!0})}).update(function(e,t){d[e]=i._titleEls[t],h[e]=i._detailEls[t]}).execute(),o.each(function(t){var a=o.getItemModel(t),i=o.get(s,t),m=new xXe,v=n(IXe(i,[l,c],[0,1],!0)),g=a.getModel("title");if(g.get("show")){var y=g.get("offsetCenter"),b=r.cx+RXe(y[0],r.r),x=r.cy+RXe(y[1],r.r);(A=d[t]).attr({z2:f?0:2,style:o1e(g,{x:b,y:x,text:o.getName(t),align:"center",verticalAlign:"middle"},{inheritColor:v})}),m.add(A)}var w=a.getModel("detail");if(w.get("show")){var _=w.get("offsetCenter"),S=r.cx+RXe(_[0],r.r),M=r.cy+RXe(_[1],r.r),T=RXe(w.get("width"),r.r),k=RXe(w.get("height"),r.r),C=e.get(["progress","show"])?o.getItemVisual(t,"style").fill:v,A=h[t],E=w.get("formatter");A.attr({z2:f?0:2,style:o1e(w,{x:S,y:M,text:Jdt(i,E),width:isNaN(T)?null:T,height:isNaN(k)?null:k,align:"center",verticalAlign:"middle"},{inheritColor:C})}),f1e(A,{normal:w},i,function(e){return Jdt(e,E)}),p&&m1e(A,t,o,e,{getFormattedLabel:function(e,t,a,n,r,o){return Jdt(o?o.interpolatedValue:i,E)}}),m.add(A)}u.add(m)}),this.group.add(u),this._titleEls=d,this._detailEls=h},t.type="gauge",t}(s6e),eht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.visualStyleAccessPath="itemStyle",a}return zHe(t,e),t.prototype.getInitialData=function(e,t){return yit(this,["value"])},t.type="series.gauge",t.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,o5e.color.neutral10]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:o5e.color.axisTick,width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:o5e.color.axisTickMinor,width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:o5e.color.axisLabel,fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:o5e.color.neutral00,borderWidth:0,borderColor:o5e.color.theme[0]}},title:{show:!0,offsetCenter:[0,"20%"],color:o5e.color.secondary,fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:o5e.color.transparent,borderWidth:0,borderColor:o5e.color.neutral40,width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:o5e.color.primary,fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},t}($3e);var tht=["itemStyle","opacity"],aht=function(e){function t(t,a){var n=e.call(this)||this,r=n,i=new OQe,o=new PZe;return r.setTextContent(o),n.setTextGuideLine(i),n.updateData(t,a,!0),n}return zHe(t,e),t.prototype.updateData=function(e,t,a){var n=this,r=e.hostModel,i=e.getItemModel(t),o=e.getItemLayout(t),s=i.getModel("emphasis"),l=i.get(tht);l=null==l?1:l,a||v0e(n),n.useStyle(e.getItemVisual(t,"style")),n.style.lineJoin="round",a?(n.setShape({points:o.points}),n.style.opacity=0,d0e(n,{style:{opacity:l}},r,t)):u0e(n,{style:{opacity:l},shape:{points:o.points}},r,t),zJe(n,i),this._updateLabel(e,t),OJe(this,s.get("focus"),s.get("blurScope"),s.get("disabled"))},t.prototype._updateLabel=function(e,t){var a=this,n=this.getTextGuideLine(),r=a.getTextContent(),i=e.hostModel,o=e.getItemModel(t),s=e.getItemLayout(t).label,l=e.getItemVisual(t,"style"),c=l.fill;r1e(r,i1e(o),{labelFetcher:e.hostModel,labelDataIndex:t,defaultOpacity:l.opacity,defaultText:e.getName(t)},{normal:{align:s.textAlign,verticalAlign:s.verticalAlign}});var u="inherit"===o.getModel("label").get("color")?c:null;a.setTextConfig({local:!0,inside:!!s.inside,insideStroke:u,outsideFill:u});var d=s.linePoints;n.setShape({points:d}),a.textGuideLineConfig={anchor:d?new eqe(d[0][0],d[0][1]):null},u0e(r,{style:{x:s.x,y:s.y}},i,t),r.attr({rotation:s.rotation,originX:s.x,originY:s.y,z2:10}),aat(a,nat(o),{stroke:c})},t}(LQe),nht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.ignoreLabelLineUpdate=!0,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=e.getData(),r=this._data,i=this.group;n.diff(r).add(function(e){var t=new aht(n,e);n.setItemGraphicEl(e,t),i.add(t)}).update(function(e,t){var a=r.getItemGraphicEl(t);a.updateData(n,e),i.add(a),n.setItemGraphicEl(e,a)}).remove(function(t){m0e(r.getItemGraphicEl(t),e,t)}).execute(),this._data=n},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.prototype.dispose=function(){},t.type="funnel",t}(s6e),rht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new xit(SGe(this.getData,this),SGe(this.getRawData,this)),this._defaultLabelLine(t)},t.prototype.getInitialData=function(e,t){return yit(this,{coordDimensions:["value"],encodeDefaulter:MGe(E5e,this)})},t.prototype._defaultLabelLine=function(e){i$e(e,"labelLine",["show"]);var t=e.labelLine,a=e.emphasis.labelLine;t.show=t.show&&e.label.show,a.show=a.show&&e.emphasis.label.show},t.prototype.getDataParams=function(t){var a=this.getData(),n=e.prototype.getDataParams.call(this,t),r=a.mapDimension("value"),i=a.getSum(r);return n.percent=i?+(a.get(r,t)/i*100).toFixed(2):0,n.$vars.push("percent"),n},t.type="series.funnel",t.defaultOption={coordinateSystemUsage:"box",z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:65,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:o5e.color.neutral00,borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:o5e.color.primary}}},t}($3e);function iht(e,t){e.eachSeriesByType("funnel",function(e){var a=e.getData(),n=a.mapDimension("value"),r=e.get("sort"),i=J2e(e,t),o=$2e(e.getBoxLayoutParams(),i.refContainer),s=e.get("orient"),l=o.width,c=o.height,u=function(e,t){for(var a=e.mapDimension("value"),n=e.mapArray(a,function(e){return e}),r=[],i="ascending"===t,o=0,s=e.count();o<s;o++)r[o]=o;return kGe(t)?r.sort(t):"none"!==t&&r.sort(function(e,t){return i?n[e]-n[t]:n[t]-n[e]}),r}(a,r),d=o.x,h=o.y,p="horizontal"===s?[RXe(e.get("minSize"),c),RXe(e.get("maxSize"),c)]:[RXe(e.get("minSize"),l),RXe(e.get("maxSize"),l)],f=a.getDataExtent(n),m=e.get("min"),v=e.get("max");null==m&&(m=Math.min(f[0],0)),null==v&&(v=f[1]);var g=e.get("funnelAlign"),y=e.get("gap"),b=(("horizontal"===s?l:c)-y*(a.count()-1))/a.count(),x=function(e,t){if("horizontal"===s){var r=IXe(a.get(n,e)||0,[m,v],p,!0),i=void 0;switch(g){case"top":i=h;break;case"center":i=h+(c-r)/2;break;case"bottom":i=h+(c-r)}return[[t,i],[t,i+r]]}var o,u=IXe(a.get(n,e)||0,[m,v],p,!0);switch(g){case"left":o=d;break;case"center":o=d+(l-u)/2;break;case"right":o=d+l-u}return[[o,t],[o+u,t]]};"ascending"===r&&(b=-b,y=-y,"horizontal"===s?d+=l:h+=c,u=u.reverse());for(var w=0;w<u.length;w++){var _=u[w],S=u[w+1],M=a.getItemModel(_);if("horizontal"===s){var T=M.get(["itemStyle","width"]);null==T?T=b:(T=RXe(T,l),"ascending"===r&&(T=-T));var k=x(_,d),C=x(S,d+T);d+=T+y,a.setItemLayout(_,{points:k.concat(C.slice().reverse())})}else{var A=M.get(["itemStyle","height"]);null==A?A=b:(A=RXe(A,c),"ascending"===r&&(A=-A));k=x(_,h),C=x(S,h+A);h+=A+y,a.setItemLayout(_,{points:k.concat(C.slice().reverse())})}}!function(e){var t=e.hostModel.get("orient");e.each(function(a){var n,r,i,o,s=e.getItemModel(a),l=s.getModel("label").get("position"),c=s.getModel("labelLine"),u=e.getItemLayout(a),d=u.points,h="inner"===l||"inside"===l||"center"===l||"insideLeft"===l||"insideRight"===l;if(h)"insideLeft"===l?(r=(d[0][0]+d[3][0])/2+5,i=(d[0][1]+d[3][1])/2,n="left"):"insideRight"===l?(r=(d[1][0]+d[2][0])/2-5,i=(d[1][1]+d[2][1])/2,n="right"):(r=(d[0][0]+d[1][0]+d[2][0]+d[3][0])/4,i=(d[0][1]+d[1][1]+d[2][1]+d[3][1])/4,n="center"),o=[[r,i],[r,i]];else{var p=void 0,f=void 0,m=void 0,v=void 0,g=c.get("length");"left"===l?(p=(d[3][0]+d[0][0])/2,f=(d[3][1]+d[0][1])/2,r=(m=p-g)-5,n="right"):"right"===l?(p=(d[1][0]+d[2][0])/2,f=(d[1][1]+d[2][1])/2,r=(m=p+g)+5,n="left"):"top"===l?(p=(d[3][0]+d[0][0])/2,i=(v=(f=(d[3][1]+d[0][1])/2)-g)-5,n="center"):"bottom"===l?(p=(d[1][0]+d[2][0])/2,i=(v=(f=(d[1][1]+d[2][1])/2)+g)+5,n="center"):"rightTop"===l?(p="horizontal"===t?d[3][0]:d[1][0],f="horizontal"===t?d[3][1]:d[1][1],"horizontal"===t?(i=(v=f-g)-5,n="center"):(r=(m=p+g)+5,n="top")):"rightBottom"===l?(p=d[2][0],f=d[2][1],"horizontal"===t?(i=(v=f+g)+5,n="center"):(r=(m=p+g)+5,n="bottom")):"leftTop"===l?(p=d[0][0],f="horizontal"===t?d[0][1]:d[1][1],"horizontal"===t?(i=(v=f-g)-5,n="center"):(r=(m=p-g)-5,n="right")):"leftBottom"===l?(p="horizontal"===t?d[1][0]:d[3][0],f="horizontal"===t?d[1][1]:d[2][1],"horizontal"===t?(i=(v=f+g)+5,n="center"):(r=(m=p-g)-5,n="right")):(p=(d[1][0]+d[2][0])/2,f=(d[1][1]+d[2][1])/2,"horizontal"===t?(i=(v=f+g)+5,n="center"):(r=(m=p+g)+5,n="left")),"horizontal"===t?r=m=p:i=v=f,o=[[p,f],[m,v]]}u.label={linePoints:o,x:r,y:i,verticalAlign:"middle",textAlign:n,inside:h}})}(a)})}var oht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._dataGroup=new xXe,a._initialized=!1,a}return zHe(t,e),t.prototype.init=function(){this.group.add(this._dataGroup)},t.prototype.render=function(e,t,a,n){this._progressiveEls=null;var r=this._dataGroup,i=e.getData(),o=this._data,s=e.coordinateSystem,l=s.dimensions,c=cht(e);if(i.diff(o).add(function(e){uht(lht(i,r,e,l,s),i,e,c)}).update(function(t,a){var n=o.getItemGraphicEl(a),r=sht(i,t,l,s);i.setItemGraphicEl(t,n),u0e(n,{shape:{points:r}},e,t),v0e(n),uht(n,i,t,c)}).remove(function(e){var t=o.getItemGraphicEl(e);r.remove(t)}).execute(),!this._initialized){this._initialized=!0;var u=function(e,t,a){var n=e.model,r=e.getRect(),i=new EZe({shape:{x:r.x,y:r.y,width:r.width,height:r.height}}),o="horizontal"===n.get("layout")?"width":"height";return i.setShape(o,0),d0e(i,{shape:{width:r.width,height:r.height}},t,a),i}(s,e,function(){setTimeout(function(){r.removeClipPath()})});r.setClipPath(u)}this._data=i},t.prototype.incrementalPrepareRender=function(e,t,a){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},t.prototype.incrementalRender=function(e,t,a){for(var n=t.getData(),r=t.coordinateSystem,i=r.dimensions,o=cht(t),s=this._progressiveEls=[],l=e.start;l<e.end;l++){var c=lht(n,this._dataGroup,l,i,r);c.incremental=!0,uht(c,n,l,o),s.push(c)}},t.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},t.type="parallel",t}(s6e);function sht(e,t,a,n){for(var r=[],i=0;i<a.length;i++){var o=a[i],s=e.get(e.mapDimension(o),t);dht(s,n.getAxis(o).type)||r.push(n.dataToPoint(s,o))}return r}function lht(e,t,a,n,r){var i=sht(e,a,n,r),o=new OQe({shape:{points:i},z2:10});return t.add(o),e.setItemGraphicEl(a,o),o}function cht(e){var t=e.get("smooth",!0);return!0===t&&(t=.3),NGe(t=jXe(t))&&(t=0),{smooth:t}}function uht(e,t,a,n){e.useStyle(t.getItemVisual(a,"style")),e.style.fill=null,e.setShape("smooth",n.smooth);var r=t.getItemModel(a),i=r.getModel("emphasis");zJe(e,r,"lineStyle"),OJe(e,i.get("focus"),i.get("blurScope"),i.get("disabled"))}function dht(e,t){return"category"===t?null==e:null==e||isNaN(e)}var hht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.visualStyleAccessPath="lineStyle",a.visualDrawType="stroke",a}return zHe(t,e),t.prototype.getInitialData=function(e,t){return U9e(null,this,{useEncodeDefaulter:SGe(pht,null,this)})},t.prototype.getRawIndicesByActiveState=function(e){var t=this.coordinateSystem,a=this.getData(),n=[];return t.eachActiveState(a,function(t,r){e===t&&n.push(a.getRawIndex(r))}),n},t.type="series.parallel",t.dependencies=["parallel"],t.defaultOption={z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},t}($3e);function pht(e){var t=e.ecModel.getComponent("parallel",e.get("parallelIndex"));if(t){var a={};return gGe(t.dimensions,function(e){var t=+e.replace("dim","");a[e]=t}),a}}var fht=["lineStyle","opacity"],mht={seriesType:"parallel",reset:function(e,t){var a=e.coordinateSystem,n={normal:e.get(["lineStyle","opacity"]),active:e.get("activeOpacity"),inactive:e.get("inactiveOpacity")};return{progress:function(e,t){a.eachActiveState(t,function(e,a){var r=n[e];if("normal"===e&&t.hasItemOption){var i=t.getItemModel(a).get(fht,!0);null!=i&&(r=i)}t.ensureUniqueItemVisual(a,"style").opacity=r},e.start,e.end)}}}};function vht(e){!function(e){if(e.parallel)return;var t=!1;gGe(e.series,function(e){e&&"parallel"===e.type&&(t=!0)}),t&&(e.parallel=[{}])}(e),function(e){var t=r$e(e.parallelAxis);gGe(t,function(t){if(IGe(t)){var a=t.parallelIndex||0,n=r$e(e.parallel)[a];n&&n.parallelAxisDefault&&uGe(t,n.parallelAxisDefault,!1)}})}(e)}var ght=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){this._model=e,this._api=a,this._handlers||(this._handlers={},gGe(yht,function(e,t){a.getZr().on(t,this._handlers[t]=SGe(e,this))},this)),g6e(this,"_throttledDispatchExpand",e.get("axisExpandRate"),"fixRate")},t.prototype.dispose=function(e,t){y6e(this,"_throttledDispatchExpand"),gGe(this._handlers,function(e,a){t.getZr().off(a,e)}),this._handlers=null},t.prototype._throttledDispatchExpand=function(e){this._dispatchExpand(e)},t.prototype._dispatchExpand=function(e){e&&this._api.dispatchAction(hGe({type:"parallelAxisExpand"},e))},t.type="parallel",t}(n6e),yht={mousedown:function(e){bht(this,"click")&&(this._mouseDownPoint=[e.offsetX,e.offsetY])},mouseup:function(e){var t=this._mouseDownPoint;if(bht(this,"click")&&t){var a=[e.offsetX,e.offsetY];if(Math.pow(t[0]-a[0],2)+Math.pow(t[1]-a[1],2)>5)return;var n=this._model.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]);"none"!==n.behavior&&this._dispatchExpand({axisExpandWindow:n.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(e){if(!this._mouseDownPoint&&bht(this,"mousemove")){var t=this._model,a=t.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]),n=a.behavior;"jump"===n&&this._throttledDispatchExpand.debounceNextCall(t.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===n?null:{axisExpandWindow:a.axisExpandWindow,animation:"jump"===n?null:{duration:0}})}}};function bht(e,t){var a=e._model;return a.get("axisExpandable")&&a.get("axisExpandTriggerOn")===t}var xht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(){e.prototype.init.apply(this,arguments),this.mergeOption({})},t.prototype.mergeOption=function(e){var t=this.option;e&&uGe(t,e,!0),this._initDimensions()},t.prototype.contains=function(e,t){var a=e.get("parallelIndex");return null!=a&&t.getComponent("parallel",a)===this},t.prototype.setAxisExpand=function(e){gGe(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(t){e.hasOwnProperty(t)&&(this.option[t]=e[t])},this)},t.prototype._initDimensions=function(){var e=this.dimensions=[],t=this.parallelAxisIndex=[];gGe(xGe(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(e){return(e.get("parallelIndex")||0)===this.componentIndex},this),function(a){e.push("dim"+a.get("dim")),t.push(a.componentIndex)})},t.type="parallel",t.dependencies=["parallelAxis"],t.layoutMode="box",t.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},t}(i5e),wht=function(e){function t(t,a,n,r,i){var o=e.call(this,t,a,n)||this;return o.type=r||"value",o.axisIndex=i,o}return zHe(t,e),t.prototype.isHorizontal=function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")},t}(Dtt);function _ht(e,t,a,n,r,i){e=e||0;var o=a[1]-a[0];if(null!=r&&(r=Mht(r,[0,o])),null!=i&&(i=Math.max(i,null!=r?r:0)),"all"===n){var s=Math.abs(t[1]-t[0]);s=Mht(s,[0,o]),r=i=Mht(s,[r,i]),n=0}t[0]=Mht(t[0],a),t[1]=Mht(t[1],a);var l=Sht(t,n);t[n]+=e;var c,u=r||0,d=a.slice();return l.sign<0?d[0]+=u:d[1]-=u,t[n]=Mht(t[n],d),c=Sht(t,n),null!=r&&(c.sign!==l.sign||c.span<r)&&(t[1-n]=t[n]+l.sign*r),c=Sht(t,n),null!=i&&c.span>i&&(t[1-n]=t[n]+c.sign*i),t}function Sht(e,t){var a=e[t]-e[1-t];return{span:Math.abs(a),sign:a>0?-1:a<0?1:t?-1:1}}function Mht(e,t){return Math.min(null!=t[1]?t[1]:1/0,Math.max(null!=t[0]?t[0]:-1/0,e))}var Tht=gGe,kht=Math.min,Cht=Math.max,Aht=Math.floor,Eht=Math.ceil,Iht=PXe,Rht=Math.PI,Dht=function(){function e(e,t,a){this.type="parallel",this._axesMap=$Ge(),this._axesLayout={},this.dimensions=e.dimensions,this._model=e,this._init(e,t,a)}return e.prototype._init=function(e,t,a){var n=e.dimensions,r=e.parallelAxisIndex;Tht(n,function(e,a){var n=r[a],i=t.getComponent("parallelAxis",n),o=this._axesMap.set(e,new wht(e,Vet(i),[0,0],i.get("type"),n)),s="category"===o.type;o.onBand=s&&i.get("boundaryGap"),o.inverse=i.get("inverse"),i.axis=o,o.model=i,o.coordinateSystem=i.coordinateSystem=this},this)},e.prototype.update=function(e,t){this._updateAxesFromSeries(this._model,e)},e.prototype.containPoint=function(e){var t=this._makeLayoutInfo(),a=t.axisBase,n=t.layoutBase,r=t.pixelDimIndex,i=e[1-r],o=e[r];return i>=a&&i<=a+t.axisLength&&o>=n&&o<=n+t.layoutLength},e.prototype.getModel=function(){return this._model},e.prototype._updateAxesFromSeries=function(e,t){t.eachSeries(function(a){if(e.contains(a,t)){var n=a.getData();Tht(this.dimensions,function(e){var t=this._axesMap.get(e);t.scale.unionExtentFromData(n,n.mapDimension(e)),zet(t.scale,t.model)},this)}},this)},e.prototype.resize=function(e,t){var a=J2e(e,t).refContainer;this._rect=$2e(e.getBoxLayoutParams(),a),this._layoutAxes()},e.prototype.getRect=function(){return this._rect},e.prototype._makeLayoutInfo=function(){var e,t=this._model,a=this._rect,n=["x","y"],r=["width","height"],i=t.get("layout"),o="horizontal"===i?0:1,s=a[r[o]],l=[0,s],c=this.dimensions.length,u=Pht(t.get("axisExpandWidth"),l),d=Pht(t.get("axisExpandCount")||0,[0,c]),h=t.get("axisExpandable")&&c>3&&c>d&&d>1&&u>0&&s>0,p=t.get("axisExpandWindow");p?(e=Pht(p[1]-p[0],l),p[1]=p[0]+e):(e=Pht(u*(d-1),l),(p=[u*(t.get("axisExpandCenter")||Aht(c/2))-e/2])[1]=p[0]+e);var f=(s-e)/(c-d);f<3&&(f=0);var m=[Aht(Iht(p[0]/u,1))+1,Eht(Iht(p[1]/u,1))-1],v=f/u*p[0];return{layout:i,pixelDimIndex:o,layoutBase:a[n[o]],layoutLength:s,axisBase:a[n[1-o]],axisLength:a[r[1-o]],axisExpandable:h,axisExpandWidth:u,axisCollapseWidth:f,axisExpandWindow:p,axisCount:c,winInnerIndices:m,axisExpandWindow0Pos:v}},e.prototype._layoutAxes=function(){var e=this._rect,t=this._axesMap,a=this.dimensions,n=this._makeLayoutInfo(),r=n.layout;t.each(function(e){var t=[0,n.axisLength],a=e.inverse?1:0;e.setExtent(t[a],t[1-a])}),Tht(a,function(t,a){var i=(n.axisExpandable?Nht:Lht)(a,n),o={horizontal:{x:i.position,y:n.axisLength},vertical:{x:0,y:i.position}},s={horizontal:Rht/2,vertical:0},l=[o[r].x+e.x,o[r].y+e.y],c=s[r],u=[1,0,0,1,0,0];ZWe(u,u,c),KWe(u,u,l),this._axesLayout[t]={position:l,rotation:c,transform:u,axisNameAvailableWidth:i.axisNameAvailableWidth,axisLabelShow:i.axisLabelShow,nameTruncateMaxWidth:i.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},e.prototype.getAxis=function(e){return this._axesMap.get(e)},e.prototype.dataToPoint=function(e,t){return this.axisCoordToPoint(this._axesMap.get(t).dataToCoord(e),t)},e.prototype.eachActiveState=function(e,t,a,n){null==a&&(a=0),null==n&&(n=e.count());var r=this._axesMap,i=this.dimensions,o=[],s=[];gGe(i,function(t){o.push(e.mapDimension(t)),s.push(r.get(t).model)});for(var l=this.hasAxisBrushed(),c=a;c<n;c++){var u=void 0;if(l){u="active";for(var d=e.getValues(o,c),h=0,p=i.length;h<p;h++){if("inactive"===s[h].getActiveState(d[h])){u="inactive";break}}}else u="normal";t(u,c)}},e.prototype.hasAxisBrushed=function(){for(var e=this.dimensions,t=this._axesMap,a=!1,n=0,r=e.length;n<r;n++)"normal"!==t.get(e[n]).model.getActiveState()&&(a=!0);return a},e.prototype.axisCoordToPoint=function(e,t){return R0e([e,0],this._axesLayout[t].transform)},e.prototype.getAxisLayout=function(e){return cGe(this._axesLayout[e])},e.prototype.getSlidedAxisExpandWindow=function(e){var t=this._makeLayoutInfo(),a=t.pixelDimIndex,n=t.axisExpandWindow.slice(),r=n[1]-n[0],i=[0,t.axisExpandWidth*(t.axisCount-1)];if(!this.containPoint(e))return{behavior:"none",axisExpandWindow:n};var o,s=e[a]-t.layoutBase-t.axisExpandWindow0Pos,l="slide",c=t.axisCollapseWidth,u=this._model.get("axisExpandSlideTriggerArea"),d=null!=u[0];if(c)d&&c&&s<r*u[0]?(l="jump",o=s-r*u[2]):d&&c&&s>r*(1-u[0])?(l="jump",o=s-r*(1-u[2])):(o=s-r*u[1])>=0&&(o=s-r*(1-u[1]))<=0&&(o=0),(o*=t.axisExpandWidth/c)?_ht(o,n,i,"all"):l="none";else{var h=n[1]-n[0];(n=[Cht(0,i[1]*s/h-h/2)])[1]=kht(i[1],n[0]+h),n[0]=n[1]-h}return{axisExpandWindow:n,behavior:l}},e}();function Pht(e,t){return kht(Cht(e,t[0]),t[1])}function Lht(e,t){var a=t.layoutLength/(t.axisCount-1);return{position:a*e,axisNameAvailableWidth:a,axisLabelShow:!0}}function Nht(e,t){var a,n,r=t.layoutLength,i=t.axisExpandWidth,o=t.axisCount,s=t.axisCollapseWidth,l=t.winInnerIndices,c=s,u=!1;return e<l[0]?(a=e*s,n=s):e<=l[1]?(a=t.axisExpandWindow0Pos+e*i-t.axisExpandWindow[0],c=i,u=!0):(a=r-(o-1-e)*s,n=s),{position:a,axisNameAvailableWidth:c,axisLabelShow:u,nameTruncateMaxWidth:n}}var Oht={create:function(e,t){var a=[];return e.eachComponent("parallel",function(n,r){var i=new Dht(n,e,t);i.name="parallel_"+r,i.resize(n,t),n.coordinateSystem=i,i.model=n,a.push(i)}),e.eachSeries(function(e){if("parallel"===e.get("coordinateSystem")){var t=e.getReferringComponents("parallel",x$e).models[0];e.coordinateSystem=t.coordinateSystem}}),a}},Fht=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.activeIntervals=[],a}return zHe(t,e),t.prototype.getAreaSelectStyle=function(){return F$e([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},t.prototype.setActiveIntervals=function(e){var t=this.activeIntervals=cGe(e);if(t)for(var a=t.length-1;a>=0;a--)LXe(t[a])},t.prototype.getActiveState=function(e){var t=this.activeIntervals;if(!t.length)return"normal";if(null==e||isNaN(+e))return"inactive";if(1===t.length){var a=t[0];if(a[0]<=e&&e<=a[1])return"active"}else for(var n=0,r=t.length;n<r;n++)if(t[n][0]<=e&&e<=t[n][1])return"active";return"inactive"},t}(i5e);mGe(Fht,Ket);var Bht=!0,Uht=Math.min,zht=Math.max,Vht=Math.pow,Hht="globalPan",Ght={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},Wht={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},qht={brushStyle:{lineWidth:2,stroke:o5e.color.backgroundTint,fill:o5e.color.borderTint},transformable:!0,brushMode:"single",removeOnClick:!1},Yht=0,jht=function(e){function t(t){var a=e.call(this)||this;return a._track=[],a._covers=[],a._handlers={},a._zr=t,a.group=new xXe,a._uid="brushController_"+Yht++,gGe(xpt,function(e,t){this._handlers[t]=SGe(e,this)},a),a}return zHe(t,e),t.prototype.enableBrush=function(e){return this._brushType&&this._doDisableBrush(),e.brushType&&this._doEnableBrush(e),this},t.prototype._doEnableBrush=function(e){var t=this._zr;this._enableGlobalPan||function(e,t,a){wst(e)[t]=a}(t,Hht,this._uid),gGe(this._handlers,function(e,a){t.on(a,e)}),this._brushType=e.brushType,this._brushOption=uGe(cGe(qht),e,!0)},t.prototype._doDisableBrush=function(){var e=this._zr;!function(e,t,a){var n=wst(e);n[t]===a&&(n[t]=null)}(e,Hht,this._uid),gGe(this._handlers,function(t,a){e.off(a,t)}),this._brushType=this._brushOption=null},t.prototype.setPanels=function(e){if(e&&e.length){var t=this._panels={};gGe(e,function(e){t[e.panelId]=cGe(e)})}else this._panels=null;return this},t.prototype.mount=function(e){e=e||{},this._enableGlobalPan=e.enableGlobalPan;var t=this.group;return this._zr.add(t),t.attr({x:e.x||0,y:e.y||0,rotation:e.rotation||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1}),this._transform=t.getLocalTransform(),this},t.prototype.updateCovers=function(e){e=yGe(e,function(e){return uGe(cGe(qht),e,!0)});var t=this._covers,a=this._covers=[],n=this,r=this._creatingCover;return new o9e(t,e,function(e,t){return i(e.__brushOption,t)},i).add(o).update(o).remove(function(e){t[e]!==r&&n.group.remove(t[e])}).execute(),this;function i(e,t){return(null!=e.id?e.id:"\0-brush-index-"+t)+"-"+e.brushType}function o(i,o){var s=e[i];if(null!=o&&t[o]===r)a[i]=t[o];else{var l=a[i]=null!=o?(t[o].__brushOption=s,t[o]):$ht(n,Xht(n,s));Jht(n,l)}}},t.prototype.unmount=function(){return this.enableBrush(!1),apt(this),this._zr.remove(this.group),this},t.prototype.dispose=function(){this.unmount(),this.off()},t}(wWe);function Xht(e,t){var a=_pt[t.brushType].createCover(e,t);return a.__brushOption=t,Zht(a,t),e.group.add(a),a}function $ht(e,t){var a=Qht(t);return a.endCreating&&(a.endCreating(e,t),Zht(t,t.__brushOption)),t}function Kht(e,t){var a=t.__brushOption;Qht(t).updateCoverShape(e,t,a.range,a)}function Zht(e,t){var a=t.z;null==a&&(a=1e4),e.traverse(function(e){e.z=a,e.z2=a})}function Jht(e,t){Qht(t).updateCommon(e,t),Kht(e,t)}function Qht(e){return _pt[e.__brushOption.brushType]}function ept(e,t,a){var n,r=e._panels;if(!r)return Bht;var i=e._transform;return gGe(r,function(e){e.isTargetByCursor(t,a,i)&&(n=e)}),n}function tpt(e,t){var a=e._panels;if(!a)return Bht;var n=t.__brushOption.panelId;return null!=n?a[n]:Bht}function apt(e){var t=e._covers,a=t.length;return gGe(t,function(t){e.group.remove(t)},e),t.length=0,!!a}function npt(e,t){var a=yGe(e._covers,function(e){var t=e.__brushOption,a=cGe(t.range);return{brushType:t.brushType,panelId:t.panelId,range:a}});e.trigger("brush",{areas:a,isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function rpt(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function ipt(e,t,a,n){var r=new xXe;return r.add(new EZe({name:"main",style:cpt(a),silent:!0,draggable:!0,cursor:"move",drift:MGe(hpt,e,t,r,["n","s","w","e"]),ondragend:MGe(npt,t,{isEnd:!0})})),gGe(n,function(a){r.add(new EZe({name:a.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:MGe(hpt,e,t,r,a),ondragend:MGe(npt,t,{isEnd:!0})}))}),r}function opt(e,t,a,n){var r=n.brushStyle.lineWidth||0,i=zht(r,6),o=a[0][0],s=a[1][0],l=o-r/2,c=s-r/2,u=a[0][1],d=a[1][1],h=u-i+r/2,p=d-i+r/2,f=u-o,m=d-s,v=f+r,g=m+r;lpt(e,t,"main",o,s,f,m),n.transformable&&(lpt(e,t,"w",l,c,i,g),lpt(e,t,"e",h,c,i,g),lpt(e,t,"n",l,c,v,i),lpt(e,t,"s",l,p,v,i),lpt(e,t,"nw",l,c,i,i),lpt(e,t,"ne",h,c,i,i),lpt(e,t,"sw",l,p,i,i),lpt(e,t,"se",h,p,i,i))}function spt(e,t){var a=t.__brushOption,n=a.transformable,r=t.childAt(0);r.useStyle(cpt(a)),r.attr({silent:!n,cursor:n?"move":"default"}),gGe([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(a){var r=t.childOfName(a.join("")),i=1===a.length?dpt(e,a[0]):function(e,t){var a=[dpt(e,t[0]),dpt(e,t[1])];return("e"===a[0]||"w"===a[0])&&a.reverse(),a.join("")}(e,a);r&&r.attr({silent:!n,invisible:!n,cursor:n?Wht[i]+"-resize":null})})}function lpt(e,t,a,n,r,i,o){var s=t.childOfName(a);s&&s.setShape(function(e){var t=Uht(e[0][0],e[1][0]),a=Uht(e[0][1],e[1][1]),n=zht(e[0][0],e[1][0]),r=zht(e[0][1],e[1][1]);return{x:t,y:a,width:n-t,height:r-a}}(mpt(e,t,[[n,r],[n+i,r+o]])))}function cpt(e){return pGe({strokeNoScale:!0},e.brushStyle)}function upt(e,t,a,n){var r=[Uht(e,a),Uht(t,n)],i=[zht(e,a),zht(t,n)];return[[r[0],i[0]],[r[1],i[1]]]}function dpt(e,t){var a=D0e({w:"left",e:"right",n:"top",s:"bottom"}[t],function(e){return I0e(e.group)}(e));return{left:"w",right:"e",top:"n",bottom:"s"}[a]}function hpt(e,t,a,n,r,i){var o=a.__brushOption,s=e.toRectRange(o.range),l=fpt(t,r,i);gGe(n,function(e){var t=Ght[e];s[t[0]][t[1]]+=l[t[0]]}),o.range=e.fromRectRange(upt(s[0][0],s[1][0],s[0][1],s[1][1])),Jht(t,a),npt(t,{isEnd:!1})}function ppt(e,t,a,n){var r=t.__brushOption.range,i=fpt(e,a,n);gGe(r,function(e){e[0]+=i[0],e[1]+=i[1]}),Jht(e,t),npt(e,{isEnd:!1})}function fpt(e,t,a){var n=e.group,r=n.transformCoordToLocal(t,a),i=n.transformCoordToLocal(0,0);return[r[0]-i[0],r[1]-i[1]]}function mpt(e,t,a){var n=tpt(e,t);return n&&n!==Bht?n.clipPath(a,e._transform):cGe(a)}function vpt(e){var t=e.event;t.preventDefault&&t.preventDefault()}function gpt(e,t,a){return e.childOfName("main").contain(t,a)}function ypt(e,t,a,n){var r,i=e._creatingCover,o=e._creatingPanel,s=e._brushOption;if(e._track.push(a.slice()),function(e){var t=e._track;if(!t.length)return!1;var a=t[t.length-1],n=t[0],r=a[0]-n[0],i=a[1]-n[1];return Vht(r*r+i*i,.5)>6}(e)||i){if(o&&!i){"single"===s.brushMode&&apt(e);var l=cGe(s);l.brushType=bpt(l.brushType,o),l.panelId=o===Bht?null:o.panelId,i=e._creatingCover=Xht(e,l),e._covers.push(i)}if(i){var c=_pt[bpt(e._brushType,o)];i.__brushOption.range=c.getCreatingRange(mpt(e,i,e._track)),n&&($ht(e,i),c.updateCommon(e,i)),Kht(e,i),r={isEnd:n}}}else n&&"single"===s.brushMode&&s.removeOnClick&&ept(e,t,a)&&apt(e)&&(r={isEnd:n,removeOnClick:!0});return r}function bpt(e,t){return"auto"===e?t.defaultBrushType:e}var xpt={mousedown:function(e){if(this._dragging)wpt(this,e);else if(!e.target||!e.target.draggable){vpt(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null,(this._creatingPanel=ept(this,e,t))&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=e.offsetX,a=e.offsetY,n=this.group.transformCoordToLocal(t,a);if(function(e,t,a){if(e._brushType&&!function(e,t,a){var n=e._zr;return t<0||t>n.getWidth()||a<0||a>n.getHeight()}(e,t.offsetX,t.offsetY)){var n=e._zr,r=e._covers,i=ept(e,t,a);if(!e._dragging)for(var o=0;o<r.length;o++){var s=r[o].__brushOption;if(i&&(i===Bht||s.panelId===i.panelId)&&_pt[s.brushType].contain(r[o],a[0],a[1]))return}i&&n.setCursorStyle("crosshair")}}(this,e,n),this._dragging){vpt(e);var r=ypt(this,e,n,!1);r&&npt(this,r)}},mouseup:function(e){wpt(this,e)}};function wpt(e,t){if(e._dragging){vpt(t);var a=t.offsetX,n=t.offsetY,r=e.group.transformCoordToLocal(a,n),i=ypt(e,t,r,!0);e._dragging=!1,e._track=[],e._creatingCover=null,i&&npt(e,i)}}var _pt={lineX:Spt(0),lineY:Spt(1),rect:{createCover:function(e,t){function a(e){return e}return ipt({toRectRange:a,fromRectRange:a},e,t,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(e){var t=rpt(e);return upt(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,a,n){opt(e,t,a,n)},updateCommon:spt,contain:gpt},polygon:{createCover:function(e,t){var a=new xXe;return a.add(new OQe({name:"main",style:cpt(t),silent:!0})),a},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new LQe({name:"main",draggable:!0,drift:MGe(ppt,e,t),ondragend:MGe(npt,e,{isEnd:!0})}))},updateCoverShape:function(e,t,a,n){t.childAt(0).setShape({points:mpt(e,t,a)})},updateCommon:spt,contain:gpt}};function Spt(e){return{createCover:function(t,a){return ipt({toRectRange:function(t){var a=[t,[0,100]];return e&&a.reverse(),a},fromRectRange:function(t){return t[e]}},t,a,[[["w"],["e"]],[["n"],["s"]]][e])},getCreatingRange:function(t){var a=rpt(t);return[Uht(a[0][e],a[1][e]),zht(a[0][e],a[1][e])]},updateCoverShape:function(t,a,n,r){var i,o=tpt(t,a);if(o!==Bht&&o.getLinearBrushOtherExtent)i=o.getLinearBrushOtherExtent(e);else{var s=t._zr;i=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[n,i];e&&l.reverse(),opt(t,a,l,r)},updateCommon:spt,contain:gpt}}function Mpt(e){return e=Cpt(e),function(t){return N0e(t,e)}}function Tpt(e,t){return e=Cpt(e),function(a){var n=null!=t?t:a,r=n?e.width:e.height,i=n?e.x:e.y;return[i,i+(r||0)]}}function kpt(e,t,a){var n=Cpt(e);return function(e,r){return n.contain(r[0],r[1])&&!Mst(e,t,a)}}function Cpt(e){return fqe.create(e)}var Apt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(t,a){e.prototype.init.apply(this,arguments),(this._brushController=new jht(a.getZr())).on("brush",SGe(this._onBrush,this))},t.prototype.render=function(e,t,a,n){if(!function(e,t,a){return a&&"axisAreaSelect"===a.type&&t.findComponents({mainType:"parallelAxis",query:a})[0]===e}(e,t,n)){this.axisModel=e,this.api=a,this.group.removeAll();var r=this._axisGroup;if(this._axisGroup=new xXe,this.group.add(this._axisGroup),e.get("show")){var i=function(e,t){return t.getComponent("parallel",e.get("parallelIndex"))}(e,t),o=i.coordinateSystem,s=e.getAreaSelectStyle(),l=s.width,c=e.axis.dim,u=hGe({strokeContainThreshold:l},o.getAxisLayout(c)),d=new hot(e,a,u);d.build(),this._axisGroup.add(d.group),this._refreshBrushController(u,s,e,i,l,a),L0e(r,this._axisGroup,e)}}},t.prototype._refreshBrushController=function(e,t,a,n,r,i){var o=a.axis.getExtent(),s=o[1]-o[0],l=Math.min(30,.1*Math.abs(s)),c=fqe.create({x:o[0],y:-r/2,width:s,height:r});c.x-=l,c.width+=2*l,this._brushController.mount({enableGlobalPan:!0,rotation:e.rotation,x:e.position[0],y:e.position[1]}).setPanels([{panelId:"pl",clipPath:Mpt(c),isTargetByCursor:kpt(c,i,n),getLinearBrushOtherExtent:Tpt(c,0)}]).enableBrush({brushType:"lineX",brushStyle:t,removeOnClick:!0}).updateCovers(function(e){var t=e.axis;return yGe(e.activeIntervals,function(e){return{brushType:"lineX",panelId:"pl",range:[t.dataToCoord(e[0],!0),t.dataToCoord(e[1],!0)]}})}(a))},t.prototype._onBrush=function(e){var t=e.areas,a=this.axisModel,n=a.axis,r=yGe(t,function(e){return[n.coordToData(e.range[0],!0),n.coordToData(e.range[1],!0)]});(!a.option.realtime===e.isEnd||e.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:a.id,intervals:r})},t.prototype.dispose=function(){this._brushController.dispose()},t.type="parallelAxis",t}(n6e);var Ept={type:"axisAreaSelect",event:"axisAreaSelected"};var Ipt={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function Rpt(e){e.registerComponentView(ght),e.registerComponentModel(xht),e.registerCoordinateSystem("parallel",Oht),e.registerPreprocessor(vht),e.registerComponentModel(Fht),e.registerComponentView(Apt),zit(e,"parallel",Fht,Ipt),function(e){e.registerAction(Ept,function(e,t){t.eachComponent({mainType:"parallelAxis",query:e},function(t){t.axis.model.setActiveIntervals(e.intervals)})}),e.registerAction("parallelAxisExpand",function(e,t){t.eachComponent({mainType:"parallel",query:e},function(t){t.setAxisExpand(e)})})}(e)}var Dpt=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0},Ppt=function(e){function t(t){return e.call(this,t)||this}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Dpt},t.prototype.buildPath=function(e,t){var a=t.extent;e.moveTo(t.x1,t.y1),e.bezierCurveTo(t.cpx1,t.cpy1,t.cpx2,t.cpy2,t.x2,t.y2),"vertical"===t.orient?(e.lineTo(t.x2+a,t.y2),e.bezierCurveTo(t.cpx2+a,t.cpy2,t.cpx1+a,t.cpy1,t.x1+a,t.y1)):(e.lineTo(t.x2,t.y2+a),e.bezierCurveTo(t.cpx2,t.cpy2+a,t.cpx1,t.cpy1+a,t.x1,t.y1+a)),e.closePath()},t.prototype.highlight=function(){_Je(this)},t.prototype.downplay=function(){SJe(this)},t}(gZe),Lpt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._mainGroup=new xXe,a._focusAdjacencyDisabled=!1,a}return zHe(t,e),t.prototype.init=function(e,t){this._controller=new Tst(t.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},t.prototype.render=function(e,t,a){var n=this,r=e.getGraph(),i=this._mainGroup,o=e.layoutInfo,s=o.width,l=o.height,c=e.getData(),u=e.getData("edge"),d=e.get("orient");this._model=e,i.removeAll(),i.x=o.x,i.y=o.y,this._updateViewCoordSys(e,a),Fst(e,a,i,this._controller,this._controllerHost,null),r.eachEdge(function(t){var a=new Ppt,n=YZe(a);n.dataIndex=t.dataIndex,n.seriesIndex=e.seriesIndex,n.dataType="edge";var r,o,c,h,p,f,m,v,g=t.getModel(),y=g.getModel("lineStyle"),b=y.get("curveness"),x=t.node1.getLayout(),w=t.node1.getModel(),_=w.get("localX"),S=w.get("localY"),M=t.node2.getLayout(),T=t.node2.getModel(),k=T.get("localX"),C=T.get("localY"),A=t.getLayout();a.shape.extent=Math.max(1,A.dy),a.shape.orient=d,"vertical"===d?(r=(null!=_?_*s:x.x)+A.sy,o=(null!=S?S*l:x.y)+x.dy,c=(null!=k?k*s:M.x)+A.ty,p=r,f=o*(1-b)+(h=null!=C?C*l:M.y)*b,m=c,v=o*b+h*(1-b)):(r=(null!=_?_*s:x.x)+x.dx,o=(null!=S?S*l:x.y)+A.sy,p=r*(1-b)+(c=null!=k?k*s:M.x)*b,f=o,m=r*b+c*(1-b),v=h=(null!=C?C*l:M.y)+A.ty),a.setShape({x1:r,y1:o,x2:c,y2:h,cpx1:p,cpy1:f,cpx2:m,cpy2:v}),a.useStyle(y.getItemStyle()),Npt(a.style,d,t);var E=""+g.get("value"),I=i1e(g,"edgeLabel");r1e(a,I,{labelFetcher:{getFormattedLabel:function(t,a,n,r,i,o){return e.getFormattedLabel(t,a,"edge",r,BGe(i,I.normal&&I.normal.get("formatter"),E),o)}},labelDataIndex:t.dataIndex,defaultText:E}),a.setTextConfig({position:"inside"});var R=g.getModel("emphasis");zJe(a,g,"lineStyle",function(e){var a=e.getItemStyle();return Npt(a,d,t),a}),i.add(a),u.setItemGraphicEl(t.dataIndex,a);var D=R.get("focus");OJe(a,"adjacency"===D?t.getAdjacentDataIndices():"trajectory"===D?t.getTrajectoryDataIndices():D,R.get("blurScope"),R.get("disabled"))}),r.eachNode(function(t){var a=t.getLayout(),n=t.getModel(),r=n.get("localX"),o=n.get("localY"),u=n.getModel("emphasis"),d=n.get(["itemStyle","borderRadius"])||0,h=new EZe({shape:{x:null!=r?r*s:a.x,y:null!=o?o*l:a.y,width:a.dx,height:a.dy,r:d},style:n.getModel("itemStyle").getItemStyle(),z2:10});r1e(h,i1e(n),{labelFetcher:{getFormattedLabel:function(t,a){return e.getFormattedLabel(t,a,"node")}},labelDataIndex:t.dataIndex,defaultText:t.id}),h.disableLabelAnimation=!0,h.setStyle("fill",t.getVisual("color")),h.setStyle("decal",t.getVisual("style").decal),zJe(h,n),i.add(h),c.setItemGraphicEl(t.dataIndex,h),YZe(h).dataType="node";var p=u.get("focus");OJe(h,"adjacency"===p?t.getAdjacentDataIndices():"trajectory"===p?t.getTrajectoryDataIndices():p,u.get("blurScope"),u.get("disabled"))}),c.eachItemGraphicEl(function(t,r){c.getItemModel(r).get("draggable")&&(t.drift=function(t,i){n._focusAdjacencyDisabled=!0,this.shape.x+=t,this.shape.y+=i,this.dirty(),a.dispatchAction({type:"dragNode",seriesId:e.id,dataIndex:c.getRawIndex(r),localX:this.shape.x/s,localY:this.shape.y/l})},t.ondragend=function(){n._focusAdjacencyDisabled=!1},t.draggable=!0,t.cursor="move")}),!this._data&&e.isAnimationEnabled()&&i.setClipPath(function(e,t,a){var n=new EZe({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return d0e(n,{shape:{width:e.width+20}},t,a),n}(i.getBoundingRect(),e,function(){i.removeClipPath()})),this._data=e.getData()},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype._updateViewCoordSys=function(e,t){var a=e.layoutInfo,n=a.width,r=a.height,i=e.coordinateSystem=new Wlt(null,{api:t,ecModel:e.ecModel});i.zoomLimit=e.get("scaleLimit"),i.setBoundingRect(0,0,n,r),i.setCenter(e.get("center")),i.setZoom(e.get("zoom")),this._controllerHost.target.attr({x:i.x,y:i.y,scaleX:i.scaleX,scaleY:i.scaleY})},t.type="sankey",t}(s6e);function Npt(e,t,a){switch(e.fill){case"source":e.fill=a.node1.getVisual("color"),e.decal=a.node1.getVisual("style").decal;break;case"target":e.fill=a.node2.getVisual("color"),e.decal=a.node2.getVisual("style").decal;break;case"gradient":var n=a.node1.getVisual("color"),r=a.node2.getVisual("color");CGe(n)&&CGe(r)&&(e.fill=new XQe(0,0,+("horizontal"===t),+("vertical"===t),[{color:n,offset:0},{color:r,offset:1}]))}}var Opt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){var a=e.edges||e.links||[],n=e.data||e.nodes||[],r=e.levels||[];this.levelModels=[];for(var i=this.levelModels,o=0;o<r.length;o++)null!=r[o].depth&&r[o].depth>=0&&(i[r[o].depth]=new E1e(r[o],this,t));var s=zdt(n,a,this,!0,function(e,t){e.wrapMethod("getItemModel",function(e,t){var a=e.parentModel,n=a.getData().getItemLayout(t);if(n){var r=n.depth,i=a.levelModels[r];i&&(e.parentModel=i)}return e}),t.wrapMethod("getItemModel",function(e,t){var a=e.parentModel,n=a.getGraph().getEdgeByIndex(t).node1.getLayout();if(n){var r=n.depth,i=a.levelModels[r];i&&(e.parentModel=i)}return e})});return s.data},t.prototype.setNodePosition=function(e,t){var a=(this.option.data||this.option.nodes)[e];a.localX=t[0],a.localY=t[1]},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(e,t,a){function n(e){return isNaN(e)||null==e}if("edge"===a){var r=this.getDataParams(e,a),i=r.data,o=r.value;return P3e("nameValue",{name:i.source+" -- "+i.target,value:o,noValue:n(o)})}var s=this.getGraph().getNodeByIndex(e).getLayout().value,l=this.getDataParams(e,a).data.name;return P3e("nameValue",{name:null!=l?l+"":null,value:s,noValue:n(s)})},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(t,a){var n=e.prototype.getDataParams.call(this,t,a);if(null==n.value&&"node"===a){var r=this.getGraph().getNodeByIndex(t).getLayout().value;n.value=r}return n},t.type="series.sankey",t.layoutMode="box",t.defaultOption={z:2,coordinateSystemUsage:"box",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,roam:!1,roamTrigger:"global",center:null,zoom:1,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:o5e.color.neutral50,opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:o5e.color.primary}},animationEasing:"linear",animationDuration:1e3},t}($3e);function Fpt(e,t){e.eachSeriesByType("sankey",function(e){var a=e.get("nodeWidth"),n=e.get("nodeGap"),r=J2e(e,t).refContainer,i=$2e(e.getBoxLayoutParams(),r);e.layoutInfo=i;var o=i.width,s=i.height,l=e.getGraph(),c=l.nodes,u=l.edges;!function(e){gGe(e,function(e){var t=jpt(e.outEdges,Ypt),a=jpt(e.inEdges,Ypt),n=e.getValue()||0,r=Math.max(t,a,n);e.setLayout({value:r},!0)})}(c),function(e,t,a,n,r,i,o,s,l){(function(e,t,a,n,r,i,o){for(var s=[],l=[],c=[],u=[],d=0,h=0;h<t.length;h++)s[h]=1;for(h=0;h<e.length;h++)l[h]=e[h].inEdges.length,0===l[h]&&c.push(e[h]);var p=-1;for(;c.length;){for(var f=0;f<c.length;f++){var m=c[f],v=m.hostGraph.data.getRawDataItem(m.dataIndex),g=null!=v.depth&&v.depth>=0;g&&v.depth>p&&(p=v.depth),m.setLayout({depth:g?v.depth:d},!0),"vertical"===i?m.setLayout({dy:a},!0):m.setLayout({dx:a},!0);for(var y=0;y<m.outEdges.length;y++){var b=m.outEdges[y];s[t.indexOf(b)]=0;var x=b.node2;0===--l[e.indexOf(x)]&&u.indexOf(x)<0&&u.push(x)}}++d,c=u,u=[]}for(h=0;h<s.length;h++)if(1===s[h])throw new Error("Sankey is a DAG, the original data has cycle!");var w=p>d-1?p:d-1;o&&"left"!==o&&function(e,t,a,n){if("right"===t){for(var r=[],i=e,o=0;i.length;){for(var s=0;s<i.length;s++){var l=i[s];l.setLayout({skNodeHeight:o},!0);for(var c=0;c<l.inEdges.length;c++){var u=l.inEdges[c];r.indexOf(u.node1)<0&&r.push(u.node1)}}i=r,r=[],++o}gGe(e,function(e){Bpt(e)||e.setLayout({depth:Math.max(0,n-e.getLayout().skNodeHeight)},!0)})}else"justify"===t&&function(e,t){gGe(e,function(e){Bpt(e)||e.outEdges.length||e.setLayout({depth:t},!0)})}(e,n)}(e,o,0,w);var _="vertical"===i?(r-a)/w:(n-a)/w;!function(e,t,a){gGe(e,function(e){var n=e.getLayout().depth*t;"vertical"===a?e.setLayout({y:n},!0):e.setLayout({x:n},!0)})}(e,_,i)})(e,t,a,r,i,s,l),function(e,t,a,n,r,i,o){var s=function(e,t){var a=[],n="vertical"===t?"y":"x",r=M$e(e,function(e){return e.getLayout()[n]});return r.keys.sort(function(e,t){return e-t}),gGe(r.keys,function(e){a.push(r.buckets.get(e))}),a}(e,o);(function(e,t,a,n,r,i){var o=1/0;gGe(e,function(e){var t=e.length,s=0;gGe(e,function(e){s+=e.getLayout().value});var l="vertical"===i?(n-(t-1)*r)/s:(a-(t-1)*r)/s;l<o&&(o=l)}),gGe(e,function(e){gGe(e,function(e,t){var a=e.getLayout().value*o;"vertical"===i?(e.setLayout({x:t},!0),e.setLayout({dx:a},!0)):(e.setLayout({y:t},!0),e.setLayout({dy:a},!0))})}),gGe(t,function(e){var t=+e.getValue()*o;e.setLayout({dy:t},!0)})})(s,t,a,n,r,o),Upt(s,r,a,n,o);for(var l=1;i>0;i--)zpt(s,l*=.99,o),Upt(s,r,a,n,o),Xpt(s,l,o),Upt(s,r,a,n,o)}(e,t,i,r,n,o,s),function(e,t){var a="vertical"===t?"x":"y";gGe(e,function(e){e.outEdges.sort(function(e,t){return e.node2.getLayout()[a]-t.node2.getLayout()[a]}),e.inEdges.sort(function(e,t){return e.node1.getLayout()[a]-t.node1.getLayout()[a]})}),gGe(e,function(e){var t=0,a=0;gGe(e.outEdges,function(e){e.setLayout({sy:t},!0),t+=e.getLayout().dy}),gGe(e.inEdges,function(e){e.setLayout({ty:a},!0),a+=e.getLayout().dy})})}(e,s)}(c,u,a,n,o,s,0!==xGe(c,function(e){return 0===e.getLayout().value}).length?0:e.get("layoutIterations"),e.get("orient"),e.get("nodeAlign"))})}function Bpt(e){var t=e.hostGraph.data.getRawDataItem(e.dataIndex);return null!=t.depth&&t.depth>=0}function Upt(e,t,a,n,r){var i="vertical"===r?"x":"y";gGe(e,function(e){var o,s,l;e.sort(function(e,t){return e.getLayout()[i]-t.getLayout()[i]});for(var c=0,u=e.length,d="vertical"===r?"dx":"dy",h=0;h<u;h++)(l=c-(s=e[h]).getLayout()[i])>0&&(o=s.getLayout()[i]+l,"vertical"===r?s.setLayout({x:o},!0):s.setLayout({y:o},!0)),c=s.getLayout()[i]+s.getLayout()[d]+t;if((l=c-t-("vertical"===r?n:a))>0){o=s.getLayout()[i]-l,"vertical"===r?s.setLayout({x:o},!0):s.setLayout({y:o},!0),c=o;for(h=u-2;h>=0;--h)(l=(s=e[h]).getLayout()[i]+s.getLayout()[d]+t-c)>0&&(o=s.getLayout()[i]-l,"vertical"===r?s.setLayout({x:o},!0):s.setLayout({y:o},!0)),c=s.getLayout()[i]}})}function zpt(e,t,a){gGe(e.slice().reverse(),function(e){gGe(e,function(e){if(e.outEdges.length){var n=jpt(e.outEdges,Vpt,a)/jpt(e.outEdges,Ypt);if(isNaN(n)){var r=e.outEdges.length;n=r?jpt(e.outEdges,Hpt,a)/r:0}if("vertical"===a){var i=e.getLayout().x+(n-qpt(e,a))*t;e.setLayout({x:i},!0)}else{var o=e.getLayout().y+(n-qpt(e,a))*t;e.setLayout({y:o},!0)}}})})}function Vpt(e,t){return qpt(e.node2,t)*e.getValue()}function Hpt(e,t){return qpt(e.node2,t)}function Gpt(e,t){return qpt(e.node1,t)*e.getValue()}function Wpt(e,t){return qpt(e.node1,t)}function qpt(e,t){return"vertical"===t?e.getLayout().x+e.getLayout().dx/2:e.getLayout().y+e.getLayout().dy/2}function Ypt(e){return e.getValue()}function jpt(e,t,a){for(var n=0,r=e.length,i=-1;++i<r;){var o=+t(e[i],a);isNaN(o)||(n+=o)}return n}function Xpt(e,t,a){gGe(e,function(e){gGe(e,function(e){if(e.inEdges.length){var n=jpt(e.inEdges,Gpt,a)/jpt(e.inEdges,Ypt);if(isNaN(n)){var r=e.inEdges.length;n=r?jpt(e.inEdges,Wpt,a)/r:0}if("vertical"===a){var i=e.getLayout().x+(n-qpt(e,a))*t;e.setLayout({x:i},!0)}else{var o=e.getLayout().y+(n-qpt(e,a))*t;e.setLayout({y:o},!0)}}})})}function $pt(e){e.eachSeriesByType("sankey",function(e){var t=e.getGraph(),a=t.nodes,n=t.edges;if(a.length){var r=1/0,i=-1/0;gGe(a,function(e){var t=e.getLayout().value;t<r&&(r=t),t>i&&(i=t)}),gGe(a,function(t){var a=new iut({type:"color",mappingMethod:"linear",dataExtent:[r,i],visual:e.get("color")}).mapValueToVisual(t.getLayout().value),n=t.getModel().get(["itemStyle","color"]);null!=n?(t.setVisual("color",n),t.setVisual("style",{fill:n})):(t.setVisual("color",a),t.setVisual("style",{fill:a}))})}n.length&&gGe(n,function(e){var t=e.getModel().get("lineStyle");e.setVisual("style",t)})})}var Kpt=function(){function e(){}return e.prototype._hasEncodeRule=function(e){var t=this.getEncode();return t&&null!=t.get(e)},e.prototype.getInitialData=function(e,t){var a,n,r=t.getComponent("xAxis",this.get("xAxisIndex")),i=t.getComponent("yAxis",this.get("yAxisIndex")),o=r.get("type"),s=i.get("type");"category"===o?(e.layout="horizontal",a=r.getOrdinalMeta(),n=!this._hasEncodeRule("x")):"category"===s?(e.layout="vertical",a=i.getOrdinalMeta(),n=!this._hasEncodeRule("y")):e.layout=e.layout||"horizontal";var l=["x","y"],c="horizontal"===e.layout?0:1,u=this._baseAxisDim=l[c],d=l[1-c],h=[r,i],p=h[c].get("type"),f=h[1-c].get("type"),m=e.data;if(m&&n){var v=[];gGe(m,function(e,t){var a;TGe(e)?(a=e.slice(),e.unshift(t)):TGe(e.value)?((a=hGe({},e)).value=a.value.slice(),e.value.unshift(t)):a=e,v.push(a)}),e.data=v}var g=this.defaultValueDimensions,y=[{name:u,type:c9e(p),ordinalMeta:a,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:d,type:c9e(f),dimsDef:g.slice()}];return yit(this,{coordDimensions:y,dimensionsCount:g.length+1,encodeDefaulter:MGe(A5e,y,this)})},e.prototype.getBaseAxis=function(){var e=this._baseAxisDim;return this.ecModel.getComponent(e+"Axis",this.get(e+"AxisIndex")).axis},e}(),Zpt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],a.visualDrawType="stroke",a}return zHe(t,e),t.type="series.boxplot",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:o5e.color.neutral00,borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:o5e.color.shadow}},animationDuration:800},t}($3e);mGe(Zpt,Kpt,!0);var Jpt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=e.getData(),r=this.group,i=this._data;this._data||r.removeAll();var o="horizontal"===e.get("layout")?1:0;n.diff(i).add(function(e){if(n.hasValue(e)){var t=tft(n.getItemLayout(e),n,e,o,!0);n.setItemGraphicEl(e,t),r.add(t)}}).update(function(e,t){var a=i.getItemGraphicEl(t);if(n.hasValue(e)){var s=n.getItemLayout(e);a?(v0e(a),aft(s,a,n,e)):a=tft(s,n,e,o),r.add(a),n.setItemGraphicEl(e,a)}else r.remove(a)}).remove(function(e){var t=i.getItemGraphicEl(e);t&&r.remove(t)}).execute(),this._data=n},t.prototype.remove=function(e){var t=this.group,a=this._data;this._data=null,a&&a.eachItemGraphicEl(function(e){e&&t.remove(e)})},t.type="boxplot",t}(s6e),Qpt=function(){},eft=function(e){function t(t){var a=e.call(this,t)||this;return a.type="boxplotBoxPath",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Qpt},t.prototype.buildPath=function(e,t){var a=t.points,n=0;for(e.moveTo(a[n][0],a[n][1]),n++;n<4;n++)e.lineTo(a[n][0],a[n][1]);for(e.closePath();n<a.length;n++)e.moveTo(a[n][0],a[n][1]),n++,e.lineTo(a[n][0],a[n][1])},t}(gZe);function tft(e,t,a,n,r){var i=e.ends,o=new eft({shape:{points:r?nft(i,n,e):i}});return aft(e,o,t,a,r),o}function aft(e,t,a,n,r){var i=a.hostModel;(0,e1e[r?"initProps":"updateProps"])(t,{shape:{points:e.ends}},i,n),t.useStyle(a.getItemVisual(n,"style")),t.style.strokeNoScale=!0,t.z2=100;var o=a.getItemModel(n),s=o.getModel("emphasis");zJe(t,o),OJe(t,s.get("focus"),s.get("blurScope"),s.get("disabled"))}function nft(e,t,a){return yGe(e,function(e){return(e=e.slice())[t]=a.initBaseline,e})}var rft=gGe;function ift(e){var t=function(e){var t=[],a=[];return e.eachSeriesByType("boxplot",function(e){var n=e.getBaseAxis(),r=fGe(a,n);r<0&&(r=a.length,a[r]=n,t[r]={axis:n,seriesModels:[]}),t[r].seriesModels.push(e)}),t}(e);rft(t,function(e){var t=e.seriesModels;t.length&&(!function(e){var t,a=e.axis,n=e.seriesModels,r=n.length,i=e.boxWidthList=[],o=e.boxOffsetList=[],s=[];if("category"===a.type)t=a.getBandWidth();else{var l=0;rft(n,function(e){l=Math.max(l,e.getData().count())});var c=a.getExtent();t=Math.abs(c[1]-c[0])/l}rft(n,function(e){var a=e.get("boxWidth");TGe(a)||(a=[a,a]),s.push([RXe(a[0],t)||0,RXe(a[1],t)||0])});var u=.8*t-2,d=u/r*.3,h=(u-d*(r-1))/r,p=h/2-u/2;rft(n,function(e,t){o.push(p),p+=d+h,i.push(Math.min(Math.max(h,s[t][0]),s[t][1]))})}(e),rft(t,function(t,a){!function(e,t,a){var n=e.coordinateSystem,r=e.getData(),i=a/2,o="horizontal"===e.get("layout")?0:1,s=1-o,l=["x","y"],c=r.mapDimension(l[o]),u=r.mapDimensionsAll(l[s]);if(null==c||u.length<5)return;for(var d=0;d<r.count();d++){var h=r.get(c,d),p=b(h,u[2],d),f=b(h,u[0],d),m=b(h,u[1],d),v=b(h,u[3],d),g=b(h,u[4],d),y=[];x(y,m,!1),x(y,v,!0),y.push(f,m,g,v),w(y,f),w(y,g),w(y,p),r.setItemLayout(d,{initBaseline:p[s],ends:y})}function b(e,a,i){var l,c=r.get(a,i),u=[];return u[o]=e,u[s]=c,isNaN(e)||isNaN(c)?l=[NaN,NaN]:(l=n.dataToPoint(u))[o]+=t,l}function x(e,t,a){var n=t.slice(),r=t.slice();n[o]+=i,r[o]-=i,a?e.push(n,r):e.push(r,n)}function w(e,t){var a=t.slice(),n=t.slice();a[o]-=i,n[o]+=i,e.push(a,n)}}(t,e.boxOffsetList[a],e.boxWidthList[a])}))})}var oft={type:"echarts:boxplot",transform:function(e){var t=e.upstream;if(t.sourceFormat!==g5e){e$e("")}var a=function(e,t){for(var a=[],n=[],r=(t=t||{}).boundIQR,i="none"===r||0===r,o=0;o<e.length;o++){var s=LXe(e[o].slice()),l=qXe(s,.25),c=qXe(s,.5),u=qXe(s,.75),d=s[0],h=s[s.length-1],p=(null==r?1.5:r)*(u-l),f=i?d:Math.max(d,l-p),m=i?h:Math.min(h,u+p),v=t.itemNameFormatter,g=kGe(v)?v({value:o}):CGe(v)?v.replace("{value}",o+""):o+"";a.push([g,f,l,c,u,m]);for(var y=0;y<s.length;y++){var b=s[y];if(b<f||b>m){var x=[g,b];n.push(x)}}}return{boxData:a,outliers:n}}(t.getRawData(),e.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:a.boxData},{data:a.outliers}]}};var sft=["itemStyle","borderColor"],lft=["itemStyle","borderColor0"],cft=["itemStyle","borderColorDoji"],uft=["itemStyle","color"],dft=["itemStyle","color0"];function hft(e,t){return t.get(e>0?uft:dft)}function pft(e,t){return t.get(0===e?cft:e>0?sft:lft)}var fft={seriesType:"candlestick",plan:r6e(),performRawSeries:!0,reset:function(e,t){if(!t.isSeriesFiltered(e))return!e.pipelineContext.large&&{progress:function(e,t){for(var a;null!=(a=e.next());){var n=t.getItemModel(a),r=t.getItemLayout(a).sign,i=n.getItemStyle();i.fill=hft(r,n),i.stroke=pft(r,n)||i.fill,hGe(t.ensureUniqueItemVisual(a,"style"),i)}}}}},mft=["color","borderColor"],vft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(e),this._isLargeDraw?this._renderLarge(e):this._renderNormal(e)},t.prototype.incrementalPrepareRender=function(e,t,a){this._clear(),this._updateDrawMode(e)},t.prototype.incrementalRender=function(e,t,a,n){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(e,t):this._incrementalRenderNormal(e,t)},t.prototype.eachRendered=function(e){q0e(this._progressiveEls||this.group,e)},t.prototype._updateDrawMode=function(e){var t=e.pipelineContext.large;null!=this._isLargeDraw&&t===this._isLargeDraw||(this._isLargeDraw=t,this._clear())},t.prototype._renderNormal=function(e){var t=e.getData(),a=this._data,n=this.group,r=t.getLayout("isSimpleBox"),i=e.get("clip",!0),o=e.coordinateSystem,s=o.getArea&&o.getArea();this._data||n.removeAll(),t.diff(a).add(function(a){if(t.hasValue(a)){var o=t.getItemLayout(a);if(i&&xft(s,o))return;var l=bft(o,a,!0);d0e(l,{shape:{points:o.ends}},e,a),wft(l,t,a,r),n.add(l),t.setItemGraphicEl(a,l)}}).update(function(o,l){var c=a.getItemGraphicEl(l);if(t.hasValue(o)){var u=t.getItemLayout(o);i&&xft(s,u)?n.remove(c):(c?(u0e(c,{shape:{points:u.ends}},e,o),v0e(c)):c=bft(u),wft(c,t,o,r),n.add(c),t.setItemGraphicEl(o,c))}else n.remove(c)}).remove(function(e){var t=a.getItemGraphicEl(e);t&&n.remove(t)}).execute(),this._data=t},t.prototype._renderLarge=function(e){this._clear(),Tft(e,this.group);var t=e.get("clip",!0)?hrt(e.coordinateSystem,!1,e):null;t?this.group.setClipPath(t):this.group.removeClipPath()},t.prototype._incrementalRenderNormal=function(e,t){for(var a,n=t.getData(),r=n.getLayout("isSimpleBox");null!=(a=e.next());){var i=bft(n.getItemLayout(a));wft(i,n,a,r),i.incremental=!0,this.group.add(i),this._progressiveEls.push(i)}},t.prototype._incrementalRenderLarge=function(e,t){Tft(t,this.group,this._progressiveEls,!0)},t.prototype.remove=function(e){this._clear()},t.prototype._clear=function(){this.group.removeAll(),this._data=null},t.type="candlestick",t}(s6e),gft=function(){},yft=function(e){function t(t){var a=e.call(this,t)||this;return a.type="normalCandlestickBox",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new gft},t.prototype.buildPath=function(e,t){var a=t.points;this.__simpleBox?(e.moveTo(a[4][0],a[4][1]),e.lineTo(a[6][0],a[6][1])):(e.moveTo(a[0][0],a[0][1]),e.lineTo(a[1][0],a[1][1]),e.lineTo(a[2][0],a[2][1]),e.lineTo(a[3][0],a[3][1]),e.closePath(),e.moveTo(a[4][0],a[4][1]),e.lineTo(a[5][0],a[5][1]),e.moveTo(a[6][0],a[6][1]),e.lineTo(a[7][0],a[7][1]))},t}(gZe);function bft(e,t,a){var n=e.ends;return new yft({shape:{points:a?_ft(n,e):n},z2:100})}function xft(e,t){for(var a=!0,n=0;n<t.ends.length;n++)if(e.contain(t.ends[n][0],t.ends[n][1])){a=!1;break}return a}function wft(e,t,a,n){var r=t.getItemModel(a);e.useStyle(t.getItemVisual(a,"style")),e.style.strokeNoScale=!0,e.__simpleBox=n,zJe(e,r);var i=t.getItemLayout(a).sign;gGe(e.states,function(e,t){var a=r.getModel(t),n=hft(i,a),o=pft(i,a)||n,s=e.style||(e.style={});n&&(s.fill=n),o&&(s.stroke=o)});var o=r.getModel("emphasis");OJe(e,o.get("focus"),o.get("blurScope"),o.get("disabled"))}function _ft(e,t){return yGe(e,function(e){return(e=e.slice())[1]=t.initBaseline,e})}var Sft=function(){},Mft=function(e){function t(t){var a=e.call(this,t)||this;return a.type="largeCandlestickBox",a}return zHe(t,e),t.prototype.getDefaultShape=function(){return new Sft},t.prototype.buildPath=function(e,t){for(var a=t.points,n=0;n<a.length;)if(this.__sign===a[n++]){var r=a[n++];e.moveTo(r,a[n++]),e.lineTo(r,a[n++])}else n+=3},t}(gZe);function Tft(e,t,a,n){var r=e.getData().getLayout("largePoints"),i=new Mft({shape:{points:r},__sign:1,ignoreCoarsePointer:!0});t.add(i);var o=new Mft({shape:{points:r},__sign:-1,ignoreCoarsePointer:!0});t.add(o);var s=new Mft({shape:{points:r},__sign:0,ignoreCoarsePointer:!0});t.add(s),kft(1,i,e),kft(-1,o,e),kft(0,s,e),n&&(i.incremental=!0,o.incremental=!0),a&&a.push(i,o)}function kft(e,t,a,n){var r=pft(e,a)||hft(e,a),i=a.getModel("itemStyle").getItemStyle(mft);t.useStyle(i),t.style.fill=null,t.style.stroke=r}var Cft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],a}return zHe(t,e),t.prototype.getShadowDim=function(){return"open"},t.prototype.brushSelector=function(e,t,a){var n=t.getItemLayout(e);return n&&a.rect(n.brushRect)},t.type="series.candlestick",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},t}($3e);function Aft(e){e&&TGe(e.series)&&gGe(e.series,function(e){IGe(e)&&"k"===e.type&&(e.type="candlestick")})}mGe(Cft,Kpt,!0);var Eft={seriesType:"candlestick",plan:r6e(),reset:function(e){var t=e.coordinateSystem,a=e.getData(),n=function(e,t){var a,n=e.getBaseAxis(),r="category"===n.type?n.getBandWidth():(a=n.getExtent(),Math.abs(a[1]-a[0])/t.count()),i=RXe(FGe(e.get("barMaxWidth"),r),r),o=RXe(FGe(e.get("barMinWidth"),1),r),s=e.get("barWidth");return null!=s?RXe(s,r):Math.max(Math.min(r/2,i),o)}(e,a),r=["x","y"],i=a.getDimensionIndex(a.mapDimension(r[0])),o=yGe(a.mapDimensionsAll(r[1]),a.getDimensionIndex,a),s=o[0],l=o[1],c=o[2],u=o[3];if(a.setLayout({candleWidth:n,isSimpleBox:n<=1.3}),!(i<0||o.length<4))return{progress:e.pipelineContext.large?function(a,n){var r,o,d=iet(4*a.count),h=0,p=[],f=[],m=n.getStore(),v=!!e.get(["itemStyle","borderColorDoji"]);for(;null!=(o=a.next());){var g=m.get(i,o),y=m.get(s,o),b=m.get(l,o),x=m.get(c,o),w=m.get(u,o);isNaN(g)||isNaN(x)||isNaN(w)?(d[h++]=NaN,h+=3):(d[h++]=Ift(m,o,y,b,l,v),p[0]=g,p[1]=x,r=t.dataToPoint(p,null,f),d[h++]=r?r[0]:NaN,d[h++]=r?r[1]:NaN,p[1]=w,r=t.dataToPoint(p,null,f),d[h++]=r?r[1]:NaN)}n.setLayout("largePoints",d)}:function(e,a){var r,o=a.getStore();for(;null!=(r=e.next());){var d=o.get(i,r),h=o.get(s,r),p=o.get(l,r),f=o.get(c,r),m=o.get(u,r),v=Math.min(h,p),g=Math.max(h,p),y=M(v,d),b=M(g,d),x=M(f,d),w=M(m,d),_=[];T(_,b,0),T(_,y,1),_.push(C(w),C(b),C(x),C(y));var S=!!a.getItemModel(r).get(["itemStyle","borderColorDoji"]);a.setItemLayout(r,{sign:Ift(o,r,h,p,l,S),initBaseline:h>p?b[1]:y[1],ends:_,brushRect:k(f,m,d)})}function M(e,a){var n=[];return n[0]=a,n[1]=e,isNaN(a)||isNaN(e)?[NaN,NaN]:t.dataToPoint(n)}function T(e,t,a){var r=t.slice(),i=t.slice();r[0]=E0e(r[0]+n/2,1,!1),i[0]=E0e(i[0]-n/2,1,!0),a?e.push(r,i):e.push(i,r)}function k(e,t,a){var r=M(e,a),i=M(t,a);return r[0]-=n/2,i[0]-=n/2,{x:r[0],y:r[1],width:n,height:i[1]-r[1]}}function C(e){return e[0]=E0e(e[0],1),e}}}}};function Ift(e,t,a,n,r,i){return a>n?-1:a<n?1:i?0:t>0?e.get(r,t-1)<=n?1:-1:1}function Rft(e,t){var a=t.rippleEffectColor||t.color;e.eachChild(function(e){e.attr({z:t.z,zlevel:t.zlevel,style:{stroke:"stroke"===t.brushType?a:null,fill:"fill"===t.brushType?a:null}})})}var Dft=function(e){function t(t,a){var n=e.call(this)||this,r=new Xnt(t,a),i=new xXe;return n.add(r),n.add(i),n.updateData(t,a),n}return zHe(t,e),t.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},t.prototype.startEffectAnimation=function(e){for(var t=e.symbolType,a=e.color,n=e.rippleNumber,r=this.childAt(1),i=0;i<n;i++){var o=y8e(t,-1,-1,2,2,a);o.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var s=-i/n*e.period+e.effectOffset;o.animate("",!0).when(e.period,{scaleX:e.rippleScale/2,scaleY:e.rippleScale/2}).delay(s).start(),o.animateStyle(!0).when(e.period,{opacity:0}).delay(s).start(),r.add(o)}Rft(r,e)},t.prototype.updateEffectAnimation=function(e){for(var t=this._effectCfg,a=this.childAt(1),n=["symbolType","period","rippleScale","rippleNumber"],r=0;r<n.length;r++){var i=n[r];if(t[i]!==e[i])return this.stopEffectAnimation(),void this.startEffectAnimation(e)}Rft(a,e)},t.prototype.highlight=function(){_Je(this)},t.prototype.downplay=function(){SJe(this)},t.prototype.getSymbolType=function(){var e=this.childAt(0);return e&&e.getSymbolType()},t.prototype.updateData=function(e,t){var a=this,n=e.hostModel;this.childAt(0).updateData(e,t);var r=this.childAt(1),i=e.getItemModel(t),o=e.getItemVisual(t,"symbol"),s=b8e(e.getItemVisual(t,"symbolSize")),l=e.getItemVisual(t,"style"),c=l&&l.fill,u=i.getModel("emphasis");r.setScale(s),r.traverse(function(e){e.setStyle("fill",c)});var d=x8e(e.getItemVisual(t,"symbolOffset"),s);d&&(r.x=d[0],r.y=d[1]);var h=e.getItemVisual(t,"symbolRotate");r.rotation=(h||0)*Math.PI/180||0;var p={};p.showEffectOn=n.get("showEffectOn"),p.rippleScale=i.get(["rippleEffect","scale"]),p.brushType=i.get(["rippleEffect","brushType"]),p.period=1e3*i.get(["rippleEffect","period"]),p.effectOffset=t/e.count(),p.z=n.getShallow("z")||0,p.zlevel=n.getShallow("zlevel")||0,p.symbolType=o,p.color=c,p.rippleEffectColor=i.get(["rippleEffect","color"]),p.rippleNumber=i.get(["rippleEffect","number"]),"render"===p.showEffectOn?(this._effectCfg?this.updateEffectAnimation(p):this.startEffectAnimation(p),this._effectCfg=p):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(e){"emphasis"===e?"render"!==p.showEffectOn&&a.startEffectAnimation(p):"normal"===e&&"render"!==p.showEffectOn&&a.stopEffectAnimation()}),this._effectCfg=p,OJe(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype.fadeOut=function(e){e&&e()},t}(xXe),Pft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(){this._symbolDraw=new Qnt(Dft)},t.prototype.render=function(e,t,a){var n=e.getData(),r=this._symbolDraw;r.updateData(n,{clipShape:this._getClipShape(e)}),this.group.add(r.group)},t.prototype._getClipShape=function(e){var t=e.coordinateSystem,a=t&&t.getArea&&t.getArea();return e.get("clip",!0)?a:null},t.prototype.updateTransform=function(e,t,a){var n=e.getData();this.group.dirty();var r=krt("").reset(e,t,a);r.progress&&r.progress({start:0,end:n.count(),count:n.count()},n),this._symbolDraw.updateLayout()},t.prototype._updateGroupTransform=function(e){var t,a,n=e.coordinateSystem;n&&n.getRoamTransform&&(this.group.transform=(t=n.getRoamTransform(),XWe(a=[1,0,0,1,0,0],t),a),this.group.decomposeTransform())},t.prototype.remove=function(e,t){this._symbolDraw&&this._symbolDraw.remove(!0)},t.type="effectScatter",t}(s6e),Lft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){return U9e(null,this,{useEncodeDefaulter:!0})},t.prototype.brushSelector=function(e,t,a){return a.point(t.getItemLayout(e))},t.type="series.effectScatter",t.dependencies=["grid","polar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},t}($3e);var Nft=function(e){function t(t,a,n){var r=e.call(this)||this;return r.add(r.createLine(t,a,n)),r._updateEffectSymbol(t,a),r}return zHe(t,e),t.prototype.createLine=function(e,t,a){return new ydt(e,t,a)},t.prototype._updateEffectSymbol=function(e,t){var a=e.getItemModel(t).getModel("effect"),n=a.get("symbolSize"),r=a.get("symbol");TGe(n)||(n=[n,n]);var i=e.getItemVisual(t,"style"),o=a.get("color")||i&&i.stroke,s=this.childAt(1);this._symbolType!==r&&(this.remove(s),(s=y8e(r,-.5,-.5,1,1,o)).z2=100,s.culling=!0,this.add(s)),s&&(s.setStyle("shadowColor",o),s.setStyle(a.getItemStyle(["color"])),s.scaleX=n[0],s.scaleY=n[1],s.setColor(o),this._symbolType=r,this._symbolScale=n,this._updateEffectAnimation(e,a,t))},t.prototype._updateEffectAnimation=function(e,t,a){var n=this.childAt(1);if(n){var r=e.getItemLayout(a),i=1e3*t.get("period"),o=t.get("loop"),s=t.get("roundTrip"),l=t.get("constantSpeed"),c=OGe(t.get("delay"),function(t){return t/e.count()*i/3});if(n.ignore=!0,this._updateAnimationPoints(n,r),l>0&&(i=this._getLineLength(n)/l*1e3),i!==this._period||o!==this._loop||s!==this._roundTrip){n.stopAnimation();var u=void 0;u=kGe(c)?c(a):c,n.__t>0&&(u=-i*n.__t),this._animateSymbol(n,i,u,o,s)}this._period=i,this._loop=o,this._roundTrip=s}},t.prototype._animateSymbol=function(e,t,a,n,r){if(t>0){e.__t=0;var i=this,o=e.animate("",n).when(r?2*t:t,{__t:r?2:1}).delay(a).during(function(){i._updateSymbolPosition(e)});n||o.done(function(){i.remove(e)}),o.start()}},t.prototype._getLineLength=function(e){return pWe(e.__p1,e.__cp1)+pWe(e.__cp1,e.__p2)},t.prototype._updateAnimationPoints=function(e,t){e.__p1=t[0],e.__p2=t[1],e.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]},t.prototype.updateData=function(e,t,a){this.childAt(0).updateData(e,t,a),this._updateEffectSymbol(e,t)},t.prototype._updateSymbolPosition=function(e){var t=e.__p1,a=e.__p2,n=e.__cp1,r=e.__t<1?e.__t:2-e.__t,i=[e.x,e.y],o=i.slice(),s=iYe,l=oYe;i[0]=s(t[0],n[0],a[0],r),i[1]=s(t[1],n[1],a[1],r);var c=e.__t<1?l(t[0],n[0],a[0],r):l(a[0],n[0],t[0],1-r),u=e.__t<1?l(t[1],n[1],a[1],r):l(a[1],n[1],t[1],1-r);e.rotation=-Math.atan2(u,c)-Math.PI/2,"line"!==this._symbolType&&"rect"!==this._symbolType&&"roundRect"!==this._symbolType||(void 0!==e.__lastT&&e.__lastT<e.__t?(e.scaleY=1.05*pWe(o,i),1===r&&(i[0]=o[0]+(i[0]-o[0])/2,i[1]=o[1]+(i[1]-o[1])/2)):1===e.__lastT?e.scaleY=2*pWe(t,i):e.scaleY=this._symbolScale[1]),e.__lastT=e.__t,e.ignore=!1,e.x=i[0],e.y=i[1]},t.prototype.updateLayout=function(e,t){this.childAt(0).updateLayout(e,t);var a=e.getItemModel(t).getModel("effect");this._updateEffectAnimation(e,a,t)},t}(xXe),Oft=function(e){function t(t,a,n){var r=e.call(this)||this;return r._createPolyline(t,a,n),r}return zHe(t,e),t.prototype._createPolyline=function(e,t,a){var n=e.getItemLayout(t),r=new OQe({shape:{points:n}});this.add(r),this._updateCommonStl(e,t,a)},t.prototype.updateData=function(e,t,a){var n=e.hostModel;u0e(this.childAt(0),{shape:{points:e.getItemLayout(t)}},n,t),this._updateCommonStl(e,t,a)},t.prototype._updateCommonStl=function(e,t,a){var n=this.childAt(0),r=e.getItemModel(t),i=a&&a.emphasisLineStyle,o=a&&a.focus,s=a&&a.blurScope,l=a&&a.emphasisDisabled;if(!a||e.hasItemOption){var c=r.getModel("emphasis");i=c.getModel("lineStyle").getLineStyle(),l=c.get("disabled"),o=c.get("focus"),s=c.get("blurScope")}n.useStyle(e.getItemVisual(t,"style")),n.style.fill=null,n.style.strokeNoScale=!0,n.ensureState("emphasis").style=i,OJe(this,o,s,l)},t.prototype.updateLayout=function(e,t){this.childAt(0).setShape("points",e.getItemLayout(t))},t}(xXe),Fft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._lastFrame=0,t._lastFramePercent=0,t}return zHe(t,e),t.prototype.createLine=function(e,t,a){return new Oft(e,t,a)},t.prototype._updateAnimationPoints=function(e,t){this._points=t;for(var a=[0],n=0,r=1;r<t.length;r++){var i=t[r-1],o=t[r];n+=pWe(i,o),a.push(n)}if(0!==n){for(r=0;r<a.length;r++)a[r]/=n;this._offsets=a,this._length=n}else this._length=0},t.prototype._getLineLength=function(){return this._length},t.prototype._updateSymbolPosition=function(e){var t=e.__t<1?e.__t:2-e.__t,a=this._points,n=this._offsets,r=a.length;if(n){var i,o=this._lastFrame;if(t<this._lastFramePercent){for(i=Math.min(o+1,r-1);i>=0&&!(n[i]<=t);i--);i=Math.min(i,r-2)}else{for(i=o;i<r&&!(n[i]>t);i++);i=Math.min(i-1,r-2)}var s=(t-n[i])/(n[i+1]-n[i]),l=a[i],c=a[i+1];e.x=l[0]*(1-s)+s*c[0],e.y=l[1]*(1-s)+s*c[1];var u=e.__t<1?c[0]-l[0]:l[0]-c[0],d=e.__t<1?c[1]-l[1]:l[1]-c[1];e.rotation=-Math.atan2(d,u)-Math.PI/2,this._lastFrame=i,this._lastFramePercent=t,e.ignore=!1}},t}(Nft),Bft=function(){this.polyline=!1,this.curveness=0,this.segs=[]},Uft=function(e){function t(t){var a=e.call(this,t)||this;return a._off=0,a.hoverDataIdx=-1,a}return zHe(t,e),t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.getDefaultStyle=function(){return{stroke:o5e.color.neutral99,fill:null}},t.prototype.getDefaultShape=function(){return new Bft},t.prototype.buildPath=function(e,t){var a,n=t.segs,r=t.curveness;if(t.polyline)for(a=this._off;a<n.length;){var i=n[a++];if(i>0){e.moveTo(n[a++],n[a++]);for(var o=1;o<i;o++)e.lineTo(n[a++],n[a++])}}else for(a=this._off;a<n.length;){var s=n[a++],l=n[a++],c=n[a++],u=n[a++];if(e.moveTo(s,l),r>0){var d=(s+c)/2-(l-u)*r,h=(l+u)/2-(c-s)*r;e.quadraticCurveTo(d,h,c,u)}else e.lineTo(c,u)}this.incremental&&(this._off=a,this.notClear=!0)},t.prototype.findDataIndex=function(e,t){var a=this.shape,n=a.segs,r=a.curveness,i=this.style.lineWidth;if(a.polyline)for(var o=0,s=0;s<n.length;){var l=n[s++];if(l>0)for(var c=n[s++],u=n[s++],d=1;d<l;d++){if(ZKe(c,u,h=n[s++],p=n[s++],i,e,t))return o}o++}else for(o=0,s=0;s<n.length;){c=n[s++],u=n[s++];var h=n[s++],p=n[s++];if(r>0){if(QKe(c,u,(c+h)/2-(u-p)*r,(u+p)/2-(h-c)*r,h,p,i,e,t))return o}else if(ZKe(c,u,h,p,i,e,t))return o;o++}return-1},t.prototype.contain=function(e,t){var a=this.transformCoordToLocal(e,t),n=this.getBoundingRect();return e=a[0],t=a[1],n.contain(e,t)?(this.hoverDataIdx=this.findDataIndex(e,t))>=0:(this.hoverDataIdx=-1,!1)},t.prototype.getBoundingRect=function(){var e=this._rect;if(!e){for(var t=this.shape.segs,a=1/0,n=1/0,r=-1/0,i=-1/0,o=0;o<t.length;){var s=t[o++],l=t[o++];a=Math.min(s,a),r=Math.max(s,r),n=Math.min(l,n),i=Math.max(l,i)}e=this._rect=new fqe(a,n,r,i)}return e},t}(gZe),zft=function(){function e(){this.group=new xXe}return e.prototype.updateData=function(e){this._clear();var t=this._create();t.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(t,e)},e.prototype.incrementalPrepareUpdate=function(e){this.group.removeAll(),this._clear()},e.prototype.incrementalUpdate=function(e,t){var a=this._newAdded[0],n=t.getLayout("linesPoints"),r=a&&a.shape.segs;if(r&&r.length<2e4){var i=r.length,o=new Float32Array(i+n.length);o.set(r),o.set(n,i),a.setShape({segs:o})}else{this._newAdded=[];var s=this._create();s.incremental=!0,s.setShape({segs:n}),this._setCommon(s,t),s.__startIndex=e.start}},e.prototype.remove=function(){this._clear()},e.prototype.eachRendered=function(e){this._newAdded[0]&&e(this._newAdded[0])},e.prototype._create=function(){var e=new Uft({cursor:"default",ignoreCoarsePointer:!0});return this._newAdded.push(e),this.group.add(e),e},e.prototype._setCommon=function(e,t,a){var n=t.hostModel;e.setShape({polyline:n.get("polyline"),curveness:n.get(["lineStyle","curveness"])}),e.useStyle(n.getModel("lineStyle").getLineStyle()),e.style.strokeNoScale=!0;var r=t.getVisual("style");r&&r.stroke&&e.setStyle("stroke",r.stroke),e.setStyle("fill",null);var i=YZe(e);i.seriesIndex=n.seriesIndex,e.on("mousemove",function(t){i.dataIndex=null;var a=e.hoverDataIdx;a>0&&(i.dataIndex=a+e.__startIndex)})},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),Vft={seriesType:"lines",plan:r6e(),reset:function(e){var t=e.coordinateSystem;if(t){var a=e.get("polyline"),n=e.pipelineContext.large;return{progress:function(r,i){var o=[];if(n){var s=void 0,l=r.end-r.start;if(a){for(var c=0,u=r.start;u<r.end;u++)c+=e.getLineCoordsCount(u);s=new Float32Array(l+2*c)}else s=new Float32Array(4*l);var d=0,h=[];for(u=r.start;u<r.end;u++){var p=e.getLineCoords(u,o);a&&(s[d++]=p);for(var f=0;f<p;f++)h=t.dataToPoint(o[f],!1,h),s[d++]=h[0],s[d++]=h[1]}i.setLayout("linesPoints",s)}else for(u=r.start;u<r.end;u++){var m=i.getItemModel(u),v=(p=e.getLineCoords(u,o),[]);if(a)for(var g=0;g<p;g++)v.push(t.dataToPoint(o[g]));else{v[0]=t.dataToPoint(o[0]),v[1]=t.dataToPoint(o[1]);var y=m.get(["lineStyle","curveness"]);+y&&(v[2]=[(v[0][0]+v[1][0])/2-(v[0][1]-v[1][1])*y,(v[0][1]+v[1][1])/2-(v[1][0]-v[0][0])*y])}i.setItemLayout(u,v)}}}}}},Hft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=e.getData(),r=this._updateLineDraw(n,e),i=e.get("zlevel"),o=e.get(["effect","trailLength"]),s=a.getZr(),l="svg"===s.painter.getType();l||s.painter.getLayer(i).clear(!0),null==this._lastZlevel||l||s.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(e)&&o>0&&(l||s.configLayer(i,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(o/10+.9,1),0)})),r.updateData(n);var c=e.get("clip",!0)&&hrt(e.coordinateSystem,!1,e);c?this.group.setClipPath(c):this.group.removeClipPath(),this._lastZlevel=i,this._finished=!0},t.prototype.incrementalPrepareRender=function(e,t,a){var n=e.getData();this._updateLineDraw(n,e).incrementalPrepareUpdate(n),this._clearLayer(a),this._finished=!1},t.prototype.incrementalRender=function(e,t,a){this._lineDraw.incrementalUpdate(e,t.getData()),this._finished=e.end===t.getData().count()},t.prototype.eachRendered=function(e){this._lineDraw&&this._lineDraw.eachRendered(e)},t.prototype.updateTransform=function(e,t,a){var n=e.getData(),r=e.pipelineContext;if(!this._finished||r.large||r.progressiveRender)return{update:!0};var i=Vft.reset(e,t,a);i.progress&&i.progress({start:0,end:n.count(),count:n.count()},n),this._lineDraw.updateLayout(),this._clearLayer(a)},t.prototype._updateLineDraw=function(e,t){var a=this._lineDraw,n=this._showEffect(t),r=!!t.get("polyline"),i=t.pipelineContext.large;return a&&n===this._hasEffet&&r===this._isPolyline&&i===this._isLargeDraw||(a&&a.remove(),a=this._lineDraw=i?new zft:new bdt(r?n?Fft:Oft:n?Nft:ydt),this._hasEffet=n,this._isPolyline=r,this._isLargeDraw=i),this.group.add(a.group),a},t.prototype._showEffect=function(e){return!!e.get(["effect","show"])},t.prototype._clearLayer=function(e){var t=e.getZr();"svg"===t.painter.getType()||null==this._lastZlevel||t.painter.getLayer(this._lastZlevel).clear(!0)},t.prototype.remove=function(e,t){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(t)},t.prototype.dispose=function(e,t){this.remove(e,t)},t.type="lines",t}(s6e),Gft="undefined"==typeof Uint32Array?Array:Uint32Array,Wft="undefined"==typeof Float64Array?Array:Float64Array;function qft(e){var t=e.data;t&&t[0]&&t[0][0]&&t[0][0].coord&&(e.data=yGe(t,function(e){var t={coords:[e[0].coord,e[1].coord]};return e[0].name&&(t.fromName=e[0].name),e[1].name&&(t.toName=e[1].name),dGe([t,e[0],e[1]])}))}var Yft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.visualStyleAccessPath="lineStyle",a.visualDrawType="stroke",a}return zHe(t,e),t.prototype.init=function(t){t.data=t.data||[],qft(t);var a=this._processFlatCoordsArray(t.data);this._flatCoords=a.flatCoords,this._flatCoordsOffset=a.flatCoordsOffset,a.flatCoords&&(t.data=new Float32Array(a.count)),e.prototype.init.apply(this,arguments)},t.prototype.mergeOption=function(t){if(qft(t),t.data){var a=this._processFlatCoordsArray(t.data);this._flatCoords=a.flatCoords,this._flatCoordsOffset=a.flatCoordsOffset,a.flatCoords&&(t.data=new Float32Array(a.count))}e.prototype.mergeOption.apply(this,arguments)},t.prototype.appendData=function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=KGe(this._flatCoords,t.flatCoords),this._flatCoordsOffset=KGe(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},t.prototype._getCoordsFromItemModel=function(e){var t=this.getData().getItemModel(e);return t.option instanceof Array?t.option:t.getShallow("coords")},t.prototype.getLineCoordsCount=function(e){return this._flatCoordsOffset?this._flatCoordsOffset[2*e+1]:this._getCoordsFromItemModel(e).length},t.prototype.getLineCoords=function(e,t){if(this._flatCoordsOffset){for(var a=this._flatCoordsOffset[2*e],n=this._flatCoordsOffset[2*e+1],r=0;r<n;r++)t[r]=t[r]||[],t[r][0]=this._flatCoords[a+2*r],t[r][1]=this._flatCoords[a+2*r+1];return n}var i=this._getCoordsFromItemModel(e);for(r=0;r<i.length;r++)t[r]=t[r]||[],t[r][0]=i[r][0],t[r][1]=i[r][1];return i.length},t.prototype._processFlatCoordsArray=function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),EGe(e[0])){for(var a=e.length,n=new Gft(a),r=new Wft(a),i=0,o=0,s=0,l=0;l<a;){s++;var c=e[l++];n[o++]=i+t,n[o++]=c;for(var u=0;u<c;u++){var d=e[l++],h=e[l++];r[i++]=d,r[i++]=h}}return{flatCoordsOffset:new Uint32Array(n.buffer,0,o),flatCoords:r,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},t.prototype.getInitialData=function(e,t){var a=new I9e(["value"],this);return a.hasItemOption=!1,a.initData(e.data,[],function(e,t,n,r){if(e instanceof Array)return NaN;a.hasItemOption=!0;var i=e.value;return null!=i?i instanceof Array?i[r]:i:void 0}),a},t.prototype.formatTooltip=function(e,t,a){var n=this.getData().getItemModel(e),r=n.get("name");if(r)return r;var i=n.get("fromName"),o=n.get("toName"),s=[];return null!=i&&s.push(i),null!=o&&s.push(o),P3e("nameValue",{name:s.join(" > ")})},t.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},t.prototype.getProgressive=function(){var e=this.option.progressive;return null==e?this.option.large?1e4:this.get("progressive"):e},t.prototype.getProgressiveThreshold=function(){var e=this.option.progressiveThreshold;return null==e?this.option.large?2e4:this.get("progressiveThreshold"):e},t.prototype.getZLevelKey=function(){var e=this.getModel("effect"),t=e.get("trailLength");return this.getData().count()>this.getProgressiveThreshold()?this.id:e.get("show")&&t>0?t+"":""},t.type="series.lines",t.dependencies=["grid","polar","geo","calendar"],t.defaultOption={coordinateSystem:"geo",z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},t}($3e);function jft(e){return e instanceof Array||(e=[e,e]),e}var Xft={seriesType:"lines",reset:function(e){var t=jft(e.get("symbol")),a=jft(e.get("symbolSize")),n=e.getData();return n.setVisual("fromSymbol",t&&t[0]),n.setVisual("toSymbol",t&&t[1]),n.setVisual("fromSymbolSize",a&&a[0]),n.setVisual("toSymbolSize",a&&a[1]),{dataEach:n.hasItemOption?function(e,t){var a=e.getItemModel(t),n=jft(a.getShallow("symbol",!0)),r=jft(a.getShallow("symbolSize",!0));n[0]&&e.setItemVisual(t,"fromSymbol",n[0]),n[1]&&e.setItemVisual(t,"toSymbol",n[1]),r[0]&&e.setItemVisual(t,"fromSymbolSize",r[0]),r[1]&&e.setItemVisual(t,"toSymbolSize",r[1])}:null}}};var $ft=function(){function e(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var e=XHe.createCanvas();this.canvas=e}return e.prototype.update=function(e,t,a,n,r,i){var o=this._getBrush(),s=this._getGradient(r,"inRange"),l=this._getGradient(r,"outOfRange"),c=this.pointSize+this.blurSize,u=this.canvas,d=u.getContext("2d"),h=e.length;u.width=t,u.height=a;for(var p=0;p<h;++p){var f=e[p],m=f[0],v=f[1],g=n(f[2]);d.globalAlpha=g,d.drawImage(o,m-c,v-c)}if(!u.width||!u.height)return u;for(var y=d.getImageData(0,0,u.width,u.height),b=y.data,x=0,w=b.length,_=this.minOpacity,S=this.maxOpacity-_;x<w;){g=b[x+3]/256;var M=4*Math.floor(255*g);if(g>0){var T=i(g)?s:l;g>0&&(g=g*S+_),b[x++]=T[M],b[x++]=T[M+1],b[x++]=T[M+2],b[x++]=T[M+3]*g*256}else x+=4}return d.putImageData(y,0,0),u},e.prototype._getBrush=function(){var e=this._brushCanvas||(this._brushCanvas=XHe.createCanvas()),t=this.pointSize+this.blurSize,a=2*t;e.width=a,e.height=a;var n=e.getContext("2d");return n.clearRect(0,0,a,a),n.shadowOffsetX=a,n.shadowBlur=this.blurSize,n.shadowColor=o5e.color.neutral99,n.beginPath(),n.arc(-t,t,this.pointSize,0,2*Math.PI,!0),n.closePath(),n.fill(),e},e.prototype._getGradient=function(e,t){for(var a=this._gradientPixels,n=a[t]||(a[t]=new Uint8ClampedArray(1024)),r=[0,0,0,0],i=0,o=0;o<256;o++)e[t](o/255,!0,r),n[i++]=r[0],n[i++]=r[1],n[i++]=r[2],n[i++]=r[3];return n},e}();function Kft(e){var t=e.dimensions;return"lng"===t[0]&&"lat"===t[1]}var Zft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n;t.eachComponent("visualMap",function(t){t.eachTargetSeries(function(a){a===e&&(n=t)})}),this._progressiveEls=null,this.group.removeAll();var r=e.coordinateSystem;"cartesian2d"===r.type||"calendar"===r.type||"matrix"===r.type?this._renderOnGridLike(e,a,0,e.getData().count()):Kft(r)&&this._renderOnGeo(r,e,n,a)},t.prototype.incrementalPrepareRender=function(e,t,a){this.group.removeAll()},t.prototype.incrementalRender=function(e,t,a,n){var r=t.coordinateSystem;r&&(Kft(r)?this.render(t,a,n):(this._progressiveEls=[],this._renderOnGridLike(t,n,e.start,e.end,!0)))},t.prototype.eachRendered=function(e){q0e(this._progressiveEls||this.group,e)},t.prototype._renderOnGridLike=function(e,t,a,n,r){var i,o,s,l,c=e.coordinateSystem,u=prt(c,"cartesian2d"),d=prt(c,"matrix");if(u){var h=c.getAxis("x"),p=c.getAxis("y");i=h.getBandWidth()+.5,o=p.getBandWidth()+.5,s=h.scale.getExtent(),l=p.scale.getExtent()}for(var f=this.group,m=e.getData(),v=e.getModel(["emphasis","itemStyle"]).getItemStyle(),g=e.getModel(["blur","itemStyle"]).getItemStyle(),y=e.getModel(["select","itemStyle"]).getItemStyle(),b=e.get(["itemStyle","borderRadius"]),x=i1e(e),w=e.getModel("emphasis"),_=w.get("focus"),S=w.get("blurScope"),M=w.get("disabled"),T=u||d?[m.mapDimension("x"),m.mapDimension("y"),m.mapDimension("value")]:[m.mapDimension("time"),m.mapDimension("value")],k=a;k<n;k++){var C=void 0,A=m.getItemVisual(k,"style");if(u){var E=m.get(T[0],k),I=m.get(T[1],k);if(isNaN(m.get(T[2],k))||isNaN(E)||isNaN(I)||E<s[0]||E>s[1]||I<l[0]||I>l[1])continue;var R=c.dataToPoint([E,I]);C=new EZe({shape:{x:R[0]-i/2,y:R[1]-o/2,width:i,height:o},style:A})}else if(d){if(NGe((D=c.dataToLayout([m.get(T[0],k),m.get(T[1],k)]).rect).x))continue;C=new EZe({z2:1,shape:D,style:A})}else{if(isNaN(m.get(T[1],k)))continue;var D,P=c.dataToLayout([m.get(T[0],k)]);if(NGe((D=P.contentRect||P.rect).x)||NGe(D.y))continue;C=new EZe({z2:1,shape:D,style:A})}if(m.hasItemOption){var L=m.getItemModel(k),N=L.getModel("emphasis");v=N.getModel("itemStyle").getItemStyle(),g=L.getModel(["blur","itemStyle"]).getItemStyle(),y=L.getModel(["select","itemStyle"]).getItemStyle(),b=L.get(["itemStyle","borderRadius"]),_=N.get("focus"),S=N.get("blurScope"),M=N.get("disabled"),x=i1e(L)}C.shape.r=b;var O=e.getRawValue(k),F="-";O&&null!=O[2]&&(F=O[2]+""),r1e(C,x,{labelFetcher:e,labelDataIndex:k,defaultOpacity:A.opacity,defaultText:F}),C.ensureState("emphasis").style=v,C.ensureState("blur").style=g,C.ensureState("select").style=y,OJe(C,_,S,M),C.incremental=r,r&&(C.states.emphasis.hoverLayer=!0),f.add(C),m.setItemGraphicEl(k,C),this._progressiveEls&&this._progressiveEls.push(C)}},t.prototype._renderOnGeo=function(e,t,a,n){var r=a.targetVisuals.inRange,i=a.targetVisuals.outOfRange,o=t.getData(),s=this._hmLayer||this._hmLayer||new $ft;s.blurSize=t.get("blurSize"),s.pointSize=t.get("pointSize"),s.minOpacity=t.get("minOpacity"),s.maxOpacity=t.get("maxOpacity");var l=e.getViewRect().clone(),c=e.getRoamTransform();l.applyTransform(c);var u=Math.max(l.x,0),d=Math.max(l.y,0),h=Math.min(l.width+l.x,n.getWidth()),p=Math.min(l.height+l.y,n.getHeight()),f=h-u,m=p-d,v=[o.mapDimension("lng"),o.mapDimension("lat"),o.mapDimension("value")],g=o.mapArray(v,function(t,a,n){var r=e.dataToPoint([t,a]);return r[0]-=u,r[1]-=d,r.push(n),r}),y=a.getExtent(),b="visualMap.continuous"===a.type?function(e,t){var a=e[1]-e[0];return t=[(t[0]-e[0])/a,(t[1]-e[0])/a],function(e){return e>=t[0]&&e<=t[1]}}(y,a.option.range):function(e,t,a){var n=e[1]-e[0],r=(t=yGe(t,function(t){return{interval:[(t.interval[0]-e[0])/n,(t.interval[1]-e[0])/n]}})).length,i=0;return function(e){var n;for(n=i;n<r;n++)if((o=t[n].interval)[0]<=e&&e<=o[1]){i=n;break}if(n===r)for(n=i-1;n>=0;n--){var o;if((o=t[n].interval)[0]<=e&&e<=o[1]){i=n;break}}return n>=0&&n<r&&a[n]}}(y,a.getPieceList(),a.option.selected);s.update(g,f,m,r.color.getNormalizer(),{inRange:r.color.getColorMapper(),outOfRange:i.color.getColorMapper()},b);var x=new _Ze({style:{width:f,height:m,x:u,y:d,image:s.canvas},silent:!0});this.group.add(x)},t.type="heatmap",t}(s6e),Jft=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){return U9e(null,this,{generateCoord:"value"})},t.prototype.preventIncremental=function(){var e=D2e.get(this.get("coordinateSystem"));if(e&&e.dimensions)return"lng"===e.dimensions[0]&&"lat"===e.dimensions[1]},t.type="series.heatmap",t.dependencies=["grid","geo","calendar","matrix"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:o5e.color.primary}}},t}($3e);function Qft(e){e.registerChartView(Zft),e.registerSeriesModel(Jft)}var emt=["itemStyle","borderWidth"],tmt=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],amt=new hQe,nmt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=this.group,r=e.getData(),i=this._data,o=e.coordinateSystem,s=o.getBaseAxis().isHorizontal(),l=o.master.getRect(),c={ecSize:{width:a.getWidth(),height:a.getHeight()},seriesModel:e,coordSys:o,coordSysExtent:[[l.x,l.x+l.width],[l.y,l.y+l.height]],isHorizontal:s,valueDim:tmt[+s],categoryDim:tmt[1-+s]};r.diff(i).add(function(e){if(r.hasValue(e)){var t=dmt(r,e),a=rmt(r,e,t,c),i=fmt(r,c,a);r.setItemGraphicEl(e,i),n.add(i),bmt(i,c,a)}}).update(function(e,t){var a=i.getItemGraphicEl(t);if(r.hasValue(e)){var o=dmt(r,e),s=rmt(r,e,o,c),l=vmt(r,s);a&&l!==a.__pictorialShapeStr&&(n.remove(a),r.setItemGraphicEl(e,null),a=null),a?function(e,t,a){var n=a.animationModel,r=a.dataIndex,i=e.__pictorialBundle;u0e(i,{x:a.bundlePosition[0],y:a.bundlePosition[1]},n,r),a.symbolRepeat?smt(e,t,a,!0):lmt(e,t,a,!0);cmt(e,a,!0),umt(e,t,a,!0)}(a,c,s):a=fmt(r,c,s,!0),r.setItemGraphicEl(e,a),a.__pictorialSymbolMeta=s,n.add(a),bmt(a,c,s)}else n.remove(a)}).remove(function(e){var t=i.getItemGraphicEl(e);t&&mmt(i,e,t.__pictorialSymbolMeta.animationModel,t)}).execute();var u=e.get("clip",!0)?hrt(e.coordinateSystem,!1,e):null;return u?n.setClipPath(u):n.removeClipPath(),this._data=r,this.group},t.prototype.remove=function(e,t){var a=this.group,n=this._data;e.get("animation")?n&&n.eachItemGraphicEl(function(t){mmt(n,YZe(t).dataIndex,e,t)}):a.removeAll()},t.type="pictorialBar",t}(s6e);function rmt(e,t,a,n){var r=e.getItemLayout(t),i=a.get("symbolRepeat"),o=a.get("symbolClip"),s=a.get("symbolPosition")||"start",l=(a.get("symbolRotate")||0)*Math.PI/180||0,c=a.get("symbolPatternSize")||2,u=a.isAnimationEnabled(),d={dataIndex:t,layout:r,itemModel:a,symbolType:e.getItemVisual(t,"symbol")||"circle",style:e.getItemVisual(t,"style"),symbolClip:o,symbolRepeat:i,symbolRepeatDirection:a.get("symbolRepeatDirection"),symbolPatternSize:c,rotation:l,animationModel:u?a:null,hoverScale:u&&a.get(["emphasis","scale"]),z2:a.getShallow("z",!0)||0};!function(e,t,a,n,r){var i,o=n.valueDim,s=e.get("symbolBoundingData"),l=n.coordSys.getOtherAxis(n.coordSys.getBaseAxis()),c=l.toGlobalCoord(l.dataToCoord(0)),u=1-+(a[o.wh]<=0);if(TGe(s)){var d=[imt(l,s[0])-c,imt(l,s[1])-c];d[1]<d[0]&&d.reverse(),i=d[u]}else i=null!=s?imt(l,s)-c:t?n.coordSysExtent[o.index][u]-c:a[o.wh];r.boundingLength=i,t&&(r.repeatCutLength=a[o.wh]);var h="x"===o.xy,p=l.inverse;r.pxSign=h&&!p||!h&&p?i>=0?1:-1:i>0?1:-1}(a,i,r,n,d),function(e,t,a,n,r,i,o,s,l,c){var u,d=l.valueDim,h=l.categoryDim,p=Math.abs(a[h.wh]),f=e.getItemVisual(t,"symbolSize");u=TGe(f)?f.slice():null==f?["100%","100%"]:[f,f];u[h.index]=RXe(u[h.index],p),u[d.index]=RXe(u[d.index],n?p:Math.abs(i)),c.symbolSize=u;var m=c.symbolScale=[u[0]/s,u[1]/s];m[d.index]*=(l.isHorizontal?-1:1)*o}(e,t,r,i,0,d.boundingLength,d.pxSign,c,n,d),function(e,t,a,n,r){var i=e.get(emt)||0;i&&(amt.attr({scaleX:t[0],scaleY:t[1],rotation:a}),amt.updateTransform(),i/=amt.getLineScale(),i*=t[n.valueDim.index]);r.valueLineWidth=i||0}(a,d.symbolScale,l,n,d);var h=d.symbolSize,p=x8e(a.get("symbolOffset"),h);return function(e,t,a,n,r,i,o,s,l,c,u,d){var h=u.categoryDim,p=u.valueDim,f=d.pxSign,m=Math.max(t[p.index]+s,0),v=m;if(n){var g=Math.abs(l),y=OGe(e.get("symbolMargin"),"15%")+"",b=!1;y.lastIndexOf("!")===y.length-1&&(b=!0,y=y.slice(0,y.length-1));var x=RXe(y,t[p.index]),w=Math.max(m+2*x,0),_=b?0:2*x,S=XXe(n),M=S?n:xmt((g+_)/w);w=m+2*(x=(g-M*m)/2/(b?M:Math.max(M-1,1))),_=b?0:2*x,S||"fixed"===n||(M=c?xmt((Math.abs(c)+_)/w):0),v=M*w-_,d.repeatTimes=M,d.symbolMargin=x}var T=f*(v/2),k=d.pathPosition=[];k[h.index]=a[h.wh]/2,k[p.index]="start"===o?T:"end"===o?l-T:l/2,i&&(k[0]+=i[0],k[1]+=i[1]);var C=d.bundlePosition=[];C[h.index]=a[h.xy],C[p.index]=a[p.xy];var A=d.barRectShape=hGe({},a);A[p.wh]=f*Math.max(Math.abs(a[p.wh]),Math.abs(k[p.index]+T)),A[h.wh]=a[h.wh];var E=d.clipShape={};E[h.xy]=-a[h.xy],E[h.wh]=u.ecSize[h.wh],E[p.xy]=0,E[p.wh]=a[p.wh]}(a,h,r,i,0,p,s,d.valueLineWidth,d.boundingLength,d.repeatCutLength,n,d),d}function imt(e,t){return e.toGlobalCoord(e.dataToCoord(e.scale.parse(t)))}function omt(e){var t=e.symbolPatternSize,a=y8e(e.symbolType,-t/2,-t/2,t,t);return a.attr({culling:!0}),"image"!==a.type&&a.setStyle({strokeNoScale:!0}),a}function smt(e,t,a,n){var r=e.__pictorialBundle,i=a.symbolSize,o=a.valueLineWidth,s=a.pathPosition,l=t.valueDim,c=a.repeatTimes||0,u=0,d=i[t.valueDim.index]+o+2*a.symbolMargin;for(gmt(e,function(e){e.__pictorialAnimationIndex=u,e.__pictorialRepeatTimes=c,u<c?ymt(e,null,f(u),a,n):ymt(e,null,{scaleX:0,scaleY:0},a,n,function(){r.remove(e)}),u++});u<c;u++){var h=omt(a);h.__pictorialAnimationIndex=u,h.__pictorialRepeatTimes=c,r.add(h);var p=f(u);ymt(h,{x:p.x,y:p.y,scaleX:0,scaleY:0},{scaleX:p.scaleX,scaleY:p.scaleY,rotation:p.rotation},a,n)}function f(e){var t=s.slice(),n=a.pxSign,r=e;return("start"===a.symbolRepeatDirection?n>0:n<0)&&(r=c-1-e),t[l.index]=d*(r-c/2+.5)+s[l.index],{x:t[0],y:t[1],scaleX:a.symbolScale[0],scaleY:a.symbolScale[1],rotation:a.rotation}}}function lmt(e,t,a,n){var r=e.__pictorialBundle,i=e.__pictorialMainPath;i?ymt(i,null,{x:a.pathPosition[0],y:a.pathPosition[1],scaleX:a.symbolScale[0],scaleY:a.symbolScale[1],rotation:a.rotation},a,n):(i=e.__pictorialMainPath=omt(a),r.add(i),ymt(i,{x:a.pathPosition[0],y:a.pathPosition[1],scaleX:0,scaleY:0,rotation:a.rotation},{scaleX:a.symbolScale[0],scaleY:a.symbolScale[1]},a,n))}function cmt(e,t,a){var n=hGe({},t.barRectShape),r=e.__pictorialBarRect;r?ymt(r,null,{shape:n},t,a):((r=e.__pictorialBarRect=new EZe({z2:2,shape:n,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}})).disableMorphing=!0,e.add(r))}function umt(e,t,a,n){if(a.symbolClip){var r=e.__pictorialClipPath,i=hGe({},a.clipShape),o=t.valueDim,s=a.animationModel,l=a.dataIndex;if(r)u0e(r,{shape:i},s,l);else{i[o.wh]=0,r=new EZe({shape:i}),e.__pictorialBundle.setClipPath(r),e.__pictorialClipPath=r;var c={};c[o.wh]=a.clipShape[o.wh],e1e[n?"updateProps":"initProps"](r,{shape:c},s,l)}}}function dmt(e,t){var a=e.getItemModel(t);return a.getAnimationDelayParams=hmt,a.isAnimationEnabled=pmt,a}function hmt(e){return{index:e.__pictorialAnimationIndex,count:e.__pictorialRepeatTimes}}function pmt(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function fmt(e,t,a,n){var r=new xXe,i=new xXe;return r.add(i),r.__pictorialBundle=i,i.x=a.bundlePosition[0],i.y=a.bundlePosition[1],a.symbolRepeat?smt(r,t,a):lmt(r,0,a),cmt(r,a,n),umt(r,t,a,n),r.__pictorialShapeStr=vmt(e,a),r.__pictorialSymbolMeta=a,r}function mmt(e,t,a,n){var r=n.__pictorialBarRect;r&&r.removeTextContent();var i=[];gmt(n,function(e){i.push(e)}),n.__pictorialMainPath&&i.push(n.__pictorialMainPath),n.__pictorialClipPath&&(a=null),gGe(i,function(e){p0e(e,{scaleX:0,scaleY:0},a,t,function(){n.parent&&n.parent.remove(n)})}),e.setItemGraphicEl(t,null)}function vmt(e,t){return[e.getItemVisual(t.dataIndex,"symbol")||"none",!!t.symbolRepeat,!!t.symbolClip].join(":")}function gmt(e,t,a){gGe(e.__pictorialBundle.children(),function(n){n!==e.__pictorialBarRect&&t.call(a,n)})}function ymt(e,t,a,n,r,i){t&&e.attr(t),n.symbolClip&&!r?a&&e.attr(a):a&&e1e[r?"updateProps":"initProps"](e,a,n.animationModel,n.dataIndex,i)}function bmt(e,t,a){var n=a.dataIndex,r=a.itemModel,i=r.getModel("emphasis"),o=i.getModel("itemStyle").getItemStyle(),s=r.getModel(["blur","itemStyle"]).getItemStyle(),l=r.getModel(["select","itemStyle"]).getItemStyle(),c=r.getShallow("cursor"),u=i.get("focus"),d=i.get("blurScope"),h=i.get("scale");gmt(e,function(e){if(e instanceof _Ze){var t=e.style;e.useStyle(hGe({image:t.image,x:t.x,y:t.y,width:t.width,height:t.height},a.style))}else e.useStyle(a.style);var n=e.ensureState("emphasis");n.style=o,h&&(n.scaleX=1.1*e.scaleX,n.scaleY=1.1*e.scaleY),e.ensureState("blur").style=s,e.ensureState("select").style=l,c&&(e.cursor=c),e.z2=a.z2});var p=t.valueDim.posDesc[+(a.boundingLength>0)],f=e.__pictorialBarRect;f.ignoreClip=!0,r1e(f,i1e(r),{labelFetcher:t.seriesModel,labelDataIndex:n,defaultText:Ynt(t.seriesModel.getData(),n),inheritColor:a.style.fill,defaultOpacity:a.style.opacity,defaultOutsidePosition:p}),OJe(e,u,d,i.get("disabled"))}function xmt(e){var t=Math.round(e);return Math.abs(e-t)<1e-4?t:Math.ceil(e)}var wmt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.hasSymbolVisual=!0,a.defaultSymbol="roundRect",a}return zHe(t,e),t.prototype.getInitialData=function(t){return t.stack=null,e.prototype.getInitialData.apply(this,arguments)},t.type="series.pictorialBar",t.dependencies=["grid"],t.defaultOption=D1e(Rrt.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",clip:!1,progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:o5e.color.primary}}}),t}(Rrt);var _mt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._layers=[],a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=e.getData(),r=this,i=this.group,o=e.getLayerSeries(),s=n.getLayout("layoutInfo"),l=s.rect,c=s.boundaryGap;function u(e){return e.name}i.x=0,i.y=l.y+c[0];var d=new o9e(this._layersSeries||[],o,u,u),h=[];function p(t,a,s){var l=r._layers;if("remove"!==t){for(var c,u,d=[],p=[],f=o[a].indices,m=0;m<f.length;m++){var v=n.getItemLayout(f[m]),g=v.x,y=v.y0,b=v.y;d.push(g,y),p.push(g,y+b),c=n.getItemVisual(f[m],"style")}var x=n.getItemLayout(f[0]),w=e.getModel("label").get("margin"),_=e.getModel("emphasis");if("add"===t){var S=h[a]=new xXe;u=new crt({shape:{points:d,stackedOnPoints:p,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),S.add(u),i.add(S),e.isAnimationEnabled()&&u.setClipPath(function(e,t,a){var n=new EZe({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return d0e(n,{shape:{x:e.x-50,width:e.width+100,height:e.height+20}},t,a),n}(u.getBoundingRect(),e,function(){u.removeClipPath()}))}else{S=l[s];u=S.childAt(0),i.add(S),h[a]=S,u0e(u,{shape:{points:d,stackedOnPoints:p}},e),v0e(u)}r1e(u,i1e(e),{labelDataIndex:f[m-1],defaultText:n.getName(f[m-1]),inheritColor:c.fill},{normal:{verticalAlign:"middle"}}),u.setTextConfig({position:null,local:!0});var M=u.getTextContent();M&&(M.x=x.x-w,M.y=x.y0+x.y/2),u.useStyle(c),n.setItemGraphicEl(a,u),zJe(u,e),OJe(u,_.get("focus"),_.get("blurScope"),_.get("disabled"))}else i.remove(l[a])}d.add(SGe(p,this,"add")).update(SGe(p,this,"update")).remove(SGe(p,this,"remove")).execute(),this._layersSeries=o,this._layers=h},t.type="themeRiver",t}(s6e);var Smt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(t){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new xit(SGe(this.getData,this),SGe(this.getRawData,this))},t.prototype.fixData=function(e){var t=e.length,a={},n=M$e(e,function(e){return a.hasOwnProperty(e[0]+"")||(a[e[0]+""]=-1),e[2]}),r=[];n.buckets.each(function(e,t){r.push({name:t,dataList:e})});for(var i=r.length,o=0;o<i;++o){for(var s=r[o].name,l=0;l<r[o].dataList.length;++l){var c=r[o].dataList[l][0]+"";a[c]=o}for(var c in a)a.hasOwnProperty(c)&&a[c]!==o&&(a[c]=o,e[t]=[c,0,s],t++)}return e},t.prototype.getInitialData=function(e,t){for(var a=this.getReferringComponents("singleAxis",x$e).models[0].get("type"),n=xGe(e.data,function(e){return void 0!==e[2]}),r=this.fixData(n||[]),i=[],o=this.nameMap=$Ge(),s=0,l=0;l<r.length;++l)i.push(r[l][2]),o.get(r[l][2])||(o.set(r[l][2],s),s++);var c=R9e(r,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:c9e(a)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,u=new I9e(c,this);return u.initData(r),u},t.prototype.getLayerSeries=function(){for(var e=this.getData(),t=e.count(),a=[],n=0;n<t;++n)a[n]=n;var r=e.mapDimension("single"),i=M$e(a,function(t){return e.get("name",t)}),o=[];return i.buckets.each(function(t,a){t.sort(function(t,a){return e.get(r,t)-e.get(r,a)}),o.push({name:a,indices:t})}),o},t.prototype.getAxisTooltipData=function(e,t,a){TGe(e)||(e=e?[e]:[]);for(var n,r=this.getData(),i=this.getLayerSeries(),o=[],s=i.length,l=0;l<s;++l){for(var c=Number.MAX_VALUE,u=-1,d=i[l].indices.length,h=0;h<d;++h){var p=r.get(e[0],i[l].indices[h]),f=Math.abs(p-t);f<=c&&(n=p,c=f,u=i[l].indices[h])}o.push(u)}return{dataIndices:o,nestestValue:n}},t.prototype.formatTooltip=function(e,t,a){var n=this.getData();return P3e("nameValue",{name:n.getName(e),value:n.get(n.mapDimension("value"),e)})},t.type="series.themeRiver",t.dependencies=["singleAxis"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},t}($3e);function Mmt(e,t){e.eachSeriesByType("themeRiver",function(e){var t=e.getData(),a=e.coordinateSystem,n={},r=a.getRect();n.rect=r;var i=e.get("boundaryGap"),o=a.getAxis();(n.boundaryGap=i,"horizontal"===o.orient)?(i[0]=RXe(i[0],r.height),i[1]=RXe(i[1],r.height),Tmt(t,e,r.height-i[0]-i[1])):(i[0]=RXe(i[0],r.width),i[1]=RXe(i[1],r.width),Tmt(t,e,r.width-i[0]-i[1]));t.setLayout("layoutInfo",n)})}function Tmt(e,t,a){if(e.count())for(var n,r=t.coordinateSystem,i=t.getLayerSeries(),o=e.mapDimension("single"),s=e.mapDimension("value"),l=yGe(i,function(t){return yGe(t.indices,function(t){var a=r.dataToPoint(e.get(o,t));return a[1]=e.get(s,t),a})}),c=function(e){for(var t=e.length,a=e[0].length,n=[],r=[],i=0,o=0;o<a;++o){for(var s=0,l=0;l<t;++l)s+=e[l][o][1];s>i&&(i=s),n.push(s)}for(var c=0;c<a;++c)r[c]=(i-n[c])/2;i=0;for(var u=0;u<a;++u){var d=n[u]+r[u];d>i&&(i=d)}return{y0:r,max:i}}(l),u=c.y0,d=a/c.max,h=i.length,p=i[0].indices.length,f=0;f<p;++f){n=u[f]*d,e.setItemLayout(i[0].indices[f],{layerIndex:0,x:l[0][f][0],y0:n,y:l[0][f][1]*d});for(var m=1;m<h;++m)n+=l[m-1][f][1]*d,e.setItemLayout(i[m].indices[f],{layerIndex:m,x:l[m][f][0],y0:n,y:l[m][f][1]*d})}}var kmt=function(e){function t(t,a,n,r){var i=e.call(this)||this;i.z2=2,i.textConfig={inside:!0},YZe(i).seriesIndex=a.seriesIndex;var o=new PZe({z2:4,silent:t.getModel().get(["label","silent"])});return i.setTextContent(o),i.updateData(!0,t,a,n,r),i}return zHe(t,e),t.prototype.updateData=function(e,t,a,n,r){this.node=t,t.piece=this,a=a||this._seriesModel,n=n||this._ecModel;var i=this;YZe(i).dataIndex=t.dataIndex;var o=t.getModel(),s=o.getModel("emphasis"),l=t.getLayout(),c=hGe({},l);c.label=null;var u=t.getVisual("style");u.lineJoin="bevel";var d=t.getVisual("decal");d&&(u.decal=q8e(d,r));var h=Frt(o.getModel("itemStyle"),c,!0);hGe(c,h),gGe(JZe,function(e){var t=i.ensureState(e),a=o.getModel([e,"itemStyle"]);t.style=a.getItemStyle();var n=Frt(a,c);n&&(t.shape=n)}),e?(i.setShape(c),i.shape.r=l.r0,d0e(i,{shape:{r:l.r}},a,t.dataIndex)):(u0e(i,{shape:c},a),v0e(i)),i.useStyle(u),this._updateLabel(a);var p=o.getShallow("cursor");p&&i.attr("cursor",p),this._seriesModel=a||this._seriesModel,this._ecModel=n||this._ecModel;var f=s.get("focus");OJe(this,"relative"===f?KGe(t.getAncestorsIndices(),t.getDescendantIndices()):"ancestor"===f?t.getAncestorsIndices():"descendant"===f?t.getDescendantIndices():f,s.get("blurScope"),s.get("disabled"))},t.prototype._updateLabel=function(e){var t=this,a=this.node.getModel(),n=a.getModel("label"),r=this.node.getLayout(),i=r.endAngle-r.startAngle,o=(r.startAngle+r.endAngle)/2,s=Math.cos(o),l=Math.sin(o),c=this,u=c.getTextContent(),d=this.node.dataIndex,h=n.get("minAngle")/180*Math.PI,p=n.get("show")&&!(null!=h&&Math.abs(i)<h);function f(e,t){var a=e.get(t);return null==a?n.get(t):a}u.ignore=!p,gGe(QZe,function(n){var h="normal"===n?a.getModel("label"):a.getModel([n,"label"]),p="normal"===n,m=p?u:u.ensureState(n),v=e.getFormattedLabel(d,n);p&&(v=v||t.node.name),m.style=o1e(h,{},null,"normal"!==n,!0),v&&(m.style.text=v);var g=h.get("show");null==g||p||(m.ignore=!g);var y,b=f(h,"position"),x=p?c:c.states[n],w=x.style.fill;x.textConfig={outsideFill:"inherit"===h.get("color")?w:null,inside:"outside"!==b};var _=f(h,"distance")||0,S=f(h,"align"),M=f(h,"rotate"),T=.5*Math.PI,k=1.5*Math.PI,C=tZe("tangential"===M?Math.PI/2-o:o),A=C>T&&!zXe(C-T)&&C<k;"outside"===b?(y=r.r+_,S=A?"right":"left"):S&&"center"!==S?"left"===S?(y=r.r0+_,S=A?"right":"left"):"right"===S&&(y=r.r-_,S=A?"left":"right"):(y=i===2*Math.PI&&0===r.r0?0:(r.r+r.r0)/2,S="center"),m.style.align=S,m.style.verticalAlign=f(h,"verticalAlign")||"middle",m.x=y*s+r.cx,m.y=y*l+r.cy;var E=0;"radial"===M?E=tZe(-o)+(A?Math.PI:0):"tangential"===M?E=tZe(Math.PI/2-o)+(A?Math.PI:0):EGe(M)&&(E=M*Math.PI/180),m.rotation=tZe(E)}),u.dirtyStyle()},t}(EQe),Cmt="sunburstRootToNode",Amt="sunburstHighlight";var Emt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a,n){var r=this;this.seriesModel=e,this.api=a,this.ecModel=t;var i=e.getData(),o=i.tree.root,s=e.getViewRoot(),l=this.group,c=e.get("renderLabelForZeroData"),u=[];s.eachNode(function(e){u.push(e)});var d=this._oldChildren||[];!function(n,r){if(0===n.length&&0===r.length)return;function s(e){return e.getId()}function u(s,u){!function(n,r){c||!n||n.getValue()||(n=null);if(n!==o&&r!==o)if(r&&r.piece)n?(r.piece.updateData(!1,n,e,t,a),i.setItemGraphicEl(n.dataIndex,r.piece)):function(e){if(!e)return;e.piece&&(l.remove(e.piece),e.piece=null)}(r);else if(n){var s=new kmt(n,e,t,a);l.add(s),i.setItemGraphicEl(n.dataIndex,s)}}(null==s?null:n[s],null==u?null:r[u])}new o9e(r,n,s,s).add(u).update(u).remove(MGe(u,null)).execute()}(u,d),function(n,i){i.depth>0?(r.virtualPiece?r.virtualPiece.updateData(!1,n,e,t,a):(r.virtualPiece=new kmt(n,e,t,a),l.add(r.virtualPiece)),i.piece.off("click"),r.virtualPiece.on("click",function(e){r._rootToNode(i.parentNode)})):r.virtualPiece&&(l.remove(r.virtualPiece),r.virtualPiece=null)}(o,s),this._initEvents(),this._oldChildren=u},t.prototype._initEvents=function(){var e=this;this.group.off("click"),this.group.on("click",function(t){var a=!1;e.seriesModel.getViewRoot().eachNode(function(n){if(!a&&n.piece&&n.piece===t.target){var r=n.getModel().get("nodeClick");if("rootToNode"===r)e._rootToNode(n);else if("link"===r){var i=n.getModel(),o=i.get("link");if(o)E2e(o,i.get("target",!0)||"_blank")}a=!0}})})},t.prototype._rootToNode=function(e){e!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:Cmt,from:this.uid,seriesId:this.seriesModel.id,targetNode:e})},t.prototype.containPoint=function(e,t){var a=t.getData().getItemLayout(0);if(a){var n=e[0]-a.cx,r=e[1]-a.cy,i=Math.sqrt(n*n+r*r);return i<=a.r&&i>=a.r0}},t.type="sunburst",t}(s6e),Imt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.ignoreStyleOnData=!0,a}return zHe(t,e),t.prototype.getInitialData=function(e,t){var a={name:e.name,children:e.data};Rmt(a);var n=this._levelModels=yGe(e.levels||[],function(e){return new E1e(e,this,t)},this),r=Rct.createTree(a,this,function(e){e.wrapMethod("getItemModel",function(e,t){var a=r.getNodeByDataIndex(t),i=n[a.depth];return i&&(e.parentModel=i),e})});return r.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(t){var a=e.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(t);return a.treePathInfo=Nct(n,this),a},t.prototype.getLevelModel=function(e){return this._levelModels&&this._levelModels[e.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var t=this.getRawData().tree.root;e&&(e===t||t.contains(e))||(this._viewRoot=t)},t.prototype.enableAriaDecal=function(){Vct(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}($3e);function Rmt(e){var t=0;gGe(e.children,function(e){Rmt(e);var a=e.value;TGe(a)&&(a=a[0]),t+=a});var a=e.value;TGe(a)&&(a=a[0]),(null==a||isNaN(a))&&(a=t),a<0&&(a=0),TGe(e.value)?e.value[0]=a:e.value=a}var Dmt=Math.PI/180;function Pmt(e,t,a){t.eachSeriesByType(e,function(e){var t=e.get("center"),n=e.get("radius");TGe(n)||(n=[0,n]),TGe(t)||(t=[t,t]);var r=a.getWidth(),i=a.getHeight(),o=Math.min(r,i),s=RXe(t[0],r),l=RXe(t[1],i),c=RXe(n[0],o/2),u=RXe(n[1],o/2),d=-e.get("startAngle")*Dmt,h=e.get("minAngle")*Dmt,p=e.getData().tree.root,f=e.getViewRoot(),m=f.depth,v=e.get("sort");null!=v&&Lmt(f,v);var g=0;gGe(f.children,function(e){!isNaN(e.getValue())&&g++});var y=f.getValue(),b=Math.PI/(y||g)*2,x=f.depth>0,w=f.height-(x?-1:1),_=(u-c)/(w||1),S=e.get("clockwise"),M=e.get("stillShowZeroSum"),T=S?1:-1,k=function(t,a){if(t){var n=a;if(t!==p){var r=t.getValue(),i=0===y&&M?b:r*b;i<h&&(i=h),n=a+T*i;var u=t.depth-m-(x?-1:1),d=c+_*u,f=c+_*(u+1),v=e.getLevelModel(t);if(v){var g=v.get("r0",!0),w=v.get("r",!0),C=v.get("radius",!0);null!=C&&(g=C[0],w=C[1]),null!=g&&(d=RXe(g,o/2)),null!=w&&(f=RXe(w,o/2))}t.setLayout({angle:i,startAngle:a,endAngle:n,clockwise:S,cx:s,cy:l,r0:d,r:f})}if(t.children&&t.children.length){var A=0;gGe(t.children,function(e){A+=k(e,a+A)})}return n-a}};if(x){var C=c,A=c+_,E=2*Math.PI;p.setLayout({angle:E,startAngle:d,endAngle:d+E,clockwise:S,cx:s,cy:l,r0:C,r:A})}k(f,d)})}function Lmt(e,t){var a=e.children||[];e.children=function(e,t){if(kGe(t)){var a=yGe(e,function(e,t){var a=e.getValue();return{params:{depth:e.depth,height:e.height,dataIndex:e.dataIndex,getValue:function(){return a}},index:t}});return a.sort(function(e,a){return t(e.params,a.params)}),yGe(a,function(t){return e[t.index]})}var n="asc"===t;return e.sort(function(e,t){var a=(e.getValue()-t.getValue())*(n?1:-1);return 0===a?(e.dataIndex-t.dataIndex)*(n?-1:1):a})}(a,t),a.length&&gGe(e.children,function(e){Lmt(e,t)})}function Nmt(e){var t={};e.eachSeriesByType("sunburst",function(e){var a=e.getData(),n=a.tree;n.eachNode(function(r){var i=r.getModel().getModel("itemStyle").getItemStyle();i.fill||(i.fill=function(e,a,n){if(0===e.depth)return o5e.color.neutral50;for(var r=e;r&&r.depth>1;)r=r.parentNode;var i=a.getColorFromPalette(r.name||r.dataIndex+"",t);return e.depth>1&&CGe(i)&&(i=RYe(i,(e.depth-1)/(n-1)*.5)),i}(r,e,n.root.height)),hGe(a.ensureUniqueItemVisual(r.dataIndex,"style"),i)})})}var Omt={color:"fill",borderColor:"stroke"},Fmt={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},Bmt=v$e(),Umt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},t.prototype.getInitialData=function(e,t){return U9e(null,this)},t.prototype.getDataParams=function(t,a,n){var r=e.prototype.getDataParams.call(this,t,a);return n&&(r.info=Bmt(n).info),r},t.type="series.custom",t.dependencies=["grid","polar","geo","singleAxis","calendar","matrix"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,clip:!1},t}($3e);function zmt(e,t){return t=t||[0,0],yGe(["x","y"],function(a,n){var r=this.getAxis(a),i=t[n],o=e[n]/2;return"category"===r.type?r.getBandWidth():Math.abs(r.dataToCoord(i-o)-r.dataToCoord(i+o))},this)}function Vmt(e,t){return t=t||[0,0],yGe([0,1],function(a){var n=t[a],r=e[a]/2,i=[],o=[];return i[a]=n-r,o[a]=n+r,i[1-a]=o[1-a]=t[1-a],Math.abs(this.dataToPoint(i)[a]-this.dataToPoint(o)[a])},this)}function Hmt(e,t){var a=this.getAxis(),n=t instanceof Array?t[0]:t,r=(e instanceof Array?e[0]:e)/2;return"category"===a.type?a.getBandWidth():Math.abs(a.dataToCoord(n-r)-a.dataToCoord(n+r))}function Gmt(e,t){return t=t||[0,0],yGe(["Radius","Angle"],function(a,n){var r=this["get"+a+"Axis"](),i=t[n],o=e[n]/2,s="category"===r.type?r.getBandWidth():Math.abs(r.dataToCoord(i-o)-r.dataToCoord(i+o));return"Angle"===a&&(s=s*Math.PI/180),s},this)}function Wmt(e,t,a,n){return e&&(e.legacy||!1!==e.legacy&&!a&&!n&&"tspan"!==t&&("text"===t||QGe(e,"text")))}function qmt(e,t,a){var n,r,i,o=e;if("text"===t)i=o;else{i={},QGe(o,"text")&&(i.text=o.text),QGe(o,"rich")&&(i.rich=o.rich),QGe(o,"textFill")&&(i.fill=o.textFill),QGe(o,"textStroke")&&(i.stroke=o.textStroke),QGe(o,"fontFamily")&&(i.fontFamily=o.fontFamily),QGe(o,"fontSize")&&(i.fontSize=o.fontSize),QGe(o,"fontStyle")&&(i.fontStyle=o.fontStyle),QGe(o,"fontWeight")&&(i.fontWeight=o.fontWeight),r={type:"text",style:i,silent:!0},n={};var s=QGe(o,"textPosition");a?n.position=s?o.textPosition:"inside":s&&(n.position=o.textPosition),QGe(o,"textPosition")&&(n.position=o.textPosition),QGe(o,"textOffset")&&(n.offset=o.textOffset),QGe(o,"textRotation")&&(n.rotation=o.textRotation),QGe(o,"textDistance")&&(n.distance=o.textDistance)}return Ymt(i,e),gGe(i.rich,function(e){Ymt(e,e)}),{textConfig:n,textContent:r}}function Ymt(e,t){t&&(t.font=t.textFont||t.font,QGe(t,"textStrokeWidth")&&(e.lineWidth=t.textStrokeWidth),QGe(t,"textAlign")&&(e.align=t.textAlign),QGe(t,"textVerticalAlign")&&(e.verticalAlign=t.textVerticalAlign),QGe(t,"textLineHeight")&&(e.lineHeight=t.textLineHeight),QGe(t,"textWidth")&&(e.width=t.textWidth),QGe(t,"textHeight")&&(e.height=t.textHeight),QGe(t,"textBackgroundColor")&&(e.backgroundColor=t.textBackgroundColor),QGe(t,"textPadding")&&(e.padding=t.textPadding),QGe(t,"textBorderColor")&&(e.borderColor=t.textBorderColor),QGe(t,"textBorderWidth")&&(e.borderWidth=t.textBorderWidth),QGe(t,"textBorderRadius")&&(e.borderRadius=t.textBorderRadius),QGe(t,"textBoxShadowColor")&&(e.shadowColor=t.textBoxShadowColor),QGe(t,"textBoxShadowBlur")&&(e.shadowBlur=t.textBoxShadowBlur),QGe(t,"textBoxShadowOffsetX")&&(e.shadowOffsetX=t.textBoxShadowOffsetX),QGe(t,"textBoxShadowOffsetY")&&(e.shadowOffsetY=t.textBoxShadowOffsetY))}function jmt(e,t,a){var n=e;n.textPosition=n.textPosition||a.position||"inside",null!=a.offset&&(n.textOffset=a.offset),null!=a.rotation&&(n.textRotation=a.rotation),null!=a.distance&&(n.textDistance=a.distance);var r=n.textPosition.indexOf("inside")>=0,i=e.fill||o5e.color.neutral99;Xmt(n,t);var o=null==n.textFill;return r?o&&(n.textFill=a.insideFill||o5e.color.neutral00,!n.textStroke&&a.insideStroke&&(n.textStroke=a.insideStroke),!n.textStroke&&(n.textStroke=i),null==n.textStrokeWidth&&(n.textStrokeWidth=2)):(o&&(n.textFill=e.fill||a.outsideFill||o5e.color.neutral00),!n.textStroke&&a.outsideStroke&&(n.textStroke=a.outsideStroke)),n.text=t.text,n.rich=t.rich,gGe(t.rich,function(e){Xmt(e,e)}),n}function Xmt(e,t){t&&(QGe(t,"fill")&&(e.textFill=t.fill),QGe(t,"stroke")&&(e.textStroke=t.fill),QGe(t,"lineWidth")&&(e.textStrokeWidth=t.lineWidth),QGe(t,"font")&&(e.font=t.font),QGe(t,"fontStyle")&&(e.fontStyle=t.fontStyle),QGe(t,"fontWeight")&&(e.fontWeight=t.fontWeight),QGe(t,"fontSize")&&(e.fontSize=t.fontSize),QGe(t,"fontFamily")&&(e.fontFamily=t.fontFamily),QGe(t,"align")&&(e.textAlign=t.align),QGe(t,"verticalAlign")&&(e.textVerticalAlign=t.verticalAlign),QGe(t,"lineHeight")&&(e.textLineHeight=t.lineHeight),QGe(t,"width")&&(e.textWidth=t.width),QGe(t,"height")&&(e.textHeight=t.height),QGe(t,"backgroundColor")&&(e.textBackgroundColor=t.backgroundColor),QGe(t,"padding")&&(e.textPadding=t.padding),QGe(t,"borderColor")&&(e.textBorderColor=t.borderColor),QGe(t,"borderWidth")&&(e.textBorderWidth=t.borderWidth),QGe(t,"borderRadius")&&(e.textBorderRadius=t.borderRadius),QGe(t,"shadowColor")&&(e.textBoxShadowColor=t.shadowColor),QGe(t,"shadowBlur")&&(e.textBoxShadowBlur=t.shadowBlur),QGe(t,"shadowOffsetX")&&(e.textBoxShadowOffsetX=t.shadowOffsetX),QGe(t,"shadowOffsetY")&&(e.textBoxShadowOffsetY=t.shadowOffsetY),QGe(t,"textShadowColor")&&(e.textShadowColor=t.textShadowColor),QGe(t,"textShadowBlur")&&(e.textShadowBlur=t.textShadowBlur),QGe(t,"textShadowOffsetX")&&(e.textShadowOffsetX=t.textShadowOffsetX),QGe(t,"textShadowOffsetY")&&(e.textShadowOffsetY=t.textShadowOffsetY))}var $mt={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},Kmt=_Ge($mt);bGe($je,function(e,t){return e[t]=1,e},{}),$je.join(", ");var Zmt=["","style","shape","extra"],Jmt=v$e();function Qmt(e,t,a,n,r){var i=e+"Animation",o=l0e(e,n,r)||{},s=Jmt(t).userDuring;return o.duration>0&&(o.during=s?SGe(ovt,{el:t,userDuring:s}):null,o.setToFinal=!0,o.scope=e),hGe(o,a[i]),o}function evt(e,t,a,n){var r=(n=n||{}).dataIndex,i=n.isInit,o=n.clearStyle,s=a.isAnimationEnabled(),l=Jmt(e),c=t.style;l.userDuring=t.during;var u={},d={};if(function(e,t,a){for(var n=0;n<Kmt.length;n++){var r=Kmt[n],i=$mt[r],o=t[r];o&&(a[i[0]]=o[0],a[i[1]]=o[1])}for(n=0;n<$je.length;n++){var s=$je[n];null!=t[s]&&(a[s]=t[s])}}(0,t,d),"compound"===e.type)for(var h=e.shape.paths,p=t.shape.paths,f=0;f<p.length;f++){lvt("shape",p[f],h[f])}else lvt("shape",t,d),lvt("extra",t,d);if(!i&&s&&(function(e,t,a){for(var n=t.transition,r=nvt(n)?$je:r$e(n||[]),i=0;i<r.length;i++){var o=r[i];if("style"!==o&&"shape"!==o&&"extra"!==o){var s=e[o];a[o]=s}}}(e,t,u),svt("shape",e,t,u),svt("extra",e,t,u),function(e,t,a,n){if(!a)return;var r,i=e.style;if(i){var o=a.transition,s=t.transition;if(o&&!nvt(o)){var l=r$e(o);!r&&(r=n.style={});for(var c=0;c<l.length;c++){var u=i[f=l[c]];r[f]=u}}else if(e.getAnimationStyleProps&&(nvt(s)||nvt(o)||fGe(s,"style")>=0)){var d=e.getAnimationStyleProps(),h=d?d.style:null;if(h){!r&&(r=n.style={});var p=_Ge(a);for(c=0;c<p.length;c++){var f;if(h[f=p[c]]){u=i[f];r[f]=u}}}}}}(e,t,c,u)),d.style=c,function(e,t,a){var n=t.style;if(!e.isGroup&&n){if(a){e.useStyle({});for(var r=e.animators,i=0;i<r.length;i++){var o=r[i];"style"===o.targetName&&o.changeTarget(e.style)}}e.setStyle(n)}t&&(t.style=null,t&&e.attr(t),t.style=n)}(e,d,o),function(e,t){QGe(t,"silent")&&(e.silent=t.silent),QGe(t,"ignore")&&(e.ignore=t.ignore),e instanceof fKe&&QGe(t,"invisible")&&(e.invisible=t.invisible);e instanceof gZe&&QGe(t,"autoBatch")&&(e.autoBatch=t.autoBatch)}(e,t),s)if(i){var m={};gGe(Zmt,function(e){var a=e?t[e]:t;a&&a.enterFrom&&(e&&(m[e]=m[e]||{}),hGe(e?m[e]:m,a.enterFrom))});var v=Qmt("enter",e,t,a,r);v.duration>0&&e.animateFrom(m,v)}else!function(e,t,a,n,r){if(r){var i=Qmt("update",e,t,n,a);i.duration>0&&e.animateFrom(r,i)}}(e,t,r||0,a,u);tvt(e,t),c?e.dirty():e.markRedraw()}function tvt(e,t){for(var a=Jmt(e).leaveToProps,n=0;n<Zmt.length;n++){var r=Zmt[n],i=r?t[r]:t;i&&i.leaveTo&&(a||(a=Jmt(e).leaveToProps={}),r&&(a[r]=a[r]||{}),hGe(r?a[r]:a,i.leaveTo))}}function avt(e,t,a,n){if(e){var r=e.parent,i=Jmt(e).leaveToProps;if(i){var o=Qmt("update",e,t,a,0);o.done=function(){r&&r.remove(e)},e.animateTo(i,o)}else r&&r.remove(e)}}function nvt(e){return"all"===e}var rvt={},ivt={setTransform:function(e,t){return rvt.el[e]=t,this},getTransform:function(e){return rvt.el[e]},setShape:function(e,t){var a=rvt.el;return(a.shape||(a.shape={}))[e]=t,a.dirtyShape&&a.dirtyShape(),this},getShape:function(e){var t=rvt.el.shape;if(t)return t[e]},setStyle:function(e,t){var a=rvt.el,n=a.style;return n&&(n[e]=t,a.dirtyStyle&&a.dirtyStyle()),this},getStyle:function(e){var t=rvt.el.style;if(t)return t[e]},setExtra:function(e,t){return(rvt.el.extra||(rvt.el.extra={}))[e]=t,this},getExtra:function(e){var t=rvt.el.extra;if(t)return t[e]}};function ovt(){var e=this,t=e.el;if(t){var a=Jmt(t).userDuring,n=e.userDuring;a===n?(rvt.el=t,n(ivt)):e.el=e.userDuring=null}}function svt(e,t,a,n){var r=a[e];if(r){var i,o=t[e];if(o){var s=a.transition,l=r.transition;if(l)if(!i&&(i=n[e]={}),nvt(l))hGe(i,o);else for(var c=r$e(l),u=0;u<c.length;u++){var d=o[p=c[u]];i[p]=d}else if(nvt(s)||fGe(s,e)>=0){!i&&(i=n[e]={});var h=_Ge(o);for(u=0;u<h.length;u++){var p;d=o[p=h[u]];cvt(r[p],d)&&(i[p]=d)}}}}}function lvt(e,t,a){var n=t[e];if(n)for(var r=a[e]={},i=_Ge(n),o=0;o<i.length;o++){var s=i[o];r[s]=lje(n[s])}}function cvt(e,t){return vGe(e)?e!==t:null!=e&&isFinite(e)}var uvt=v$e(),dvt=["percent","easing","shape","style","extra"];function hvt(e){e.stopAnimation("keyframe"),e.attr(uvt(e))}function pvt(e,t,a){if(a.isAnimationEnabled()&&t)if(TGe(t))gGe(t,function(t){pvt(e,t,a)});else{var n=t.keyframes,r=t.duration;if(a&&null==r){var i=l0e("enter",a,0);r=i&&i.duration}if(n&&r){var o=uvt(e);gGe(Zmt,function(a){var i;a&&!e[a]||(n.sort(function(e,t){return e.percent-t.percent}),gGe(n,function(n){var s=e.animators,l=a?n[a]:n;if(l){var c=_Ge(l);if(a||(c=xGe(c,function(e){return fGe(dvt,e)<0})),c.length){i||((i=e.animate(a,t.loop,!0)).scope="keyframe");for(var u=0;u<s.length;u++)s[u]!==i&&s[u].targetName===i.targetName&&s[u].stopTracks(c);a&&(o[a]=o[a]||{});var d=a?o[a]:o;gGe(c,function(t){d[t]=((a?e[a]:e)||{})[t]}),i.whenWithKeys(r*n.percent,l,c,n.easing)}}}),i&&i.delay(t.delay||0).duration(r).start(t.easing))})}}}var fvt="emphasis",mvt="normal",vvt="blur",gvt="select",yvt=[mvt,fvt,vvt,gvt],bvt={normal:["itemStyle"],emphasis:[fvt,"itemStyle"],blur:[vvt,"itemStyle"],select:[gvt,"itemStyle"]},xvt={normal:["label"],emphasis:[fvt,"label"],blur:[vvt,"label"],select:[gvt,"label"]},wvt=["x","y"],_vt={normal:{},emphasis:{},blur:{},select:{}},Svt={cartesian2d:function(e){var t=e.master.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t){return e.dataToPoint(t)},size:SGe(zmt,e)}}},geo:function(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:e.getZoom()},api:{coord:function(t){return e.dataToPoint(t)},size:SGe(Vmt,e)}}},single:function(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t){return e.dataToPoint(t)},size:SGe(Hmt,e)}}},polar:function(e){var t=e.getRadiusAxis(),a=e.getAngleAxis(),n=t.getExtent();return n[0]>n[1]&&n.reverse(),{coordSys:{type:"polar",cx:e.cx,cy:e.cy,r:n[1],r0:n[0]},api:{coord:function(n){var r=t.dataToRadius(n[0]),i=a.dataToAngle(n[1]),o=e.coordToPoint([r,i]);return o.push(r,i*Math.PI/180),o},size:SGe(Gmt,e)}}},calendar:function(e){var t=e.getRect(),a=e.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),rangeInfo:{start:a.start,end:a.end,weeks:a.weeks,dayCount:a.allDay}},api:{coord:function(t,a){return e.dataToPoint(t,a)},layout:function(t,a){return e.dataToLayout(t,a)}}}},matrix:function(e){var t=e.getRect();return{coordSys:{type:"matrix",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(t,a){return e.dataToPoint(t,a)},layout:function(t,a){return e.dataToLayout(t,a)}}}}};function Mvt(e){return e instanceof gZe}function Tvt(e){return e instanceof fKe}var kvt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a,n){this._progressiveEls=null;var r=this._data,i=e.getData(),o=this.group,s=Rvt(e,i,t,a);r||o.removeAll(),i.diff(r).add(function(t){Pvt(a,null,t,s(t,n),e,o,i)}).remove(function(t){var a=r.getItemGraphicEl(t);a&&avt(a,Bmt(a).option,e)}).update(function(t,l){var c=r.getItemGraphicEl(l);Pvt(a,c,t,s(t,n),e,o,i)}).execute();var l=e.get("clip",!0)?hrt(e.coordinateSystem,!1,e):null;l?o.setClipPath(l):o.removeClipPath(),this._data=i},t.prototype.incrementalPrepareRender=function(e,t,a){this.group.removeAll(),this._data=null},t.prototype.incrementalRender=function(e,t,a,n,r){var i=t.getData(),o=Rvt(t,i,a,n),s=this._progressiveEls=[];function l(e){e.isGroup||(e.incremental=!0,e.ensureState("emphasis").hoverLayer=!0)}for(var c=e.start;c<e.end;c++){var u=Pvt(null,null,c,o(c,r),t,this.group,i);u&&(u.traverse(l),s.push(u))}},t.prototype.eachRendered=function(e){q0e(this._progressiveEls||this.group,e)},t.prototype.filterForExposedEvent=function(e,t,a,n){var r=t.element;if(null==r||a.name===r)return!0;for(;(a=a.__hostTarget||a.parent)&&a!==this.group;)if(a.name===r)return!0;return!1},t.type="custom",t}(s6e);function Cvt(e){var t,a=e.type;if("path"===a){var n=null!=(i=e.shape).width&&null!=i.height?{x:i.x||0,y:i.y||0,width:i.width,height:i.height}:null,r=Gvt(i);t=S0e(r,null,n,i.layout||"center"),Bmt(t).customPathData=r}else if("image"===a)t=new _Ze({}),Bmt(t).customImagePath=e.style.image;else if("text"===a)t=new PZe({});else if("group"===a)t=new xXe;else if("compoundPath"===a){var i;if(!(i=e.shape)||!i.paths)e$e("");var o=yGe(i.paths,function(e){if("path"===e.type)return S0e(e.shape.pathData,e,null);var t=_0e(e.type);if(!t){e$e("")}return new t});t=new YQe({shape:{paths:o}})}else{var s=_0e(a);if(!s)e$e("");t=new s}return Bmt(t).customGraphicType=a,t.name=e.name,t.z2EmphasisLift=1,t.z2SelectLift=1,t}function Avt(e,t,a,n,r,i,o){hvt(t);var s=r&&r.normal.cfg;s&&t.setTextConfig(s),n&&null==n.transition&&(n.transition=wvt);var l=n&&n.style;if(l){if("text"===t.type){var c=l;QGe(c,"textFill")&&(c.fill=c.textFill),QGe(c,"textStroke")&&(c.stroke=c.textStroke)}var u=void 0,d=Mvt(t)?l.decal:null;e&&d&&(d.dirty=!0,u=q8e(d,e)),l.__decalPattern=u}Tvt(t)&&(l&&(u=l.__decalPattern)&&(l.decal=u));evt(t,n,i,{dataIndex:a,isInit:o,clearStyle:!0}),pvt(t,n.keyframeAnimation,i)}function Evt(e,t,a,n,r){var i=t.isGroup?null:t,o=r&&r[e].cfg;if(i){var s=i.ensureState(e);if(!1===n){var l=i.getState(e);l&&(l.style=null)}else s.style=n||null;o&&(s.textConfig=o),bJe(i)}}function Ivt(e,t,a){var n=a===mvt,r=n?t:Fvt(t,a),i=r?r.z2:null;null!=i&&((n?e:e.ensureState(a)).z2=i||0)}function Rvt(e,t,a,n){var r=e.get("renderItem");if("string"==typeof r){var i=Z8e[r];i&&(r=i)}var o=e.coordinateSystem,s={};o&&(s=o.prepareCustoms?o.prepareCustoms(o):Svt[o.type](o));for(var l,c,u=pGe({getWidth:n.getWidth,getHeight:n.getHeight,getZr:n.getZr,getDevicePixelRatio:n.getDevicePixelRatio,value:function(e,a){return null==a&&(a=l),t.getStore().get(t.getDimensionIndex(e||0),a)},style:function(a,n){null==n&&(n=l);var r=t.getItemVisual(n,"style"),i=r&&r.fill,o=r&&r.opacity,s=b(n,mvt).getItemStyle();null!=i&&(s.fill=i),null!=o&&(s.opacity=o);var c={inheritColor:CGe(i)?i:o5e.color.neutral99},u=x(n,mvt),d=o1e(u,null,c,!1,!0);d.text=u.getShallow("show")?FGe(e.getFormattedLabel(n,mvt),Ynt(t,n)):null;var h=s1e(u,c,!1);return _(a,s),s=jmt(s,d,h),a&&w(s,a),s.legacy=!0,s},ordinalRawValue:function(e,a){null==a&&(a=l),e=e||0;var n=t.getDimensionInfo(e);if(!n){var r=t.getDimensionIndex(e);return r>=0?t.getStore().get(r,a):void 0}var i=t.get(n.name,a),o=n&&n.ordinalMeta;return o?o.categories[i]:i},styleEmphasis:function(a,n){null==n&&(n=l);var r=b(n,fvt).getItemStyle(),i=x(n,fvt),o=o1e(i,null,null,!0,!0);o.text=i.getShallow("show")?BGe(e.getFormattedLabel(n,fvt),e.getFormattedLabel(n,mvt),Ynt(t,n)):null;var s=s1e(i,null,!0);return _(a,r),r=jmt(r,o,s),a&&w(r,a),r.legacy=!0,r},visual:function(e,a){if(null==a&&(a=l),QGe(Omt,e)){var n=t.getItemVisual(a,"style");return n?n[Omt[e]]:null}if(QGe(Fmt,e))return t.getItemVisual(a,e)},barLayout:function(e){if("cartesian2d"===o.type){return function(e){var t=[],a=e.axis,n="axis0";if("category"===a.type){for(var r=a.getBandWidth(),i=0;i<e.count;i++)t.push(pGe({bandWidth:r,axisKey:n,stackId:oet+i},e));var o=het(t),s=[];for(i=0;i<e.count;i++){var l=o[n][oet+i];l.offsetCenter=l.offset+l.width/2,s.push(l)}return s}}(pGe({axis:o.getBaseAxis()},e))}},currentSeriesIndices:function(){return a.getCurrentSeriesIndices()},font:function(e){return h1e(e,a)}},s.api||{}),d={context:{},seriesId:e.id,seriesName:e.name,seriesIndex:e.seriesIndex,coordSys:s.coordSys,dataInsideLength:t.count(),encode:Dvt(e.getData()),itemPayload:e.get("itemPayload")||{}},h={},p={},f={},m={},v=0;v<yvt.length;v++){var g=yvt[v];f[g]=e.getModel(bvt[g]),m[g]=e.getModel(xvt[g])}function y(e){return e===l?c||(c=t.getItemModel(e)):t.getItemModel(e)}function b(e,a){return t.hasItemOption?e===l?h[a]||(h[a]=y(e).getModel(bvt[a])):y(e).getModel(bvt[a]):f[a]}function x(e,a){return t.hasItemOption?e===l?p[a]||(p[a]=y(e).getModel(xvt[a])):y(e).getModel(xvt[a]):m[a]}return function(e,a){return l=e,c=null,h={},p={},r&&r(pGe({dataIndexInside:e,dataIndex:t.getRawIndex(e),actionType:a?a.type:null},d),u)};function w(e,t){for(var a in t)QGe(t,a)&&(e[a]=t[a])}function _(e,t){e&&(e.textFill&&(t.textFill=e.textFill),e.textPosition&&(t.textPosition=e.textPosition))}}function Dvt(e){var t={};return gGe(e.dimensions,function(a){var n=e.getDimensionInfo(a);if(!n.isExtraCoord){var r=n.coordDim;(t[r]=t[r]||[])[n.coordDimIndex]=e.getDimensionIndex(a)}}),t}function Pvt(e,t,a,n,r,i,o){if(n){var s=Lvt(e,t,a,n,r,i);return s&&o.setItemGraphicEl(a,s),s&&OJe(s,n.focus,n.blurScope,n.emphasisDisabled),s}i.remove(t)}function Lvt(e,t,a,n,r,i){var o=-1,s=t;t&&Nvt(t,n,r)&&(o=fGe(i.childrenRef(),t),t=null);var l,c,u=!t,d=t;d?d.clearStates():(d=Cvt(n),s&&(l=s,(c=d).copyTransform(l),Tvt(c)&&Tvt(l)&&(c.setStyle(l.style),c.z=l.z,c.z2=l.z2,c.zlevel=l.zlevel,c.invisible=l.invisible,c.ignore=l.ignore,Mvt(c)&&Mvt(l)&&c.setShape(l.shape)))),!1===n.morph?d.disableMorphing=!0:d.disableMorphing&&(d.disableMorphing=!1),n.tooltipDisabled&&(d.tooltipDisabled=!0),_vt.normal.cfg=_vt.normal.conOpt=_vt.emphasis.cfg=_vt.emphasis.conOpt=_vt.blur.cfg=_vt.blur.conOpt=_vt.select.cfg=_vt.select.conOpt=null,_vt.isLegacy=!1,function(e,t,a,n,r,i){if(e.isGroup||"compoundPath"===e.type)return;Ovt(a,null,i),Ovt(a,fvt,i);var o=i.normal.conOpt,s=i.emphasis.conOpt,l=i.blur.conOpt,c=i.select.conOpt;if(null!=o||null!=s||null!=c||null!=l){var u=e.getTextContent();if(!1===o)u&&e.removeTextContent();else{o=i.normal.conOpt=o||{type:"text"},u?u.clearStates():(u=Cvt(o),e.setTextContent(u)),Avt(null,u,t,o,null,n,r);for(var d=o&&o.style,h=0;h<yvt.length;h++){var p=yvt[h];if(p!==mvt){var f=i[p].conOpt;Evt(p,u,0,Bvt(o,f,p),null)}}d?u.dirty():u.markRedraw()}}}(d,a,n,r,u,_vt),function(e,t,a,n,r){var i=a.clipPath;if(!1===i)e&&e.getClipPath()&&e.removeClipPath();else if(i){var o=e.getClipPath();o&&Nvt(o,i,n)&&(o=null),o||(o=Cvt(i),e.setClipPath(o)),Avt(null,o,t,i,null,n,r)}}(d,a,n,r,u),Avt(e,d,a,n,_vt,r,u),QGe(n,"info")&&(Bmt(d).info=n.info);for(var h=0;h<yvt.length;h++){var p=yvt[h];if(p!==mvt){var f=Fvt(n,p);Evt(p,d,0,Bvt(n,f,p),_vt)}}return function(e,t,a){if(!e.isGroup){var n=e,r=a.currentZ,i=a.currentZLevel;n.z=r,n.zlevel=i;var o=t.z2;null!=o&&(n.z2=o||0);for(var s=0;s<yvt.length;s++)Ivt(n,t,yvt[s])}}(d,n,r),"group"===n.type&&function(e,t,a,n,r){var i=n.children,o=i?i.length:0,s=n.$mergeChildren,l="byName"===s||n.diffChildrenByName,c=!1===s;if(!o&&!l&&!c)return;if(l)return u={api:e,oldChildren:t.children()||[],newChildren:i||[],dataIndex:a,seriesModel:r,group:t},void new o9e(u.oldChildren,u.newChildren,zvt,zvt,u).add(Vvt).update(Vvt).remove(Hvt).execute();var u;c&&t.removeAll();for(var d=0;d<o;d++){var h=i[d],p=t.childAt(d);h?(null==h.ignore&&(h.ignore=!1),Lvt(e,p,a,h,r,t)):p.ignore=!0}for(var f=t.childCount()-1;f>=d;f--){var m=t.childAt(f);Uvt(t,m,r)}}(e,d,a,n,r),o>=0?i.replaceAt(d,o):i.add(d),d}function Nvt(e,t,a){var n,r=Bmt(e),i=t.type,o=t.shape,s=t.style;return a.isUniversalTransitionEnabled()||null!=i&&i!==r.customGraphicType||"path"===i&&((n=o)&&(QGe(n,"pathData")||QGe(n,"d")))&&Gvt(o)!==r.customPathData||"image"===i&&QGe(s,"image")&&s.image!==r.customImagePath}function Ovt(e,t,a){var n=t?Fvt(e,t):e,r=t?Bvt(e,n,fvt):e.style,i=e.type,o=n?n.textConfig:null,s=e.textContent,l=s?t?Fvt(s,t):s:null;if(r&&(a.isLegacy||Wmt(r,i,!!o,!!l))){a.isLegacy=!0;var c=qmt(r,i,!t);!o&&c.textConfig&&(o=c.textConfig),!l&&c.textContent&&(l=c.textContent)}if(!t&&l){var u=l;!u.type&&(u.type="text")}var d=t?a[t]:a.normal;d.cfg=o,d.conOpt=l}function Fvt(e,t){return t?e?e[t]:null:e}function Bvt(e,t,a){var n=t&&t.style;return null==n&&a===fvt&&e&&(n=e.styleEmphasis),n}function Uvt(e,t,a){t&&avt(t,Bmt(e).option,a)}function zvt(e,t){var a=e&&e.name;return null!=a?a:"e\0\0"+t}function Vvt(e,t){var a=this.context,n=null!=e?a.newChildren[e]:null,r=null!=t?a.oldChildren[t]:null;Lvt(a.api,r,a.dataIndex,n,a.seriesModel,a.group)}function Hvt(e){var t=this.context,a=t.oldChildren[e];a&&avt(a,Bmt(a).option,t.seriesModel)}function Gvt(e){return e&&(e.pathData||e.d)}var Wvt=v$e(),qvt=cGe,Yvt=SGe,jvt=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(e,t,a,n){var r=t.get("value"),i=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=a,n||this._lastValue!==r||this._lastStatus!==i){this._lastValue=r,this._lastStatus=i;var o=this._group,s=this._handle;if(!i||"hide"===i)return o&&o.hide(),void(s&&s.hide());o&&o.show(),s&&s.show();var l={};this.makeElOption(l,r,e,t,a);var c=l.graphicKey;c!==this._lastGraphicKey&&this.clear(a),this._lastGraphicKey=c;var u=this._moveAnimation=this.determineAnimation(e,t);if(o){var d=MGe(Xvt,t,u);this.updatePointerEl(o,l,d),this.updateLabelEl(o,l,d,t)}else o=this._group=new xXe,this.createPointerEl(o,l,e,t),this.createLabelEl(o,l,e,t),a.getZr().add(o);Jvt(o,t,!0),this._renderHandle(r)}},e.prototype.remove=function(e){this.clear(e)},e.prototype.dispose=function(e){this.clear(e)},e.prototype.determineAnimation=function(e,t){var a=t.get("animation"),n=e.axis,r="category"===n.type,i=t.get("snap");if(!i&&!r)return!1;if("auto"===a||null==a){var o=this.animationThreshold;if(r&&n.getBandWidth()>o)return!0;if(i){var s=zot(e).seriesDataCount,l=n.getExtent();return Math.abs(l[0]-l[1])/s>o}return!1}return!0===a},e.prototype.makeElOption=function(e,t,a,n,r){},e.prototype.createPointerEl=function(e,t,a,n){var r=t.pointer;if(r){var i=Wvt(e).pointerEl=new e1e[r.type](qvt(t.pointer));e.add(i)}},e.prototype.createLabelEl=function(e,t,a,n){if(t.label){var r=Wvt(e).labelEl=new PZe(qvt(t.label));e.add(r),Kvt(r,n)}},e.prototype.updatePointerEl=function(e,t,a){var n=Wvt(e).pointerEl;n&&t.pointer&&(n.setStyle(t.pointer.style),a(n,{shape:t.pointer.shape}))},e.prototype.updateLabelEl=function(e,t,a,n){var r=Wvt(e).labelEl;r&&(r.setStyle(t.label.style),a(r,{x:t.label.x,y:t.label.y}),Kvt(r,n))},e.prototype._renderHandle=function(e){if(!this._dragging&&this.updateHandleTransform){var t,a=this._axisPointerModel,n=this._api.getZr(),r=this._handle,i=a.getModel("handle"),o=a.get("status");if(!i.get("show")||!o||"hide"===o)return r&&n.remove(r),void(this._handle=null);this._handle||(t=!0,r=this._handle=O0e(i.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(e){VWe(e.event)},onmousedown:Yvt(this._onHandleDragMove,this,0,0),drift:Yvt(this._onHandleDragMove,this),ondragend:Yvt(this._onHandleDragEnd,this)}),n.add(r)),Jvt(r,a,!1),r.setStyle(i.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=i.get("size");TGe(s)||(s=[s,s]),r.scaleX=s[0]/2,r.scaleY=s[1]/2,g6e(this,"_doDispatchAxisPointer",i.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,t)}},e.prototype._moveHandleToValue=function(e,t){Xvt(this._axisPointerModel,!t&&this._moveAnimation,this._handle,Zvt(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(e,t){var a=this._handle;if(a){this._dragging=!0;var n=this.updateHandleTransform(Zvt(a),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=n,a.stopAnimation(),a.attr(Zvt(n)),Wvt(a).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){if(this._handle){var e=this._payloadInfo,t=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:e.cursorPoint[0],y:e.cursorPoint[1],tooltipOption:e.tooltipOption,axesInfo:[{axisDim:t.axis.dim,axisIndex:t.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){if(this._dragging=!1,this._handle){var e=this._axisPointerModel.get("value");this._moveHandleToValue(e),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),a=this._group,n=this._handle;t&&a&&(this._lastGraphicKey=null,a&&t.remove(a),n&&t.remove(n),this._group=null,this._handle=null,this._payloadInfo=null),y6e(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(e,t,a){return{x:e[a=a||0],y:e[1-a],width:t[a],height:t[1-a]}},e}();function Xvt(e,t,a,n){$vt(Wvt(a).lastProp,n)||(Wvt(a).lastProp=n,t?u0e(a,n,e):(a.stopAnimation(),a.attr(n)))}function $vt(e,t){if(IGe(e)&&IGe(t)){var a=!0;return gGe(t,function(t,n){a=a&&$vt(e[n],t)}),!!a}return e===t}function Kvt(e,t){e[t.get(["label","show"])?"show":"hide"]()}function Zvt(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function Jvt(e,t,a){var n=t.get("z"),r=t.get("zlevel");e&&e.traverse(function(e){"group"!==e.type&&(null!=n&&(e.z=n),null!=r&&(e.zlevel=r),e.silent=a)})}function Qvt(e){var t,a=e.get("type"),n=e.getModel(a+"Style");return"line"===a?(t=n.getLineStyle()).fill=null:"shadow"===a&&((t=n.getAreaStyle()).stroke=null),t}function egt(e,t,a,n,r){var i=tgt(a.get("value"),t.axis,t.ecModel,a.get("seriesDataIndices"),{precision:a.get(["label","precision"]),formatter:a.get(["label","formatter"])}),o=a.getModel("label"),s=S2e(o.get("padding")||0),l=o.getFont(),c=nXe(i,l),u=r.position,d=c.width+s[1]+s[3],h=c.height+s[0]+s[2],p=r.align;"right"===p&&(u[0]-=d),"center"===p&&(u[0]-=d/2);var f=r.verticalAlign;"bottom"===f&&(u[1]-=h),"middle"===f&&(u[1]-=h/2),function(e,t,a,n){var r=n.getWidth(),i=n.getHeight();e[0]=Math.min(e[0]+t,r)-t,e[1]=Math.min(e[1]+a,i)-a,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}(u,d,h,n);var m=o.get("backgroundColor");m&&"auto"!==m||(m=t.get(["axisLine","lineStyle","color"])),e.label={x:u[0],y:u[1],style:o1e(o,{text:i,font:l,fill:o.getTextColor(),padding:s,backgroundColor:m}),z2:10}}function tgt(e,t,a,n,r){e=t.scale.parse(e);var i=t.scale.getLabel({value:e},{precision:r.precision}),o=r.formatter;if(o){var s={value:Get(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};gGe(n,function(e){var t=a.getSeriesByIndex(e.seriesIndex),n=e.dataIndexInside,r=t&&t.getDataParams(n);r&&s.seriesData.push(r)}),CGe(o)?i=o.replace("{value}",i):kGe(o)&&(i=o(s))}return i}function agt(e,t,a){var n=[1,0,0,1,0,0];return ZWe(n,n,a.rotation),KWe(n,n,a.position),R0e([e.dataToCoord(t),(a.labelOffset||0)+(a.labelDirection||1)*(a.labelMargin||0)],n)}function ngt(e,t,a,n,r,i){var o=hot.innerTextLayout(a.rotation,0,a.labelDirection);a.labelMargin=r.get(["label","margin"]),egt(t,n,r,i,{position:agt(n.axis,e,a),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function rgt(e,t,a){return{x1:e[a=a||0],y1:e[1-a],x2:t[a],y2:t[1-a]}}function igt(e,t,a){return{x:e[a=a||0],y:e[1-a],width:t[a],height:t[1-a]}}function ogt(e,t,a,n,r,i){return{cx:e,cy:t,r0:a,r:n,startAngle:r,endAngle:i,clockwise:!0}}var sgt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.makeElOption=function(e,t,a,n,r){var i=a.axis,o=i.grid,s=n.get("type"),l=lgt(o,i).getOtherAxis(i).getGlobalExtent(),c=i.toGlobalCoord(i.dataToCoord(t,!0));if(s&&"none"!==s){var u=Qvt(n),d=cgt[s](i,c,l);d.style=u,e.graphicKey=d.type,e.pointer=d}ngt(t,e,Mot(o.getRect(),a),a,n,r)},t.prototype.getHandleTransform=function(e,t,a){var n=Mot(t.axis.grid.getRect(),t,{labelInside:!1});n.labelMargin=a.get(["handle","margin"]);var r=agt(t.axis,e,n);return{x:r[0],y:r[1],rotation:n.rotation+(n.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(e,t,a,n){var r=a.axis,i=r.grid,o=r.getGlobalExtent(!0),s=lgt(i,r).getOtherAxis(r).getGlobalExtent(),l="x"===r.dim?0:1,c=[e.x,e.y];c[l]+=t[l],c[l]=Math.min(o[1],c[l]),c[l]=Math.max(o[0],c[l]);var u=(s[1]+s[0])/2,d=[u,u];d[l]=c[l];return{x:c[0],y:c[1],rotation:e.rotation,cursorPoint:d,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]}},t}(jvt);function lgt(e,t){var a={};return a[t.dim+"AxisIndex"]=t.index,e.getCartesian(a)}var cgt={line:function(e,t,a){return{type:"Line",subPixelOptimize:!0,shape:rgt([t,a[0]],[t,a[1]],ugt(e))}},shadow:function(e,t,a){var n=Math.max(1,e.getBandWidth()),r=a[1]-a[0];return{type:"Rect",shape:igt([t-n/2,a[0]],[n,r],ugt(e))}}};function ugt(e){return"x"===e.dim?0:1}var dgt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:o5e.color.border,width:1,type:"dashed"},shadowStyle:{color:o5e.color.shadowTint},label:{show:!0,formatter:null,precision:"auto",margin:3,color:o5e.color.neutral00,padding:[5,7,5,7],backgroundColor:o5e.color.accent60,borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:o5e.color.accent40,throttle:40}},t}(i5e),hgt=v$e(),pgt=gGe;function fgt(e,t,a){if(!HHe.node){var n=t.getZr();hgt(n).records||(hgt(n).records={}),function(e,t){if(hgt(e).initialized)return;function a(a,n){e.on(a,function(a){var r=function(e){var t={showTip:[],hideTip:[]},a=function(n){var r=t[n.type];r?r.push(n):(n.dispatchAction=a,e.dispatchAction(n))};return{dispatchAction:a,pendings:t}}(t);pgt(hgt(e).records,function(e){e&&n(e,a,r.dispatchAction)}),function(e,t){var a,n=e.showTip.length,r=e.hideTip.length;n?a=e.showTip[n-1]:r&&(a=e.hideTip[r-1]);a&&(a.dispatchAction=null,t.dispatchAction(a))}(r.pendings,t)})}hgt(e).initialized=!0,a("click",MGe(vgt,"click")),a("mousemove",MGe(vgt,"mousemove")),a("globalout",mgt)}(n,t),(hgt(n).records[e]||(hgt(n).records[e]={})).handler=a}}function mgt(e,t,a){e.handler("leave",null,a)}function vgt(e,t,a,n){t.handler(e,a,n)}function ggt(e,t){if(!HHe.node){var a=t.getZr();(hgt(a).records||{})[e]&&(hgt(a).records[e]=null)}}var ygt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=t.getComponent("tooltip"),r=e.get("triggerOn")||n&&n.get("triggerOn")||"mousemove|click";fgt("axisPointer",a,function(e,t,a){"none"!==r&&("leave"===e||r.indexOf(e)>=0)&&a({type:"updateAxisPointer",currTrigger:e,x:t&&t.offsetX,y:t&&t.offsetY})})},t.prototype.remove=function(e,t){ggt("axisPointer",t)},t.prototype.dispose=function(e,t){ggt("axisPointer",t)},t.type="axisPointer",t}(n6e);function bgt(e,t){var a,n=[],r=e.seriesIndex;if(null==r||!(a=t.getSeriesByIndex(r)))return{point:[]};var i=a.getData(),o=m$e(i,e);if(null==o||o<0||TGe(o))return{point:[]};var s=i.getItemGraphicEl(o),l=a.coordinateSystem;if(a.getTooltipPosition)n=a.getTooltipPosition(o)||[];else if(l&&l.dataToPoint)if(e.isStacked){var c=l.getBaseAxis(),u=l.getOtherAxis(c).dim,d=c.dim,h="x"===u||"radius"===u?1:0,p=i.mapDimension(d),f=[];f[h]=i.get(p,o),f[1-h]=i.get(i.getCalculationInfo("stackResultDimension"),o),n=l.dataToPoint(f)||[]}else n=l.dataToPoint(i.getValues(yGe(l.dimensions,function(e){return i.mapDimension(e)}),o))||[];else if(s){var m=s.getBoundingRect().clone();m.applyTransform(s.transform),n=[m.x+m.width/2,m.y+m.height/2]}return{point:n,el:s}}var xgt=v$e();function wgt(e,t,a){var n=e.currTrigger,r=[e.x,e.y],i=e,o=e.dispatchAction||SGe(a.dispatchAction,a),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){kgt(r)&&(r=bgt({seriesIndex:i.seriesIndex,dataIndex:i.dataIndex},t).point);var l=kgt(r),c=i.axesInfo,u=s.axesInfo,d="leave"===n||kgt(r),h={},p={},f={list:[],map:{}},m={showPointer:MGe(Sgt,p),showTooltip:MGe(Mgt,f)};gGe(s.coordSysMap,function(e,t){var a=l||e.containPoint(r);gGe(s.coordSysAxesInfo[t],function(e,t){var n=e.axis,i=function(e,t){for(var a=0;a<(e||[]).length;a++){var n=e[a];if(t.axis.dim===n.axisDim&&t.axis.model.componentIndex===n.axisIndex)return n}}(c,e);if(!d&&a&&(!c||i)){var o=i&&i.value;null!=o||l||(o=n.pointToData(r)),null!=o&&_gt(e,o,m,!1,h)}})});var v={};return gGe(u,function(e,t){var a=e.linkGroup;a&&!p[t]&&gGe(a.axesInfo,function(t,n){var r=p[n];if(t!==e&&r){var i=r.value;a.mapper&&(i=e.axis.scale.parse(a.mapper(i,Tgt(t),Tgt(e)))),v[e.key]=i}})}),gGe(v,function(e,t){_gt(u[t],e,m,!0,h)}),function(e,t,a){var n=a.axesInfo=[];gGe(t,function(t,a){var r=t.axisPointerModel.option,i=e[a];i?(!t.useHandle&&(r.status="show"),r.value=i.value,r.seriesDataIndices=(i.payloadBatch||[]).slice()):!t.useHandle&&(r.status="hide"),"show"===r.status&&n.push({axisDim:t.axis.dim,axisIndex:t.axis.model.componentIndex,value:r.value})})}(p,u,h),function(e,t,a,n){if(kgt(t)||!e.list.length)return void n({type:"hideTip"});var r=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:a.tooltipOption,position:a.position,dataIndexInside:r.dataIndexInside,dataIndex:r.dataIndex,seriesIndex:r.seriesIndex,dataByCoordSys:e.list})}(f,r,e,o),function(e,t,a){var n=a.getZr(),r="axisPointerLastHighlights",i=xgt(n)[r]||{},o=xgt(n)[r]={};gGe(e,function(e,t){var a=e.axisPointerModel.option;"show"===a.status&&e.triggerEmphasis&&gGe(a.seriesDataIndices,function(e){var t=e.seriesIndex+" | "+e.dataIndex;o[t]=e})});var s=[],l=[];gGe(i,function(e,t){!o[t]&&l.push(e)}),gGe(o,function(e,t){!i[t]&&s.push(e)}),l.length&&a.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&a.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}(u,0,a),h}}function _gt(e,t,a,n,r){var i=e.axis;if(!i.scale.isBlank()&&i.containData(t))if(e.involveSeries){var o=function(e,t){var a=t.axis,n=a.dim,r=e,i=[],o=Number.MAX_VALUE,s=-1;return gGe(t.seriesModels,function(t,l){var c,u,d=t.getData().mapDimensionsAll(n);if(t.getAxisTooltipData){var h=t.getAxisTooltipData(d,e,a);u=h.dataIndices,c=h.nestestValue}else{if(!(u=t.indicesOfNearest(n,d[0],e,"category"===a.type?.5:null)).length)return;c=t.getData().get(d[0],u[0])}if(null!=c&&isFinite(c)){var p=e-c,f=Math.abs(p);f<=o&&((f<o||p>=0&&s<0)&&(o=f,s=p,r=c,i.length=0),gGe(u,function(e){i.push({seriesIndex:t.seriesIndex,dataIndexInside:e,dataIndex:t.getData().getRawIndex(e)})}))}}),{payloadBatch:i,snapToValue:r}}(t,e),s=o.payloadBatch,l=o.snapToValue;s[0]&&null==r.seriesIndex&&hGe(r,s[0]),!n&&e.snap&&i.containData(l)&&null!=l&&(t=l),a.showPointer(e,t,s),a.showTooltip(e,o,l)}else a.showPointer(e,t)}function Sgt(e,t,a,n){e[t.key]={value:a,payloadBatch:n}}function Mgt(e,t,a,n){var r=a.payloadBatch,i=t.axis,o=i.model,s=t.axisPointerModel;if(t.triggerTooltip&&r.length){var l=t.coordSys.model,c=Hot(l),u=e.map[c];u||(u=e.map[c]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(u)),u.dataByAxis.push({axisDim:i.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:r.slice()})}}function Tgt(e){var t=e.axis.model,a={},n=a.axisDim=e.axis.dim;return a.axisIndex=a[n+"AxisIndex"]=t.componentIndex,a.axisName=a[n+"AxisName"]=t.name,a.axisId=a[n+"AxisId"]=t.id,a}function kgt(e){return!e||null==e[0]||isNaN(e[0])||null==e[1]||isNaN(e[1])}function Cgt(e){Wot.registerAxisPointerClass("CartesianAxisPointer",sgt),e.registerComponentModel(dgt),e.registerComponentView(ygt),e.registerPreprocessor(function(e){if(e){(!e.axisPointer||0===e.axisPointer.length)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!TGe(t)&&(e.axisPointer.link=[t])}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=Bot(e,t)}),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},wgt)}function Agt(e){Qet(tst),Qet(Cgt)}var Egt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.makeElOption=function(e,t,a,n,r){var i=a.axis;"angle"===i.dim&&(this.animationThreshold=Math.PI/18);var o=i.polar,s=o.getOtherAxis(i).getExtent(),l=i.dataToCoord(t),c=n.get("type");if(c&&"none"!==c){var u=Qvt(n),d=Igt[c](i,o,l,s);d.style=u,e.graphicKey=d.type,e.pointer=d}var h=function(e,t,a,n,r){var i=t.axis,o=i.dataToCoord(e),s=n.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l,c,u,d=n.getRadiusAxis().getExtent();if("radius"===i.dim){var h=[1,0,0,1,0,0];ZWe(h,h,s),KWe(h,h,[n.cx,n.cy]),l=R0e([o,-r],h);var p=t.getModel("axisLabel").get("rotate")||0,f=hot.innerTextLayout(s,p*Math.PI/180,-1);c=f.textAlign,u=f.textVerticalAlign}else{var m=d[1];l=n.coordToPoint([m+r,o]);var v=n.cx,g=n.cy;c=Math.abs(l[0]-v)/m<.3?"center":l[0]>v?"left":"right",u=Math.abs(l[1]-g)/m<.3?"middle":l[1]>g?"top":"bottom"}return{position:l,align:c,verticalAlign:u}}(t,a,0,o,n.get(["label","margin"]));egt(e,a,n,r,h)},t}(jvt);var Igt={line:function(e,t,a,n){return"angle"===e.dim?{type:"Line",shape:rgt(t.coordToPoint([n[0],a]),t.coordToPoint([n[1],a]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r:a}}},shadow:function(e,t,a,n){var r=Math.max(1,e.getBandWidth()),i=Math.PI/180;return"angle"===e.dim?{type:"Sector",shape:ogt(t.cx,t.cy,n[0],n[1],(-a-r/2)*i,(r/2-a)*i)}:{type:"Sector",shape:ogt(t.cx,t.cy,a-r/2,a+r/2,0,2*Math.PI)}}},Rgt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.findAxisModel=function(e){var t;return this.ecModel.eachComponent(e,function(e){e.getCoordSysModel()===this&&(t=e)},this),t},t.type="polar",t.dependencies=["radiusAxis","angleAxis"],t.defaultOption={z:0,center:["50%","50%"],radius:"80%"},t}(i5e),Dgt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",x$e).models[0]},t.type="polarAxis",t}(i5e);mGe(Dgt,Ket);var Pgt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="angleAxis",t}(Dgt),Lgt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="radiusAxis",t}(Dgt),Ngt=function(e){function t(t,a){return e.call(this,"radius",t,a)||this}return zHe(t,e),t.prototype.pointToData=function(e,t){return this.polar.pointToData(e,t)["radius"===this.dim?0:1]},t}(Dtt);Ngt.prototype.dataToRadius=Dtt.prototype.dataToCoord,Ngt.prototype.radiusToData=Dtt.prototype.coordToData;var Ogt=v$e(),Fgt=function(e){function t(t,a){return e.call(this,"angle",t,a||[0,360])||this}return zHe(t,e),t.prototype.pointToData=function(e,t){return this.polar.pointToData(e,t)["radius"===this.dim?0:1]},t.prototype.calculateCategoryInterval=function(){var e=this,t=e.getLabelModel(),a=e.scale,n=a.getExtent(),r=a.count();if(n[1]-n[0]<1)return 0;var i=n[0],o=e.dataToCoord(i+1)-e.dataToCoord(i),s=Math.abs(o),l=nXe(null==i?"":i+"",t.getFont(),"center","top"),c=Math.max(l.height,7)/s;isNaN(c)&&(c=1/0);var u=Math.max(0,Math.floor(c)),d=Ogt(e.model),h=d.lastAutoInterval,p=d.lastTickCount;return null!=h&&null!=p&&Math.abs(h-u)<=1&&Math.abs(p-r)<=1&&h>u?u=h:(d.lastTickCount=r,d.lastAutoInterval=u),u},t}(Dtt);Fgt.prototype.dataToAngle=Dtt.prototype.dataToCoord,Fgt.prototype.angleToData=Dtt.prototype.coordToData;var Bgt=["radius","angle"],Ugt=function(){function e(e){this.dimensions=Bgt,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new Ngt,this._angleAxis=new Fgt,this.axisPointerEnabled=!0,this.name=e||"",this._radiusAxis.polar=this._angleAxis.polar=this}return e.prototype.containPoint=function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},e.prototype.containData=function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},e.prototype.getAxis=function(e){return this["_"+e+"Axis"]},e.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},e.prototype.getAxesByScale=function(e){var t=[],a=this._angleAxis,n=this._radiusAxis;return a.scale.type===e&&t.push(a),n.scale.type===e&&t.push(n),t},e.prototype.getAngleAxis=function(){return this._angleAxis},e.prototype.getRadiusAxis=function(){return this._radiusAxis},e.prototype.getOtherAxis=function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},e.prototype.getTooltipAxes=function(e){var t=null!=e&&"auto"!==e?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},e.prototype.dataToPoint=function(e,t,a){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)],a)},e.prototype.pointToData=function(e,t,a){a=a||[];var n=this.pointToCoord(e);return a[0]=this._radiusAxis.radiusToData(n[0],t),a[1]=this._angleAxis.angleToData(n[1],t),a},e.prototype.pointToCoord=function(e){var t=e[0]-this.cx,a=e[1]-this.cy,n=this.getAngleAxis(),r=n.getExtent(),i=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]);n.inverse?i=o-360:o=i+360;var s=Math.sqrt(t*t+a*a);t/=s,a/=s;for(var l=Math.atan2(-a,t)/Math.PI*180,c=l<i?1:-1;l<i||l>o;)l+=360*c;return[s,l]},e.prototype.coordToPoint=function(e,t){t=t||[];var a=e[0],n=e[1]/180*Math.PI;return t[0]=Math.cos(n)*a+this.cx,t[1]=-Math.sin(n)*a+this.cy,t},e.prototype.getArea=function(){var e=this.getAngleAxis(),t=this.getRadiusAxis().getExtent().slice();t[0]>t[1]&&t.reverse();var a=e.getExtent(),n=Math.PI/180,r=1e-4;return{cx:this.cx,cy:this.cy,r0:t[0],r:t[1],startAngle:-a[0]*n,endAngle:-a[1]*n,clockwise:e.inverse,contain:function(e,t){var a=e-this.cx,n=t-this.cy,i=a*a+n*n,o=this.r,s=this.r0;return o!==s&&i-r<=o*o&&i+r>=s*s},x:this.cx-t[1],y:this.cy-t[1],width:2*t[1],height:2*t[1]}},e.prototype.convertToPixel=function(e,t,a){return zgt(t)===this?this.dataToPoint(a):null},e.prototype.convertFromPixel=function(e,t,a){return zgt(t)===this?this.pointToData(a):null},e}();function zgt(e){var t=e.seriesModel,a=e.polarModel;return a&&a.coordinateSystem||t&&t.coordinateSystem}function Vgt(e,t){var a=this,n=a.getAngleAxis(),r=a.getRadiusAxis();if(n.scale.setExtent(1/0,-1/0),r.scale.setExtent(1/0,-1/0),e.eachSeries(function(e){if(e.coordinateSystem===a){var t=e.getData();gGe(Yet(t,"radius"),function(e){r.scale.unionExtentFromData(t,e)}),gGe(Yet(t,"angle"),function(e){n.scale.unionExtentFromData(t,e)})}}),zet(n.scale,n.model),zet(r.scale,r.model),"category"===n.type&&!n.onBand){var i=n.getExtent(),o=360/n.scale.count();n.inverse?i[1]+=o:i[1]-=o,n.setExtent(i[0],i[1])}}function Hgt(e,t){var a;if(e.type=t.get("type"),e.scale=Vet(t),e.onBand=t.get("boundaryGap")&&"category"===e.type,e.inverse=t.get("inverse"),function(e){return"angleAxis"===e.mainType}(t)){e.inverse=e.inverse!==t.get("clockwise");var n=t.get("startAngle"),r=null!==(a=t.get("endAngle"))&&void 0!==a?a:n+(e.inverse?-360:360);e.setExtent(n,r)}t.axis=e,e.model=t}var Ggt={dimensions:Bgt,create:function(e,t){var a=[];return e.eachComponent("polar",function(e,n){var r=new Ugt(n+"");r.update=Vgt;var i=r.getRadiusAxis(),o=r.getAngleAxis(),s=e.findAxisModel("radiusAxis"),l=e.findAxisModel("angleAxis");Hgt(i,s),Hgt(o,l),function(e,t,a){var n=t.get("center"),r=J2e(t,a).refContainer;e.cx=RXe(n[0],r.width)+r.x,e.cy=RXe(n[1],r.height)+r.y;var i=e.getRadiusAxis(),o=Math.min(r.width,r.height)/2,s=t.get("radius");null==s?s=[0,"100%"]:TGe(s)||(s=[0,s]);var l=[RXe(s[0],o),RXe(s[1],o)];i.inverse?i.setExtent(l[1],l[0]):i.setExtent(l[0],l[1])}(r,e,t),a.push(r),e.coordinateSystem=r,r.model=e}),e.eachSeries(function(e){if("polar"===e.get("coordinateSystem")){var t=e.getReferringComponents("polar",x$e).models[0];e.coordinateSystem=t.coordinateSystem}}),a}},Wgt=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function qgt(e,t,a){t[1]>t[0]&&(t=t.slice().reverse());var n=e.coordToPoint([t[0],a]),r=e.coordToPoint([t[1],a]);return{x1:n[0],y1:n[1],x2:r[0],y2:r[1]}}function Ygt(e){return e.getRadiusAxis().inverse?0:1}function jgt(e){var t=e[0],a=e[e.length-1];t&&a&&Math.abs(Math.abs(t.coord-a.coord)-360)<1e-4&&e.pop()}var Xgt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.axisPointerClass="PolarAxisPointer",a}return zHe(t,e),t.prototype.render=function(e,t){if(this.group.removeAll(),e.get("show")){var a=e.axis,n=a.polar,r=n.getRadiusAxis().getExtent(),i=a.getTicksCoords({breakTicks:"none"}),o=a.getMinorTicksCoords(),s=yGe(a.getViewLabels(),function(e){e=cGe(e);var t=a.scale,n="ordinal"===t.type?t.getRawOrdinalNumber(e.tickValue):e.tickValue;return e.coord=a.dataToCoord(n),e});jgt(s),jgt(i),gGe(Wgt,function(t){!e.get([t,"show"])||a.scale.isBlank()&&"axisLine"!==t||$gt[t](this.group,e,n,i,o,r,s)},this)}},t.type="angleAxis",t}(Wot),$gt={axisLine:function(e,t,a,n,r,i){var o,s=t.getModel(["axisLine","lineStyle"]),l=a.getAngleAxis(),c=Math.PI/180,u=l.getExtent(),d=Ygt(a),h=d?0:1,p=360===Math.abs(u[1]-u[0])?"Circle":"Arc";(o=0===i[h]?new e1e[p]({shape:{cx:a.cx,cy:a.cy,r:i[d],startAngle:-u[0]*c,endAngle:-u[1]*c,clockwise:l.inverse},style:s.getLineStyle(),z2:1,silent:!0}):new RQe({shape:{cx:a.cx,cy:a.cy,r:i[d],r0:i[h]},style:s.getLineStyle(),z2:1,silent:!0})).style.fill=null,e.add(o)},axisTick:function(e,t,a,n,r,i){var o=t.getModel("axisTick"),s=(o.get("inside")?-1:1)*o.get("length"),l=i[Ygt(a)],c=yGe(n,function(e){return new UQe({shape:qgt(a,[l,l+s],e.coord)})});e.add(k0e(c,{style:pGe(o.getModel("lineStyle").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})}))},minorTick:function(e,t,a,n,r,i){if(r.length){for(var o=t.getModel("axisTick"),s=t.getModel("minorTick"),l=(o.get("inside")?-1:1)*s.get("length"),c=i[Ygt(a)],u=[],d=0;d<r.length;d++)for(var h=0;h<r[d].length;h++)u.push(new UQe({shape:qgt(a,[c,c+l],r[d][h].coord)}));e.add(k0e(u,{style:pGe(s.getModel("lineStyle").getLineStyle(),pGe(o.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(e,t,a,n,r,i,o){var s=t.getCategories(!0),l=t.getModel("axisLabel"),c=l.get("margin"),u=t.get("triggerEvent");gGe(o,function(n,r){var o=l,d=n.tickValue,h=i[Ygt(a)],p=a.coordToPoint([h+c,n.coord]),f=a.cx,m=a.cy,v=Math.abs(p[0]-f)/h<.3?"center":p[0]>f?"left":"right",g=Math.abs(p[1]-m)/h<.3?"middle":p[1]>m?"top":"bottom";if(s&&s[d]){var y=s[d];IGe(y)&&y.textStyle&&(o=new E1e(y.textStyle,l,l.ecModel))}var b=new PZe({silent:hot.isLabelSilent(t),style:o1e(o,{x:p[0],y:p[1],fill:o.getTextColor()||t.get(["axisLine","lineStyle","color"]),text:n.formattedLabel,align:v,verticalAlign:g})});if(e.add(b),G0e({el:b,componentModel:t,itemName:n.formattedLabel,formatterParamsExtra:{isTruncated:function(){return b.isTruncated},value:n.rawLabel,tickIndex:r}}),u){var x=hot.makeAxisEventDataBase(t);x.targetType="axisLabel",x.value=n.rawLabel,YZe(b).eventData=x}},this)},splitLine:function(e,t,a,n,r,i){var o=t.getModel("splitLine").getModel("lineStyle"),s=o.get("color"),l=0;s=s instanceof Array?s:[s];for(var c=[],u=0;u<n.length;u++){var d=l++%s.length;c[d]=c[d]||[],c[d].push(new UQe({shape:qgt(a,i,n[u].coord)}))}for(u=0;u<c.length;u++)e.add(k0e(c[u],{style:pGe({stroke:s[u%s.length]},o.getLineStyle()),silent:!0,z:t.get("z")}))},minorSplitLine:function(e,t,a,n,r,i){if(r.length){for(var o=t.getModel("minorSplitLine").getModel("lineStyle"),s=[],l=0;l<r.length;l++)for(var c=0;c<r[l].length;c++)s.push(new UQe({shape:qgt(a,i,r[l][c].coord)}));e.add(k0e(s,{style:o.getLineStyle(),silent:!0,z:t.get("z")}))}},splitArea:function(e,t,a,n,r,i){if(n.length){var o=t.getModel("splitArea").getModel("areaStyle"),s=o.get("color"),l=0;s=s instanceof Array?s:[s];for(var c=[],u=Math.PI/180,d=-n[0].coord*u,h=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),f=t.get("clockwise"),m=1,v=n.length;m<=v;m++){var g=m===v?n[0].coord:n[m].coord,y=l++%s.length;c[y]=c[y]||[],c[y].push(new EQe({shape:{cx:a.cx,cy:a.cy,r0:h,r:p,startAngle:d,endAngle:-g*u,clockwise:f},silent:!0})),d=-g*u}for(m=0;m<c.length;m++)e.add(k0e(c[m],{style:pGe({fill:s[m%s.length]},o.getAreaStyle()),silent:!0}))}}},Kgt=["splitLine","splitArea","minorSplitLine"],Zgt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.axisPointerClass="PolarAxisPointer",a}return zHe(t,e),t.prototype.render=function(e,t,a){if(this.group.removeAll(),e.get("show")){var n=this._axisGroup,r=this._axisGroup=new xXe;this.group.add(r);var i=e.axis,o=i.polar,s=o.getAngleAxis(),l=i.getTicksCoords(),c=i.getMinorTicksCoords(),u=s.getExtent()[0],d=i.getExtent(),h=function(e,t,a){return{position:[e.cx,e.cy],rotation:a/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}(o,e,u),p=new hot(e,a,h);p.build(),r.add(p.group),L0e(n,r,e),gGe(Kgt,function(t){e.get([t,"show"])&&!i.scale.isBlank()&&Jgt[t](this.group,e,o,u,d,l,c)},this)}},t.type="radiusAxis",t}(Wot),Jgt={splitLine:function(e,t,a,n,r,i){var o=t.getModel("splitLine").getModel("lineStyle"),s=o.get("color"),l=0,c=a.getAngleAxis(),u=Math.PI/180,d=c.getExtent(),h=360===Math.abs(d[1]-d[0])?"Circle":"Arc";s=s instanceof Array?s:[s];for(var p=[],f=0;f<i.length;f++){var m=l++%s.length;p[m]=p[m]||[],p[m].push(new e1e[h]({shape:{cx:a.cx,cy:a.cy,r:Math.max(i[f].coord,0),startAngle:-d[0]*u,endAngle:-d[1]*u,clockwise:c.inverse}}))}for(f=0;f<p.length;f++)e.add(k0e(p[f],{style:pGe({stroke:s[f%s.length],fill:null},o.getLineStyle()),silent:!0}))},minorSplitLine:function(e,t,a,n,r,i,o){if(o.length){for(var s=t.getModel("minorSplitLine").getModel("lineStyle"),l=[],c=0;c<o.length;c++)for(var u=0;u<o[c].length;u++)l.push(new hQe({shape:{cx:a.cx,cy:a.cy,r:o[c][u].coord}}));e.add(k0e(l,{style:pGe({fill:null},s.getLineStyle()),silent:!0}))}},splitArea:function(e,t,a,n,r,i){if(i.length){var o=t.getModel("splitArea").getModel("areaStyle"),s=o.get("color"),l=0;s=s instanceof Array?s:[s];for(var c=[],u=i[0].coord,d=1;d<i.length;d++){var h=l++%s.length;c[h]=c[h]||[],c[h].push(new EQe({shape:{cx:a.cx,cy:a.cy,r0:u,r:i[d].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),u=i[d].coord}for(d=0;d<c.length;d++)e.add(k0e(c[d],{style:pGe({fill:s[d%s.length]},o.getAreaStyle()),silent:!0}))}}};function Qgt(e){return e.get("stack")||"__ec_stack_"+e.seriesIndex}function eyt(e,t){return t.dim+e.model.componentIndex}function tyt(e,t,a){var n={},r=function(e){var t={};gGe(e,function(e,a){var n=e.getData(),r=e.coordinateSystem,i=r.getBaseAxis(),o=eyt(r,i),s=i.getExtent(),l="category"===i.type?i.getBandWidth():Math.abs(s[1]-s[0])/n.count(),c=t[o]||{bandWidth:l,remainedWidth:l,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},u=c.stacks;t[o]=c;var d=Qgt(e);u[d]||c.autoWidthCount++,u[d]=u[d]||{width:0,maxWidth:0};var h=RXe(e.get("barWidth"),l),p=RXe(e.get("barMaxWidth"),l),f=e.get("barGap"),m=e.get("barCategoryGap");h&&!u[d].width&&(h=Math.min(c.remainedWidth,h),u[d].width=h,c.remainedWidth-=h),p&&(u[d].maxWidth=p),null!=f&&(c.gap=f),null!=m&&(c.categoryGap=m)});var a={};return gGe(t,function(e,t){a[t]={};var n=e.stacks,r=e.bandWidth,i=RXe(e.categoryGap,r),o=RXe(e.gap,1),s=e.remainedWidth,l=e.autoWidthCount,c=(s-i)/(l+(l-1)*o);c=Math.max(c,0),gGe(n,function(e,t){var a=e.maxWidth;a&&a<c&&(a=Math.min(a,s),e.width&&(a=Math.min(a,e.width)),s-=a,e.width=a,l--)}),c=(s-i)/(l+(l-1)*o),c=Math.max(c,0);var u,d=0;gGe(n,function(e,t){e.width||(e.width=c),u=e,d+=e.width*(1+o)}),u&&(d-=u.width*o);var h=-d/2;gGe(n,function(e,n){a[t][n]=a[t][n]||{offset:h,width:e.width},h+=e.width*(1+o)})}),a}(xGe(t.getSeriesByType(e),function(e){return!t.isSeriesFiltered(e)&&e.coordinateSystem&&"polar"===e.coordinateSystem.type}));t.eachSeriesByType(e,function(e){if("polar"===e.coordinateSystem.type){var t=e.getData(),a=e.coordinateSystem,i=a.getBaseAxis(),o=eyt(a,i),s=Qgt(e),l=r[o][s],c=l.offset,u=l.width,d=a.getOtherAxis(i),h=e.coordinateSystem.cx,p=e.coordinateSystem.cy,f=e.get("barMinHeight")||0,m=e.get("barMinAngle")||0;n[s]=n[s]||[];for(var v=t.mapDimension(d.dim),g=t.mapDimension(i.dim),y=F9e(t,v),b="radius"!==i.dim||!e.get("roundCap",!0),x=d.model.get("startValue"),w=d.dataToCoord(x||0),_=0,S=t.count();_<S;_++){var M=t.get(v,_),T=t.get(g,_),k=M>=0?"p":"n",C=w;y&&(n[s][T]||(n[s][T]={p:w,n:w}),C=n[s][T][k]);var A=void 0,E=void 0,I=void 0,R=void 0;if("radius"===d.dim){var D=d.dataToCoord(M)-w,P=i.dataToCoord(T);Math.abs(D)<f&&(D=(D<0?-1:1)*f),A=C,E=C+D,R=(I=P-c)-u,y&&(n[s][T][k]=E)}else{var L=d.dataToCoord(M,b)-w,N=i.dataToCoord(T);Math.abs(L)<m&&(L=(L<0?-1:1)*m),E=(A=N+c)+u,I=C,R=C+L,y&&(n[s][T][k]=R)}t.setItemLayout(_,{cx:h,cy:p,r0:A,r:E,startAngle:-I*Math.PI/180,endAngle:-R*Math.PI/180,clockwise:I>=R})}}})}var ayt={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},nyt={splitNumber:5},ryt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="polar",t}(n6e);function iyt(e,t){t=t||{};var a=e.coordinateSystem,n=e.axis,r={},i=n.position,o=n.orient,s=a.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],c={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};r.position=["vertical"===o?c.vertical[i]:l[0],"horizontal"===o?c.horizontal[i]:l[3]];r.rotation=Math.PI/2*{horizontal:0,vertical:1}[o];r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,right:1,left:-1}[i],e.get(["axisTick","inside"])&&(r.tickDirection=-r.tickDirection),OGe(t.labelInside,e.get(["axisLabel","inside"]))&&(r.labelDirection=-r.labelDirection);var u=e.get(["axisLabel","rotate"]);return r.labelRotate="top"===i?-u:u,r.z2=1,r}var oyt=["splitArea","splitLine","breakArea"],syt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.axisPointerClass="SingleAxisPointer",a}return zHe(t,e),t.prototype.render=function(t,a,n,r){var i=this.group;i.removeAll();var o=this._axisGroup;this._axisGroup=new xXe;var s=iyt(t),l=new hot(t,n,s);l.build(),i.add(this._axisGroup),i.add(l.group),gGe(oyt,function(e){t.get([e,"show"])&&lyt[e](this,this.group,this._axisGroup,t,n)},this),L0e(o,this._axisGroup,t),e.prototype.render.call(this,t,a,n,r)},t.prototype.remove=function(){jot(this)},t.type="singleAxis",t}(Wot),lyt={splitLine:function(e,t,a,n,r){var i=n.axis;if(!i.scale.isBlank()){var o=n.getModel("splitLine"),s=o.getModel("lineStyle"),l=s.get("color");l=l instanceof Array?l:[l];for(var c=s.get("width"),u=n.coordinateSystem.getRect(),d=i.isHorizontal(),h=[],p=0,f=i.getTicksCoords({tickModel:o,breakTicks:"none",pruneByBreak:"preserve_extent_bound"}),m=[],v=[],g=0;g<f.length;++g){var y=i.toGlobalCoord(f[g].coord);d?(m[0]=y,m[1]=u.y,v[0]=y,v[1]=u.y+u.height):(m[0]=u.x,m[1]=y,v[0]=u.x+u.width,v[1]=y);var b=new UQe({shape:{x1:m[0],y1:m[1],x2:v[0],y2:v[1]},silent:!0});A0e(b.shape,c);var x=p++%l.length;h[x]=h[x]||[],h[x].push(b)}var w=s.getLineStyle(["color"]);for(g=0;g<h.length;++g)t.add(k0e(h[g],{style:pGe({stroke:l[g%l.length]},w),silent:!0}))}},splitArea:function(e,t,a,n,r){Yot(e,a,n,n)},breakArea:function(e,t,a,n,r){var i=Uit(),o=n.axis.scale;i&&"ordinal"!==o.type&&i.rectCoordBuildBreakAxis(t,e,n,n.coordinateSystem.getRect(),r)}},cyt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.getCoordSysModel=function(){return this},t.type="singleAxis",t.layoutMode="box",t.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}},jitter:0,jitterOverlap:!0,jitterMargin:2},t}(i5e);mGe(cyt,Ket.prototype);var uyt=function(e){function t(t,a,n,r,i){var o=e.call(this,t,a,n)||this;return o.type=r||"value",o.position=i||"bottom",o}return zHe(t,e),t.prototype.isHorizontal=function(){var e=this.position;return"top"===e||"bottom"===e},t.prototype.pointToData=function(e,t){return this.coordinateSystem.pointToData(e)[0]},t}(Dtt),dyt=["single"],hyt=function(){function e(e,t,a){this.type="single",this.dimension="single",this.dimensions=dyt,this.axisPointerEnabled=!0,this.model=e,this._init(e,t,a)}return e.prototype._init=function(e,t,a){var n=this.dimension,r=new uyt(n,Vet(e),[0,0],e.get("type"),e.get("position")),i="category"===r.type;r.onBand=i&&e.get("boundaryGap"),r.inverse=e.get("inverse"),r.orient=e.get("orient"),e.axis=r,r.model=e,r.coordinateSystem=this,this._axis=r},e.prototype.update=function(e,t){e.eachSeries(function(e){if(e.coordinateSystem===this){var t=e.getData();gGe(t.mapDimensionsAll(this.dimension),function(e){this._axis.scale.unionExtentFromData(t,e)},this),zet(this._axis.scale,this._axis.model)}},this)},e.prototype.resize=function(e,t){var a=J2e(e,t).refContainer;this._rect=$2e(e.getBoxLayoutParams(),a),this._adjustAxis()},e.prototype.getRect=function(){return this._rect},e.prototype._adjustAxis=function(){var e=this._rect,t=this._axis,a=t.isHorizontal(),n=a?[0,e.width]:[0,e.height],r=t.inverse?1:0;t.setExtent(n[r],n[1-r]),this._updateAxisTransform(t,a?e.x:e.y)},e.prototype._updateAxisTransform=function(e,t){var a=e.getExtent(),n=a[0]+a[1],r=e.isHorizontal();e.toGlobalCoord=r?function(e){return e+t}:function(e){return n-e+t},e.toLocalCoord=r?function(e){return e-t}:function(e){return n-e+t}},e.prototype.getAxis=function(){return this._axis},e.prototype.getBaseAxis=function(){return this._axis},e.prototype.getAxes=function(){return[this._axis]},e.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},e.prototype.containPoint=function(e){var t=this.getRect(),a=this.getAxis();return"horizontal"===a.orient?a.contain(a.toLocalCoord(e[0]))&&e[1]>=t.y&&e[1]<=t.y+t.height:a.contain(a.toLocalCoord(e[1]))&&e[0]>=t.y&&e[0]<=t.y+t.height},e.prototype.pointToData=function(e,t,a){a=a||[];var n=this.getAxis();return a[0]=n.coordToData(n.toLocalCoord(e["horizontal"===n.orient?0:1])),a},e.prototype.dataToPoint=function(e,t,a){var n=this.getAxis(),r=this.getRect();a=a||[];var i="horizontal"===n.orient?0:1;return e instanceof Array&&(e=e[0]),a[i]=n.toGlobalCoord(n.dataToCoord(+e)),a[1-i]=0===i?r.y+r.height/2:r.x+r.width/2,a},e.prototype.convertToPixel=function(e,t,a){return pyt(t)===this?this.dataToPoint(a):null},e.prototype.convertFromPixel=function(e,t,a){return pyt(t)===this?this.pointToData(a):null},e}();function pyt(e){var t=e.seriesModel,a=e.singleAxisModel;return a&&a.coordinateSystem||t&&t.coordinateSystem}var fyt={create:function(e,t){var a=[];return e.eachComponent("singleAxis",function(n,r){var i=new hyt(n,e,t);i.name="single_"+r,i.resize(n,t),n.coordinateSystem=i,a.push(i)}),e.eachSeries(function(e){if("singleAxis"===e.get("coordinateSystem")){var t=e.getReferringComponents("singleAxis",x$e).models[0];e.coordinateSystem=t&&t.coordinateSystem}}),a},dimensions:dyt},myt=["x","y"],vyt=["width","height"],gyt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.makeElOption=function(e,t,a,n,r){var i=a.axis,o=i.coordinateSystem,s=xyt(o,1-byt(i)),l=o.dataToPoint(t)[0],c=n.get("type");if(c&&"none"!==c){var u=Qvt(n),d=yyt[c](i,l,s);d.style=u,e.graphicKey=d.type,e.pointer=d}ngt(t,e,iyt(a),a,n,r)},t.prototype.getHandleTransform=function(e,t,a){var n=iyt(t,{labelInside:!1});n.labelMargin=a.get(["handle","margin"]);var r=agt(t.axis,e,n);return{x:r[0],y:r[1],rotation:n.rotation+(n.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(e,t,a,n){var r=a.axis,i=r.coordinateSystem,o=byt(r),s=xyt(i,o),l=[e.x,e.y];l[o]+=t[o],l[o]=Math.min(s[1],l[o]),l[o]=Math.max(s[0],l[o]);var c=xyt(i,1-o),u=(c[1]+c[0])/2,d=[u,u];return d[o]=l[o],{x:l[0],y:l[1],rotation:e.rotation,cursorPoint:d,tooltipOption:{verticalAlign:"middle"}}},t}(jvt),yyt={line:function(e,t,a){return{type:"Line",subPixelOptimize:!0,shape:rgt([t,a[0]],[t,a[1]],byt(e))}},shadow:function(e,t,a){var n=e.getBandWidth(),r=a[1]-a[0];return{type:"Rect",shape:igt([t-n/2,a[0]],[n,r],byt(e))}}};function byt(e){return e.isHorizontal()?0:1}function xyt(e,t){var a=e.getRect();return[a[myt[t]],a[myt[t]]+a[vyt[t]]]}var wyt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="single",t}(n6e);var _yt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(t,a,n){var r=a5e(t);e.prototype.init.apply(this,arguments),Syt(t,r)},t.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),Syt(this.option,t)},t.prototype.getCellSize=function(){return this.option.cellSize},t.type="calendar",t.layoutMode="box",t.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:o5e.color.axisLine,width:1,type:"solid"}},itemStyle:{color:o5e.color.neutral00,borderWidth:1,borderColor:o5e.color.neutral10},dayLabel:{show:!0,firstDay:0,position:"start",margin:o5e.size.s,color:o5e.color.secondary},monthLabel:{show:!0,position:"start",margin:o5e.size.s,align:"center",formatter:null,color:o5e.color.secondary},yearLabel:{show:!0,position:null,margin:o5e.size.xl,formatter:null,color:o5e.color.quaternary,fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},t}(i5e);function Syt(e,t){var a,n=e.cellSize;1===(a=TGe(n)?n:e.cellSize=[n,n]).length&&(a[1]=a[0]);var r=yGe([0,1],function(e){return function(e,t){return null!=e[W2e[t][0]]||null!=e[W2e[t][1]]&&null!=e[W2e[t][2]]}(t,e)&&(a[e]="auto"),null!=a[e]&&"auto"!==a[e]});t5e(e,t,{type:"box",ignoreSize:r})}var Myt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){var n=this.group;n.removeAll();var r=e.coordinateSystem,i=r.getRangeInfo(),o=r.getOrient(),s=t.getLocaleModel();this._renderDayRect(e,i,n),this._renderLines(e,i,o,n),this._renderYearText(e,i,o,n),this._renderMonthText(e,s,o,n),this._renderWeekText(e,s,i,o,n)},t.prototype._renderDayRect=function(e,t,a){for(var n=e.coordinateSystem,r=e.getModel("itemStyle").getItemStyle(),i=n.getCellWidth(),o=n.getCellHeight(),s=t.start.time;s<=t.end.time;s=n.getNextNDay(s,1).time){var l=n.dataToCalendarLayout([s],!1).tl,c=new EZe({shape:{x:l[0],y:l[1],width:i,height:o},cursor:"default",style:r});a.add(c)}},t.prototype._renderLines=function(e,t,a,n){var r=this,i=e.coordinateSystem,o=e.getModel(["splitLine","lineStyle"]).getLineStyle(),s=e.get(["splitLine","show"]),l=o.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var c=t.start,u=0;c.time<=t.end.time;u++){h(c.formatedDate),0===u&&(c=i.getDateInfo(t.start.y+"-"+t.start.m));var d=c.date;d.setMonth(d.getMonth()+1),c=i.getDateInfo(d)}function h(t){r._firstDayOfMonth.push(i.getDateInfo(t)),r._firstDayPoints.push(i.dataToCalendarLayout([t],!1).tl);var l=r._getLinePointsOfOneWeek(e,t,a);r._tlpoints.push(l[0]),r._blpoints.push(l[l.length-1]),s&&r._drawSplitline(l,o,n)}h(i.getNextNDay(t.end.time,1).formatedDate),s&&this._drawSplitline(r._getEdgesPoints(r._tlpoints,l,a),o,n),s&&this._drawSplitline(r._getEdgesPoints(r._blpoints,l,a),o,n)},t.prototype._getEdgesPoints=function(e,t,a){var n=[e[0].slice(),e[e.length-1].slice()],r="horizontal"===a?0:1;return n[0][r]=n[0][r]-t/2,n[1][r]=n[1][r]+t/2,n},t.prototype._drawSplitline=function(e,t,a){var n=new OQe({z2:20,shape:{points:e},style:t});a.add(n)},t.prototype._getLinePointsOfOneWeek=function(e,t,a){for(var n=e.coordinateSystem,r=n.getDateInfo(t),i=[],o=0;o<7;o++){var s=n.getNextNDay(r.time,o),l=n.dataToCalendarLayout([s.time],!1);i[2*s.day]=l.tl,i[2*s.day+1]=l["horizontal"===a?"bl":"tr"]}return i},t.prototype._formatterLabel=function(e,t){return CGe(e)&&e?(a=e,gGe(t,function(e,t){a=a.replace("{"+t+"}",e)}),a):kGe(e)?e(t):t.nameMap;var a},t.prototype._yearTextPositionControl=function(e,t,a,n,r){var i=t[0],o=t[1],s=["center","bottom"];"bottom"===n?(o+=r,s=["center","top"]):"left"===n?i-=r:"right"===n?(i+=r,s=["center","top"]):o-=r;var l=0;return"left"!==n&&"right"!==n||(l=Math.PI/2),{rotation:l,x:i,y:o,style:{align:s[0],verticalAlign:s[1]}}},t.prototype._renderYearText=function(e,t,a,n){var r=e.getModel("yearLabel");if(r.get("show")){var i=r.get("margin"),o=r.get("position");o||(o="horizontal"!==a?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,c=(s[0][1]+s[1][1])/2,u="horizontal"===a?0:1,d={top:[l,s[u][1]],bottom:[l,s[1-u][1]],left:[s[1-u][0],c],right:[s[u][0],c]},h=t.start.y;+t.end.y>+t.start.y&&(h=h+"-"+t.end.y);var p=r.get("formatter"),f={start:t.start.y,end:t.end.y,nameMap:h},m=this._formatterLabel(p,f),v=new PZe({z2:30,style:o1e(r,{text:m}),silent:r.get("silent")});v.attr(this._yearTextPositionControl(v,d[o],a,o,i)),n.add(v)}},t.prototype._monthTextPositionControl=function(e,t,a,n,r){var i="left",o="top",s=e[0],l=e[1];return"horizontal"===a?(l+=r,t&&(i="center"),"start"===n&&(o="bottom")):(s+=r,t&&(o="middle"),"start"===n&&(i="right")),{x:s,y:l,align:i,verticalAlign:o}},t.prototype._renderMonthText=function(e,t,a,n){var r=e.getModel("monthLabel");if(r.get("show")){var i=r.get("nameMap"),o=r.get("margin"),s=r.get("position"),l=r.get("align"),c=[this._tlpoints,this._blpoints];i&&!CGe(i)||(i&&(t=z1e(i)||t),i=t.get(["time","monthAbbr"])||[]);var u="start"===s?0:1,d="horizontal"===a?0:1;o="start"===s?-o:o;for(var h="center"===l,p=r.get("silent"),f=0;f<c[u].length-1;f++){var m=c[u][f].slice(),v=this._firstDayOfMonth[f];if(h){var g=this._firstDayPoints[f];m[d]=(g[d]+c[0][f+1][d])/2}var y=r.get("formatter"),b=i[+v.m-1],x={yyyy:v.y,yy:(v.y+"").slice(2),MM:v.m,M:+v.m,nameMap:b},w=this._formatterLabel(y,x),_=new PZe({z2:30,style:hGe(o1e(r,{text:w}),this._monthTextPositionControl(m,h,a,s,o)),silent:p});n.add(_)}}},t.prototype._weekTextPositionControl=function(e,t,a,n,r){var i="center",o="middle",s=e[0],l=e[1],c="start"===a;return"horizontal"===t?(s=s+n+(c?1:-1)*r[0]/2,i=c?"right":"left"):(l=l+n+(c?1:-1)*r[1]/2,o=c?"bottom":"top"),{x:s,y:l,align:i,verticalAlign:o}},t.prototype._renderWeekText=function(e,t,a,n,r){var i=e.getModel("dayLabel");if(i.get("show")){var o=e.coordinateSystem,s=i.get("position"),l=i.get("nameMap"),c=i.get("margin"),u=o.getFirstDayOfWeek();if(!l||CGe(l))l&&(t=z1e(l)||t),l=t.get(["time","dayOfWeekShort"])||yGe(t.get(["time","dayOfWeekAbbr"]),function(e){return e[0]});var d=o.getNextNDay(a.end.time,7-a.lweek).time,h=[o.getCellWidth(),o.getCellHeight()];c=RXe(c,Math.min(h[1],h[0])),"start"===s&&(d=o.getNextNDay(a.start.time,-(7+a.fweek)).time,c=-c);for(var p=i.get("silent"),f=0;f<7;f++){var m,v=o.getNextNDay(d,f),g=o.dataToCalendarLayout([v.time],!1).center;m=Math.abs((f+u)%7);var y=new PZe({z2:30,style:hGe(o1e(i,{text:l[m]}),this._weekTextPositionControl(g,n,s,c,h)),silent:p});r.add(y)}}},t.type="calendar",t}(n6e),Tyt=864e5,kyt=function(){function e(t,a,n){this.type="calendar",this.dimensions=e.dimensions,this.getDimensionsInfo=e.getDimensionsInfo,this._model=t,this._update(a,n)}return e.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},e.prototype.getRangeInfo=function(){return this._rangeInfo},e.prototype.getModel=function(){return this._model},e.prototype.getRect=function(){return this._rect},e.prototype.getCellWidth=function(){return this._sw},e.prototype.getCellHeight=function(){return this._sh},e.prototype.getOrient=function(){return this._orient},e.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},e.prototype.getDateInfo=function(e){var t=(e=HXe(e)).getFullYear(),a=e.getMonth()+1,n=a<10?"0"+a:""+a,r=e.getDate(),i=r<10?"0"+r:""+r,o=e.getDay();return{y:t+"",m:n,d:i,day:o=Math.abs((o+7-this.getFirstDayOfWeek())%7),time:e.getTime(),formatedDate:t+"-"+n+"-"+i,date:e}},e.prototype.getNextNDay=function(e,t){return 0===(t=t||0)||(e=new Date(this.getDateInfo(e).time)).setDate(e.getDate()+t),this.getDateInfo(e)},e.prototype._update=function(e,t){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var a=this._rangeInfo.weeks||1,n=["width","height"],r=this._model.getCellSize().slice(),i=this._model.getBoxLayoutParams(),o="horizontal"===this._orient?[a,7]:[7,a];gGe([0,1],function(e){c(r,e)&&(i[n[e]]=r[e]*o[e])});var s={width:t.getWidth(),height:t.getHeight()},l=this._rect=$2e(i,s);function c(e,t){return null!=e[t]&&"auto"!==e[t]}gGe([0,1],function(e){c(r,e)||(r[e]=l[n[e]]/o[e])}),this._sw=r[0],this._sh=r[1]},e.prototype.dataToPoint=function(e,t,a){a=a||[],TGe(e)&&(e=e[0]),null==t&&(t=!0);var n=this.getDateInfo(e),r=this._rangeInfo,i=n.formatedDate;if(t&&!(n.time>=r.start.time&&n.time<r.end.time+Tyt))return a[0]=a[1]=NaN,a;var o=n.day,s=this._getRangeInfo([r.start.time,i]).nthWeek;return"vertical"===this._orient?(a[0]=this._rect.x+o*this._sw+this._sw/2,a[1]=this._rect.y+s*this._sh+this._sh/2):(a[0]=this._rect.x+s*this._sw+this._sw/2,a[1]=this._rect.y+o*this._sh+this._sh/2),a},e.prototype.pointToData=function(e){var t=this.pointToDate(e);return t&&t.time},e.prototype.dataToLayout=function(e,t,a){var n=(a=a||{}).rect=a.rect||{},r=a.contentRect=a.contentRect||{},i=this.dataToPoint(e,t);return n.x=i[0]-this._sw/2,n.y=i[1]-this._sh/2,n.width=this._sw,n.height=this._sh,fqe.copy(r,n),z0e(r,this._lineWidth/2,!0,!0),a},e.prototype.dataToCalendarLayout=function(e,t){var a=this.dataToPoint(e,t);return{center:a,tl:[a[0]-this._sw/2,a[1]-this._sh/2],tr:[a[0]+this._sw/2,a[1]-this._sh/2],br:[a[0]+this._sw/2,a[1]+this._sh/2],bl:[a[0]-this._sw/2,a[1]+this._sh/2]}},e.prototype.pointToDate=function(e){var t=Math.floor((e[0]-this._rect.x)/this._sw)+1,a=Math.floor((e[1]-this._rect.y)/this._sh)+1,n=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(a,t-1,n):this._getDateByWeeksAndDay(t,a-1,n)},e.prototype.convertToPixel=function(e,t,a){var n=Cyt(t);return n===this?n.dataToPoint(a):null},e.prototype.convertToLayout=function(e,t,a){var n=Cyt(t);return n===this?n.dataToLayout(a):null},e.prototype.convertFromPixel=function(e,t,a){var n=Cyt(t);return n===this?n.pointToData(a):null},e.prototype.containPoint=function(e){return console.warn("Not implemented."),!1},e.prototype._initRangeOption=function(){var e,t=this._model.get("range");if(TGe(t)&&1===t.length&&(t=t[0]),TGe(t))e=t;else{var a=t.toString();if(/^\d{4}$/.test(a)&&(e=[a+"-01-01",a+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(a)){var n=this.getDateInfo(a),r=n.date;r.setMonth(r.getMonth()+1);var i=this.getNextNDay(r,-1);e=[n.formatedDate,i.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(a)&&(e=[a,a])}if(!e)return t;var o=this._getRangeInfo(e);return o.start.time>o.end.time&&e.reverse(),e},e.prototype._getRangeInfo=function(e){var t,a=[this.getDateInfo(e[0]),this.getDateInfo(e[1])];a[0].time>a[1].time&&(t=!0,a.reverse());var n=Math.floor(a[1].time/Tyt)-Math.floor(a[0].time/Tyt)+1,r=new Date(a[0].time),i=r.getDate(),o=a[1].date.getDate();r.setDate(i+n-1);var s=r.getDate();if(s!==o)for(var l=r.getTime()-a[1].time>0?1:-1;(s=r.getDate())!==o&&(r.getTime()-a[1].time)*l>0;)n-=l,r.setDate(s-l);var c=Math.floor((n+a[0].day+6)/7),u=t?1-c:c-1;return t&&a.reverse(),{range:[a[0].formatedDate,a[1].formatedDate],start:a[0],end:a[1],allDay:n,weeks:c,nthWeek:u,fweek:a[0].day,lweek:a[1].day}},e.prototype._getDateByWeeksAndDay=function(e,t,a){var n=this._getRangeInfo(a);if(e>n.weeks||0===e&&t<n.fweek||e===n.weeks&&t>n.lweek)return null;var r=7*(e-1)-n.fweek+t,i=new Date(n.start.time);return i.setDate(+n.start.d+r),this.getDateInfo(i)},e.create=function(t,a){var n=[];return t.eachComponent("calendar",function(r){var i=new e(r,t,a);n.push(i),r.coordinateSystem=i}),t.eachComponent(function(e,t){z2e({targetModel:t,coordSysType:"calendar",coordSysProvider:V2e})}),n},e.dimensions=["time","value"],e}();function Cyt(e){var t=e.calendarModel,a=e.seriesModel;return t?t.coordinateSystem:a?a.coordinateSystem:null}var Ayt=1,Eyt=2,Iyt=3,Ryt={none:0,all:1,body:2,corner:3};function Dyt(e,t,a){var n=t[y0e[a]].getCell(e);return!n&&EGe(e)&&e<0&&(n=t[y0e[1-a]].getUnitLayoutInfo(a,Math.round(e))),n}function Pyt(e){var t=e||[];return t[0]=t[0]||[],t[1]=t[1]||[],t[0][0]=t[0][1]=t[1][0]=t[1][1]=NaN,t}function Lyt(e,t,a,n,r){Nyt(e[0],t,r,a,n,0),Nyt(e[1],t,r,a,n,1)}function Nyt(e,t,a,n,r,i){e[0]=1/0,e[1]=-1/0;var o=n[i],s=TGe(o)?o:[o],l=s.length,c=!!a;if(l>=1?(Oyt(e,t,s,c,r,i,0),l>1&&Oyt(e,t,s,c,r,i,l-1)):e[0]=e[1]=NaN,c){var u=-r[y0e[1-i]].getLocatorCount(i),d=r[y0e[i]].getLocatorCount(i)-1;a===Ryt.body?u=AXe(0,u):a===Ryt.corner&&(d=CXe(-1,d)),d<u&&(u=d=NaN),NGe(e[0])&&(e[0]=u),NGe(e[1])&&(e[1]=d),e[0]=AXe(CXe(e[0],d),u),e[1]=AXe(CXe(e[1],d),u)}}function Oyt(e,t,a,n,r,i,o){var s=Dyt(a[o],r,i);if(s){var l,c=s.id[y0e[i]],u=c,d=!(l=s)||l.type!==Eyt&&l.type!==Iyt?null:l;d&&(u+=d.span[y0e[i]]-1),e[0]=CXe(e[0],c,u),e[1]=AXe(e[1],c,u)}else e[0]=e[1]=NaN}function Fyt(e,t){return NGe(e[t][0])||NGe(e[t][1])}function Byt(e,t,a,n){t=t||Uyt;for(var r=0;r<n;r++)t[r]=!1;for(;;){var i=!1;for(r=0;r<n;r++){var o=a[r];!t[r]&&o.cellMergeOwner&&zyt(e,o.locatorRange)&&(t[r]=!0,i=!0)}if(!i)break}}var Uyt=[];function zyt(e,t){return!(!Vyt(e[0],t[0])||!Vyt(e[1],t[1]))&&(e[0][0]=CXe(e[0][0],t[0][0]),e[0][1]=AXe(e[0][1],t[0][1]),e[1][0]=CXe(e[1][0],t[1][0]),e[1][1]=AXe(e[1][1],t[1][1]),!0)}function Vyt(e,t){return e[1]>=t[0]&&e[0]<=t[1]}function Hyt(e,t){e.id.set(t[0][0],t[1][0]),e.span.set(t[0][1]-e.id.x+1,t[1][1]-e.id.y+1)}function Gyt(e,t,a,n){var r=Dyt(t[n][0],a,n),i=Dyt(t[n][1],a,n);e[y0e[n]]=e[b0e[n]]=NaN,r&&i&&(e[y0e[n]]=r.xy,e[b0e[n]]=i.xy+i.wh-r.xy)}function Wyt(e,t,a,n){return e[y0e[t]]=a,e[y0e[1-t]]=n,e}var qyt=function(){function e(e,t){this._cells=[],this._levels=[],this.dim=e,this.dimIdx="x"===e?0:1,this._model=t,this._uniqueValueGen=function(e){var t=e.toUpperCase(),a=new RegExp("^"+t+"([0-9]+)$"),n=0;function r(e){var t;null!=e&&(t=e.match(a))&&(n=AXe(n,+t[1]+1))}function i(){return""+t+n++}function o(e,t){for(var a=$Ge(),n=0;n<e.length;n++){var r=e[n];null!=r&&null==a.get(r)||(e[n]=r=i(),t[n].option=pGe({value:r},t[n].option)),a.set(r,!0)}}return{calcDupBase:r,ensureValueUnique:o}}(e);var a=t.get("data",!0);null==a||TGe(a)||(a=[]),a?this._initByDimModelData(a):this._initBySeriesData()}return e.prototype._initByDimModelData=function(e){var t=this,a=t._cells,n=t._levels,r=[],i=0;return t._leavesCount=function e(a,o,s){var l=0;if(!a)return l;return gGe(a,function(a,c){var u;CGe(a)?u={value:a}:IGe(a)?(u=a,null==a.value||CGe(a.value)||(u={value:null})):u={value:null};var d={type:Iyt,ordinal:NaN,level:s,firstLeafLocator:o,id:new eqe,span:Wyt(new eqe,t.dimIdx,1,1),option:u,xy:NaN,wh:NaN,dim:t,rect:{x:NaN,y:NaN,width:NaN,height:NaN}};i++,(r[o]||(r[o]=[])).push(d),n[s]||(n[s]={type:Ayt,xy:NaN,wh:NaN,option:null,id:new eqe,dim:t});var h=e(u.children,o,s+1),p=Math.max(1,h);d.span[y0e[t.dimIdx]]=p,l+=p,o+=p}),l}(e,0,0),void function(){var e=[];for(;a.length<i;)for(var n=0;n<r.length;n++){var o=r[n].pop();if(o){o.ordinal=e.length;var s=o.option.value;e.push(s),a.push(o),t._uniqueValueGen.calcDupBase(s)}}t._uniqueValueGen.ensureValueUnique(e,a);var l=t._ordinalMeta=new J9e({categories:e,needCollect:!1,deduplication:!1});t._scale=new eet({ordinalMeta:l});for(var c=0;c<t._leavesCount;c++){var u=t._cells[c];u.type=Eyt,u.span[y0e[1-t.dimIdx]]=t._levels.length-u.level}t._initCellsId(),t._initLevelIdOptions()}()},e.prototype._initBySeriesData=function(){var e=this;e._leavesCount=0,e._levels=[{type:Ayt,xy:NaN,wh:NaN,option:null,id:new eqe,dim:e}],e._initLevelIdOptions();var t=e._ordinalMeta=new J9e({needCollect:!0,deduplication:!0,onCollect:function(t,a){var n=e._cells[a]={type:Eyt,ordinal:a,level:0,firstLeafLocator:a,id:new eqe,span:Wyt(new eqe,e.dimIdx,1,1),option:{value:t+""},xy:NaN,wh:NaN,dim:e,rect:{x:NaN,y:NaN,width:NaN,height:NaN}};e._leavesCount++,e._setCellId(n)}});e._scale=new eet({ordinalMeta:t})},e.prototype._setCellId=function(e){var t=this._levels.length,a=this.dimIdx;Wyt(e.id,a,e.firstLeafLocator,e.level-t)},e.prototype._initCellsId=function(){var e=this._levels.length,t=this.dimIdx;gGe(this._cells,function(a){Wyt(a.id,t,a.firstLeafLocator,a.level-e)})},e.prototype._initLevelIdOptions=function(){var e=this._levels.length,t=this.dimIdx,a=this._model.get("levels",!0);a=TGe(a)?a:[],gGe(this._levels,function(n,r){Wyt(n.id,t,0,r-e),n.option=a[r]})},e.prototype.shouldShow=function(){return!!this._model.getShallow("show",!0)},e.prototype.resetLayoutIterator=function(e,t,a,n){if(e=e||new k$e,t===this.dimIdx){var r=this._leavesCount,i=null!=a?Math.max(0,a):0;n=null!=n?Math.min(n,r):r,e.reset(this._cells,i,i+n)}else{r=this._levels.length,i=null!=a?Math.max(0,a+r):0;n=null!=n?Math.min(n,r):r,e.reset(this._levels,i,i+n)}return e},e.prototype.resetCellIterator=function(e){return(e||new k$e).reset(this._cells,0)},e.prototype.resetLevelIterator=function(e){return(e||new k$e).reset(this._levels,0)},e.prototype.getLayout=function(e,t,a){var n=this.getUnitLayoutInfo(t,a);e[y0e[t]]=n?n.xy:NaN,e[b0e[t]]=n?n.wh:NaN},e.prototype.getUnitLayoutInfo=function(e,t){return e===this.dimIdx?t<this._leavesCount?this._cells[t]:void 0:this._levels[t+this._levels.length]},e.prototype.getCell=function(e){var t=this._scale.parse(e);return NGe(t)?void 0:this._cells[t]},e.prototype.getLocatorCount=function(e){return e===this.dimIdx?this._leavesCount:this._levels.length},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e}();var Yyt=function(){function e(e,t,a){this._model=t,this._dims=a,this._kind=e,this._cellMergeOwnerList=[]}return e.prototype._ensureCellMap=function(){var e=this,t=e._cellMap;return t||(t=e._cellMap=$Ge(),function(){var t=[],n=e._model.getShallow("data");n&&!TGe(n)&&(n=null);gGe(n,function(a,n){if(IGe(a)&&TGe(a.coord)){var r=Pyt([]);if(Lyt(r,null,a.coord,e._dims,a.coordClamp?Ryt[e._kind]:Ryt.none),!Fyt(r,0)&&!Fyt(r,1)){var i=a&&a.mergeCells,o={id:new eqe,span:new eqe,locatorRange:r,option:a,cellMergeOwner:i};Hyt(o,r),t.push(o)}}});for(var r=[],i=0;i<t.length;i++){var o=t[i];if(o.cellMergeOwner){var s=o.locatorRange;Byt(s,r,t,i);for(var l=0;l<i;l++)r[l]&&(t[l].cellMergeOwner=!1);if(s[0][0]!==o.id.x||s[1][0]!==o.id.y){o.cellMergeOwner=!1;var c=hGe({},o.option);c.coord=null;var u={id:new eqe,span:new eqe,locatorRange:s,option:c,cellMergeOwner:!0};Hyt(u,s),t.push(u)}}}gGe(t,function(t){var n=a(t.id.x,t.id.y);if(t.cellMergeOwner&&(n.cellMergeOwner=!0,n.span=t.span,n.locatorRange=t.locatorRange,n.spanRect={x:NaN,y:NaN,width:NaN,height:NaN},e._cellMergeOwnerList.push(n)),t.cellMergeOwner||t.option)for(var r=0;r<t.span.y;r++)for(var i=0;i<t.span.x;i++){var o=a(t.id.x+i,t.id.y+r);o.option=t.option,t.cellMergeOwner&&(o.inSpanOf=n)}})}()),t;function a(e,a){var n=Xyt(e,a),r=t.get(n);return r||(r=t.set(n,{id:new eqe(e,a),option:null,inSpanOf:null,span:null,spanRect:null,locatorRange:null,cellMergeOwner:!1})),r}},e.prototype.getCell=function(e){return this._ensureCellMap().get(Xyt(e[0],e[1]))},e.prototype.travelExistingCells=function(e){this._ensureCellMap().each(e)},e.prototype.expandRangeByCellMerge=function(e){if(!Fyt(e,0)&&!Fyt(e,1)&&e[0][0]===e[0][1]&&e[1][0]===e[1][1]){jyt[0]=e[0][0],jyt[1]=e[1][0];var t=this.getCell(jyt),a=t&&t.inSpanOf;if(a)return void function(e,t){e[0][0]=t[0][0],e[0][1]=t[0][1],e[1][0]=t[1][0],e[1][1]=t[1][1]}(e,a.locatorRange)}var n=this._cellMergeOwnerList;Byt(e,null,n,n.length)},e}(),jyt=[];function Xyt(e,t){return e+"|"+t}var $yt={show:!0,color:o5e.color.secondary,overflow:"break",lineOverflow:"truncate",padding:[2,3,2,3],distance:0};function Kyt(e){return{color:"none",borderWidth:1,borderColor:e?"none":o5e.color.borderTint}}var Zyt={show:!0,label:$yt,itemStyle:Kyt(!1),silent:void 0,dividerLineStyle:{width:1,color:o5e.color.border}},Jyt={z:-50,left:"10%",top:"10%",right:"10%",bottom:"10%",x:Zyt,y:Zyt,body:{label:$yt,itemStyle:Kyt(!1),silent:void 0},corner:{label:$yt,itemStyle:Kyt(!0),silent:void 0},backgroundStyle:{color:"none",borderColor:o5e.color.axisLine,borderWidth:1}},Qyt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.optionUpdated=function(){var e=this._dimModels={x:new ebt(this.get("x",!0)||{}),y:new ebt(this.get("y",!0)||{})};e.x.option.type=e.y.option.type="category";var t={x:e.x.dim=new qyt("x",e.x),y:e.y.dim=new qyt("y",e.y)};this._body=new Yyt("body",new E1e(this.getShallow("body")),t),this._corner=new Yyt("corner",new E1e(this.getShallow("corner")),t)},t.prototype.getDimensionModel=function(e){return this._dimModels[e]},t.prototype.getBody=function(){return this._body},t.prototype.getCorner=function(){return this._corner},t.type="matrix",t.layoutMode="box",t.defaultOption=Jyt,t}(i5e),ebt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.getOrdinalMeta=function(){return this.dim.getOrdinalMeta()},t}(E1e),tbt=Math.round,abt={normal:25,special:100},nbt={normal:50,special:125},rbt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t){this.group.removeAll();var a=this.group,n=e.coordinateSystem.getRect(),r=e.getDimensionModel("x"),i=e.getDimensionModel("y"),o=r.dim,s=i.dim;!function(e,t,a){function n(n){var r=t.getDimensionModel(y0e[n]),i=r.dim;if(i.shouldShow())for(var o=r.getModel("itemStyle"),s=r.getModel("label"),l=t.getShallow("tooltip",!0),c=[],u=i.resetCellIterator();u.next();){var d=u.item,h={};fqe.copy(h,d.rect),iWe(c,d.id.x,d.id.y),ibt(c,t,e,a,d.option,o,s,r,h,d.option.value,nbt,l)}}n(0),n(1)}(a,e,t),function(e,t,a,n,r){i("body",t.getBody(),a,n),a.shouldShow()&&n.shouldShow()&&i("corner",t.getCorner(),n,a);function i(a,n,i,o){var s=new E1e(t.getShallow(a,!0)),l=s.getModel("itemStyle"),c=s.getModel("label"),u=new k$e,d=new k$e,h=[],p=t.getShallow("tooltip",!0);for(o.resetLayoutIterator(d,1);d.next();)for(i.resetLayoutIterator(u,0);u.next();){var f=u.item,m=d.item;iWe(h,f.id.x,m.id.y);var v=n.getCell(h);if(!v||!v.inSpanOf||v.inSpanOf===v){var g={};v&&v.span?fqe.copy(g,v.spanRect):(f.dim.getLayout(g,0,h[0]),m.dim.getLayout(g,1,h[1]));var y=v?v.option:null;ibt(h,t,e,r,y,l,c,s,g,y?y.value:null,abt,p)}}}}(a,e,o,s,t);var l=FGe(e.getShallow("borderZ2",!0),99),c=l-1,u=e.getModel("backgroundStyle").getItemStyle(["borderWidth"]);u.lineWidth=0;var d=e.getModel("backgroundStyle").getItemStyle(["color","decal","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]);d.fill="none";var h=ubt(n.clone(),u,0),p=ubt(n.clone(),d,l);h.silent=!0,p.silent=!0,a.add(h),a.add(p);var f=o.getUnitLayoutInfo(0,0),m=s.getUnitLayoutInfo(1,0);f&&m&&(o.shouldShow()&&a.add(dbt({x1:n.x,y1:m.xy,x2:n.x+n.width,y2:m.xy},r.getModel("dividerLineStyle").getLineStyle(),c)),s.shouldShow()&&a.add(dbt({x1:f.xy,y1:n.y,x2:f.xy,y2:n.y+n.height},i.getModel("dividerLineStyle").getLineStyle(),c)))},t.type="matrix",t}(n6e);function ibt(e,t,a,n,r,i,o,s,l,c,u,d){var h;sbt.option=r?r.itemStyle:null,sbt.parentModel=i,obt.option=r,obt.parentModel=s;var p=FGe(obt.getShallow("z2"),r&&r.itemStyle?u.special:u.normal),f=d&&d.show,m=ubt(l,sbt.getItemStyle(),p);a.add(m);var v,g=obt.get("cursor");if(null!=g&&m.attr("cursor",g),null!=c){var y=c+"";if(lbt.option=r?r.label:null,lbt.parentModel=o,lbt.ecModel=n,r1e(m,{normal:lbt},{defaultText:y,autoOverflowArea:!0,layoutRect:cGe(m.shape)}),v=m.getTextContent()){v.z2=p+1;var b=v.style;if(b&&b.overflow&&"none"!==b.overflow&&b.lineOverflow){var x={};fqe.copy(x,l),z0e(x,((null===(h=m.style)||void 0===h?void 0:h.lineWidth)||0)/2,!0,!0),m.updateInnerText(),v.getLocalTransform(cbt),QWe(cbt,cbt),fqe.applyTransform(x,x,cbt),v.setClipPath(new EZe({shape:x}))}}G0e({el:m,componentModel:t,itemName:y,itemTooltipOption:d,formatterParamsExtra:{xyLocator:e.slice()}})}if(v){var w=lbt.get("silent");null==w&&(w=!f),v.silent=w,v.ignoreHostSilent=!0}var _=obt.get("silent");null==_&&(_=!m.style||"none"===m.style.fill||!m.style.fill),m.silent=_,C$e(obt),C$e(sbt),C$e(lbt)}var obt=new E1e,sbt=new E1e,lbt=new E1e,cbt=[];function ubt(e,t,a){var n=t.lineWidth;if(n){var r=e.x+e.width,i=e.y+e.height;e.x=kZe(e.x,n,!0),e.y=kZe(e.y,n,!0),e.width=kZe(r,n,!0)-e.x,e.height=kZe(i,n,!0)-e.y}return new EZe({shape:e,style:t,z2:a})}function dbt(e,t,a){var n=t.lineWidth;return n&&(tbt(2*e.x1)===tbt(2*e.x2)&&(e.x1=e.x2=kZe(e.x1,n,!0)),tbt(2*e.y1)===tbt(2*e.y2)&&(e.y1=e.y2=kZe(e.y1,n,!0))),new UQe({shape:e,style:t,silent:!0,z2:a})}var hbt=function(){function e(t,a,n){this.dimensions=e.dimensions,this.type="matrix",this._model=t;var r=this._dimModels={x:t.getDimensionModel("x"),y:t.getDimensionModel("y")};this._dims={x:r.x.dim,y:r.y.dim},this._resize(t,n)}return e.getDimensionsInfo=function(){return[{name:"x",type:"ordinal"},{name:"y",type:"ordinal"},{name:"value"}]},e.create=function(t,a){var n=[];return t.eachComponent("matrix",function(r){var i=new e(r,t,a);n.push(i),r.coordinateSystem=i}),t.eachComponent(function(e,t){z2e({targetModel:t,coordSysType:"matrix",coordSysProvider:V2e})}),n},e.prototype.getRect=function(){return this._rect},e.prototype._resize=function(e,t){var a=this._dims,n=this._dimModels,r=this._rect=$2e(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()});vbt(n,a,r,0),vbt(n,a,r,1),gbt(0,a),gbt(1,a),ybt(this._model.getBody(),a),ybt(this._model.getCorner(),a)},e.prototype.dataToPoint=function(e,t,a){return a=a||[],this.dataToLayout(e,t,pbt),a[0]=pbt.rect.x+pbt.rect.width/2,a[1]=pbt.rect.y+pbt.rect.height/2,a},e.prototype.dataToLayout=function(e,t,a){var n=this._dims,r=(a=a||{}).rect=a.rect||{};r.x=r.y=r.width=r.height=NaN;var i=a.matrixXYLocatorRange=Pyt(a.matrixXYLocatorRange);return TGe(e)?(Lyt(i,null,e,n,FGe(t&&t.clamp,Ryt.none)),t&&t.ignoreMergeCells||(t&&t.clamp===Ryt.corner||this._model.getBody().expandRangeByCellMerge(i),t&&t.clamp===Ryt.body||this._model.getCorner().expandRangeByCellMerge(i)),Gyt(r,i,n,0),Gyt(r,i,n,1),a):a},e.prototype.pointToData=function(e,t,a){var n=this._dims;return Mbt(Sbt,0,n,e,t&&t.clamp),Mbt(Sbt,1,n,e,t&&t.clamp),(a=a||[])[0]=a[1]=NaN,Sbt.y===_bt.inCorner&&Sbt.x===_bt.inBody?Tbt(Sbt,a,0,n):Sbt.x===_bt.inCorner&&Sbt.y===_bt.inBody?Tbt(Sbt,a,1,n):(kbt(Sbt,a,0,n),kbt(Sbt,a,1,n)),a},e.prototype.convertToPixel=function(e,t,a,n){var r=wbt(t);return r===this?r.dataToPoint(a,n):void 0},e.prototype.convertToLayout=function(e,t,a,n){var r=wbt(t);return r===this?r.dataToLayout(a,n):void 0},e.prototype.convertFromPixel=function(e,t,a,n){var r=wbt(t);return r===this?r.pointToData(a,n):void 0},e.prototype.containPoint=function(e){return this._rect.contain(e[0],e[1])},e.dimensions=["x","y","value"],e}(),pbt={rect:{x:NaN,y:NaN,width:NaN,height:NaN}},fbt=new k$e,mbt=new k$e;function vbt(e,t,a,n){for(var r=1-n,i=t[y0e[n]],o=t[y0e[r]],s=o.shouldShow(),l=i.resetCellIterator();l.next();)l.item.wh=l.item.xy=NaN;for(var c=o.resetLayoutIterator(null,n);c.next();)c.item.wh=c.item.xy=NaN;for(var u=a[b0e[n]],d=i.getLocatorCount(n)+o.getLocatorCount(n),h=new E1e,p=o.resetLevelIterator();p.next();)h.option=p.item.option,h.parentModel=e[y0e[r]],v(p.item,s?h.get("levelSize"):0);for(var f=new E1e,m=i.resetCellIterator();m.next();)m.item.type===Eyt&&(f.option=m.item.option,f.parentModel=void 0,v(m.item,f.get("size")));function v(e,t){var r=function(e,t,a){var n=DXe(e,a[b0e[t]]);return xbt(n,a[b0e[t]])}(t,n,a);NGe(r)||(e.wh=xbt(r,u),u=xbt(u-e.wh),d--)}var g=d?u/d:0,y=!d&&u>=1,b=a[y0e[n]],x=i.getLocatorCount(n)-1,w=new k$e;for(o.resetLayoutIterator(w,n);w.next();)_(w.item);for(i.resetLayoutIterator(w,n);w.next();)_(w.item);function _(e){NGe(e.wh)&&(e.wh=g),e.xy=b,e.id[y0e[n]]!==x||y||(e.wh=a[y0e[n]]+a[b0e[n]]-e.xy),b+=e.wh}}function gbt(e,t){for(var a=t[y0e[e]].resetCellIterator();a.next();){var n=a.item;bbt(n.rect,e,n.id,n.span,t),bbt(n.rect,1-e,n.id,n.span,t),n.type===Iyt&&(n.xy=n.rect[y0e[e]],n.wh=n.rect[b0e[e]])}}function ybt(e,t){e.travelExistingCells(function(e){var a=e.span;if(a){var n=e.spanRect,r=e.id;bbt(n,0,r,a,t),bbt(n,1,r,a,t)}})}function bbt(e,t,a,n,r){e[b0e[t]]=0;var i=a[y0e[t]]<0?r[y0e[1-t]]:r[y0e[t]],o=i.getUnitLayoutInfo(t,a[y0e[t]]);if(e[y0e[t]]=o.xy,e[b0e[t]]=o.wh,n[y0e[t]]>1){var s=i.getUnitLayoutInfo(t,a[y0e[t]]+n[y0e[t]]-1);e[b0e[t]]=s.xy+s.wh-o.xy}}function xbt(e,t){return Math.max(Math.min(e,FGe(t,1/0)),0)}function wbt(e){var t=e.matrixModel,a=e.seriesModel;return t?t.coordinateSystem:a?a.coordinateSystem:null}var _bt={inBody:1,inCorner:2,outside:3},Sbt={x:null,y:null,point:[]};function Mbt(e,t,a,n,r){var i=a[y0e[t]],o=a[y0e[1-t]],s=i.getUnitLayoutInfo(t,i.getLocatorCount(t)-1),l=i.getUnitLayoutInfo(t,0),c=o.getUnitLayoutInfo(t,-o.getLocatorCount(t)),u=o.shouldShow()?o.getUnitLayoutInfo(t,-1):null,d=e.point[t]=n[t];if(l||u)if(r!==Ryt.body)if(r!==Ryt.corner){var h=l?l.xy:u?u.xy+u.wh:NaN,p=c?c.xy:h,f=s?s.xy+s.wh:h;if(d<p){if(!r)return void(e[y0e[t]]=_bt.outside);d=p}else if(d>f){if(!r)return void(e[y0e[t]]=_bt.outside);d=f}e.point[t]=d,e[y0e[t]]=h<=d&&d<=f?_bt.inBody:p<=d&&d<=h?_bt.inCorner:_bt.outside}else u?(e[y0e[t]]=_bt.inCorner,d=CXe(u.xy+u.wh,AXe(c.xy,d)),e.point[t]=d):e[y0e[t]]=_bt.outside;else l?(e[y0e[t]]=_bt.inBody,d=CXe(s.xy+s.wh,AXe(l.xy,d)),e.point[t]=d):e[y0e[t]]=_bt.outside;else e[y0e[t]]=_bt.outside}function Tbt(e,t,a,n){var r=1-a;if(e[y0e[a]]!==_bt.outside)for(n[y0e[a]].resetCellIterator(mbt);mbt.next();){var i=mbt.item;if(Abt(e.point[a],i.rect,a)&&Abt(e.point[r],i.rect,r))return t[a]=i.ordinal,void(t[r]=i.id[y0e[r]])}}function kbt(e,t,a,n){if(e[y0e[a]]!==_bt.outside)for((e[y0e[a]]===_bt.inCorner?n[y0e[1-a]]:n[y0e[a]]).resetLayoutIterator(fbt,a);fbt.next();)if(Cbt(e.point[a],fbt.item))return void(t[a]=fbt.item.id[y0e[a]])}function Cbt(e,t){return t.xy<=e&&e<=t.xy+t.wh}function Abt(e,t,a){return t[y0e[a]]<=e&&e<=t[y0e[a]]+t[b0e[a]]}function Ebt(e,t){var a;return gGe(t,function(t){null!=e[t]&&"auto"!==e[t]&&(a=!0)}),a}var Ibt=["transition","enterFrom","leaveTo"],Rbt=Ibt.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function Dbt(e,t,a){if(a&&(!e[a]&&t[a]&&(e[a]={}),e=e[a],t=t[a]),e&&t)for(var n=a?Ibt:Rbt,r=0;r<n.length;r++){var i=n[r];null==e[i]&&null!=t[i]&&(e[i]=t[i])}}var Pbt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.preventAutoZ=!0,a}return zHe(t,e),t.prototype.mergeOption=function(t,a){var n=this.option.elements;this.option.elements=null,e.prototype.mergeOption.call(this,t,a),this.option.elements=n},t.prototype.optionUpdated=function(e,t){var a=this.option,n=(t?a:e).elements,r=a.elements=t?[]:a.elements,i=[];this._flatten(n,i,null);var o=c$e(r,i,"normalMerge"),s=this._elOptionsToUpdate=[];gGe(o,function(e,t){var a=e.newOption;a&&(s.push(a),function(e,t){var a=e.existing;if(t.id=e.keyInfo.id,!t.type&&a&&(t.type=a.type),null==t.parentId){var n=t.parentOption;n?t.parentId=n.id:a&&(t.parentId=a.parentId)}t.parentOption=null}(e,a),function(e,t,a){var n=hGe({},a),r=e[t],i=a.$action||"merge";"merge"===i?r?(uGe(r,n,!0),t5e(r,n,{ignoreSize:!0}),n5e(a,r),Dbt(a,r),Dbt(a,r,"shape"),Dbt(a,r,"style"),Dbt(a,r,"extra"),a.clipPath=r.clipPath):e[t]=n:"replace"===i?e[t]=n:"remove"===i&&r&&(e[t]=null)}(r,t,a),function(e,t){if(e&&(e.hv=t.hv=[Ebt(t,["left","right"]),Ebt(t,["top","bottom"])],"group"===e.type)){var a=e,n=t;null==a.width&&(a.width=n.width=0),null==a.height&&(a.height=n.height=0)}}(r[t],a))},this),a.elements=xGe(r,function(e){return e&&delete e.$action,null!=e})},t.prototype._flatten=function(e,t,a){gGe(e,function(e){if(e){a&&(e.parentOption=a),t.push(e);var n=e.children;n&&n.length&&this._flatten(n,t,e),delete e.children}},this)},t.prototype.useElOptionsToUpdate=function(){var e=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,e},t.type="graphic",t.defaultOption={elements:[]},t}(i5e),Lbt={path:null,compoundPath:null,group:xXe,image:_Ze,text:PZe},Nbt=v$e(),Obt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(){this._elMap=$Ge()},t.prototype.render=function(e,t,a){e!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=e,this._updateElements(e),this._relocate(e,a)},t.prototype._updateElements=function(e){var t=e.useElOptionsToUpdate();if(t){var a=this._elMap,n=this.group,r=e.get("z"),i=e.get("zlevel");gGe(t,function(t){var o=h$e(t.id,null),s=null!=o?a.get(o):null,l=h$e(t.parentId,null),c=null!=l?a.get(l):n,u=t.type,d=t.style;"text"===u&&d&&t.hv&&t.hv[1]&&(d.textVerticalAlign=d.textBaseline=d.verticalAlign=d.align=null);var h=t.textContent,p=t.textConfig;if(d&&Wmt(d,u,!!p,!!h)){var f=qmt(d,u,!0);!p&&f.textConfig&&(p=t.textConfig=f.textConfig),!h&&f.textContent&&(h=f.textContent)}var m=function(e){return e=hGe({},e),gGe(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(G2e),function(t){delete e[t]}),e}(t),v=t.$action||"merge",g="merge"===v,y="replace"===v;if(g){var b=s;(k=!s)?b=Bbt(o,c,t.type,a):(b&&(Nbt(b).isNew=!1),hvt(b)),b&&(evt(b,m,e,{isInit:k}),zbt(b,t,r,i))}else if(y){Ubt(s,t,a,e);var x=Bbt(o,c,t.type,a);x&&(evt(x,m,e,{isInit:!0}),zbt(x,t,r,i))}else"remove"===v&&(tvt(s,t),Ubt(s,t,a,e));var w=a.get(o);if(w&&h)if(g){var _=w.getTextContent();_?_.attr(h):w.setTextContent(new PZe(h))}else y&&w.setTextContent(new PZe(h));if(w){var S=t.clipPath;if(S){var M=S.type,T=void 0,k=!1;if(g){var C=w.getClipPath();T=(k=!C||Nbt(C).type!==M)?Fbt(M):C}else y&&(k=!0,T=Fbt(M));w.setClipPath(T),evt(T,S,e,{isInit:k}),pvt(T,S.keyframeAnimation,e)}var A=Nbt(w);w.setTextConfig(p),A.option=t,function(e,t,a){var n=YZe(e).eventData;e.silent||e.ignore||n||(n=YZe(e).eventData={componentType:"graphic",componentIndex:t.componentIndex,name:e.name});n&&(n.info=a.info)}(w,e,t),G0e({el:w,componentModel:e,itemName:w.name,itemTooltipOption:t.tooltip}),pvt(w,t.keyframeAnimation,e)}})}},t.prototype._relocate=function(e,t){for(var a=e.option.elements,n=this.group,r=this._elMap,i=t.getWidth(),o=t.getHeight(),s=["x","y"],l=0;l<a.length;l++){if((f=null!=(p=h$e((h=a[l]).id,null))?r.get(p):null)&&f.isGroup){var c=(m=f.parent)===n,u=Nbt(f),d=Nbt(m);u.width=RXe(u.option.width,c?i:d.width)||0,u.height=RXe(u.option.height,c?o:d.height)||0}}for(l=a.length-1;l>=0;l--){var h,p,f;if(f=null!=(p=h$e((h=a[l]).id,null))?r.get(p):null){var m=f.parent,v=(d=Nbt(m),{}),g=Q2e(f,h,m===n?{width:i,height:o}:{width:d.width,height:d.height},null,{hv:h.hv,boundingMode:h.bounding},v);if(!Nbt(f).isNew&&g){for(var y=h.transition,b={},x=0;x<s.length;x++){var w=s[x],_=v[w];y&&(nvt(y)||fGe(y,w)>=0)?b[w]=_:f[w]=_}u0e(f,b,e,0)}else f.attr(v)}}},t.prototype._clear=function(){var e=this,t=this._elMap;t.each(function(a){Ubt(a,Nbt(a).option,t,e._lastGraphicModel)}),this._elMap=$Ge()},t.prototype.dispose=function(){this._clear()},t.type="graphic",t}(n6e);function Fbt(e){var t=new(QGe(Lbt,e)?Lbt[e]:_0e(e))({});return Nbt(t).type=e,t}function Bbt(e,t,a,n){var r=Fbt(a);return t.add(r),n.set(e,r),Nbt(r).id=e,Nbt(r).isNew=!0,r}function Ubt(e,t,a,n){e&&e.parent&&("group"===e.type&&e.traverse(function(e){Ubt(e,t,a,n)}),avt(e,t,n),a.removeKey(Nbt(e).id))}function zbt(e,t,a,n){e.isGroup||gGe([["cursor",fKe.prototype.cursor],["zlevel",n||0],["z",a||0],["z2",0]],function(a){var n=a[0];QGe(t,n)?e[n]=FGe(t[n],a[1]):null==e[n]&&(e[n]=a[1])}),gGe(_Ge(t),function(a){if(0===a.indexOf("on")){var n=t[a];e[a]=kGe(n)?n:null}}),QGe(t,"draggable")&&(e.draggable=t.draggable),null!=t.name&&(e.name=t.name),null!=t.id&&(e.id=t.id)}var Vbt=["x","y","radius","angle","single"],Hbt=["cartesian2d","polar","singleAxis"];function Gbt(e){return e+"Axis"}function Wbt(e,t){var a,n=$Ge(),r=[],i=$Ge();e.eachComponent({mainType:"dataZoom",query:t},function(e){i.get(e.uid)||s(e)});do{a=!1,e.eachComponent("dataZoom",o)}while(a);function o(e){!i.get(e.uid)&&function(e){var t=!1;return e.eachTargetAxis(function(e,a){var r=n.get(e);r&&r[a]&&(t=!0)}),t}(e)&&(s(e),a=!0)}function s(e){i.set(e.uid,!0),r.push(e),e.eachTargetAxis(function(e,t){(n.get(e)||n.set(e,[]))[t]=!0})}return r}function qbt(e){var t=e.ecModel,a={infoList:[],infoMap:$Ge()};return e.eachTargetAxis(function(e,n){var r=t.getComponent(Gbt(e),n);if(r){var i=r.getCoordSysModel();if(i){var o=i.uid,s=a.infoMap.get(o);s||(s={model:i,axisModels:[]},a.infoList.push(s),a.infoMap.set(o,s)),s.axisModels.push(r)}}}),a}var Ybt=function(){function e(){this.indexList=[],this.indexMap=[]}return e.prototype.add=function(e){this.indexMap[e]||(this.indexList.push(e),this.indexMap[e]=!0)},e}(),jbt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._autoThrottle=!0,a._noTarget=!0,a._rangePropMode=["percent","percent"],a}return zHe(t,e),t.prototype.init=function(e,t,a){var n=Xbt(e);this.settledOption=n,this.mergeDefaultAndTheme(e,a),this._doInit(n)},t.prototype.mergeOption=function(e){var t=Xbt(e);uGe(this.option,e,!0),uGe(this.settledOption,t,!0),this._doInit(t)},t.prototype._doInit=function(e){var t=this.option;this._setDefaultThrottle(e),this._updateRangeUse(e);var a=this.settledOption;gGe([["start","startValue"],["end","endValue"]],function(e,n){"value"===this._rangePropMode[n]&&(t[e[0]]=a[e[0]]=null)},this),this._resetTarget()},t.prototype._resetTarget=function(){var e=this.get("orient",!0),t=this._targetAxisInfoMap=$Ge();this._fillSpecifiedTargetAxis(t)?this._orient=e||this._makeAutoOrientByTargetAxis():(this._orient=e||"horizontal",this._fillAutoTargetAxisByOrient(t,this._orient)),this._noTarget=!0,t.each(function(e){e.indexList.length&&(this._noTarget=!1)},this)},t.prototype._fillSpecifiedTargetAxis=function(e){var t=!1;return gGe(Vbt,function(a){var n=this.getReferringComponents(Gbt(a),w$e);if(n.specified){t=!0;var r=new Ybt;gGe(n.models,function(e){r.add(e.componentIndex)}),e.set(a,r)}},this),t},t.prototype._fillAutoTargetAxisByOrient=function(e,t){var a=this.ecModel,n=!0;if(n){var r="vertical"===t?"y":"x";i(a.findComponents({mainType:r+"Axis"}),r)}n&&i(a.findComponents({mainType:"singleAxis",filter:function(e){return e.get("orient",!0)===t}}),"single");function i(t,a){var r=t[0];if(r){var i=new Ybt;if(i.add(r.componentIndex),e.set(a,i),n=!1,"x"===a||"y"===a){var o=r.getReferringComponents("grid",x$e).models[0];o&&gGe(t,function(e){r.componentIndex!==e.componentIndex&&o===e.getReferringComponents("grid",x$e).models[0]&&i.add(e.componentIndex)})}}}n&&gGe(Vbt,function(t){if(n){var r=a.findComponents({mainType:Gbt(t),filter:function(e){return"category"===e.get("type",!0)}});if(r[0]){var i=new Ybt;i.add(r[0].componentIndex),e.set(t,i),n=!1}}},this)},t.prototype._makeAutoOrientByTargetAxis=function(){var e;return this.eachTargetAxis(function(t){!e&&(e=t)},this),"y"===e?"vertical":"horizontal"},t.prototype._setDefaultThrottle=function(e){if(e.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var t=this.ecModel.option;this.option.throttle=t.animation&&t.animationDurationUpdate>0?100:20}},t.prototype._updateRangeUse=function(e){var t=this._rangePropMode,a=this.get("rangeMode");gGe([["start","startValue"],["end","endValue"]],function(n,r){var i=null!=e[n[0]],o=null!=e[n[1]];i&&!o?t[r]="percent":!i&&o?t[r]="value":a?t[r]=a[r]:i&&(t[r]="percent")})},t.prototype.noTarget=function(){return this._noTarget},t.prototype.getFirstTargetAxisModel=function(){var e;return this.eachTargetAxis(function(t,a){null==e&&(e=this.ecModel.getComponent(Gbt(t),a))},this),e},t.prototype.eachTargetAxis=function(e,t){this._targetAxisInfoMap.each(function(a,n){gGe(a.indexList,function(a){e.call(t,n,a)})})},t.prototype.getAxisProxy=function(e,t){var a=this.getAxisModel(e,t);if(a)return a.__dzAxisProxy},t.prototype.getAxisModel=function(e,t){var a=this._targetAxisInfoMap.get(e);if(a&&a.indexMap[t])return this.ecModel.getComponent(Gbt(e),t)},t.prototype.setRawRange=function(e){var t=this.option,a=this.settledOption;gGe([["start","startValue"],["end","endValue"]],function(n){null==e[n[0]]&&null==e[n[1]]||(t[n[0]]=a[n[0]]=e[n[0]],t[n[1]]=a[n[1]]=e[n[1]])},this),this._updateRangeUse(e)},t.prototype.setCalculatedRange=function(e){var t=this.option;gGe(["start","startValue","end","endValue"],function(a){t[a]=e[a]})},t.prototype.getPercentRange=function(){var e=this.findRepresentativeAxisProxy();if(e)return e.getDataPercentWindow()},t.prototype.getValueRange=function(e,t){if(null!=e||null!=t)return this.getAxisProxy(e,t).getDataValueWindow();var a=this.findRepresentativeAxisProxy();return a?a.getDataValueWindow():void 0},t.prototype.findRepresentativeAxisProxy=function(e){if(e)return e.__dzAxisProxy;for(var t,a=this._targetAxisInfoMap.keys(),n=0;n<a.length;n++)for(var r=a[n],i=this._targetAxisInfoMap.get(r),o=0;o<i.indexList.length;o++){var s=this.getAxisProxy(r,i.indexList[o]);if(s.hostedBy(this))return s;t||(t=s)}return t},t.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},t.prototype.getOrient=function(){return this._orient},t.type="dataZoom",t.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],t.defaultOption={z:4,filterMode:"filter",start:0,end:100},t}(i5e);function Xbt(e){var t={};return gGe(["start","end","startValue","endValue","throttle"],function(a){e.hasOwnProperty(a)&&(t[a]=e[a])}),t}var $bt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="dataZoom.select",t}(jbt),Kbt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a,n){this.dataZoomModel=e,this.ecModel=t,this.api=a},t.type="dataZoom",t}(n6e),Zbt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="dataZoom.select",t}(Kbt),Jbt=gGe,Qbt=LXe,ext=function(){function e(e,t,a,n){this._dimName=e,this._axisIndex=t,this.ecModel=n,this._dataZoomModel=a}return e.prototype.hostedBy=function(e){return this._dataZoomModel===e},e.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},e.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},e.prototype.getTargetSeriesModels=function(){var e=[];return this.ecModel.eachSeries(function(t){if(function(e){var t=e.get("coordinateSystem");return fGe(Hbt,t)>=0}(t)){var a=Gbt(this._dimName),n=t.getReferringComponents(a,x$e).models[0];n&&this._axisIndex===n.componentIndex&&e.push(t)}},this),e},e.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},e.prototype.getMinMaxSpan=function(){return cGe(this._minMaxSpan)},e.prototype.calculateDataWindow=function(e){var t,a=this._dataExtent,n=this.getAxisModel().axis.scale,r=this._dataZoomModel.getRangePropMode(),i=[0,100],o=[],s=[];Jbt(["start","end"],function(l,c){var u=e[l],d=e[l+"Value"];"percent"===r[c]?(null==u&&(u=i[c]),d=n.parse(IXe(u,i,a))):(t=!0,u=IXe(d=null==d?a[c]:n.parse(d),a,i)),s[c]=null==d||isNaN(d)?a[c]:d,o[c]=null==u||isNaN(u)?i[c]:u}),Qbt(s),Qbt(o);var l=this._minMaxSpan;function c(e,t,a,r,i){var o=i?"Span":"ValueSpan";_ht(0,e,a,"all",l["min"+o],l["max"+o]);for(var s=0;s<2;s++)t[s]=IXe(e[s],a,r,!0),i&&(t[s]=n.parse(t[s]))}return t?c(s,o,a,i,!1):c(o,s,i,a,!0),{valueWindow:s,percentWindow:o}},e.prototype.reset=function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=function(e,t,a){var n=[1/0,-1/0];Jbt(a,function(e){!function(e,t,a){t&&gGe(Yet(t,a),function(a){var n=t.getApproximateExtent(a);n[0]<e[0]&&(e[0]=n[0]),n[1]>e[1]&&(e[1]=n[1])})}(n,e.getData(),t)});var r=e.getAxisModel(),i=Fet(r.axis.scale,r,n).calculate();return[i.min,i.max]}(this,this._dimName,t),this._updateMinMaxSpan();var a=this.calculateDataWindow(e.settledOption);this._valueWindow=a.valueWindow,this._percentWindow=a.percentWindow,this._setAxisModel()}},e.prototype.filterData=function(e,t){if(e===this._dataZoomModel){var a=this._dimName,n=this.getTargetSeriesModels(),r=e.get("filterMode"),i=this._valueWindow;"none"!==r&&Jbt(n,function(e){var t=e.getData(),n=t.mapDimensionsAll(a);if(n.length){if("weakFilter"===r){var o=t.getStore(),s=yGe(n,function(e){return t.getDimensionIndex(e)},t);t.filterSelf(function(e){for(var t,a,r,l=0;l<n.length;l++){var c=o.get(s[l],e),u=!isNaN(c),d=c<i[0],h=c>i[1];if(u&&!d&&!h)return!0;u&&(r=!0),d&&(t=!0),h&&(a=!0)}return r&&t&&a})}else Jbt(n,function(a){if("empty"===r)e.setData(t=t.map(a,function(e){return function(e){return e>=i[0]&&e<=i[1]}(e)?e:NaN}));else{var n={};n[a]=i,t.selectRange(n)}});Jbt(n,function(e){t.setApproximateExtent(i,e)})}})}},e.prototype._updateMinMaxSpan=function(){var e=this._minMaxSpan={},t=this._dataZoomModel,a=this._dataExtent;Jbt(["min","max"],function(n){var r=t.get(n+"Span"),i=t.get(n+"ValueSpan");null!=i&&(i=this.getAxisModel().axis.scale.parse(i)),null!=i?r=IXe(a[0]+i,a,[0,100],!0):null!=r&&(i=IXe(r,[0,100],a,!0)-a[0]),e[n+"Span"]=r,e[n+"ValueSpan"]=i},this)},e.prototype._setAxisModel=function(){var e=this.getAxisModel(),t=this._percentWindow,a=this._valueWindow;if(t){var n=OXe(a,[0,500]);n=Math.min(n,20);var r=e.axis.scale.rawExtentInfo;0!==t[0]&&r.setDeterminedMinMax("min",+a[0].toFixed(n)),100!==t[1]&&r.setDeterminedMinMax("max",+a[1].toFixed(n)),r.freeze()}},e}();var txt={getTargetSeries:function(e){function t(t){e.eachComponent("dataZoom",function(a){a.eachTargetAxis(function(n,r){var i=e.getComponent(Gbt(n),r);t(n,r,i,a)})})}t(function(e,t,a,n){a.__dzAxisProxy=null});var a=[];t(function(t,n,r,i){r.__dzAxisProxy||(r.__dzAxisProxy=new ext(t,n,i,e),a.push(r.__dzAxisProxy))});var n=$Ge();return gGe(a,function(e){gGe(e.getTargetSeriesModels(),function(e){n.set(e.uid,e)})}),n},overallReset:function(e,t){e.eachComponent("dataZoom",function(e){e.eachTargetAxis(function(t,a){e.getAxisProxy(t,a).reset(e)}),e.eachTargetAxis(function(a,n){e.getAxisProxy(a,n).filterData(e,t)})}),e.eachComponent("dataZoom",function(e){var t=e.findRepresentativeAxisProxy();if(t){var a=t.getDataPercentWindow(),n=t.getDataValueWindow();e.setCalculatedRange({start:a[0],end:a[1],startValue:n[0],endValue:n[1]})}})}};var axt=!1;function nxt(e){axt||(axt=!0,e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,txt),function(e){e.registerAction("dataZoom",function(e,t){gGe(Wbt(t,e),function(t){t.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})}(e),e.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function rxt(e){e.registerComponentModel($bt),e.registerComponentView(Zbt),nxt(e)}var ixt=function(){},oxt={};function sxt(e,t){oxt[e]=t}function lxt(e){return oxt[e]}var cxt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.optionUpdated=function(){e.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;gGe(this.option.feature,function(e,a){var n=lxt(a);n&&(n.getDefaultOption&&(n.defaultOption=n.getDefaultOption(t)),uGe(e,n.defaultOption))})},t.type="toolbox",t.layoutMode={type:"box",ignoreSize:!0},t.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:o5e.color.border,borderRadius:0,borderWidth:0,padding:o5e.size.m,itemSize:15,itemGap:o5e.size.s,showTitle:!0,iconStyle:{borderColor:o5e.color.accent50,color:"none"},emphasis:{iconStyle:{borderColor:o5e.color.accent50}},tooltip:{show:!1,position:"bottom"}},t}(i5e);function uxt(e,t){var a=S2e(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),new EZe({shape:{x:e.x-a[3],y:e.y-a[0],width:e.width+a[1]+a[3],height:e.height+a[0]+a[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1})}var dxt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.render=function(e,t,a,n){var r=this.group;if(r.removeAll(),e.get("show")){var i=+e.get("itemSize"),o="vertical"===e.get("orient"),s=e.get("feature")||{},l=this._features||(this._features={}),c=[];gGe(s,function(e,t){c.push(t)}),new o9e(this._featureNames||[],c).add(f).update(f).remove(MGe(f,null)).execute(),this._featureNames=c;var u=J2e(e,a).refContainer,d=e.getBoxLayoutParams(),h=e.get("padding"),p=$2e(d,u,h);Y2e(e.get("orient"),r,e.get("itemGap"),p.width,p.height),Q2e(r,d,u,h),r.add(uxt(r.getBoundingRect(),e)),o||r.eachChild(function(e){var t=e.__title,n=e.ensureState("emphasis"),o=n.textConfig||(n.textConfig={}),s=e.getTextContent(),l=s&&s.ensureState("emphasis");if(l&&!kGe(l)&&t){var c=l.style||(l.style={}),u=nXe(t,PZe.makeFont(c)),d=e.x+r.x,h=!1;e.y+r.y+i+u.height>a.getHeight()&&(o.position="top",h=!0);var p=h?-5-u.height:i+10;d+u.width/2>a.getWidth()?(o.position=["100%",p],c.align="right"):d-u.width/2<0&&(o.position=[0,p],c.align="left")}})}function f(u,d){var h,p=c[u],f=c[d],m=s[p],v=new E1e(m,e,e.ecModel);if(n&&null!=n.newTitle&&n.featureName===p&&(m.title=n.newTitle),p&&!f){if(function(e){return 0===e.indexOf("my")}(p))h={onclick:v.option.onclick,featureName:p};else{var g=lxt(p);if(!g)return;h=new g}l[p]=h}else if(!(h=l[f]))return;h.uid=R1e("toolbox-feature"),h.model=v,h.ecModel=t,h.api=a;var y=h instanceof ixt;p||!f?!v.get("show")||y&&h.unusable?y&&h.remove&&h.remove(t,a):(!function(n,s,l){var c,u,d=n.getModel("iconStyle"),h=n.getModel(["emphasis","iconStyle"]),p=s instanceof ixt&&s.getIcons?s.getIcons():n.get("icon"),f=n.get("title")||{};CGe(p)?(c={})[l]=p:c=p;CGe(f)?(u={})[l]=f:u=f;var m=n.iconPaths={};gGe(c,function(l,c){var p=O0e(l,{},{x:-i/2,y:-i/2,width:i,height:i});p.setStyle(d.getItemStyle()),p.ensureState("emphasis").style=h.getItemStyle();var f=new PZe({style:{text:u[c],align:h.get("textAlign"),borderRadius:h.get("textBorderRadius"),padding:h.get("textPadding"),fill:null,font:h1e({fontStyle:h.get("textFontStyle"),fontFamily:h.get("textFontFamily"),fontSize:h.get("textFontSize"),fontWeight:h.get("textFontWeight")},t)},ignore:!0});p.setTextContent(f),G0e({el:p,componentModel:e,itemName:c,formatterParamsExtra:{title:u[c]}}),p.__title=u[c],p.on("mouseover",function(){var t=h.getItemStyle(),n=o?null==e.get("right")&&"right"!==e.get("left")?"right":"left":null==e.get("bottom")&&"bottom"!==e.get("top")?"bottom":"top";f.setStyle({fill:h.get("textFill")||t.fill||t.stroke||o5e.color.neutral99,backgroundColor:h.get("textBackgroundColor")}),p.setTextConfig({position:h.get("textPosition")||n}),f.ignore=!e.get("showTitle"),a.enterEmphasis(this)}).on("mouseout",function(){"emphasis"!==n.get(["iconStatus",c])&&a.leaveEmphasis(this),f.hide()}),("emphasis"===n.get(["iconStatus",c])?_Je:SJe)(p),r.add(p),p.on("click",SGe(s.onclick,s,t,a,c)),m[c]=p})}(v,h,p),v.setIconStatus=function(e,t){var a=this.option,n=this.iconPaths;a.iconStatus=a.iconStatus||{},a.iconStatus[e]=t,n[e]&&("emphasis"===t?_Je:SJe)(n[e])},h instanceof ixt&&h.render&&h.render(v,t,a,n)):y&&h.dispose&&h.dispose(t,a)}},t.prototype.updateView=function(e,t,a,n){gGe(this._features,function(e){e instanceof ixt&&e.updateView&&e.updateView(e.model,t,a,n)})},t.prototype.remove=function(e,t){gGe(this._features,function(a){a instanceof ixt&&a.remove&&a.remove(e,t)}),this.group.removeAll()},t.prototype.dispose=function(e,t){gGe(this._features,function(a){a instanceof ixt&&a.dispose&&a.dispose(e,t)})},t.type="toolbox",t}(n6e);var hxt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.onclick=function(e,t){var a=this.model,n=a.get("name")||e.get("title.0.text")||"echarts",r="svg"===t.getZr().painter.getType(),i=r?"svg":a.get("type",!0)||"png",o=t.getConnectedDataURL({type:i,backgroundColor:a.get("backgroundColor",!0)||e.get("backgroundColor")||o5e.color.neutral00,connectedBackgroundColor:a.get("connectedBackgroundColor"),excludeComponents:a.get("excludeComponents"),pixelRatio:a.get("pixelRatio")}),s=HHe.browser;if("function"!=typeof MouseEvent||!s.newEdge&&(s.ie||s.edge))if(window.navigator.msSaveOrOpenBlob||r){var l=o.split(","),c=l[0].indexOf("base64")>-1,u=r?decodeURIComponent(l[1]):l[1];c&&(u=window.atob(u));var d=n+"."+i;if(window.navigator.msSaveOrOpenBlob){for(var h=u.length,p=new Uint8Array(h);h--;)p[h]=u.charCodeAt(h);var f=new Blob([p]);window.navigator.msSaveOrOpenBlob(f,d)}else{var m=document.createElement("iframe");document.body.appendChild(m);var v=m.contentWindow,g=v.document;g.open("image/svg+xml","replace"),g.write(u),g.close(),v.focus(),g.execCommand("SaveAs",!0,d),document.body.removeChild(m)}}else{var y=a.get("lang"),b='<body style="margin:0;"><img src="'+o+'" style="max-width:100%;" title="'+(y&&y[0]||"")+'" /></body>',x=window.open();x.document.write(b),x.document.title=n}else{var w=document.createElement("a");w.download=n+"."+i,w.target="_blank",w.href=o;var _=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});w.dispatchEvent(_)}},t.getDefaultOption=function(e){return{show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:e.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:o5e.color.neutral00,name:"",excludeComponents:["toolbox"],lang:e.getLocaleModel().get(["toolbox","saveAsImage","lang"])}},t}(ixt),pxt="__ec_magicType_stack__",fxt=[["line","bar"],["stack"]],mxt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.getIcons=function(){var e=this.model,t=e.get("icon"),a={};return gGe(e.get("type"),function(e){t[e]&&(a[e]=t[e])}),a},t.getDefaultOption=function(e){return{show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:e.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}}},t.prototype.onclick=function(e,t,a){var n=this.model,r=n.get(["seriesIndex",a]);if(vxt[a]){var i,o={series:[]};gGe(fxt,function(e){fGe(e,a)>=0&&gGe(e,function(e){n.setIconStatus(e,"normal")})}),n.setIconStatus(a,"emphasis"),e.eachComponent({mainType:"series",query:null==r?null:{seriesIndex:r}},function(e){var t=e.subType,r=e.id,i=vxt[a](t,r,e,n);i&&(pGe(i,e.option),o.series.push(i));var s=e.coordinateSystem;if(s&&"cartesian2d"===s.type&&("line"===a||"bar"===a)){var l=s.getAxesByScale("ordinal")[0];if(l){var c=l.dim+"Axis",u=e.getReferringComponents(c,x$e).models[0].componentIndex;o[c]=o[c]||[];for(var d=0;d<=u;d++)o[c][u]=o[c][u]||{};o[c][u].boundaryGap="bar"===a}}});var s=a;"stack"===a&&(i=uGe({stack:n.option.title.tiled,tiled:n.option.title.stack},n.option.title),"emphasis"!==n.get(["iconStatus",a])&&(s="tiled")),t.dispatchAction({type:"changeMagicType",currentType:s,newOption:o,newTitle:i,featureName:"magicType"})}},t}(ixt),vxt={line:function(e,t,a,n){if("bar"===e)return uGe({id:t,type:"line",data:a.get("data"),stack:a.get("stack"),markPoint:a.get("markPoint"),markLine:a.get("markLine")},n.get(["option","line"])||{},!0)},bar:function(e,t,a,n){if("line"===e)return uGe({id:t,type:"bar",data:a.get("data"),stack:a.get("stack"),markPoint:a.get("markPoint"),markLine:a.get("markLine")},n.get(["option","bar"])||{},!0)},stack:function(e,t,a,n){var r=a.get("stack")===pxt;if("line"===e||"bar"===e)return n.setIconStatus("stack",r?"normal":"emphasis"),uGe({id:t,stack:r?"":pxt},n.get(["option","stack"])||{},!0)}};Z7e({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,t){t.mergeOption(e.newOption)});var gxt=new Array(60).join("-"),yxt="\t";function bxt(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var xxt=new RegExp("[\t]+","g");function wxt(e,t){var a=e.split(new RegExp("\n*"+gxt+"\n*","g")),n={series:[]};return gGe(a,function(e,a){if(function(e){if(e.slice(0,e.indexOf("\n")).indexOf(yxt)>=0)return!0}(e)){var r=function(e){for(var t=e.split(/\n+/g),a=[],n=yGe(bxt(t.shift()).split(xxt),function(e){return{name:e,data:[]}}),r=0;r<t.length;r++){var i=bxt(t[r]).split(xxt);a.push(i.shift());for(var o=0;o<i.length;o++)n[o]&&(n[o].data[r]=i[o])}return{series:n,categories:a}}(e),i=t[a],o=i.axisDim+"Axis";i&&(n[o]=n[o]||[],n[o][i.axisIndex]={data:r.categories},n.series=n.series.concat(r.series))}else{r=function(e){for(var t=e.split(/\n+/g),a=bxt(t.shift()),n=[],r=0;r<t.length;r++){var i=bxt(t[r]);if(i){var o=i.split(xxt),s="",l=void 0,c=!1;isNaN(o[0])?(c=!0,s=o[0],o=o.slice(1),n[r]={name:s,value:[]},l=n[r].value):l=n[r]=[];for(var u=0;u<o.length;u++)l.push(+o[u]);1===l.length&&(c?n[r].value=l[0]:n[r]=l[0])}}return{name:a,data:n}}(e);n.series.push(r)}}),n}var _xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.onclick=function(e,t){setTimeout(function(){t.dispatchAction({type:"hideTip"})});var a=t.getDom(),n=this.model;this._dom&&a.removeChild(this._dom);var r=document.createElement("div");r.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",r.style.backgroundColor=n.get("backgroundColor")||o5e.color.neutral00;var i=document.createElement("h4"),o=n.get("lang")||[];i.innerHTML=o[0]||n.get("title"),i.style.cssText="margin:10px 20px",i.style.color=n.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="overflow:auto";var c=n.get("optionToContent"),u=n.get("contentToOption"),d=function(e){var t,a,n,r=function(e){var t={},a=[],n=[];return e.eachRawSeries(function(e){var r=e.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)a.push(e);else{var i=r.getBaseAxis();if("category"===i.type){var o=i.dim+"_"+i.index;t[o]||(t[o]={categoryAxis:i,valueAxis:r.getOtherAxis(i),series:[]},n.push({axisDim:i.dim,axisIndex:i.index})),t[o].series.push(e)}else a.push(e)}}),{seriesGroupByCategoryAxis:t,other:a,meta:n}}(e);return{value:xGe([(a=r.seriesGroupByCategoryAxis,n=[],gGe(a,function(e,t){var a=e.categoryAxis,r=e.valueAxis.dim,i=[" "].concat(yGe(e.series,function(e){return e.name})),o=[a.model.getCategories()];gGe(e.series,function(e){var t=e.getRawData();o.push(e.getRawData().mapArray(t.mapDimension(r),function(e){return e}))});for(var s=[i.join(yxt)],l=0;l<o[0].length;l++){for(var c=[],u=0;u<o.length;u++)c.push(o[u][l]);s.push(c.join(yxt))}n.push(s.join("\n"))}),n.join("\n\n"+gxt+"\n\n")),(t=r.other,yGe(t,function(e){var t=e.getRawData(),a=[e.name],n=[];return t.each(t.dimensions,function(){for(var e=arguments.length,r=arguments[e-1],i=t.getName(r),o=0;o<e-1;o++)n[o]=arguments[o];a.push((i?i+yxt:"")+n.join(yxt))}),a.join("\n")}).join("\n\n"+gxt+"\n\n"))],function(e){return!!e.replace(/[\n\t\s]/g,"")}).join("\n\n"+gxt+"\n\n"),meta:r.meta}}(e);if(kGe(c)){var h=c(t.getOption());CGe(h)?s.innerHTML=h:PGe(h)&&s.appendChild(h)}else{l.readOnly=n.get("readOnly");var p=l.style;p.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",p.color=n.get("textColor"),p.borderColor=n.get("textareaBorderColor"),p.backgroundColor=n.get("textareaColor"),l.value=d.value,s.appendChild(l)}var f=d.meta,m=document.createElement("div");m.style.cssText="position:absolute;bottom:5px;left:0;right:0";var v="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",g=document.createElement("div"),y=document.createElement("div");v+=";background-color:"+n.get("buttonColor"),v+=";color:"+n.get("buttonTextColor");var b=this;function x(){a.removeChild(r),b._dom=null}UWe(g,"click",x),UWe(y,"click",function(){if(null==u&&null!=c||null!=u&&null==c)x();else{var e;try{e=kGe(u)?u(s,t.getOption()):wxt(l.value,f)}catch(TQe){throw x(),new Error("Data view format error "+TQe)}e&&t.dispatchAction({type:"changeDataView",newOption:e}),x()}}),g.innerHTML=o[1],y.innerHTML=o[2],y.style.cssText=g.style.cssText=v,!n.get("readOnly")&&m.appendChild(y),m.appendChild(g),r.appendChild(i),r.appendChild(s),r.appendChild(m),s.style.height=a.clientHeight-80+"px",a.appendChild(r),this._dom=r},t.prototype.remove=function(e,t){this._dom&&t.getDom().removeChild(this._dom)},t.prototype.dispose=function(e,t){this.remove(e,t)},t.getDefaultOption=function(e){return{show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:e.getLocaleModel().get(["toolbox","dataView","title"]),lang:e.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:o5e.color.background,textColor:o5e.color.primary,textareaColor:o5e.color.background,textareaBorderColor:o5e.color.border,buttonColor:o5e.color.accent50,buttonTextColor:o5e.color.neutral00}},t}(ixt);function Sxt(e,t){return yGe(e,function(e,a){var n=t&&t[a];if(IGe(n)&&!TGe(n)){IGe(e)&&!TGe(e)||(e={value:e});var r=null!=n.name&&null==e.name;return e=pGe(e,n),r&&delete e.name,e}return e})}Z7e({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,t){var a=[];gGe(e.newOption.series,function(e){var n=t.getSeriesByName(e.name)[0];if(n){var r=n.get("data");a.push({name:e.name,data:Sxt(e.data,r)})}else a.push(hGe({type:"scatter"},e))}),t.mergeOption(pGe({series:a},e.newOption))});var Mxt=gGe,Txt=v$e();function kxt(e){var t=Txt(e);return t.snapshots||(t.snapshots=[{}]),t.snapshots}var Cxt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.onclick=function(e,t){!function(e){Txt(e).snapshots=null}(e),t.dispatchAction({type:"restore",from:this.uid})},t.getDefaultOption=function(e){return{show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:e.getLocaleModel().get(["toolbox","restore","title"])}},t}(ixt);Z7e({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,t){t.resetOption("recreate")});var Axt=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],Ext=function(){function e(e,t,a){var n=this;this._targetInfoList=[];var r=Rxt(t,e);gGe(Dxt,function(e,t){(!a||!a.include||fGe(a.include,t)>=0)&&e(r,n._targetInfoList)})}return e.prototype.setOutputRanges=function(e,t){return this.matchOutputRanges(e,t,function(e,t,a){if((e.coordRanges||(e.coordRanges=[])).push(t),!e.coordRange){e.coordRange=t;var n=Nxt[e.brushType](0,a,t);e.__rangeOffset={offset:Fxt[e.brushType](n.values,e.range,[1,1]),xyMinMax:n.xyMinMax}}}),e},e.prototype.matchOutputRanges=function(e,t,a){gGe(e,function(e){var n=this.findTargetInfo(e,t);n&&!0!==n&&gGe(n.coordSyses,function(n){var r=Nxt[e.brushType](1,n,e.range,!0);a(e,r.values,n,t)})},this)},e.prototype.setInputRanges=function(e,t){gGe(e,function(e){var a,n,r,i,o,s=this.findTargetInfo(e,t);if(e.range=e.range||[],s&&!0!==s){e.panelId=s.panelId;var l=Nxt[e.brushType](0,s.coordSys,e.coordRange),c=e.__rangeOffset;e.range=c?Fxt[e.brushType](l.values,c.offset,(a=l.xyMinMax,n=c.xyMinMax,r=Uxt(a),i=Uxt(n),o=[r[0]/i[0],r[1]/i[1]],isNaN(o[0])&&(o[0]=1),isNaN(o[1])&&(o[1]=1),o)):l.values}},this)},e.prototype.makePanelOpts=function(e,t){return yGe(this._targetInfoList,function(a){var n=a.getPanelRect();return{panelId:a.panelId,defaultBrushType:t?t(a):null,clipPath:Mpt(n),isTargetByCursor:kpt(n,e,a.coordSysModel),getLinearBrushOtherExtent:Tpt(n)}})},e.prototype.controlSeries=function(e,t,a){var n=this.findTargetInfo(e,a);return!0===n||n&&fGe(n.coordSyses,t.coordinateSystem)>=0},e.prototype.findTargetInfo=function(e,t){for(var a=this._targetInfoList,n=Rxt(t,e),r=0;r<a.length;r++){var i=a[r],o=e.panelId;if(o){if(i.panelId===o)return i}else for(var s=0;s<Pxt.length;s++)if(Pxt[s](n,i))return i}return!0},e}();function Ixt(e){return e[0]>e[1]&&e.reverse(),e}function Rxt(e,t){return y$e(e,t,{includeMainTypes:Axt})}var Dxt={grid:function(e,t){var a=e.xAxisModels,n=e.yAxisModels,r=e.gridModels,i=$Ge(),o={},s={};(a||n||r)&&(gGe(a,function(e){var t=e.axis.grid.model;i.set(t.id,t),o[t.id]=!0}),gGe(n,function(e){var t=e.axis.grid.model;i.set(t.id,t),s[t.id]=!0}),gGe(r,function(e){i.set(e.id,e),o[e.id]=!0,s[e.id]=!0}),i.each(function(e){var r=e.coordinateSystem,i=[];gGe(r.getCartesians(),function(e,t){(fGe(a,e.getAxis("x").model)>=0||fGe(n,e.getAxis("y").model)>=0)&&i.push(e)}),t.push({panelId:"grid--"+e.id,gridModel:e,coordSysModel:e,coordSys:i[0],coordSyses:i,getPanelRect:Lxt.grid,xAxisDeclared:o[e.id],yAxisDeclared:s[e.id]})}))},geo:function(e,t){gGe(e.geoModels,function(e){var a=e.coordinateSystem;t.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:a,coordSyses:[a],getPanelRect:Lxt.geo})})}},Pxt=[function(e,t){var a=e.xAxisModel,n=e.yAxisModel,r=e.gridModel;return!r&&a&&(r=a.axis.grid.model),!r&&n&&(r=n.axis.grid.model),r&&r===t.gridModel},function(e,t){var a=e.geoModel;return a&&a===t.geoModel}],Lxt={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(I0e(e)),t}},Nxt={lineX:MGe(Oxt,0),lineY:MGe(Oxt,1),rect:function(e,t,a,n){var r=e?t.pointToData([a[0][0],a[1][0]],n):t.dataToPoint([a[0][0],a[1][0]],n),i=e?t.pointToData([a[0][1],a[1][1]],n):t.dataToPoint([a[0][1],a[1][1]],n),o=[Ixt([r[0],i[0]]),Ixt([r[1],i[1]])];return{values:o,xyMinMax:o}},polygon:function(e,t,a,n){var r=[[1/0,-1/0],[1/0,-1/0]];return{values:yGe(a,function(a){var i=e?t.pointToData(a,n):t.dataToPoint(a,n);return r[0][0]=Math.min(r[0][0],i[0]),r[1][0]=Math.min(r[1][0],i[1]),r[0][1]=Math.max(r[0][1],i[0]),r[1][1]=Math.max(r[1][1],i[1]),i}),xyMinMax:r}}};function Oxt(e,t,a,n){var r=a.getAxis(["x","y"][e]),i=Ixt(yGe([0,1],function(e){return t?r.coordToData(r.toLocalCoord(n[e]),!0):r.toGlobalCoord(r.dataToCoord(n[e]))})),o=[];return o[e]=i,o[1-e]=[NaN,NaN],{values:i,xyMinMax:o}}var Fxt={lineX:MGe(Bxt,0),lineY:MGe(Bxt,1),rect:function(e,t,a){return[[e[0][0]-a[0]*t[0][0],e[0][1]-a[0]*t[0][1]],[e[1][0]-a[1]*t[1][0],e[1][1]-a[1]*t[1][1]]]},polygon:function(e,t,a){return yGe(e,function(e,n){return[e[0]-a[0]*t[n][0],e[1]-a[1]*t[n][1]]})}};function Bxt(e,t,a,n){return[t[0]-n[e]*a[0],t[1]-n[e]*a[1]]}function Uxt(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var zxt,Vxt,Hxt=gGe,Gxt=n$e+"toolbox-dataZoom_",Wxt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.render=function(e,t,a,n){this._brushController||(this._brushController=new jht(a.getZr()),this._brushController.on("brush",SGe(this._onBrush,this)).mount()),function(e,t,a,n,r){var i=a._isZoomActive;n&&"takeGlobalCursor"===n.type&&(i="dataZoomSelect"===n.key&&n.dataZoomSelectActive);a._isZoomActive=i,e.setIconStatus("zoom",i?"emphasis":"normal");var o=new Ext(Yxt(e),t,{include:["grid"]}),s=o.makePanelOpts(r,function(e){return e.xAxisDeclared&&!e.yAxisDeclared?"lineX":!e.xAxisDeclared&&e.yAxisDeclared?"lineY":"rect"});a._brushController.setPanels(s).enableBrush(!(!i||!s.length)&&{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()})}(e,t,this,n,a),function(e,t){e.setIconStatus("back",function(e){return kxt(e).length}(t)>1?"emphasis":"normal")}(e,t)},t.prototype.onclick=function(e,t,a){qxt[a].call(this)},t.prototype.remove=function(e,t){this._brushController&&this._brushController.unmount()},t.prototype.dispose=function(e,t){this._brushController&&this._brushController.dispose()},t.prototype._onBrush=function(e){var t=e.areas;if(e.isEnd&&t.length){var a={},n=this.ecModel;this._brushController.updateCovers([]),new Ext(Yxt(this.model),n,{include:["grid"]}).matchOutputRanges(t,n,function(e,t,a){if("cartesian2d"===a.type){var n=e.brushType;"rect"===n?(r("x",a,t[0]),r("y",a,t[1])):r({lineX:"x",lineY:"y"}[n],a,t)}}),function(e,t){var a=kxt(e);Mxt(t,function(t,n){for(var r=a.length-1;r>=0&&!a[r][n];r--);if(r<0){var i=e.queryComponents({mainType:"dataZoom",subType:"select",id:n})[0];if(i){var o=i.getPercentRange();a[0][n]={dataZoomId:n,start:o[0],end:o[1]}}}}),a.push(t)}(n,a),this._dispatchZoomAction(a)}function r(e,t,r){var i=t.getAxis(e),o=i.model,s=function(e,t,a){var n;return a.eachComponent({mainType:"dataZoom",subType:"select"},function(a){a.getAxisModel(e,t.componentIndex)&&(n=a)}),n}(e,o,n),l=s.findRepresentativeAxisProxy(o).getMinMaxSpan();null==l.minValueSpan&&null==l.maxValueSpan||(r=_ht(0,r.slice(),i.scale.getExtent(),0,l.minValueSpan,l.maxValueSpan)),s&&(a[s.id]={dataZoomId:s.id,startValue:r[0],endValue:r[1]})}},t.prototype._dispatchZoomAction=function(e){var t=[];Hxt(e,function(e,a){t.push(cGe(e))}),t.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:t})},t.getDefaultOption=function(e){return{show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:e.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:o5e.color.backgroundTint}}},t}(ixt),qxt={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(function(e){var t=kxt(e),a=t[t.length-1];t.length>1&&t.pop();var n={};return Mxt(a,function(e,a){for(var r=t.length-1;r>=0;r--)if(e=t[r][a]){n[a]=e;break}}),n}(this.ecModel))}};function Yxt(e){var t={xAxisIndex:e.get("xAxisIndex",!0),yAxisIndex:e.get("yAxisIndex",!0),xAxisId:e.get("xAxisId",!0),yAxisId:e.get("yAxisId",!0)};return null==t.xAxisIndex&&null==t.xAxisId&&(t.xAxisIndex="all"),null==t.yAxisIndex&&null==t.yAxisId&&(t.yAxisIndex="all"),t}zxt="dataZoom",Vxt=function(e){var t=e.getComponent("toolbox",0),a=["feature","dataZoom"];if(t&&null!=t.get(a)){var n=t.getModel(a),r=[],i=y$e(e,Yxt(n));return Hxt(i.xAxisModels,function(e){return o(e,"xAxis","xAxisIndex")}),Hxt(i.yAxisModels,function(e){return o(e,"yAxis","yAxisIndex")}),r}function o(e,t,a){var i=e.componentIndex,o={type:"select",$fromToolbox:!0,filterMode:n.get("filterMode",!0)||"filter",id:Gxt+t+i};o[a]=i,r.push(o)}},VGe(null==P5e.get(zxt)&&Vxt),P5e.set(zxt,Vxt);var jxt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,displayTransition:!0,enterable:!1,backgroundColor:o5e.color.neutral00,shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,defaultBorderColor:o5e.color.border,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:o5e.color.borderShade,width:1,type:"dashed",textStyle:{}}},textStyle:{color:o5e.color.tertiary,fontSize:14}},t}(i5e);function Xxt(e){var t=e.get("confine");return null!=t?!!t:"richText"===e.get("renderMode")}function $xt(e){if(HHe.domSupported)for(var t=document.documentElement.style,a=0,n=e.length;a<n;a++)if(e[a]in t)return e[a]}var Kxt=$xt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]);function Zxt(e,t){if(!e)return t;t=_2e(t,!0);var a=e.indexOf(t);return(e=-1===a?t:"-"+e.slice(0,a)+"-"+t).toLowerCase()}var Jxt=Zxt($xt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),"transition"),Qxt=Zxt(Kxt,"transform"),ewt="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(HHe.transform3dSupported?"will-change:transform;":"");function twt(e,t,a){var n=e.toFixed(0)+"px",r=t.toFixed(0)+"px";if(!HHe.transformSupported)return a?"top:"+r+";left:"+n+";":[["top",r],["left",n]];var i=HHe.transform3dSupported,o="translate"+(i?"3d":"")+"("+n+","+r+(i?",0":"")+")";return a?"top:0;left:0;"+Qxt+":"+o+";":[["top",0],["left",0],[Kxt,o]]}function awt(e,t,a,n){var r=[],i=e.get("transitionDuration"),o=e.get("backgroundColor"),s=e.get("shadowBlur"),l=e.get("shadowColor"),c=e.get("shadowOffsetX"),u=e.get("shadowOffsetY"),d=e.getModel("textStyle"),h=G3e(e,"html"),p=c+"px "+u+"px "+s+"px "+l;return r.push("box-shadow:"+p),t&&i>0&&r.push(function(e,t,a){var n="cubic-bezier(0.23,1,0.32,1)",r="",i="";return a&&(i="opacity"+(r=" "+e/2+"s "+n)+",visibility"+r),t||(r=" "+e+"s "+n,i+=(i.length?",":"")+(HHe.transformSupported?""+Qxt+r:",left"+r+",top"+r)),Jxt+":"+i}(i,a,n)),o&&r.push("background-color:"+o),gGe(["width","color","radius"],function(t){var a="border-"+t,n=_2e(a),i=e.get(n);null!=i&&r.push(a+":"+i+("color"===t?"":"px"))}),r.push(function(e){var t=[],a=e.get("fontSize"),n=e.getTextColor();n&&t.push("color:"+n),t.push("font:"+e.getFont());var r=FGe(e.get("lineHeight"),Math.round(3*a/2));a&&t.push("line-height:"+r+"px");var i=e.get("textShadowColor"),o=e.get("textShadowBlur")||0,s=e.get("textShadowOffsetX")||0,l=e.get("textShadowOffsetY")||0;return i&&o&&t.push("text-shadow:"+s+"px "+l+"px "+o+"px "+i),gGe(["decoration","align"],function(a){var n=e.get(a);n&&t.push("text-"+a+":"+n)}),t.join(";")}(d)),null!=h&&r.push("padding:"+S2e(h).join("px ")+"px"),r.join(";")+";"}function nwt(e,t,a,n,r){var i=t&&t.painter;if(a){var o=i&&i.getViewportRoot();o&&function(e,t,a,n,r){CWe(kWe,t,n,r,!0)&&CWe(e,a,kWe[0],kWe[1])}(e,o,a,n,r)}else{e[0]=n,e[1]=r;var s=i&&i.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var rwt=function(){function e(e,t){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,HHe.wxa)return null;var a=document.createElement("div");a.domBelongToZr=!0,this.el=a;var n=this._zr=e.getZr(),r=t.appendTo,i=r&&(CGe(r)?document.querySelector(r):PGe(r)?r:kGe(r)&&r(e.getDom()));nwt(this._styleCoord,n,i,e.getWidth()/2,e.getHeight()/2),(i||e.getDom()).appendChild(a),this._api=e,this._container=i;var o=this;a.onmouseenter=function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0},a.onmousemove=function(e){if(e=e||window.event,!o._enterable){var t=n.handler;BWe(n.painter.getViewportRoot(),e,!0),t.dispatch("mousemove",e)}},a.onmouseleave=function(){o._inContent=!1,o._enterable&&o._show&&o.hideLater(o._hideDelay)}}return e.prototype.update=function(e){if(!this._container){var t=this._api.getDom(),a=(i="position",(o=(r=t).currentStyle||document.defaultView&&document.defaultView.getComputedStyle(r))?o[i]:null),n=t.style;"absolute"!==n.position&&"absolute"!==a&&(n.position="relative")}var r,i,o,s=e.get("alwaysShowContent");s&&this._moveIfResized(),this._alwaysShowContent=s,this._enableDisplayTransition=e.get("displayTransition")&&e.get("transitionDuration")>0,this.el.className=e.get("className")||""},e.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var a=this.el,n=a.style,r=this._styleCoord;a.innerHTML?n.cssText=ewt+awt(e,!this._firstShow,this._longHide,this._enableDisplayTransition)+twt(r[0],r[1],!0)+"border-color:"+A2e(t)+";"+(e.get("extraCssText")||"")+";pointer-events:"+(this._enterable?"auto":"none"):n.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(e,t,a,n,r){var i=this.el;if(null!=e){var o="";if(CGe(r)&&"item"===a.get("trigger")&&!Xxt(a)&&(o=function(e,t,a){if(!CGe(a)||"inside"===a)return"";var n=e.get("backgroundColor"),r=e.get("borderWidth");t=A2e(t);var i,o,s="left"===(i=a)?"right":"right"===i?"left":"top"===i?"bottom":"top",l=Math.max(1.5*Math.round(r),6),c="",u=Qxt+":";fGe(["left","right"],s)>-1?(c+="top:50%",u+="translateY(-50%) rotate("+(o="left"===s?-225:-45)+"deg)"):(c+="left:50%",u+="translateX(-50%) rotate("+(o="top"===s?225:45)+"deg)");var d=o*Math.PI/180,h=l+r,p=h*Math.abs(Math.cos(d))+h*Math.abs(Math.sin(d)),f=t+" solid "+r+"px;";return'<div style="'+["position:absolute;width:"+l+"px;height:"+l+"px;z-index:-1;",(c+=";"+s+":-"+Math.round(100*((p-Math.SQRT2*r)/2+Math.SQRT2*r-(p-h)/2))/100+"px")+";"+u+";","border-bottom:"+f,"border-right:"+f,"background-color:"+n+";"].join("")+'"></div>'}(a,n,r)),CGe(e))i.innerHTML=e+o;else if(e){i.innerHTML="",TGe(e)||(e=[e]);for(var s=0;s<e.length;s++)PGe(e[s])&&e[s].parentNode!==i&&i.appendChild(e[s]);if(o&&i.childNodes.length){var l=document.createElement("div");l.innerHTML=o,i.appendChild(l)}}}else i.innerHTML=""},e.prototype.setEnterable=function(e){this._enterable=e},e.prototype.getSize=function(){var e=this.el;return e?[e.offsetWidth,e.offsetHeight]:[0,0]},e.prototype.moveTo=function(e,t){if(this.el){var a=this._styleCoord;if(nwt(a,this._zr,this._container,e,t),null!=a[0]&&null!=a[1]){var n=this.el.style;gGe(twt(a[0],a[1]),function(e){n[e[0]]=e[1]})}}},e.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},e.prototype.hide=function(){var e=this,t=this.el.style;this._enableDisplayTransition?(t.visibility="hidden",t.opacity="0"):t.display="none",HHe.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},e.prototype.hideLater=function(e){!this._show||this._inContent&&this._enterable||this._alwaysShowContent||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(SGe(this.hide,this),e)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var e=this._zr;!function(e,t){function a(e){var t=e[TWe];t&&(t.clearMarkers&&t.clearMarkers(),delete e[TWe])}e&&a(e),t&&a(t)}(e&&e.painter&&e.painter.getViewportRoot(),this._container);var t=this.el;if(t){t.onmouseenter=t.onmousemove=t.onmouseleave=null;var a=t.parentNode;a&&a.removeChild(t)}this.el=this._container=null},e}(),iwt=function(){function e(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),lwt(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return e.prototype.update=function(e){var t=e.get("alwaysShowContent");t&&this._moveIfResized(),this._alwaysShowContent=t},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(e,t,a,n,r){var i=this;IGe(e)&&e$e(""),this.el&&this._zr.remove(this.el);var o=a.getModel("textStyle");this.el=new PZe({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:n,textShadowColor:o.get("textShadowColor"),fill:a.get(["textStyle","color"]),padding:G3e(a,"richText"),verticalAlign:"top",align:"left"},z:a.get("z")}),gGe(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(e){i.el.style[e]=a.get(e)}),gGe(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(e){i.el.style[e]=o.get(e)||0}),this._zr.add(this.el);var s=this;this.el.on("mouseover",function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0}),this.el.on("mouseout",function(){s._enterable&&s._show&&s.hideLater(s._hideDelay),s._inContent=!1})},e.prototype.setEnterable=function(e){this._enterable=e},e.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),a=swt(e.style);return[t.width+a.left+a.right,t.height+a.top+a.bottom]},e.prototype.moveTo=function(e,t){var a=this.el;if(a){var n=this._styleCoord;lwt(n,this._zr,e,t),e=n[0],t=n[1];var r=a.style,i=owt(r.borderWidth||0),o=swt(r);a.x=e+i+o.left,a.y=t+i+o.top,a.markRedraw()}},e.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(e){!this._show||this._inContent&&this._enterable||this._alwaysShowContent||(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(SGe(this.hide,this),e)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function owt(e){return Math.max(0,e)}function swt(e){var t=owt(e.shadowBlur||0),a=owt(e.shadowOffsetX||0),n=owt(e.shadowOffsetY||0);return{left:owt(t-a),right:owt(t+a),top:owt(t-n),bottom:owt(t+n)}}function lwt(e,t,a,n){e[0]=a,e[1]=n,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var cwt=new EZe({shape:{x:-1,y:-1,width:2,height:2}}),uwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(e,t){if(!HHe.node&&t.getDom()){var a,n=e.getComponent("tooltip"),r=this._renderMode="auto"===(a=n.get("renderMode"))?HHe.domSupported?"html":"richText":a||"html";this._tooltipContent="richText"===r?new iwt(t):new rwt(t,{appendTo:n.get("appendToBody",!0)?"body":n.get("appendTo",!0)})}},t.prototype.render=function(e,t,a){if(!HHe.node&&a.getDom()){this.group.removeAll(),this._tooltipModel=e,this._ecModel=t,this._api=a;var n=this._tooltipContent;n.update(e),n.setEnterable(e.get("enterable")),this._initGlobalListener(),this._keepShow(),"richText"!==this._renderMode&&e.get("transitionDuration")?g6e(this,"_updatePosition",50,"fixRate"):y6e(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var e=this._tooltipModel.get("triggerOn");fgt("itemTooltip",this._api,SGe(function(t,a,n){"none"!==e&&(e.indexOf(t)>=0?this._tryShow(a,n):"leave"===t&&this._hide(n))},this))},t.prototype._keepShow=function(){var e=this._tooltipModel,t=this._ecModel,a=this._api,n=e.get("triggerOn");if(null!=this._lastX&&null!=this._lastY&&"none"!==n&&"click"!==n){var r=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!a.isDisposed()&&r.manuallyShowTip(e,t,a,{x:r._lastX,y:r._lastY,dataByCoordSys:r._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(e,t,a,n){if(n.from!==this.uid&&!HHe.node&&a.getDom()){var r=hwt(n,a);this._ticket="";var i=n.dataByCoordSys,o=function(e,t,a){var n=b$e(e).queryOptionMap,r=n.keys()[0];if(!r||"series"===r)return;var i=_$e(t,r,n.get(r),{useDefault:!1,enableAll:!1,enableNone:!1}),o=i.models[0];if(!o)return;var s,l=a.getViewOfComponentModel(o);if(l.group.traverse(function(t){var a=YZe(t).tooltipConfig;if(a&&a.name===e.name)return s=t,!0}),s)return{componentMainType:r,componentIndex:o.componentIndex,el:s}}(n,t,a);if(o){var s=o.el.getBoundingRect().clone();s.applyTransform(o.el.transform),this._tryShow({offsetX:s.x+s.width/2,offsetY:s.y+s.height/2,target:o.el,position:n.position,positionDefault:"bottom"},r)}else if(n.tooltip&&null!=n.x&&null!=n.y){var l=cwt;l.x=n.x,l.y=n.y,l.update(),YZe(l).tooltipConfig={name:null,option:n.tooltip},this._tryShow({offsetX:n.x,offsetY:n.y,target:l},r)}else if(i)this._tryShow({offsetX:n.x,offsetY:n.y,position:n.position,dataByCoordSys:i,tooltipOption:n.tooltipOption},r);else if(null!=n.seriesIndex){if(this._manuallyAxisShowTip(e,t,a,n))return;var c=bgt(n,t),u=c.point[0],d=c.point[1];null!=u&&null!=d&&this._tryShow({offsetX:u,offsetY:d,target:c.el,position:n.position,positionDefault:"bottom"},r)}else null!=n.x&&null!=n.y&&(a.dispatchAction({type:"updateAxisPointer",x:n.x,y:n.y}),this._tryShow({offsetX:n.x,offsetY:n.y,position:n.position,target:a.getZr().findHover(n.x,n.y).target},r))}},t.prototype.manuallyHideTip=function(e,t,a,n){var r=this._tooltipContent;this._tooltipModel&&r.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,n.from!==this.uid&&this._hide(hwt(n,a))},t.prototype._manuallyAxisShowTip=function(e,t,a,n){var r=n.seriesIndex,i=n.dataIndex,o=t.getComponent("axisPointer").coordSysAxesInfo;if(null!=r&&null!=i&&null!=o){var s=t.getSeriesByIndex(r);if(s)if("axis"===dwt([s.getData().getItemModel(i),s,(s.coordinateSystem||{}).model],this._tooltipModel).get("trigger"))return a.dispatchAction({type:"updateAxisPointer",seriesIndex:r,dataIndex:i,position:n.position}),!0}},t.prototype._tryShow=function(e,t){var a=e.target;if(this._tooltipModel){this._lastX=e.offsetX,this._lastY=e.offsetY;var n=e.dataByCoordSys;if(n&&n.length)this._showAxisTooltip(n,e);else if(a){var r,i;if("legend"===YZe(a).ssrType)return;this._lastDataByCoordSys=null,o8e(a,function(e){if(e.tooltipDisabled)return r=i=null,!0;r||i||(null!=YZe(e).dataIndex?r=e:null!=YZe(e).tooltipConfig&&(i=e))},!0),r?this._showSeriesItemTooltip(e,r,t):i?this._showComponentItemTooltip(e,i,t):this._hide(t)}else this._lastDataByCoordSys=null,this._hide(t)}},t.prototype._showOrMove=function(e,t){var a=e.get("showDelay");t=SGe(t,this),clearTimeout(this._showTimout),a>0?this._showTimout=setTimeout(t,a):t()},t.prototype._showAxisTooltip=function(e,t){var a=this._ecModel,n=this._tooltipModel,r=[t.offsetX,t.offsetY],i=dwt([t.tooltipOption],n),o=this._renderMode,s=[],l=P3e("section",{blocks:[],noHeader:!0}),c=[],u=new W3e;gGe(e,function(e){gGe(e.dataByAxis,function(e){var t=a.getComponent(e.axisDim+"Axis",e.axisIndex),r=e.value;if(t&&null!=r){var i=tgt(r,t.axis,a,e.seriesDataIndices,e.valueLabelOpt),d=P3e("section",{header:i,noHeader:!HGe(i),sortBlocks:!0,blocks:[]});l.blocks.push(d),gGe(e.seriesDataIndices,function(l){var h=a.getSeriesByIndex(l.seriesIndex),p=l.dataIndexInside,f=h.getDataParams(p);if(!(f.dataIndex<0)){f.axisDim=e.axisDim,f.axisIndex=e.axisIndex,f.axisType=e.axisType,f.axisId=e.axisId,f.axisValue=Get(t.axis,{value:r}),f.axisValueLabel=i,f.marker=u.makeTooltipMarker("item",A2e(f.color),o);var m=j4e(h.formatTooltip(p,!0,null)),v=m.frag;if(v){var g=dwt([h],n).get("valueFormatter");d.blocks.push(g?hGe({valueFormatter:g},v):v)}m.text&&c.push(m.text),s.push(f)}})}})}),l.blocks.reverse(),c.reverse();var d=t.position,h=i.get("order"),p=U3e(l,u,o,h,a.get("useUTC"),i.get("textStyle"));p&&c.unshift(p);var f="richText"===o?"\n\n":"<br/>",m=c.join(f);this._showOrMove(i,function(){this._updateContentNotChangedOnAxis(e,s)?this._updatePosition(i,d,r[0],r[1],this._tooltipContent,s):this._showTooltipContent(i,m,s,Math.random()+"",r[0],r[1],d,null,u)})},t.prototype._showSeriesItemTooltip=function(e,t,a){var n=this._ecModel,r=YZe(t),i=r.seriesIndex,o=n.getSeriesByIndex(i),s=r.dataModel||o,l=r.dataIndex,c=r.dataType,u=s.getData(c),d=this._renderMode,h=e.positionDefault,p=dwt([u.getItemModel(l),s,o&&(o.coordinateSystem||{}).model],this._tooltipModel,h?{position:h}:null),f=p.get("trigger");if(null==f||"item"===f){var m=s.getDataParams(l,c),v=new W3e;m.marker=v.makeTooltipMarker("item",A2e(m.color),d);var g=j4e(s.formatTooltip(l,!1,c)),y=p.get("order"),b=p.get("valueFormatter"),x=g.frag,w=x?U3e(b?hGe({valueFormatter:b},x):x,v,d,y,n.get("useUTC"),p.get("textStyle")):g.text,_="item_"+s.name+"_"+l;this._showOrMove(p,function(){this._showTooltipContent(p,w,m,_,e.offsetX,e.offsetY,e.position,e.target,v)}),a({type:"showTip",dataIndexInside:l,dataIndex:u.getRawIndex(l),seriesIndex:i,from:this.uid})}},t.prototype._showComponentItemTooltip=function(e,t,a){var n="html"===this._renderMode,r=YZe(t),i=r.tooltipConfig.option||{},o=i.encodeHTMLContent;if(CGe(i)){i={content:i,formatter:i},o=!0}o&&n&&i.content&&((i=cGe(i)).content=RWe(i.content));var s=[i],l=this._ecModel.getComponent(r.componentMainType,r.componentIndex);l&&s.push(l),s.push({formatter:i.content});var c=e.positionDefault,u=dwt(s,this._tooltipModel,c?{position:c}:null),d=u.get("content"),h=Math.random()+"",p=new W3e;this._showOrMove(u,function(){var a=cGe(u.get("formatterParams")||{});this._showTooltipContent(u,d,a,h,e.offsetX,e.offsetY,e.position,t,p)}),a({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(e,t,a,n,r,i,o,s,l){if(this._ticket="",e.get("showContent")&&e.get("show")){var c=this._tooltipContent;c.setEnterable(e.get("enterable"));var u=e.get("formatter");o=o||e.get("position");var d=t,h=this._getNearestPoint([r,i],a,e.get("trigger"),e.get("borderColor"),e.get("defaultBorderColor",!0)).color;if(u)if(CGe(u)){var p=e.ecModel.get("useUTC"),f=TGe(a)?a[0]:a;d=u,f&&f.axisType&&f.axisType.indexOf("time")>=0&&(d=r2e(f.axisValue,d,p)),d=C2e(d,a,!0)}else if(kGe(u)){var m=SGe(function(t,n){t===this._ticket&&(c.setContent(n,l,e,h,o),this._updatePosition(e,o,r,i,c,a,s))},this);this._ticket=n,d=u(a,n,m)}else d=u;c.setContent(d,l,e,h,o),c.show(e,h),this._updatePosition(e,o,r,i,c,a,s)}},t.prototype._getNearestPoint=function(e,t,a,n,r){return"axis"===a||TGe(t)?{color:n||r}:TGe(t)?void 0:{color:n||t.color||t.borderColor}},t.prototype._updatePosition=function(e,t,a,n,r,i,o){var s=this._api.getWidth(),l=this._api.getHeight();t=t||e.get("position");var c=r.getSize(),u=e.get("align"),d=e.get("verticalAlign"),h=o&&o.getBoundingRect().clone();if(o&&h.applyTransform(o.transform),kGe(t)&&(t=t([a,n],i,r.el,h,{viewSize:[s,l],contentSize:c.slice()})),TGe(t))a=RXe(t[0],s),n=RXe(t[1],l);else if(IGe(t)){var p=t;p.width=c[0],p.height=c[1];var f=$2e(p,{width:s,height:l});a=f.x,n=f.y,u=null,d=null}else if(CGe(t)&&o){var m=function(e,t,a,n){var r=a[0],i=a[1],o=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,c=t.width,u=t.height;switch(e){case"inside":s=t.x+c/2-r/2,l=t.y+u/2-i/2;break;case"top":s=t.x+c/2-r/2,l=t.y-i-o;break;case"bottom":s=t.x+c/2-r/2,l=t.y+u+o;break;case"left":s=t.x-r-o,l=t.y+u/2-i/2;break;case"right":s=t.x+c+o,l=t.y+u/2-i/2}return[s,l]}(t,h,c,e.get("borderWidth"));a=m[0],n=m[1]}else{m=function(e,t,a,n,r,i,o){var s=a.getSize(),l=s[0],c=s[1];null!=i&&(e+l+i+2>n?e-=l+i:e+=i);null!=o&&(t+c+o>r?t-=c+o:t+=o);return[e,t]}(a,n,r,s,l,u?null:20,d?null:20);a=m[0],n=m[1]}if(u&&(a-=pwt(u)?c[0]/2:"right"===u?c[0]:0),d&&(n-=pwt(d)?c[1]/2:"bottom"===d?c[1]:0),Xxt(e)){m=function(e,t,a,n,r){var i=a.getSize(),o=i[0],s=i[1];return e=Math.min(e+o,n)-o,t=Math.min(t+s,r)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}(a,n,r,s,l);a=m[0],n=m[1]}r.moveTo(a,n)},t.prototype._updateContentNotChangedOnAxis=function(e,t){var a=this._lastDataByCoordSys,n=this._cbParamsList,r=!!a&&a.length===e.length;return r&&gGe(a,function(a,i){var o=a.dataByAxis||[],s=(e[i]||{}).dataByAxis||[];(r=r&&o.length===s.length)&&gGe(o,function(e,a){var i=s[a]||{},o=e.seriesDataIndices||[],l=i.seriesDataIndices||[];(r=r&&e.value===i.value&&e.axisType===i.axisType&&e.axisId===i.axisId&&o.length===l.length)&&gGe(o,function(e,t){var a=l[t];r=r&&e.seriesIndex===a.seriesIndex&&e.dataIndex===a.dataIndex}),n&&gGe(e.seriesDataIndices,function(e){var a=e.seriesIndex,i=t[a],o=n[a];i&&o&&o.data!==i.data&&(r=!1)})})}),this._lastDataByCoordSys=e,this._cbParamsList=t,!!r},t.prototype._hide=function(e){this._lastDataByCoordSys=null,e({type:"hideTip",from:this.uid})},t.prototype.dispose=function(e,t){!HHe.node&&t.getDom()&&(y6e(this,"_updatePosition"),this._tooltipContent.dispose(),ggt("itemTooltip",t))},t.type="tooltip",t}(n6e);function dwt(e,t,a){var n,r=t.ecModel;a?(n=new E1e(a,r,r),n=new E1e(t.option,n,r)):n=t;for(var i=e.length-1;i>=0;i--){var o=e[i];o&&(o instanceof E1e&&(o=o.get("tooltip",!0)),CGe(o)&&(o={formatter:o}),o&&(n=new E1e(o,n,r)))}return n}function hwt(e,t){return e.dispatchAction||SGe(t.dispatchAction,t)}function pwt(e){return"center"===e||"middle"===e}function fwt(e){Qet(Cgt),e.registerComponentModel(jxt),e.registerComponentView(uwt),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},eWe),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},eWe)}var mwt=["rect","polygon","keep","clear"];function vwt(e,t){var a=r$e(e?e.brush:[]);if(a.length){var n=[];gGe(a,function(e){var t=e.hasOwnProperty("toolbox")?e.toolbox:[];t instanceof Array&&(n=n.concat(t))});var r=e&&e.toolbox;TGe(r)&&(r=r[0]),r||(r={feature:{}},e.toolbox=[r]);var i=r.feature||(r.feature={}),o=i.brush||(i.brush={}),s=o.type||(o.type=[]);s.push.apply(s,n),function(e){var t={};gGe(e,function(e){t[e]=1}),e.length=0,gGe(t,function(t,a){e.push(a)})}(s),t&&!s.length&&s.push.apply(s,mwt)}}var gwt=gGe;function ywt(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!0}function bwt(e,t,a){var n={};return gwt(t,function(t){var r,i=n[t]=((r=function(){}).prototype.__hidden=r.prototype,new r);gwt(e[t],function(e,n){if(iut.isValidType(n)){var r={type:n,visual:e};a&&a(r,t),i[n]=new iut(r),"opacity"===n&&((r=cGe(r)).type="colorAlpha",i.__hidden.__alphaForOpacity=new iut(r))}})}),n}function xwt(e,t,a){var n;gGe(a,function(e){t.hasOwnProperty(e)&&ywt(t[e])&&(n=!0)}),n&&gGe(a,function(a){t.hasOwnProperty(a)&&ywt(t[a])?e[a]=cGe(t[a]):delete e[a]})}var wwt={lineX:_wt(0),lineY:_wt(1),rect:{point:function(e,t,a){return e&&a.boundingRect.contain(e[0],e[1])},rect:function(e,t,a){return e&&a.boundingRect.intersect(e)}},polygon:{point:function(e,t,a){return e&&a.boundingRect.contain(e[0],e[1])&&ttt(a.range,e[0],e[1])},rect:function(e,t,a){var n=a.range;if(!e||n.length<=1)return!1;var r=e.x,i=e.y,o=e.width,s=e.height,l=n[0];return!!(ttt(n,r,i)||ttt(n,r+o,i)||ttt(n,r,i+s)||ttt(n,r+o,i+s)||fqe.create(e).contain(l[0],l[1])||F0e(r,i,r+o,i,n)||F0e(r,i,r,i+s,n)||F0e(r+o,i,r+o,i+s,n)||F0e(r,i+s,r+o,i+s,n))||void 0}}};function _wt(e){var t=["x","y"],a=["width","height"];return{point:function(t,a,n){if(t){var r=n.range;return Swt(t[e],r)}},rect:function(n,r,i){if(n){var o=i.range,s=[n[t[e]],n[t[e]]+n[a[e]]];return s[1]<s[0]&&s.reverse(),Swt(s[0],o)||Swt(s[1],o)||Swt(o[0],s)||Swt(o[1],s)}}}}function Swt(e,t){return t[0]<=e&&e<=t[1]}var Mwt=["inBrush","outOfBrush"],Twt="__ecBrushSelect",kwt="__ecInBrushSelectEvent";function Cwt(e){e.eachComponent({mainType:"brush"},function(t){(t.brushTargetManager=new Ext(t.option,e)).setInputRanges(t.areas,e)})}function Awt(e,t,a){var n,r,i=[];e.eachComponent({mainType:"brush"},function(e){a&&"takeGlobalCursor"===a.type&&e.setBrushOption("brush"===a.key?a.brushOption:{brushType:!1})}),Cwt(e),e.eachComponent({mainType:"brush"},function(t,a){var o={brushId:t.id,brushIndex:a,brushName:t.name,areas:cGe(t.areas),selected:[]};i.push(o);var s=t.option,l=s.brushLink,c=[],u=[],d=[],h=!1;a||(n=s.throttleType,r=s.throttleDelay);var p=yGe(t.areas,function(e){var t=Rwt[e.brushType],a=pGe({boundingRect:t?t(e):void 0},e);return a.selectors=function(e){var t=e.brushType,a={point:function(n){return wwt[t].point(n,a,e)},rect:function(n){return wwt[t].rect(n,a,e)}};return a}(a),a}),f=bwt(t.option,Mwt,function(e){e.mappingMethod="fixed"});function m(e){return"all"===l||!!c[e]}function v(e){return!!e.length}TGe(l)&&gGe(l,function(e){c[e]=1}),e.eachSeries(function(a,n){var r=d[n]=[];"parallel"===a.subType?function(e,t){var a=e.coordinateSystem;h=h||a.hasAxisBrushed(),m(t)&&a.eachActiveState(e.getData(),function(e,t){"active"===e&&(u[t]=1)})}(a,n):function(a,n,r){if(!a.brushSelector||function(e,t){var a=e.option.seriesIndex;return null!=a&&"all"!==a&&(TGe(a)?fGe(a,t)<0:t!==a)}(t,n))return;if(gGe(p,function(n){t.brushTargetManager.controlSeries(n,a,e)&&r.push(n),h=h||v(r)}),m(n)&&v(r)){var i=a.getData();i.each(function(e){Iwt(a,r,i,e)&&(u[e]=1)})}}(a,n,r)}),e.eachSeries(function(e,t){var a={seriesId:e.id,seriesIndex:t,seriesName:e.name,dataIndex:[]};o.selected.push(a);var n=d[t],r=e.getData(),i=m(t)?function(e){return u[e]?(a.dataIndex.push(r.getRawIndex(e)),"inBrush"):"outOfBrush"}:function(t){return Iwt(e,n,r,t)?(a.dataIndex.push(r.getRawIndex(t)),"inBrush"):"outOfBrush"};(m(t)?h:v(n))&&function(e,t,a,n,r){var i,o={};function s(e){return t8e(a,i,e)}function l(e,t){n8e(a,i,e,t)}gGe(e,function(e){var a=iut.prepareVisualTypes(t[e]);o[e]=a}),a.each(function(e,c){i=e;var u=a.getRawDataItem(i);if(!u||!1!==u.visualMap)for(var d=n.call(r,e),h=t[d],p=o[d],f=0,m=p.length;f<m;f++){var v=p[f];h[v]&&h[v].applyVisual(e,s,l)}})}(Mwt,f,r,i)})}),function(e,t,a,n,r){if(!r)return;var i=e.getZr();if(i[kwt])return;i[Twt]||(i[Twt]=Ewt);var o=g6e(i,Twt,a,t);o(e,n)}(t,n,r,i,a)}function Ewt(e,t){if(!e.isDisposed()){var a=e.getZr();a[kwt]=!0,e.dispatchAction({type:"brushSelect",batch:t}),a[kwt]=!1}}function Iwt(e,t,a,n){for(var r=0,i=t.length;r<i;r++){var o=t[r];if(e.brushSelector(n,a,o.selectors,o))return!0}}var Rwt={rect:function(e){return Dwt(e.range)},polygon:function(e){for(var t,a=e.range,n=0,r=a.length;n<r;n++){t=t||[[1/0,-1/0],[1/0,-1/0]];var i=a[n];i[0]<t[0][0]&&(t[0][0]=i[0]),i[0]>t[0][1]&&(t[0][1]=i[0]),i[1]<t[1][0]&&(t[1][0]=i[1]),i[1]>t[1][1]&&(t[1][1]=i[1])}return t&&Dwt(t)}};function Dwt(e){return new fqe(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}var Pwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(e,t){this.ecModel=e,this.api=t,this.model,(this._brushController=new jht(t.getZr())).on("brush",SGe(this._onBrush,this)).mount()},t.prototype.render=function(e,t,a,n){this.model=e,this._updateController(e,t,a,n)},t.prototype.updateTransform=function(e,t,a,n){Cwt(t),this._updateController(e,t,a,n)},t.prototype.updateVisual=function(e,t,a,n){this.updateTransform(e,t,a,n)},t.prototype.updateView=function(e,t,a,n){this._updateController(e,t,a,n)},t.prototype._updateController=function(e,t,a,n){(!n||n.$from!==e.id)&&this._brushController.setPanels(e.brushTargetManager.makePanelOpts(a)).enableBrush(e.brushOption).updateCovers(e.areas.slice())},t.prototype.dispose=function(){this._brushController.dispose()},t.prototype._onBrush=function(e){var t=this.model.id,a=this.model.brushTargetManager.setOutputRanges(e.areas,this.ecModel);(!e.isEnd||e.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:t,areas:cGe(a),$from:t}),e.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:t,areas:cGe(a),$from:t})},t.type="brush",t}(n6e),Lwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.areas=[],a.brushOption={},a}return zHe(t,e),t.prototype.optionUpdated=function(e,t){var a=this.option;!t&&xwt(a,e,["inBrush","outOfBrush"]);var n=a.inBrush=a.inBrush||{};a.outOfBrush=a.outOfBrush||{color:this.option.defaultOutOfBrushColor},n.hasOwnProperty("liftZ")||(n.liftZ=5)},t.prototype.setAreas=function(e){e&&(this.areas=yGe(e,function(e){return Nwt(this.option,e)},this))},t.prototype.setBrushOption=function(e){this.brushOption=Nwt(this.option,e),this.brushType=this.brushOption.brushType},t.type="brush",t.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],t.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:o5e.color.backgroundTint,borderColor:o5e.color.borderTint},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4,defaultOutOfBrushColor:o5e.color.disabled},t}(i5e);function Nwt(e,t){return uGe({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new E1e(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick,z:e.z},t,!0)}var Owt=["rect","polygon","lineX","lineY","keep","clear"],Fwt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return zHe(t,e),t.prototype.render=function(e,t,a){var n,r,i;t.eachComponent({mainType:"brush"},function(e){n=e.brushType,r=e.brushOption.brushMode||"single",i=i||!!e.areas.length}),this._brushType=n,this._brushMode=r,gGe(e.get("type",!0),function(t){e.setIconStatus(t,("keep"===t?"multiple"===r:"clear"===t?i:t===n)?"emphasis":"normal")})},t.prototype.updateView=function(e,t,a){this.render(e,t,a)},t.prototype.getIcons=function(){var e=this.model,t=e.get("icon",!0),a={};return gGe(e.get("type",!0),function(e){t[e]&&(a[e]=t[e])}),a},t.prototype.onclick=function(e,t,a){var n=this._brushType,r=this._brushMode;"clear"===a?(t.dispatchAction({type:"axisAreaSelect",intervals:[]}),t.dispatchAction({type:"brush",command:"clear",areas:[]})):t.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===a?n:n!==a&&a,brushMode:"keep"===a?"multiple"===r?"single":"multiple":r}})},t.getDefaultOption=function(e){return{show:!0,type:Owt.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:e.getLocaleModel().get(["toolbox","brush","title"])}},t}(ixt);var Bwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.layoutMode={type:"box",ignoreSize:!0},a}return zHe(t,e),t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:"center",top:o5e.size.m,backgroundColor:o5e.color.transparent,borderColor:o5e.color.primary,borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:o5e.color.primary},subtextStyle:{fontSize:12,color:o5e.color.quaternary}},t}(i5e),Uwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){if(this.group.removeAll(),e.get("show")){var n=this.group,r=e.getModel("textStyle"),i=e.getModel("subtextStyle"),o=e.get("textAlign"),s=FGe(e.get("textBaseline"),e.get("textVerticalAlign")),l=new PZe({style:o1e(r,{text:e.get("text"),fill:r.getTextColor()},{disableBox:!0}),z2:10}),c=l.getBoundingRect(),u=e.get("subtext"),d=new PZe({style:o1e(i,{text:u,fill:i.getTextColor(),y:c.height+e.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),h=e.get("link"),p=e.get("sublink"),f=e.get("triggerEvent",!0);l.silent=!h&&!f,d.silent=!p&&!f,h&&l.on("click",function(){E2e(h,"_"+e.get("target"))}),p&&d.on("click",function(){E2e(p,"_"+e.get("subtarget"))}),YZe(l).eventData=YZe(d).eventData=f?{componentType:"title",componentIndex:e.componentIndex}:null,n.add(l),u&&n.add(d);var m=n.getBoundingRect(),v=e.getBoxLayoutParams();v.width=m.width,v.height=m.height;var g=$2e(v,J2e(e,a).refContainer,e.get("padding"));o||("middle"===(o=e.get("left")||e.get("right"))&&(o="center"),"right"===o?g.x+=g.width:"center"===o&&(g.x+=g.width/2)),s||("center"===(s=e.get("top")||e.get("bottom"))&&(s="middle"),"bottom"===s?g.y+=g.height:"middle"===s&&(g.y+=g.height/2),s=s||"top"),n.x=g.x,n.y=g.y,n.markRedraw();var y={align:o,verticalAlign:s};l.setStyle(y),d.setStyle(y),m=n.getBoundingRect();var b=g.margin,x=e.getItemStyle(["color","opacity"]);x.fill=e.get("backgroundColor");var w=new EZe({shape:{x:m.x-b[3],y:m.y-b[0],width:m.width+b[1]+b[3],height:m.height+b[0]+b[2],r:e.get("borderRadius")},style:x,subPixelOptimize:!0,silent:!0});n.add(w)}},t.type="title",t}(n6e);function zwt(e){e.registerComponentModel(Bwt),e.registerComponentView(Uwt)}var Vwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.layoutMode="box",a}return zHe(t,e),t.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a),this._initData()},t.prototype.mergeOption=function(t){e.prototype.mergeOption.apply(this,arguments),this._initData()},t.prototype.setCurrentIndex=function(e){null==e&&(e=this.option.currentIndex);var t=this._data.count();this.option.loop?e=(e%t+t)%t:(e>=t&&(e=t-1),e<0&&(e=0)),this.option.currentIndex=e},t.prototype.getCurrentIndex=function(){return this.option.currentIndex},t.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},t.prototype.setPlayState=function(e){this.option.autoPlay=!!e},t.prototype.getPlayState=function(){return!!this.option.autoPlay},t.prototype._initData=function(){var e,t=this.option,a=t.data||[],n=t.axisType,r=this._names=[];"category"===n?(e=[],gGe(a,function(t,a){var n,i=h$e(s$e(t),"");IGe(t)?(n=cGe(t)).value=a:n=a,e.push(n),r.push(i)})):e=a;var i={category:"ordinal",time:"time",value:"number"}[n]||"number";(this._data=new I9e([{name:"value",type:i}],this)).initData(e,r)},t.prototype.getData=function(){return this._data},t.prototype.getCategories=function(){if("category"===this.get("axisType"))return this._names.slice()},t.type="timeline",t.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:o5e.size.m,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:o5e.color.secondary},data:[]},t}(i5e),Hwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="timeline.slider",t.defaultOption=D1e(Vwt.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:o5e.color.border,borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:o5e.color.accent10},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:o5e.color.tertiary},itemStyle:{color:o5e.color.accent20,borderWidth:0},checkpointStyle:{symbol:"circle",symbolSize:15,color:o5e.color.accent50,borderColor:o5e.color.accent50,borderWidth:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0, 0, 0, 0)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M15 0C23.2843 0 30 6.71573 30 15C30 23.2843 23.2843 30 15 30C6.71573 30 0 23.2843 0 15C0 6.71573 6.71573 0 15 0ZM15 3C8.37258 3 3 8.37258 3 15C3 21.6274 8.37258 27 15 27C21.6274 27 27 21.6274 27 15C27 8.37258 21.6274 3 15 3ZM11.5 10.6699C11.5 9.90014 12.3333 9.41887 13 9.80371L20.5 14.1338C21.1667 14.5187 21.1667 15.4813 20.5 15.8662L13 20.1963C12.3333 20.5811 11.5 20.0999 11.5 19.3301V10.6699Z",stopIcon:"path://M15 0C23.2843 0 30 6.71573 30 15C30 23.2843 23.2843 30 15 30C6.71573 30 0 23.2843 0 15C0 6.71573 6.71573 0 15 0ZM15 3C8.37258 3 3 8.37258 3 15C3 21.6274 8.37258 27 15 27C21.6274 27 27 21.6274 27 15C27 8.37258 21.6274 3 15 3ZM11.5 10C12.3284 10 13 10.6716 13 11.5V18.5C13 19.3284 12.3284 20 11.5 20C10.6716 20 10 19.3284 10 18.5V11.5C10 10.6716 10.6716 10 11.5 10ZM18.5 10C19.3284 10 20 10.6716 20 11.5V18.5C20 19.3284 19.3284 20 18.5 20C17.6716 20 17 19.3284 17 18.5V11.5C17 10.6716 17.6716 10 18.5 10Z",nextIcon:"path://M0.838834 18.7383C0.253048 18.1525 0.253048 17.2028 0.838834 16.617L7.55635 9.89949L0.838834 3.18198C0.253048 2.59619 0.253048 1.64645 0.838834 1.06066C1.42462 0.474874 2.37437 0.474874 2.96015 1.06066L10.7383 8.83883L10.8412 8.95277C11.2897 9.50267 11.2897 10.2963 10.8412 10.8462L10.7383 10.9602L2.96015 18.7383C2.37437 19.3241 1.42462 19.3241 0.838834 18.7383Z",prevIcon:"path://M10.9602 1.06066C11.5459 1.64645 11.5459 2.59619 10.9602 3.18198L4.24264 9.89949L10.9602 16.617C11.5459 17.2028 11.5459 18.1525 10.9602 18.7383C10.3744 19.3241 9.42462 19.3241 8.83883 18.7383L1.06066 10.9602L0.957771 10.8462C0.509245 10.2963 0.509245 9.50267 0.957771 8.95277L1.06066 8.83883L8.83883 1.06066C9.42462 0.474874 10.3744 0.474874 10.9602 1.06066Z",prevBtnSize:18,nextBtnSize:18,color:o5e.color.accent50,borderColor:o5e.color.accent50,borderWidth:0},emphasis:{label:{show:!0,color:o5e.color.accent60},itemStyle:{color:o5e.color.accent60,borderColor:o5e.color.accent60},controlStyle:{color:o5e.color.accent70,borderColor:o5e.color.accent70}},progress:{lineStyle:{color:o5e.color.accent30},itemStyle:{color:o5e.color.accent40}},data:[]}),t}(Vwt);mGe(Hwt,Y4e.prototype);var Gwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="timeline",t}(n6e),Wwt=function(e){function t(t,a,n,r){var i=e.call(this,t,a,n)||this;return i.type=r||"value",i}return zHe(t,e),t.prototype.getLabelModel=function(){return this.model.getModel("label")},t.prototype.isHorizontal=function(){return"horizontal"===this.model.get("orient")},t}(Dtt),qwt=Math.PI,Ywt=v$e(),jwt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(e,t){this.api=t},t.prototype.render=function(e,t,a){if(this.model=e,this.api=a,this.ecModel=t,this.group.removeAll(),e.get("show",!0)){var n=this._layout(e,a),r=this._createGroup("_mainGroup"),i=this._createGroup("_labelGroup"),o=this._axis=this._createAxis(n,e);e.formatTooltip=function(e){return P3e("nameValue",{noName:!0,value:o.scale.getLabel({value:e})})},gGe(["AxisLine","AxisTick","Control","CurrentPointer"],function(t){this["_render"+t](n,r,o,e)},this),this._renderAxisLabel(n,i,o,e),this._position(n,e)}this._doPlayStop(),this._updateTicksStatus()},t.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},t.prototype.dispose=function(){this._clearTimer()},t.prototype._layout=function(e,t){var a,n,r,i,o=e.get(["label","position"]),s=e.get("orient"),l=function(e,t){return $2e(e.getBoxLayoutParams(),J2e(e,t).refContainer,e.get("padding"))}(e,t),c={horizontal:"center",vertical:(a=null==o||"auto"===o?"horizontal"===s?l.y+l.height/2<t.getHeight()/2?"-":"+":l.x+l.width/2<t.getWidth()/2?"+":"-":CGe(o)?{horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[s][o]:o)>=0||"+"===a?"left":"right"},u={horizontal:a>=0||"+"===a?"top":"bottom",vertical:"middle"},d={horizontal:0,vertical:qwt/2},h="vertical"===s?l.height:l.width,p=e.getModel("controlStyle"),f=p.get("show",!0),m=f?p.get("itemSize"):0,v=f?p.get("itemGap"):0,g=m+v,y=e.get(["label","rotate"])||0;y=y*qwt/180;var b=p.get("position",!0),x=f&&p.get("showPlayBtn",!0),w=f&&p.get("showPrevBtn",!0),_=f&&p.get("showNextBtn",!0),S=0,M=h;"left"===b||"bottom"===b?(x&&(n=[0,0],S+=g),w&&(r=[S,0],S+=g),_&&(i=[M-m,0],M-=g)):(x&&(n=[M-m,0],M-=g),w&&(r=[0,0],S+=g),_&&(i=[M-m,0],M-=g));var T=[S,M];return e.get("inverse")&&T.reverse(),{viewRect:l,mainLength:h,orient:s,rotation:d[s],labelRotation:y,labelPosOpt:a,labelAlign:e.get(["label","align"])||c[s],labelBaseline:e.get(["label","verticalAlign"])||e.get(["label","baseline"])||u[s],playPosition:n,prevBtnPosition:r,nextBtnPosition:i,axisExtent:T,controlSize:m,controlGap:v}},t.prototype._position=function(e,t){var a=this._mainGroup,n=this._labelGroup,r=e.viewRect;if("vertical"===e.orient){var i=[1,0,0,1,0,0],o=r.x,s=r.y+r.height;KWe(i,i,[-o,-s]),ZWe(i,i,-qwt/2),KWe(i,i,[o,s]),(r=r.clone()).applyTransform(i)}var l=v(r),c=v(a.getBoundingRect()),u=v(n.getBoundingRect()),d=[a.x,a.y],h=[n.x,n.y];h[0]=d[0]=l[0][0];var p,f=e.labelPosOpt;null==f||CGe(f)?(g(d,c,l,1,p="+"===f?0:1),g(h,u,l,1,1-p)):(g(d,c,l,1,p=f>=0?0:1),h[1]=d[1]+f);function m(e){e.originX=l[0][0]-e.x,e.originY=l[1][0]-e.y}function v(e){return[[e.x,e.x+e.width],[e.y,e.y+e.height]]}function g(e,t,a,n,r){e[n]+=a[n][r]-t[n][r]}a.setPosition(d),n.setPosition(h),a.rotation=n.rotation=e.rotation,m(a),m(n)},t.prototype._createAxis=function(e,t){var a=t.getData(),n=t.get("axisType"),r=function(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new eet({ordinalMeta:e.getCategories(),extent:[1/0,-1/0]});case"time":return new get({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new aet}}(t,n);r.getTicks=function(){return a.mapArray(["value"],function(e){return{value:e}})};var i=a.getDataExtent("value");r.setExtent(i[0],i[1]),r.calcNiceTicks();var o=new Wwt("value",r,e.axisExtent,n);return o.model=t,o},t.prototype._createGroup=function(e){var t=this[e]=new xXe;return this.group.add(t),t},t.prototype._renderAxisLine=function(e,t,a,n){var r=a.getExtent();if(n.get(["lineStyle","show"])){var i=new UQe({shape:{x1:r[0],y1:0,x2:r[1],y2:0},style:hGe({lineCap:"round"},n.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});t.add(i);var o=this._progressLine=new UQe({shape:{x1:r[0],x2:this._currentPointer?this._currentPointer.x:r[0],y1:0,y2:0},style:pGe({lineCap:"round",lineWidth:i.style.lineWidth},n.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});t.add(o)}},t.prototype._renderAxisTick=function(e,t,a,n){var r=this,i=n.getData(),o=a.scale.getTicks();this._tickSymbols=[],gGe(o,function(e){var o=a.dataToCoord(e.value),s=i.getItemModel(e.value),l=s.getModel("itemStyle"),c=s.getModel(["emphasis","itemStyle"]),u=s.getModel(["progress","itemStyle"]),d={x:o,y:0,onclick:SGe(r._changeTimeline,r,e.value)},h=Xwt(s,l,t,d);h.ensureState("emphasis").style=c.getItemStyle(),h.ensureState("progress").style=u.getItemStyle(),NJe(h);var p=YZe(h);s.get("tooltip")?(p.dataIndex=e.value,p.dataModel=n):p.dataIndex=p.dataModel=null,r._tickSymbols.push(h)})},t.prototype._renderAxisLabel=function(e,t,a,n){var r=this;if(a.getLabelModel().get("show")){var i=n.getData(),o=a.getViewLabels();this._tickLabels=[],gGe(o,function(n){var o=n.tickValue,s=i.getItemModel(o),l=s.getModel("label"),c=s.getModel(["emphasis","label"]),u=s.getModel(["progress","label"]),d=a.dataToCoord(n.tickValue),h=new PZe({x:d,y:0,rotation:e.labelRotation-e.rotation,onclick:SGe(r._changeTimeline,r,o),silent:!1,style:o1e(l,{text:n.formattedLabel,align:e.labelAlign,verticalAlign:e.labelBaseline})});h.ensureState("emphasis").style=o1e(c),h.ensureState("progress").style=o1e(u),t.add(h),NJe(h),Ywt(h).dataIndex=o,r._tickLabels.push(h)})}},t.prototype._renderControl=function(e,t,a,n){var r=e.controlSize,i=e.rotation,o=n.getModel("controlStyle").getItemStyle(),s=n.getModel(["emphasis","controlStyle"]).getItemStyle(),l=n.getPlayState(),c=n.get("inverse",!0);function u(e,a,l,c){if(e){var u=sXe(FGe(n.get(["controlStyle",a+"BtnSize"]),r),r),d=function(e,t,a,n){var r=n.style,i=O0e(e.get(["controlStyle",t]),n||{},new fqe(a[0],a[1],a[2],a[3]));r&&i.setStyle(r);return i}(n,a+"Icon",[0,-u/2,u,u],{x:e[0],y:e[1],originX:r/2,originY:0,rotation:c?-i:0,rectHover:!0,style:o,onclick:l});d.ensureState("emphasis").style=s,t.add(d),NJe(d)}}u(e.nextBtnPosition,"next",SGe(this._changeTimeline,this,c?"-":"+")),u(e.prevBtnPosition,"prev",SGe(this._changeTimeline,this,c?"+":"-")),u(e.playPosition,l?"stop":"play",SGe(this._handlePlayClick,this,!l),!0)},t.prototype._renderCurrentPointer=function(e,t,a,n){var r=n.getData(),i=n.getCurrentIndex(),o=r.getItemModel(i).getModel("checkpointStyle"),s=this,l={onCreate:function(e){e.draggable=!0,e.drift=SGe(s._handlePointerDrag,s),e.ondragend=SGe(s._handlePointerDragend,s),$wt(e,s._progressLine,i,a,n,!0)},onUpdate:function(e){$wt(e,s._progressLine,i,a,n)}};this._currentPointer=Xwt(o,o,this._mainGroup,{},this._currentPointer,l)},t.prototype._handlePlayClick=function(e){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:e,from:this.uid})},t.prototype._handlePointerDrag=function(e,t,a){this._clearTimer(),this._pointerChangeTimeline([a.offsetX,a.offsetY])},t.prototype._handlePointerDragend=function(e){this._pointerChangeTimeline([e.offsetX,e.offsetY],!0)},t.prototype._pointerChangeTimeline=function(e,t){var a=this._toAxisCoord(e)[0],n=LXe(this._axis.getExtent().slice());a>n[1]&&(a=n[1]),a<n[0]&&(a=n[0]),this._currentPointer.x=a,this._currentPointer.markRedraw();var r=this._progressLine;r&&(r.shape.x2=a,r.dirty());var i=this._findNearestTick(a),o=this.model;(t||i!==o.getCurrentIndex()&&o.get("realtime"))&&this._changeTimeline(i)},t.prototype._doPlayStop=function(){var e=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var t=e.model;e._changeTimeline(t.getCurrentIndex()+(t.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},t.prototype._toAxisCoord=function(e){return R0e(e,this._mainGroup.getLocalTransform(),!0)},t.prototype._findNearestTick=function(e){var t,a=this.model.getData(),n=1/0,r=this._axis;return a.each(["value"],function(a,i){var o=r.dataToCoord(a),s=Math.abs(o-e);s<n&&(n=s,t=i)}),t},t.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._changeTimeline=function(e){var t=this.model.getCurrentIndex();"+"===e?e=t+1:"-"===e&&(e=t-1),this.api.dispatchAction({type:"timelineChange",currentIndex:e,from:this.uid})},t.prototype._updateTicksStatus=function(){var e=this.model.getCurrentIndex(),t=this._tickSymbols,a=this._tickLabels;if(t)for(var n=0;n<t.length;n++)t&&t[n]&&t[n].toggleState("progress",n<e);if(a)for(n=0;n<a.length;n++)a&&a[n]&&a[n].toggleState("progress",Ywt(a[n]).dataIndex<=e)},t.type="timeline.slider",t}(Gwt);function Xwt(e,t,a,n,r,i){var o=t.get("color");r?(r.setColor(o),a.add(r),i&&i.onUpdate(r)):((r=y8e(e.get("symbol"),-1,-1,2,2,o)).setStyle("strokeNoScale",!0),a.add(r),i&&i.onCreate(r));var s=t.getItemStyle(["color"]);r.setStyle(s),n=uGe({rectHover:!0,z2:100},n,!0);var l=b8e(e.get("symbolSize"));n.scaleX=l[0]/2,n.scaleY=l[1]/2;var c=x8e(e.get("symbolOffset"),l);c&&(n.x=(n.x||0)+c[0],n.y=(n.y||0)+c[1]);var u=e.get("symbolRotate");return n.rotation=(u||0)*Math.PI/180||0,r.attr(n),r.updateTransform(),r}function $wt(e,t,a,n,r,i){if(!e.dragging){var o=r.getModel("checkpointStyle"),s=n.dataToCoord(r.getData().get("value",a));if(i||!o.get("animation",!0))e.attr({x:s,y:0}),t&&t.attr({shape:{x2:s}});else{var l={duration:o.get("animationDuration",!0),easing:o.get("animationEasing",!0)};e.stopAnimation(null,!0),e.animateTo({x:s,y:0},l),t&&t.animateTo({shape:{x2:s}},l)}}}function Kwt(e){var t=e&&e.timeline;TGe(t)||(t=t?[t]:[]),gGe(t,function(e){e&&function(e){var t=e.type,a={number:"value",time:"time"};a[t]&&(e.axisType=a[t],delete e.type);if(Zwt(e),Jwt(e,"controlPosition")){var n=e.controlStyle||(e.controlStyle={});Jwt(n,"position")||(n.position=e.controlPosition),"none"!==n.position||Jwt(n,"show")||(n.show=!1,delete n.position),delete e.controlPosition}gGe(e.data||[],function(e){IGe(e)&&!TGe(e)&&(!Jwt(e,"value")&&Jwt(e,"name")&&(e.value=e.name),Zwt(e))})}(e)})}function Zwt(e){var t=e.itemStyle||(e.itemStyle={}),a=t.emphasis||(t.emphasis={}),n=e.label||e.label||{},r=n.normal||(n.normal={}),i={normal:1,emphasis:1};gGe(n,function(e,t){i[t]||Jwt(r,t)||(r[t]=e)}),a.label&&!Jwt(n,"emphasis")&&(n.emphasis=a.label,delete a.label)}function Jwt(e,t){return e.hasOwnProperty(t)}function Qwt(e,t){if(!e)return!1;for(var a=TGe(e)?e:[e],n=0;n<a.length;n++)if(a[n]&&a[n][t])return!0;return!1}function e_t(e){i$e(e,"label",["show"])}var t_t=v$e(),a_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.createdBySelf=!1,a.preventAutoZ=!0,a}return zHe(t,e),t.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a),this._mergeOption(e,a,!1,!0)},t.prototype.isAnimationEnabled=function(){if(HHe.node)return!1;var e=this.__hostSeries;return this.getShallow("animation")&&e&&e.isAnimationEnabled()},t.prototype.mergeOption=function(e,t){this._mergeOption(e,t,!1,!1)},t.prototype._mergeOption=function(e,t,a,n){var r=this.mainType;a||t.eachSeries(function(e){var a=e.get(this.mainType,!0),i=t_t(e)[r];a&&a.data?(i?i._mergeOption(a,t,!0):(n&&e_t(a),gGe(a.data,function(e){e instanceof Array?(e_t(e[0]),e_t(e[1])):e_t(e)}),hGe(i=this.createMarkerModelFromSeries(a,this,t),{mainType:this.mainType,seriesIndex:e.seriesIndex,name:e.name,createdBySelf:!0}),i.__hostSeries=e),t_t(e)[r]=i):t_t(e)[r]=null},this)},t.prototype.formatTooltip=function(e,t,a){var n=this.getData(),r=this.getRawValue(e),i=n.getName(e);return P3e("section",{header:this.name,blocks:[P3e("nameValue",{name:i,value:r,noName:!i,noValue:null==r})]})},t.prototype.getData=function(){return this._data},t.prototype.setData=function(e){this._data=e},t.prototype.getDataParams=function(e,t){var a=Y4e.prototype.getDataParams.call(this,e,t),n=this.__hostSeries;return n&&(a.seriesId=n.id,a.seriesName=n.name,a.seriesType=n.subType),a},t.getMarkerModelFromSeries=function(e,t){return t_t(e)[t]},t.type="marker",t.dependencies=["series","grid","polar","geo"],t}(i5e);mGe(a_t,Y4e.prototype);var n_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.createMarkerModelFromSeries=function(e,a,n){return new t(e,a,n)},t.type="markPoint",t.defaultOption={z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},t}(a_t);function r_t(e){return!(isNaN(parseFloat(e.x))&&isNaN(parseFloat(e.y)))}function i_t(e,t,a,n,r,i,o){var s=[],l=F9e(t,r)?t.getCalculationInfo("stackResultDimension"):r,c=d_t(t,l,e),u=t.hostModel.indicesOfNearest(a,l,c)[0];s[i]=t.get(n,u),s[o]=t.get(l,u);var d=t.get(r,u),h=NXe(t.get(r,u));return(h=Math.min(h,20))>=0&&(s[o]=+s[o].toFixed(h)),[s,d]}var o_t={min:MGe(i_t,"min"),max:MGe(i_t,"max"),average:MGe(i_t,"average"),median:MGe(i_t,"median")};function s_t(e,t){if(t){var a=e.getData(),n=e.coordinateSystem,r=n&&n.dimensions;if(!function(e){return!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y))}(t)&&!TGe(t.coord)&&TGe(r)){var i=l_t(t,a,n,e);if((t=cGe(t)).type&&o_t[t.type]&&i.baseAxis&&i.valueAxis){var o=fGe(r,i.baseAxis.dim),s=fGe(r,i.valueAxis.dim),l=o_t[t.type](a,i.valueAxis.dim,i.baseDataDim,i.valueDataDim,o,s);t.coord=l[0],t.value=l[1]}else t.coord=[null!=t.xAxis?t.xAxis:t.radiusAxis,null!=t.yAxis?t.yAxis:t.angleAxis]}if(null!=t.coord&&TGe(r))for(var c=t.coord,u=0;u<2;u++)o_t[c[u]]&&(c[u]=d_t(a,a.mapDimension(r[u]),c[u]));else{t.coord=[];var d=e.getBaseAxis();if(d&&t.type&&o_t[t.type]){var h=n.getOtherAxis(d);h&&(t.value=d_t(a,a.mapDimension(h.dim),t.type))}}return t}}function l_t(e,t,a,n){var r={};return null!=e.valueIndex||null!=e.valueDim?(r.valueDataDim=null!=e.valueIndex?t.getDimension(e.valueIndex):e.valueDim,r.valueAxis=a.getAxis(function(e,t){var a=e.getData().getDimensionInfo(t);return a&&a.coordDim}(n,r.valueDataDim)),r.baseAxis=a.getOtherAxis(r.valueAxis),r.baseDataDim=t.mapDimension(r.baseAxis.dim)):(r.baseAxis=n.getBaseAxis(),r.valueAxis=a.getOtherAxis(r.baseAxis),r.baseDataDim=t.mapDimension(r.baseAxis.dim),r.valueDataDim=t.mapDimension(r.valueAxis.dim)),r}function c_t(e,t){return!(e&&e.containData&&t.coord&&!r_t(t))||e.containData(t.coord)}function u_t(e,t){return e?function(e,a,n,r){return Z4e(r<2?e.coord&&e.coord[r]:e.value,t[r])}:function(e,a,n,r){return Z4e(e.value,t[r])}}function d_t(e,t,a){if("average"===a){var n=0,r=0;return e.each(t,function(e,t){isNaN(e)||(n+=e,r++)}),n/r}return"median"===a?e.getMedian(t):e.getDataExtent(t)["max"===a?1:0]}var h_t=v$e(),p_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.init=function(){this.markerGroupMap=$Ge()},t.prototype.render=function(e,t,a){var n=this,r=this.markerGroupMap;r.each(function(e){h_t(e).keep=!1}),t.eachSeries(function(e){var r=a_t.getMarkerModelFromSeries(e,n.type);r&&n.renderSeries(e,r,t,a)}),r.each(function(e){!h_t(e).keep&&n.group.remove(e.group)}),function(e,t,a){e.eachSeries(function(e){var n=a_t.getMarkerModelFromSeries(e,a),r=t.get(e.id);if(n&&r&&r.group){var i=K0e(n),o=i.z,s=i.zlevel;J0e(r.group,o,s)}})}(t,r,this.type)},t.prototype.markKeep=function(e){h_t(e).keep=!0},t.prototype.toggleBlurSeries=function(e,t){var a=this;gGe(e,function(e){var n=a_t.getMarkerModelFromSeries(e,a.type);n&&n.getData().eachItemGraphicEl(function(e){e&&(t?MJe(e):TJe(e))})})},t.type="marker",t}(n6e);function f_t(e,t,a){var n=t.coordinateSystem,r=a.getWidth(),i=a.getHeight(),o=n&&n.getArea&&n.getArea();e.each(function(a){var s,l=e.getItemModel(a),c="coordinate"===l.get("relativeTo"),u=c?o?o.width:0:r,d=c?o?o.height:0:i,h=c&&o?o.x:0,p=c&&o?o.y:0,f=RXe(l.get("x"),u)+h,m=RXe(l.get("y"),d)+p;if(isNaN(f)||isNaN(m)){if(t.getMarkerPosition)s=t.getMarkerPosition(e.getValues(e.dimensions,a));else if(n){var v=e.get(n.dimensions[0],a),g=e.get(n.dimensions[1],a);s=n.dataToPoint([v,g])}}else s=[f,m];isNaN(f)||(s[0]=f),isNaN(m)||(s[1]=m),e.setItemLayout(a,s)})}var m_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.updateTransform=function(e,t,a){t.eachSeries(function(e){var t=a_t.getMarkerModelFromSeries(e,"markPoint");t&&(f_t(t.getData(),e,a),this.markerGroupMap.get(e.id).updateLayout())},this)},t.prototype.renderSeries=function(e,t,a,n){var r=e.coordinateSystem,i=e.id,o=e.getData(),s=this.markerGroupMap,l=s.get(i)||s.set(i,new Qnt),c=function(e,t,a){var n;n=e?yGe(e&&e.dimensions,function(e){return hGe(hGe({},t.getData().getDimensionInfo(t.getData().mapDimension(e))||{}),{name:e,ordinalMeta:null})}):[{name:"value",type:"float"}];var r=new I9e(n,a),i=yGe(a.get("data"),MGe(s_t,t));e&&(i=xGe(i,MGe(c_t,e)));var o=u_t(!!e,n);return r.initData(i,null,o),r}(r,e,t);t.setData(c),f_t(t.getData(),e,n),c.each(function(e){var a=c.getItemModel(e),n=a.getShallow("symbol"),r=a.getShallow("symbolSize"),i=a.getShallow("symbolRotate"),s=a.getShallow("symbolOffset"),l=a.getShallow("symbolKeepAspect");if(kGe(n)||kGe(r)||kGe(i)||kGe(s)){var u=t.getRawValue(e),d=t.getDataParams(e);kGe(n)&&(n=n(u,d)),kGe(r)&&(r=r(u,d)),kGe(i)&&(i=i(u,d)),kGe(s)&&(s=s(u,d))}var h=a.getModel("itemStyle").getItemStyle(),p=a.get("z2"),f=a8e(o,"color");h.fill||(h.fill=f),c.setItemVisual(e,{z2:FGe(p,0),symbol:n,symbolSize:r,symbolRotate:i,symbolOffset:s,symbolKeepAspect:l,style:h})}),l.updateData(c),this.group.add(l.group),c.eachItemGraphicEl(function(e){e.traverse(function(e){YZe(e).dataModel=t})}),this.markKeep(l),l.group.silent=t.get("silent")||e.get("silent")},t.type="markPoint",t}(p_t);var v_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.createMarkerModelFromSeries=function(e,a,n){return new t(e,a,n)},t.type="markLine",t.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},t}(a_t),g_t=v$e(),y_t=function(e,t,a,n){var r,i=e.getData();if(TGe(n))r=n;else{var o=n.type;if("min"===o||"max"===o||"average"===o||"median"===o||null!=n.xAxis||null!=n.yAxis){var s=void 0,l=void 0;if(null!=n.yAxis||null!=n.xAxis)s=t.getAxis(null!=n.yAxis?"y":"x"),l=OGe(n.yAxis,n.xAxis);else{var c=l_t(n,i,t,e);s=c.valueAxis,l=d_t(i,B9e(i,c.valueDataDim),o)}var u="x"===s.dim?0:1,d=1-u,h=cGe(n),p={coord:[]};h.type=null,h.coord=[],h.coord[d]=-1/0,p.coord[d]=1/0;var f=a.get("precision");f>=0&&EGe(l)&&(l=+l.toFixed(Math.min(f,20))),h.coord[u]=p.coord[u]=l,r=[h,p,{type:o,valueIndex:n.valueIndex,value:l}]}else r=[]}var m=[s_t(e,r[0]),s_t(e,r[1]),hGe({},r[2])];return m[2].type=m[2].type||null,uGe(m[2],m[0]),uGe(m[2],m[1]),m};function b_t(e){return!isNaN(e)&&!isFinite(e)}function x_t(e,t,a,n){var r=1-e,i=n.dimensions[e];return b_t(t[r])&&b_t(a[r])&&t[e]===a[e]&&n.getAxis(i).containData(t[e])}function w_t(e,t){if("cartesian2d"===e.type){var a=t[0].coord,n=t[1].coord;if(a&&n&&(x_t(1,a,n,e)||x_t(0,a,n,e)))return!0}return c_t(e,t[0])&&c_t(e,t[1])}function __t(e,t,a,n,r){var i,o=n.coordinateSystem,s=e.getItemModel(t),l=RXe(s.get("x"),r.getWidth()),c=RXe(s.get("y"),r.getHeight());if(isNaN(l)||isNaN(c)){if(n.getMarkerPosition)i=n.getMarkerPosition(e.getValues(e.dimensions,t));else{var u=o.dimensions,d=e.get(u[0],t),h=e.get(u[1],t);i=o.dataToPoint([d,h])}if(prt(o,"cartesian2d")){var p=o.getAxis("x"),f=o.getAxis("y");u=o.dimensions;b_t(e.get(u[0],t))?i[0]=p.toGlobalCoord(p.getExtent()[a?0:1]):b_t(e.get(u[1],t))&&(i[1]=f.toGlobalCoord(f.getExtent()[a?0:1]))}isNaN(l)||(i[0]=l),isNaN(c)||(i[1]=c)}else i=[l,c];e.setItemLayout(t,i)}var S_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.updateTransform=function(e,t,a){t.eachSeries(function(e){var t=a_t.getMarkerModelFromSeries(e,"markLine");if(t){var n=t.getData(),r=g_t(t).from,i=g_t(t).to;r.each(function(t){__t(r,t,!0,e,a),__t(i,t,!1,e,a)}),n.each(function(e){n.setItemLayout(e,[r.getItemLayout(e),i.getItemLayout(e)])}),this.markerGroupMap.get(e.id).updateLayout()}},this)},t.prototype.renderSeries=function(e,t,a,n){var r=e.coordinateSystem,i=e.id,o=e.getData(),s=this.markerGroupMap,l=s.get(i)||s.set(i,new bdt);this.group.add(l.group);var c=function(e,t,a){var n;n=e?yGe(e&&e.dimensions,function(e){return hGe(hGe({},t.getData().getDimensionInfo(t.getData().mapDimension(e))||{}),{name:e,ordinalMeta:null})}):[{name:"value",type:"float"}];var r=new I9e(n,a),i=new I9e(n,a),o=new I9e([],a),s=yGe(a.get("data"),MGe(y_t,t,e,a));e&&(s=xGe(s,MGe(w_t,e)));var l=u_t(!!e,n);return r.initData(yGe(s,function(e){return e[0]}),null,l),i.initData(yGe(s,function(e){return e[1]}),null,l),o.initData(yGe(s,function(e){return e[2]})),o.hasItemOption=!0,{from:r,to:i,line:o}}(r,e,t),u=c.from,d=c.to,h=c.line;g_t(t).from=u,g_t(t).to=d,t.setData(h);var p=t.get("symbol"),f=t.get("symbolSize"),m=t.get("symbolRotate"),v=t.get("symbolOffset");function g(t,a,r){var i=t.getItemModel(a);__t(t,a,r,e,n);var s=i.getModel("itemStyle").getItemStyle();null==s.fill&&(s.fill=a8e(o,"color")),t.setItemVisual(a,{symbolKeepAspect:i.get("symbolKeepAspect"),symbolOffset:FGe(i.get("symbolOffset",!0),v[r?0:1]),symbolRotate:FGe(i.get("symbolRotate",!0),m[r?0:1]),symbolSize:FGe(i.get("symbolSize"),f[r?0:1]),symbol:FGe(i.get("symbol",!0),p[r?0:1]),style:s})}TGe(p)||(p=[p,p]),TGe(f)||(f=[f,f]),TGe(m)||(m=[m,m]),TGe(v)||(v=[v,v]),c.from.each(function(e){g(u,e,!0),g(d,e,!1)}),h.each(function(e){var t=h.getItemModel(e),a=t.getModel("lineStyle").getLineStyle();h.setItemLayout(e,[u.getItemLayout(e),d.getItemLayout(e)]);var n=t.get("z2");null==a.stroke&&(a.stroke=u.getItemVisual(e,"style").fill),h.setItemVisual(e,{z2:FGe(n,0),fromSymbolKeepAspect:u.getItemVisual(e,"symbolKeepAspect"),fromSymbolOffset:u.getItemVisual(e,"symbolOffset"),fromSymbolRotate:u.getItemVisual(e,"symbolRotate"),fromSymbolSize:u.getItemVisual(e,"symbolSize"),fromSymbol:u.getItemVisual(e,"symbol"),toSymbolKeepAspect:d.getItemVisual(e,"symbolKeepAspect"),toSymbolOffset:d.getItemVisual(e,"symbolOffset"),toSymbolRotate:d.getItemVisual(e,"symbolRotate"),toSymbolSize:d.getItemVisual(e,"symbolSize"),toSymbol:d.getItemVisual(e,"symbol"),style:a})}),l.updateData(h),c.line.eachItemGraphicEl(function(e){YZe(e).dataModel=t,e.traverse(function(e){YZe(e).dataModel=t})}),this.markKeep(l),l.group.silent=t.get("silent")||e.get("silent")},t.type="markLine",t}(p_t);function M_t(e){e.registerComponentModel(v_t),e.registerComponentView(S_t),e.registerPreprocessor(function(e){Qwt(e.series,"markLine")&&(e.markLine=e.markLine||{})})}var T_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.createMarkerModelFromSeries=function(e,a,n){return new t(e,a,n)},t.type="markArea",t.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},t}(a_t),k_t=v$e(),C_t=function(e,t,a,n){var r=n[0],i=n[1];if(r&&i){var o=s_t(e,r),s=s_t(e,i),l=o.coord,c=s.coord;l[0]=OGe(l[0],-1/0),l[1]=OGe(l[1],-1/0),c[0]=OGe(c[0],1/0),c[1]=OGe(c[1],1/0);var u=dGe([{},o,s]);return u.coord=[o.coord,s.coord],u.x0=o.x,u.y0=o.y,u.x1=s.x,u.y1=s.y,u}};function A_t(e){return!isNaN(e)&&!isFinite(e)}function E_t(e,t,a,n){var r=1-e;return A_t(t[r])&&A_t(a[r])}function I_t(e,t){var a=t.coord[0],n=t.coord[1],r={coord:a,x:t.x0,y:t.y0},i={coord:n,x:t.x1,y:t.y1};return prt(e,"cartesian2d")?!(!a||!n||!E_t(1,a,n)&&!E_t(0,a,n))||function(e,t,a){return!(e&&e.containZone&&t.coord&&a.coord&&!r_t(t)&&!r_t(a))||e.containZone(t.coord,a.coord)}(e,r,i):c_t(e,r)||c_t(e,i)}function R_t(e,t,a,n,r){var i,o=n.coordinateSystem,s=e.getItemModel(t),l=RXe(s.get(a[0]),r.getWidth()),c=RXe(s.get(a[1]),r.getHeight());if(isNaN(l)||isNaN(c)){if(n.getMarkerPosition){var u=e.getValues(["x0","y0"],t),d=e.getValues(["x1","y1"],t),h=o.clampData(u),p=o.clampData(d),f=[];"x0"===a[0]?f[0]=h[0]>p[0]?d[0]:u[0]:f[0]=h[0]>p[0]?u[0]:d[0],"y0"===a[1]?f[1]=h[1]>p[1]?d[1]:u[1]:f[1]=h[1]>p[1]?u[1]:d[1],i=n.getMarkerPosition(f,a,!0)}else{var m=[y=e.get(a[0],t),b=e.get(a[1],t)];o.clampData&&o.clampData(m,m),i=o.dataToPoint(m,!0)}if(prt(o,"cartesian2d")){var v=o.getAxis("x"),g=o.getAxis("y"),y=e.get(a[0],t),b=e.get(a[1],t);A_t(y)?i[0]=v.toGlobalCoord(v.getExtent()["x0"===a[0]?0:1]):A_t(b)&&(i[1]=g.toGlobalCoord(g.getExtent()["y0"===a[1]?0:1]))}isNaN(l)||(i[0]=l),isNaN(c)||(i[1]=c)}else i=[l,c];return i}var D_t=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],P_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.updateTransform=function(e,t,a){t.eachSeries(function(e){var t=a_t.getMarkerModelFromSeries(e,"markArea");if(t){var n=t.getData();n.each(function(t){var r=yGe(D_t,function(r){return R_t(n,t,r,e,a)});n.setItemLayout(t,r),n.getItemGraphicEl(t).setShape("points",r)})}},this)},t.prototype.renderSeries=function(e,t,a,n){var r=e.coordinateSystem,i=e.id,o=e.getData(),s=this.markerGroupMap,l=s.get(i)||s.set(i,{group:new xXe});this.group.add(l.group),this.markKeep(l);var c=function(e,t,a){var n,r,i=["x0","y0","x1","y1"];if(e){var o=yGe(e&&e.dimensions,function(e){var a=t.getData();return hGe(hGe({},a.getDimensionInfo(a.mapDimension(e))||{}),{name:e,ordinalMeta:null})});r=yGe(i,function(e,t){return{name:e,type:o[t%2].type}}),n=new I9e(r,a)}else n=new I9e(r=[{name:"value",type:"float"}],a);var s=yGe(a.get("data"),MGe(C_t,t,e,a));e&&(s=xGe(s,MGe(I_t,e)));var l=e?function(e,t,a,n){return Z4e(e.coord[Math.floor(n/2)][n%2],r[n])}:function(e,t,a,n){return Z4e(e.value,r[n])};return n.initData(s,null,l),n.hasItemOption=!0,n}(r,e,t);t.setData(c),c.each(function(t){var a=yGe(D_t,function(a){return R_t(c,t,a,e,n)}),i=r.getAxis("x").scale,s=r.getAxis("y").scale,l=i.getExtent(),u=s.getExtent(),d=[i.parse(c.get("x0",t)),i.parse(c.get("x1",t))],h=[s.parse(c.get("y0",t)),s.parse(c.get("y1",t))];LXe(d),LXe(h);var p=!!(l[0]>d[1]||l[1]<d[0]||u[0]>h[1]||u[1]<h[0]);c.setItemLayout(t,{points:a,allClipped:p});var f=c.getItemModel(t),m=f.getModel("itemStyle").getItemStyle(),v=f.get("z2"),g=a8e(o,"color");m.fill||(m.fill=g,CGe(m.fill)&&(m.fill=LYe(m.fill,.4))),m.stroke||(m.stroke=g),c.setItemVisual(t,"style",m),c.setItemVisual(t,"z2",FGe(v,0))}),c.diff(k_t(l).data).add(function(e){var t=c.getItemLayout(e),a=c.getItemVisual(e,"z2");if(!t.allClipped){var n=new LQe({z2:FGe(a,0),shape:{points:t.points}});c.setItemGraphicEl(e,n),l.group.add(n)}}).update(function(e,a){var n=k_t(l).data.getItemGraphicEl(a),r=c.getItemLayout(e),i=c.getItemVisual(e,"z2");r.allClipped?n&&l.group.remove(n):(n?u0e(n,{z2:FGe(i,0),shape:{points:r.points}},t,e):n=new LQe({shape:{points:r.points}}),c.setItemGraphicEl(e,n),l.group.add(n))}).remove(function(e){var t=k_t(l).data.getItemGraphicEl(e);l.group.remove(t)}).execute(),c.eachItemGraphicEl(function(e,a){var n=c.getItemModel(a),r=c.getItemVisual(a,"style");e.useStyle(c.getItemVisual(a,"style")),r1e(e,i1e(n),{labelFetcher:t,labelDataIndex:a,defaultText:c.getName(a)||"",inheritColor:CGe(r.fill)?LYe(r.fill,1):o5e.color.neutral99}),zJe(e,n),OJe(e,null,null,n.get(["emphasis","disabled"])),YZe(e).dataModel=t}),k_t(l).data=c,l.group.silent=t.get("silent")||e.get("silent")},t.type="markArea",t}(p_t);var L_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.layoutMode={type:"box",ignoreSize:!0},a}return zHe(t,e),t.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a),e.selected=e.selected||{},this._updateSelector(e)},t.prototype.mergeOption=function(t,a){e.prototype.mergeOption.call(this,t,a),this._updateSelector(t)},t.prototype._updateSelector=function(e){var t=e.selector,a=this.ecModel;!0===t&&(t=e.selector=["all","inverse"]),TGe(t)&&gGe(t,function(e,n){CGe(e)&&(e={type:e}),t[n]=uGe(e,function(e,t){return"all"===t?{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])}:"inverse"===t?{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}:void 0}(a,e.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&"single"===this.get("selectedMode")){for(var t=!1,a=0;a<e.length;a++){var n=e[a].get("name");if(this.isSelected(n)){this.select(n),t=!0;break}}!t&&this.select(e[0].get("name"))}},t.prototype._updateData=function(e){var t=[],a=[];e.eachRawSeries(function(n){var r,i=n.name;if(a.push(i),n.legendVisualProvider){var o=n.legendVisualProvider.getAllNames();e.isSeriesFiltered(n)||(a=a.concat(o)),o.length?t=t.concat(o):r=!0}else r=!0;r&&p$e(n)&&t.push(n.name)}),this._availableNames=a;var n=this.get("data")||t,r=$Ge(),i=yGe(n,function(e){return(CGe(e)||EGe(e))&&(e={name:e}),r.get(e.name)?null:(r.set(e.name,!0),new E1e(e,this,this.ecModel))},this);this._data=xGe(i,function(e){return!!e})},t.prototype.getData=function(){return this._data},t.prototype.select=function(e){var t=this.option.selected;"single"===this.get("selectedMode")&&gGe(this._data,function(e){t[e.get("name")]=!1});t[e]=!0},t.prototype.unSelect=function(e){"single"!==this.get("selectedMode")&&(this.option.selected[e]=!1)},t.prototype.toggleSelected=function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},t.prototype.allSelect=function(){var e=this._data,t=this.option.selected;gGe(e,function(e){t[e.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var e=this._data,t=this.option.selected;gGe(e,function(e){var a=e.get("name",!0);t.hasOwnProperty(a)||(t[a]=!0),t[a]=!t[a]})},t.prototype.isSelected=function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&fGe(this._availableNames,e)>=0},t.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",bottom:o5e.size.m,align:"auto",backgroundColor:o5e.color.transparent,borderColor:o5e.color.border,borderRadius:0,borderWidth:0,padding:5,itemGap:8,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:o5e.color.disabled,inactiveBorderColor:o5e.color.disabled,inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:o5e.color.disabled,inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:o5e.color.secondary},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:o5e.color.tertiary,borderWidth:1,borderColor:o5e.color.border},emphasis:{selectorLabel:{show:!0,color:o5e.color.quaternary}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1},triggerEvent:!1},t}(i5e),N_t=MGe,O_t=gGe,F_t=xXe,B_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.newlineDisabled=!1,a}return zHe(t,e),t.prototype.init=function(){this.group.add(this._contentGroup=new F_t),this.group.add(this._selectorGroup=new F_t),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(e,t,a){var n=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),e.get("show",!0)){var r=e.get("align"),i=e.get("orient");r&&"auto"!==r||(r="right"===e.get("left")&&"vertical"===i?"right":"left");var o=e.get("selector",!0),s=e.get("selectorPosition",!0);!o||s&&"auto"!==s||(s="horizontal"===i?"end":"start"),this.renderInner(r,e,t,a,o,i,s);var l=J2e(e,a).refContainer,c=e.getBoxLayoutParams(),u=e.get("padding"),d=$2e(c,l,u),h=this.layoutInner(e,r,d,n,o,s),p=$2e(pGe({width:h.width,height:h.height},c),l,u);this.group.x=p.x-h.x,this.group.y=p.y-h.y,this.group.markRedraw(),this.group.add(this._backgroundEl=uxt(h,e))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(e,t,a,n,r,i,o){var s=this.getContentGroup(),l=$Ge(),c=t.get("selectedMode"),u=t.get("triggerEvent"),d=[];a.eachRawSeries(function(e){!e.get("legendHoverLink")&&d.push(e.id)}),O_t(t.getData(),function(r,i){var o=this,h=r.get("name");if(!this.newlineDisabled&&(""===h||"\n"===h)){var p=new F_t;return p.newline=!0,void s.add(p)}var f=a.getSeriesByName(h)[0];if(!l.get(h))if(f){var m=f.getData(),v=m.getVisual("legendLineStyle")||{},g=m.getVisual("legendIcon"),y=m.getVisual("style"),b=this._createItem(f,h,i,r,t,e,v,y,g,c,n);b.on("click",N_t(U_t,h,null,n,d)).on("mouseover",N_t(V_t,f.name,null,n,d)).on("mouseout",N_t(H_t,f.name,null,n,d)),a.ssr&&b.eachChild(function(e){var t=YZe(e);t.seriesIndex=f.seriesIndex,t.dataIndex=i,t.ssrType="legend"}),u&&b.eachChild(function(e){o.packEventData(e,t,f,i,h)}),l.set(h,!0)}else a.eachRawSeries(function(o){var s=this;if(!l.get(h)&&o.legendVisualProvider){var p=o.legendVisualProvider;if(!p.containName(h))return;var f=p.indexOfName(h),m=p.getItemVisual(f,"style"),v=p.getItemVisual(f,"legendIcon"),g=EYe(m.fill);g&&0===g[3]&&(g[3]=.2,m=hGe(hGe({},m),{fill:NYe(g,"rgba")}));var y=this._createItem(o,h,i,r,t,e,{},m,v,c,n);y.on("click",N_t(U_t,null,h,n,d)).on("mouseover",N_t(V_t,null,h,n,d)).on("mouseout",N_t(H_t,null,h,n,d)),a.ssr&&y.eachChild(function(e){var t=YZe(e);t.seriesIndex=o.seriesIndex,t.dataIndex=i,t.ssrType="legend"}),u&&y.eachChild(function(e){s.packEventData(e,t,o,i,h)}),l.set(h,!0)}},this)},this),r&&this._createSelector(r,t,n,i,o)},t.prototype.packEventData=function(e,t,a,n,r){var i={componentType:"legend",componentIndex:t.componentIndex,dataIndex:n,value:r,seriesIndex:a.seriesIndex};YZe(e).eventData=i},t.prototype._createSelector=function(e,t,a,n,r){var i=this.getSelectorGroup();O_t(e,function(e){var n=e.type,r=new PZe({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){a.dispatchAction({type:"all"===n?"legendAllSelect":"legendInverseSelect",legendId:t.id})}});i.add(r),r1e(r,{normal:t.getModel("selectorLabel"),emphasis:t.getModel(["emphasis","selectorLabel"])},{defaultText:e.title}),NJe(r)})},t.prototype._createItem=function(e,t,a,n,r,i,o,s,l,c,u){var d=e.visualDrawType,h=r.get("itemWidth"),p=r.get("itemHeight"),f=r.isSelected(t),m=n.get("symbolRotate"),v=n.get("symbolKeepAspect"),g=n.get("icon"),y=function(e,t,a,n,r,i,o){function s(e,t){"auto"===e.lineWidth&&(e.lineWidth=t.lineWidth>0?2:0),O_t(e,function(a,n){"inherit"===e[n]&&(e[n]=t[n])})}var l=t.getModel("itemStyle"),c=l.getItemStyle(),u=0===e.lastIndexOf("empty",0)?"fill":"stroke",d=l.getShallow("decal");c.decal=d&&"inherit"!==d?q8e(d,o):n.decal,"inherit"===c.fill&&(c.fill=n[r]);"inherit"===c.stroke&&(c.stroke=n[u]);"inherit"===c.opacity&&(c.opacity=("fill"===r?n:a).opacity);s(c,n);var h=t.getModel("lineStyle"),p=h.getLineStyle();if(s(p,a),"auto"===c.fill&&(c.fill=n.fill),"auto"===c.stroke&&(c.stroke=n.fill),"auto"===p.stroke&&(p.stroke=n.fill),!i){var f=t.get("inactiveBorderWidth"),m=c[u];c.lineWidth="auto"===f?n.lineWidth>0&&m?2:0:c.lineWidth,c.fill=t.get("inactiveColor"),c.stroke=t.get("inactiveBorderColor"),p.stroke=h.get("inactiveColor"),p.lineWidth=h.get("inactiveWidth")}return{itemStyle:c,lineStyle:p}}(l=g||l||"roundRect",n,o,s,d,f,u),b=new F_t,x=n.getModel("textStyle");if(!kGe(e.getLegendIcon)||g&&"inherit"!==g){var w="inherit"===g&&e.getData().getVisual("symbol")?"inherit"===m?e.getData().getVisual("symbolRotate"):m:0;b.add(function(e){var t=e.icon||"roundRect",a=y8e(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);a.setStyle(e.itemStyle),a.rotation=(e.iconRotate||0)*Math.PI/180,a.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(a.style.stroke=a.style.fill,a.style.fill=o5e.color.neutral00,a.style.lineWidth=2);return a}({itemWidth:h,itemHeight:p,icon:l,iconRotate:w,itemStyle:y.itemStyle,symbolKeepAspect:v}))}else b.add(e.getLegendIcon({itemWidth:h,itemHeight:p,icon:l,iconRotate:m,itemStyle:y.itemStyle,lineStyle:y.lineStyle,symbolKeepAspect:v}));var _="left"===i?h+5:-5,S=i,M=r.get("formatter"),T=t;CGe(M)&&M?T=M.replace("{name}",null!=t?t:""):kGe(M)&&(T=M(t));var k=f?x.getTextColor():n.get("inactiveColor");b.add(new PZe({style:o1e(x,{text:T,x:_,y:p/2,fill:k,align:S,verticalAlign:"middle"},{inheritColor:k})}));var C=new EZe({shape:b.getBoundingRect(),style:{fill:"transparent"}}),A=n.getModel("tooltip");return A.get("show")&&G0e({el:C,componentModel:r,itemName:t,itemTooltipOption:A.option}),b.add(C),b.eachChild(function(e){e.silent=!0}),C.silent=!c,this.getContentGroup().add(b),NJe(b),b.__legendDataIndex=a,b},t.prototype.layoutInner=function(e,t,a,n,r,i){var o=this.getContentGroup(),s=this.getSelectorGroup();Y2e(e.get("orient"),o,e.get("itemGap"),a.width,a.height);var l=o.getBoundingRect(),c=[-l.x,-l.y];if(s.markRedraw(),o.markRedraw(),r){Y2e("horizontal",s,e.get("selectorItemGap",!0));var u=s.getBoundingRect(),d=[-u.x,-u.y],h=e.get("selectorButtonGap",!0),p=e.getOrient().index,f=0===p?"width":"height",m=0===p?"height":"width",v=0===p?"y":"x";"end"===i?d[p]+=l[f]+h:c[p]+=u[f]+h,d[1-p]+=l[m]/2-u[m]/2,s.x=d[0],s.y=d[1],o.x=c[0],o.y=c[1];var g={x:0,y:0};return g[f]=l[f]+h+u[f],g[m]=Math.max(l[m],u[m]),g[v]=Math.min(0,u[v]+d[1-p]),g}return o.x=c[0],o.y=c[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(n6e);function U_t(e,t,a,n){H_t(e,t,a,n),a.dispatchAction({type:"legendToggleSelect",name:null!=e?e:t}),V_t(e,t,a,n)}function z_t(e){for(var t,a=e.getZr().storage.getDisplayList(),n=0,r=a.length;n<r&&!(t=a[n].states.emphasis);)n++;return t&&t.hoverLayer}function V_t(e,t,a,n){z_t(a)||a.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:n})}function H_t(e,t,a,n){z_t(a)||a.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:n})}function G_t(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(e){for(var a=0;a<t.length;a++)if(!t[a].isSelected(e.name))return!1;return!0})}function W_t(e,t,a){var n="allSelect"===e||"inverseSelect"===e,r={},i=[];a.eachComponent({mainType:"legend",query:t},function(a){n?a[e]():a[e](t.name),q_t(a,r),i.push(a.componentIndex)});var o={};return a.eachComponent("legend",function(e){gGe(r,function(t,a){e[t?"select":"unSelect"](a)}),q_t(e,o)}),n?{selected:o,legendIndex:i}:{name:t.name,selected:o}}function q_t(e,t){var a=t||{};return gGe(e.getData(),function(t){var n=t.get("name");if("\n"!==n&&""!==n){var r=e.isSelected(n);QGe(a,n)?a[n]=a[n]&&r:a[n]=r}}),a}function Y_t(e){e.registerComponentModel(L_t),e.registerComponentView(B_t),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,G_t),e.registerSubTypeDefaulter("legend",function(){return"plain"}),function(e){e.registerAction("legendToggleSelect","legendselectchanged",MGe(W_t,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",MGe(W_t,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",MGe(W_t,"inverseSelect")),e.registerAction("legendSelect","legendselected",MGe(W_t,"select")),e.registerAction("legendUnSelect","legendunselected",MGe(W_t,"unSelect"))}(e)}var j_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.setScrollDataIndex=function(e){this.option.scrollDataIndex=e},t.prototype.init=function(t,a,n){var r=a5e(t);e.prototype.init.call(this,t,a,n),X_t(this,t,r)},t.prototype.mergeOption=function(t,a){e.prototype.mergeOption.call(this,t,a),X_t(this,this.option,t)},t.type="legend.scroll",t.defaultOption=D1e(L_t.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:o5e.color.accent50,pageIconInactiveColor:o5e.color.accent10,pageIconSize:15,pageTextStyle:{color:o5e.color.tertiary},animationDurationUpdate:800}),t}(L_t);function X_t(e,t,a){var n=[1,1];n[e.getOrient().index]=0,t5e(t,a,{type:"box",ignoreSize:!!n})}var $_t=xXe,K_t=["width","height"],Z_t=["x","y"],J_t=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.newlineDisabled=!0,a._currentIndex=0,a}return zHe(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new $_t),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new $_t)},t.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(t,a,n,r,i,o,s){var l=this;e.prototype.renderInner.call(this,t,a,n,r,i,o,s);var c=this._controllerGroup,u=a.get("pageIconSize",!0),d=TGe(u)?u:[u,u];p("pagePrev",0);var h=a.getModel("pageTextStyle");function p(e,t){var n=e+"DataIndex",i=O0e(a.get("pageIcons",!0)[a.getOrient().name][t],{onclick:SGe(l._pageGo,l,n,a,r)},{x:-d[0]/2,y:-d[1]/2,width:d[0],height:d[1]});i.name=e,c.add(i)}c.add(new PZe({name:"pageText",style:{text:"xx/xx",fill:h.getTextColor(),font:h.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),p("pageNext",1)},t.prototype.layoutInner=function(e,t,a,n,r,i){var o=this.getSelectorGroup(),s=e.getOrient().index,l=K_t[s],c=Z_t[s],u=K_t[1-s],d=Z_t[1-s];r&&Y2e("horizontal",o,e.get("selectorItemGap",!0));var h=e.get("selectorButtonGap",!0),p=o.getBoundingRect(),f=[-p.x,-p.y],m=cGe(a);r&&(m[l]=a[l]-p[l]-h);var v=this._layoutContentAndController(e,n,m,s,l,u,d,c);if(r){if("end"===i)f[s]+=v[l]+h;else{var g=p[l]+h;f[s]-=g,v[c]-=g}v[l]+=p[l]+h,f[1-s]+=v[d]+v[u]/2-p[u]/2,v[u]=Math.max(v[u],p[u]),v[d]=Math.min(v[d],p[d]+f[1-s]),o.x=f[0],o.y=f[1],o.markRedraw()}return v},t.prototype._layoutContentAndController=function(e,t,a,n,r,i,o,s){var l=this.getContentGroup(),c=this._containerGroup,u=this._controllerGroup;Y2e(e.get("orient"),l,e.get("itemGap"),n?a.width:null,n?null:a.height),Y2e("horizontal",u,e.get("pageButtonItemGap",!0));var d=l.getBoundingRect(),h=u.getBoundingRect(),p=this._showController=d[r]>a[r],f=[-d.x,-d.y];t||(f[n]=l[s]);var m=[0,0],v=[-h.x,-h.y],g=FGe(e.get("pageButtonGap",!0),e.get("itemGap",!0));p&&("end"===e.get("pageButtonPosition",!0)?v[n]+=a[r]-h[r]:m[n]+=h[r]+g);v[1-n]+=d[i]/2-h[i]/2,l.setPosition(f),c.setPosition(m),u.setPosition(v);var y={x:0,y:0};if(y[r]=p?a[r]:d[r],y[i]=Math.max(d[i],h[i]),y[o]=Math.min(0,h[o]+v[1-n]),c.__rectSize=a[r],p){var b={x:0,y:0};b[r]=Math.max(a[r]-h[r]-g,0),b[i]=y[i],c.setClipPath(new EZe({shape:b})),c.__rectSize=b[r]}else u.eachChild(function(e){e.attr({invisible:!0,silent:!0})});var x=this._getPageInfo(e);return null!=x.pageIndex&&u0e(l,{x:x.contentPosition[0],y:x.contentPosition[1]},p?e:null),this._updatePageInfoView(e,x),y},t.prototype._pageGo=function(e,t,a){var n=this._getPageInfo(t)[e];null!=n&&a.dispatchAction({type:"legendScroll",scrollDataIndex:n,legendId:t.id})},t.prototype._updatePageInfoView=function(e,t){var a=this._controllerGroup;gGe(["pagePrev","pageNext"],function(n){var r=null!=t[n+"DataIndex"],i=a.childOfName(n);i&&(i.setStyle("fill",r?e.get("pageIconColor",!0):e.get("pageIconInactiveColor",!0)),i.cursor=r?"pointer":"default")});var n=a.childOfName("pageText"),r=e.get("pageFormatter"),i=t.pageIndex,o=null!=i?i+1:0,s=t.pageCount;n&&r&&n.setStyle("text",CGe(r)?r.replace("{current}",null==o?"":o+"").replace("{total}",null==s?"":s+""):r({current:o,total:s}))},t.prototype._getPageInfo=function(e){var t=e.get("scrollDataIndex",!0),a=this.getContentGroup(),n=this._containerGroup.__rectSize,r=e.getOrient().index,i=K_t[r],o=Z_t[r],s=this._findTargetItemIndex(t),l=a.children(),c=l[s],u=l.length,d=u?1:0,h={contentPosition:[a.x,a.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return h;var p=y(c);h.contentPosition[r]=-p.s;for(var f=s+1,m=p,v=p,g=null;f<=u;++f)(!(g=y(l[f]))&&v.e>m.s+n||g&&!b(g,m.s))&&(m=v.i>m.i?v:g)&&(null==h.pageNextDataIndex&&(h.pageNextDataIndex=m.i),++h.pageCount),v=g;for(f=s-1,m=p,v=p,g=null;f>=-1;--f)(g=y(l[f]))&&b(v,g.s)||!(m.i<v.i)||(v=m,null==h.pagePrevDataIndex&&(h.pagePrevDataIndex=m.i),++h.pageCount,++h.pageIndex),m=g;return h;function y(e){if(e){var t=e.getBoundingRect(),a=t[o]+e[o];return{s:a,e:a+t[i],i:e.__legendDataIndex}}}function b(e,t){return e.e>=t&&e.s<=t+n}},t.prototype._findTargetItemIndex=function(e){return this._showController?(this.getContentGroup().eachChild(function(n,r){var i=n.__legendDataIndex;null==a&&null!=i&&(a=r),i===e&&(t=r)}),null!=t?t:a):0;var t,a},t.type="legend.scroll",t}(B_t);function Q_t(e){Qet(Y_t),e.registerComponentModel(j_t),e.registerComponentView(J_t),function(e){e.registerAction("legendScroll","legendscroll",function(e,t){var a=e.scrollDataIndex;null!=a&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(e){e.setScrollDataIndex(a)})})}(e)}function eSt(e){Qet(Y_t),Qet(Q_t)}var tSt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="dataZoom.inside",t.defaultOption=D1e(jbt.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(jbt),aSt=v$e();function nSt(e,t){if(t){e.removeKey(t.model.uid);var a=t.controller;a&&a.dispose()}}function rSt(e,t){e.isDisposed()||e.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function iSt(e,t,a,n){return e.coordinateSystem.containPoint([a,n])}function oSt(e){e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,function(e,t){var a=aSt(t),n=a.coordSysRecordMap||(a.coordSysRecordMap=$Ge());n.each(function(e){e.dataZoomInfoMap=null}),e.eachComponent({mainType:"dataZoom",subType:"inside"},function(e){gGe(qbt(e).infoList,function(a){var r=a.model.uid,i=n.get(r)||n.set(r,function(e,t){var a={model:t,containsPoint:MGe(iSt,t),dispatchAction:MGe(rSt,e),dataZoomInfoMap:null,controller:null},n=a.controller=new Tst(e.getZr());return gGe(["pan","zoom","scrollMove"],function(e){n.on(e,function(t){var n=[];a.dataZoomInfoMap.each(function(r){if(t.isAvailableBehavior(r.model.option)){var i=(r.getRange||{})[e],o=i&&i(r.dzReferCoordSysInfo,a.model.mainType,a.controller,t);!r.model.get("disabled",!0)&&o&&n.push({dataZoomId:r.model.id,start:o[0],end:o[1]})}}),n.length&&a.dispatchAction(n)})}),a}(t,a.model));(i.dataZoomInfoMap||(i.dataZoomInfoMap=$Ge())).set(e.uid,{dzReferCoordSysInfo:a,model:e,getRange:null})})}),n.each(function(e){var a,r=e.controller,i=e.dataZoomInfoMap;if(i){var o=i.keys()[0];null!=o&&(a=i.get(o))}if(a){var s=function(e,t,a){var n,r="type_",i={type_true:2,type_move:1,type_false:0,type_undefined:-1},o=!0;return e.each(function(e){var t=e.model,a=!t.get("disabled",!0)&&(!t.get("zoomLock",!0)||"move");i[r+a]>i[r+n]&&(n=a),o=o&&t.get("preventDefaultMouseMove",!0)}),{controlType:n,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!o,api:a,zInfo:{component:t.model},triggerInfo:{roamTrigger:null,isInSelf:t.containsPoint}}}}(i,e,t);r.enable(s.controlType,s.opt),g6e(e,"dispatchAction",a.model.get("throttle",!0),"fixRate")}else nSt(n,e)})})}var sSt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dataZoom.inside",t}return zHe(t,e),t.prototype.render=function(t,a,n){e.prototype.render.apply(this,arguments),t.noTarget()?this._clear():(this.range=t.getPercentRange(),function(e,t,a){aSt(e).coordSysRecordMap.each(function(e){var n=e.dataZoomInfoMap.get(t.uid);n&&(n.getRange=a)})}(n,t,{pan:SGe(lSt.pan,this),zoom:SGe(lSt.zoom,this),scrollMove:SGe(lSt.scrollMove,this)}))},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){!function(e,t){for(var a=aSt(e).coordSysRecordMap,n=a.keys(),r=0;r<n.length;r++){var i=n[r],o=a.get(i),s=o.dataZoomInfoMap;if(s){var l=t.uid;s.get(l)&&(s.removeKey(l),s.keys().length||nSt(a,o))}}}(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(Kbt),lSt={zoom:function(e,t,a,n){var r=this.range,i=r.slice(),o=e.axisModels[0];if(o){var s=uSt[t](null,[n.originX,n.originY],o,a,e),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(i[1]-i[0])+i[0],c=Math.max(1/n.scale,0);i[0]=(i[0]-l)*c+l,i[1]=(i[1]-l)*c+l;var u=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return _ht(0,i,[0,100],0,u.minSpan,u.maxSpan),this.range=i,r[0]!==i[0]||r[1]!==i[1]?i:void 0}},pan:cSt(function(e,t,a,n,r,i){var o=uSt[n]([i.oldX,i.oldY],[i.newX,i.newY],t,r,a);return o.signal*(e[1]-e[0])*o.pixel/o.pixelLength}),scrollMove:cSt(function(e,t,a,n,r,i){return uSt[n]([0,0],[i.scrollDelta,i.scrollDelta],t,r,a).signal*(e[1]-e[0])*i.scrollDelta})};function cSt(e){return function(t,a,n,r){var i=this.range,o=i.slice(),s=t.axisModels[0];if(s)return _ht(e(o,s,t,a,n,r),o,[0,100],"all"),this.range=o,i[0]!==o[0]||i[1]!==o[1]?o:void 0}}var uSt={grid:function(e,t,a,n,r){var i=a.axis,o={},s=r.model.coordinateSystem.getRect();return e=e||[0,0],"x"===i.dim?(o.pixel=t[0]-e[0],o.pixelLength=s.width,o.pixelStart=s.x,o.signal=i.inverse?1:-1):(o.pixel=t[1]-e[1],o.pixelLength=s.height,o.pixelStart=s.y,o.signal=i.inverse?-1:1),o},polar:function(e,t,a,n,r){var i=a.axis,o={},s=r.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),c=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),"radiusAxis"===a.mainType?(o.pixel=t[0]-e[0],o.pixelLength=l[1]-l[0],o.pixelStart=l[0],o.signal=i.inverse?1:-1):(o.pixel=t[1]-e[1],o.pixelLength=c[1]-c[0],o.pixelStart=c[0],o.signal=i.inverse?-1:1),o},singleAxis:function(e,t,a,n,r){var i=a.axis,o=r.model.coordinateSystem.getRect(),s={};return e=e||[0,0],"horizontal"===i.orient?(s.pixel=t[0]-e[0],s.pixelLength=o.width,s.pixelStart=o.x,s.signal=i.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=o.height,s.pixelStart=o.y,s.signal=i.inverse?-1:1),s}};function dSt(e){nxt(e),e.registerComponentModel(tSt),e.registerComponentView(sSt),oSt(e)}var hSt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=D1e(jbt.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:o5e.color.accent10,borderRadius:0,backgroundColor:o5e.color.transparent,dataBackground:{lineStyle:{color:o5e.color.accent30,width:.5},areaStyle:{color:o5e.color.accent20,opacity:.2}},selectedDataBackground:{lineStyle:{color:o5e.color.accent40,width:.5},areaStyle:{color:o5e.color.accent20,opacity:.3}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:o5e.color.neutral00,borderColor:o5e.color.accent20},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:o5e.color.accent40,opacity:.5},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:o5e.color.tertiary},brushSelect:!0,brushStyle:{color:o5e.color.accent30,opacity:.3},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:o5e.color.accent40},moveHandleStyle:{opacity:.8}},defaultLocationEdgeGap:15}),t}(jbt),pSt=EZe,fSt="horizontal",mSt="vertical",vSt=["line","bar","candlestick","scatter"],gSt={easing:"cubicOut",duration:100,delay:0},ySt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._displayables={},a}return zHe(t,e),t.prototype.init=function(e,t){this.api=t,this._onBrush=SGe(this._onBrush,this),this._onBrushEnd=SGe(this._onBrushEnd,this)},t.prototype.render=function(t,a,n,r){if(e.prototype.render.apply(this,arguments),g6e(this,"_dispatchZoomAction",t.get("throttle"),"fixRate"),this._orient=t.getOrient(),!1!==t.get("show")){if(t.noTarget())return this._clear(),void this.group.removeAll();r&&"dataZoom"===r.type&&r.from===this.uid||this._buildView(),this._updateView()}else this.group.removeAll()},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){y6e(this,"_dispatchZoomAction");var e=this.api.getZr();e.off("mousemove",this._onBrush),e.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var e=this.group;e.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var t=this._displayables.sliderGroup=new xXe;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(t),this._positionGroup()},t.prototype._resetLocation=function(){var e=this.dataZoomModel,t=this.api,a=e.get("brushSelect")?7:0,n=J2e(e,t).refContainer,r=this._findCoordRect(),i=e.get("defaultLocationEdgeGap",!0)||0,o=this._orient===fSt?{right:n.width-r.x-r.width,top:n.height-30-i-a,width:r.width,height:30}:{right:i,top:r.y,width:30,height:r.height},s=a5e(e.option);gGe(["right","top","width","height"],function(e){"ph"===s[e]&&(s[e]=o[e])});var l=$2e(s,n);this._location={x:l.x,y:l.y},this._size=[l.width,l.height],this._orient===mSt&&this._size.reverse()},t.prototype._positionGroup=function(){var e=this.group,t=this._location,a=this._orient,n=this.dataZoomModel.getFirstTargetAxisModel(),r=n&&n.get("inverse"),i=this._displayables.sliderGroup,o=(this._dataShadowInfo||{}).otherAxisInverse;i.attr(a!==fSt||r?a===fSt&&r?{scaleY:o?1:-1,scaleX:-1}:a!==mSt||r?{scaleY:o?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:o?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:o?1:-1,scaleX:1});var s=e.getBoundingRect([i]);e.x=t.x-s.x,e.y=t.y-s.y,e.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var e=this.dataZoomModel,t=this._size,a=this._displayables.sliderGroup,n=e.get("brushSelect");a.add(new pSt({silent:!0,shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:e.get("backgroundColor")},z2:-40}));var r=new pSt({shape:{x:0,y:0,width:t[0],height:t[1]},style:{fill:"transparent"},z2:0,onclick:SGe(this._onClickPanel,this)}),i=this.api.getZr();n?(r.on("mousedown",this._onBrushStart,this),r.cursor="crosshair",i.on("mousemove",this._onBrush),i.on("mouseup",this._onBrushEnd)):(i.off("mousemove",this._onBrush),i.off("mouseup",this._onBrushEnd)),a.add(r)},t.prototype._renderDataShadow=function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],e){var t=this._size,a=this._shadowSize||[],n=e.series,r=n.getRawData(),i=n.getShadowDim&&n.getShadowDim(),o=i&&r.getDimensionInfo(i)?n.getShadowDim():e.otherDim;if(null!=o){var s=this._shadowPolygonPts,l=this._shadowPolylinePts;if(r!==this._shadowData||o!==this._shadowDim||t[0]!==a[0]||t[1]!==a[1]){var c=r.getDataExtent(e.thisDim),u=r.getDataExtent(o),d=.3*(u[1]-u[0]);u=[u[0]-d,u[1]+d];var h,p=[0,t[1]],f=[0,t[0]],m=[[t[0],0],[0,0]],v=[],g=f[1]/Math.max(1,r.count()-1),y=t[0]/(c[1]-c[0]),b="time"===e.thisAxis.type,x=-g,w=Math.round(r.count()/t[0]);r.each([e.thisDim,o],function(e,t,a){if(w>0&&a%w)b||(x+=g);else{x=b?(+e-c[0])*y:x+g;var n=null==t||isNaN(t)||""===t,r=n?0:IXe(t,u,p,!0);n&&!h&&a?(m.push([m[m.length-1][0],0]),v.push([v[v.length-1][0],0])):!n&&h&&(m.push([x,0]),v.push([x,0])),n||(m.push([x,r]),v.push([x,r])),h=n}}),s=this._shadowPolygonPts=m,l=this._shadowPolylinePts=v}this._shadowData=r,this._shadowDim=o,this._shadowSize=[t[0],t[1]];for(var _=this.dataZoomModel,S=0;S<3;S++){var M=T(1===S);this._displayables.sliderGroup.add(M),this._displayables.dataShadowSegs.push(M)}}}function T(e){var t=_.getModel(e?"selectedDataBackground":"dataBackground"),a=new xXe,n=new LQe({shape:{points:s},segmentIgnoreThreshold:1,style:t.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),r=new OQe({shape:{points:l},segmentIgnoreThreshold:1,style:t.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return a.add(n),a.add(r),a}},t.prototype._prepareDataShadowInfo=function(){var e=this.dataZoomModel,t=e.get("showDataShadow");if(!1!==t){var a,n=this.ecModel;return e.eachTargetAxis(function(r,i){gGe(e.getAxisProxy(r,i).getTargetSeriesModels(),function(e){if(!(a||!0!==t&&fGe(vSt,e.get("type"))<0)){var o,s=n.getComponent(Gbt(r),i).axis,l=function(e){var t={x:"y",y:"x",radius:"angle",angle:"radius"};return t[e]}(r),c=e.coordinateSystem;null!=l&&c.getOtherAxis&&(o=c.getOtherAxis(s).inverse),l=e.getData().mapDimension(l);var u=e.getData().mapDimension(r);a={thisAxis:s,series:e,thisDim:u,otherDim:l,otherAxisInverse:o}}},this)},this),a}},t.prototype._renderHandle=function(){var e=this.group,t=this._displayables,a=t.handles=[null,null],n=t.handleLabels=[null,null],r=this._displayables.sliderGroup,i=this._size,o=this.dataZoomModel,s=this.api,l=o.get("borderRadius")||0,c=o.get("brushSelect"),u=t.filler=new pSt({silent:c,style:{fill:o.get("fillerColor")},textConfig:{position:"inside"}});r.add(u),r.add(new pSt({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:i[0],height:i[1],r:l},style:{stroke:o.get("dataBackgroundColor")||o.get("borderColor"),lineWidth:1,fill:o5e.color.transparent}})),gGe([0,1],function(t){var i=o.get("handleIcon");!m8e[i]&&i.indexOf("path://")<0&&i.indexOf("image://")<0&&(i="path://"+i);var s,l=y8e(i,-1,0,2,2,null,!0);l.attr({cursor:(s=this._orient,"vertical"===s?"ns-resize":"ew-resize"),draggable:!0,drift:SGe(this._onDragMove,this,t),ondragend:SGe(this._onDragEnd,this),onmouseover:SGe(this._showDataInfo,this,!0),onmouseout:SGe(this._showDataInfo,this,!1),z2:5});var c=l.getBoundingRect(),u=o.get("handleSize");this._handleHeight=RXe(u,this._size[1]),this._handleWidth=c.width/c.height*this._handleHeight,l.setStyle(o.getModel("handleStyle").getItemStyle()),l.style.strokeNoScale=!0,l.rectHover=!0,l.ensureState("emphasis").style=o.getModel(["emphasis","handleStyle"]).getItemStyle(),NJe(l);var d=o.get("handleColor");null!=d&&(l.style.fill=d),r.add(a[t]=l);var h=o.getModel("textStyle"),p=(o.get("handleLabel")||{}).show||!1;e.add(n[t]=new PZe({silent:!0,invisible:!p,style:o1e(h,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:h.getTextColor(),font:h.getFont()}),z2:10}))},this);var d=u;if(c){var h=RXe(o.get("moveHandleSize"),i[1]),p=t.moveHandle=new EZe({style:o.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:i[1]-.5,height:h}}),f=.8*h,m=t.moveHandleIcon=y8e(o.get("moveHandleIcon"),-f/2,-f/2,f,f,o5e.color.neutral00,!0);m.silent=!0,m.y=i[1]+h/2-.5,p.ensureState("emphasis").style=o.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var v=Math.min(i[1]/2,Math.max(h,10));(d=t.moveZone=new EZe({invisible:!0,shape:{y:i[1]-v,height:h+v}})).on("mouseover",function(){s.enterEmphasis(p)}).on("mouseout",function(){s.leaveEmphasis(p)}),r.add(p),r.add(m),r.add(d)}d.attr({draggable:!0,cursor:"default",drift:SGe(this._onDragMove,this,"all"),ondragstart:SGe(this._showDataInfo,this,!0),ondragend:SGe(this._onDragEnd,this),onmouseover:SGe(this._showDataInfo,this,!0),onmouseout:SGe(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var e=this._range=this.dataZoomModel.getPercentRange(),t=this._getViewExtent();this._handleEnds=[IXe(e[0],[0,100],t,!0),IXe(e[1],[0,100],t,!0)]},t.prototype._updateInterval=function(e,t){var a=this.dataZoomModel,n=this._handleEnds,r=this._getViewExtent(),i=a.findRepresentativeAxisProxy().getMinMaxSpan(),o=[0,100];_ht(t,n,r,a.get("zoomLock")?"all":e,null!=i.minSpan?IXe(i.minSpan,o,r,!0):null,null!=i.maxSpan?IXe(i.maxSpan,o,r,!0):null);var s=this._range,l=this._range=LXe([IXe(n[0],r,o,!0),IXe(n[1],r,o,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},t.prototype._updateView=function(e){var t=this._displayables,a=this._handleEnds,n=LXe(a.slice()),r=this._size;gGe([0,1],function(e){var n=t.handles[e],i=this._handleHeight;n.attr({scaleX:i/2,scaleY:i/2,x:a[e]+(e?-1:1),y:r[1]/2-i/2})},this),t.filler.setShape({x:n[0],y:0,width:n[1]-n[0],height:r[1]});var i={x:n[0],width:n[1]-n[0]};t.moveHandle&&(t.moveHandle.setShape(i),t.moveZone.setShape(i),t.moveZone.getBoundingRect(),t.moveHandleIcon&&t.moveHandleIcon.attr("x",i.x+i.width/2));for(var o=t.dataShadowSegs,s=[0,n[0],n[1],r[0]],l=0;l<o.length;l++){var c=o[l],u=c.getClipPath();u||(u=new EZe,c.setClipPath(u)),u.setShape({x:s[l],y:0,width:s[l+1]-s[l],height:r[1]})}this._updateDataInfo(e)},t.prototype._updateDataInfo=function(e){var t=this.dataZoomModel,a=this._displayables,n=a.handleLabels,r=this._orient,i=["",""];if(t.get("showDetail")){var o=t.findRepresentativeAxisProxy();if(o){var s=o.getAxisModel().axis,l=this._range,c=e?o.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:o.getDataValueWindow();i=[this._formatLabel(c[0],s),this._formatLabel(c[1],s)]}}var u=LXe(this._handleEnds.slice());function d(e){var t=I0e(a.handles[e].parent,this.group),o=D0e(0===e?"right":"left",t),s=this._handleWidth/2+5,l=R0e([u[e]+(0===e?-s:s),this._size[1]/2],t);n[e].setStyle({x:l[0],y:l[1],verticalAlign:r===fSt?"middle":o,align:r===fSt?o:"center",text:i[e]})}d.call(this,0),d.call(this,1)},t.prototype._formatLabel=function(e,t){var a=this.dataZoomModel,n=a.get("labelFormatter"),r=a.get("labelPrecision");null!=r&&"auto"!==r||(r=t.getPixelPrecision());var i=null==e||isNaN(e)?"":"category"===t.type||"time"===t.type?t.scale.getLabel({value:Math.round(e)}):e.toFixed(Math.min(r,20));return kGe(n)?n(e,i):CGe(n)?n.replace("{value}",i):i},t.prototype._showDataInfo=function(e){var t=(this.dataZoomModel.get("handleLabel")||{}).show||!1,a=this.dataZoomModel.getModel(["emphasis","handleLabel"]).get("show")||!1,n=e||this._dragging?a:t,r=this._displayables,i=r.handleLabels;i[0].attr("invisible",!n),i[1].attr("invisible",!n),r.moveHandle&&this.api[n?"enterEmphasis":"leaveEmphasis"](r.moveHandle,1)},t.prototype._onDragMove=function(e,t,a,n){this._dragging=!0,VWe(n.event);var r=R0e([t,a],this._displayables.sliderGroup.getLocalTransform(),!0),i=this._updateInterval(e,r[0]),o=this.dataZoomModel.get("realtime");this._updateView(!o),i&&o&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),!this.dataZoomModel.get("realtime")&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(e){var t=this._size,a=this._displayables.sliderGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(a[0]<0||a[0]>t[0]||a[1]<0||a[1]>t[1])){var n=this._handleEnds,r=(n[0]+n[1])/2,i=this._updateInterval("all",a[0]-r);this._updateView(),i&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(e){var t=e.offsetX,a=e.offsetY;this._brushStart=new eqe(t,a),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(e){if(this._brushing){var t=this._displayables.brushRect;if(this._brushing=!1,t){t.attr("ignore",!0);var a=t.shape;if(!(+new Date-this._brushStartTime<200&&Math.abs(a.width)<5)){var n=this._getViewExtent(),r=[0,100],i=this._handleEnds=[a.x,a.x+a.width],o=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();_ht(0,i,n,0,null!=o.minSpan?IXe(o.minSpan,r,n,!0):null,null!=o.maxSpan?IXe(o.maxSpan,r,n,!0):null),this._range=LXe([IXe(i[0],n,r,!0),IXe(i[1],n,r,!0)]),this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(e){this._brushing&&(VWe(e.event),this._updateBrushRect(e.offsetX,e.offsetY))},t.prototype._updateBrushRect=function(e,t){var a=this._displayables,n=this.dataZoomModel,r=a.brushRect;r||(r=a.brushRect=new pSt({silent:!0,style:n.getModel("brushStyle").getItemStyle()}),a.sliderGroup.add(r)),r.attr("ignore",!1);var i=this._brushStart,o=this._displayables.sliderGroup,s=o.transformCoordToLocal(e,t),l=o.transformCoordToLocal(i.x,i.y),c=this._size;s[0]=Math.max(Math.min(c[0],s[0]),0),r.setShape({x:l[0],y:0,width:s[0]-l[0],height:c[1]})},t.prototype._dispatchZoomAction=function(e){var t=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:e?gSt:null,start:t[0],end:t[1]})},t.prototype._findCoordRect=function(){var e,t=qbt(this.dataZoomModel).infoList;if(!e&&t.length){var a=t[0].model.coordinateSystem;e=a.getRect&&a.getRect()}if(!e){var n=this.api.getWidth(),r=this.api.getHeight();e={x:.2*n,y:.2*r,width:.6*n,height:.6*r}}return e},t.type="dataZoom.slider",t}(Kbt);function bSt(e){e.registerComponentModel(hSt),e.registerComponentView(ySt),nxt(e)}var xSt=function(e,t,a){var n=cGe((wSt[e]||{})[t]);return a&&TGe(n)?n[n.length-1]:n},wSt={color:{active:["#006edd","#e0ffff"],inactive:[o5e.color.transparent]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},_St=iut.mapVisual,SSt=iut.eachVisual,MSt=TGe,TSt=gGe,kSt=LXe,CSt=IXe,ASt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.stateList=["inRange","outOfRange"],a.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],a.layoutMode={type:"box",ignoreSize:!0},a.dataBound=[-1/0,1/0],a.targetVisuals={},a.controllerVisuals={},a}return zHe(t,e),t.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a)},t.prototype.optionUpdated=function(e,t){var a=this.option;!t&&xwt(a,e,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},t.prototype.resetVisual=function(e){var t=this.stateList;e=SGe(e,this),this.controllerVisuals=bwt(this.option.controller,t,e),this.targetVisuals=bwt(this.option.target,t,e)},t.prototype.getItemSymbol=function(){return null},t.prototype.getTargetSeriesIndices=function(){var e=this.option.seriesId,t=this.option.seriesIndex;return null==t&&null==e&&(t="all"),yGe(_$e(this.ecModel,"series",{index:t,id:e},{useDefault:!1,enableAll:!0,enableNone:!1}).models,function(e){return e.componentIndex})},t.prototype.eachTargetSeries=function(e,t){gGe(this.getTargetSeriesIndices(),function(a){var n=this.ecModel.getSeriesByIndex(a);n&&e.call(t,n)},this)},t.prototype.isTargetSeries=function(e){var t=!1;return this.eachTargetSeries(function(a){a===e&&(t=!0)}),t},t.prototype.formatValueText=function(e,t,a){var n,r=this.option,i=r.precision,o=this.dataBound,s=r.formatter;a=a||["<",">"],TGe(e)&&(e=e.slice(),n=!0);var l=t?e:n?[c(e[0]),c(e[1])]:c(e);return CGe(s)?s.replace("{value}",n?l[0]:l).replace("{value2}",n?l[1]:l):kGe(s)?n?s(e[0],e[1]):s(e):n?e[0]===o[0]?a[0]+" "+l[1]:e[1]===o[1]?a[1]+" "+l[0]:l[0]+" - "+l[1]:l;function c(e){return e===o[0]?"min":e===o[1]?"max":(+e).toFixed(Math.min(i,20))}},t.prototype.resetExtent=function(){var e=this.option,t=kSt([e.min,e.max]);this._dataExtent=t},t.prototype.getDataDimensionIndex=function(e){var t=this.option.dimension;if(null!=t)return e.getDimensionIndex(t);for(var a=e.dimensions,n=a.length-1;n>=0;n--){var r=a[n],i=e.getDimensionInfo(r);if(!i.isCalculationCoord)return i.storeDimIndex}},t.prototype.getExtent=function(){return this._dataExtent.slice()},t.prototype.completeVisualOption=function(){var e=this.ecModel,t=this.option,a={inRange:t.inRange,outOfRange:t.outOfRange},n=t.target||(t.target={}),r=t.controller||(t.controller={});uGe(n,a),uGe(r,a);var i=this.isCategory();function o(a){MSt(t.color)&&!a.inRange&&(a.inRange={color:t.color.slice().reverse()}),a.inRange=a.inRange||{color:e.get("gradientColor")}}o.call(this,n),o.call(this,r),function(e,t,a){var n=e[t],r=e[a];n&&!r&&(r=e[a]={},TSt(n,function(e,t){if(iut.isValidType(t)){var a=xSt(t,"inactive",i);null!=a&&(r[t]=a,"color"!==t||r.hasOwnProperty("opacity")||r.hasOwnProperty("colorAlpha")||(r.opacity=[0,0]))}}))}.call(this,n,"inRange","outOfRange"),function(e){var t=(e.inRange||{}).symbol||(e.outOfRange||{}).symbol,a=(e.inRange||{}).symbolSize||(e.outOfRange||{}).symbolSize,n=this.get("inactiveColor"),r=this.getItemSymbol()||"roundRect";TSt(this.stateList,function(o){var s=this.itemSize,l=e[o];l||(l=e[o]={color:i?n:[n]}),null==l.symbol&&(l.symbol=t&&cGe(t)||(i?r:[r])),null==l.symbolSize&&(l.symbolSize=a&&cGe(a)||(i?s[0]:[s[0],s[0]])),l.symbol=_St(l.symbol,function(e){return"none"===e?r:e});var c=l.symbolSize;if(null!=c){var u=-1/0;SSt(c,function(e){e>u&&(u=e)}),l.symbolSize=_St(c,function(e){return CSt(e,[0,u],[0,s[0]],!0)})}},this)}.call(this,r)},t.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},t.prototype.isCategory=function(){return!!this.option.categories},t.prototype.setSelected=function(e){},t.prototype.getSelected=function(){return null},t.prototype.getValueState=function(e){return null},t.prototype.getVisualMeta=function(e){return null},t.type="visualMap",t.dependencies=["series"],t.defaultOption={show:!0,z:4,min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:o5e.color.transparent,borderColor:o5e.color.borderTint,contentColor:o5e.color.theme[0],inactiveColor:o5e.color.disabled,borderWidth:0,padding:o5e.size.m,textGap:10,precision:0,textStyle:{color:o5e.color.secondary}},t}(i5e),ESt=[20,140],ISt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.optionUpdated=function(t,a){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(e){e.mappingMethod="linear",e.dataExtent=this.getExtent()}),this._resetRange()},t.prototype.resetItemSize=function(){e.prototype.resetItemSize.apply(this,arguments);var t=this.itemSize;(null==t[0]||isNaN(t[0]))&&(t[0]=ESt[0]),(null==t[1]||isNaN(t[1]))&&(t[1]=ESt[1])},t.prototype._resetRange=function(){var e=this.getExtent(),t=this.option.range;!t||t.auto?(e.auto=1,this.option.range=e):TGe(t)&&(t[0]>t[1]&&t.reverse(),t[0]=Math.max(t[0],e[0]),t[1]=Math.min(t[1],e[1]))},t.prototype.completeVisualOption=function(){e.prototype.completeVisualOption.apply(this,arguments),gGe(this.stateList,function(e){var t=this.option.controller[e].symbolSize;t&&t[0]!==t[1]&&(t[0]=t[1]/3)},this)},t.prototype.setSelected=function(e){this.option.range=e.slice(),this._resetRange()},t.prototype.getSelected=function(){var e=this.getExtent(),t=LXe((this.get("range")||[]).slice());return t[0]>e[1]&&(t[0]=e[1]),t[1]>e[1]&&(t[1]=e[1]),t[0]<e[0]&&(t[0]=e[0]),t[1]<e[0]&&(t[1]=e[0]),t},t.prototype.getValueState=function(e){var t=this.option.range,a=this.getExtent(),n=FGe(this.option.unboundedRange,!0);return(n&&t[0]<=a[0]||t[0]<=e)&&(n&&t[1]>=a[1]||e<=t[1])?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(e){var t=[];return this.eachTargetSeries(function(a){var n=[],r=a.getData();r.each(this.getDataDimensionIndex(r),function(t,a){e[0]<=t&&t<=e[1]&&n.push(a)},this),t.push({seriesId:a.id,dataIndex:n})},this),t},t.prototype.getVisualMeta=function(e){var t=RSt(this,"outOfRange",this.getExtent()),a=RSt(this,"inRange",this.option.range.slice()),n=[];function r(t,a){n.push({value:t,color:e(t,a)})}for(var i=0,o=0,s=a.length,l=t.length;o<l&&(!a.length||t[o]<=a[0]);o++)t[o]<a[i]&&r(t[o],"outOfRange");for(var c=1;i<s;i++,c=0)c&&n.length&&r(a[i],"outOfRange"),r(a[i],"inRange");for(c=1;o<l;o++)(!a.length||a[a.length-1]<t[o])&&(c&&(n.length&&r(n[n.length-1].value,"outOfRange"),c=0),r(t[o],"outOfRange"));var u=n.length;return{stops:n,outerColors:[u?n[0].color:"transparent",u?n[u-1].color:"transparent"]}},t.type="visualMap.continuous",t.defaultOption=D1e(ASt.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:o5e.color.neutral00,borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:o5e.color.neutral00,borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:o5e.color.shadow}}),t}(ASt);function RSt(e,t,a){if(a[0]===a[1])return a.slice();for(var n=(a[1]-a[0])/200,r=a[0],i=[],o=0;o<=200&&r<a[1];o++)i.push(r),r+=n;return i.push(a[1]),i}var DSt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.autoPositionValues={left:1,right:1,top:1,bottom:1},a}return zHe(t,e),t.prototype.init=function(e,t){this.ecModel=e,this.api=t},t.prototype.render=function(e,t,a,n){this.visualMapModel=e,!1!==e.get("show")?this.doRender(e,t,a,n):this.group.removeAll()},t.prototype.renderBackground=function(e){var t=this.visualMapModel,a=S2e(t.get("padding")||0),n=e.getBoundingRect();e.add(new EZe({z2:-1,silent:!0,shape:{x:n.x-a[3],y:n.y-a[0],width:n.width+a[3]+a[1],height:n.height+a[0]+a[2]},style:{fill:t.get("backgroundColor"),stroke:t.get("borderColor"),lineWidth:t.get("borderWidth")}}))},t.prototype.getControllerVisual=function(e,t,a){var n=(a=a||{}).forceState,r=this.visualMapModel,i={};if("color"===t){var o=r.get("contentColor");i.color=o}function s(e){return i[e]}function l(e,t){i[e]=t}var c=r.controllerVisuals[n||r.getValueState(e)];return gGe(iut.prepareVisualTypes(c),function(n){var r=c[n];a.convertOpacityToAlpha&&"opacity"===n&&(n="colorAlpha",r=c.__alphaForOpacity),iut.dependsOn(n,t)&&r&&r.applyVisual(e,s,l)}),i[t]},t.prototype.positionGroup=function(e){var t=this.visualMapModel,a=J2e(t,this.api).refContainer;Q2e(e,t.getBoxLayoutParams(),a)},t.prototype.doRender=function(e,t,a,n){},t.type="visualMap",t}(n6e),PSt=[["left","right","width"],["top","bottom","height"]];function LSt(e,t,a){var n=e.option,r=n.align;if(null!=r&&"auto"!==r)return r;for(var i={width:t.getWidth(),height:t.getHeight()},o="horizontal"===n.orient?1:0,s=PSt[o],l=[0,null,10],c={},u=0;u<3;u++)c[PSt[1-o][u]]=l[u],c[s[u]]=2===u?a[0]:n[s[u]];var d=[["x","width",3],["y","height",0]][o],h=$2e(c,i,n.padding);return s[(h.margin[d[2]]||0)+h[d[0]]+.5*h[d[1]]<.5*i[d[1]]?0:1]}function NSt(e,t){return gGe(e||[],function(e){null!=e.dataIndex&&(e.dataIndexInside=e.dataIndex,e.dataIndex=null),e.highlightKey="visualMap"+(t?t.componentIndex:"")}),e}var OSt=IXe,FSt=gGe,BSt=Math.min,USt=Math.max,zSt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._shapes={},a._dataInterval=[],a._handleEnds=[],a._hoverLinkDataIndices=[],a}return zHe(t,e),t.prototype.init=function(t,a){e.prototype.init.call(this,t,a),this._hoverLinkFromSeriesMouseOver=SGe(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=SGe(this._hideIndicator,this)},t.prototype.doRender=function(e,t,a,n){n&&"selectDataRange"===n.type&&n.from===this.uid||this._buildView()},t.prototype._buildView=function(){this.group.removeAll();var e=this.visualMapModel,t=this.group;this._orient=e.get("orient"),this._useHandle=e.get("calculable"),this._resetInterval(),this._renderBar(t);var a=e.get("text");this._renderEndsText(t,a,0),this._renderEndsText(t,a,1),this._updateView(!0),this.renderBackground(t),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(t)},t.prototype._renderEndsText=function(e,t,a){if(t){var n=t[1-a];n=null!=n?n+"":"";var r=this.visualMapModel,i=r.get("textGap"),o=r.itemSize,s=this._shapes.mainGroup,l=this._applyTransform([o[0]/2,0===a?-i:o[1]+i],s),c=this._applyTransform(0===a?"bottom":"top",s),u=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new PZe({style:o1e(d,{x:l[0],y:l[1],verticalAlign:d.get("verticalAlign")||("horizontal"===u?"middle":c),align:d.get("align")||("horizontal"===u?c:"center"),text:n})}))}},t.prototype._renderBar=function(e){var t=this.visualMapModel,a=this._shapes,n=t.itemSize,r=this._orient,i=this._useHandle,o=LSt(t,this.api,n),s=a.mainGroup=this._createBarGroup(o),l=new xXe;s.add(l),l.add(a.outOfRange=VSt()),l.add(a.inRange=VSt(null,i?GSt(this._orient):null,SGe(this._dragHandle,this,"all",!1),SGe(this._dragHandle,this,"all",!0))),l.setClipPath(new EZe({shape:{x:0,y:0,width:n[0],height:n[1],r:3}}));var c=t.textStyleModel.getTextRect("国"),u=USt(c.width,c.height);i&&(a.handleThumbs=[],a.handleLabels=[],a.handleLabelPoints=[],this._createHandle(t,s,0,n,u,r),this._createHandle(t,s,1,n,u,r)),this._createIndicator(t,s,n,u,r),e.add(s)},t.prototype._createHandle=function(e,t,a,n,r,i){var o=SGe(this._dragHandle,this,a,!1),s=SGe(this._dragHandle,this,a,!0),l=sXe(e.get("handleSize"),n[0]),c=y8e(e.get("handleIcon"),-l/2,-l/2,l,l,null,!0),u=GSt(this._orient);c.attr({cursor:u,draggable:!0,drift:o,ondragend:s,onmousemove:function(e){VWe(e.event)}}),c.x=n[0]/2,c.useStyle(e.getModel("handleStyle").getItemStyle()),c.setStyle({strokeNoScale:!0,strokeFirst:!0}),c.style.lineWidth*=2,c.ensureState("emphasis").style=e.getModel(["emphasis","handleStyle"]).getItemStyle(),VJe(c,!0),t.add(c);var d=this.visualMapModel.textStyleModel,h=new PZe({cursor:u,draggable:!0,drift:o,onmousemove:function(e){VWe(e.event)},ondragend:s,style:o1e(d,{x:0,y:0,text:""})});h.ensureState("blur").style={opacity:.1},h.stateTransition={duration:200},this.group.add(h);var p=[l,0],f=this._shapes;f.handleThumbs[a]=c,f.handleLabelPoints[a]=p,f.handleLabels[a]=h},t.prototype._createIndicator=function(e,t,a,n,r){var i=sXe(e.get("indicatorSize"),a[0]),o=y8e(e.get("indicatorIcon"),-i/2,-i/2,i,i,null,!0);o.attr({cursor:"move",invisible:!0,silent:!0,x:a[0]/2});var s=e.getModel("indicatorStyle").getItemStyle();if(o instanceof _Ze){var l=o.style;o.useStyle(hGe({image:l.image,x:l.x,y:l.y,width:l.width,height:l.height},s))}else o.useStyle(s);t.add(o);var c=this.visualMapModel.textStyleModel,u=new PZe({silent:!0,invisible:!0,style:o1e(c,{x:0,y:0,text:""})});this.group.add(u);var d=[("horizontal"===r?n/2:6)+a[0]/2,0],h=this._shapes;h.indicator=o,h.indicatorLabel=u,h.indicatorLabelPoint=d,this._firstShowIndicator=!0},t.prototype._dragHandle=function(e,t,a,n){if(this._useHandle){if(this._dragging=!t,!t){var r=this._applyTransform([a,n],this._shapes.mainGroup,!0);this._updateInterval(e,r[1]),this._hideIndicator(),this._updateView()}t===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),t?!this._hovering&&this._clearHoverLinkToSeries():HSt(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[e],!1)}},t.prototype._resetInterval=function(){var e=this.visualMapModel,t=this._dataInterval=e.getSelected(),a=e.getExtent(),n=[0,e.itemSize[1]];this._handleEnds=[OSt(t[0],a,n,!0),OSt(t[1],a,n,!0)]},t.prototype._updateInterval=function(e,t){t=t||0;var a=this.visualMapModel,n=this._handleEnds,r=[0,a.itemSize[1]];_ht(t,n,r,e,0);var i=a.getExtent();this._dataInterval=[OSt(n[0],r,i,!0),OSt(n[1],r,i,!0)]},t.prototype._updateView=function(e){var t=this.visualMapModel,a=t.getExtent(),n=this._shapes,r=[0,t.itemSize[1]],i=e?r:this._handleEnds,o=this._createBarVisual(this._dataInterval,a,i,"inRange"),s=this._createBarVisual(a,a,r,"outOfRange");n.inRange.setStyle({fill:o.barColor}).setShape("points",o.barPoints),n.outOfRange.setStyle({fill:s.barColor}).setShape("points",s.barPoints),this._updateHandle(i,o)},t.prototype._createBarVisual=function(e,t,a,n){var r={forceState:n,convertOpacityToAlpha:!0},i=this._makeColorGradient(e,r),o=[this.getControllerVisual(e[0],"symbolSize",r),this.getControllerVisual(e[1],"symbolSize",r)],s=this._createBarPoints(a,o);return{barColor:new XQe(0,0,0,1,i),barPoints:s,handlesColor:[i[0].color,i[i.length-1].color]}},t.prototype._makeColorGradient=function(e,t){var a=[],n=(e[1]-e[0])/100;a.push({color:this.getControllerVisual(e[0],"color",t),offset:0});for(var r=1;r<100;r++){var i=e[0]+n*r;if(i>e[1])break;a.push({color:this.getControllerVisual(i,"color",t),offset:r/100})}return a.push({color:this.getControllerVisual(e[1],"color",t),offset:1}),a},t.prototype._createBarPoints=function(e,t){var a=this.visualMapModel.itemSize;return[[a[0]-t[0],e[0]],[a[0],e[0]],[a[0],e[1]],[a[0]-t[1],e[1]]]},t.prototype._createBarGroup=function(e){var t=this._orient,a=this.visualMapModel.get("inverse");return new xXe("horizontal"!==t||a?"horizontal"===t&&a?{scaleX:"bottom"===e?-1:1,rotation:-Math.PI/2}:"vertical"!==t||a?{scaleX:"left"===e?1:-1}:{scaleX:"left"===e?1:-1,scaleY:-1}:{scaleX:"bottom"===e?1:-1,rotation:Math.PI/2})},t.prototype._updateHandle=function(e,t){if(this._useHandle){var a=this._shapes,n=this.visualMapModel,r=a.handleThumbs,i=a.handleLabels,o=n.itemSize,s=n.getExtent(),l=this._applyTransform("left",a.mainGroup);FSt([0,1],function(c){var u=r[c];u.setStyle("fill",t.handlesColor[c]),u.y=e[c];var d=OSt(e[c],[0,o[1]],s,!0),h=this.getControllerVisual(d,"symbolSize");u.scaleX=u.scaleY=h/o[0],u.x=o[0]-h/2;var p=R0e(a.handleLabelPoints[c],I0e(u,this.group));if("horizontal"===this._orient){var f="left"===l||"top"===l?(o[0]-h)/2:(o[0]-h)/-2;p[1]+=f}i[c].setStyle({x:p[0],y:p[1],text:n.formatValueText(this._dataInterval[c]),verticalAlign:"middle",align:"vertical"===this._orient?this._applyTransform("left",a.mainGroup):"center"})},this)}},t.prototype._showIndicator=function(e,t,a,n){var r=this.visualMapModel,i=r.getExtent(),o=r.itemSize,s=[0,o[1]],l=this._shapes,c=l.indicator;if(c){c.attr("invisible",!1);var u=this.getControllerVisual(e,"color",{convertOpacityToAlpha:!0}),d=this.getControllerVisual(e,"symbolSize"),h=OSt(e,i,s,!0),p=o[0]-d/2,f={x:c.x,y:c.y};c.y=h,c.x=p;var m=R0e(l.indicatorLabelPoint,I0e(c,this.group)),v=l.indicatorLabel;v.attr("invisible",!1);var g=this._applyTransform("left",l.mainGroup),y="horizontal"===this._orient;v.setStyle({text:(a||"")+r.formatValueText(t),verticalAlign:y?g:"middle",align:y?"center":g});var b={x:p,y:h,style:{fill:u}},x={style:{x:m[0],y:m[1]}};if(r.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var w={duration:100,easing:"cubicInOut",additive:!0};c.x=f.x,c.y=f.y,c.animateTo(b,w),v.animateTo(x,w)}else c.attr(b),v.attr(x);this._firstShowIndicator=!1;var _=this._shapes.handleLabels;if(_)for(var S=0;S<_.length;S++)this.api.enterBlur(_[S])}},t.prototype._enableHoverLinkToSeries=function(){var e=this;this._shapes.mainGroup.on("mousemove",function(t){if(e._hovering=!0,!e._dragging){var a=e.visualMapModel.itemSize,n=e._applyTransform([t.offsetX,t.offsetY],e._shapes.mainGroup,!0,!0);n[1]=BSt(USt(0,n[1]),a[1]),e._doHoverLinkToSeries(n[1],0<=n[0]&&n[0]<=a[0])}}).on("mouseout",function(){e._hovering=!1,!e._dragging&&e._clearHoverLinkToSeries()})},t.prototype._enableHoverLinkFromSeries=function(){var e=this.api.getZr();this.visualMapModel.option.hoverLink?(e.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),e.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},t.prototype._doHoverLinkToSeries=function(e,t){var a=this.visualMapModel,n=a.itemSize;if(a.option.hoverLink){var r=[0,n[1]],i=a.getExtent();e=BSt(USt(r[0],e),r[1]);var o=function(e,t,a){var n=6,r=e.get("hoverLinkDataSize");r&&(n=OSt(r,t,a,!0)/2);return n}(a,i,r),s=[e-o,e+o],l=OSt(e,r,i,!0),c=[OSt(s[0],r,i,!0),OSt(s[1],r,i,!0)];s[0]<r[0]&&(c[0]=-1/0),s[1]>r[1]&&(c[1]=1/0),t&&(c[0]===-1/0?this._showIndicator(l,c[1],"< ",o):c[1]===1/0?this._showIndicator(l,c[0],"> ",o):this._showIndicator(l,l,"≈ ",o));var u=this._hoverLinkDataIndices,d=[];(t||HSt(a))&&(d=this._hoverLinkDataIndices=a.findTargetDataIndices(c));var h=function(e,t){var a={},n={};return r(e||[],a),r(t||[],n,a),[i(a),i(n)];function r(e,t,a){for(var n=0,r=e.length;n<r;n++){var i=h$e(e[n].seriesId,null);if(null==i)return;for(var o=r$e(e[n].dataIndex),s=a&&a[i],l=0,c=o.length;l<c;l++){var u=o[l];s&&s[u]?s[u]=null:(t[i]||(t[i]={}))[u]=1}}}function i(e,t){var a=[];for(var n in e)if(e.hasOwnProperty(n)&&null!=e[n])if(t)a.push(+n);else{var r=i(e[n],!0);r.length&&a.push({seriesId:n,dataIndex:r})}return a}}(u,d);this._dispatchHighDown("downplay",NSt(h[0],a)),this._dispatchHighDown("highlight",NSt(h[1],a))}},t.prototype._hoverLinkFromSeriesMouseOver=function(e){var t;if(o8e(e.target,function(e){var a=YZe(e);if(null!=a.dataIndex)return t=a,!0},!0),t){var a=this.ecModel.getSeriesByIndex(t.seriesIndex),n=this.visualMapModel;if(n.isTargetSeries(a)){var r=a.getData(t.dataType),i=r.getStore().get(n.getDataDimensionIndex(r),t.dataIndex);isNaN(i)||this._showIndicator(i,i)}}},t.prototype._hideIndicator=function(){var e=this._shapes;e.indicator&&e.indicator.attr("invisible",!0),e.indicatorLabel&&e.indicatorLabel.attr("invisible",!0);var t=this._shapes.handleLabels;if(t)for(var a=0;a<t.length;a++)this.api.leaveBlur(t[a])},t.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var e=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",NSt(e,this.visualMapModel)),e.length=0},t.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var e=this.api.getZr();e.off("mouseover",this._hoverLinkFromSeriesMouseOver),e.off("mouseout",this._hideIndicator)},t.prototype._applyTransform=function(e,t,a,n){var r=I0e(t,n?null:this.group);return TGe(e)?R0e(e,r,a):D0e(e,r,a)},t.prototype._dispatchHighDown=function(e,t){t&&t.length&&this.api.dispatchAction({type:e,batch:t})},t.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},t.type="visualMap.continuous",t}(DSt);function VSt(e,t,a,n){return new LQe({shape:{points:e},draggable:!!a,cursor:t,drift:a,onmousemove:function(e){VWe(e.event)},ondragend:n})}function HSt(e){var t=e.get("hoverLinkOnHandle");return!!(null==t?e.get("realtime"):t)}function GSt(e){return"vertical"===e?"ns-resize":"ew-resize"}var WSt={type:"selectDataRange",event:"dataRangeSelected",update:"update"},qSt=function(e,t){t.eachComponent({mainType:"visualMap",query:e},function(t){t.setSelected(e.selected)})},YSt=[{createOnAllSeries:!0,reset:function(e,t){var a=[];return t.eachComponent("visualMap",function(t){var n,r,i,o,s,l=e.pipelineContext;!t.isTargetSeries(e)||l&&l.large||a.push((n=t.stateList,r=t.targetVisuals,i=SGe(t.getValueState,t),o=t.getDataDimensionIndex(e.getData()),s={},gGe(n,function(e){var t=iut.prepareVisualTypes(r[e]);s[e]=t}),{progress:function(e,t){var a,n;function l(e){return t8e(t,n,e)}function c(e,a){n8e(t,n,e,a)}null!=o&&(a=t.getDimensionIndex(o));for(var u=t.getStore();null!=(n=e.next());){var d=t.getRawDataItem(n);if(!d||!1!==d.visualMap)for(var h=null!=o?u.get(a,n):n,p=i(h),f=r[p],m=s[p],v=0,g=m.length;v<g;v++){var y=m[v];f[y]&&f[y].applyVisual(h,l,c)}}}}))}),a}},{createOnAllSeries:!0,reset:function(e,t){var a=e.getData(),n=[];t.eachComponent("visualMap",function(t){if(t.isTargetSeries(e)){var r=t.getVisualMeta(SGe(jSt,null,e,t))||{stops:[],outerColors:[]},i=t.getDataDimensionIndex(a);i>=0&&(r.dimension=i,n.push(r))}}),e.getData().setVisual("visualMeta",n)}}];function jSt(e,t,a,n){for(var r=t.targetVisuals[n],i=iut.prepareVisualTypes(r),o={color:a8e(e.getData(),"color")},s=0,l=i.length;s<l;s++){var c=i[s],u=r["opacity"===c?"__alphaForOpacity":c];u&&u.applyVisual(a,d,h)}return o.color;function d(e){return o[e]}function h(e,t){o[e]=t}}var XSt=gGe;function $St(e){var t=e&&e.visualMap;TGe(t)||(t=t?[t]:[]),XSt(t,function(e){if(e){KSt(e,"splitList")&&!KSt(e,"pieces")&&(e.pieces=e.splitList,delete e.splitList);var t=e.pieces;t&&TGe(t)&&XSt(t,function(e){IGe(e)&&(KSt(e,"start")&&!KSt(e,"min")&&(e.min=e.start),KSt(e,"end")&&!KSt(e,"max")&&(e.max=e.end))})}})}function KSt(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var ZSt=!1;function JSt(e){ZSt||(ZSt=!0,e.registerSubTypeDefaulter("visualMap",function(e){return e.categories||(e.pieces?e.pieces.length>0:e.splitNumber>0)&&!e.calculable?"piecewise":"continuous"}),e.registerAction(WSt,qSt),gGe(YSt,function(t){e.registerVisual(e.PRIORITY.VISUAL.COMPONENT,t)}),e.registerPreprocessor($St))}function QSt(e){e.registerComponentModel(ISt),e.registerComponentView(zSt),JSt(e)}var eMt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a._pieceList=[],a}return zHe(t,e),t.prototype.optionUpdated=function(t,a){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var n=this._mode=this._determineMode();this._pieceList=[],tMt[this._mode].call(this,this._pieceList),this._resetSelected(t,a);var r=this.option.categories;this.resetVisual(function(e,t){"categories"===n?(e.mappingMethod="category",e.categories=cGe(r)):(e.dataExtent=this.getExtent(),e.mappingMethod="piecewise",e.pieceList=yGe(this._pieceList,function(e){return e=cGe(e),"inRange"!==t&&(e.visual=null),e}))})},t.prototype.completeVisualOption=function(){var t=this.option,a={},n=iut.listVisualTypes(),r=this.isCategory();function i(e,t,a){return e&&e[t]&&e[t].hasOwnProperty(a)}gGe(t.pieces,function(e){gGe(n,function(t){e.hasOwnProperty(t)&&(a[t]=1)})}),gGe(a,function(e,a){var n=!1;gGe(this.stateList,function(e){n=n||i(t,e,a)||i(t.target,e,a)},this),!n&&gGe(this.stateList,function(e){(t[e]||(t[e]={}))[a]=xSt(a,"inRange"===e?"active":"inactive",r)})},this),e.prototype.completeVisualOption.apply(this,arguments)},t.prototype._resetSelected=function(e,t){var a=this.option,n=this._pieceList,r=(t?a:e).selected||{};if(a.selected=r,gGe(n,function(e,t){var a=this.getSelectedMapKey(e);r.hasOwnProperty(a)||(r[a]=!0)},this),"single"===a.selectedMode){var i=!1;gGe(n,function(e,t){var a=this.getSelectedMapKey(e);r[a]&&(i?r[a]=!1:i=!0)},this)}},t.prototype.getItemSymbol=function(){return this.get("itemSymbol")},t.prototype.getSelectedMapKey=function(e){return"categories"===this._mode?e.value+"":e.index+""},t.prototype.getPieceList=function(){return this._pieceList},t.prototype._determineMode=function(){var e=this.option;return e.pieces&&e.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},t.prototype.setSelected=function(e){this.option.selected=cGe(e)},t.prototype.getValueState=function(e){var t=iut.findPieceIndex(e,this._pieceList);return null!=t&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(e){var t=[],a=this._pieceList;return this.eachTargetSeries(function(n){var r=[],i=n.getData();i.each(this.getDataDimensionIndex(i),function(t,n){iut.findPieceIndex(t,a)===e&&r.push(n)},this),t.push({seriesId:n.id,dataIndex:r})},this),t},t.prototype.getRepresentValue=function(e){var t;if(this.isCategory())t=e.value;else if(null!=e.value)t=e.value;else{var a=e.interval||[];t=a[0]===-1/0&&a[1]===1/0?0:(a[0]+a[1])/2}return t},t.prototype.getVisualMeta=function(e){if(!this.isCategory()){var t=[],a=["",""],n=this,r=this._pieceList.slice();if(r.length){var i=r[0].interval[0];i!==-1/0&&r.unshift({interval:[-1/0,i]}),(i=r[r.length-1].interval[1])!==1/0&&r.push({interval:[i,1/0]})}else r.push({interval:[-1/0,1/0]});var o=-1/0;return gGe(r,function(e){var t=e.interval;t&&(t[0]>o&&s([o,t[0]],"outOfRange"),s(t.slice()),o=t[1])},this),{stops:t,outerColors:a}}function s(r,i){var o=n.getRepresentValue({interval:r});i||(i=n.getValueState(o));var s=e(o,i);r[0]===-1/0?a[0]=s:r[1]===1/0?a[1]=s:t.push({value:r[0],color:s},{value:r[1],color:s})}},t.type="visualMap.piecewise",t.defaultOption=D1e(ASt.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),t}(ASt),tMt={splitNumber:function(e){var t=this.option,a=Math.min(t.precision,20),n=this.getExtent(),r=t.splitNumber;r=Math.max(parseInt(r,10),1),t.splitNumber=r;for(var i=(n[1]-n[0])/r;+i.toFixed(a)!==i&&a<5;)a++;t.precision=a,i=+i.toFixed(a),t.minOpen&&e.push({interval:[-1/0,n[0]],close:[0,0]});for(var o=0,s=n[0];o<r;s+=i,o++){var l=o===r-1?n[1]:s+i;e.push({interval:[s,l],close:[1,1]})}t.maxOpen&&e.push({interval:[n[1],1/0],close:[0,0]}),YXe(e),gGe(e,function(e,t){e.index=t,e.text=this.formatValueText(e.interval)},this)},categories:function(e){var t=this.option;gGe(t.categories,function(t){e.push({text:this.formatValueText(t,!0),value:t})},this),aMt(t,e)},pieces:function(e){var t=this.option;gGe(t.pieces,function(t,a){IGe(t)||(t={value:t});var n={text:"",index:a};if(null!=t.label&&(n.text=t.label),t.hasOwnProperty("value")){var r=n.value=t.value;n.interval=[r,r],n.close=[1,1]}else{for(var i=n.interval=[],o=n.close=[0,0],s=[1,0,1],l=[-1/0,1/0],c=[],u=0;u<2;u++){for(var d=[["gte","gt","min"],["lte","lt","max"]][u],h=0;h<3&&null==i[u];h++)i[u]=t[d[h]],o[u]=s[h],c[u]=2===h;null==i[u]&&(i[u]=l[u])}c[0]&&i[1]===1/0&&(o[0]=0),c[1]&&i[0]===-1/0&&(o[1]=0),i[0]===i[1]&&o[0]&&o[1]&&(n.value=i[0])}n.visual=iut.retrieveVisuals(t),e.push(n)},this),aMt(t,e),YXe(e),gGe(e,function(e){var t=e.close,a=[["<","≤"][t[1]],[">","≥"][t[0]]];e.text=e.text||this.formatValueText(null!=e.value?e.value:e.interval,!1,a)},this)}};function aMt(e,t){var a=e.inverse;("vertical"===e.orient?!a:a)&&t.reverse()}var nMt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.doRender=function(){var e=this.group;e.removeAll();var t=this.visualMapModel,a=t.get("textGap"),n=t.textStyleModel,r=this._getItemAlign(),i=t.itemSize,o=this._getViewData(),s=o.endsText,l=OGe(t.get("showLabel",!0),!s),c=!t.get("selectedMode");s&&this._renderEndsText(e,s[0],i,l,r),gGe(o.viewPieceList,function(o){var s=o.piece,u=new xXe;u.onclick=SGe(this._onItemClick,this,s),this._enableHoverLink(u,o.indexInModelPieceList);var d=t.getRepresentValue(s);if(this._createItemSymbol(u,d,[0,0,i[0],i[1]],c),l){var h=this.visualMapModel.getValueState(d),p=n.get("align")||r;u.add(new PZe({style:o1e(n,{x:"right"===p?-a:i[0]+a,y:i[1]/2,text:s.text,verticalAlign:n.get("verticalAlign")||"middle",align:p,opacity:FGe(n.get("opacity"),"outOfRange"===h?.5:1)}),silent:c}))}e.add(u)},this),s&&this._renderEndsText(e,s[1],i,l,r),Y2e(t.get("orient"),e,t.get("itemGap")),this.renderBackground(e),this.positionGroup(e)},t.prototype._enableHoverLink=function(e,t){var a=this;e.on("mouseover",function(){return n("highlight")}).on("mouseout",function(){return n("downplay")});var n=function(e){var n=a.visualMapModel;n.option.hoverLink&&a.api.dispatchAction({type:e,batch:NSt(n.findTargetDataIndices(t),n)})}},t.prototype._getItemAlign=function(){var e=this.visualMapModel,t=e.option;if("vertical"===t.orient)return LSt(e,this.api,e.itemSize);var a=t.align;return a&&"auto"!==a||(a="left"),a},t.prototype._renderEndsText=function(e,t,a,n,r){if(t){var i=new xXe,o=this.visualMapModel.textStyleModel;i.add(new PZe({style:o1e(o,{x:n?"right"===r?a[0]:0:a[0]/2,y:a[1]/2,verticalAlign:"middle",align:n?r:"center",text:t})})),e.add(i)}},t.prototype._getViewData=function(){var e=this.visualMapModel,t=yGe(e.getPieceList(),function(e,t){return{piece:e,indexInModelPieceList:t}}),a=e.get("text"),n=e.get("orient"),r=e.get("inverse");return("horizontal"===n?r:!r)?t.reverse():a&&(a=a.slice().reverse()),{viewPieceList:t,endsText:a}},t.prototype._createItemSymbol=function(e,t,a,n){var r=y8e(this.getControllerVisual(t,"symbol"),a[0],a[1],a[2],a[3],this.getControllerVisual(t,"color"));r.silent=n,e.add(r)},t.prototype._onItemClick=function(e){var t=this.visualMapModel,a=t.option,n=a.selectedMode;if(n){var r=cGe(a.selected),i=t.getSelectedMapKey(e);"single"===n||!0===n?(r[i]=!0,gGe(r,function(e,t){r[t]=t===i})):r[i]=!r[i],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:r})}},t.type="visualMap.piecewise",t}(DSt);function rMt(e){e.registerComponentModel(eMt),e.registerComponentView(nMt),JSt(e)}function iMt(e){Qet(QSt),Qet(rMt)}var oMt=function(){function e(e){this._thumbnailModel=e}return e.prototype.reset=function(e){this._renderVersion=e.getMainProcessVersion()},e.prototype.renderContent=function(e){var t=e.api.getViewOfComponentModel(this._thumbnailModel);t&&(e.group.silent=!0,t.renderContent({group:e.group,targetTrans:e.targetTrans,z2Range:Z0e(e.group),roamType:e.roamType,viewportRect:e.viewportRect,renderVersion:this._renderVersion}))},e.prototype.updateWindow=function(e,t){var a=t.getViewOfComponentModel(this._thumbnailModel);a&&a.updateWindow({targetTrans:e,renderVersion:this._renderVersion})},e}(),sMt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a.preventAutoZ=!0,a}return zHe(t,e),t.prototype.optionUpdated=function(e,t){this._updateBridge()},t.prototype._updateBridge=function(){var e=this._birdge=this._birdge||new oMt(this);(this._target=null,this.ecModel.eachSeries(function(e){Ddt(e,null)}),this.shouldShow())&&Ddt(this.getTarget().baseMapProvider,e)},t.prototype.shouldShow=function(){return this.getShallow("show",!0)},t.prototype.getBridge=function(){return this._birdge},t.prototype.getTarget=function(){if(this._target)return this._target;var e=this.getReferringComponents("series",{useDefault:!1,enableAll:!1,enableNone:!1}).models[0];return e?"graph"!==e.subType&&(e=null):e=this.ecModel.queryComponents({mainType:"series",subType:"graph"})[0],this._target={baseMapProvider:e},this._target},t.type="thumbnail",t.layoutMode="box",t.dependencies=["series","geo"],t.defaultOption={show:!0,right:1,bottom:1,height:"25%",width:"25%",itemStyle:{borderColor:o5e.color.border,borderWidth:2},windowStyle:{borderWidth:1,color:o5e.color.neutral30,borderColor:o5e.color.neutral40,opacity:.3},z:10},t}(i5e),lMt=function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.type=t.type,a}return zHe(t,e),t.prototype.render=function(e,t,a){if(this._api=a,this._model=e,this._coordSys||(this._coordSys=new Wlt),this._isEnabled()){this._renderVersion=a.getMainProcessVersion();var n=this.group;n.removeAll();var r=e.getModel("itemStyle"),i=r.getItemStyle();null==i.fill&&(i.fill=t.get("backgroundColor")||o5e.color.neutral00);var o=J2e(e,a).refContainer,s=$2e(j2e(e,!0),o),l=i.lineWidth||0,c=this._contentRect=z0e(s.clone(),l/2,!0,!0),u=new xXe;n.add(u),u.setClipPath(new EZe({shape:c.plain()}));var d=this._targetGroup=new xXe;u.add(d);var h=s.plain();h.r=r.getShallow("borderRadius",!0),n.add(this._bgRect=new EZe({style:i,shape:h,silent:!1,cursor:"grab"}));var p=e.getModel("windowStyle"),f=p.getShallow("borderRadius",!0);u.add(this._windowRect=new EZe({shape:{x:0,y:0,width:0,height:0,r:f},style:p.getItemStyle(),silent:!1,cursor:"grab"})),this._dealRenderContent(),this._dealUpdateWindow(),uMt(e,this)}else this._clear()},t.prototype.renderContent=function(e){this._bridgeRendered=e,this._isEnabled()&&(this._dealRenderContent(),this._dealUpdateWindow(),uMt(this._model,this))},t.prototype._dealRenderContent=function(){var e=this._bridgeRendered;if(e&&e.renderVersion===this._renderVersion){var t=this._targetGroup,a=this._coordSys,n=this._contentRect;if(t.removeAll(),e){var r=e.group,i=r.getBoundingRect();t.add(r),this._bgRect.z2=e.z2Range.min-10,a.setBoundingRect(i.x,i.y,i.width,i.height);var o=$2e({left:"center",top:"center",aspect:i.width/i.height},n);a.setViewRect(o.x,o.y,o.width,o.height),r.attr(a.getTransformInfo().raw),this._windowRect.z2=e.z2Range.max+10,this._resetRoamController(e.roamType)}}},t.prototype.updateWindow=function(e){var t=this._bridgeRendered;t&&t.renderVersion===e.renderVersion&&(t.targetTrans=e.targetTrans),this._isEnabled()&&this._dealUpdateWindow()},t.prototype._dealUpdateWindow=function(){var e=this._bridgeRendered;if(e&&e.renderVersion===this._renderVersion){var t=QWe([],e.targetTrans),a=$We([],this._coordSys.transform,t);this._transThisToTarget=QWe([],a);var n=e.viewportRect;(n=n?n.clone():new fqe(0,0,this._api.getWidth(),this._api.getHeight())).applyTransform(a);var r=this._windowRect,i=r.shape.r;r.setShape(pGe({r:i},n))}},t.prototype._resetRoamController=function(e){var t=this,a=this._api,n=this._roamController;n||(n=this._roamController=new Tst(a.getZr())),e&&this._isEnabled()?(n.enable(e,{api:a,zInfo:{component:this._model},triggerInfo:{roamTrigger:null,isInSelf:function(e,a,n){return t._contentRect.contain(a,n)}}}),n.off("pan").off("zoom").on("pan",SGe(this._onPan,this)).on("zoom",SGe(this._onZoom,this))):n.disable()},t.prototype._onPan=function(e){var t=this._transThisToTarget;if(this._isEnabled()&&t){var a=vWe([],[e.oldX,e.oldY],t),n=vWe([],[e.oldX-e.dx,e.oldY-e.dy],t);this._api.dispatchAction(cMt(this._model.getTarget().baseMapProvider,{dx:n[0]-a[0],dy:n[1]-a[1]}))}},t.prototype._onZoom=function(e){var t=this._transThisToTarget;if(this._isEnabled()&&t){var a=vWe([],[e.originX,e.originY],t);this._api.dispatchAction(cMt(this._model.getTarget().baseMapProvider,{zoom:1/e.scale,originX:a[0],originY:a[1]}))}},t.prototype._isEnabled=function(){var e=this._model;return!(!e||!e.shouldShow())&&!!e.getTarget().baseMapProvider},t.prototype._clear=function(){this.group.removeAll(),this._bridgeRendered=null,this._roamController&&this._roamController.disable()},t.prototype.remove=function(){this._clear()},t.prototype.dispose=function(){this._clear()},t.type="thumbnail",t}(n6e);function cMt(e,t){var a={type:"series"===e.mainType?e.subType+"Roam":e.mainType+"Roam"};return a[e.mainType+"Id"]=e.id,hGe(a,t),a}function uMt(e,t){var a=K0e(e);J0e(t.group,a.z,a.zlevel)}var dMt={label:{enabled:!0},decal:{show:!1}},hMt=v$e(),pMt={};function fMt(e,t){var a=e.getModel("aria");if(a.get("enabled")){var n=cGe(dMt);uGe(n.label,e.getLocaleModel().get("aria"),!1),uGe(a.option,n,!1),function(){if(a.getModel("decal").get("show")){var t=$Ge();e.eachSeries(function(e){if(!e.isColorBySeries()){var a=t.get(e.type);a||(a={},t.set(e.type,a)),hMt(e).scope=a}}),e.eachRawSeries(function(t){if(!e.isSeriesFiltered(t))if(kGe(t.enableAriaDecal))t.enableAriaDecal();else{var a=t.getData();if(t.isColorBySeries()){var n=z5e(t.ecModel,t.name,pMt,e.getSeriesCount()),r=a.getVisual("decal");a.setVisual("decal",c(r,n))}else{var i=t.getRawData(),o={},s=hMt(t).scope;a.each(function(e){var t=a.getRawIndex(e);o[t]=e});var l=i.count();i.each(function(e){var n=o[e],r=i.getName(e)||e+"",u=z5e(t.ecModel,r,s,l),d=a.getItemVisual(n,"decal");a.setItemVisual(n,"decal",c(d,u))})}}function c(e,t){var a=e?hGe(hGe({},t),e):t;return a.dirty=!0,a}})}}(),function(){var n=t.getZr().dom;if(!n)return;var i=e.getLocaleModel().get("aria"),o=a.getModel("label");if(o.option=pGe(o.option,i),!o.get("enabled"))return;if(n.setAttribute("role","img"),o.get("description"))return void n.setAttribute("aria-label",o.get("description"));var s,l=e.getSeriesCount(),c=o.get(["data","maxCount"])||10,u=o.get(["series","maxCount"])||10,d=Math.min(l,u);if(l<1)return;var h=function(){var t=e.get("title");t&&t.length&&(t=t[0]);return t&&t.text}();s=h?r(o.get(["general","withTitle"]),{title:h}):o.get(["general","withoutTitle"]);var p=[];s+=r(l>1?o.get(["series","multiple","prefix"]):o.get(["series","single","prefix"]),{seriesCount:l}),e.eachSeries(function(t,a){if(a<d){var n=void 0,i=t.get("name")?"withName":"withoutName";n=r(n=l>1?o.get(["series","multiple",i]):o.get(["series","single",i]),{seriesId:t.seriesIndex,seriesName:t.get("name"),seriesType:(x=t.subType,w=e.getLocaleModel().get(["series","typeNames"]),w[x]||w.chart)});var s=t.getData();if(s.count()>c)n+=r(o.get(["data","partialData"]),{displayCnt:c});else n+=o.get(["data","allData"]);for(var u=o.get(["data","separator","middle"]),h=o.get(["data","separator","end"]),f=o.get(["data","excludeDimensionId"]),m=[],v=0;v<s.count();v++)if(v<c){var g=s.getName(v),y=f?xGe(s.getValues(v),function(e,t){return-1===fGe(f,t)}):s.getValues(v),b=o.get(["data",g?"withName":"withoutName"]);m.push(r(b,{name:g,value:y.join(u)}))}n+=m.join(u)+h,p.push(n)}var x,w});var f=o.getModel(["series","multiple","separator"]),m=f.get("middle"),v=f.get("end");s+=p.join(m)+v,n.setAttribute("aria-label",s)}()}function r(e,t){if(!CGe(e))return e;var a=e;return gGe(t,function(e,t){a=a.replace(new RegExp("\\{\\s*"+t+"\\s*\\}","g"),e)}),a}}function mMt(e){if(e&&e.aria){var t=e.aria;null!=t.show&&(t.enabled=t.show),t.label=t.label||{},gGe(["description","general","series","data"],function(e){null!=t[e]&&(t.label[e]=t[e])})}}var vMt={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},gMt=function(){function e(e){var t;if(null==(this._condVal=CGe(e)?new RegExp(e):(t=e,"[object RegExp]"===ZHe.call(t)?e:null))){e$e("")}}return e.prototype.evaluate=function(e){var t=typeof e;return CGe(t)?this._condVal.test(e):!!EGe(t)&&this._condVal.test(e+"")},e}(),yMt=function(){function e(){}return e.prototype.evaluate=function(){return this.value},e}(),bMt=function(){function e(){}return e.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(!e[t].evaluate())return!1;return!0},e}(),xMt=function(){function e(){}return e.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(e[t].evaluate())return!0;return!1},e}(),wMt=function(){function e(){}return e.prototype.evaluate=function(){return!this.child.evaluate()},e}(),_Mt=function(){function e(){}return e.prototype.evaluate=function(){for(var e=!!this.valueParser,t=(0,this.getValue)(this.valueGetterParam),a=e?this.valueParser(t):null,n=0;n<this.subCondList.length;n++)if(!this.subCondList[n].evaluate(e?a:t))return!1;return!0},e}();function SMt(e,t){if(!0===e||!1===e){var a=new yMt;return a.value=e,a}return TMt(e)||e$e(""),e.and?MMt("and",e,t):e.or?MMt("or",e,t):e.not?function(e,t){var a=e.not,n="";TMt(a)||e$e(n);var r=new wMt;r.child=SMt(a,t),r.child||e$e(n);return r}(e,t):function(e,t){for(var a="",n=t.prepareGetValue(e),r=[],i=_Ge(e),o=e.parser,s=o?Q4e(o):null,l=0;l<i.length;l++){var c=i[l];if("parser"!==c&&!t.valueGetterAttrMap.get(c)){var u=QGe(vMt,c)?vMt[c]:c,d=e[c],h=s?s(d):d,p=r3e(u,h)||"reg"===u&&new gMt(h);p||e$e(a),r.push(p)}}r.length||e$e(a);var f=new _Mt;return f.valueGetterParam=n,f.valueParser=s,f.getValue=t.getValue,f.subCondList=r,f}(e,t)}function MMt(e,t,a){var n=t[e];TGe(n)||e$e(""),n.length||e$e("");var r="and"===e?new bMt:new xMt;return r.children=yGe(n,function(e){return SMt(e,a)}),r.children.length||e$e(""),r}function TMt(e){return IGe(e)&&!vGe(e)}var kMt=function(){function e(e,t){this._cond=SMt(e,t)}return e.prototype.evaluate=function(){return this._cond.evaluate()},e}();var CMt={type:"echarts:filter",transform:function(e){for(var t,a,n,r=e.upstream,i=(a=e.config,n={valueGetterAttrMap:$Ge({dimension:!0}),prepareGetValue:function(e){var t=e.dimension;QGe(e,"dimension")||e$e("");var a=r.getDimensionInfo(t);return a||e$e(""),{dimIdx:a.index}},getValue:function(e){return r.retrieveValueFromItem(t,e.dimIdx)}},new kMt(a,n)),o=[],s=0,l=r.count();s<l;s++)t=r.getRawDataItem(s),i.evaluate()&&o.push(t);return{data:o}}},AMt={type:"echarts:sort",transform:function(e){var t=e.upstream,a=e.config,n="",r=r$e(a);r.length||e$e(n);var i=[];gGe(r,function(e){var a=e.dimension,r=e.order,o=e.parser,s=e.incomparable;if(null==a&&e$e(n),"asc"!==r&&"desc"!==r&&e$e(n),s&&"min"!==s&&"max"!==s){e$e("")}if("asc"!==r&&"desc"!==r){e$e("")}var l=t.getDimensionInfo(a);l||e$e(n);var c=o?Q4e(o):null;o&&!c&&e$e(n),i.push({dimIdx:l.index,parser:c,comparator:new a3e(r,s)})});var o=t.sourceFormat;o!==g5e&&o!==y5e&&e$e(n);for(var s=[],l=0,c=t.count();l<c;l++)s.push(t.getRawDataItem(l));return s.sort(function(e,a){for(var n=0;n<i.length;n++){var r=i[n],o=t.retrieveValueFromItem(e,r.dimIdx),s=t.retrieveValueFromItem(a,r.dimIdx);r.parser&&(o=r.parser(o),s=r.parser(s));var l=r.comparator.evaluate(o,s);if(0!==l)return l}return 0}),{data:s}}};var EMt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dataset",t}return zHe(t,e),t.prototype.init=function(t,a,n){e.prototype.init.call(this,t,a,n),this._sourceManager=new T3e(this),k3e(this)},t.prototype.mergeOption=function(t,a){e.prototype.mergeOption.call(this,t,a),k3e(this)},t.prototype.optionUpdated=function(){this._sourceManager.dirty()},t.prototype.getSourceManager=function(){return this._sourceManager},t.type="dataset",t.defaultOption={seriesLayoutBy:_5e},t}(i5e),IMt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="dataset",t}return zHe(t,e),t.type="dataset",t}(n6e);const RMt=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function DMt(e){return RMt.reduce((t,a)=>(t[a]=function(t){return function(...a){if(!e.value)throw new Error("ECharts is not initialized yet.");return Reflect.apply(e.value[t],e.value,a)}}(a),t),{})}const PMt={autoresize:[Boolean,Object]},LMt=Symbol();const NMt={loading:Boolean,loadingOptions:Object};function OMt(){return"undefined"!=typeof window&&"undefined"!=typeof document}const FMt=/^on[^a-z]/,BMt=e=>FMt.test(e);function UMt(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}const zMt={tooltip:["tooltip","formatter"],dataView:["toolbox","feature","dataView","optionToContent"]},VMt=Object.keys(zMt);function HMt(e){return VMt.some(t=>e===t||e.startsWith(t+"-"))}function GMt(e,t){const a=OMt()?document.createElement("div"):void 0,i=X({}),o=X({}),s=X({}),l=W(!1);let c=[];return K(()=>{const a=Object.keys(e).filter(HMt);(function(e,t){const a=new Set(e),n=new Set(t);if(a.size!==n.size)return!1;for(const r of a)if(!n.has(r))return!1;return!0})(a,c)||(c.forEach(e=>{a.includes(e)||(delete s[e],delete o[e],delete i[e])}),c=a,t())}),n(()=>{l.value=!0}),r(()=>{a?.remove()}),{teleportedSlots:()=>l.value&&a?G(H,{to:a},Object.entries(e).filter(([e])=>HMt(e)).map(([e,t])=>{const a=e;return G("div",{ref:e=>{e instanceof HTMLElement&&(i[a]=e)},style:{display:"contents"}},o[a]?t?.(s[a]):void 0)})):void 0,patchOption:function(t){const a={...t},n=(e,t)=>{const a=e[t];return Array.isArray(a)?(e[t]=[...a],e[t]):null===(n=a)||"object"!=typeof n||Array.isArray(n)?void 0===a?(e[t]=function(e){const t=Number(e);return Number.isInteger(t)&&t>=0&&t<Math.pow(2,32)-1&&String(t)===e}(t)?[]:{},e[t]):void 0:(e[t]={...a},e[t]);var n};return Object.keys(e).filter(e=>HMt(e)).forEach(e=>{const[t,...r]=e.split("-"),l=zMt[t];if(!l)return;const c=[...r,...l];if(0===c.length)return;let u=a;for(let a=0;a<c.length-1;a++)if(u=n(u,c[a]),!u)return;u[c[c.length-1]]=t=>(o[e]=!0,s[e]=t,i[e])}),a}}}let WMt=null;const qMt="x-vue-echarts";function YMt(e){if(!UMt(e))return;const t=e.id;return"string"==typeof t?t:"number"==typeof t&&Number.isFinite(t)?String(t):void 0}function jMt(e){const t=e,a=Array.isArray(t.options)?t.options.length:0,n=Array.isArray(t.media)?t.media.length:0,r=Object.create(null),i=[],o=[];for(const s of Object.keys(t)){if("options"===s||"media"===s)continue;const e=t[s];if(Array.isArray(e)){const t=e,a=new Set;let n=0;for(let e=0;e<t.length;e++){const r=YMt(t[e]);void 0!==r?a.add(r):n++}r[s]={idsSorted:a.size>0?Array.from(a).sort():[],noIdCount:n}}else UMt(e)?i.push(s):void 0!==e&&o.push(s)}return i.length>1&&i.sort(),o.length>1&&o.sort(),{optionsLength:a,mediaLength:n,arrays:r,objects:i,scalars:o}}function XMt(e,t){if(0===e.length)return[];if(0===t.length)return e.slice();const a=new Set(t),n=[];for(let r=0;r<e.length;r++){const t=e[r];a.has(t)||n.push(t)}return n}function $Mt(e,t){if(0===e.length)return!1;if(0===t.length)return!0;const a=new Set(t);for(let n=0;n<e.length;n++)if(!a.has(e[n]))return!0;return!1}var KMt="x-vue-echarts{display:block;width:100%;height:100%;min-width:0;}\nx-vue-echarts>:first-child,x-vue-echarts>:first-child>canvas{border-radius:inherit;}\n";if("undefined"!=typeof document)if(Array.isArray(document.adoptedStyleSheets)&&"replaceSync"in CSSStyleSheet.prototype){const e=new CSSStyleSheet;e.replaceSync(KMt),document.adoptedStyleSheets=[...document.adoptedStyleSheets,e]}else{const e=document.createElement("style");e.textContent=KMt,document.head.appendChild(e)}const ZMt=function(){if(null!=WMt)return WMt;const e=globalThis.customElements;if(!OMt()||!e?.get)return WMt=!1,WMt;if(!e.get(qMt))try{class t extends HTMLElement{__dispose=null;disconnectedCallback(){this.__dispose&&(this.__dispose(),this.__dispose=null)}}e.define(qMt,t)}catch{return WMt=!1,WMt}return WMt=!0,WMt}(),JMt=Symbol(),QMt=Symbol(),eTt=Symbol();var tTt=e({name:"Echarts",inheritAttrs:!1,props:{option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean,...PMt,...NMt},emits:{},slots:Object,setup(e,{attrs:t,expose:a,slots:r}){const i=W(),o=W(),s=Z(JMt,null),l=Z(QMt,null),c=Z(eTt,null),{autoresize:u,manualUpdate:d,loading:h,loadingOptions:p}=q(e),f=S(()=>e.theme||Y(s)),m=S(()=>e.initOptions||Y(l)||void 0),v=S(()=>e.updateOptions||Y(c)),g=S(()=>function(e){const t={};for(const a in e)BMt(a)||(t[a]=e[a]);return t}(t)),y={},b=new Map,{teleportedSlots:x,patchOption:w}=GMt(r,()=>{!d.value&&e.option&&o.value&&M(o.value,e.option)});let _;function M(e,t,a,n=!1){const r=w(t);if(n)return e.setOption(r,a??{}),void(_=void 0);if(v.value){const t=a??v.value;return e.setOption(r,t),void(_=void 0)}const i=function(e,t){const a=jMt(t);if(!e)return{option:t,signature:a,plan:{notMerge:!1}};if(a.optionsLength<e.optionsLength)return{option:t,signature:a,plan:{notMerge:!0}};if(a.mediaLength<e.mediaLength)return{option:t,signature:a,plan:{notMerge:!0}};if(XMt(e.scalars,a.scalars).length>0)return{option:t,signature:a,plan:{notMerge:!0}};const n=new Set,r=new Map,i=XMt(e.objects,a.objects);for(let c=0;c<i.length;c++)r.set(i[c],null);for(const c of Object.keys(e.arrays)){const t=e.arrays[c];if(!t)continue;const i=a.arrays[c];i?($Mt(t.idsSorted,i.idsSorted)||i.noIdCount<t.noIdCount)&&n.add(c):(t.idsSorted.length>0||t.noIdCount>0)&&(r.set(c,[]),n.add(c))}let o=t,s=a;if(r.size>0){const e={...t};r.forEach((t,a)=>{e[a]=t}),o=e,s=jMt(o)}const l=n.size>0?Array.from(n).sort():void 0;return{option:o,signature:s,plan:l?{notMerge:!1,replaceMerge:l}:{notMerge:!1}}}(_,r),o=function(e){const t={},a=(e?.replaceMerge??[]).filter(e=>null!=e);return a.length>0&&(t.replaceMerge=[...new Set(a)]),void 0!==e?.notMerge&&(t.notMerge=e.notMerge),t}(i.plan);e.setOption(i.option,o),_=i.signature}function T(){if(!i.value)return;const t=o.value=Y7e(i.value,f.value,m.value);function a(){const{option:a}=e;d.value?a&&M(t,a,void 0,!0):a&&M(t,a)}e.group&&(t.group=e.group),b.forEach((e,{zr:a,once:n,event:r})=>{if(!e)return;const i=a?t.getZr():t;if(n){const t=e;let a=!1;e=(...n)=>{a||(a=!0,t(...n),i.off(r,e))}}i.on(r,e)}),u.value?A(()=>{t&&!t.isDisposed()&&t.resize(),a()}):a()}Object.keys(t).filter(e=>BMt(e)).forEach(e=>{if(2===e.indexOf("Native:")){const a=`on${e.charAt(9).toUpperCase()}${e.slice(10)}`;return void(y[a]=t[e])}let a,n,r=e.charAt(2).toLowerCase()+e.slice(3);0===r.indexOf("zr:")&&(a=!0,r=r.substring(3)),"Once"===r.substring(r.length-4)&&(n=!0,r=r.substring(0,r.length-4)),b.set({event:r,zr:a,once:n},t[e])});function k(){o.value&&(o.value.dispose(),o.value=void 0),_=void 0}R(()=>e.option,e=>{e?d.value||o.value&&M(o.value,e):_=void 0},{deep:!0}),R([d,m],()=>{k(),T()},{deep:!0}),R(f,e=>{o.value?.setTheme(e||{})},{deep:!0}),j(()=>{e.group&&o.value&&(o.value.group=e.group)});const C=DMt(o);return function(e,t,a){const n=Z(LMt,{}),r=S(()=>({...Y(n),...a?.value}));j(()=>{const a=e.value;a&&(t.value?a.showLoading(r.value):a.hideLoading())})}(o,h,p),function(e,t,a){R([a,e,t],([e,t,a],n,r)=>{let i=null;if(e&&t&&a){const{offsetWidth:n,offsetHeight:r}=e,{throttle:o=100,onResize:s}=!0===a?{}:a;let l=!1;const c=()=>{t.resize(),s?.()},u=o?v6e(c,o):c;i=new ResizeObserver(()=>{(l||(l=!0,e.offsetWidth!==n||e.offsetHeight!==r))&&0!==e.offsetWidth&&0!==e.offsetHeight&&u()}),i.observe(e)}r(()=>{i&&(i.disconnect(),i=null)})})}(o,u,i),n(()=>{T()}),z(()=>{ZMt&&i.value?i.value.__dispose=k:k()}),a({setOption:(t,a,n)=>{if(!e.manualUpdate)return;const r="boolean"==typeof a?{notMerge:a,lazyUpdate:n}:a;o.value&&M(o.value,t,r??void 0,!0)},root:i,chart:o,...C}),()=>G(qMt,{...g.value,...y,ref:i,class:["echarts",g.value.class]},x())}}),aTt=tTt;const nTt={class:"page-container custom-scrollbar"},rTt={class:"section-header flex-col md:flex-row md:items-center gap-6"},iTt={class:"flex items-center gap-4"},oTt={class:"section-subtitle"},sTt={key:0},lTt={key:1},cTt={key:2},uTt={class:"tab-group"},dTt={key:0,class:"grid-2 mb-6"},hTt={class:"relative","data-dropdown-assets":""},pTt={class:"flex items-center gap-3"},fTt={class:"icon-box-sm icon-blue"},mTt={class:"dropdown-value font-mono"},vTt={class:"p-3 border-b border-white/10 bg-white/5"},gTt={class:"relative"},yTt={class:"overflow-y-auto custom-scrollbar flex-1"},bTt={class:"p-2"},xTt={key:0,class:"mb-4"},wTt={class:"px-3 py-2 text-xs font-bold text-gray-500 uppercase tracking-wider mb-1"},_Tt=["onClick"],STt={class:"flex-1 min-w-0"},MTt={class:"font-medium truncate"},TTt={key:0,class:"py-8 text-center text-gray-500 text-sm"},kTt={class:"relative","data-dropdown-instruments":""},CTt={class:"flex items-center gap-3"},ATt={class:"p-2 rounded-lg bg-emerald-500/20 text-emerald-400"},ETt={class:"text-xs text-gray-400"},ITt={class:"p-2"},RTt=["onClick"],DTt={class:"flex-1"},PTt={class:"font-medium"},LTt={class:"text-xs text-gray-500"},NTt={class:"flex-1 min-h-[400px] p-6 rounded-2xl bg-black/20 border border-white/5 relative flex flex-col lg:flex-row gap-6"},OTt={key:0,class:"w-full flex flex-col"},FTt={class:"flex justify-between items-center mb-6"},BTt={class:"text-lg font-bold text-white flex items-center gap-2"},UTt={class:"text-xs font-mono text-emerald-400 bg-emerald-500/10 px-2 py-1 rounded border border-emerald-500/20"},zTt={key:0,class:"flex-1 flex flex-col gap-4"},VTt={key:0,class:"flex-1 flex items-center justify-center"},HTt={class:"text-center"},GTt={key:1,class:"flex-1 flex flex-col gap-4"},WTt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4"},qTt={class:"p-4 rounded-xl bg-white/5 border border-white/10"},YTt={class:"text-lg font-bold text-white"},jTt={class:"flex-1 min-h-[300px] bg-black/20 rounded-xl p-4"},XTt={key:1,class:"flex-1 flex flex-col gap-4"},$Tt={key:0,class:"flex-1 flex items-center justify-center"},KTt={class:"text-center"},ZTt={key:1,class:"flex-1 flex flex-col gap-4"},JTt={class:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4"},QTt={class:"p-4 rounded-xl bg-white/5 border border-white/10"},ekt={class:"text-lg font-bold text-white"},tkt={class:"flex-1 min-h-[300px] bg-black/20 rounded-xl p-4"},akt={key:2,class:"flex-1 flex flex-col gap-4"},nkt={class:"grid grid-cols-4 gap-4"},rkt={class:"p-4 rounded-xl bg-white/5 border border-white/10"},ikt={class:"p-4 rounded-xl bg-white/5 border border-white/10"},okt={class:"p-4 rounded-xl bg-white/5 border border-white/10"},skt={class:"text-lg font-bold text-cyan-400"},lkt={key:3,class:"flex-1 flex items-center justify-center"},ckt={class:"text-center"},ukt={class:"text-xl font-bold text-white mb-2"},dkt={class:"text-gray-400"},hkt={key:0,class:"text-xs text-gray-500 mt-4"},pkt={key:1,class:"mt-4 p-4 rounded-xl bg-white/5 border border-white/10 inline-block"},fkt={class:"text-lg font-bold text-white"},mkt={class:"flex justify-between items-center mb-6"},vkt={class:"text-lg font-bold text-white flex items-center gap-2"},gkt={key:0},ykt={key:1},bkt={key:2},xkt={key:0,class:"flex gap-2"},wkt={key:1,class:"text-xs font-mono text-emerald-400 bg-emerald-500/10 px-2 py-1 rounded border border-emerald-500/20"},_kt={key:0,class:"flex-1 min-h-[300px]"},Skt={key:2,class:"lg:w-1/3 bg-white/5 rounded-xl p-4 border border-white/5 flex flex-col"},Mkt={class:"text-sm font-bold text-white mb-4 flex items-center gap-2"},Tkt={class:"flex-1 min-h-[200px] relative"},kkt={class:"mt-4 space-y-2"},Ckt={class:"flex items-center gap-2"},Akt={class:"text-gray-300"},Ekt={class:"text-white font-mono"},Ikt={key:1,class:"mt-6 p-6 rounded-2xl bg-gradient-to-r from-indigo-900/40 to-purple-900/40 border border-white/10 flex items-center justify-between"},Rkt={class:"flex items-center gap-4"},Dkt={class:"p-3 bg-white/10 rounded-xl backdrop-blur-md"},Pkt=e({__name:"AnalyticsPage",props:{activeSection:{default:"AI"}},setup(e){Qet([Wnt,Irt,Sit,Qft,zwt,fwt,Agt,eSt,iMt]);const a=e,r=t(a.activeSection),o=t(!1),d=t(!1),h=t(""),g=t(null),x=t(""),_=t(null),M=t(DHe.TRENDING),I=t(1e3),D=t(0),P=t(Date.now());let L=null,N=null;const{init:F,dispose:B,setRegime:U}=BHe(),V=S(()=>{const e=Math.floor(D.value/365),t=D.value%365;return e>0?`${e}Y ${t}D`:`${t}D`}),H=(e,t)=>{let a=0;a=M.value===DHe.TRENDING?e>.2?1:e<-.2?-1:0:e>.5?.5:e<-.5?-.5:Math.random()-.5;const n=Math.abs(a)*(M.value===DHe.TRENDING?1.5:-2)+(2*Math.random()-1);I.value+=n},G=()=>{L&&(clearInterval(L),L=null),N&&(clearInterval(N),N=null),B()};R(g,(e,t)=>{"wave-sigma"===t?.id&&G(),"wave-sigma"===e?.id&&A(()=>{_.value&&(I.value=1e3,D.value=0,P.value=Date.now(),M.value=DHe.TRENDING,F(_.value,H),L=setInterval(()=>{const e=M.value===DHe.TRENDING?DHe.CHOPPY:DHe.TRENDING;M.value=e,U(e)},8e3),N=setInterval(()=>{const e=(Date.now()-P.value)/1e3;D.value=Math.floor(7*e)},100))})});const W={crypto:[{symbol:"BTC/USDT",name:"Bitcoin"},{symbol:"ETH/USDT",name:"Ethereum"},{symbol:"SOL/USDT",name:"Solana"},{symbol:"XRP/USDT",name:"Ripple"},{symbol:"BNB/USDT",name:"Binance Coin"},{symbol:"ADA/USDT",name:"Cardano"}],stocks:[{symbol:"AAPL",name:"Apple Inc."},{symbol:"TSLA",name:"Tesla Inc."},{symbol:"NVDA",name:"NVIDIA Corporation"},{symbol:"AMD",name:"Advanced Micro Devices"},{symbol:"MSFT",name:"Microsoft Corporation"},{symbol:"GOOGL",name:"Alphabet Inc."},{symbol:"AMZN",name:"Amazon.com Inc."},{symbol:"META",name:"Meta Platforms Inc."}],forex:[{symbol:"EUR/USD",name:"Euro / US Dollar"},{symbol:"GBP/USD",name:"British Pound / US Dollar"},{symbol:"USD/JPY",name:"US Dollar / Japanese Yen"},{symbol:"AUD/USD",name:"Australian Dollar / US Dollar"},{symbol:"USD/CHF",name:"US Dollar / Swiss Franc"},{symbol:"USD/CAD",name:"US Dollar / Canadian Dollar"}],commodities:[{symbol:"GOLD",name:"Gold"},{symbol:"SILVER",name:"Silver"},{symbol:"OIL",name:"Crude Oil"},{symbol:"COPPER",name:"Copper"}],indices:[{symbol:"SPX",name:"S&P 500"},{symbol:"DJI",name:"Dow Jones Industrial Average"},{symbol:"IXIC",name:"NASDAQ Composite"},{symbol:"RUT",name:"Russell 2000"}]},q={crypto:"Криптовалюты",stocks:"Акции",forex:"Валютные пары",commodities:"Сырьё",indices:"Индексы"},Y=S(()=>{const e=x.value.toLowerCase().trim();if(!e)return W;const t={crypto:[],stocks:[],forex:[],commodities:[],indices:[]};return Object.keys(W).forEach(a=>{t[a]=W[a].filter(t=>t.symbol.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}),t});S(()=>Object.values(W).flat().map(e=>e.symbol)),R(()=>a.activeSection,e=>{r.value=e});const j=[{id:"volatility-surface",label:"Поверхность волатильности",code:"VOL",description:"3D визуализация волатильности по страйкам и экспирациям",icon:"LayersIcon"},{id:"volatility-surface-greeks",label:"Поверхность волатильности (по грекам)",code:"VOLG",description:"3D визуализация волатильности по страйкам и экспирациям на основе греков",icon:"LayersIcon"},{id:"citadel-zeta-field",label:"Citadel Zeta Field",code:"CZF",description:"Анализ поля дзета-параметров Citadel",icon:"TargetIcon"},{id:"cvrc",label:"Convolutional Volatility Resolution Clustering",code:"CVRC",description:"Кластеризация волатильности с использованием сверточных нейросетей",icon:"ActivityIcon"},{id:"phase-space",label:"Phase Space Reconstruction",code:"PSR",description:"Реконструкция фазового пространства для анализа динамики",icon:"BarChart2Icon"},{id:"latent-volatility",label:"Latent Volatility model",code:"LVM",description:"Модель скрытой волатильности",icon:"LayersIcon"},{id:"momentum-volatility",label:"Momentum-Volatility Surface",code:"MVS",description:"Поверхность волатильности с учетом импульса",icon:"TrendingUpIcon"},{id:"liquidity-model",label:"Liquidity Model",code:"LIQ",description:"Модель ликвидности рынка",icon:"ActivityIcon"},{id:"hmm-regime",label:"HMM regime model visualization",code:"HMM",description:"Визуализация режимов скрытой марковской модели",icon:"PieChartIcon"},{id:"time-series-signals",label:"Time series с сигналами",code:"TSIG",description:"Линейный/бар чарт цены + наложение флагов buy/sell",icon:"ChartBarIcon"},{id:"correlation-heatmap",label:"Correlation heatmap",code:"CORR",description:"Цветная матрица корреляций",icon:"TableCellsIcon"},{id:"hmm-state-diagram",label:"HMM state diagram",code:"HMMD",description:"Граф состояний + timeline colors",icon:"ShareIcon"},{id:"zscore-residuals",label:"Z‑score residuals",code:"ZSCR",description:"Линейный график отклонений",icon:"TrendingDownIcon"},{id:"orderbook-heatmap",label:"Order book heatmap",code:"OBHM",description:"Цветная карта глубины стакана",icon:"Squares2X2Icon"},{id:"ensemble-signal",label:"Ensemble signal distribution",code:"ENSD",description:"Гистограмма/confidence bands",icon:"Bars3Icon"},{id:"feature-importance",label:"Feature importance bar chart",code:"FEAT",description:"Столбцы значимости факторов",icon:"BarChart3Icon"},{id:"drawdown-sharpe",label:"Drawdown/Sharpe timeline",code:"DDSH",description:"Накопленный график + метрики",icon:"LineChartIcon"},{id:"latency-slippage",label:"Latency/slippage scatter",code:"EXEC",description:"Точечный график execution metrics",icon:"ScatterIcon"},{id:"turnover-exposure",label:"Turnover/exposure matrix",code:"EXPO",description:"Heatmap позиций по активам",icon:"TableCellsIcon"},{id:"orderbook-3d",label:"Объёмная карта ордербука (3D Depth Map)",code:"OB3D",description:"Трёхмерная визуализация глубины стакана",icon:"LayersIcon"},{id:"time-varying-correlation",label:"Динамическая корреляционная сеть (Time‑Varying Correlation Network)",code:"TVCN",description:"Сетевая визуализация корреляций во времени",icon:"ShareIcon"},{id:"covariance-tensor",label:"Ковариационный куб (Covariance Tensor Cube)",code:"CTENSOR",description:"Трёхмерное представление ковариационной матрицы",icon:"Squares2X2Icon"},{id:"liquidity-helix",label:"Объёмно‑временная спираль ликвидности (Liquidity Helix)",code:"HELIX",description:"Спиральная визуализация ликвидности во времени",icon:"ActivityIcon"},{id:"correlation-hypercube",label:"Пространство корреляций во времени (Correlation Hypercube)",code:"HYPERCUBE",description:"Гиперкубическое представление корреляций",icon:"Squares2X2Icon"},{id:"sentiment-vortex",label:"Вихрь рыночных настроений (Sentiment Vortex)",code:"VORTEX",description:"Вихревая визуализация рыночных настроений",icon:"ActivityIcon"},{id:"options-plasma",label:"«Плазма» потока опционных сделок",code:"PLASMA",description:"Визуализация в реальном времени потока опционных сделок как заряженных частиц в магнитном поле",icon:"ActivityIcon"},{id:"auction-lattice",label:"«Кристаллическая решетка аукциона» (Auction Lattice)",code:"LATTICE",description:"3D-структура, показывающая историю и текущее состояние аукциона (открытия/закрытия на бирже, аукциона MOC)",icon:"Squares2X2Icon"},{id:"tick-core",label:"«Тактовый сердечник» процессора исполнения",code:"TICKCORE",description:"Метафора процессора, где каждый такт — это пакет рыночных данных (тик). Визуализация нагрузки и задержек в обработке",icon:"ActivityIcon"},{id:"greeks-3d-tensor",label:"3D Greeks Tensor (Delta-Gamma-Vega landscape)",code:"GREEKS3D",description:"Для портфеля опционов/структурных продуктов показывай греки как трёхмерный тензор",icon:"LayersIcon"},{id:"regime-correlation-network",label:"Regime Correlation Network (HMM‑driven)",code:"REGNET",description:"3D‑граф корреляций, где высота узлов пропорциональна posterior probability текущего режима (из HMM)",icon:"ShareIcon"},{id:"tail-risk-cube",label:"Tail Risk Cube (EVT Stress Scenarios)",code:"TAILCUBE",description:"Куб, где каждый слой — сценарий стресса (GPD fits для tails), вокселы — P&L портфеля при quantile α",icon:"Squares2X2Icon"},{id:"wave-sigma",label:"WAVE_σ.9 Quant Model",code:"WSIGMA",description:"Топология рыночного импульса с режимами TRENDING/CHOPPY и симуляцией торговли",icon:"WaveIcon"}],X=e=>{const t=e.target;t.closest("[data-dropdown-assets]")||(o.value=!1),t.closest("[data-dropdown-instruments]")||(d.value=!1)};n(()=>{document.addEventListener("click",X)}),z(()=>{document.removeEventListener("click",X),G()});const $=["#F59E0B","#6366F1","#10B981","#EC4899"],K=[{name:"BTC",value:400},{name:"ETH",value:300},{name:"USDT",value:300},{name:"SOL",value:100}],Z=S(()=>Array.from({length:20},(e,t)=>({name:t,val1:100*Math.random()+("Finance"===r.value?4e4:0),val2:100*Math.random()+50+("Finance"===r.value?4e4:0)}))),J=S(()=>{const e="Finance"===r.value?"#F59E0B":"AI"===r.value?"#6366f1":"#10b981";return{grid:{left:40,right:20,top:20,bottom:30},xAxis:{type:"category",data:Z.value.map(e=>e.name),axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)"}},yAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)"},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"line",data:Z.value.map(e=>e.val1),smooth:!0,symbol:"none",lineStyle:{color:e,width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:e.replace(")",", 0.3)").replace("rgb","rgba")},{offset:1,color:"rgba(0,0,0,0)"}]}}}],tooltip:{backgroundColor:"rgba(20,20,30,0.9)",borderColor:"rgba(255,255,255,0.1)",textStyle:{color:"#fff"}}}}),Q=S(()=>({series:[{type:"pie",radius:["50%","70%"],center:["50%","50%"],data:K.map((e,t)=>({value:e.value,name:e.name,itemStyle:{color:$[t]}})),label:{show:!1},emphasis:{scale:!0,scaleSize:5}}],tooltip:{backgroundColor:"rgba(20,20,30,0.9)",borderColor:"rgba(255,255,255,0.1)",textStyle:{color:"#fff"}}})),ee=S(()=>{const e=[80,85,90,95,100,105,110,115,120],t=["1M","3M","6M","1Y","2Y","3Y"],a=[];return e.forEach((e,n)=>{t.forEach((t,r)=>{const i=.15+.1*(Math.random()-.5)+Math.abs(e-100)/1e3;a.push([n,r,Math.max(.05,Math.min(.5,i))])})}),{tooltip:{backgroundColor:"rgba(20,20,30,0.9)",borderColor:"rgba(255,255,255,0.1)",textStyle:{color:"#fff"},formatter:a=>`Страйк: ${e[a.data[0]]}<br/>Экспирация: ${t[a.data[1]]}<br/>Волатильность: ${(100*a.data[2]).toFixed(2)}%`},grid:{height:"60%",top:"10%"},xAxis:{type:"category",data:e,splitArea:{show:!0},axisLabel:{color:"rgba(255,255,255,0.7)"},name:"Страйк",nameTextStyle:{color:"#fff"}},yAxis:{type:"category",data:t,splitArea:{show:!0},axisLabel:{color:"rgba(255,255,255,0.7)"},name:"Экспирация",nameTextStyle:{color:"#fff"}},visualMap:{min:.05,max:.5,calculable:!0,orient:"horizontal",left:"center",bottom:"5%",inRange:{color:["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffcc","#fee090","#fdae61","#f46d43","#d73027","#a50026"]},textStyle:{color:"#fff"}},series:[{name:"Волатильность",type:"heatmap",data:a,label:{show:!0,formatter:e=>(100*e.data[2]).toFixed(1)+"%",color:"#fff",fontSize:10},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}}),te={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 4.44-2.54ZM14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-4.44-2.54Z"/></svg>'},ae={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/><line x1="16" y1="14" x2="16" y2="18"/><line x1="16" y1="10" x2="16" y2="10"/><line x1="12" y1="10" x2="12" y2="10"/><line x1="8" y1="10" x2="8" y2="10"/><line x1="12" y1="14" x2="12" y2="14"/><line x1="8" y1="14" x2="8" y2="14"/><line x1="12" y1="18" x2="12" y2="18"/><line x1="8" y1="18" x2="8" y2="18"/></svg>'},ne={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>'},re={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'},ie={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>'},oe={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>'},se={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>'},le={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'},ce={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>'};return(e,t)=>(w(),i("div",nTt,[s("div",rTt,[s("div",iTt,[s("div",{class:c(`icon-box ${e.getAccentClass()}`)},[(w(),b(C("AI"===r.value?"BrainIcon":"Quant"===r.value?"TargetIcon":"WalletIcon"),{class:"w-6 h-6"}))],2),s("div",null,[t[9]||(t[9]=s("h1",{class:"section-title font-anton"},"АНАЛИТИЧЕСКИЙ ХАБ",-1)),s("p",oTt,["AI"===r.value?(w(),i("span",sTt,"ПРОДВИНУТАЯ АНАЛИТИКА РЫНКА НА ОСНОВЕ ИИ")):"Quant"===r.value?(w(),i("span",lTt,"КОЛИЧЕСТВЕННЫЕ МЕТРИКИ И МОДЕЛИРОВАНИЕ РИСКОВ")):(w(),i("span",cTt,"ПРОИЗВОДИТЕЛЬНОСТЬ ПОРТФЕЛЯ И РАСПРЕДЕЛЕНИЕ АКТИВОВ"))])])]),s("div",uTt,[s("button",{onClick:t[0]||(t[0]=e=>r.value="AI"),class:c(["tab-btn",{active:"AI"===r.value}])},[u(te,{class:"w-3.5 h-3.5"}),t[10]||(t[10]=m(" AI АНАЛИЗ ",-1))],2),s("button",{onClick:t[1]||(t[1]=e=>r.value="Quant"),class:c(["tab-btn",{active:"Quant"===r.value}])},[u(ae,{class:"w-3.5 h-3.5"}),t[11]||(t[11]=m(" КОЛИЧЕСТВЕННАЯ АНАЛИТИКА ",-1))],2),s("button",{onClick:t[2]||(t[2]=e=>r.value="Finance"),class:c(["tab-btn",{active:"Finance"===r.value}])},[u(ne,{class:"w-3.5 h-3.5"}),t[12]||(t[12]=m(" ФИНАНСОВЫЙ АНАЛИЗ ",-1))],2)])]),"Quant"===r.value?(w(),i("div",dTt,[s("div",hTt,[s("button",{onClick:t[3]||(t[3]=e=>o.value=!o.value),class:"dropdown-trigger"},[s("div",pTt,[s("div",fTt,[u(re,{class:"w-4 h-4"})]),s("div",null,[t[13]||(t[13]=s("div",{class:"dropdown-label font-oswald"},"АКТИВЫ",-1)),s("div",mTt,v(h.value||"ВЫБЕРИТЕ АКТИВ"),1)])]),u(le,{class:c(["dropdown-chevron",{open:o.value}])},null,8,["class"])]),o.value?(w(),i("div",{key:0,onClick:t[6]||(t[6]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/95 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-[500px] overflow-hidden flex flex-col"},[s("div",vTt,[s("div",gTt,[u(ce,{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),T(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>x.value=e),onClick:t[5]||(t[5]=E(()=>{},["stop"])),type:"text",placeholder:"Поиск актива...",class:"w-full pl-10 pr-3 py-2 bg-black/40 border border-white/10 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors"},null,512),[[k,x.value]])])]),s("div",yTt,[s("div",bTt,[(w(!0),i(p,null,f(Y.value,(e,t)=>(w(),i(p,{key:t},[e.length>0?(w(),i("div",xTt,[s("div",wTt,v(q[t]),1),(w(!0),i(p,null,f(e,e=>(w(),i("div",{key:e.symbol,onClick:t=>(e=>{h.value=e,o.value=!1})(e.symbol),class:c("flex items-center justify-between gap-3 px-4 py-2.5 rounded-lg text-sm transition-colors cursor-pointer "+(h.value===e.symbol?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"text-gray-300 hover:bg-white/5 hover:text-white border border-transparent"))},[s("div",STt,[s("div",MTt,v(e.name),1)]),s("span",{class:c("text-xs font-mono px-2 py-0.5 rounded "+(h.value===e.symbol?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-white/5 text-gray-500 border border-white/5"))},v(e.symbol),3)],10,_Tt))),128))])):l("",!0)],64))),128)),Object.values(Y.value).every(e=>0===e.length)?(w(),i("div",TTt," Активы не найдены ")):l("",!0)])])])):l("",!0)]),s("div",kTt,[s("button",{onClick:t[7]||(t[7]=e=>d.value=!d.value),class:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl hover:border-emerald-500/50 transition-all flex items-center justify-between text-left group"},[s("div",CTt,[s("div",ATt,[u(se,{class:"w-4 h-4"})]),s("div",null,[t[14]||(t[14]=s("div",{class:"text-sm font-bold text-white"},"Инструменты",-1)),s("div",ETt,v(g.value?.label||"Выберите инструмент"),1)])]),u(le,{class:c("w-4 h-4 text-gray-400 transition-transform "+(d.value?"rotate-180":""))},null,8,["class"])]),d.value?(w(),i("div",{key:0,onClick:t[8]||(t[8]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/95 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-96 overflow-y-auto custom-scrollbar"},[s("div",ITt,[(w(),i(p,null,f(j,e=>s("div",{key:e.id,onClick:t=>(e=>{g.value=e,d.value=!1})(e),class:c("flex items-center gap-3 px-4 py-3 rounded-lg text-sm transition-colors cursor-pointer "+(g.value?.id===e.id?"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30":"text-gray-300 hover:bg-white/5 hover:text-white border border-transparent"))},[s("div",{class:c("p-1.5 rounded-lg "+(g.value?.id===e.id?"bg-emerald-500/30":"bg-white/5"))},[(w(),b(C(e.icon),{class:c("w-4 h-4 "+(g.value?.id===e.id?"text-emerald-300":"text-gray-400"))},null,8,["class"]))],2),s("div",DTt,[s("div",PTt,v(e.label),1),s("div",LTt,v(e.description),1)]),s("span",{class:c("text-xs font-mono px-2 py-0.5 rounded "+(g.value?.id===e.id?"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30":"bg-white/5 text-gray-500 border border-white/5"))},v(e.code),3)],10,RTt)),64))])])):l("",!0)])])):l("",!0),s("div",NTt,["Quant"===r.value&&g.value?(w(),i("div",OTt,[s("div",FTt,[s("h3",BTt,[(w(),b(C(g.value.icon),{class:"w-5 h-5 text-emerald-400"})),s("span",null,v(g.value.label),1)]),s("span",UTt,v(g.value.code),1)]),"volatility-surface"===g.value.id?(w(),i("div",zTt,[h.value?(w(),i("div",GTt,[s("div",WTt,[s("div",qTt,[t[16]||(t[16]=s("div",{class:"text-xs text-gray-400 mb-2"},"Актив",-1)),s("div",YTt,v(h.value),1)]),t[17]||(t[17]=s("div",{class:"p-4 rounded-xl bg-white/5 border border-white/10"},[s("div",{class:"text-xs text-gray-400 mb-2"},"Текущая волатильность"),s("div",{class:"text-2xl font-bold text-emerald-400"},"14.2%")],-1))]),s("div",jTt,[u(O(aTt),{class:"w-full h-full",option:ee.value,autoresize:""},null,8,["option"])])])):(w(),i("div",VTt,[s("div",HTt,[u(re,{class:"w-16 h-16 text-gray-500 mx-auto mb-4 opacity-50"}),t[15]||(t[15]=s("p",{class:"text-gray-400"},"Выберите актив для анализа",-1))])]))])):"volatility-surface-greeks"===g.value.id?(w(),i("div",XTt,[h.value?(w(),i("div",ZTt,[s("div",JTt,[s("div",QTt,[t[19]||(t[19]=s("div",{class:"text-xs text-gray-400 mb-2"},"Актив",-1)),s("div",ekt,v(h.value),1)]),t[20]||(t[20]=s("div",{class:"p-4 rounded-xl bg-white/5 border border-white/10"},[s("div",{class:"text-xs text-gray-400 mb-2"},"Текущая волатильность"),s("div",{class:"text-2xl font-bold text-emerald-400"},"14.2%")],-1))]),s("div",tkt,[u(O(aTt),{class:"w-full h-full",option:ee.value,autoresize:""},null,8,["option"])])])):(w(),i("div",$Tt,[s("div",KTt,[u(re,{class:"w-16 h-16 text-gray-500 mx-auto mb-4 opacity-50"}),t[18]||(t[18]=s("p",{class:"text-gray-400"},"Выберите актив для анализа",-1))])]))])):"wave-sigma"===g.value.id?(w(),i("div",akt,[s("div",{ref_key:"waveSigmaContainer",ref:_,class:"flex-1 min-h-[400px] bg-black rounded-xl overflow-hidden relative"},null,512),s("div",nkt,[s("div",rkt,[t[21]||(t[21]=s("div",{class:"text-xs text-gray-400 mb-1"},"Режим",-1)),s("div",{class:c("text-lg font-bold "+("TRENDING"===M.value?"text-green-400":"text-red-400"))},v(M.value),3)]),s("div",ikt,[t[22]||(t[22]=s("div",{class:"text-xs text-gray-400 mb-1"},"Equity",-1)),s("div",{class:c("text-lg font-bold "+(I.value>1e3?"text-green-400":"text-red-400"))}," $"+v(I.value.toFixed(2)),3)]),t[24]||(t[24]=s("div",{class:"p-4 rounded-xl bg-white/5 border border-white/10"},[s("div",{class:"text-xs text-gray-400 mb-1"},"Sharpe"),s("div",{class:"text-lg font-bold text-white"},"2.1")],-1)),s("div",okt,[t[23]||(t[23]=s("div",{class:"text-xs text-gray-400 mb-1"},"Период",-1)),s("div",skt,v(V.value),1)])])])):(w(),i("div",lkt,[s("div",ckt,[(w(),b(C(g.value.icon),{class:"w-16 h-16 text-emerald-400 mx-auto mb-4 opacity-50"})),s("h4",ukt,v(g.value.label),1),s("p",dkt,v(g.value.description),1),h.value?(w(),i("div",pkt,[t[25]||(t[25]=s("div",{class:"text-xs text-gray-400 mb-1"},"Актив",-1)),s("div",fkt,v(h.value),1)])):(w(),i("p",hkt,"Выберите актив для анализа"))])]))])):(w(),i("div",{key:1,class:c("flex-1 flex flex-col "+("Finance"===r.value?"lg:w-2/3":"w-full"))},[s("div",mkt,[s("h3",vkt,[u(ie,{class:"w-4 h-4 text-gray-400"}),"AI"===r.value?(w(),i("span",gkt,"Модель прогнозирования тренда (Gemini-3 Pro)")):"Quant"===r.value?(w(),i("span",ykt,"Выберите инструмент количественного анализа")):(w(),i("span",bkt,"История производительности портфеля"))]),"Quant"!==r.value||g.value?l("",!0):(w(),i("div",xkt,[...t[26]||(t[26]=[s("span",{class:"text-xs text-gray-500"},"Выберите инструмент из меню выше",-1)])])),"Finance"===r.value?(w(),i("span",wkt,"+15.4% За всё время")):l("",!0)]),"Quant"===r.value&&g.value?l("",!0):(w(),i("div",_kt,[u(O(aTt),{class:"w-full h-full",option:J.value,autoresize:""},null,8,["option"])]))],2)),"Finance"===r.value?(w(),i("div",Skt,[s("h3",Mkt,[u(ne,{class:"w-3.5 h-3.5 text-gray-400"}),t[27]||(t[27]=m(" Распределение активов ",-1))]),s("div",Tkt,[u(O(aTt),{class:"w-full h-full",option:Q.value,autoresize:""},null,8,["option"])]),s("div",kkt,[(w(),i(p,null,f(K,(e,t)=>s("div",{key:e.name,class:"flex justify-between items-center text-xs"},[s("div",Ckt,[s("div",{class:"w-2 h-2 rounded-full",style:y({backgroundColor:$[t]})},null,4),s("span",Akt,v(e.name),1)]),s("span",Ekt,v((e.value/1100*100).toFixed(0))+"%",1)])),64))])])):l("",!0)]),"AI"===r.value?(w(),i("div",Ikt,[s("div",Rkt,[s("div",Dkt,[u(oe,{class:"w-6 h-6 text-white"})]),t[28]||(t[28]=s("div",null,[s("h3",{class:"font-bold text-white text-lg"},"Обнаружена следующая возможность"),s("p",{class:"text-sm text-gray-400"},"Gemini выявил дивергенцию на часовом таймфрейме BTC/USDT.")],-1))]),t[29]||(t[29]=s("button",{class:"px-6 py-2 bg-white text-black font-bold rounded-xl hover:scale-105 transition-transform shadow-lg shadow-white/10 text-sm"},"Подробнее",-1))])):l("",!0)]))}}),Lkt={class:"page-container custom-scrollbar"},Nkt={class:"section-header flex-col md:flex-row gap-4"},Okt={class:"flex items-center gap-4"},Fkt={class:"icon-box icon-blue"},Bkt={class:"tab-group"},Ukt=["onClick"],zkt={class:"flex-1 flex flex-col gap-6"},Vkt={key:0,class:"flex flex-col h-full gap-6"},Hkt={class:"p-4 rounded-2xl bg-white/5 border border-white/5 flex flex-wrap gap-4 items-center"},Gkt={class:"flex items-center gap-2 px-3 py-2 bg-black/20 rounded-xl border border-white/10"},Wkt={class:"relative","data-dropdown-sector":""},qkt=["onClick"],Ykt={class:"relative","data-dropdown-cap":""},jkt=["onClick"],Xkt={class:"relative","data-dropdown-pe":""},$kt=["onClick"],Kkt={class:"flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20"},Zkt={class:"w-full text-left border-collapse"},Jkt={class:"text-sm font-mono text-gray-300"},Qkt={class:"p-4 font-bold text-white group-hover:text-blue-400"},eCt={class:"p-4 text-xs font-sans text-gray-400"},tCt={class:"p-4 text-right"},aCt={class:"p-4 text-right text-gray-400"},nCt={class:"p-4 text-right"},rCt={class:"p-4 text-right text-xs"},iCt={class:"p-4 text-right text-xs text-gray-500"},oCt={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full"},sCt={class:"lg:col-span-1 flex flex-col gap-4"},lCt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 flex-1"},cCt={class:"flex justify-between items-center mb-4"},uCt={class:"p-1.5 rounded-lg bg-blue-500 hover:bg-blue-600 text-white transition-colors"},dCt={class:"space-y-2"},hCt={class:"flex items-center gap-3"},pCt={class:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center text-xs font-bold text-gray-300"},fCt={class:"flex flex-col"},mCt={class:"text-sm font-bold text-white"},vCt={class:"text-gray-600 hover:text-rose-400 opacity-0 group-hover:opacity-100 transition-opacity"},gCt={class:"lg:col-span-2 flex flex-col gap-6"},yCt={class:"flex-1 p-6 rounded-2xl bg-white/5 border border-white/5"},bCt={class:"grid grid-cols-5 gap-1"},xCt={class:"h-12 flex items-center justify-center font-bold text-xs text-gray-400"},wCt={key:2,class:"flex flex-col h-full"},_Ct={class:"flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20"},SCt={class:"w-full text-left"},MCt={class:"text-sm font-mono text-gray-300"},TCt={class:"p-4 text-gray-500 text-xs"},kCt={class:"p-4 font-bold text-white"},CCt={class:"p-4 text-blue-300"},ACt={class:"p-4"},ECt={class:"p-4 text-emerald-400"},ICt={class:"p-4 text-yellow-400 font-bold"},RCt={class:"p-4 text-right"},DCt={key:3,class:"flex items-center justify-center h-full"},PCt={class:"text-center"},LCt={class:"text-xl font-bold text-white mb-2"},NCt=e({__name:"ScreeningPage",props:{symbol:{},activeSection:{}},setup(e){const a=e,r=t(a.activeSection),o=t("All"),d=t("All"),h=t("All"),m=t(!1),g=t(!1),b=t(!1);R(()=>a.activeSection,e=>{r.value=e});const x=[{id:"EQS",label:"Скринер акций",icon:"FilterIcon"},{id:"WLT",label:"Аналитика списка наблюдения",icon:"ListIcon"},{id:"EQRV",label:"Относительная оценка",icon:"PieChartIcon"},{id:"MA",label:"Отслеживание M&A",icon:"GitMergeIcon"}],_=S(()=>{const e=new Set(B.map(e=>e.sec));return Array.from(e).sort()}),M=["Mega","Large","Mid","Small","Micro"],T=["Under15","Under25","Under50","All"],k=e=>{o.value=e,m.value=!1},C=e=>{d.value=e,g.value=!1},A=e=>{h.value=e,b.value=!1},D=e=>({Technology:"Технологии",Tech:"Технологии",Healthcare:"Здравоохранение",Finance:"Финансы",Energy:"Энергетика",Consumer:"Потребительские товары",Industrial:"Промышленность",Telecommunications:"Телекоммуникации",Materials:"Материалы","Oil & Gas":"Нефть и газ",Banking:"Банковский сектор",Retail:"Розничная торговля",Automotive:"Автомобильная промышленность","Real Estate":"Недвижимость",Utilities:"Коммунальные услуги"}[e]||e),P=e=>({Mega:"Мега (>100B)",Large:"Крупные (10B-100B)",Mid:"Средние (1B-10B)",Small:"Малые (100M-1B)",Micro:"Микро (<100M)"}[e]||e),L=e=>({Under15:"P/E < 15",Under25:"P/E < 25",Under50:"P/E < 50",All:"Все"}[e]||e),N=e=>({Completed:"Завершено",Closing:"Закрытие",Pending:"Ожидание","Regulator Review":"Проверка регулятора"}[e]||e),O=e=>{const t=x.find(t=>t.id===e);return t?t.label:e};let F=null;n(()=>{F=e=>{const t=e.target;t.closest("[data-dropdown-sector]")||t.closest("[data-dropdown-cap]")||t.closest("[data-dropdown-pe]")||(m.value=!1,g.value=!1,b.value=!1)},document.addEventListener("click",F)}),z(()=>{F&&document.removeEventListener("click",F)});const B=[{s:"NVDA",n:"NVIDIA Corp",p:892.1,c:"+4.2%",pe:75.2,mc:"2.2T",v:"High",sec:"Technology"},{s:"AMD",n:"Advanced Micro",p:178.2,c:"+2.1%",pe:42.1,mc:"280B",v:"High",sec:"Technology"},{s:"TSM",n:"Taiwan Semi",p:142.5,c:"-0.5%",pe:24.5,mc:"750B",v:"Med",sec:"Technology"},{s:"AVGO",n:"Broadcom Inc",p:1350,c:"+1.8%",pe:35.8,mc:"620B",v:"Med",sec:"Technology"},{s:"INTC",n:"Intel Corp",p:42.1,c:"-1.2%",pe:85.2,mc:"180B",v:"Med",sec:"Technology"},{s:"QCOM",n:"Qualcomm",p:168.4,c:"+0.9%",pe:18.2,mc:"190B",v:"Low",sec:"Technology"},{s:"MU",n:"Micron Tech",p:124.3,c:"+3.5%",pe:-12.4,mc:"135B",v:"High",sec:"Technology"},{s:"AAPL",n:"Apple Inc",p:173.5,c:"+1.2%",pe:28.5,mc:"2.7T",v:"Med",sec:"Technology"},{s:"MSFT",n:"Microsoft",p:420.55,c:"-0.45%",pe:32.8,mc:"3.1T",v:"Med",sec:"Technology"},{s:"GOOGL",n:"Alphabet",p:156.4,c:"-0.20%",pe:24.2,mc:"1.9T",v:"Med",sec:"Technology"},{s:"META",n:"Meta Platforms",p:495.1,c:"+1.85%",pe:22.5,mc:"1.2T",v:"High",sec:"Technology"},{s:"AMZN",n:"Amazon",p:180.25,c:"+0.95%",pe:48.3,mc:"1.8T",v:"Med",sec:"Technology"},{s:"ORCL",n:"Oracle",p:118.25,c:"+0.75%",pe:19.8,mc:"320B",v:"Low",sec:"Technology"},{s:"ADBE",n:"Adobe",p:545.8,c:"+1.85%",pe:45.2,mc:"248B",v:"Med",sec:"Technology"},{s:"CRM",n:"Salesforce",p:285.4,c:"+1.25%",pe:52.1,mc:"280B",v:"Med",sec:"Technology"},{s:"NOW",n:"ServiceNow",p:785.2,c:"+2.15%",pe:68.5,mc:"155B",v:"High",sec:"Technology"},{s:"ASML",n:"ASML Holding",p:945.6,c:"+2.85%",pe:38.2,mc:"375B",v:"High",sec:"Technology"},{s:"JNJ",n:"Johnson & Johnson",p:158.4,c:"+0.30%",pe:22.8,mc:"420B",v:"Low",sec:"Healthcare"},{s:"UNH",n:"UnitedHealth",p:525.4,c:"+1.20%",pe:26.5,mc:"495B",v:"Med",sec:"Healthcare"},{s:"LLY",n:"Eli Lilly",p:765.2,c:"+2.45%",pe:58.2,mc:"728B",v:"High",sec:"Healthcare"},{s:"ABBV",n:"AbbVie",p:168.9,c:"+0.40%",pe:14.2,mc:"298B",v:"Low",sec:"Healthcare"},{s:"MRK",n:"Merck",p:128.6,c:"+0.55%",pe:18.5,mc:"326B",v:"Low",sec:"Healthcare"},{s:"PFE",n:"Pfizer",p:27.8,c:"-0.50%",pe:12.8,mc:"158B",v:"Low",sec:"Healthcare"},{s:"TMO",n:"Thermo Fisher",p:585.4,c:"+1.15%",pe:32.5,mc:"225B",v:"Med",sec:"Healthcare"},{s:"ABT",n:"Abbott Labs",p:112.5,c:"+0.65%",pe:28.2,mc:"195B",v:"Low",sec:"Healthcare"},{s:"DHR",n:"Danaher",p:265.8,c:"+0.85%",pe:35.8,mc:"195B",v:"Med",sec:"Healthcare"},{s:"BMY",n:"Bristol-Myers",p:52.4,c:"+0.25%",pe:12.5,mc:"108B",v:"Low",sec:"Healthcare"},{s:"AMGN",n:"Amgen",p:285.6,c:"+0.95%",pe:19.2,mc:"152B",v:"Low",sec:"Healthcare"},{s:"GILD",n:"Gilead Sciences",p:78.2,c:"+0.35%",pe:15.8,mc:"98B",v:"Low",sec:"Healthcare"},{s:"REGN",n:"Regeneron",p:985.4,c:"+1.85%",pe:24.5,mc:"108B",v:"High",sec:"Healthcare"},{s:"VRTX",n:"Vertex Pharma",p:425.8,c:"+2.15%",pe:28.5,mc:"110B",v:"High",sec:"Healthcare"},{s:"JPM",n:"JPMorgan Chase",p:185.4,c:"+0.55%",pe:12.5,mc:"540B",v:"Med",sec:"Finance"},{s:"BAC",n:"Bank of America",p:38.5,c:"+0.40%",pe:11.8,mc:"305B",v:"Med",sec:"Banking"},{s:"WFC",n:"Wells Fargo",p:58.2,c:"+0.30%",pe:12.2,mc:"215B",v:"Low",sec:"Banking"},{s:"GS",n:"Goldman Sachs",p:425.8,c:"+0.85%",pe:15.2,mc:"145B",v:"Med",sec:"Finance"},{s:"MS",n:"Morgan Stanley",p:95.6,c:"+0.65%",pe:14.8,mc:"175B",v:"Med",sec:"Finance"},{s:"C",n:"Citigroup",p:62.4,c:"+0.25%",pe:8.5,mc:"120B",v:"Low",sec:"Banking"},{s:"BLK",n:"BlackRock",p:825.4,c:"+1.15%",pe:22.5,mc:"125B",v:"Med",sec:"Finance"},{s:"SCHW",n:"Charles Schwab",p:68.2,c:"+0.45%",pe:18.2,mc:"125B",v:"Med",sec:"Finance"},{s:"AXP",n:"American Express",p:225.6,c:"+0.75%",pe:19.5,mc:"165B",v:"Med",sec:"Finance"},{s:"COF",n:"Capital One",p:145.8,c:"+0.55%",pe:10.2,mc:"55B",v:"Med",sec:"Banking"},{s:"XOM",n:"Exxon Mobil",p:118.5,c:"+0.85%",pe:13.2,mc:"495B",v:"Med",sec:"Oil & Gas"},{s:"CVX",n:"Chevron",p:162.4,c:"+0.75%",pe:14.5,mc:"305B",v:"Med",sec:"Oil & Gas"},{s:"COP",n:"ConocoPhillips",p:115.8,c:"+1.05%",pe:12.8,mc:"138B",v:"Med",sec:"Oil & Gas"},{s:"SLB",n:"Schlumberger",p:52.4,c:"+1.25%",pe:18.5,mc:"75B",v:"Med",sec:"Oil & Gas"},{s:"EOG",n:"EOG Resources",p:128.6,c:"+1.45%",pe:11.2,mc:"75B",v:"Med",sec:"Oil & Gas"},{s:"MPC",n:"Marathon Petroleum",p:185.4,c:"+0.95%",pe:8.5,mc:"65B",v:"Med",sec:"Oil & Gas"},{s:"VLO",n:"Valero Energy",p:145.2,c:"+0.65%",pe:7.8,mc:"58B",v:"Med",sec:"Oil & Gas"},{s:"PSX",n:"Phillips 66",p:152.8,c:"+0.85%",pe:9.2,mc:"68B",v:"Med",sec:"Oil & Gas"},{s:"WMT",n:"Walmart",p:165.3,c:"+0.45%",pe:26.5,mc:"445B",v:"Low",sec:"Consumer"},{s:"PG",n:"Procter & Gamble",p:168.9,c:"+0.35%",pe:24.8,mc:"400B",v:"Low",sec:"Consumer"},{s:"KO",n:"Coca-Cola",p:62.8,c:"+0.20%",pe:25.2,mc:"270B",v:"Low",sec:"Consumer"},{s:"PEP",n:"PepsiCo",p:172.5,c:"+0.40%",pe:28.5,mc:"238B",v:"Low",sec:"Consumer"},{s:"NKE",n:"Nike",p:98.4,c:"+1.15%",pe:32.5,mc:"151B",v:"Med",sec:"Consumer"},{s:"MCD",n:"McDonald's",p:295.6,c:"+0.50%",pe:28.2,mc:"215B",v:"Low",sec:"Consumer"},{s:"SBUX",n:"Starbucks",p:95.8,c:"+0.85%",pe:25.8,mc:"110B",v:"Med",sec:"Consumer"},{s:"TGT",n:"Target",p:145.2,c:"+0.65%",pe:18.5,mc:"68B",v:"Med",sec:"Retail"},{s:"HD",n:"Home Depot",p:385.4,c:"+0.75%",pe:22.5,mc:"395B",v:"Med",sec:"Retail"},{s:"LOW",n:"Lowe's",p:225.6,c:"+0.55%",pe:19.8,mc:"135B",v:"Med",sec:"Retail"},{s:"COST",n:"Costco",p:825.4,c:"+1.25%",pe:42.5,mc:"365B",v:"Med",sec:"Retail"},{s:"TJX",n:"TJX Companies",p:95.2,c:"+0.45%",pe:24.2,mc:"108B",v:"Med",sec:"Retail"},{s:"BA",n:"Boeing",p:185.4,c:"+1.85%",pe:-45.2,mc:"115B",v:"High",sec:"Industrial"},{s:"CAT",n:"Caterpillar",p:348.6,c:"+1.45%",pe:15.8,mc:"175B",v:"Med",sec:"Industrial"},{s:"GE",n:"General Electric",p:148.2,c:"+1.15%",pe:28.5,mc:"162B",v:"Med",sec:"Industrial"},{s:"HON",n:"Honeywell",p:225.4,c:"+0.85%",pe:25.2,mc:"152B",v:"Med",sec:"Industrial"},{s:"RTX",n:"Raytheon",p:95.6,c:"+0.65%",pe:18.5,mc:"135B",v:"Med",sec:"Industrial"},{s:"LMT",n:"Lockheed Martin",p:485.2,c:"+0.95%",pe:19.2,mc:"125B",v:"Med",sec:"Industrial"},{s:"DE",n:"Deere & Co",p:425.8,c:"+1.25%",pe:12.5,mc:"125B",v:"Med",sec:"Industrial"},{s:"EMR",n:"Emerson Electric",p:105.4,c:"+0.45%",pe:22.8,mc:"58B",v:"Low",sec:"Industrial"},{s:"T",n:"AT&T",p:17.4,c:"+0.15%",pe:8.5,mc:"124B",v:"Low",sec:"Telecommunications"},{s:"VZ",n:"Verizon",p:40.8,c:"+0.10%",pe:9.2,mc:"172B",v:"Low",sec:"Telecommunications"},{s:"TMUS",n:"T-Mobile",p:165.4,c:"+0.65%",pe:22.5,mc:"195B",v:"Med",sec:"Telecommunications"},{s:"CMCSA",n:"Comcast",p:45.2,c:"+0.35%",pe:12.8,mc:"185B",v:"Low",sec:"Telecommunications"},{s:"LIN",n:"Linde",p:425.6,c:"+0.75%",pe:32.5,mc:"205B",v:"Med",sec:"Materials"},{s:"APD",n:"Air Products",p:285.4,c:"+0.55%",pe:28.2,mc:"65B",v:"Med",sec:"Materials"},{s:"ECL",n:"Ecolab",p:225.8,c:"+0.45%",pe:42.5,mc:"62B",v:"Med",sec:"Materials"},{s:"SHW",n:"Sherwin-Williams",p:285.6,c:"+0.65%",pe:28.8,mc:"75B",v:"Med",sec:"Materials"},{s:"FCX",n:"Freeport-McMoRan",p:42.5,c:"+1.25%",pe:18.5,mc:"58B",v:"Med",sec:"Materials"},{s:"NEM",n:"Newmont",p:38.2,c:"+0.85%",pe:22.2,mc:"48B",v:"Med",sec:"Materials"},{s:"TSLA",n:"Tesla",p:175.3,c:"+2.10%",pe:58.5,mc:"550B",v:"High",sec:"Automotive"},{s:"F",n:"Ford",p:12.5,c:"+0.25%",pe:8.2,mc:"48B",v:"Med",sec:"Automotive"},{s:"GM",n:"General Motors",p:38.4,c:"+0.35%",pe:5.8,mc:"52B",v:"Med",sec:"Automotive"},{s:"STLA",n:"Stellantis",p:22.6,c:"+0.15%",pe:3.2,mc:"68B",v:"Med",sec:"Automotive"}],U=["BTC","ETH","NVDA","GOLD"],V=[[1,.85,.42,-.1],[.85,1,.38,-.15],[.42,.38,1,.65],[-.1,-.15,.65,1]],H=[{date:"Oct 24",acquirer:"Chevron",target:"Hess Corp",val:"$53B",prem:"+10.2%",spread:"1.4%",status:"Pending"},{date:"Oct 12",acquirer:"Exxon",target:"Pioneer",val:"$59B",prem:"+18.0%",spread:"0.8%",status:"Closing"},{date:"Sep 28",acquirer:"Cisco",target:"Splunk",val:"$28B",prem:"+31.0%",spread:"2.1%",status:"Regulator Review"},{date:"Sep 15",acquirer:"Broadcom",target:"VMware",val:"$61B",prem:"+44.0%",spread:"0.2%",status:"Completed"}],G={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>'},W={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>'},q={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>'},Y={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>'},j={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'};return(e,t)=>(w(),i("div",Lkt,[s("div",Nkt,[s("div",Okt,[s("div",Fkt,[u(G,{class:"w-6 h-6"})]),t[9]||(t[9]=s("div",null,[s("h2",{class:"section-title font-anton"},"СКРИНИНГ РЫНКА"),s("p",{class:"section-subtitle font-mono"},"ОБНАРУЖЕНИЕ, АНАЛИЗ И ОТСЛЕЖИВАНИЕ ВОЗМОЖНОСТЕЙ")],-1))]),s("div",Bkt,[(w(),i(p,null,f(x,e=>s("button",{key:e.id,onClick:t=>r.value=e.id,class:c(["tab-btn",{active:r.value===e.id}])},v(e.label),11,Ukt)),64))])]),s("div",zkt,["EQS"===r.value?(w(),i("div",Vkt,[s("div",Hkt,[s("div",Gkt,[u(W,{class:"w-3.5 h-3.5 text-gray-400"}),t[10]||(t[10]=s("span",{class:"text-xs font-bold text-white"},"Фильтры:",-1))]),s("div",Wkt,[s("button",{onClick:t[0]||(t[0]=e=>m.value=!m.value),class:"px-4 py-2 bg-black/20 text-xs text-white border border-white/10 rounded-lg hover:border-blue-500/50 transition-all flex items-center justify-between gap-3 min-w-[180px]"},[s("span",null,v("All"===o.value?"Все сектора":D(o.value)),1),u(j,{class:c("w-3.5 h-3.5 transition-transform "+(m.value?"rotate-180":""))},null,8,["class"])]),m.value?(w(),i("div",{key:0,onClick:t[2]||(t[2]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:t[1]||(t[1]=e=>k("All")),class:c("w-full px-4 py-3 text-left text-xs transition-colors "+("All"===o.value?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все сектора ",2),(w(!0),i(p,null,f(_.value,e=>(w(),i("button",{key:e,onClick:t=>k(e),class:c("w-full px-4 py-3 text-left text-xs transition-colors "+(o.value===e?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(D(e)),11,qkt))),128))])):l("",!0)]),s("div",Ykt,[s("button",{onClick:t[3]||(t[3]=e=>g.value=!g.value),class:"px-4 py-2 bg-black/20 text-xs text-white border border-white/10 rounded-lg hover:border-blue-500/50 transition-all flex items-center justify-between gap-3 min-w-[180px]"},[s("span",null,v("All"===d.value?"Все":P(d.value)),1),u(j,{class:c("w-3.5 h-3.5 transition-transform "+(g.value?"rotate-180":""))},null,8,["class"])]),g.value?(w(),i("div",{key:0,onClick:t[5]||(t[5]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:t[4]||(t[4]=e=>C("All")),class:c("w-full px-4 py-3 text-left text-xs transition-colors "+("All"===d.value?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все ",2),(w(),i(p,null,f(M,e=>s("button",{key:e,onClick:t=>C(e),class:c("w-full px-4 py-3 text-left text-xs transition-colors "+(d.value===e?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(P(e)),11,jkt)),64))])):l("",!0)]),s("div",Xkt,[s("button",{onClick:t[6]||(t[6]=e=>b.value=!b.value),class:"px-4 py-2 bg-black/20 text-xs text-white border border-white/10 rounded-lg hover:border-blue-500/50 transition-all flex items-center justify-between gap-3 min-w-[180px]"},[s("span",null,v("All"===h.value?"Все":L(h.value)),1),u(j,{class:c("w-3.5 h-3.5 transition-transform "+(b.value?"rotate-180":""))},null,8,["class"])]),b.value?(w(),i("div",{key:0,onClick:t[8]||(t[8]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-full bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-64 overflow-y-auto custom-scrollbar"},[s("button",{onClick:t[7]||(t[7]=e=>A("All")),class:c("w-full px-4 py-3 text-left text-xs transition-colors "+("All"===h.value?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-white/5 hover:text-white"))}," Все ",2),(w(),i(p,null,f(T,e=>s("button",{key:e,onClick:t=>A(e),class:c("w-full px-4 py-3 text-left text-xs transition-colors "+(h.value===e?"bg-blue-500/20 text-blue-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},v(L(e)),11,$kt)),64))])):l("",!0)]),t[11]||(t[11]=s("div",{class:"ml-auto flex gap-2"},[s("button",{class:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold rounded-lg transition-colors shadow-lg shadow-blue-500/20"}," Запустить скрининг "),s("button",{class:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white text-xs font-bold rounded-lg transition-colors"}," Сохранить шаблон ")],-1))]),s("div",Kkt,[s("table",Zkt,[t[12]||(t[12]=s("thead",null,[s("tr",{class:"text-xs text-gray-400 uppercase bg-white/5 sticky top-0 backdrop-blur-md z-10"},[s("th",{class:"p-4 font-bold"},"Тикер"),s("th",{class:"p-4 font-bold"},"Компания"),s("th",{class:"p-4 font-bold text-right"},"Цена"),s("th",{class:"p-4 font-bold text-right"},"Изменение"),s("th",{class:"p-4 font-bold text-right"},"P/E"),s("th",{class:"p-4 font-bold text-right"},"Капитализация"),s("th",{class:"p-4 font-bold text-right"},"Волатильность (30д)"),s("th",{class:"p-4 font-bold text-right"},"Сектор")])],-1)),s("tbody",Jkt,[(w(),i(p,null,f(B,(e,t)=>s("tr",{key:t,class:"border-b border-white/5 hover:bg-white/5 transition-colors group cursor-pointer"},[s("td",Qkt,v(e.s),1),s("td",eCt,v(e.n),1),s("td",tCt,"$"+v(e.p.toFixed(2)),1),s("td",{class:c("p-4 text-right font-bold "+(e.c.startsWith("+")?"text-emerald-400":"text-rose-400"))},v(e.c),3),s("td",aCt,v(e.pe),1),s("td",nCt,v(e.mc),1),s("td",rCt,[s("span",{class:c("px-2 py-0.5 rounded "+("High"===e.v?"bg-indigo-500/20 text-indigo-300":"Med"===e.v?"bg-yellow-500/20 text-yellow-300":"bg-gray-700/30 text-gray-400"))},v("High"===e.v?"Высокая":"Med"===e.v?"Средняя":"Низкая"),3)]),s("td",iCt,v(D(e.sec)),1)])),64))])])])])):"WLT"===r.value?(w(),i("div",oCt,[s("div",sCt,[s("div",lCt,[s("div",cCt,[t[13]||(t[13]=s("h3",{class:"text-lg font-bold text-white"},"Портфель A",-1)),s("button",uCt,[u(q,{class:"w-4 h-4"})])]),s("div",dCt,[(w(),i(p,null,f(U,e=>s("div",{key:e,class:"flex justify-between items-center p-3 rounded-xl bg-black/20 hover:bg-white/5 group border border-transparent hover:border-white/10 cursor-pointer"},[s("div",hCt,[s("div",pCt,v(e),1),s("div",fCt,[s("span",mCt,v(e),1),t[14]||(t[14]=s("span",{class:"text-[10px] text-gray-500"},"25% Вес",-1))])]),s("button",vCt,[u(Y,{class:"w-3.5 h-3.5"})])])),64))])])]),s("div",gCt,[t[17]||(t[17]=I('<div class="grid grid-cols-3 gap-4"><div class="p-4 rounded-xl bg-emerald-900/10 border border-emerald-500/20 text-center"><div class="text-xs text-emerald-500/70 font-bold uppercase mb-1">Общая доходность (YTD)</div><div class="text-2xl font-bold text-emerald-400">+24.5%</div></div><div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center"><div class="text-xs text-gray-500 font-bold uppercase mb-1">Бета</div><div class="text-2xl font-bold text-white">1.25</div></div><div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center"><div class="text-xs text-gray-500 font-bold uppercase mb-1">Коэффициент Шарпа</div><div class="text-2xl font-bold text-white">1.8</div></div></div>',1)),s("div",yCt,[t[16]||(t[16]=s("h3",{class:"text-sm font-bold text-gray-400 uppercase mb-6"},"Корреляционная матрица",-1)),s("div",bCt,[t[15]||(t[15]=s("div",{class:"h-10"},null,-1)),(w(),i(p,null,f(U,e=>s("div",{key:e,class:"h-10 flex items-center justify-center font-bold text-xs text-gray-400"},v(e),1)),64)),(w(),i(p,null,f(V,(e,t)=>(w(),i(p,{key:t},[s("div",xCt,v(U[t]),1),(w(!0),i(p,null,f(e,(e,a)=>(w(),i("div",{key:`${t}-${a}`,class:"h-12 flex items-center justify-center rounded-lg text-xs font-bold transition-all hover:scale-105 cursor-default",style:y({backgroundColor:e>0?`rgba(16, 185, 129, ${e})`:`rgba(244, 63, 94, ${Math.abs(e)})`,color:Math.abs(e)>.5?"white":"rgba(255,255,255,0.7)"})},v(e.toFixed(2)),5))),128))],64))),64))])])])])):"MA"===r.value?(w(),i("div",wCt,[t[19]||(t[19]=I('<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"><div class="p-6 rounded-2xl bg-gradient-to-br from-indigo-600/20 to-indigo-900/20 border border-indigo-500/20"><h3 class="text-indigo-300 font-bold text-sm uppercase mb-1">Объём активных сделок</h3><div class="text-3xl font-bold text-white">$142B</div><div class="text-xs text-gray-400 mt-1">Q4 2025 (В процессе)</div></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-gray-400 font-bold text-sm uppercase mb-1">Средний арбитражный спред</h3><div class="text-3xl font-bold text-white">3.2%</div><div class="text-xs text-gray-400 mt-1">Годовая доходность</div></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-gray-400 font-bold text-sm uppercase mb-1">Регуляторный риск</h3><div class="text-3xl font-bold text-rose-400">Высокий</div><div class="text-xs text-gray-400 mt-1">Проверка FTC</div></div></div>',1)),s("div",_Ct,[s("table",SCt,[t[18]||(t[18]=s("thead",null,[s("tr",{class:"text-xs text-gray-400 uppercase bg-white/5"},[s("th",{class:"p-4"},"Дата"),s("th",{class:"p-4"},"Покупатель"),s("th",{class:"p-4"},"Цель"),s("th",{class:"p-4"},"Стоимость сделки"),s("th",{class:"p-4"},"Премия"),s("th",{class:"p-4"},"Арб. спред"),s("th",{class:"p-4 text-right"},"Статус")])],-1)),s("tbody",MCt,[(w(),i(p,null,f(H,(e,t)=>{return s("tr",{key:t,class:"border-b border-white/5 hover:bg-white/5"},[s("td",TCt,v(e.date),1),s("td",kCt,v(e.acquirer),1),s("td",CCt,v(e.target),1),s("td",ACt,v(e.val),1),s("td",ECt,v(e.prem),1),s("td",ICt,v(e.spread),1),s("td",RCt,[s("span",{class:c("px-2 py-1 rounded-lg text-xs font-bold border "+(a=e.status,"Completed"===a?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400":"Closing"===a?"bg-blue-500/10 border-blue-500/20 text-blue-400":"bg-gray-700/30 border-gray-600/30 text-gray-400"))},v(N(e.status)),3)])]);var a}),64))])])])])):(w(),i("div",DCt,[s("div",PCt,[s("h3",LCt,v(O(r.value)),1),t[20]||(t[20]=s("p",{class:"text-gray-400"},"Содержимое появится в ближайшее время",-1))])]))])]))}}),OCt={class:"page-container custom-scrollbar"},FCt={class:"flex flex-col md:flex-row items-center justify-between p-6 border-b border-white/5 bg-black/20 gap-4"},BCt={class:"flex items-center gap-4 self-start md:self-auto"},UCt=["src"],zCt={key:1},VCt={class:"relative group","data-dropdown-asset":""},HCt={class:"flex items-center gap-3 mb-1"},GCt={class:"text-2xl font-bold text-white tracking-tight group-hover:text-indigo-300 transition-colors"},WCt={class:"p-1 rounded-lg bg-white/5 group-hover:bg-indigo-500/20 transition-colors"},qCt={class:"flex items-center gap-4 text-xs text-gray-400"},YCt={class:"font-mono text-white"},jCt={class:"p-3 border-b border-white/5"},XCt={class:"overflow-y-auto custom-scrollbar max-h-64"},$Ct=["onClick"],KCt=["src","onError"],ZCt={key:1},JCt={class:"flex-1"},QCt={class:"font-bold"},eAt={class:"text-xs text-gray-500"},tAt={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},aAt={class:"flex bg-black/40 rounded-xl p-1 border border-white/5 overflow-x-auto max-w-full custom-scrollbar self-stretch md:self-auto"},nAt=["onClick"],rAt={class:"flex-1 overflow-y-auto custom-scrollbar p-6 bg-gradient-to-b from-black/10 to-transparent"},iAt={key:0,class:"space-y-6"},oAt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},sAt={class:"p-6 rounded-2xl bg-white/5 border border-white/5"},lAt={class:"h-64"},cAt={class:"p-6 rounded-2xl bg-white/5 border border-white/5"},uAt={class:"h-64"},dAt={key:1,class:"p-6 rounded-2xl bg-white/5 border border-white/5"},hAt={class:"w-full text-left"},pAt={class:"text-sm"},fAt={class:"py-4 px-4 font-bold text-white"},mAt={class:"py-4 px-4 text-gray-400"},vAt={class:"py-4 px-4 text-white"},gAt={class:"py-4 px-4 text-right"},yAt={key:2,class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},bAt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center justify-center"},xAt={class:"flex gap-1 mb-6"},wAt={class:"h-64 w-full"},_At={class:"p-6 rounded-2xl bg-white/5 border border-white/5"},SAt={class:"space-y-6"},MAt={class:"text-gray-400 font-medium"},TAt={class:"flex gap-4 items-center"},kAt={class:"text-white font-mono font-bold"},CAt={key:3,class:"p-6 rounded-2xl bg-white/5 border border-white/5"},AAt={class:"w-full text-left"},EAt={class:"text-sm font-mono"},IAt={class:"py-4 px-4 text-gray-300"},RAt={class:"py-4 px-4 text-gray-300"},DAt={class:"py-4 px-4 text-gray-300"},PAt={class:"py-4 px-4 text-emerald-400 font-bold"},LAt={key:4,class:"grid grid-cols-1 md:grid-cols-3 gap-6"},NAt={key:5,class:"flex items-center justify-center h-full"},OAt={class:"text-center"},FAt={class:"text-xl font-bold text-white mb-2"},BAt=e({__name:"FundamentalAnalysisPage",props:{symbol:{},activeSection:{}},setup(e){Qet([Wnt,ait,Sit,zwt,fwt,Agt,eSt]);const a=e,r=t(a.activeSection),o=t(a.symbol),d=t(!1),h=t(""),m=t(null);R(()=>a.activeSection,e=>{r.value=e}),R(()=>a.symbol,e=>{o.value=e,M()});const g=[{id:"EE",label:"Прогнозы",icon:"TrendingUpIcon"},{id:"ERN",label:"Прибыли",icon:"DollarSignIcon"},{id:"ANR",label:"Рекомендации",icon:"UsersIcon"},{id:"INT",label:"Аналитика",icon:"FileTextIcon"},{id:"RV",label:"Оценка",icon:"ScaleIcon"},{id:"DVD",label:"Дивиденды",icon:"CalendarIcon"},{id:"CAST",label:"Структура капитала",icon:"LayersIcon"}],y=[{name:"Bitcoin",symbol:"BTC/USDT",price:"64,230.50",change:"+2.45%",cap:"1.2T",vol:"35B",category:"Crypto"},{name:"Ethereum",symbol:"ETH/USDT",price:"3,450.20",change:"-1.12%",cap:"400B",vol:"15B",category:"Crypto"},{name:"Solana",symbol:"SOL/USDT",price:"148.50",change:"+5.67%",cap:"65B",vol:"4B",category:"Crypto"},{name:"Apple Inc.",symbol:"AAPL",price:"173.50",change:"+1.20%",category:"Equities",vol:"55M",cap:"2.7T"},{name:"NVIDIA Corp",symbol:"NVDA",price:"892.10",change:"+4.25%",category:"Equities",vol:"42M",cap:"2.2T"},{name:"Microsoft",symbol:"MSFT",price:"420.55",change:"-0.45%",category:"Equities",vol:"22M",cap:"3.1T"},{name:"Tesla Inc",symbol:"TSLA",price:"175.30",change:"+2.10%",category:"Equities",vol:"95M",cap:"550B"},{name:"Amazon",symbol:"AMZN",price:"180.25",change:"+0.95%",category:"Equities",vol:"38M",cap:"1.8T"},{name:"Meta Platforms",symbol:"META",price:"495.10",change:"+1.85%",category:"Equities",vol:"18M",cap:"1.2T"},{name:"Google",symbol:"GOOGL",price:"156.40",change:"-0.20%",category:"Equities",vol:"24M",cap:"1.9T"},{name:"AMD",symbol:"AMD",price:"142.50",change:"+3.15%",category:"Equities",vol:"65M",cap:"230B"},{name:"Netflix",symbol:"NFLX",price:"485.20",change:"+2.30%",category:"Equities",vol:"8M",cap:"215B"},{name:"JPMorgan Chase",symbol:"JPM",price:"185.40",change:"+0.55%",category:"Equities",vol:"15M",cap:"540B"},{name:"Bank of America",symbol:"BAC",price:"38.50",change:"+0.40%",category:"Equities",vol:"45M",cap:"305B"},{name:"Walmart",symbol:"WMT",price:"165.30",change:"+0.45%",category:"Equities",vol:"8M",cap:"445B"},{name:"Johnson & Johnson",symbol:"JNJ",price:"158.40",change:"+0.30%",category:"Equities",vol:"9M",cap:"420B"},{name:"Exxon Mobil",symbol:"XOM",price:"118.50",change:"+0.85%",category:"Equities",vol:"22M",cap:"495B"},{name:"Boeing",symbol:"BA",price:"185.40",change:"+1.85%",category:"Equities",vol:"8M",cap:"115B"},{name:"Сбербанк",symbol:"SBER",price:"285.40",change:"+1.85%",category:"Equities",vol:"125M",cap:"6.5T"},{name:"Газпром",symbol:"GAZP",price:"168.50",change:"+0.95%",category:"Equities",vol:"85M",cap:"4.2T"},{name:"Лукойл",symbol:"LKOH",price:"7850.60",change:"+1.25%",category:"Equities",vol:"1.2M",cap:"8.1T"},{name:"Яндекс",symbol:"YNDX",price:"2840.50",change:"+1.45%",category:"Equities",vol:"2.5M",cap:"1.1T"}],b=S(()=>{if(!h.value)return y;const e=h.value.toLowerCase();return y.filter(t=>t.symbol.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}),x=S(()=>m.value?.price||"0.00"),_=S(()=>m.value?.change||"+0.00%"),M=()=>{m.value=y.find(e=>e.symbol===o.value)||null},C=e=>{const t={Crypto:"bg-gradient-to-br from-yellow-500/20 to-orange-500/20 text-yellow-300 border border-yellow-500/30",Equities:"bg-gradient-to-br from-indigo-500/20 to-purple-500/20 text-indigo-300 border border-indigo-500/30",FX:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 text-blue-300 border border-blue-500/30"};return t[e||"Equities"]||t.Equities},A=e=>{const t=g.find(t=>t.id===e);return t?t.label:e},D=t(new Set),P=e=>{D.value.add(e)};let L=null;n(()=>{M(),y.forEach(e=>{if("Equities"===e.category&&!D.value.has(e.symbol)){const t={AAPL:"apple.com",MSFT:"microsoft.com",GOOGL:"google.com",AMZN:"amazon.com",META:"meta.com",NVDA:"nvidia.com",TSLA:"tesla.com",NFLX:"netflix.com",AMD:"amd.com",JPM:"jpmorganchase.com",BAC:"bankofamerica.com",WMT:"walmart.com",JNJ:"jnj.com",XOM:"exxonmobil.com",BA:"boeing.com",SBER:"sber.ru",GAZP:"gazprom.ru",LKOH:"lukoil.ru",YNDX:"yandex.ru"}[e.symbol]||`${e.name.toLowerCase().replace(/[^a-z0-9]/g,"")}.com`;e.logoUrl=`https://logo.clearbit.com/${t}?size=40&format=png`}}),L=e=>{e.target.closest("[data-dropdown-asset]")||(d.value=!1)},document.addEventListener("click",L)}),z(()=>{L&&document.removeEventListener("click",L)});const N=[{period:"Q3 2025",eps:2.45,rev:45.2},{period:"Q4 2025",eps:2.8,rev:48.5},{period:"Q1 2026",eps:3.1,rev:52.1},{period:"Q2 2026",eps:3.35,rev:55.8}],F=[{q:"Q2 25",est:2.1,act:2.25,surprise:"+7.1%"},{q:"Q1 25",est:1.95,act:2.05,surprise:"+5.1%"},{q:"Q4 24",est:1.8,act:1.88,surprise:"+4.4%"},{q:"Q3 24",est:1.65,act:1.6,surprise:"-3.0%"}],B=[{name:"Goldman Sachs",rating:"BUY",target:"1,200"},{name:"Morgan Stanley",rating:"OW",target:"1,150"},{name:"JP Morgan",rating:"HOLD",target:"980"}],U=S(()=>[{t:o.value,pe:35.2,pb:12.4,ev:28.5,roe:"45%"},{t:"AMD",pe:42.1,pb:8.2,ev:30.1,roe:"12%"},{t:"INTC",pe:85.4,pb:1.1,ev:12.5,roe:"5%"},{t:"TSM",pe:22.8,pb:5.6,ev:18.2,roe:"28%"}]),V=S(()=>({grid:{left:40,right:20,top:20,bottom:30},xAxis:{type:"category",data:N.map(e=>e.period),axisLabel:{color:"rgba(255,255,255,0.5)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{color:"rgba(255,255,255,0.5)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"bar",data:N.map(e=>e.eps),itemStyle:{color:"#6366f1",borderRadius:[4,4,0,0]},barWidth:40}],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"}}})),H=S(()=>({grid:{left:40,right:20,top:20,bottom:30},xAxis:{type:"category",data:N.map(e=>e.period),axisLabel:{color:"rgba(255,255,255,0.5)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",axisLabel:{color:"rgba(255,255,255,0.5)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"bar",data:N.map(e=>e.rev),itemStyle:{color:"#10b981",borderRadius:[4,4,0,0]},barWidth:40}],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"}}})),G=S(()=>({series:[{type:"pie",radius:["50%","70%"],center:["50%","50%"],data:[{value:35,name:"Покупать",itemStyle:{color:"#10b981"}},{value:10,name:"Держать",itemStyle:{color:"#fbbf24"}},{value:2,name:"Продавать",itemStyle:{color:"#f43f5e"}}],label:{show:!1},emphasis:{scale:!0,scaleSize:5}}],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"}},legend:{bottom:0,textStyle:{color:"#9ca3af"}}})),W={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'};return(e,t)=>(w(),i("div",OCt,[s("div",FCt,[s("div",BCt,[s("div",{class:c(`w-12 h-12 rounded-xl flex items-center justify-center text-lg font-bold shadow-lg overflow-hidden ${C(m.value?.category||"Equities")}`)},[m.value?.logoUrl?(w(),i("img",{key:0,src:m.value.logoUrl,alt:"Logo",class:"w-full h-full object-cover",onError:t[0]||(t[0]=e=>P(m.value.symbol))},null,40,UCt)):(w(),i("span",zCt,v(o.value.substring(0,2)),1))],2),s("div",VCt,[s("div",{onClick:t[1]||(t[1]=e=>d.value=!d.value),class:"cursor-pointer"},[s("div",HCt,[s("h2",GCt,v(o.value),1),s("div",WCt,[u(W,{class:c("w-3.5 h-3.5 text-gray-500 group-hover:text-indigo-300 transition-colors "+(d.value?"rotate-180":""))},null,8,["class"])])]),s("div",qCt,[s("span",YCt,v(x.value),1),s("span",{class:c("font-bold "+(_.value.startsWith("+")?"text-emerald-400":"text-rose-400"))},v(_.value),3),t[5]||(t[5]=s("span",{class:"px-1.5 py-0.5 rounded bg-white/5 text-[10px] uppercase"},"Фундаментальный анализ",-1))])]),d.value?(w(),i("div",{key:0,onClick:t[4]||(t[4]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-80 bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-96 flex flex-col"},[s("div",jCt,[T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>h.value=e),type:"text",placeholder:"Поиск актива...",class:"w-full px-3 py-2 bg-black/40 border border-white/10 rounded-lg text-sm text-white placeholder-gray-500 focus:border-indigo-500/50 outline-none",onInput:t[3]||(t[3]=e=>h.value=e.target.value)},null,544),[[k,h.value]])]),s("div",XCt,[(w(!0),i(p,null,f(b.value,e=>(w(),i("button",{key:e.symbol,onClick:t=>(e=>{o.value=e.symbol,m.value=e,d.value=!1,h.value=""})(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors flex items-center gap-3 "+(o.value===e.symbol?"bg-indigo-500/20 text-indigo-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},[s("div",{class:c(`w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold shadow-lg overflow-hidden ${C(e.category)}`)},[e.logoUrl?(w(),i("img",{key:0,src:e.logoUrl,alt:"Logo",class:"w-full h-full object-cover",onError:t=>P(e.symbol)},null,40,KCt)):(w(),i("span",ZCt,v(e.symbol.substring(0,2)),1))],2),s("div",JCt,[s("div",QCt,v(e.symbol),1),s("div",eAt,v(e.name),1)])],10,$Ct))),128)),0===b.value.length?(w(),i("div",tAt," Активы не найдены ")):l("",!0)])])):l("",!0)])]),s("div",aAt,[(w(),i(p,null,f(g,e=>s("button",{key:e.id,onClick:t=>r.value=e.id,class:c("px-3 py-1.5 rounded-lg text-xs font-bold transition-all whitespace-nowrap "+(r.value===e.id?"bg-indigo-500/20 text-indigo-300 border border-indigo-500/30":"text-gray-500 hover:text-white hover:bg-white/5"))},v(e.label),11,nAt)),64))])]),s("div",rAt,["EE"===r.value?(w(),i("div",iAt,[s("div",oAt,[s("div",sAt,[t[6]||(t[6]=s("h3",{class:"text-sm font-bold text-gray-400 uppercase mb-4"},"Консенсус-прогнозы EPS",-1)),s("div",lAt,[u(O(aTt),{class:"w-full h-full",option:V.value,autoresize:""},null,8,["option"])])]),s("div",cAt,[t[7]||(t[7]=s("h3",{class:"text-sm font-bold text-gray-400 uppercase mb-4"},"Прогноз выручки (млрд)",-1)),s("div",uAt,[u(O(aTt),{class:"w-full h-full",option:H.value,autoresize:""},null,8,["option"])])])])])):"ERN"===r.value?(w(),i("div",dAt,[t[9]||(t[9]=s("h3",{class:"text-lg font-bold text-white mb-6"},"История прибылей: Факт vs Консенсус",-1)),s("table",hAt,[t[8]||(t[8]=s("thead",null,[s("tr",{class:"text-xs text-gray-500 uppercase border-b border-white/10"},[s("th",{class:"py-3 px-4"},"Период"),s("th",{class:"py-3 px-4"},"Прогноз"),s("th",{class:"py-3 px-4"},"Факт"),s("th",{class:"py-3 px-4"},"Сюрприз"),s("th",{class:"py-3 px-4 text-right"},"Реакция цены")])],-1)),s("tbody",pAt,[(w(),i(p,null,f(F,(e,t)=>s("tr",{key:t,class:"border-b border-white/5 hover:bg-white/5"},[s("td",fAt,v(e.q),1),s("td",mAt,"$"+v(e.est),1),s("td",vAt,"$"+v(e.act),1),s("td",{class:c("py-4 px-4 font-bold "+(e.surprise.startsWith("+")?"text-emerald-400":"text-rose-400"))},v(e.surprise),3),s("td",gAt,[s("span",{class:c("px-2 py-1 rounded text-xs "+(e.surprise.startsWith("+")?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"))},v(e.surprise.startsWith("+")?"+2.4%":"-1.1%"),3)])])),64))])])])):"ANR"===r.value?(w(),i("div",yAt,[s("div",bAt,[t[10]||(t[10]=s("h3",{class:"text-lg font-bold text-white mb-2"},"Консенсус-рейтинг",-1)),t[11]||(t[11]=s("div",{class:"text-5xl font-bold text-emerald-400 mb-2"},"4.8",-1)),s("div",xAt,[(w(),i(p,null,f(5,e=>s("span",{key:e,class:c("w-5 h-5 "+(e<=4?"text-yellow-400":"text-gray-600"))},"★",2)),64))]),s("div",wAt,[u(O(aTt),{class:"w-full h-full",option:G.value,autoresize:""},null,8,["option"])])]),s("div",_At,[t[12]||(t[12]=s("h3",{class:"text-lg font-bold text-white mb-6"},"Целевые цены аналитиков",-1)),s("div",SAt,[(w(),i(p,null,f(B,(e,t)=>{return s("div",{key:t,class:"flex justify-between items-center p-4 bg-white/5 rounded-xl border border-white/5"},[s("span",MAt,v(e.name),1),s("div",TAt,[s("span",{class:c("font-bold px-2 py-0.5 rounded text-xs "+("BUY"===e.rating||"OW"===e.rating?"bg-emerald-500/10 text-emerald-400":"bg-yellow-500/10 text-yellow-400"))},v((a=e.rating,{BUY:"ПОКУПАТЬ",OW:"ПРЕВЫШЕНИЕ",HOLD:"ДЕРЖАТЬ",UW:"НЕДООЦЕНКА",SELL:"ПРОДАВАТЬ"}[a]||a)),3),s("span",kAt,"$"+v(e.target),1)])]);var a}),64))])])])):"RV"===r.value?(w(),i("div",CAt,[t[14]||(t[14]=s("h3",{class:"text-lg font-bold text-white mb-6"},"Относительная оценка",-1)),s("table",AAt,[t[13]||(t[13]=s("thead",null,[s("tr",{class:"text-xs text-gray-500 uppercase border-b border-white/10"},[s("th",{class:"py-3 px-4"},"Тикер"),s("th",{class:"py-3 px-4"},"P/E (TTM)"),s("th",{class:"py-3 px-4"},"P/B"),s("th",{class:"py-3 px-4"},"EV/EBITDA"),s("th",{class:"py-3 px-4"},"ROE")])],-1)),s("tbody",EAt,[(w(!0),i(p,null,f(U.value,(e,t)=>(w(),i("tr",{key:t,class:c("border-b border-white/5 "+(e.t===o.value?"bg-indigo-500/10":""))},[s("td",{class:c("py-4 px-4 font-bold "+(e.t===o.value?"text-indigo-300":"text-white"))},v(e.t),3),s("td",IAt,v(e.pe)+"x",1),s("td",RAt,v(e.pb)+"x",1),s("td",DAt,v(e.ev)+"x",1),s("td",PAt,v(e.roe),1)],2))),128))])])])):"DVD"===r.value?(w(),i("div",LAt,[...t[15]||(t[15]=[I('<div class="p-6 rounded-2xl bg-white/5 border border-white/5 text-center"><div class="text-sm text-gray-400 uppercase font-bold mb-2">Дивидендная доходность</div><div class="text-3xl font-bold text-white">0.04%</div><div class="text-xs text-gray-500 mt-1">Годовая</div></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5 text-center"><div class="text-sm text-gray-400 uppercase font-bold mb-2">Дата выплаты</div><div class="text-3xl font-bold text-white">28 дек</div><div class="text-xs text-gray-500 mt-1">2025</div></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5 text-center"><div class="text-sm text-gray-400 uppercase font-bold mb-2">Ex-Dividend</div><div class="text-3xl font-bold text-white">04 дек</div><div class="text-xs text-gray-500 mt-1">Подтверждено</div></div>',3)])])):(w(),i("div",NAt,[s("div",OAt,[s("h3",FAt,v(A(r.value)),1),t[16]||(t[16]=s("p",{class:"text-gray-400"},"Содержимое появится в ближайшее время",-1))])]))])]))}}),UAt={class:"page-container custom-scrollbar"},zAt={class:"flex flex-col md:flex-row items-center justify-between p-6 border-b border-white/5 bg-black/20 gap-4"},VAt={class:"flex items-center gap-4 self-start md:self-auto"},HAt={class:"w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-500/20 to-teal-500/20 flex items-center justify-center text-lg font-bold text-emerald-300 border border-emerald-500/30"},GAt={class:"relative group","data-dropdown-asset":""},WAt={class:"flex items-center gap-3 mb-1"},qAt={class:"text-2xl font-bold text-white tracking-tight group-hover:text-emerald-300 transition-colors"},YAt={class:"p-1 rounded-lg bg-white/5 group-hover:bg-emerald-500/20 transition-colors"},jAt={class:"p-3 border-b border-white/5"},XAt={class:"overflow-y-auto custom-scrollbar max-h-64"},$At=["onClick"],KAt={class:"w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-500/20 to-teal-500/20 flex items-center justify-center text-xs font-bold text-emerald-300"},ZAt={class:"flex-1"},JAt={class:"font-bold"},QAt={class:"text-xs text-gray-500"},eEt={key:0,class:"px-4 py-3 text-sm text-gray-500 text-center"},tEt={class:"flex bg-black/40 rounded-xl p-1 border border-white/5 overflow-x-auto max-w-full custom-scrollbar self-stretch md:self-auto"},aEt=["onClick"],nEt={class:"flex-1 overflow-y-auto custom-scrollbar p-6 bg-gradient-to-b from-black/10 to-transparent"},rEt={key:0,class:"space-y-4"},iEt={class:"overflow-x-auto rounded-xl border border-white/5"},oEt={class:"w-full text-left border-collapse"},sEt={class:"text-sm font-mono text-gray-300"},lEt={class:"p-4"},cEt={class:"p-4 text-right"},uEt={class:"p-4 text-right text-emerald-400/80"},dEt={class:"p-4 text-right text-rose-400/80"},hEt={class:"p-4 text-right font-bold text-white"},pEt={class:"p-4 text-right text-gray-500"},fEt={key:1,class:"h-full flex flex-col"},mEt={class:"flex justify-between items-center mb-4"},vEt={class:"flex gap-2"},gEt={class:"flex-1 bg-black/20 rounded-xl border border-white/5 p-4 min-h-[400px]"},yEt={key:2,class:"h-full flex flex-col"},bEt={class:"flex justify-between items-center mb-4"},xEt={class:"flex gap-2"},wEt=["onClick"],_Et={class:"flex-1 bg-black/20 rounded-xl border border-white/5 p-4 min-h-[400px]"},SEt={class:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4"},MEt={class:"bg-black/20 rounded-xl border border-white/5 p-4 text-center"},TEt={class:"text-lg font-bold text-white font-mono"},kEt={class:"bg-black/20 rounded-xl border border-white/5 p-4 text-center"},CEt={class:"text-lg font-bold text-emerald-400 font-mono"},AEt={class:"bg-black/20 rounded-xl border border-white/5 p-4 text-center"},EEt={class:"text-lg font-bold text-rose-400 font-mono"},IEt={class:"bg-black/20 rounded-xl border border-white/5 p-4 text-center"},REt={class:"text-lg font-bold text-white font-mono"},DEt={key:3,class:"h-full grid grid-cols-1 lg:grid-cols-3 gap-6"},PEt={class:"lg:col-span-2 bg-black/20 rounded-xl border border-white/5 p-6 flex flex-col min-h-[400px]"},LEt={class:"flex-1"},NEt={key:4,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},OEt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 col-span-1 lg:col-span-2"},FEt={class:"text-sm font-bold text-white uppercase mb-6 flex items-center gap-2"},BEt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},UEt={class:"text-xs text-gray-500 mb-1"},zEt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 col-span-1 lg:col-span-3"},VEt={class:"text-sm font-bold text-white uppercase mb-4 flex items-center gap-2"},HEt={class:"overflow-x-auto"},GEt={class:"w-full text-left"},WEt={class:"text-sm font-mono"},qEt={class:"py-3 font-bold text-white"},YEt={class:"py-3 text-gray-300"},jEt={class:"py-3 text-gray-300"},XEt={class:"py-3 text-right text-emerald-400 font-bold"},$Et={key:5,class:"flex items-center justify-center h-full"},KEt={class:"text-center"},ZEt={class:"text-xl font-bold text-white mb-2"},JEt=e({__name:"PriceAnalysisPage",props:{symbol:{},activeSection:{}},setup(e){Qet([Wnt,Irt,sst,BarChart,zwt,fwt,Agt]);const a=e,r=t(a.activeSection||"HP"),o=t(a.symbol||"BTC/USDT"),d=t(!0),h=t(!1),g=t(!1),y=t(""),b=t("1h");R(()=>a.activeSection,e=>{r.value=e}),R(()=>a.symbol,e=>{o.value=e});const x=[{id:"HP",label:"Историческая цена",icon:"CalendarIcon"},{id:"GP",label:"График цены",icon:"ActivityIcon"},{id:"GIP",label:"Внутридневной график",icon:"ClockIcon"},{id:"BETA",label:"Анализ Бета",icon:"LayersIcon"},{id:"RG",label:"Историческая доходность",icon:"TrendingUpIcon"},{id:"TECH",label:"Технический анализ",icon:"BarChart2Icon"}],_=[{name:"Bitcoin",symbol:"BTC/USDT",price:"64,230.50",change:"+2.45%",cap:"1.2T",vol:"35B",category:"Crypto"},{name:"Ethereum",symbol:"ETH/USDT",price:"3,450.20",change:"-1.12%",cap:"400B",vol:"15B",category:"Crypto"},{name:"Solana",symbol:"SOL/USDT",price:"148.50",change:"+5.67%",cap:"65B",vol:"4B",category:"Crypto"},{name:"Ripple",symbol:"XRP/USDT",price:"0.62",change:"-0.45%",cap:"34B",vol:"1.2B",category:"Crypto"},{name:"Cardano",symbol:"ADA/USDT",price:"0.45",change:"+1.20%",cap:"16B",vol:"400M",category:"Crypto"},{name:"Polkadot",symbol:"DOT/USDT",price:"7.25",change:"+3.10%",cap:"9.5B",vol:"250M",category:"Crypto"},{name:"Chainlink",symbol:"LINK/USDT",price:"14.80",change:"+1.85%",cap:"8.2B",vol:"180M",category:"Crypto"},{name:"Polygon",symbol:"MATIC/USDT",price:"0.85",change:"-0.30%",cap:"7.8B",vol:"150M",category:"Crypto"},{name:"Avalanche",symbol:"AVAX/USDT",price:"38.50",change:"+4.20%",cap:"14.5B",vol:"320M",category:"Crypto"},{name:"Uniswap",symbol:"UNI/USDT",price:"6.20",change:"+2.50%",cap:"4.6B",vol:"95M",category:"Crypto"},{name:"Litecoin",symbol:"LTC/USDT",price:"82.40",change:"+0.95%",cap:"6.1B",vol:"280M",category:"Crypto"},{name:"Bitcoin Cash",symbol:"BCH/USDT",price:"245.60",change:"-0.15%",cap:"4.8B",vol:"120M",category:"Crypto"},{name:"Dogecoin",symbol:"DOGE/USDT",price:"0.15",change:"+5.25%",cap:"21.5B",vol:"1.2B",category:"Crypto"},{name:"Shiba Inu",symbol:"SHIB/USDT",price:"0.000025",change:"+4.50%",cap:"14.8B",vol:"850M",category:"Crypto"},{name:"Binance Coin",symbol:"BNB/USDT",price:"585.40",change:"+1.25%",cap:"88B",vol:"1.8B",category:"Crypto"},{name:"Apple Inc.",symbol:"AAPL",price:"173.50",change:"+1.20%",category:"Equities",vol:"55M",cap:"2.7T"},{name:"NVIDIA Corp",symbol:"NVDA",price:"892.10",change:"+4.25%",category:"Equities",vol:"42M",cap:"2.2T"},{name:"Microsoft",symbol:"MSFT",price:"420.55",change:"-0.45%",category:"Equities",vol:"22M",cap:"3.1T"},{name:"Tesla Inc",symbol:"TSLA",price:"175.30",change:"+2.10%",category:"Equities",vol:"95M",cap:"550B"},{name:"Amazon",symbol:"AMZN",price:"180.25",change:"+0.95%",category:"Equities",vol:"38M",cap:"1.8T"},{name:"Meta Platforms",symbol:"META",price:"495.10",change:"+1.85%",category:"Equities",vol:"18M",cap:"1.2T"},{name:"Google",symbol:"GOOGL",price:"156.40",change:"-0.20%",category:"Equities",vol:"24M",cap:"1.9T"},{name:"AMD",symbol:"AMD",price:"142.50",change:"+3.15%",category:"Equities",vol:"65M",cap:"230B"},{name:"Netflix",symbol:"NFLX",price:"485.20",change:"+2.30%",category:"Equities",vol:"8M",cap:"215B"},{name:"JPMorgan Chase",symbol:"JPM",price:"185.40",change:"+0.55%",category:"Equities",vol:"15M",cap:"540B"},{name:"Bank of America",symbol:"BAC",price:"38.50",change:"+0.40%",category:"Equities",vol:"45M",cap:"305B"},{name:"Walmart",symbol:"WMT",price:"165.30",change:"+0.45%",category:"Equities",vol:"8M",cap:"445B"},{name:"Johnson & Johnson",symbol:"JNJ",price:"158.40",change:"+0.30%",category:"Equities",vol:"9M",cap:"420B"},{name:"Exxon Mobil",symbol:"XOM",price:"118.50",change:"+0.85%",category:"Equities",vol:"22M",cap:"495B"},{name:"Boeing",symbol:"BA",price:"185.40",change:"+1.85%",category:"Equities",vol:"8M",cap:"115B"},{name:"Сбербанк",symbol:"SBER",price:"285.40",change:"+1.85%",category:"Equities",vol:"125M",cap:"6.5T"},{name:"Газпром",symbol:"GAZP",price:"168.50",change:"+0.95%",category:"Equities",vol:"85M",cap:"4.2T"},{name:"Лукойл",symbol:"LKOH",price:"7850.60",change:"+1.25%",category:"Equities",vol:"1.2M",cap:"8.1T"},{name:"Яндекс",symbol:"YNDX",price:"2840.50",change:"+1.45%",category:"Equities",vol:"2.5M",cap:"1.1T"},{name:"Euro / USD",symbol:"EUR/USD",price:"1.0850",change:"-0.10%",category:"FX"},{name:"USD / JPY",symbol:"USD/JPY",price:"151.20",change:"+0.30%",category:"FX"},{name:"GBP / USD",symbol:"GBP/USD",price:"1.2640",change:"+0.05%",category:"FX"},{name:"AUD / USD",symbol:"AUD/USD",price:"0.6520",change:"+0.15%",category:"FX"}],M=S(()=>{if(!y.value)return _;const e=y.value.toLowerCase();return _.filter(t=>t.symbol.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}),C=e=>{const t=x.find(t=>t.id===e);return t?t.label:e};let A=null;n(()=>{A=e=>{e.target.closest("[data-dropdown-asset]")||(g.value=!1)},document.addEventListener("click",A)}),z(()=>{A&&document.removeEventListener("click",A)});const D=S(()=>Array.from({length:15},(e,t)=>{const a=new Date;a.setDate(a.getDate()-t);const n=140+10*Math.random(),r=n+5*(Math.random()-.5);return{date:a.toLocaleDateString(),open:n.toFixed(2),high:(Math.max(n,r)+Math.random()).toFixed(2),low:(Math.min(n,r)-Math.random()).toFixed(2),close:r.toFixed(2),vol:(10*Math.random()+5).toFixed(2)+"M",change:((r-n)/n*100).toFixed(2)}})),P=S(()=>Array.from({length:50},(e,t)=>({time:`Day ${t+1}`,close:140+10*Math.sin(.2*t)+5*Math.random(),ma20:140+8*Math.sin(.2*t),upperBB:140+10*Math.sin(.2*t)+8,lowerBB:140+10*Math.sin(.2*t)-8}))),L=S(()=>({grid:{left:40,right:40,top:20,bottom:30},xAxis:{type:"category",data:P.value.map(e=>e.time),axisLabel:{color:"rgba(255,255,255,0.3)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",position:"right",axisLabel:{color:"rgba(255,255,255,0.3)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"line",data:P.value.map(e=>e.close),smooth:!0,symbol:"none",lineStyle:{color:"#10b981",width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(16, 185, 129, 0.3)"},{offset:1,color:"rgba(16, 185, 129, 0)"}]}}},...d.value?[{type:"line",data:P.value.map(e=>e.ma20),smooth:!0,symbol:"none",lineStyle:{color:"#fbbf24",width:2}}]:[],...h.value?[{type:"line",data:P.value.map(e=>e.upperBB),smooth:!0,symbol:"none",lineStyle:{color:"#60a5fa",width:1,type:"dashed"}},{type:"line",data:P.value.map(e=>e.lowerBB),smooth:!0,symbol:"none",lineStyle:{color:"#60a5fa",width:1,type:"dashed"}}]:[]],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"}}})),N=S(()=>Array.from({length:50},()=>[2*(Math.random()-.5),3*(Math.random()-.5)])),F=S(()=>({grid:{left:40,right:20,top:20,bottom:40},xAxis:{type:"value",name:"Доходность SPX %",nameLocation:"middle",nameGap:25,nameTextStyle:{color:"#6b7280",fontSize:10},axisLabel:{color:"#9ca3af",fontSize:10},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},yAxis:{type:"value",name:"Доходность актива %",nameLocation:"middle",nameGap:30,nameTextStyle:{color:"#6b7280",fontSize:10},axisLabel:{color:"#9ca3af",fontSize:10},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"scatter",data:N.value,symbolSize:8,itemStyle:{color:"#34d399"}}],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"}}})),B=[{name:"RSI (14)",value:"64.5",signal:"Нейтрально",color:"text-emerald-400"},{name:"Stoch (9,6)",value:"82.1",signal:"Перекупленность",color:"text-rose-400"},{name:"CCI (20)",value:"110.2",signal:"Покупка",color:"text-emerald-400"},{name:"MACD (12,26)",value:"2.45",signal:"Бычий крест",color:"text-emerald-400"}],U=[{period:"MA10",sma:"142.50",ema:"143.10",action:"ПОКУПКА"},{period:"MA20",sma:"138.20",ema:"139.50",action:"ПОКУПКА"},{period:"MA50",sma:"125.00",ema:"128.40",action:"ПОКУПКА"},{period:"MA200",sma:"110.10",ema:"115.20",action:"ПОКУПКА"}],V=[{label:"1 мин",value:"1m"},{label:"5 мин",value:"5m"},{label:"15 мин",value:"15m"},{label:"1 час",value:"1h"},{label:"4 часа",value:"4h"}],H=S(()=>{const e=new Date,t="1m"===b.value?390:"5m"===b.value?78:"15m"===b.value?26:"1h"===b.value?6.5:1.5;return Array.from({length:Math.floor(t)},(a,n)=>{const r=new Date(e);"1m"===b.value?r.setMinutes(r.getMinutes()-(Math.floor(t)-n)):"5m"===b.value?r.setMinutes(r.getMinutes()-5*(Math.floor(t)-n)):"15m"===b.value?r.setMinutes(r.getMinutes()-15*(Math.floor(t)-n)):"1h"===b.value?r.setHours(r.getHours()-(Math.floor(t)-n)):r.setHours(r.getHours()-4*(Math.floor(t)-n));const i=145.32+2*Math.sin(.1*n)+1.5*(Math.random()-.5);return{time:r.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}),price:i,volume:1e6*Math.random()}})}),G=S(()=>{const e=H.value.map(e=>e.price);return 0===e.length?{open:"0.00",high:"0.00",low:"0.00",current:"0.00"}:{open:e[0]?.toFixed(2)||"0.00",high:Math.max(...e).toFixed(2),low:Math.min(...e).toFixed(2),current:e[e.length-1]?.toFixed(2)||"0.00"}}),W=S(()=>({grid:{left:50,right:50,top:20,bottom:40},xAxis:{type:"category",data:H.value.map(e=>e.time),axisLabel:{color:"rgba(255,255,255,0.3)",fontSize:10,rotate:45,interval:"1m"===b.value?"auto":0},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",position:"right",axisLabel:{color:"rgba(255,255,255,0.3)",fontSize:10},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"line",data:H.value.map(e=>e.price),smooth:!1,symbol:"none",lineStyle:{color:"#10b981",width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(16, 185, 129, 0.3)"},{offset:1,color:"rgba(16, 185, 129, 0)"}]}},markLine:{silent:!0,data:[{yAxis:parseFloat(G.value.open),name:"Открытие",lineStyle:{color:"#60a5fa",type:"dashed",width:1}},{yAxis:parseFloat(G.value.high),name:"Максимум",lineStyle:{color:"#10b981",type:"dashed",width:1}},{yAxis:parseFloat(G.value.low),name:"Минимум",lineStyle:{color:"#ef4444",type:"dashed",width:1}}]}}],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"},trigger:"axis",axisPointer:{type:"cross"}}})),q={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'},Y={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>'},j={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'};return(e,t)=>(w(),i("div",UAt,[s("div",zAt,[s("div",VAt,[s("div",HAt,v((o.value||"BT").substring(0,2)),1),s("div",GAt,[s("div",{onClick:t[0]||(t[0]=e=>g.value=!g.value),class:"cursor-pointer"},[s("div",WAt,[s("h2",qAt,v(o.value),1),s("div",YAt,[u(j,{class:c("w-3.5 h-3.5 text-gray-500 group-hover:text-emerald-300 transition-colors "+(g.value?"rotate-180":""))},null,8,["class"])])]),t[6]||(t[6]=s("div",{class:"flex items-center gap-4 text-xs text-gray-400"},[s("span",{class:"font-mono text-white"},"$145.32"),s("span",{class:"text-emerald-400 font-bold"},"+1.24%"),s("span",{class:"px-1.5 py-0.5 rounded bg-white/5 text-[10px] uppercase"},"Анализ цен")],-1))]),g.value?(w(),i("div",{key:0,onClick:t[3]||(t[3]=E(()=>{},["stop"])),class:"absolute top-full left-0 mt-2 w-80 bg-black/90 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl z-50 max-h-96 flex flex-col"},[s("div",jAt,[T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e),type:"text",placeholder:"Поиск актива...",class:"w-full px-3 py-2 bg-black/40 border border-white/10 rounded-lg text-sm text-white placeholder-gray-500 focus:border-emerald-500/50 outline-none",onInput:t[2]||(t[2]=e=>y.value=e.target.value)},null,544),[[k,y.value]])]),s("div",XAt,[(w(!0),i(p,null,f(M.value,e=>(w(),i("button",{key:e.symbol,onClick:t=>(e=>{o.value=e.symbol,g.value=!1,y.value=""})(e),class:c("w-full px-4 py-3 text-left text-sm transition-colors flex items-center gap-3 "+(o.value===e.symbol?"bg-emerald-500/20 text-emerald-300":"text-gray-300 hover:bg-white/5 hover:text-white"))},[s("div",KAt,v(e.symbol.substring(0,2)),1),s("div",ZAt,[s("div",JAt,v(e.symbol),1),s("div",QAt,v(e.name),1)])],10,$At))),128)),0===M.value.length?(w(),i("div",eEt," Активы не найдены ")):l("",!0)])])):l("",!0)])]),s("div",tEt,[(w(),i(p,null,f(x,e=>s("button",{key:e.id,onClick:t=>r.value=e.id,class:c("px-3 py-1.5 rounded-lg text-xs font-bold transition-all whitespace-nowrap "+(r.value===e.id?"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30":"text-gray-500 hover:text-white hover:bg-white/5"))},v(e.label),11,aEt)),64))])]),s("div",nEt,["HP"===r.value?(w(),i("div",rEt,[t[8]||(t[8]=I('<div class="flex justify-between items-center"><h3 class="text-lg font-bold text-white">Исторические данные (OHLCV)</h3><div class="flex gap-2"><button class="px-3 py-1 bg-white/10 rounded-lg text-xs hover:bg-white/20">День</button><button class="px-3 py-1 text-gray-500 hover:text-white text-xs">Неделя</button><button class="px-3 py-1 text-gray-500 hover:text-white text-xs">Месяц</button></div></div>',1)),s("div",iEt,[s("table",oEt,[t[7]||(t[7]=s("thead",null,[s("tr",{class:"bg-white/5 text-xs text-gray-400 uppercase"},[s("th",{class:"p-4 font-bold"},"Дата"),s("th",{class:"p-4 font-bold text-right"},"Открытие"),s("th",{class:"p-4 font-bold text-right"},"Максимум"),s("th",{class:"p-4 font-bold text-right"},"Минимум"),s("th",{class:"p-4 font-bold text-right"},"Закрытие"),s("th",{class:"p-4 font-bold text-right"},"Объём"),s("th",{class:"p-4 font-bold text-right"},"Изменение %")])],-1)),s("tbody",sEt,[(w(!0),i(p,null,f(D.value,(e,t)=>(w(),i("tr",{key:t,class:"border-t border-white/5 hover:bg-white/5 transition-colors"},[s("td",lEt,v(e.date),1),s("td",cEt,v(e.open),1),s("td",uEt,v(e.high),1),s("td",dEt,v(e.low),1),s("td",hEt,v(e.close),1),s("td",pEt,v(e.vol),1),s("td",{class:c("p-4 text-right font-bold "+(parseFloat(e.change)>=0?"text-emerald-400":"text-rose-400"))},v(parseFloat(e.change)>=0?"+":"")+v(e.change)+"% ",3)]))),128))])])])])):"GP"===r.value?(w(),i("div",fEt,[s("div",mEt,[t[9]||(t[9]=s("h3",{class:"text-lg font-bold text-white"},"Технический график цены",-1)),s("div",vEt,[s("button",{onClick:t[4]||(t[4]=e=>d.value=!d.value),class:c("px-3 py-1 rounded-lg text-xs font-bold border transition-all "+(d.value?"bg-indigo-500/20 border-indigo-500/50 text-indigo-300":"border-white/10 text-gray-500"))}," MA (20) ",2),s("button",{onClick:t[5]||(t[5]=e=>h.value=!h.value),class:c("px-3 py-1 rounded-lg text-xs font-bold border transition-all "+(h.value?"bg-indigo-500/20 border-indigo-500/50 text-indigo-300":"border-white/10 text-gray-500"))}," Полосы Боллинджера ",2)])]),s("div",gEt,[u(O(aTt),{class:"w-full h-full",option:L.value,autoresize:""},null,8,["option"])])])):"GIP"===r.value?(w(),i("div",yEt,[s("div",bEt,[t[10]||(t[10]=s("h3",{class:"text-lg font-bold text-white"},"Внутридневной график",-1)),s("div",xEt,[(w(),i(p,null,f(V,e=>s("button",{key:e.value,onClick:t=>b.value=e.value,class:c("px-3 py-1 rounded-lg text-xs font-bold border transition-all "+(b.value===e.value?"bg-emerald-500/20 border-emerald-500/50 text-emerald-300":"border-white/10 text-gray-500 hover:text-white hover:bg-white/5"))},v(e.label),11,wEt)),64))])]),s("div",_Et,[u(O(aTt),{class:"w-full h-full",option:W.value,autoresize:""},null,8,["option"])]),s("div",SEt,[s("div",MEt,[t[11]||(t[11]=s("div",{class:"text-xs text-gray-400 mb-1"},"Открытие",-1)),s("div",TEt,v(G.value.open),1)]),s("div",kEt,[t[12]||(t[12]=s("div",{class:"text-xs text-gray-400 mb-1"},"Максимум",-1)),s("div",CEt,v(G.value.high),1)]),s("div",AEt,[t[13]||(t[13]=s("div",{class:"text-xs text-gray-400 mb-1"},"Минимум",-1)),s("div",EEt,v(G.value.low),1)]),s("div",IEt,[t[14]||(t[14]=s("div",{class:"text-xs text-gray-400 mb-1"},"Текущая",-1)),s("div",REt,v(G.value.current),1)])])])):"BETA"===r.value?(w(),i("div",DEt,[s("div",PEt,[t[15]||(t[15]=s("h3",{class:"text-lg font-bold text-white mb-4"},"Регрессионный анализ (vs SPX)",-1)),s("div",LEt,[u(O(aTt),{class:"w-full h-full",option:F.value,autoresize:""},null,8,["option"])])]),t[16]||(t[16]=I('<div class="space-y-4"><div class="p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center justify-center text-center"><span class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Коэффициент Бета</span><span class="text-5xl font-bold text-emerald-400 mb-2">1.42</span><span class="text-xs text-gray-500">Высокая волатильность к рынку</span></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center justify-center text-center"><span class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Альфа (Дженсен)</span><span class="text-5xl font-bold text-white mb-2">2.1%</span><span class="text-xs text-gray-500">Избыточная доходность</span></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col items-center justify-center text-center"><span class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">R-квадрат</span><span class="text-5xl font-bold text-indigo-400 mb-2">0.65</span><span class="text-xs text-gray-500">Сила корреляции</span></div></div>',1))])):"TECH"===r.value?(w(),i("div",NEt,[s("div",OEt,[s("h3",FEt,[u(q,{class:"w-4 h-4 text-indigo-400"}),t[17]||(t[17]=m(" Осцилляторы ",-1))]),s("div",BEt,[(w(),i(p,null,f(B,e=>s("div",{key:e.name,class:"bg-black/20 p-4 rounded-xl text-center border border-white/5"},[s("div",UEt,v(e.name),1),s("div",{class:c(`text-xl font-bold ${e.color}`)},v(e.value),3),s("div",{class:c(`text-[10px] mt-1 ${e.color}`)},v(e.signal),3)])),64))])]),t[20]||(t[20]=I('<div class="p-6 rounded-2xl bg-gradient-to-br from-indigo-900/30 to-black border border-white/5 flex flex-col items-center justify-center text-center"><h3 class="text-sm font-bold text-white uppercase mb-4">Общий сигнал</h3><div class="relative w-32 h-32 flex items-center justify-center mb-4"><div class="absolute inset-0 rounded-full border-4 border-white/5 border-t-emerald-500 border-r-emerald-500 transform rotate-45"></div><div class="text-2xl font-bold text-emerald-400">СИЛЬНАЯ<br>ПОКУПКА</div></div><p class="text-xs text-gray-400 px-4">На основе 12 осцилляторов и 8 скользящих средних</p></div>',1)),s("div",zEt,[s("h3",VEt,[u(Y,{class:"w-4 h-4 text-indigo-400"}),t[18]||(t[18]=m(" Скользящие средние ",-1))]),s("div",HEt,[s("table",GEt,[t[19]||(t[19]=s("thead",null,[s("tr",{class:"text-xs text-gray-500 uppercase border-b border-white/10"},[s("th",{class:"py-2"},"Период"),s("th",{class:"py-2"},"Простая MA"),s("th",{class:"py-2"},"Экспоненциальная MA"),s("th",{class:"py-2 text-right"},"Действие")])],-1)),s("tbody",WEt,[(w(),i(p,null,f(U,e=>s("tr",{key:e.period,class:"border-b border-white/5"},[s("td",qEt,v(e.period),1),s("td",YEt,v(e.sma),1),s("td",jEt,v(e.ema),1),s("td",XEt,v(e.action),1)])),64))])])])])])):(w(),i("div",$Et,[s("div",KEt,[s("h3",ZEt,v(C(r.value)),1),t[21]||(t[21]=s("p",{class:"text-gray-400"},"Содержимое появится в ближайшее время",-1))])]))])]))}}),QEt={class:"page-container custom-scrollbar"},eIt={class:"section-header flex-col md:flex-row gap-4"},tIt={class:"flex items-center gap-4"},aIt={class:"icon-box icon-green"},nIt={class:"tab-group"},rIt=["onClick"],iIt={class:"flex-1 overflow-y-auto custom-scrollbar p-6 bg-gradient-to-b from-black/10 to-transparent"},oIt={key:0,class:"flex flex-col h-full"},sIt={key:0,class:"flex items-center justify-center py-4 text-gray-400 mb-4"},lIt={class:"w-full text-center border-collapse"},cIt={class:"text-xs font-mono"},uIt={class:"p-4 font-bold text-white bg-white/5 sticky left-0 border-r border-white/5"},dIt={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-8 h-full"},hIt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col gap-6"},pIt={key:0,class:"flex items-center justify-center py-4 text-gray-400"},fIt={class:"grid grid-cols-[1fr_auto_1fr] gap-2 items-end"},mIt=["disabled"],vIt={class:"mt-auto p-4 rounded-xl bg-black/30 border border-white/10 text-center"},gIt={class:"text-3xl font-bold text-green-400 font-mono"},yIt={class:"text-sm text-gray-400"},bIt={class:"text-xs text-gray-500 mt-2"},xIt={class:"lg:col-span-2 p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col"},wIt={class:"flex justify-between items-center mb-6"},_It={class:"text-lg font-bold text-white"},SIt={class:"flex gap-2"},MIt={class:"flex-1 min-h-[300px]"},TIt={key:2,class:"flex flex-col h-full gap-6"},kIt={class:"flex-1 bg-black/20 rounded-2xl border border-white/5 overflow-hidden"},CIt={class:"w-full text-left border-collapse"},AIt={class:"text-sm font-mono text-gray-300"},EIt={class:"p-4 font-bold text-white"},IIt={class:"p-4 text-right"},RIt={class:"p-4 text-right text-gray-400"},DIt={class:"p-4 text-right text-gray-400"},PIt={class:"p-4 text-right text-gray-400"},LIt={class:"p-4 text-right text-gray-400"},NIt={class:"p-4 text-right"},OIt={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 h-full"},FIt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col"},BIt={class:"space-y-4 flex-1"},UIt={class:"font-bold text-white"},zIt={class:"text-right"},VIt={class:"text-white font-mono"},HIt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col"},GIt={class:"space-y-4 flex-1"},WIt={class:"font-bold text-white"},qIt={class:"text-right"},YIt={class:"text-white font-mono"},jIt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col"},XIt={class:"space-y-4 flex-1"},$It={class:"text-sm text-gray-300"},KIt={class:"font-bold text-white"},ZIt={key:4,class:"flex items-center justify-center h-full"},JIt={class:"text-center"},QIt={class:"text-xl font-bold text-white mb-2"},eRt=e({__name:"FXPage",props:{symbol:{},activeSection:{}},setup(e){Qet([Wnt,Irt,zwt,fwt,Agt]);const a=e,r=t(a.activeSection);R(()=>a.activeSection,e=>{r.value=e});const o=[{id:"FXC",label:"Кросс-валютная матрица"},{id:"FXCA",label:"Расчет спот-курса"},{id:"FXFC",label:"Прогнозы"},{id:"WIRA",label:"Международные резервы"},{id:"WCRS",label:"Рейтинги"},{id:"GMM",label:"Монитор"}],d=["USD","EUR","JPY","GBP","CHF","CAD","AUD"],h=t({USD:1,EUR:1.08,GBP:1.26,AUD:.65,CAD:.73,CHF:1.1,JPY:.0066}),g=t(!1),y=async()=>{g.value=!0;try{console.log("Loading currency rates...");const e=d.filter(e=>"USD"!==e).map(async e=>{try{const t=await(async(e,t="USD")=>{try{const a=await fetch(`${Eze}/api/market/currency/${e}/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a.ok){const e=await a.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${a.status}`)}return await a.json()}catch(QXe){throw console.error("Failed to fetch currency rate:",QXe),QXe}})(e,"USD");h.value[e]=1/t.rate,console.log(`Loaded ${e}/USD:`,t.rate)}catch(QXe){console.error(`Error loading rate for ${e}:`,QXe.message)}});await Promise.all(e),console.log("Currency rates loaded successfully")}catch(QXe){console.error("Error loading currency rates:",QXe),console.error("Error details:",QXe.message,QXe.stack)}finally{g.value=!1}},x=(e,t)=>e===t?1:h.value[e]/h.value[t],_=t(1e3),M=t("USD"),A=t("EUR"),E=S(()=>x(M.value,A.value)),P=S(()=>Array.from({length:30},(e,t)=>({day:t,rate:E.value+.02*Math.sin(t/5)+.01*(Math.random()-.5)})));let L=null;n(async()=>{await y(),L=setInterval(y,6e4)}),z(()=>{L&&clearInterval(L)});const N=S(()=>({grid:{left:40,right:20,top:20,bottom:30},xAxis:{type:"category",data:P.value.map(e=>e.day),show:!1},yAxis:{type:"value",axisLabel:{color:"#9ca3af",fontSize:10,formatter:e=>e.toFixed(3)},axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgba(255,255,255,0.05)"}}},series:[{type:"line",data:P.value.map(e=>e.rate),smooth:!0,symbol:"none",lineStyle:{color:"#10b981",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(16,185,129,0.3)"},{offset:1,color:"rgba(16,185,129,0)"}]}}}],tooltip:{backgroundColor:"#18181b",borderColor:"#27272a",textStyle:{color:"#fff"}}})),F=[{pair:"EUR/USD",spot:1.085,q1:1.09,q2:1.1,q3:1.12,q4:1.14,consensus:"Рост"},{pair:"USD/JPY",spot:151.2,q1:150,q2:148,q3:145,q4:142,consensus:"Спад"},{pair:"GBP/USD",spot:1.264,q1:1.27,q2:1.28,q3:1.29,q4:1.3,consensus:"Рост"},{pair:"AUD/USD",spot:.655,q1:.66,q2:.67,q3:.68,q4:.7,consensus:"Рост"},{pair:"USD/CAD",spot:1.358,q1:1.35,q2:1.34,q3:1.33,q4:1.32,consensus:"Рост"}],B=[{p:"EUR/USD",r:1.085,c:-.15},{p:"USD/JPY",r:151.2,c:.32},{p:"GBP/USD",r:1.264,c:.05},{p:"USD/CHF",r:.902,c:-.1}],U=[{p:"USD/CNH",r:7.245,c:.05},{p:"USD/MXN",r:16.502,c:-.25},{p:"USD/BRL",r:5.051,c:.12},{p:"USD/ZAR",r:18.85,c:.45}],V=[{name:"US 10Y Yield",value:"4.25%"},{name:"DXY Index",value:"104.20"},{name:"Gold (XAU)",value:"$2,685"},{name:"Brent Oil",value:"$74.50"}],H={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>'},G={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>'};return(e,t)=>(w(),i("div",QEt,[s("div",eIt,[s("div",tIt,[s("div",aIt,[u(H,{class:"w-6 h-6"})]),t[3]||(t[3]=s("div",null,[s("h2",{class:"section-title font-anton"},"ВАЛЮТНЫЙ РЫНОК"),s("p",{class:"section-subtitle font-mono"},"SPOT RATES, FORWARDS & MACRO FLOWS")],-1))]),s("div",nIt,[(w(),i(p,null,f(o,e=>s("button",{key:e.id,onClick:t=>r.value=e.id,class:c(["tab-btn",{active:r.value===e.id}])},[(w(),b(C(e.icon),{class:"w-3.5 h-3.5"})),m(" "+v(e.label),1)],10,rIt)),64))])]),s("div",iIt,["FXC"===r.value?(w(),i("div",oIt,[t[6]||(t[6]=I('<div class="flex justify-between items-center mb-6"><h3 class="text-lg font-bold text-white">Кросс-валютная матрица</h3><div class="flex gap-2 text-xs"><span class="flex items-center gap-1 text-emerald-400"><div class="w-2 h-2 rounded-full bg-emerald-500"></div> Strong</span><span class="flex items-center gap-1 text-rose-400"><div class="w-2 h-2 rounded-full bg-rose-500"></div> Weak</span></div></div>',1)),g.value?(w(),i("div",sIt,[...t[4]||(t[4]=[s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-4 h-4 border-2 border-green-500 border-t-transparent rounded-full animate-spin"}),s("span",{class:"text-xs font-bold"},"Загрузка курсов валют...")],-1)])])):l("",!0),s("div",{class:c(["flex-1 overflow-auto bg-black/20 rounded-2xl border border-white/5",{"opacity-50":g.value}])},[s("table",lIt,[s("thead",null,[s("tr",null,[t[5]||(t[5]=s("th",{class:"p-4 bg-white/5 border-b border-white/10 text-xs font-bold text-gray-500 sticky top-0 left-0 z-20"},"Base / Quote",-1)),(w(),i(p,null,f(d,e=>s("th",{key:e,class:"p-4 bg-white/5 border-b border-white/10 text-xs font-bold text-white sticky top-0 z-10"},v(e),1)),64))])]),s("tbody",cIt,[(w(),i(p,null,f(d,e=>s("tr",{key:e,class:"border-b border-white/5 hover:bg-white/5 transition-colors"},[s("td",uIt,v(e),1),(w(),i(p,null,f(d,t=>s("td",{key:t,class:c("p-4 "+(e===t?"text-gray-600 bg-black/40":x(e,t)>1?"text-emerald-400":"text-rose-400"))},v(e===t?"-":x(e,t).toFixed(4)),3)),64))])),64))])])],2)])):"FXCA"===r.value?(w(),i("div",dIt,[s("div",hIt,[t[12]||(t[12]=s("h3",{class:"text-lg font-bold text-white"},"Расчет спот-курса",-1)),g.value?(w(),i("div",pIt,[...t[7]||(t[7]=[s("div",{class:"flex items-center gap-2"},[s("div",{class:"w-4 h-4 border-2 border-green-500 border-t-transparent rounded-full animate-spin"}),s("span",{class:"text-xs font-bold"},"Загрузка курсов...")],-1)])])):l("",!0),s("div",{class:c(["space-y-4",{"opacity-50":g.value}])},[s("div",null,[t[8]||(t[8]=s("label",{class:"text-xs text-gray-500 font-bold uppercase mb-1 block"},"Количество",-1)),T(s("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),class:"w-full bg-black/40 border border-white/10 rounded-xl py-3 px-4 text-white font-mono text-lg outline-none focus:border-green-500/50"},null,512),[[k,_.value]])]),s("div",fIt,[s("div",null,[t[9]||(t[9]=s("label",{class:"text-xs text-gray-500 font-bold uppercase mb-1 block"},"Из",-1)),T(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>M.value=e),class:"w-full bg-black/40 border border-white/10 rounded-xl py-3 px-4 text-white outline-none"},[(w(),i(p,null,f(["USD","EUR","GBP","JPY","CAD"],e=>s("option",{key:e},v(e),1)),64))],512),[[D,M.value]])]),s("button",{onClick:y,class:"p-3 bg-white/10 rounded-xl hover:bg-white/20 text-white mb-1 transition-colors",disabled:g.value},[u(G,{class:c("w-4 h-4 "+(g.value?"animate-spin":""))},null,8,["class"])],8,mIt),s("div",null,[t[10]||(t[10]=s("label",{class:"text-xs text-gray-500 font-bold uppercase mb-1 block"},"В",-1)),T(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>A.value=e),class:"w-full bg-black/40 border border-white/10 rounded-xl py-3 px-4 text-white outline-none"},[(w(),i(p,null,f(["EUR","USD","GBP","JPY","CAD"],e=>s("option",{key:e},v(e),1)),64))],512),[[D,A.value]])])])],2),s("div",vIt,[t[11]||(t[11]=s("div",{class:"text-xs text-gray-500 uppercase mb-1"},"Результат",-1)),s("div",gIt,[m(v((_.value*E.value).toFixed(2))+" ",1),s("span",yIt,v(A.value),1)]),s("div",bIt,"Курс: 1 "+v(M.value)+" = "+v(E.value.toFixed(4))+" "+v(A.value),1)])]),s("div",xIt,[s("div",wIt,[s("h3",_It,"Исторический курс валютной пары ("+v(M.value)+"/"+v(A.value)+")",1),s("div",SIt,[(w(),i(p,null,f(["1W","1M","3M","1Y"],e=>s("button",{key:e,class:"px-3 py-1 text-xs font-bold rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white transition-colors"},v(e),1)),64))])]),s("div",MIt,[u(O(aTt),{class:"w-full h-full",option:N.value,autoresize:""},null,8,["option"])])])])):"FXFC"===r.value?(w(),i("div",TIt,[t[15]||(t[15]=I('<div class="grid grid-cols-3 gap-6"><div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Прогноз индекса DXY (Годовой)</h3><div class="text-3xl font-bold text-white">102.50</div><div class="text-xs text-rose-400 mt-1">Bearish vs Current (104.20)</div></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Наиболее количество сделок (Q4)</h3><div class="text-3xl font-bold text-emerald-400">Short USD/JPY</div><div class="text-xs text-gray-500 mt-1">Carry Unwind Theme</div></div><div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Обзор волатильности рынка</h3><div class="text-3xl font-bold text-white">Повышающаяся</div><div class="text-xs text-gray-500 mt-1">Election Risk Premium</div></div></div>',1)),s("div",kIt,[t[14]||(t[14]=s("div",{class:"p-4 border-b border-white/10 bg-white/5"},[s("h3",{class:"font-bold text-white"},"Консенсус-прогнозы по валютным парам (Медиана)")],-1)),s("table",CIt,[t[13]||(t[13]=s("thead",null,[s("tr",{class:"text-xs text-gray-500 uppercase"},[s("th",{class:"p-4"},"Валютная пара"),s("th",{class:"p-4 text-right"},"Спот-курс"),s("th",{class:"p-4 text-right"},"Q1 26"),s("th",{class:"p-4 text-right"},"Q2 26"),s("th",{class:"p-4 text-right"},"Q3 26"),s("th",{class:"p-4 text-right"},"Q4 26"),s("th",{class:"p-4 text-right"},"Консенсус")])],-1)),s("tbody",AIt,[(w(),i(p,null,f(F,(e,t)=>s("tr",{key:t,class:"border-b border-white/5 hover:bg-white/5 transition-colors"},[s("td",EIt,v(e.pair),1),s("td",IIt,v(e.spot.toFixed(4)),1),s("td",RIt,v(e.q1.toFixed(2)),1),s("td",DIt,v(e.q2.toFixed(2)),1),s("td",PIt,v(e.q3.toFixed(2)),1),s("td",LIt,v(e.q4.toFixed(2)),1),s("td",NIt,[s("span",{class:c("px-2 py-1 rounded text-xs font-bold border "+("Рост"===e.consensus?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400":"bg-rose-500/10 border-rose-500/20 text-rose-400"))},v(e.consensus),3)])])),64))])])])])):"GMM"===r.value?(w(),i("div",OIt,[s("div",FIt,[t[16]||(t[16]=s("h3",{class:"text-sm font-bold text-gray-400 uppercase mb-4"},"G10 Currencies",-1)),s("div",BIt,[(w(),i(p,null,f(B,e=>s("div",{key:e.p,class:"flex justify-between items-center p-3 rounded-xl bg-black/20"},[s("span",UIt,v(e.p),1),s("div",zIt,[s("div",VIt,v(e.r.toFixed(4)),1),s("div",{class:c("text-xs "+(e.c>0?"text-emerald-400":"text-rose-400"))},v(e.c>0?"+":"")+v(e.c)+"% ",3)])])),64))])]),s("div",HIt,[t[17]||(t[17]=s("h3",{class:"text-sm font-bold text-gray-400 uppercase mb-4"},"Emerging Markets",-1)),s("div",GIt,[(w(),i(p,null,f(U,e=>s("div",{key:e.p,class:"flex justify-between items-center p-3 rounded-xl bg-black/20"},[s("span",WIt,v(e.p),1),s("div",qIt,[s("div",YIt,v(e.r.toFixed(4)),1),s("div",{class:c("text-xs "+(e.c>0?"text-emerald-400":"text-rose-400"))},v(e.c>0?"+":"")+v(e.c)+"% ",3)])])),64))])]),s("div",jIt,[t[18]||(t[18]=s("h3",{class:"text-sm font-bold text-gray-400 uppercase mb-4"},"Макроиндикаторы",-1)),s("div",XIt,[(w(),i(p,null,f(V,(e,t)=>s("div",{key:t,class:"flex justify-between items-center p-3 rounded-xl bg-black/20"},[s("span",$It,v(e.name),1),s("span",KIt,v(e.value),1)])),64))])])])):(w(),i("div",ZIt,[s("div",JIt,[s("h3",QIt,v(r.value)+" View",1),t[19]||(t[19]=s("p",{class:"text-gray-400"},"Content coming soon",-1))])]))])]))}}),tRt={class:"widget-header"},aRt={class:"widget-title-area"},nRt={class:"widget-title font-oswald"},rRt={key:0,class:"widget-controls"},iRt={class:"widget-content custom-scrollbar"},oRt={key:0,class:"resize-handles"},sRt=e({__name:"BaseWidget",props:{title:{},icon:{},iconBg:{default:"icon-bg-red"},iconColor:{default:"text-red-500"},width:{default:1},height:{default:1},resizable:{type:Boolean,default:!0},showControls:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,o=t(!1),d=t(0),h=t(0),p=t(0),f=t(0),m=t("both"),g=(e,t="both")=>{e.preventDefault(),e.stopPropagation(),o.value=!0,m.value=t,d.value=e.clientX,h.value=e.clientY,p.value=n.width,f.value=n.height;let a=null,i=p.value,s=f.value,l=null;const c=e=>{e.preventDefault(),l||(l=window.setTimeout(()=>{l=null},16),a&&cancelAnimationFrame(a),a=requestAnimationFrame(()=>{const t=e.clientX-d.value,a=e.clientY-h.value;let n=p.value,o=f.value;"width"!==m.value&&"both"!==m.value||(n=Math.max(1,Math.round(p.value+t/50))),"height"!==m.value&&"both"!==m.value||(o=Math.max(1,Math.round(f.value+a/50))),n===i&&o===s||(i=n,s=o,r("resize",n,o))}))},u=()=>{a&&cancelAnimationFrame(a),l&&clearTimeout(l),o.value=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",c,{passive:!1}),document.addEventListener("mouseup",u,{once:!0})},y={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6m9-9h-6m-6 0H3"/></svg>'},x={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>'};return(t,a)=>(w(),i("div",{class:c(["widget-container",{"is-resizing":o.value}])},[s("div",tRt,[s("div",aRt,[s("div",{class:c(["widget-icon",e.iconBg])},[(w(),b(C(e.icon),{class:c(["w-3.5 h-3.5",e.iconColor])},null,8,["class"]))],2),s("h3",nRt,v(e.title),1)]),e.showControls?(w(),i("div",rRt,[s("button",{onClick:a[0]||(a[0]=E(e=>t.$emit("settings"),["stop"])),class:"widget-btn",title:"Настройки"},[u(y,{class:"w-3.5 h-3.5"})]),s("button",{onClick:a[1]||(a[1]=E(e=>t.$emit("remove"),["stop"])),class:"widget-btn widget-btn-danger",title:"Удалить виджет"},[u(x,{class:"w-3.5 h-3.5"})])])):l("",!0)]),s("div",iRt,[F(t.$slots,"default",{},void 0)]),e.resizable?(w(),i("div",oRt,[s("div",{class:"resize-handle resize-handle-right",onMousedown:a[2]||(a[2]=E(e=>g(e,"width"),["stop"])),title:"Изменить ширину"},null,32),s("div",{class:"resize-handle resize-handle-bottom",onMousedown:a[3]||(a[3]=E(e=>g(e,"height"),["stop"])),title:"Изменить высоту"},null,32),s("div",{class:"resize-handle resize-handle-corner",onMousedown:a[4]||(a[4]=E(e=>g(e,"both"),["stop"])),title:"Изменить размер"},[...a[5]||(a[5]=[s("div",{class:"resize-corner-indicator"},null,-1)])],32)])):l("",!0)],2))}}),lRt=xe(sRt,[["__scopeId","data-v-f0b51128"]]),cRt={class:"relative flex justify-between items-center text-[9px] px-2 hover:bg-white/5 cursor-pointer group transition-colors flex-shrink-0",style:{height:"calc(100% / 12)"}},uRt={class:"relative z-10 font-mono text-gray-400 text-right opacity-80 group-hover:opacity-100"},dRt=e({__name:"OrderBookRow",props:{item:{},type:{}},setup(e){const t=e,a=S(()=>20*t.item.amount+"%"),n=S(()=>"bid"===t.type?"bg-emerald-500":"bg-rose-500"),r=S(()=>"bid"===t.type?"text-emerald-400":"text-rose-400");return(t,o)=>(w(),i("div",cRt,[s("div",{class:c(`absolute top-0 right-0 h-full opacity-10 ${n.value}`),style:y({width:a.value})},null,6),s("span",{class:c(`relative z-10 font-mono ${r.value} font-medium`)},v(e.item.price.toFixed(0)),3),s("span",uRt,v(e.item.amount.toFixed(3)),1)]))}}),hRt={class:"orderbook"},pRt={class:"orderbook-content"},fRt={class:"orderbook-asks"},mRt={class:"orderbook-price"},vRt={class:"price-info"},gRt={class:"price-value font-mono"},yRt={class:"price-usd font-mono"},bRt={class:"orderbook-bids"},xRt=e({__name:"OrderBook",props:{bids:{},asks:{},currentPrice:{}},setup(e){const{isMobile:t,isSmallMobile:a}=Ho(),n=e,r=S(()=>a.value?6:t.value?8:12),o=S(()=>n.bids.slice(0,r.value)),l=S(()=>[...n.asks.slice(0,r.value)].reverse());return(t,a)=>(w(),i("div",hRt,[a[2]||(a[2]=I('<div class="orderbook-header" data-v-73883315><span class="orderbook-title font-mono" data-v-73883315>СТАКАН</span><div class="orderbook-dots" data-v-73883315><div class="dot" data-v-73883315></div><div class="dot" data-v-73883315></div><div class="dot" data-v-73883315></div></div></div>',1)),s("div",pRt,[a[1]||(a[1]=s("div",{class:"orderbook-labels font-mono"},[s("span",null,"ЦЕНА"),s("span",null,"ОБЪЁМ")],-1)),s("div",fRt,[(w(!0),i(p,null,f(l.value,(e,t)=>(w(),b(dRt,{key:t,item:e,type:"ask"},null,8,["item"]))),128))]),s("div",mRt,[s("div",vRt,[s("span",gRt,v(e.currentPrice.toFixed(2)),1),s("span",yRt,"≈ $"+v(e.currentPrice.toFixed(2)),1)]),a[0]||(a[0]=s("div",{class:"price-indicator"},null,-1))]),s("div",bRt,[(w(!0),i(p,null,f(o.value,(e,t)=>(w(),b(dRt,{key:t,item:e,type:"bid"},null,8,["item"]))),128))])])]))}}),wRt=xe(xRt,[["__scopeId","data-v-73883315"]]),_Rt=e({__name:"OrderBookWidget",props:{bids:{},asks:{},currentPrice:{},width:{default:1},height:{default:2},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,i=t(n.width),o=t(n.height),s=(e,t)=>{i.value=e,o.value=t,r("resize",e,t)};return(t,a)=>(w(),b(lRt,{title:"СТАКАН",icon:"BookIcon","icon-bg":"icon-bg-blue","icon-color":"text-blue-500",width:i.value,height:o.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:s},{default:h(()=>[u(wRt,{bids:e.bids,asks:e.asks,currentPrice:e.currentPrice},null,8,["bids","asks","currentPrice"])]),_:1},8,["width","height","resizable"]))}}),SRt={class:"h-full w-full flex flex-col bg-transparent relative"},MRt={class:"absolute top-0 left-0 right-0 z-10 px-4 py-3 flex justify-between items-start bg-gradient-to-b from-black/40 to-transparent"},TRt={class:"flex flex-col gap-1"},kRt={class:"flex items-baseline gap-3"},CRt={class:"text-lg font-bold text-white tracking-tight font-mono"},ARt={class:"flex gap-2 text-[10px] font-medium"},ERt={class:"bg-white/5 px-2 py-0.5 rounded text-white/60 border border-white/5"},IRt={class:"flex items-center gap-2"},RRt={class:"flex bg-black/30 rounded-lg p-0.5 backdrop-blur-md border border-white/5"},DRt={class:"flex-1 w-full pt-16"},PRt={class:"h-[60px] w-full border-t border-white/5 bg-black/10"},LRt=e({__name:"ChartWidget",props:{data:{},isExpanded:{type:Boolean},symbol:{}},emits:["toggleExpand"],setup(e,{emit:a}){Ho(),Qet([Wnt,Irt,ait,zwt,fwt,Agt,eSt,M_t]);const n=e,r=a,o=t(null),d=t(null),h=["15m","1H","4H","1D"],g=S(()=>({"BTC/USDT":"Bitcoin","ETH/USDT":"Ethereum","SOL/USDT":"Solana",AAPL:"Apple Inc."}[n.symbol]||"Asset")),y=S(()=>0===n.data.length?0:n.data[n.data.length-1].close),x=S(()=>{if(n.data.length<2)return 0;const e=n.data[0].close;return(n.data[n.data.length-1].close-e)/e*100}),_=()=>r("toggleExpand"),M=S(()=>{const e=n.data.map(e=>e.close),t=.999*Math.min(...e),a=1.001*Math.max(...e);return{animation:!0,animationDuration:300,animationEasing:"cubicOut",grid:{left:10,right:70,top:10,bottom:30,containLabel:!1},xAxis:{type:"category",data:n.data.map(e=>e.time),axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.3)",fontSize:9,interval:Math.floor(n.data.length/6),formatter:e=>e},splitLine:{show:!1}},yAxis:{type:"value",position:"right",min:t,max:a,splitNumber:6,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgba(255,255,255,0.5)",fontSize:10,fontFamily:"JetBrains Mono, monospace",formatter:e=>e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})},splitLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.05)",type:"dashed"}}},series:[{type:"line",data:e,smooth:.3,symbol:"none",lineStyle:{color:x.value>=0?"#10B981":"#EF4444",width:2,shadowColor:x.value>=0?"rgba(16, 185, 129, 0.5)":"rgba(239, 68, 68, 0.5)",shadowBlur:10},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:x.value>=0?[{offset:0,color:"rgba(16, 185, 129, 0.25)"},{offset:1,color:"rgba(16, 185, 129, 0)"}]:[{offset:0,color:"rgba(239, 68, 68, 0.25)"},{offset:1,color:"rgba(239, 68, 68, 0)"}]}},markLine:{silent:!0,symbol:"none",lineStyle:{color:x.value>=0?"#10B981":"#EF4444",type:"dashed",width:1},label:{show:!0,position:"end",formatter:y.value.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),backgroundColor:x.value>=0?"#10B981":"#EF4444",color:"#fff",padding:[4,8],borderRadius:4,fontSize:11,fontFamily:"JetBrains Mono, monospace",fontWeight:"bold"},data:[{yAxis:y.value}]},animationDuration:300,animationEasing:"cubicOut"}],tooltip:{trigger:"axis",backgroundColor:"rgba(15, 15, 20, 0.95)",borderColor:"rgba(255,255,255,0.1)",borderRadius:8,padding:[10,14],textStyle:{color:"#fff",fontSize:12,fontFamily:"JetBrains Mono, monospace"},formatter:e=>{const t=e[0];return`<div style="font-size:10px;color:#888;margin-bottom:4px">${t.name}</div>\n                <div style="font-size:14px;font-weight:bold;color:#fff">${Number(t.value).toLocaleString("en-US",{minimumFractionDigits:2})}</div>`}}}}),T=S(()=>({animation:!0,animationDuration:300,grid:{left:10,right:70,top:5,bottom:5},xAxis:{type:"category",data:n.data.map(e=>e.time),show:!1},yAxis:{type:"value",show:!1},series:[{type:"bar",data:n.data.map((e,t)=>({value:e.volume,itemStyle:{color:t>0&&n.data[t].close>=n.data[t-1].close?"rgba(16, 185, 129, 0.3)":"rgba(239, 68, 68, 0.3)",borderRadius:[2,2,0,0]}})),barWidth:"80%"}],tooltip:{show:!1}}));return R(()=>n.data,()=>{},{deep:!0}),(t,a)=>(w(),i("div",SRt,[s("div",MRt,[s("div",TRt,[s("div",kRt,[s("h2",CRt,v(e.symbol),1),s("span",{class:c(["text-xl font-bold font-mono",x.value>=0?"text-emerald-400":"text-rose-400"])},v(y.value.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),3),s("span",{class:c(["text-xs font-mono px-2 py-0.5 rounded",x.value>=0?"text-emerald-400 bg-emerald-500/10":"text-rose-400 bg-rose-500/10"])},v(x.value>=0?"+":"")+v(x.value.toFixed(2))+"% ",3)]),s("div",ARt,[s("span",ERt,v(g.value),1),a[0]||(a[0]=s("span",{class:"bg-white/5 px-2 py-0.5 rounded text-white/60 border border-white/5"},[s("span",{class:"w-1.5 h-1.5 rounded-full bg-emerald-500 inline-block mr-1 animate-pulse"}),m(" Онлайн ")],-1))])]),s("div",IRt,[s("div",RRt,[(w(),i(p,null,f(h,(e,t)=>s("button",{key:e,class:c("px-3 py-1 text-xs rounded-md transition-all "+(1===t?"bg-white/10 text-white shadow-sm":"text-gray-500 hover:text-gray-300"))},v(e),3)),64))]),_?(w(),i("button",{key:0,onClick:_,class:"p-1.5 text-gray-400 hover:text-white transition-colors hover:bg-white/10 rounded-lg"},[(w(),b(C(e.isExpanded?"MinimizeIcon":"MaximizeIcon"),{class:"w-4 h-4"}))])):l("",!0)])]),s("div",DRt,[u(O(aTt),{ref_key:"chartRef",ref:o,class:"chart",option:M.value,style:{height:"100%",width:"100%"}},null,8,["option"])]),s("div",PRt,[u(O(aTt),{ref_key:"volumeChartRef",ref:d,class:"volume-chart",option:T.value,style:{height:"100%",width:"100%"}},null,8,["option"])])]))}}),NRt=xe(LRt,[["__scopeId","data-v-97c8b43f"]]),ORt=e({__name:"ChartWidgetWrapper",props:{data:{},symbol:{},width:{default:3},height:{default:3},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,i=t(n.width),o=t(n.height),s=(e,t)=>{i.value=e,o.value=t,r("resize",e,t)};return(t,a)=>(w(),b(lRt,{title:"График цены",icon:"LineChartIcon","icon-bg":"bg-emerald-500/20","icon-color":"text-emerald-400",width:i.value,height:o.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:s},{default:h(()=>[u(NRt,{data:e.data,isExpanded:!1,symbol:e.symbol},null,8,["data","symbol"])]),_:1},8,["width","height","resizable"]))}}),FRt={class:"news-list"},BRt={class:"news-meta"},URt={class:"news-source font-mono"},zRt={class:"news-time font-mono"},VRt={class:"news-title font-oswald"},HRt=e({__name:"NewsWidget",props:{width:{default:2},height:{default:2},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,o=t(n.width),l=t(n.height),u=(e,t)=>{o.value=e,l.value=t,r("resize",e,t)},d=[{id:1,title:"Bitcoin достиг исторического максимума на фоне институционального ажиотажа",source:"Bloomberg",time:"2 мин назад",importance:"High"},{id:2,title:"Федеральная резервная система назначила экстренное заседание на понедельник",source:"Reuters",time:"15 мин назад",importance:"Critical"},{id:3,title:"NVIDIA анонсировала революционный AI-чип 'Rubin'",source:"TechCrunch",time:"42 мин назад",importance:"High"},{id:4,title:"Цены на нефть снижаются по мере небольшого ослабления напряжённости на Ближнем Востоке",source:"CNBC",time:"1 ч назад",importance:"Medium"},{id:5,title:"Apple сообщила о рекордной выручке от услуг в Q3",source:"MarketWatch",time:"2 ч назад",importance:"Medium"}];return(t,a)=>(w(),b(lRt,{title:"НОВОСТИ",icon:"NewspaperIcon","icon-bg":"icon-bg-purple","icon-color":"text-purple-500",width:o.value,height:l.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:u},{default:h(()=>[s("div",FRt,[(w(!0),i(p,null,f(d.slice(0,5),e=>{return w(),i("div",{key:e.id,class:"news-item"},[s("div",BRt,[s("span",{class:c(["news-badge font-mono",{"news-badge-critical":"Critical"===e.importance}])},v((t=e.importance,{Critical:"КРИТИЧНО",High:"ВЫСОКАЯ",Medium:"СРЕДНЯЯ"}[t]||t.toUpperCase())),3),s("span",URt,v(e.source),1),s("span",zRt,v(e.time),1)]),s("h4",VRt,v(e.title),1)]);var t}),128))])]),_:1},8,["width","height","resizable"]))}}),GRt=xe(HRt,[["__scopeId","data-v-fb8e9f0e"]]),WRt={class:"ai-panel"},qRt={class:"ai-header"},YRt={class:"ai-header-left"},jRt={class:"ai-icon"},XRt={class:"ai-content custom-scrollbar"},$Rt={key:0,class:"ai-idle"},KRt={class:"idle-icon"},ZRt={key:1,class:"ai-loading"},JRt={key:2,class:"ai-results"},QRt={class:"trend-card"},eDt={class:"trend-value"},tDt={class:"confidence-section"},aDt={class:"confidence-header font-mono"},nDt={class:"confidence-bar"},rDt={class:"reasoning-card"},iDt={class:"reasoning-text font-mono"},oDt={class:"levels-grid"},sDt={class:"level-card level-support"},lDt={class:"level-value font-mono"},cDt={class:"level-card level-resistance"},uDt={class:"level-value font-mono"},dDt=e({__name:"AIPanel",props:{data:{}},setup(e){const a=e,n=t(null),r=t(!1),o=async()=>{if(r.value)return;r.value=!0;const e=await(async e=>{try{const t=e[e.length-1]?.close||0,a=e[e.length-2]?.close||t;return{trend:t>a?"BULLISH":t<a?"BEARISH":"NEUTRAL",confidence:Math.floor(30*Math.random())+60,reasoning:"Market showing moderate volatility with potential upward momentum based on recent price action",keyLevels:{support:.95*t,resistance:1.05*t}}}catch(QXe){return console.error("AI Analysis Failed:",QXe),{trend:"NEUTRAL",confidence:0,reasoning:"AI Service Temporarily Unavailable",keyLevels:{support:0,resistance:0}}}})(a.data);n.value=e,r.value=!1},d={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="10" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>'},h={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>'},p={template:'<svg viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>'},f={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>'};return(e,t)=>(w(),i("div",WRt,[s("div",qRt,[s("div",YRt,[s("div",jRt,[u(d,{class:"w-4 h-4"})]),t[0]||(t[0]=s("span",{class:"ai-title font-oswald"},"ИИ АНАЛИТИК",-1))]),t[1]||(t[1]=s("div",{class:"ai-status font-mono"},[s("span",{class:"status-dot"}),s("span",null,"LIVE")],-1))]),s("div",XRt,[n.value||r.value?l("",!0):(w(),i("div",$Rt,[s("div",KRt,[u(h,{class:"w-6 h-6"})]),t[3]||(t[3]=s("div",{class:"idle-text"},[s("h3",{class:"font-oswald"},"ОЖИДАНИЕ КОМАНДЫ"),s("p",{class:"font-mono"},"Анализ рыночных данных для определения трендов и ключевых уровней.")],-1)),s("button",{onClick:o,class:"ai-btn font-oswald"},[u(p,{class:"w-3.5 h-3.5"}),t[2]||(t[2]=m(" ЗАПУСТИТЬ АНАЛИЗ ",-1))])])),r.value?(w(),i("div",ZRt,[...t[4]||(t[4]=[s("div",{class:"loading-spinner"},null,-1),s("span",{class:"font-mono"},"ОБРАБОТКА РЫНОЧНЫХ ДАННЫХ...",-1)])])):l("",!0),n.value?(w(),i("div",JRt,[s("div",QRt,[t[6]||(t[6]=s("span",{class:"trend-label font-mono"},"СИГНАЛ",-1)),s("div",eDt,[s("h2",{class:c(["trend-text font-anton",{"trend-bullish":"BULLISH"===n.value.trend,"trend-bearish":"BEARISH"===n.value.trend}])},v(n.value.trend),3)]),s("div",tDt,[s("div",aDt,[t[5]||(t[5]=s("span",null,"УВЕРЕННОСТЬ",-1)),s("span",null,v(n.value.confidence)+"%",1)]),s("div",nDt,[s("div",{class:c(["confidence-fill",{high:n.value.confidence>70}]),style:y({width:`${n.value.confidence}%`})},null,6)])])]),s("div",rDt,[t[7]||(t[7]=s("div",{class:"reasoning-header"},[s("div",{class:"reasoning-indicator"}),s("span",{class:"font-mono"},"АНАЛИЗ")],-1)),s("p",iDt,v(n.value.reasoning),1)]),s("div",oDt,[s("div",sDt,[t[8]||(t[8]=s("span",{class:"level-label font-mono"},"ПОДДЕРЖКА",-1)),s("span",lDt,v(n.value.keyLevels.support.toFixed(2)),1)]),s("div",cDt,[t[9]||(t[9]=s("span",{class:"level-label font-mono"},"СОПРОТИВЛЕНИЕ",-1)),s("span",uDt,v(n.value.keyLevels.resistance.toFixed(2)),1)])]),s("button",{onClick:o,class:"refresh-btn font-mono"},[u(f,{class:"w-3 h-3"}),t[10]||(t[10]=m(" ОБНОВИТЬ АНАЛИЗ ",-1))])])):l("",!0)])]))}}),hDt=xe(dDt,[["__scopeId","data-v-de15b4e2"]]),pDt=e({__name:"AIWidget",props:{data:{},width:{default:2},height:{default:2},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,i=t(n.width),o=t(n.height),s=(e,t)=>{i.value=e,o.value=t,r("resize",e,t)};return(t,a)=>(w(),b(lRt,{title:"ИИ АНАЛИТИК",icon:"BrainIcon","icon-bg":"icon-bg-purple","icon-color":"text-purple-500",width:i.value,height:o.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:s},{default:h(()=>[u(hDt,{data:e.data},null,8,["data"])]),_:1},8,["width","height","resizable"]))}}),fDt={class:"h-full bg-transparent flex flex-col flex-shrink-0"},mDt=e({__name:"FooterPanel",setup:e=>(e,t)=>(w(),i("div",fDt,[...t[0]||(t[0]=[I('<div class="flex border-b border-white/5 px-2"><button class="px-2 py-1.5 text-xs font-bold text-white border-b-2 border-indigo-500 bg-white/5">Открытые (2)</button><button class="px-2 py-1.5 text-xs font-medium text-gray-500 hover:text-white transition-colors">История</button><button class="px-2 py-1.5 text-xs font-medium text-gray-500 hover:text-white transition-colors">Позиции</button></div><div class="flex-1 overflow-x-hidden overflow-y-auto custom-scrollbar"><table class="w-full text-left border-collapse table-fixed"><thead><tr class="text-[8px] text-gray-500 border-b border-white/5"><th class="font-normal py-1.5 px-1.5 w-[10%]">Время</th><th class="font-normal py-1.5 px-1.5 w-[12%]">Актив</th><th class="font-normal py-1.5 px-1.5 w-[8%]">Тип</th><th class="font-normal py-1.5 px-1.5 w-[12%]">Напр.</th><th class="font-normal py-1.5 px-1.5 w-[14%]">Цена</th><th class="font-normal py-1.5 px-1.5 w-[12%]">Объём</th><th class="font-normal py-1.5 px-1.5 w-[10%]">Исп.</th><th class="font-normal py-1.5 px-1.5 w-[12%]">Итого</th><th class="font-normal py-1.5 px-1.5 text-right w-[10%]">Дейст.</th></tr></thead><tbody class="text-[9px] font-mono text-gray-300"><tr class="border-b border-white/5 hover:bg-white/5 transition-colors group"><td class="py-1.5 px-1.5 text-gray-500">12:30:45</td><td class="py-1.5 px-1.5 font-bold text-white">BTC/USDT</td><td class="py-1.5 px-1.5">Лимит</td><td class="py-1.5 px-1.5 text-emerald-400 font-bold">Покупка</td><td class="py-1.5 px-1.5">63,200</td><td class="py-1.5 px-1.5">0.05</td><td class="py-1.5 px-1.5">0%</td><td class="py-1.5 px-1.5">3,160</td><td class="py-1.5 px-1.5 text-right"><button class="text-gray-500 hover:text-rose-400 transition-colors opacity-0 group-hover:opacity-100 text-[8px]">Отменить</button></td></tr><tr class="border-b border-white/5 hover:bg-white/5 transition-colors group"><td class="py-1.5 px-1.5 text-gray-500">11:15:22</td><td class="py-1.5 px-1.5 font-bold text-white">ETH/USDT</td><td class="py-1.5 px-1.5">Лимит</td><td class="py-1.5 px-1.5 text-rose-400 font-bold">Продажа</td><td class="py-1.5 px-1.5">2,850</td><td class="py-1.5 px-1.5">1.20</td><td class="py-1.5 px-1.5">12.5%</td><td class="py-1.5 px-1.5">3,420</td><td class="py-1.5 px-1.5 text-right"><button class="text-gray-500 hover:text-rose-400 transition-colors opacity-0 group-hover:opacity-100 text-[8px]">Отменить</button></td></tr></tbody></table></div>',2)])]))}),vDt=e({__name:"FooterWidget",props:{width:{default:3},height:{default:1},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,i=t(n.width),o=t(n.height),s=(e,t)=>{i.value=e,o.value=t,r("resize",e,t)};return(t,a)=>(w(),b(lRt,{title:"Ордера и позиции",icon:"ListIcon","icon-bg":"bg-orange-500/20","icon-color":"text-orange-400",width:i.value,height:o.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:s},{default:h(()=>[u(mDt)]),_:1},8,["width","height","resizable"]))}}),gDt={class:"p-4 space-y-2"},yDt=["onClick"],bDt={class:"flex items-center gap-3"},xDt={class:"text-sm font-bold text-white"},wDt={class:"text-xs text-gray-500"},_Dt={class:"text-right"},SDt={class:"text-sm font-mono text-white"},MDt=e({__name:"MarketsWidget",props:{width:{default:2},height:{default:3},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize","assetClick"],setup(e,{emit:a}){const n=e,r=a,o=t(n.width),l=t(n.height),u=(e,t)=>{o.value=e,l.value=t,r("resize",e,t)},d=[{name:"Apple Inc.",symbol:"AAPL",price:"173.50",change:"+1.20%",category:"Equities"},{name:"NVIDIA Corp",symbol:"NVDA",price:"892.10",change:"+4.25%",category:"Equities"},{name:"Microsoft",symbol:"MSFT",price:"420.55",change:"-0.45%",category:"Equities"},{name:"Tesla Inc",symbol:"TSLA",price:"175.30",change:"+2.10%",category:"Equities"},{name:"Bitcoin",symbol:"BTC/USDT",price:"64,230.50",change:"+2.45%",category:"Crypto"},{name:"Ethereum",symbol:"ETH/USDT",price:"3,450.20",change:"-1.12%",category:"Crypto"},{name:"Amazon",symbol:"AMZN",price:"180.25",change:"+0.95%",category:"Equities"},{name:"Meta Platforms",symbol:"META",price:"495.10",change:"+1.85%",category:"Equities"}];return(t,a)=>(w(),b(lRt,{title:"Рынки",icon:"TrendingUpIcon","icon-bg":"bg-green-500/20","icon-color":"text-green-400",width:o.value,height:l.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:u},{default:h(()=>[s("div",gDt,[(w(!0),i(p,null,f(d.slice(0,8),e=>{return w(),i("div",{key:e.symbol,class:"flex items-center justify-between p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors cursor-pointer",onClick:a=>t.$emit("assetClick",e)},[s("div",bDt,[s("div",{class:c("w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold "+(a=e.category,"Crypto"===a?"bg-gradient-to-br from-yellow-500/20 to-orange-500/20 text-yellow-300":"bg-gradient-to-br from-indigo-500/20 to-purple-500/20 text-indigo-300"))},v(e.symbol.substring(0,2)),3),s("div",null,[s("div",xDt,v(e.symbol),1),s("div",wDt,v(e.name),1)])]),s("div",_Dt,[s("div",SDt,v(e.price),1),s("div",{class:c("text-xs font-bold "+(e.change.startsWith("+")?"text-emerald-400":"text-rose-400"))},v(e.change),3)])],8,yDt);var a}),128))])]),_:1},8,["width","height","resizable"]))}}),TDt=e({__name:"AnalyticsWidget",props:{width:{default:2},height:{default:2},resizable:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,i=t(n.width),o=t(n.height),l=(e,t)=>{i.value=e,o.value=t,r("resize",e,t)};return(t,a)=>(w(),b(lRt,{title:"Аналитика",icon:"BarChartIcon","icon-bg":"bg-cyan-500/20","icon-color":"text-cyan-400",width:i.value,height:o.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:l},{default:h(()=>[...a[2]||(a[2]=[s("div",{class:"p-4 space-y-4"},[s("div",{class:"grid grid-cols-2 gap-3"},[s("div",{class:"p-3 rounded-xl bg-white/5 border border-white/5 text-center"},[s("div",{class:"text-xs text-gray-400 uppercase mb-1"},"Настроение"),s("div",{class:"text-xl font-bold text-emerald-400"},"Бычье")]),s("div",{class:"p-3 rounded-xl bg-white/5 border border-white/5 text-center"},[s("div",{class:"text-xs text-gray-400 uppercase mb-1"},"Уверенность"),s("div",{class:"text-xl font-bold text-white"},"87%")])]),s("div",{class:"p-3 rounded-xl bg-white/5 border border-white/5"},[s("div",{class:"text-xs text-gray-400 uppercase mb-2"},"Волатильность"),s("div",{class:"text-lg font-bold text-white"},"Высокая")])],-1)])]),_:1},8,["width","height","resizable"]))}}),kDt={class:"p-4 flex flex-col items-center justify-center h-full"},CDt={class:"text-lg font-bold text-white mb-2 text-center"},ADt={class:"text-sm text-gray-400 text-center mb-4"},EDt={class:"px-3 py-1 rounded-lg bg-white/5 border border-white/10"},IDt={class:"text-xs font-mono text-gray-400"},RDt={key:0,class:"mt-4 px-3 py-1 rounded-lg bg-emerald-500/10 border border-emerald-500/20"},DDt={class:"text-xs text-emerald-400"},PDt={key:1,class:"mt-4 text-xs text-gray-500 text-center"},LDt=e({__name:"QuantitativeToolWidget",props:{type:{},title:{default:"Инструмент"},description:{default:"Инструмент количественного анализа"},icon:{default:"ActivityIcon"},iconBg:{default:"bg-emerald-500/20"},iconColor:{default:"text-emerald-400"},code:{default:""},width:{default:3},height:{default:3},resizable:{type:Boolean,default:!0},selectedAsset:{default:""}},emits:["settings","remove","resize"],setup(e,{emit:a}){const n=e,r=a,o=t(n.width),l=t(n.height),u=(e,t)=>{o.value=e,l.value=t,r("resize",e,t)},d={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'},p={ActivityIcon:d,LayersIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>'},TargetIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>'},BarChart2Icon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>'},PieChartIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>'},ChartBarIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/></svg>'},TableCellsIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3h18v18H3z"/><path d="M3 9h18M3 15h18M9 3v18M15 3v18"/></svg>'},ShareIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>'},TrendingDownIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></svg>'},Squares2X2Icon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>'},Bars3Icon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>'},BarChart3Icon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="20" x2="12" y2="10"/><line x1="18" y1="20" x2="18" y2="4"/><line x1="6" y1="20" x2="6" y2="16"/><line x1="3" y1="20" x2="21" y2="20"/></svg>'},ScatterIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="7" cy="7" r="2"/><circle cx="17" cy="7" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></svg>'},TrendingUpIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>'},LineChartIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 3 7 9 12 5 15 9 21 3"/><polyline points="3 21 7 15 12 19 15 15 21 21"/></svg>'}},f=S(()=>p[n.icon]||d);return(t,a)=>(w(),b(lRt,{title:e.title,icon:e.icon,"icon-bg":e.iconBg,"icon-color":e.iconColor,width:o.value,height:l.value,resizable:e.resizable,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:u},{default:h(()=>[s("div",kDt,[(w(),b(C(f.value),{class:c(`w-16 h-16 ${e.iconColor} opacity-50 mb-4`)},null,8,["class"])),s("h4",CDt,v(e.title),1),s("p",ADt,v(e.description),1),s("div",EDt,[s("span",IDt,"Код: "+v(e.code),1)]),e.selectedAsset?(w(),i("div",RDt,[s("span",DDt,"Актив: "+v(e.selectedAsset),1)])):(w(),i("div",PDt," Выберите актив для анализа "))])]),_:1},8,["title","icon","icon-bg","icon-color","width","height","resizable"]))}});var NDt=KKe.CMD;function ODt(e,t){return Math.abs(e-t)<1e-5}function FDt(e){var t,a,n,r,i,o=e.data,s=e.len(),l=[],c=0,u=0,d=0,h=0;function p(e,a){t&&t.length>2&&l.push(t),t=[e,a]}function f(e,a,n,r){ODt(e,n)&&ODt(a,r)||t.push(e,a,n,r,n,r)}function m(e,a,n,r,i,o){var s=Math.abs(a-e),l=4*Math.tan(s/4)/3,c=a<e?-1:1,u=Math.cos(e),d=Math.sin(e),h=Math.cos(a),p=Math.sin(a),f=u*i+n,m=d*o+r,v=h*i+n,g=p*o+r,y=i*l*c,b=o*l*c;t.push(f-y*d,m+b*u,v+y*p,g-b*h,v,g)}for(var v=0;v<s;){var g=o[v++],y=1===v;switch(y&&(d=c=o[v],h=u=o[v+1],g!==NDt.L&&g!==NDt.C&&g!==NDt.Q||(t=[d,h])),g){case NDt.M:c=d=o[v++],u=h=o[v++],p(d,h);break;case NDt.L:f(c,u,a=o[v++],n=o[v++]),c=a,u=n;break;case NDt.C:t.push(o[v++],o[v++],o[v++],o[v++],c=o[v++],u=o[v++]);break;case NDt.Q:a=o[v++],n=o[v++],r=o[v++],i=o[v++],t.push(c+2/3*(a-c),u+2/3*(n-u),r+2/3*(a-r),i+2/3*(n-i),r,i),c=r,u=i;break;case NDt.A:var b=o[v++],x=o[v++],w=o[v++],_=o[v++],S=o[v++],M=o[v++]+S;v+=1;var T=!o[v++];a=Math.cos(S)*w+b,n=Math.sin(S)*_+x,y?p(d=a,h=n):f(c,u,a,n),c=Math.cos(M)*w+b,u=Math.sin(M)*_+x;for(var k=(T?-1:1)*Math.PI/2,C=S;T?C>M:C<M;C+=k){m(C,T?Math.max(C+k,M):Math.min(C+k,M),b,x,w,_)}break;case NDt.R:d=c=o[v++],h=u=o[v++],a=d+o[v++],n=h+o[v++],p(a,h),f(a,h,a,n),f(a,n,d,n),f(d,n,d,h),f(d,h,a,h);break;case NDt.Z:t&&f(c,u,d,h),c=d,u=h}}return t&&t.length>2&&l.push(t),l}function BDt(e,t,a,n,r,i,o,s,l,c){if(ODt(e,a)&&ODt(t,n)&&ODt(r,o)&&ODt(i,s))l.push(o,s);else{var u=2/c,d=u*u,h=o-e,p=s-t,f=Math.sqrt(h*h+p*p);h/=f,p/=f;var m=a-e,v=n-t,g=r-o,y=i-s,b=m*m+v*v,x=g*g+y*y;if(b<d&&x<d)l.push(o,s);else{var w=h*m+p*v,_=-h*g-p*y;if(b-w*w<d&&w>=0&&x-_*_<d&&_>=0)l.push(o,s);else{var S=[],M=[];aYe(e,a,r,o,.5,S),aYe(t,n,i,s,.5,M),BDt(S[0],M[0],S[1],M[1],S[2],M[2],S[3],M[3],l,c),BDt(S[4],M[4],S[5],M[5],S[6],M[6],S[7],M[7],l,c)}}}}function UDt(e,t,a){var n=e[t],r=e[1-t],i=Math.abs(n/r),o=Math.ceil(Math.sqrt(i*a)),s=Math.floor(a/o);0===s&&(s=1,o=a);for(var l=[],c=0;c<o;c++)l.push(s);var u=a-o*s;if(u>0)for(c=0;c<u;c++)l[c%o]+=1;return l}function zDt(e,t,a){for(var n=e.r0,r=e.r,i=e.startAngle,o=e.endAngle,s=Math.abs(o-i),l=s*r,c=r-n,u=l>Math.abs(c),d=UDt([l,c],u?0:1,t),h=(u?s:c)/d.length,p=0;p<d.length;p++)for(var f=(u?c:s)/d[p],m=0;m<d[p];m++){var v={};u?(v.startAngle=i+h*p,v.endAngle=i+h*(p+1),v.r0=n+f*m,v.r=n+f*(m+1)):(v.startAngle=i+f*m,v.endAngle=i+f*(m+1),v.r0=n+h*p,v.r=n+h*(p+1)),v.clockwise=e.clockwise,v.cx=e.cx,v.cy=e.cy,a.push(v)}}function VDt(e,t,a,n){return e*n-a*t}function HDt(e,t,a,n,r,i,o,s){var l=a-e,c=n-t,u=o-r,d=s-i,h=VDt(u,d,l,c);if(Math.abs(h)<1e-6)return null;var p=VDt(e-r,t-i,u,d)/h;return p<0||p>1?null:new eqe(p*l+e,p*c+t)}function GDt(e,t,a){var n=new eqe;eqe.sub(n,a,t),n.normalize();var r=new eqe;return eqe.sub(r,e,t),r.dot(n)}function WDt(e,t){var a=e[e.length-1];a&&a[0]===t[0]&&a[1]===t[1]||e.push(t)}function qDt(e){var t=e.points,a=[],n=[];TKe(t,a,n);var r=new fqe(a[0],a[1],n[0]-a[0],n[1]-a[1]),i=r.width,o=r.height,s=r.x,l=r.y,c=new eqe,u=new eqe;return i>o?(c.x=u.x=s+i/2,c.y=l,u.y=l+o):(c.y=u.y=l+o/2,c.x=s,u.x=s+i),function(e,t,a){for(var n=e.length,r=[],i=0;i<n;i++){var o=e[i],s=e[(i+1)%n],l=HDt(o[0],o[1],s[0],s[1],t.x,t.y,a.x,a.y);l&&r.push({projPt:GDt(l,t,a),pt:l,idx:i})}if(r.length<2)return[{points:e},{points:e}];r.sort(function(e,t){return e.projPt-t.projPt});var c=r[0],u=r[r.length-1];if(u.idx<c.idx){var d=c;c=u,u=d}var h=[c.pt.x,c.pt.y],p=[u.pt.x,u.pt.y],f=[h],m=[p];for(i=c.idx+1;i<=u.idx;i++)WDt(f,e[i].slice());for(WDt(f,p),WDt(f,h),i=u.idx+1;i<=c.idx+n;i++)WDt(m,e[i%n].slice());return WDt(m,h),WDt(m,p),[{points:f},{points:m}]}(t,c,u)}function YDt(e,t,a,n){if(1===a)n.push(t);else{var r=Math.floor(a/2),i=e(t);YDt(e,i[0],r,n),YDt(e,i[1],a-r,n)}return n}function jDt(e,t){t.setStyle(e.style),t.z=e.z,t.z2=e.z2,t.zlevel=e.zlevel}function XDt(e,t){var a,n=[],r=e.shape;switch(e.type){case"rect":!function(e,t,a){for(var n=e.width,r=e.height,i=n>r,o=UDt([n,r],i?0:1,t),s=i?"width":"height",l=i?"height":"width",c=i?"x":"y",u=i?"y":"x",d=e[s]/o.length,h=0;h<o.length;h++)for(var p=e[l]/o[h],f=0;f<o[h];f++){var m={};m[c]=h*d,m[u]=f*p,m[s]=d,m[l]=p,m.x+=e.x,m.y+=e.y,a.push(m)}}(r,t,n),a=EZe;break;case"sector":zDt(r,t,n),a=EQe;break;case"circle":zDt({r0:0,r:r.r,startAngle:0,endAngle:2*Math.PI,cx:r.cx,cy:r.cy},t,n),a=EQe;break;default:var i=e.getComputedTransform(),o=i?Math.sqrt(Math.max(i[0]*i[0]+i[1]*i[1],i[2]*i[2]+i[3]*i[3])):1,s=yGe(function(e,t){var a=FDt(e),n=[];t=t||1;for(var r=0;r<a.length;r++){var i=a[r],o=[],s=i[0],l=i[1];o.push(s,l);for(var c=2;c<i.length;){var u=i[c++],d=i[c++],h=i[c++],p=i[c++],f=i[c++],m=i[c++];BDt(s,l,u,d,h,p,f,m,o,t),s=f,l=m}n.push(o)}return n}(e.getUpdatedPathProxy(),o),function(e){return function(e){for(var t=[],a=0;a<e.length;)t.push([e[a++],e[a++]]);return t}(e)}),l=s.length;if(0===l)YDt(qDt,{points:s[0]},t,n);else if(l===t)for(var c=0;c<l;c++)n.push({points:s[c]});else{var u=0,d=yGe(s,function(e){var t=[],a=[];TKe(e,t,a);var n=(a[1]-t[1])*(a[0]-t[0]);return u+=n,{poly:e,area:n}});d.sort(function(e,t){return t.area-e.area});var h=t;for(c=0;c<l;c++){var p=d[c];if(h<=0)break;var f=c===l-1?h:Math.ceil(p.area/u*t);f<0||(YDt(qDt,{points:p.poly},f,n),h-=f)}}a=LQe}if(!a)return function(e,t){for(var a=[],n=0;n<t;n++)a.push(uQe(e));return a}(e,t);var m=[];for(c=0;c<n.length;c++){var v=new a;v.setShape(n[c]),jDt(e,v),m.push(v)}return m}function $Dt(e,t){var a=e.length,n=t.length;if(a===n)return[e,t];for(var r=[],i=[],o=a<n?e:t,s=Math.min(a,n),l=Math.abs(n-a)/6,c=(s-2)/6,u=Math.ceil(l/c)+1,d=[o[0],o[1]],h=l,p=2;p<s;){var f=o[p-2],m=o[p-1],v=o[p++],g=o[p++],y=o[p++],b=o[p++],x=o[p++],w=o[p++];if(h<=0)d.push(v,g,y,b,x,w);else{for(var _=Math.min(h,u-1)+1,S=1;S<=_;S++){var M=S/_;aYe(f,v,y,x,M,r),aYe(m,g,b,w,M,i),f=r[3],m=i[3],d.push(r[1],i[1],r[2],i[2],f,m),v=r[5],g=i[5],y=r[6],b=i[6]}h-=_-1}}return o===e?[d,t]:[e,d]}function KDt(e,t){for(var a=e.length,n=e[a-2],r=e[a-1],i=[],o=0;o<t.length;)i[o++]=n,i[o++]=r;return i}function ZDt(e){for(var t=0,a=0,n=0,r=e.length,i=0,o=r-2;i<r;o=i,i+=2){var s=e[o],l=e[o+1],c=e[i],u=e[i+1],d=s*u-c*l;t+=d,a+=(s+c)*d,n+=(l+u)*d}return 0===t?[e[0]||0,e[1]||0]:[a/t/3,n/t/3,t]}function JDt(e,t,a,n){for(var r=(e.length-2)/6,i=1/0,o=0,s=e.length,l=s-2,c=0;c<r;c++){for(var u=6*c,d=0,h=0;h<s;h+=2){var p=0===h?u:(u+h-2)%l+2,f=e[p]-a[0],m=e[p+1]-a[1],v=t[h]-n[0]-f,g=t[h+1]-n[1]-m;d+=v*v+g*g}d<i&&(i=d,o=c)}return o}function QDt(e){for(var t=[],a=e.length,n=0;n<a;n+=2)t[n]=e[a-n-2],t[n+1]=e[a-n-1];return t}function ePt(e){return e.__isCombineMorphing}var tPt="__mOriginal_";function aPt(e,t,a){var n=tPt+t,r=e[n]||e[t];e[n]||(e[n]=e[t]);var i=a.replace,o=a.after,s=a.before;e[t]=function(){var e,t=arguments;return s&&s.apply(this,t),e=i?i.apply(this,t):r.apply(this,t),o&&o.apply(this,t),e}}function nPt(e,t){var a=tPt+t;e[a]&&(e[t]=e[a],e[a]=null)}function rPt(e,t){for(var a=0;a<e.length;a++)for(var n=e[a],r=0;r<n.length;){var i=n[r],o=n[r+1];n[r++]=t[0]*i+t[2]*o+t[4],n[r++]=t[1]*i+t[3]*o+t[5]}}function iPt(e,t){var a=e.getUpdatedPathProxy(),n=t.getUpdatedPathProxy(),r=function(e,t){for(var a,n,r,i=[],o=[],s=0;s<Math.max(e.length,t.length);s++){var l=e[s],c=t[s],u=void 0,d=void 0;l?c?(n=u=(a=$Dt(l,c))[0],r=d=a[1]):(d=KDt(r||l,l),u=l):(u=KDt(n||c,c),d=c),i.push(u),o.push(d)}return[i,o]}(FDt(a),FDt(n)),i=r[0],o=r[1],s=e.getComputedTransform(),l=t.getComputedTransform();s&&rPt(i,s),l&&rPt(o,l),aPt(t,"updateTransform",{replace:function(){this.transform=null}}),t.transform=null;var c=function(e,t,a,n){for(var r,i=[],o=0;o<e.length;o++){var s=e[o],l=t[o],c=ZDt(s),u=ZDt(l);null==r&&(r=c[2]<0!=u[2]<0);var d=[],h=[],p=0,f=1/0,m=[],v=s.length;r&&(s=QDt(s));for(var g=6*JDt(s,l,c,u),y=v-2,b=0;b<y;b+=2){var x=(g+b)%y+2;d[b+2]=s[x]-c[0],d[b+3]=s[x+1]-c[1]}d[0]=s[g]-c[0],d[1]=s[g+1]-c[1];for(var w=n/a,_=-n/2;_<=n/2;_+=w){var S=Math.sin(_),M=Math.cos(_),T=0;for(b=0;b<s.length;b+=2){var k=d[b],C=d[b+1],A=l[b]-u[0],E=l[b+1]-u[1],I=A*M-E*S,R=A*S+E*M;m[b]=I,m[b+1]=R;var D=I-k,P=R-C;T+=D*D+P*P}if(T<f){f=T,p=_;for(var L=0;L<m.length;L++)h[L]=m[L]}}i.push({from:d,to:h,fromCp:c,toCp:u,rotation:-p})}return i}(i,o,10,Math.PI),u=[];aPt(t,"buildPath",{replace:function(e){for(var a=t.__morphT,n=1-a,r=[],i=0;i<c.length;i++){var o=c[i],s=o.from,l=o.to,d=o.rotation*a,h=o.fromCp,p=o.toCp,f=Math.sin(d),m=Math.cos(d);mWe(r,h,p,a);for(var v=0;v<s.length;v+=2){var g=s[v],y=s[v+1],b=g*n+(S=l[v])*a,x=y*n+(M=l[v+1])*a;u[v]=b*m-x*f+r[0],u[v+1]=b*f+x*m+r[1]}var w=u[0],_=u[1];e.moveTo(w,_);for(v=2;v<s.length;){var S=u[v++],M=u[v++],T=u[v++],k=u[v++],C=u[v++],A=u[v++];w===S&&_===M&&T===C&&k===A?e.lineTo(C,A):e.bezierCurveTo(S,M,T,k,C,A),w=C,_=A}}}})}function oPt(e,t,a){if(!e||!t)return t;var n=a.done,r=a.during;return iPt(e,t),t.__morphT=0,t.animateTo({__morphT:1},pGe({during:function(e){t.dirtyShape(),r&&r(e)},done:function(){nPt(t,"buildPath"),nPt(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape(),n&&n()}},a)),t}function sPt(e,t,a,n,r,i){e=r===a?0:Math.round(32767*(e-a)/(r-a)),t=i===n?0:Math.round(32767*(t-n)/(i-n));for(var o,s=0,l=32768;l>0;l/=2){var c=0,u=0;(e&l)>0&&(c=1),(t&l)>0&&(u=1),s+=l*l*(3*c^u),0===u&&(1===c&&(e=l-1-e,t=l-1-t),o=e,e=t,t=o)}return s}function lPt(e){var t=1/0,a=1/0,n=-1/0,r=-1/0,i=yGe(e,function(e){var i=e.getBoundingRect(),o=e.getComputedTransform(),s=i.x+i.width/2+(o?o[4]:0),l=i.y+i.height/2+(o?o[5]:0);return t=Math.min(s,t),a=Math.min(l,a),n=Math.max(s,n),r=Math.max(l,r),[s,l]});return yGe(i,function(i,o){return{cp:i,z:sPt(i[0],i[1],t,a,n,r),path:e[o]}}).sort(function(e,t){return e.z-t.z}).map(function(e){return e.path})}function cPt(e){return XDt(e.path,e.count)}function uPt(e){return TGe(e[0])}function dPt(e,t){for(var a=[],n=e.length,r=0;r<n;r++)a.push({one:e[r],many:[]});for(r=0;r<t.length;r++){var i=t[r].length,o=void 0;for(o=0;o<i;o++)a[o%n].many.push(t[r][o])}var s=0;for(r=n-1;r>=0;r--)if(!a[r].many.length){var l=a[s].many;if(l.length<=1){if(!s)return a;s=0}i=l.length;var c=Math.ceil(i/2);a[r].many=l.slice(c,i),a[s].many=l.slice(0,c),s++}return a}var hPt={clone:function(e){for(var t=[],a=1-Math.pow(1-e.path.style.opacity,1/e.count),n=0;n<e.count;n++){var r=uQe(e.path);r.setStyle("opacity",a),t.push(r)}return t},split:null};function pPt(e,t,a,n,r,i){if(e.length&&t.length){var o=l0e("update",n,r);if(o&&o.duration>0){var s,l,c=n.getModel("universalTransition").get("delay"),u=Object.assign({setToFinal:!0},o);uPt(e)&&(s=e,l=t),uPt(t)&&(s=t,l=e);for(var d=s?s===e:e.length>t.length,h=s?dPt(l,s):dPt(d?t:e,[d?e:t]),p=0,f=0;f<h.length;f++)p+=h[f].many.length;var m=0;for(f=0;f<h.length;f++)v(h[f],d,m,p),m+=h[f].many.length}}function v(e,t,n,r,o){var s=e.many,l=e.one;if(1!==s.length||o)for(var d=pGe({dividePath:hPt[a],individualDelay:c&&function(e,t,a,i){return c(e+n,r)}},u),h=t?function(e,t,a){var n=[];!function e(t){for(var a=0;a<t.length;a++){var r=t[a];ePt(r)?e(r.childrenRef()):r instanceof gZe&&n.push(r)}}(e);var r=n.length;if(!r)return{fromIndividuals:[],toIndividuals:[],count:0};var i=(a.dividePath||cPt)({path:t,count:r});if(i.length!==r)return console.error("Invalid morphing: unmatched splitted path"),{fromIndividuals:[],toIndividuals:[],count:0};n=lPt(n),i=lPt(i);for(var o=a.done,s=a.during,l=a.individualDelay,c=new Xje,u=0;u<r;u++){var d=n[u],h=i[u];h.parent=t,h.copyTransform(c),l||iPt(d,h)}function p(e){for(var t=0;t<i.length;t++)i[t].addSelfToZr(e)}function f(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,nPt(t,"addSelfToZr"),nPt(t,"removeSelfFromZr")}t.__isCombineMorphing=!0,t.childrenRef=function(){return i},aPt(t,"addSelfToZr",{after:function(e){p(e)}}),aPt(t,"removeSelfFromZr",{after:function(e){for(var t=0;t<i.length;t++)i[t].removeSelfFromZr(e)}});var m=i.length;if(l){var v=m,g=function(){0===--v&&(f(),o&&o())};for(u=0;u<m;u++){var y=l?pGe({delay:(a.delay||0)+l(u,m,n[u],i[u]),done:g},a):a;oPt(n[u],i[u],y)}}else t.__morphT=0,t.animateTo({__morphT:1},pGe({during:function(e){for(var a=0;a<m;a++){var n=i[a];n.__morphT=t.__morphT,n.dirtyShape()}s&&s(e)},done:function(){f();for(var t=0;t<e.length;t++)nPt(e[t],"updateTransform");o&&o()}},a));return t.__zr&&p(t.__zr),{fromIndividuals:n,toIndividuals:i,count:m}}(s,l,d):function(e,t,a){var n=t.length,r=[],i=a.dividePath||cPt;if(ePt(e)){!function e(t){for(var a=0;a<t.length;a++){var n=t[a];ePt(n)?e(n.childrenRef()):n instanceof gZe&&r.push(n)}}(e.childrenRef());var o=r.length;if(o<n)for(var s=0,l=o;l<n;l++)r.push(uQe(r[s++%o]));r.length=n}else{r=i({path:e,count:n});var c=e.getComputedTransform();for(l=0;l<r.length;l++)r[l].setLocalTransform(c);if(r.length!==n)return console.error("Invalid morphing: unmatched splitted path"),{fromIndividuals:[],toIndividuals:[],count:0}}r=lPt(r),t=lPt(t);var u=a.individualDelay;for(l=0;l<n;l++){var d=u?pGe({delay:(a.delay||0)+u(l,n,r[l],t[l])},a):a;oPt(r[l],t[l],d)}return{fromIndividuals:r,toIndividuals:t,count:t.length}}(l,s,d),p=h.fromIndividuals,f=h.toIndividuals,m=p.length,g=0;g<m;g++){y=c?pGe({delay:c(g,m)},u):u;i(p[g],f[g],t?s[g]:e.one,t?e.one:s[g],y)}else{var y,b=t?s[0]:l,x=t?l:s[0];if(ePt(b))v({many:[b],one:x},!0,n,r,!0);else oPt(b,x,y=c?pGe({delay:c(n,r)},u):u),i(b,x,b,x,y)}}}function fPt(e){if(!e)return[];if(TGe(e)){for(var t=[],a=0;a<e.length;a++)t.push(fPt(e[a]));return t}var n=[];return e.traverse(function(e){e instanceof gZe&&!e.disableMorphing&&!e.invisible&&!e.ignore&&n.push(e)}),n}var mPt=v$e();function vPt(e,t,a,n){var r=function(e,t){for(var a=e.dimensions,n=0;n<a.length;n++){var r=e.getDimensionInfo(a[n]);if(r&&0===r.otherDims[t])return a[n]}}(e,n?"itemChildGroupId":"itemGroupId");if(r){var i=function(e,t,a){var n=e.getDimensionInfo(a),r=n&&n.ordinalMeta;if(n){var i=e.get(n.name,t);return r&&r.categories[i]||i+""}}(e,t,r);return i}var o=e.getRawDataItem(t),s=n?"childGroupId":"groupId";return o&&o[s]?o[s]+"":n?void 0:a||e.getId(t)}function gPt(e){var t=[];return gGe(e,function(e){var a=e.data,n=e.dataGroupId;if(!(a.count()>1e4))for(var r=a.getIndices(),i=0;i<r.length;i++)t.push({data:a,groupId:vPt(a,i,n,!1),childGroupId:vPt(a,i,n,!0),divide:e.divide,dataIndex:i})}),t}function yPt(e,t,a){e.traverse(function(e){e instanceof gZe&&d0e(e,{style:{opacity:0}},t,{dataIndex:a,isFrom:!0})})}function bPt(e){if(e.parent){var t=e.getComputedTransform();e.setLocalTransform(t),e.parent.remove(e)}}function xPt(e){e.stopAnimation(),e.isGroup&&e.traverse(function(e){e.stopAnimation()})}function wPt(e,t,a){var n=l0e("update",a,t);n&&e.traverse(function(e){if(e instanceof fKe){var t=function(e){return s0e(e).oldStyle}(e);t&&e.animateFrom({style:t},n)}})}function _Pt(e,t,a){var n=gPt(e),r=gPt(t);function i(e,t,a,n,r){(a||e)&&t.animateFrom({style:a&&a!==e?hGe(hGe({},a.style),e.style):e.style},r)}var o=!1,s=0,l=$Ge(),c=$Ge();n.forEach(function(e){e.groupId&&l.set(e.groupId,!0),e.childGroupId&&c.set(e.childGroupId,!0)});for(var u=0;u<r.length;u++){var d=r[u].groupId;if(c.get(d)){s=1;break}var h=r[u].childGroupId;if(h&&l.get(h)){s=2;break}}function p(e,t){return function(a){var n=a.data,r=a.dataIndex;return t?n.getId(r):e?1===s?a.childGroupId:a.groupId:2===s?a.childGroupId:a.groupId}}var f=function(e,t){var a=e.length;if(a!==t.length)return!1;for(var n=0;n<a;n++){var r=e[n],i=t[n];if(r.data.getId(r.dataIndex)!==i.data.getId(i.dataIndex))return!1}return!0}(n,r),m={};if(!f)for(u=0;u<r.length;u++){var v=r[u],g=v.data.getItemGraphicEl(v.dataIndex);g&&(m[g.id]=!0)}function y(e,t){var a=n[t],s=r[e],l=s.data.hostModel,c=a.data.getItemGraphicEl(a.dataIndex),u=s.data.getItemGraphicEl(s.dataIndex);c!==u?c&&m[c.id]||u&&(xPt(u),c?(xPt(c),bPt(c),o=!0,pPt(fPt(c),fPt(u),s.divide,l,e,i)):yPt(u,l,e)):u&&wPt(u,s.dataIndex,l)}new o9e(n,r,p(!0,f),p(!1,f),null,"multiple").update(y).updateManyToOne(function(e,t){var a=r[e],s=a.data,l=s.hostModel,c=s.getItemGraphicEl(a.dataIndex),u=xGe(yGe(t,function(e){return n[e].data.getItemGraphicEl(n[e].dataIndex)}),function(e){return e&&e!==c&&!m[e.id]});c&&(xPt(c),u.length?(gGe(u,function(e){xPt(e),bPt(e)}),o=!0,pPt(fPt(u),fPt(c),a.divide,l,e,i)):yPt(c,l,a.dataIndex))}).updateOneToMany(function(e,t){var a=n[t],s=a.data.getItemGraphicEl(a.dataIndex);if(!s||!m[s.id]){var l=xGe(yGe(e,function(e){return r[e].data.getItemGraphicEl(r[e].dataIndex)}),function(e){return e&&e!==s}),c=r[e[0]].data.hostModel;l.length&&(gGe(l,function(e){return xPt(e)}),s?(xPt(s),bPt(s),o=!0,pPt(fPt(s),fPt(l),a.divide,c,e[0],i)):gGe(l,function(t){return yPt(t,c,e[0])}))}}).updateManyToMany(function(e,t){new o9e(t,e,function(e){return n[e].data.getId(n[e].dataIndex)},function(e){return r[e].data.getId(r[e].dataIndex)}).update(function(a,n){y(e[a],t[n])}).execute()}).execute(),o&&gGe(t,function(e){var t=e.data.hostModel,n=t&&a.getViewOfSeriesModel(t),r=l0e("update",t,0);n&&t.isAnimationEnabled()&&r&&r.duration>0&&n.group.traverse(function(e){e instanceof gZe&&!e.animators.length&&e.animateFrom({style:{opacity:0}},r)})})}function SPt(e){var t=e.getModel("universalTransition").get("seriesKey");return t||e.id}function MPt(e){return TGe(e)?e.sort().join(","):e}function TPt(e){if(e.hostModel)return e.hostModel.getModel("universalTransition").get("divideShape")}function kPt(e,t){for(var a=0;a<e.length;a++){if(null!=t.seriesIndex&&t.seriesIndex===e[a].seriesIndex||null!=t.seriesId&&t.seriesId===e[a].id)return a}}var CPt=function(){function e(){this.breaks=[],this._elapsedExtent=[1/0,-1/0]}return e.prototype.setBreaks=function(e){this.breaks=e.breaks},e.prototype.update=function(e){!function(e,t){var a=0,n={tpAbs:{span:0,val:0},tpPrct:{span:0,val:0}},r=function(){return{has:!1,span:NaN,inExtFrac:NaN,val:NaN}},i={S:{tpAbs:r(),tpPrct:r()},E:{tpAbs:r(),tpPrct:r()}};gGe(e.breaks,function(e){var r=e.gapParsed;"tpPrct"===r.type&&(a+=r.val);var o=PPt(e,t);if(o){var s=o.vmin!==e.vmin,l=o.vmax!==e.vmax,c=o.vmax-o.vmin;if(s&&l);else if(s||l){var u=s?"S":"E";i[u][r.type].has=!0,i[u][r.type].span=c,i[u][r.type].inExtFrac=c/(e.vmax-e.vmin),i[u][r.type].val=r.val}else n[r.type].span+=c,n[r.type].val+=r.val}});var o=a*(t[1]-t[0]+0+(n.tpAbs.val-n.tpAbs.span)+(i.S.tpAbs.has?(i.S.tpAbs.val-i.S.tpAbs.span)*i.S.tpAbs.inExtFrac:0)+(i.E.tpAbs.has?(i.E.tpAbs.val-i.E.tpAbs.span)*i.E.tpAbs.inExtFrac:0)-n.tpPrct.span-(i.S.tpPrct.has?i.S.tpPrct.span*i.S.tpPrct.inExtFrac:0)-(i.E.tpPrct.has?i.E.tpPrct.span*i.E.tpPrct.inExtFrac:0))/(1-n.tpPrct.val-(i.S.tpPrct.has?i.S.tpPrct.val*i.S.tpPrct.inExtFrac:0)-(i.E.tpPrct.has?i.E.tpPrct.val*i.E.tpPrct.inExtFrac:0));gGe(e.breaks,function(e){var t=e.gapParsed;"tpPrct"===t.type&&(e.gapReal=0!==a?Math.max(o,0)*t.val/a:0),"tpAbs"===t.type&&(e.gapReal=t.val),null==e.gapReal&&(e.gapReal=0)})}(this,e);var t=this._elapsedExtent;t[0]=this.elapse(e[0]),t[1]=this.elapse(e[1])},e.prototype.hasBreaks=function(){return!!this.breaks.length},e.prototype.calcNiceTickMultiple=function(e,t){for(var a=0;a<this.breaks.length;a++){var n=this.breaks[a];if(n.vmin<e&&e<n.vmax)return t(e,n.vmax)}return 0},e.prototype.getExtentSpan=function(){return this._elapsedExtent[1]-this._elapsedExtent[0]},e.prototype.normalize=function(e){var t=this._elapsedExtent[1]-this._elapsedExtent[0];return 0===t?.5:(this.elapse(e)-this._elapsedExtent[0])/t},e.prototype.scale=function(e){return this.unelapse(e*(this._elapsedExtent[1]-this._elapsedExtent[0])+this._elapsedExtent[0])},e.prototype.elapse=function(e){for(var t=EPt,a=IPt,n=!0,r=0;r<this.breaks.length;r++){var i=this.breaks[r];if(e<=i.vmax){e>i.vmin?t+=i.vmin-a+(e-i.vmin)/(i.vmax-i.vmin)*i.gapReal:t+=e-a,a=i.vmax,n=!1;break}t+=i.vmin-a+i.gapReal,a=i.vmax}return n&&(t+=e-a),t},e.prototype.unelapse=function(e){for(var t=EPt,a=IPt,n=!0,r=0,i=0;i<this.breaks.length;i++){var o=this.breaks[i],s=t+o.vmin-a,l=s+o.gapReal;if(e<=l){r=e>s?o.vmin+(e-s)/(l-s)*(o.vmax-o.vmin):a+e-t,a=o.vmax,n=!1;break}t=l,a=o.vmax}return n&&(r=a+e-t),r},e}();function APt(){return new CPt}var EPt=0,IPt=0;function RPt(e,t,a,n,r,i){"no"!==e&&gGe(a,function(a){var o=PPt(a,i);if(o)for(var s=t.length-1;s>=0;s--){var l=t[s],c=n(l),u=3*r/4;c>o.vmin-u&&c<o.vmax+u&&("preserve_extent_bound"!==e||c!==i[0]&&c!==i[1])&&t.splice(s,1)}})}function DPt(e,t,a,n){gGe(t,function(t){var r=PPt(t,a);r&&(e.push({value:r.vmin,break:{type:"vmin",parsedBreak:r},time:n?n(r):void 0}),e.push({value:r.vmax,break:{type:"vmax",parsedBreak:r},time:n?n(r):void 0}))}),t.length&&e.sort(function(e,t){return e.value-t.value})}function PPt(e,t){var a=Math.max(e.vmin,t[0]),n=Math.min(e.vmax,t[1]);return a<n||a===n&&a>t[0]&&a<t[1]?{vmin:a,vmax:n,breakOption:e.breakOption,gapParsed:e.gapParsed,gapReal:e.gapReal}:null}function LPt(e,t,a){var n=[];if(!e)return{breaks:n};gGe(e,function(e){if(e&&null!=e.start&&null!=e.end&&!e.isExpanded){var r={breakOption:cGe(e),vmin:t(e.start),vmax:t(e.end),gapParsed:{type:"tpAbs",val:0},gapReal:null};if(null!=e.gap){var i=!1;if(CGe(e.gap)){var o=HGe(e.gap);if(o.match(/%$/)){var s=parseFloat(o)/100;(function(e){return e>=0&&e<.99999})(s)||(s=0),r.gapParsed.type="tpPrct",r.gapParsed.val=s,i=!0}}if(!i){var l=t(e.gap);(!isFinite(l)||l<0)&&(l=0),r.gapParsed.type="tpAbs",r.gapParsed.val=l}}if(r.vmin===r.vmax&&(r.gapParsed.type="tpAbs",r.gapParsed.val=0),a&&a.noNegative&&gGe(["vmin","vmax"],function(e){r[e]<0&&(r[e]=0)}),r.vmin>r.vmax){var c=r.vmax;r.vmax=r.vmin,r.vmin=c}n.push(r)}}),n.sort(function(e,t){return e.vmin-t.vmin});var r=-1/0;return gGe(n,function(e,t){r>e.vmin&&(n[t]=null),r=e.vmax}),{breaks:n.filter(function(e){return!!e})}}function NPt(e,t){return OPt(t)===OPt(e)}function OPt(e){return e.start+"_\0_"+e.end}function FPt(e,t,a){var n=[];gGe(e,function(e,a){var r=t(e);r&&"vmin"===r.type&&n.push([a])}),gGe(e,function(a,r){var i=t(a);if(i&&"vmax"===i.type){var o=wGe(n,function(a){return NPt(t(e[a[0]]).parsedBreak.breakOption,i.parsedBreak.breakOption)});o&&o.push(r)}});var r=[];return gGe(n,function(t){2===t.length&&r.push(a?t:[e[t[0]],e[t[1]]])}),r}function BPt(e,t,a,n){var r,i;if(e.break){var o=e.break.parsedBreak,s=wGe(a,function(t){return NPt(t.breakOption,e.break.parsedBreak.breakOption)}),l=n(Math.pow(t,o.vmin),s.vmin),c=n(Math.pow(t,o.vmax),s.vmax),u={type:o.gapParsed.type,val:"tpAbs"===o.gapParsed.type?PXe(Math.pow(t,o.vmin+o.gapParsed.val))-l:o.gapParsed.val};r={type:e.break.type,parsedBreak:{breakOption:o.breakOption,vmin:l,vmax:c,gapParsed:u,gapReal:o.gapReal}},i=s[e.break.type]}return{brkRoundingCriterion:i,vBreak:r}}function UPt(e,t,a){var n={noNegative:!0},r=LPt(e,a,n),i=LPt(e,a,n),o=Math.log(t);return i.breaks=yGe(i.breaks,function(e){var t=Math.log(e.vmin)/o;return{vmin:t,vmax:Math.log(e.vmax)/o,gapParsed:{type:e.gapParsed.type,val:"tpAbs"===e.gapParsed.type?Math.log(e.vmin+e.gapParsed.val)/o-t:e.gapParsed.val},gapReal:e.gapReal,breakOption:e.breakOption}}),{parsedOriginal:r,parsedLogged:i}}var zPt={vmin:"start",vmax:"end"};function VPt(e,t){return t&&((e=e||{}).break={type:zPt[t.type],start:t.parsedBreak.vmin,end:t.parsedBreak.vmax}),e}function HPt(){var e;e={createScaleBreakContext:APt,pruneTicksByBreak:RPt,addBreaksToTicks:DPt,parseAxisBreakOption:LPt,identifyAxisBreak:NPt,serializeAxisBreakIdentifier:OPt,retrieveAxisBreakPairs:FPt,getTicksLogTransformBreak:BPt,logarithmicParseBreaksFromOption:UPt,makeAxisLabelFormatterParamBreak:VPt},V1e||(V1e=e)}var GPt=v$e();function WPt(e,t,a,n,r){var i=a.axis;if(!i.scale.isBlank()&&H1e()){var o=H1e().retrieveAxisBreakPairs(i.scale.getTicks({breakTicks:"only_break"}),function(e){return e.break},!1);if(o.length){var s=a.getModel("breakArea"),l=s.get("zigzagAmplitude"),c=s.get("zigzagMinSpan"),u=s.get("zigzagMaxSpan");c=Math.max(2,c||0),u=Math.max(c,u||0);var d=s.get("expandOnClick"),h=s.get("zigzagZ"),p=s.getModel("itemStyle").getItemStyle(),f=p.stroke,m=p.lineWidth,v=p.lineDash,g=p.fill,y=new xXe({ignoreModelZ:!0}),b=i.isHorizontal(),x=GPt(t).visualList||(GPt(t).visualList=[]);gGe(x,function(e){return e.shouldRemove=!0});for(var w=function(e){var t=o[e][0].break.parsedBreak,s=[];s[0]=i.toGlobalCoord(i.dataToCoord(t.vmin,!0)),s[1]=i.toGlobalCoord(i.dataToCoord(t.vmax,!0)),s[1]<s[0]&&s.reverse();var w=function(e,t){var a=wGe(e,function(e){return H1e().identifyAxisBreak(e.parsedBreak.breakOption,t.breakOption)});return a||e.push(a={zigzagRandomList:[],parsedBreak:t,shouldRemove:!1}),a}(x,t);w.shouldRemove=!1;var _=new xXe;!function(e,t,a,r,i,o){var s={stroke:f,lineWidth:m,lineDash:v,fill:"none"},d=i?0:1,y=1-d,b=n[y0e[y]]+n[b0e[y]];function x(e){var t=[],a=[];t[d]=a[d]=e,t[y]=n[y0e[y]],a[y]=b;var r={x1:t[0],y1:t[1],x2:a[0],y2:a[1]};return MZe(r,r,{lineWidth:1}),t[0]=r.x1,t[1]=r.y1,t[d]}a=x(a),r=x(r);for(var w=[],_=[],S=!0,M=n[y0e[y]],T=0;;T++){var k=M===n[y0e[y]],C=M>=b;C&&(M=b);var A=[],E=[];A[d]=a,E[d]=r,k||C||(A[d]+=S?-l:l,E[d]-=S?l:-l),A[y]=M,E[y]=M,w.push(A),_.push(E);var I=void 0;if(T<e.length?I=e[T]:(I=Math.random(),e.push(I)),M+=I*(u-c)+c,S=!S,C)break}var R=H1e().serializeAxisBreakIdentifier(o.breakOption);if(t.add(new OQe({anid:"break_a_"+R,shape:{points:w},style:s,z:h})),0!==o.gapReal){t.add(new OQe({anid:"break_b_"+R,shape:{points:_},style:s,z:h}));var D=_.slice();D.reverse();var P=w.concat(D);t.add(new LQe({anid:"break_c_"+R,shape:{points:P},style:{fill:g,opacity:p.opacity},z:h}))}}(w.zigzagRandomList,_,s[0],s[1],b,t),d&&_.on("click",function(){var e={type:jit,breaks:[{start:t.breakOption.start,end:t.breakOption.end}]};e[i.dim+"AxisIndex"]=a.componentIndex,r.dispatchAction(e)}),_.silent=!d,y.add(_)},_=0;_<o.length;_++)w(_);e.add(y),function(e){for(var t=e.length-1;t>=0;t--)e[t].shouldRemove&&e.splice(t,1)}(x)}}}function qPt(e,t,a,n){var r=e.axis,i=a.transform;VGe(n.style);var o=r.getExtent();r.inverse&&(o=o.slice()).reverse();var s=yGe(H1e().retrieveAxisBreakPairs(r.scale.getTicks({breakTicks:"only_break"}),function(e){return e.break},!1),function(e){var t=e[0].break.parsedBreak,a=[r.dataToCoord(t.vmin,!0),r.dataToCoord(t.vmax,!0)];return a[0]>a[1]&&a.reverse(),{coordPair:a,brkId:H1e().serializeAxisBreakIdentifier(t.breakOption)}});s.sort(function(e,t){return e.coordPair[0]-t.coordPair[0]});for(var l=o[0],c=null,u=0;u<s.length;u++){var d=s[u],h=Math.max(d.coordPair[0],o[0]),p=Math.min(d.coordPair[1],o[1]);l<=h&&f(l,h,c,d),l=p,c=d}function f(e,a,r,o){function s(e,t){i&&(vWe(e,e,i),vWe(t,t,i))}function l(e,t){var a={x1:e[0],y1:e[1],x2:t[0],y2:t[1]};MZe(a,a,n.style),e[0]=a.x1,e[1]=a.y1,t[0]=a.x2,t[1]=a.y2}var c=[e,0],u=[a,0],d=[e,5],h=[a,5];s(c,d),l(c,d),s(u,h),l(u,h),l(c,u);var p=new UQe(hGe({shape:{x1:c[0],y1:c[1],x2:u[0],y2:u[1]}},n));t.add(p),p.anid="breakLine_"+(r?r.brkId:"\0")+"_\0_"+(o?o.brkId:"\0")}l<=o[1]&&f(l,o[1],c,null)}function YPt(e,t,a){if(!wGe(a,function(e){return!e})){var n=new eqe;if(mat(a[0],a[1],n,{direction:-(e?t+Math.PI:t),touchThreshold:0,bidirectional:!1})){var r=[1,0,0,1,0,0];ZWe(r,r,-t);var i=yGe(a,function(e){return e.transform?$We([1,0,0,1,0,0],r,e.transform):r}),o=.5;if(m(0)||m(1)){var s=yGe(a,function(e,t){var a=e.localRect.clone();return a.applyTransform(i[t]),a}),l=new eqe;l.copy(a[0].label).add(a[1].label).scale(.5),l.transform(r);var c=n.clone().transform(r),u=(s[0].x+s[1].x+(c.x>=0?s[0].width:s[1].width)+c.x)/2-l.x,d=Math.min(u,u-c.x),h=Math.max(u,u-c.x);o=(u-(h<0?h:d>0?d:0))/c.x}var p=new eqe,f=new eqe;eqe.scale(p,n,-o),eqe.scale(f,n,1-o),uat(a[0],p),uat(a[1],f)}}function m(e){var t=a[0].localRect,n=new eqe(t[b0e[e]]*i[0][0],t[b0e[e]]*i[0][1]);return Math.abs(n.y)<1e-5}}function jPt(e,t){var a={breaks:[]};return gGe(t.breaks,function(n){if(n){var r=wGe(e.get("breaks",!0),function(e){return H1e().identifyAxisBreak(e,n)});if(r){var i=t.type,o={isExpanded:!!r.isExpanded};r.isExpanded=i===jit||i!==Xit&&(i===$it?!r.isExpanded:r.isExpanded),a.breaks.push({start:r.start,end:r.end,isExpanded:!!r.isExpanded,old:o})}}}),a}function XPt(){var e;e={adjustBreakLabelPair:YPt,buildAxisBreakLine:qPt,rectCoordBuildBreakAxis:WPt,updateModelAxisBreak:jPt},Bit||(Bit=e)}function $Pt(e,t){gGe(e,function(e){if(!e.model.get(["axisLabel","inside"])){var a=function(e){var t,a,n=e.model,r=e.scale;if(!n.get(["axisLabel","show"])||r.isBlank())return;var i=r.getExtent();a=r instanceof eet?r.count():(t=r.getTicks()).length;var o,s=e.getLabelModel(),l=Het(e),c=1;a>40&&(c=Math.ceil(a/40));for(var u=0;u<a;u+=c){var d=l(t?t[u]:{value:i[0]+u},u),h=p(s.getTextRect(d),s.get("rotate")||0);o?o.union(h):o=h}return o;function p(e,t){var a=t*Math.PI/180,n=e.width,r=e.height,i=n*Math.abs(Math.cos(a))+Math.abs(r*Math.sin(a)),o=n*Math.abs(Math.sin(a))+Math.abs(r*Math.cos(a));return new fqe(e.x,e.y,i,o)}}(e);if(a){var n=e.isHorizontal()?"height":"width",r=e.model.get(["axisLabel","margin"]);t[n]-=a[n]+r,"top"===e.position?t.y+=a.height+r:"left"===e.position&&(t.x+=a.width+r)}}})}Qet([Wnt]),Qet([function(e){e.registerPainter("svg",Fnt)}]),Qet([Irt,ait,Sit,sst,function(e){Qet(xst),e.registerChartView(hst),e.registerSeriesModel(pst),e.registerLayout(lst),e.registerProcessor(sit("radar")),e.registerPreprocessor(dst)},function(e){Qet(act),e.registerChartView(Ult),e.registerSeriesModel(zlt),e.registerLayout(Hlt),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,Vlt),r8e("map",e.registerAction)},function(e){e.registerChartView(fct),e.registerSeriesModel(Oct),e.registerLayout(Bct),e.registerVisual(Uct),function(e){e.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(e,t){t.eachComponent({mainType:"series",subType:"tree",query:e},function(t){var a=e.dataIndex,n=t.getData().tree.getNodeByDataIndex(a);n.isExpand=!n.isExpand})}),e.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(e,t,a){t.eachComponent({mainType:"series",subType:"tree",query:e},function(t){var a=Ust(t.coordinateSystem,e,t.get("scaleLimit"));t.setCenter(a.center),t.setZoom(a.zoom)})})}(e)},function(e){e.registerSeriesModel(Hct),e.registerChartView(tut),e.registerVisual(yut),e.registerLayout(Rut),function(e){for(var t=0;t<zct.length;t++)e.registerAction({type:zct[t],update:"updateView"},eWe);e.registerAction({type:"treemapRootToNode",update:"updateView"},function(e,t){t.eachComponent({mainType:"series",subType:"treemap",query:e},function(t,a){var n=Dct(e,["treemapZoomToNode","treemapRootToNode"],t);if(n){var r=t.getViewRoot();r&&(e.direction=Lct(r,n.node)?"rollUp":"drillDown"),t.resetViewRoot(n.node)}})})}(e)},function(e){e.registerChartView(Ldt),e.registerSeriesModel(Vdt),e.registerProcessor(Fut),e.registerVisual(But),e.registerVisual(zut),e.registerLayout(Kut),e.registerLayout(e.PRIORITY.VISUAL.POST_CHART_LAYOUT,rdt),e.registerLayout(odt),e.registerCoordinateSystem("graphView",{dimensions:Wlt.dimensions,create:sdt}),e.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},eWe),e.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},eWe),e.registerAction({type:"graphRoam",event:"graphRoam",update:"none"},function(e,t,a){t.eachComponent({mainType:"series",query:e},function(t){var n=a.getViewOfSeriesModel(t);n&&(null!=e.dx&&null!=e.dy&&n.updateViewOnPan(t,a,e),null!=e.zoom&&null!=e.originX&&null!=e.originY&&n.updateViewOnZoom(t,a,e));var r=Ust(t.coordinateSystem,e,t.get("scaleLimit"));t.setCenter&&t.setCenter(r.center),t.setZoom&&t.setZoom(r.zoom)})})},function(e){e.registerChartView(Ydt),e.registerSeriesModel(jdt),e.registerLayout(e.PRIORITY.VISUAL.POST_CHART_LAYOUT,$dt),e.registerProcessor(sit("chord"))},function(e){e.registerChartView(Qdt),e.registerSeriesModel(eht)},function(e){e.registerChartView(nht),e.registerSeriesModel(rht),e.registerLayout(iht),e.registerProcessor(sit("funnel"))},function(e){Qet(Rpt),e.registerChartView(oht),e.registerSeriesModel(hht),e.registerVisual(e.PRIORITY.VISUAL.BRUSH,mht)},function(e){e.registerChartView(Lpt),e.registerSeriesModel(Opt),e.registerLayout(Fpt),e.registerVisual($pt),e.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(e,t){t.eachComponent({mainType:"series",subType:"sankey",query:e},function(t){t.setNodePosition(e.dataIndex,[e.localX,e.localY])})}),e.registerAction({type:"sankeyRoam",event:"sankeyRoam",update:"none"},function(e,t,a){t.eachComponent({mainType:"series",subType:"sankey",query:e},function(t){var a=Ust(t.coordinateSystem,e,t.get("scaleLimit"));t.setCenter(a.center),t.setZoom(a.zoom)})})},function(e){e.registerSeriesModel(Zpt),e.registerChartView(Jpt),e.registerLayout(ift),e.registerTransform(oft)},function(e){e.registerChartView(vft),e.registerSeriesModel(Cft),e.registerPreprocessor(Aft),e.registerVisual(fft),e.registerLayout(Eft)},function(e){e.registerChartView(Pft),e.registerSeriesModel(Lft),e.registerLayout(krt("effectScatter"))},function(e){e.registerChartView(Hft),e.registerSeriesModel(Yft),e.registerLayout(Vft),e.registerVisual(Xft)},Qft,function(e){e.registerChartView(nmt),e.registerSeriesModel(wmt),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,MGe(pet,"pictorialBar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,fet("pictorialBar"))},function(e){e.registerChartView(_mt),e.registerSeriesModel(Smt),e.registerLayout(Mmt),e.registerProcessor(sit("themeRiver"))},function(e){e.registerChartView(Emt),e.registerSeriesModel(Imt),e.registerLayout(MGe(Pmt,"sunburst")),e.registerProcessor(MGe(sit,"sunburst")),e.registerVisual(Nmt),function(e){e.registerAction({type:Cmt,update:"updateView"},function(e,t){t.eachComponent({mainType:"series",subType:"sunburst",query:e},function(t,a){var n=Dct(e,[Cmt],t);if(n){var r=t.getViewRoot();r&&(e.direction=Lct(r,n.node)?"rollUp":"drillDown"),t.resetViewRoot(n.node)}})}),e.registerAction({type:Amt,update:"none"},function(e,t,a){e=hGe({},e),t.eachComponent({mainType:"series",subType:"sunburst",query:e},function(t){var a=Dct(e,[Amt],t);a&&(e.dataIndex=a.node.dataIndex)}),a.dispatchAction(hGe(e,{type:"highlight"}))}),e.registerAction({type:"sunburstUnhighlight",update:"updateView"},function(e,t,a){e=hGe({},e),a.dispatchAction(hGe(e,{type:"downplay"}))})}(e)},function(e){e.registerChartView(kvt),e.registerSeriesModel(Umt)}]),Qet(Agt),Qet(function(e){Qet(Cgt),Wot.registerAxisPointerClass("PolarAxisPointer",Egt),e.registerCoordinateSystem("polar",Ggt),e.registerComponentModel(Rgt),e.registerComponentView(ryt),zit(e,"angle",Pgt,ayt),zit(e,"radius",Lgt,nyt),e.registerComponentView(Xgt),e.registerComponentView(Zgt),e.registerLayout(MGe(tyt,"bar"))}),Qet(act),Qet(function(e){Qet(Cgt),Wot.registerAxisPointerClass("SingleAxisPointer",gyt),e.registerComponentView(wyt),e.registerComponentView(syt),e.registerComponentModel(cyt),zit(e,"single",cyt,cyt.defaultOption),e.registerCoordinateSystem("single",fyt)}),Qet(Rpt),Qet(function(e){e.registerComponentModel(_yt),e.registerComponentView(Myt),e.registerCoordinateSystem("calendar",kyt)}),Qet(function(e){e.registerComponentModel(Qyt),e.registerComponentView(rbt),e.registerCoordinateSystem("matrix",hbt)}),Qet(function(e){e.registerComponentModel(Pbt),e.registerComponentView(Obt),e.registerPreprocessor(function(e){var t=e.graphic;TGe(t)?t[0]&&t[0].elements?e.graphic=[e.graphic[0]]:e.graphic=[{elements:t}]:t&&!t.elements&&(e.graphic=[{elements:[t]}])})}),Qet(function(e){e.registerComponentModel(cxt),e.registerComponentView(dxt),sxt("saveAsImage",hxt),sxt("magicType",mxt),sxt("dataView",_xt),sxt("dataZoom",Wxt),sxt("restore",Cxt),Qet(rxt)}),Qet(fwt),Qet(Cgt),Qet(function(e){e.registerComponentView(Pwt),e.registerComponentModel(Lwt),e.registerPreprocessor(vwt),e.registerVisual(e.PRIORITY.VISUAL.BRUSH,Awt),e.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(e,t){t.eachComponent({mainType:"brush",query:e},function(t){t.setAreas(e.areas)})}),e.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},eWe),e.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},eWe),sxt("brush",Fwt)}),Qet(zwt),Qet(function(e){e.registerComponentModel(Hwt),e.registerComponentView(jwt),e.registerSubTypeDefaulter("timeline",function(){return"slider"}),function(e){e.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(e,t,a){var n=t.getComponent("timeline");return n&&null!=e.currentIndex&&(n.setCurrentIndex(e.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.getPlayState()&&(n.setPlayState(!1),a.dispatchAction({type:"timelinePlayChange",playState:!1,from:e.from}))),t.resetOption("timeline",{replaceMerge:n.get("replaceMerge",!0)}),pGe({currentIndex:n.option.currentIndex},e)}),e.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(e,t){var a=t.getComponent("timeline");a&&null!=e.playState&&a.setPlayState(e.playState)})}(e),e.registerPreprocessor(Kwt)}),Qet(function(e){e.registerComponentModel(n_t),e.registerComponentView(m_t),e.registerPreprocessor(function(e){Qwt(e.series,"markPoint")&&(e.markPoint=e.markPoint||{})})}),Qet(M_t),Qet(function(e){e.registerComponentModel(T_t),e.registerComponentView(P_t),e.registerPreprocessor(function(e){Qwt(e.series,"markArea")&&(e.markArea=e.markArea||{})})}),Qet(eSt),Qet(function(e){Qet(dSt),Qet(bSt)}),Qet(dSt),Qet(bSt),Qet(iMt),Qet(QSt),Qet(rMt),Qet(function(e){e.registerComponentModel(sMt),e.registerComponentView(lMt)}),Qet(function(e){e.registerPreprocessor(mMt),e.registerVisual(e.PRIORITY.VISUAL.ARIA,fMt)}),Qet(function(e){e.registerTransform(CMt),e.registerTransform(AMt)}),Qet(function(e){e.registerComponentModel(EMt),e.registerComponentView(IMt)}),Qet(function(e){e.registerUpdateLifecycle("series:beforeupdate",function(e,t,a){gGe(r$e(a.seriesTransition),function(e){gGe(r$e(e.to),function(e){for(var t=a.updatedSeries,n=0;n<t.length;n++)(null!=e.seriesIndex&&e.seriesIndex===t[n].seriesIndex||null!=e.seriesId&&e.seriesId===t[n].id)&&(t[n][X3e]=!0)})})}),e.registerUpdateLifecycle("series:transition",function(e,t,a){var n=mPt(t);if(n.oldSeries&&a.updatedSeries&&a.optionChanged){var r=a.seriesTransition;if(r)gGe(r$e(r),function(e){!function(e,t,a,n){var r=[],i=[];gGe(r$e(e.from),function(e){var a=kPt(t.oldSeries,e);a>=0&&r.push({dataGroupId:t.oldDataGroupIds[a],data:t.oldData[a],divide:TPt(t.oldData[a]),groupIdDim:e.dimension})}),gGe(r$e(e.to),function(e){var n=kPt(a.updatedSeries,e);if(n>=0){var r=a.updatedSeries[n].getData();i.push({dataGroupId:t.oldDataGroupIds[n],data:r,divide:TPt(r),groupIdDim:e.dimension})}}),r.length>0&&i.length>0&&_Pt(r,i,n)}(e,n,a,t)});else{var i=function(e,t){var a=$Ge(),n=$Ge(),r=$Ge();return gGe(e.oldSeries,function(t,a){var i=e.oldDataGroupIds[a],o=e.oldData[a],s=SPt(t),l=MPt(s);n.set(l,{dataGroupId:i,data:o}),TGe(s)&&gGe(s,function(e){r.set(e,{key:l,dataGroupId:i,data:o})})}),gGe(t.updatedSeries,function(e){if(e.isUniversalTransitionEnabled()&&e.isAnimationEnabled()){var t=e.get("dataGroupId"),i=e.getData(),o=SPt(e),s=MPt(o),l=n.get(s);if(l)a.set(s,{oldSeries:[{dataGroupId:l.dataGroupId,divide:TPt(l.data),data:l.data}],newSeries:[{dataGroupId:t,divide:TPt(i),data:i}]});else if(TGe(o)){var c=[];gGe(o,function(e){var t=n.get(e);t.data&&c.push({dataGroupId:t.dataGroupId,divide:TPt(t.data),data:t.data})}),c.length&&a.set(s,{oldSeries:c,newSeries:[{dataGroupId:t,data:i,divide:TPt(i)}]})}else{var u=r.get(o);if(u){var d=a.get(u.key);d||(d={oldSeries:[{dataGroupId:u.dataGroupId,data:u.data,divide:TPt(u.data)}],newSeries:[]},a.set(u.key,d)),d.newSeries.push({dataGroupId:t,data:i,divide:TPt(i)})}}}}),a}(n,a);gGe(i.keys(),function(e){var a=i.get(e);_Pt(a.oldSeries,a.newSeries,t)})}gGe(a.updatedSeries,function(e){e[X3e]&&(e[X3e]=!1)})}for(var o=e.getSeries(),s=n.oldSeries=[],l=n.oldDataGroupIds=[],c=n.oldData=[],u=0;u<o.length;u++){var d=o[u].getData();d.count()<1e4&&(s.push(o[u]),l.push(o[u].get("dataGroupId")),c.push(d))}})}),Qet(function(e){e.registerUpdateLifecycle("series:beforeupdate",function(e,t,a){var n=Tat(t).labelManager;n||(n=Tat(t).labelManager=new Mat),n.clearLabels()}),e.registerUpdateLifecycle("series:layoutlabels",function(e,t,a){var n=Tat(t).labelManager;a.updatedSeries.forEach(function(e){n.addLabelsOfSeries(t.getViewOfSeriesModel(e))}),n.updateLayoutConfig(t),n.layout(t),n.processLabelsOverall()})}),Qet(function(e){!function(e){function t(e,t){var a=[],n=y$e(t,e);function r(t,r){gGe(n[t],function(t){gGe(t.updateAxisBreaks(e).breaks,function(e){var n;a.push(pGe(((n={})[r]=t.componentIndex,n),e))})})}return r("xAxisModels","xAxisIndex"),r("yAxisModels","yAxisIndex"),r("singleAxisModels","singleAxisIndex"),{eventBreaks:a}}e.registerAction(Zit,t),e.registerAction(Jit,t),e.registerAction(Qit,t)}(e),HPt(),XPt()}),Qet(function(){Cot=$Pt}),Qet(function(e){e.registerLayout(e.PRIORITY.VISUAL.POST_CHART_LAYOUT,ost)});const KPt={class:"flex h-full"},ZPt={class:"flex-[2] relative border-r border-white/5"},JPt={class:"absolute top-0 left-0 p-3 z-10 pointer-events-none"},QPt={class:"text-[10px] text-gray-400 font-mono border-l-2 border-orange-500 pl-2"},eLt={class:"flex-1 bg-gradient-to-b from-[#0a0a0a] to-black flex flex-col"},tLt={class:"p-2 border-b border-white/10 bg-black/50 flex justify-between items-center"},aLt={class:"text-right"},nLt={class:"font-mono text-xs text-cyan-400"},rLt={class:"flex-1 flex flex-col p-2 gap-2 overflow-hidden"},iLt={class:"flex-1 bg-black/40 backdrop-blur-md border border-white/10 rounded-lg p-2 min-h-0"},oLt={class:"flex-1 bg-black/40 backdrop-blur-md border border-white/10 rounded-lg p-2 min-h-0"},sLt={class:"p-2 border-t border-white/10 bg-[#080808]"},lLt={class:"flex justify-between items-center mb-2"},cLt=e({__name:"WaveSigmaWidget",props:{width:{default:6},height:{default:4},resizable:{type:Boolean,default:!0},showControls:{type:Boolean,default:!0}},emits:["settings","remove","resize"],setup(e,{emit:a}){const i=e,o=a,l=t(null),u=t(null),d=t(null),p=t(i.width),f=t(i.height),g=t(DHe.TRENDING),y=t(1e3),x=t(0),_=t([]);let M=null,T=null;const{init:k,dispose:C,setRegime:E,resize:I}=BHe(),D=t([]),P=t(0),L=t(Date.now()),N=S(()=>{const e=Math.floor(x.value/365),t=x.value%365;return e>0?`${e}Y ${t}D`:`${t}D`}),O=(e,t)=>{const a=performance.now();if(a-P.value<50)return;P.value=a;let n=0;n=g.value===DHe.TRENDING?e>.2?1:e<-.2?-1:0:e>.5?.5:e<-.5?-.5:Math.random()-.5;const r=Math.abs(n)*(g.value===DHe.TRENDING?1.5:-2)+(2*Math.random()-1),i=y.value+r;y.value=i;const o={position:n,equity:i,price:0,timestamp:a},s=[...D.value.slice(1),o];D.value=s,_.value=s,F()},F=()=>{const e=_.value.slice(-60);M&&M.setOption({series:[{data:e.map(e=>e.position)}]}),T&&T.setOption({series:[{data:e.map(e=>e.equity)}]})},B=(e,t)=>{p.value=e,f.value=t,o("resize",e,t),A(()=>{I(),M?.resize(),T?.resize()})};let U=null,z=null;n(()=>{const e=Array(60).fill(0).map((e,t)=>({position:0,equity:1e3,price:100,timestamp:t}));D.value=e,_.value=e,A(()=>{l.value&&k(l.value,O),u.value&&(M=Y7e(u.value),M.setOption({animation:!1,grid:{top:5,right:5,bottom:15,left:5},xAxis:{type:"category",show:!0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!0,color:"#444",fontSize:8,interval:14,formatter:(e,t)=>`-${(.05*(60-t)).toFixed(1)}s`},data:Array(60).fill(0).map((e,t)=>t)},yAxis:{type:"value",min:-1.2,max:1.2,show:!1,splitLine:{show:!1}},series:[{type:"line",step:"end",data:[],lineStyle:{color:"#ff9f43",width:1.5},showSymbol:!1,markLine:{silent:!0,data:[{yAxis:0}],lineStyle:{color:"#222",type:"solid"},label:{show:!1},symbol:"none"}}]})),d.value&&(T=Y7e(d.value),T.setOption({animation:!1,grid:{top:5,right:5,bottom:15,left:5},xAxis:{type:"category",show:!0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!0,color:"#444",fontSize:8,interval:14,formatter:(e,t)=>`-${(.05*(60-t)).toFixed(1)}s`},data:Array(60).fill(0).map((e,t)=>t)},yAxis:{type:"value",show:!1,splitLine:{show:!1}},series:[{type:"line",smooth:!0,data:[],lineStyle:{color:"#00d2d3",width:2},showSymbol:!1,areaStyle:{color:new XQe(0,0,0,1,[{offset:0,color:"rgba(0, 210, 211, 0.2)"},{offset:1,color:"rgba(0, 210, 211, 0)"}])}}]})),F()}),U=setInterval(()=>{const e=g.value===DHe.TRENDING?DHe.CHOPPY:DHe.TRENDING;g.value=e,E(e)},8e3),z=setInterval(()=>{const e=(Date.now()-L.value)/1e3;x.value=Math.floor(7*e)},100),window.addEventListener("resize",V)});const V=()=>{I(),M?.resize(),T?.resize()};return r(()=>{U&&clearInterval(U),z&&clearInterval(z),C(),M?.dispose(),T?.dispose(),window.removeEventListener("resize",V)}),R(()=>i.width,e=>{p.value=e}),R(()=>i.height,e=>{f.value=e}),(t,a)=>(w(),b(lRt,{title:"WAVE_σ.9",icon:"WaveIcon","icon-bg":"bg-orange-500/20","icon-color":"text-orange-400",width:p.value,height:f.value,resizable:e.resizable,"show-controls":e.showControls,onSettings:a[0]||(a[0]=e=>t.$emit("settings")),onRemove:a[1]||(a[1]=e=>t.$emit("remove")),onResize:B},{default:h(()=>[s("div",KPt,[s("div",ZPt,[s("div",JPt,[s("p",QPt,[a[2]||(a[2]=m(" Regime: ",-1)),s("span",{class:c("TRENDING"===g.value?"text-green-400 font-bold":"text-red-400 font-bold")},v(g.value),3)])]),s("div",{ref_key:"canvasRef",ref:l,class:"w-full h-full"},null,512)]),s("div",eLt,[s("div",tLt,[a[4]||(a[4]=s("div",null,[s("div",{class:"text-[8px] text-gray-500 font-mono uppercase tracking-widest"},"Output"),s("div",{class:"flex items-center gap-1"},[s("div",{class:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),s("span",{class:"text-[10px] font-bold text-white"},"LIVE")])],-1)),s("div",aLt,[a[3]||(a[3]=s("div",{class:"text-[8px] text-gray-500 font-mono uppercase tracking-widest"},"Backtest",-1)),s("div",nLt,v(N.value),1)])]),s("div",rLt,[s("div",iLt,[a[5]||(a[5]=s("div",{class:"flex justify-between items-center mb-1"},[s("h3",{class:"text-[8px] font-mono font-bold text-orange-400 uppercase tracking-widest"},"Position"),s("span",{class:"text-[8px] text-gray-500 font-mono"},"-1 : 1")],-1)),s("div",{ref_key:"positionChartRef",ref:u,class:"w-full h-[calc(100%-16px)]"},null,512)]),s("div",oLt,[a[6]||(a[6]=s("div",{class:"flex justify-between items-center mb-1"},[s("h3",{class:"text-[8px] font-mono font-bold text-cyan-400 uppercase tracking-widest"},"Equity"),s("span",{class:"text-[8px] text-gray-500 font-mono"},"Rolling")],-1)),s("div",{ref_key:"equityChartRef",ref:d,class:"w-full h-[calc(100%-16px)]"},null,512)])]),s("div",sLt,[s("div",lLt,[a[7]||(a[7]=s("div",{class:"text-[8px] text-gray-500 font-mono uppercase tracking-widest"},"Equity",-1)),s("div",{class:c("font-mono text-sm "+(y.value>1e3?"text-green-400":"text-red-400"))}," $"+v(y.value.toFixed(2)),3)]),a[8]||(a[8]=s("div",{class:"grid grid-cols-2 gap-1 text-[8px] font-mono text-gray-500"},[s("div",{class:"flex justify-between border border-white/5 p-1 rounded"},[s("span",null,"SHARPE"),s("span",{class:"text-white"},"2.1")]),s("div",{class:"flex justify-between border border-white/5 p-1 rounded"},[s("span",null,"VOL"),s("span",{class:"text-white"},"15%")])],-1))])])])]),_:1},8,["width","height","resizable","show-controls"]))}}),uLt={class:"settings-container"},dLt={class:"settings-sidebar"},hLt=["onClick"],pLt={class:"settings-content custom-scrollbar"},fLt={key:0,class:"space-y-8"},mLt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},vLt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 hover:border-indigo-500/50 transition-colors cursor-pointer group"},gLt={class:"flex justify-between items-start mb-4"},yLt={class:"p-3 bg-indigo-500/20 rounded-xl text-indigo-400"},bLt={class:"p-6 rounded-2xl bg-white/5 border border-white/5 border-dashed flex flex-col items-center justify-center text-center cursor-pointer hover:bg-white/10 transition-colors"},xLt={class:"p-4 bg-white/5 rounded-full mb-4"},wLt={key:1,class:"space-y-8"},_Lt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},SLt=["onClick"],MLt={class:"flex items-center gap-3 mb-3"},TLt={class:"text-sm font-bold text-white"},kLt={class:"text-xs text-gray-500"},CLt={class:"flex items-center gap-2 text-xs text-gray-400"},ALt={class:"font-mono text-white"},ELt={class:"flex justify-between items-center mb-4"},ILt={class:"text-xs text-gray-500"},RLt={class:"bg-black/20 rounded-2xl border border-white/10 p-6 min-h-[500px] relative"},DLt={key:0,class:"flex items-center justify-center h-[400px] text-center"},PLt={key:1,class:"dashboard-preview-grid",style:{gridTemplateColumns:"repeat(12, 1fr)"}},LLt={key:2,class:"space-y-8"},NLt={class:"flex justify-between items-center"},OLt={class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-xs flex items-center gap-2"},FLt={class:"bg-black/20 rounded-2xl border border-white/5 overflow-hidden"},BLt={class:"w-full text-left"},ULt={class:"text-sm font-mono text-gray-300"},zLt={class:"p-4 font-bold text-white"},VLt={class:"p-4"},HLt={class:"p-4"},GLt={class:"p-4 text-gray-500 text-xs"},WLt={class:"p-4 text-right"},qLt={class:"p-2 hover:bg-white/10 rounded-lg text-gray-400 hover:text-white transition-colors"},YLt={key:3,class:"space-y-8"},jLt={class:"grid grid-cols-1 md:grid-cols-2 gap-8"},XLt={class:"space-y-6"},$Lt={class:"flex items-center gap-2 p-3 bg-black/20 rounded-xl border border-white/10"},KLt={class:"flex items-center gap-2 p-3 bg-black/20 rounded-xl border border-white/10"},ZLt={class:"space-y-6"},JLt={class:"grid grid-cols-2 gap-4"},QLt={class:"flex items-center justify-center gap-2 p-3 rounded-xl border border-white/10 bg-white/5 text-white hover:bg-white/10"},eNt={class:"flex items-center justify-center gap-2 p-3 rounded-xl border border-white/10 bg-transparent text-gray-500 hover:text-white hover:bg-white/5"},tNt={class:"space-y-2 max-h-48 overflow-y-auto custom-scrollbar"},aNt={class:"text-sm text-white font-mono"},nNt=["onClick"],rNt={key:0,class:"text-xs text-gray-500 text-center py-4"},iNt={class:"mt-3 flex gap-2"},oNt={key:4,class:"flex items-center justify-center h-full"},sNt={class:"text-center"},lNt={class:"text-xl font-bold text-white mb-2"},cNt=e({__name:"SettingsPage",props:{activeSection:{}},setup(a){const n=a,r=t(n.activeSection);R(()=>n.activeSection,e=>{r.value=e});const d=[{id:"BLP",label:"Панель запуска",icon:"MonitorIcon"},{id:"CONSTRUCTOR",label:"Конструктор экрана",icon:"LayoutIcon"},{id:"NW",label:"Пользовательские экраны",icon:"LayoutIcon"},{id:"ALRT",label:"Уведомления",icon:"BellIcon"},{id:"PDF",label:"Личные настройки",icon:"UserIcon"},{id:"SALT",label:"Новостные уведомления",icon:"MailIcon"}],h=[{name:"Технологический рост",type:"Watchlist",count:12,date:"2 часа назад"},{name:"Глобальный макро",type:"Layout",count:"-",date:"1 день назад"},{name:"Крипто ядро",type:"Watchlist",count:5,date:"3 дня назад"},{name:"Сезон отчётов",type:"Layout",count:"-",date:"15 окт"}],g=t(["BTC/USDT","ETH/USDT","AAPL","TSLA"]),y=t(""),x=()=>{y.value.trim()&&!g.value.includes(y.value.trim().toUpperCase())&&(g.value.push(y.value.trim().toUpperCase()),y.value="")},_=[{type:"OrderBook",title:"Стакан",description:"Отображение биржевого стакана с ордерами",icon:"BookIcon",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",defaultWidth:2,defaultHeight:4},{type:"Chart",title:"График цены",description:"Интерактивный график движения цены",icon:"LineChartIcon",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",defaultWidth:6,defaultHeight:4},{type:"News",title:"Новости",description:"Лента последних новостей рынка",icon:"NewspaperIcon",iconBg:"bg-purple-500/20",iconColor:"text-purple-400",defaultWidth:2,defaultHeight:2},{type:"AI",title:"ИИ Аналитик",description:"Анализ рынка с помощью искусственного интеллекта",icon:"BrainIcon",iconBg:"bg-indigo-500/20",iconColor:"text-indigo-400",defaultWidth:2,defaultHeight:2},{type:"Footer",title:"Ордера и позиции",description:"Открытые ордера и текущие позиции",icon:"ListIcon",iconBg:"bg-orange-500/20",iconColor:"text-orange-400",defaultWidth:3,defaultHeight:1},{type:"Markets",title:"Рынки",description:"Топ активов и их изменения",icon:"TrendingUpIcon",iconBg:"bg-green-500/20",iconColor:"text-green-400",defaultWidth:2,defaultHeight:3},{type:"Analytics",title:"Аналитика",description:"Ключевые метрики и показатели",icon:"BarChartIcon",iconBg:"bg-cyan-500/20",iconColor:"text-cyan-400",defaultWidth:2,defaultHeight:2},{type:"VOL",title:"Поверхность волатильности",description:"3D визуализация волатильности по страйкам и экспирациям",icon:"LayersIcon",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",defaultWidth:4,defaultHeight:3},{type:"VOLG",title:"Поверхность волатильности (по грекам)",description:"3D визуализация волатильности по страйкам и экспирациям на основе греков",icon:"LayersIcon",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",defaultWidth:4,defaultHeight:3},{type:"CZF",title:"Citadel Zeta Field",description:"Анализ поля дзета-параметров Citadel",icon:"TargetIcon",iconBg:"bg-indigo-500/20",iconColor:"text-indigo-400",defaultWidth:3,defaultHeight:3},{type:"CVRC",title:"Convolutional Volatility Resolution Clustering",description:"Кластеризация волатильности с использованием сверточных нейросетей",icon:"ActivityIcon",iconBg:"bg-purple-500/20",iconColor:"text-purple-400",defaultWidth:3,defaultHeight:3},{type:"PSR",title:"Phase Space Reconstruction",description:"Реконструкция фазового пространства для анализа динамики",icon:"BarChart2Icon",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",defaultWidth:3,defaultHeight:3},{type:"LVM",title:"Latent Volatility model",description:"Модель скрытой волатильности",icon:"LayersIcon",iconBg:"bg-cyan-500/20",iconColor:"text-cyan-400",defaultWidth:3,defaultHeight:3},{type:"MVS",title:"Momentum-Volatility Surface",description:"Поверхность волатильности с учетом импульса",icon:"TrendingUpIcon",iconBg:"bg-green-500/20",iconColor:"text-green-400",defaultWidth:3,defaultHeight:3},{type:"LIQ",title:"Liquidity Model",description:"Модель ликвидности рынка",icon:"ActivityIcon",iconBg:"bg-teal-500/20",iconColor:"text-teal-400",defaultWidth:3,defaultHeight:3},{type:"HMM",title:"HMM regime model visualization",description:"Визуализация режимов скрытой марковской модели",icon:"PieChartIcon",iconBg:"bg-pink-500/20",iconColor:"text-pink-400",defaultWidth:3,defaultHeight:3},{type:"TSIG",title:"Time series с сигналами",description:"Линейный/бар чарт цены + наложение флагов buy/sell",icon:"ChartBarIcon",iconBg:"bg-yellow-500/20",iconColor:"text-yellow-400",defaultWidth:4,defaultHeight:3},{type:"CORR",title:"Correlation heatmap",description:"Цветная матрица корреляций",icon:"TableCellsIcon",iconBg:"bg-orange-500/20",iconColor:"text-orange-400",defaultWidth:3,defaultHeight:3},{type:"HMMD",title:"HMM state diagram",description:"Граф состояний + timeline colors",icon:"ShareIcon",iconBg:"bg-violet-500/20",iconColor:"text-violet-400",defaultWidth:3,defaultHeight:3},{type:"ZSCR",title:"Z‑score residuals",description:"Линейный график отклонений",icon:"TrendingDownIcon",iconBg:"bg-red-500/20",iconColor:"text-red-400",defaultWidth:3,defaultHeight:2},{type:"OBHM",title:"Order book heatmap",description:"Цветная карта глубины стакана",icon:"Squares2X2Icon",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",defaultWidth:3,defaultHeight:3},{type:"ENSD",title:"Ensemble signal distribution",description:"Гистограмма/confidence bands",icon:"Bars3Icon",iconBg:"bg-lime-500/20",iconColor:"text-lime-400",defaultWidth:3,defaultHeight:2},{type:"FEAT",title:"Feature importance bar chart",description:"Столбцы значимости факторов",icon:"BarChart3Icon",iconBg:"bg-sky-500/20",iconColor:"text-sky-400",defaultWidth:3,defaultHeight:2},{type:"DDSH",title:"Drawdown/Sharpe timeline",description:"Накопленный график + метрики",icon:"LineChartIcon",iconBg:"bg-rose-500/20",iconColor:"text-rose-400",defaultWidth:4,defaultHeight:2},{type:"EXEC",title:"Latency/slippage scatter",description:"Точечный график execution metrics",icon:"ScatterIcon",iconBg:"bg-fuchsia-500/20",iconColor:"text-fuchsia-400",defaultWidth:3,defaultHeight:3},{type:"EXPO",title:"Turnover/exposure matrix",description:"Heatmap позиций по активам",icon:"TableCellsIcon",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",defaultWidth:3,defaultHeight:3},{type:"OB3D",title:"Объёмная карта ордербука (3D Depth Map)",description:"Трёхмерная визуализация глубины стакана",icon:"LayersIcon",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",defaultWidth:4,defaultHeight:3},{type:"TVCN",title:"Динамическая корреляционная сеть",description:"Сетевая визуализация корреляций во времени",icon:"ShareIcon",iconBg:"bg-indigo-500/20",iconColor:"text-indigo-400",defaultWidth:3,defaultHeight:3},{type:"CTENSOR",title:"Ковариационный куб",description:"Трёхмерное представление ковариационной матрицы",icon:"Squares2X2Icon",iconBg:"bg-purple-500/20",iconColor:"text-purple-400",defaultWidth:3,defaultHeight:3},{type:"HELIX",title:"Объёмно‑временная спираль ликвидности",description:"Спиральная визуализация ликвидности во времени",icon:"ActivityIcon",iconBg:"bg-cyan-500/20",iconColor:"text-cyan-400",defaultWidth:3,defaultHeight:3},{type:"HYPERCUBE",title:"Пространство корреляций во времени",description:"Гиперкубическое представление корреляций",icon:"Squares2X2Icon",iconBg:"bg-teal-500/20",iconColor:"text-teal-400",defaultWidth:3,defaultHeight:3},{type:"VORTEX",title:"Вихрь рыночных настроений",description:"Вихревая визуализация рыночных настроений",icon:"ActivityIcon",iconBg:"bg-pink-500/20",iconColor:"text-pink-400",defaultWidth:3,defaultHeight:3},{type:"PLASMA",title:"«Плазма» потока опционных сделок",description:"Визуализация потока опционных сделок как заряженных частиц",icon:"ActivityIcon",iconBg:"bg-yellow-500/20",iconColor:"text-yellow-400",defaultWidth:4,defaultHeight:3},{type:"LATTICE",title:"«Кристаллическая решетка аукциона»",description:"3D-структура истории и текущего состояния аукциона",icon:"Squares2X2Icon",iconBg:"bg-orange-500/20",iconColor:"text-orange-400",defaultWidth:3,defaultHeight:3},{type:"TICKCORE",title:"«Тактовый сердечник» процессора исполнения",description:"Визуализация нагрузки и задержек в обработке рыночных данных",icon:"ActivityIcon",iconBg:"bg-violet-500/20",iconColor:"text-violet-400",defaultWidth:3,defaultHeight:3},{type:"GREEKS3D",title:"3D Greeks Tensor",description:"Трёхмерный тензор греков для портфеля опционов",icon:"LayersIcon",iconBg:"bg-red-500/20",iconColor:"text-red-400",defaultWidth:4,defaultHeight:3},{type:"REGNET",title:"Regime Correlation Network",description:"3D‑граф корреляций с HMM режимами",icon:"ShareIcon",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",defaultWidth:3,defaultHeight:3},{type:"TAILCUBE",title:"Tail Risk Cube",description:"Куб стресс-сценариев с EVT для tails",icon:"Squares2X2Icon",iconBg:"bg-lime-500/20",iconColor:"text-lime-400",defaultWidth:3,defaultHeight:3},{type:"WSIGMA",title:"WAVE_σ.9",description:"Топология моментума и режимы торговли",icon:"ActivityIcon",iconBg:"bg-orange-500/20",iconColor:"text-orange-400",defaultWidth:6,defaultHeight:4}],S=t((()=>{const e=localStorage.getItem("terminal-widgets");if(e)try{return JSON.parse(e).map(e=>{const t=_.find(t=>t.type===e.type);return{...e,title:e.title||t?.title||e.type,description:e.description||t?.description||"",icon:e.icon||t?.icon||"LayoutIcon",iconBg:e.iconBg||t?.iconBg||"bg-gray-500/20",iconColor:e.iconColor||t?.iconColor||"text-gray-400",code:e.code||e.type}})}catch(TQe){console.error("Failed to load widgets:",TQe)}return[]})());R(()=>S.value.length,e=>{console.log("Active widgets count:",e),e>0&&console.log("Widgets:",S.value)},{immediate:!0});const M={OrderBook:_Rt,Chart:ORt,News:GRt,AI:pDt,Footer:vDt,Markets:MDt,Analytics:TDt,VOL:LDt,VOLG:LDt,CZF:LDt,CVRC:LDt,PSR:LDt,LVM:LDt,MVS:LDt,LIQ:LDt,HMM:LDt,TSIG:LDt,CORR:LDt,HMMD:LDt,ZSCR:LDt,OBHM:LDt,ENSD:LDt,FEAT:LDt,DDSH:LDt,EXEC:LDt,EXPO:LDt,OB3D:LDt,TVCN:LDt,CTENSOR:LDt,HELIX:LDt,HYPERCUBE:LDt,VORTEX:LDt,PLASMA:LDt,LATTICE:LDt,TICKCORE:LDt,GREEKS3D:LDt,REGNET:LDt,TAILCUBE:LDt,WSIGMA:cLt},A=()=>{const e=S.value.map(e=>({id:e.id,type:e.type,title:e.title,description:e.description||"",icon:e.icon,iconBg:e.iconBg,iconColor:e.iconColor,code:e.code||e.type,width:e.width,height:e.height}));localStorage.setItem("terminal-widgets",JSON.stringify(e)),window.dispatchEvent(new Event("widgets-updated"))},E={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>'},D={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>'},P={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/></svg>'},L={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>'},N={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>'},F={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>'},B={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>'},z=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),G("line",{x1:"6",y1:"6",x2:"18",y2:"18"})])});return(e,t)=>(w(),i("div",uLt,[s("div",dLt,[t[1]||(t[1]=s("div",{class:"settings-sidebar-header"},[s("h2",{class:"settings-title font-oswald"},"НАСТРОЙКИ"),s("p",{class:"settings-subtitle font-mono"},"Конфигурация системы")],-1)),(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>r.value=e.id,class:c(["settings-menu-item font-oswald",{"settings-menu-active":r.value===e.id}])},v(e.label),11,hLt)),64))]),s("div",pLt,["BLP"===r.value?(w(),i("div",fLt,[t[6]||(t[6]=s("div",null,[s("h3",{class:"text-2xl font-bold text-white mb-2"},"Мониторинг панели"),s("p",{class:"text-sm text-gray-400"},"Настройте рабочие пространства и пользовательские панели.")],-1)),s("div",mLt,[s("div",vLt,[s("div",gLt,[s("div",yLt,[u(E,{class:"w-6 h-6"})]),t[2]||(t[2]=s("span",{class:"bg-emerald-500/10 text-emerald-400 text-xs px-2 py-1 rounded border border-emerald-500/20"},"Активно",-1))]),t[3]||(t[3]=I('<h4 class="text-lg font-bold text-white mb-1" data-v-aff7ecf3>Главный терминал</h4><p class="text-xs text-gray-500 mb-4" data-v-aff7ecf3>4 графика, стакан, лента новостей</p><div class="h-24 bg-black/40 rounded-lg border border-white/5 relative overflow-hidden" data-v-aff7ecf3><div class="absolute top-2 left-2 right-2 bottom-2 grid grid-cols-3 gap-1 opacity-50" data-v-aff7ecf3><div class="col-span-2 bg-white/20 rounded" data-v-aff7ecf3></div><div class="bg-white/20 rounded" data-v-aff7ecf3></div><div class="col-span-3 h-8 bg-white/20 rounded mt-auto" data-v-aff7ecf3></div></div></div>',3))]),s("div",bLt,[s("div",xLt,[u(D,{class:"w-6 h-6 text-gray-400"})]),t[4]||(t[4]=s("h4",{class:"text-sm font-bold text-white"},"Создать монитор",-1)),t[5]||(t[5]=s("p",{class:"text-xs text-gray-500 mt-1"},"Начать с нуля или шаблона",-1))])])])):"CONSTRUCTOR"===r.value?(w(),i("div",wLt,[t[11]||(t[11]=s("div",null,[s("h3",{class:"text-2xl font-bold text-white mb-2"},"Конструктор экрана"),s("p",{class:"text-sm text-gray-400"},"Добавляйте и настраивайте виджеты для главной страницы терминала.")],-1)),s("div",null,[t[8]||(t[8]=s("h4",{class:"text-lg font-bold text-white mb-4"},"Доступные виджеты",-1)),s("div",_Lt,[(w(),i(p,null,f(_,e=>s("div",{key:e.type,class:"p-4 rounded-xl bg-white/5 border border-white/5 hover:border-indigo-500/50 transition-colors cursor-pointer group",onClick:t=>(e=>{const t={id:`${e.type}-${Date.now()}`,type:e.type,title:e.title,description:e.description,icon:e.icon,iconBg:e.iconBg,iconColor:e.iconColor,code:e.type,width:e.defaultWidth,height:e.defaultHeight};S.value.push(t),A()})(e)},[s("div",MLt,[s("div",{class:c(`p-2 rounded-lg ${e.iconBg}`)},[(w(),b(C(e.icon),{class:c(`w-5 h-5 ${e.iconColor}`)},null,8,["class"]))],2),s("div",null,[s("h5",TLt,v(e.title),1),s("p",kLt,v(e.description),1)])]),s("div",CLt,[t[7]||(t[7]=s("span",null,"Размер:",-1)),s("span",ALt,v(e.defaultWidth)+"×"+v(e.defaultHeight),1)])],8,SLt)),64))])]),s("div",null,[s("div",ELt,[t[9]||(t[9]=s("h4",{class:"text-lg font-bold text-white"},"Предпросмотр экрана",-1)),s("span",ILt,v(S.value.length)+" виджетов",1)]),s("div",RLt,[0===S.value.length?(w(),i("div",DLt,[...t[10]||(t[10]=[s("div",null,[s("div",{class:"text-gray-500 text-sm mb-2"},"Нет активных виджетов"),s("div",{class:"text-xs text-gray-600 mb-4"},"Добавьте виджеты из списка выше"),s("div",{class:"text-xs text-gray-700"},'Кликните на любой виджет из списка "Доступные виджеты"')],-1)])])):(w(),i("div",PLt,[(w(!0),i(p,null,f(S.value,e=>{return w(),b(C((t=e.type,M[t]||(console.warn(`Widget component not found for type: ${t}, using QuantitativeToolWidget`),LDt))),o({key:e.id},{ref_for:!0},(e=>{const t=_.find(t=>t.type===e.type);return M[e.type]===LDt?{type:e.type,title:e.title||t?.title||e.type,description:e.description||t?.description||"",icon:e.icon||t?.icon||"ActivityIcon",iconBg:e.iconBg||t?.iconBg||"bg-emerald-500/20",iconColor:e.iconColor||t?.iconColor||"text-emerald-400",code:e.code||e.type,selectedAsset:""}:{bids:[],asks:[],currentPrice:0,data:[],symbol:"BTC/USDT"}})(e),{width:e.width,height:e.height,resizable:!0,"show-controls":!0,onRemove:t=>(e=>{const t=S.value.find(t=>t.id===e);t&&confirm(`Удалить виджет "${t.title}"?`)&&(S.value=S.value.filter(t=>t.id!==e),A())})(e.id),onResize:(t,a)=>((e,t,a)=>{const n=S.value.find(t=>t.id===e);n&&(n.width=t,n.height=a,A())})(e.id,t,a),style:{gridColumn:`span ${e.width}`,gridRow:`span ${e.height}`}}),null,16,["width","height","onRemove","onResize","style"]);var t}),128))]))])])])):"NW"===r.value?(w(),i("div",LLt,[s("div",NLt,[t[13]||(t[13]=s("div",null,[s("h3",{class:"text-2xl font-bold text-white mb-2"},"Рабочие листы и списки"),s("p",{class:"text-sm text-gray-400"},"Управляйте пользовательскими экранами и списками активов.")],-1)),s("button",OLt,[u(D,{class:"w-3.5 h-3.5"}),t[12]||(t[12]=m(" Новый лист ",-1))])]),s("div",FLt,[s("table",BLt,[t[14]||(t[14]=s("thead",null,[s("tr",{class:"bg-white/5 text-xs text-gray-500 uppercase border-b border-white/10"},[s("th",{class:"p-4"},"Имя"),s("th",{class:"p-4"},"Тип"),s("th",{class:"p-4"},"Активы"),s("th",{class:"p-4"},"Изменено"),s("th",{class:"p-4 text-right"},"Действия")])],-1)),s("tbody",ULt,[(w(),i(p,null,f(h,(e,t)=>s("tr",{key:t,class:"border-b border-white/5 hover:bg-white/5 transition-colors"},[s("td",zLt,v(e.name),1),s("td",VLt,[s("span",{class:c("px-2 py-1 rounded text-xs border "+("Watchlist"===e.type?"bg-blue-500/10 border-blue-500/20 text-blue-400":"bg-purple-500/10 border-purple-500/20 text-purple-400"))},v("Watchlist"===e.type?"Список":"Макет"),3)]),s("td",HLt,v(e.count),1),s("td",GLt,v(e.date),1),s("td",WLt,[s("button",qLt,[u(P,{class:"w-3.5 h-3.5"})])])])),64))])])])])):"PDF"===r.value?(w(),i("div",YLt,[t[25]||(t[25]=s("div",null,[s("h3",{class:"text-2xl font-bold text-white mb-2"},"Личные предпочтения"),s("p",{class:"text-sm text-gray-400"},"Настройте работу терминала под себя.")],-1)),s("div",jLt,[s("div",XLt,[s("div",null,[t[16]||(t[16]=s("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-2"},"Язык",-1)),s("div",$Lt,[u(L,{class:"w-4 h-4 text-gray-400"}),t[15]||(t[15]=s("select",{class:"bg-transparent text-white text-sm outline-none flex-1"},[s("option",null,"Английский (US)"),s("option",null,"Русский"),s("option",null,"Китайский (упрощённый)")],-1))])]),t[19]||(t[19]=s("div",null,[s("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-2"},"Валюта по умолчанию"),s("div",{class:"flex items-center gap-2 p-3 bg-black/20 rounded-xl border border-white/10"},[s("span",{class:"text-gray-400 text-sm font-bold"},"$"),s("select",{class:"bg-transparent text-white text-sm outline-none flex-1"},[s("option",null,"USD - Доллар США"),s("option",null,"EUR - Евро"),s("option",null,"RUB - Российский рубль")])])],-1)),s("div",null,[t[18]||(t[18]=s("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-2"},"Часовой пояс",-1)),s("div",KLt,[u(N,{class:"w-4 h-4 text-gray-400"}),t[17]||(t[17]=s("select",{class:"bg-transparent text-white text-sm outline-none flex-1"},[s("option",null,"UTC-05:00 (Восточное время)"),s("option",null,"UTC+00:00 (Лондон)"),s("option",null,"UTC+03:00 (Москва)")],-1))])])]),s("div",ZLt,[s("div",null,[t[22]||(t[22]=s("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-2"},"Тема",-1)),s("div",JLt,[s("button",QLt,[u(F,{class:"w-4 h-4"}),t[20]||(t[20]=m(" Тёмная (Pro) ",-1))]),s("button",eNt,[u(B,{class:"w-4 h-4"}),t[21]||(t[21]=m(" Светлая ",-1))])])]),t[24]||(t[24]=s("div",null,[s("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-2"},"Плотность макета"),s("div",{class:"flex bg-black/20 rounded-xl p-1 border border-white/10"},[s("button",{class:"flex-1 py-2 text-xs font-bold text-gray-500 hover:text-white"},"Комфортная"),s("button",{class:"flex-1 py-2 text-xs font-bold text-white bg-white/10 rounded-lg shadow"},"Компактная")])],-1)),s("div",null,[t[23]||(t[23]=s("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-2"},"Избранные активы",-1)),s("div",tNt,[(w(!0),i(p,null,f(g.value,e=>(w(),i("div",{key:e,class:"flex items-center justify-between p-2 bg-black/20 rounded-lg border border-white/5 hover:bg-white/5 transition-colors"},[s("span",aNt,v(e),1),s("button",{onClick:t=>(e=>{g.value=g.value.filter(t=>t!==e)})(e),class:"text-gray-500 hover:text-rose-400 transition-colors"},[u(O(z),{class:"w-4 h-4"})],8,nNt)]))),128)),0===g.value.length?(w(),i("div",rNt," Нет избранных активов ")):l("",!0)]),s("div",iNt,[T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),onKeyup:U(x,["enter"]),type:"text",placeholder:"Введите тикер (например: BTC/USDT)",class:"flex-1 bg-black/20 border border-white/10 rounded-lg py-2 px-3 text-sm text-white focus:border-indigo-500/50 outline-none"},null,544),[[k,y.value]]),s("button",{onClick:x,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold transition-colors"}," Добавить ")])])])])])):(w(),i("div",oNt,[s("div",sNt,[s("h3",lNt,v(r.value)+" Раздел",1),t[26]||(t[26]=s("p",{class:"text-gray-400"},"Содержимое появится в ближайшее время",-1))])]))])]))}}),uNt=xe(cNt,[["__scopeId","data-v-aff7ecf3"]]),dNt={class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},hNt={class:"relative w-full max-w-lg data-panel overflow-hidden transition-all transform scale-100 flex flex-col max-h-[90vh]"},pNt={class:"p-6 border-b border-white/5 flex items-start justify-between bg-white/5"},fNt={class:"flex items-center gap-4"},mNt={class:"text-2xl font-bold text-white tracking-tight"},vNt={class:"flex items-center gap-2 text-sm text-gray-400"},gNt={class:"font-mono"},yNt={class:"bg-white/10 px-1.5 py-0.5 rounded text-[10px] uppercase"},bNt={class:"overflow-y-auto custom-scrollbar"},xNt={class:"p-6"},wNt={class:"flex items-baseline gap-4 mb-6"},_Nt={class:"text-4xl font-mono font-bold text-white"},SNt={class:"h-48 w-full bg-black/20 rounded-xl border border-white/5 overflow-hidden relative mb-6"},MNt={class:"grid grid-cols-2 gap-3 mb-6"},TNt={class:"p-3 rounded-xl bg-white/5 border border-white/5"},kNt={class:"flex items-center gap-2 text-gray-500 text-xs mb-1"},CNt={class:"font-mono text-white font-medium"},ANt={class:"p-3 rounded-xl bg-white/5 border border-white/5"},ENt={class:"flex items-center gap-2 text-gray-500 text-xs mb-1"},INt={class:"font-mono text-white font-medium"},RNt={class:"p-3 rounded-xl bg-white/5 border border-white/5"},DNt={class:"flex items-center gap-2 text-gray-500 text-xs mb-1"},PNt={class:"font-mono text-white font-medium"},LNt={class:"p-3 rounded-xl bg-white/5 border border-white/5"},NNt={class:"flex items-center gap-2 text-gray-500 text-xs mb-1"},ONt={class:"font-mono text-white font-medium"},FNt={class:"mb-6"},BNt={class:"text-sm font-bold text-white mb-2 flex items-center gap-2"},UNt={class:"text-xs text-gray-400 leading-relaxed"},zNt={class:"p-4 border-t border-white/5 bg-black/20 backdrop-blur-md flex gap-3"},VNt={class:"flex-1 py-3 rounded-xl bg-white/10 hover:bg-white/20 text-white font-bold text-sm transition-colors flex items-center justify-center gap-2 border border-white/5"},HNt=e({__name:"AssetDetailModal",props:{asset:{}},emits:["close","trade"],setup(e,{emit:t}){Qet([Wnt,Irt,fwt,Agt]);const a=e,n=t,r=S(()=>a.asset.change.startsWith("+")),o=S(()=>hze(30)),l=S(()=>parseFloat(a.asset.price.replace(/[^0-9.]/g,""))),d=S(()=>(1.05*l.value).toFixed(2)),h=S(()=>(.95*l.value).toFixed(2)),p=S(()=>({grid:{left:0,right:0,top:20,bottom:0},xAxis:{type:"category",show:!1,data:o.value.map((e,t)=>t)},yAxis:{type:"value",show:!1},series:[{type:"line",data:o.value.map(e=>e.close),smooth:!0,symbol:"none",lineStyle:{color:r.value?"#10B981":"#F43F5E",width:2},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:r.value?"rgba(16, 185, 129, 0.3)":"rgba(244, 63, 94, 0.3)"},{offset:1,color:r.value?"rgba(16, 185, 129, 0)":"rgba(244, 63, 94, 0)"}]}}}],tooltip:{backgroundColor:"rgba(0,0,0,0.8)",borderColor:"transparent",textStyle:{color:"#fff",fontSize:12}}})),f=()=>{n("trade",a.asset.symbol),n("close")},g={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>'},y={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'},x={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>'},_={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>'},M={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>'},T={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>'},k={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>'};return(t,a)=>(w(),i("div",dNt,[s("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:a[0]||(a[0]=e=>t.$emit("close"))}),s("div",hNt,[s("div",pNt,[s("div",fNt,[s("div",{class:c("w-14 h-14 rounded-2xl flex items-center justify-center text-xl font-bold shadow-lg "+("Crypto"===e.asset.category?"bg-gradient-to-br from-orange-500/20 to-yellow-500/20 text-orange-400":"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 text-blue-400"))},v(e.asset.symbol.substring(0,2)),3),s("div",null,[s("h2",mNt,v(e.asset.name),1),s("div",vNt,[s("span",gNt,v(e.asset.symbol),1),a[2]||(a[2]=s("span",{class:"w-1 h-1 rounded-full bg-gray-600"},null,-1)),s("span",yNt,v(e.asset.category||"Asset"),1)])])]),s("button",{onClick:a[1]||(a[1]=e=>t.$emit("close")),class:"p-2 rounded-full hover:bg-white/10 text-gray-400 hover:text-white transition-colors"},[u(g,{class:"w-5 h-5"})])]),s("div",bNt,[s("div",xNt,[s("div",wNt,[s("span",_Nt,v(e.asset.price),1),s("div",{class:c("flex items-center gap-1 px-2 py-1 rounded-lg text-sm font-bold "+(r.value?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"))},[(w(),b(C(r.value?"TrendingUpIcon":"TrendingDownIcon"),{class:"w-4 h-4"})),m(" "+v(e.asset.change),1)],2)]),s("div",SNt,[a[3]||(a[3]=s("div",{class:"absolute top-3 left-3 z-10 text-[10px] font-bold text-gray-500 uppercase tracking-wider"},"1H Performance",-1)),u(O(aTt),{class:"w-full h-full",option:p.value,autoresize:""},null,8,["option"])]),s("div",MNt,[s("div",TNt,[s("div",kNt,[u(y,{class:"w-3 h-3"}),a[4]||(a[4]=m(" Vol (24h) ",-1))]),s("div",CNt,v(e.asset.vol||"1.2B"),1)]),s("div",ANt,[s("div",ENt,[u(x,{class:"w-3 h-3"}),a[5]||(a[5]=m(" Mkt Cap ",-1))]),s("div",INt,v(e.asset.cap||"850M"),1)]),s("div",RNt,[s("div",DNt,[u(_,{class:"w-3 h-3"}),a[6]||(a[6]=m(" High (24h) ",-1))]),s("div",PNt,v(d.value),1)]),s("div",LNt,[s("div",NNt,[u(_,{class:"w-3 h-3"}),a[7]||(a[7]=m(" Low (24h) ",-1))]),s("div",ONt,v(h.value),1)])]),s("div",FNt,[s("h3",BNt,[u(M,{class:"w-3.5 h-3.5 text-indigo-400"}),m(" About "+v(e.asset.name),1)]),s("p",UNt,v(e.asset.name)+" is a leading digital asset in the "+v(e.asset.category||"Global")+" market. It has shown significant volatility in the last 24 hours. Smart contract capability and decentralized nature make it a key player in the ecosystem. ",1)])])]),s("div",zNt,[s("button",VNt,[u(T,{class:"w-4 h-4"}),a[8]||(a[8]=m(" Favorite ",-1))]),s("button",{onClick:f,class:"flex-[2] py-3 rounded-xl bg-white text-black font-bold text-sm hover:scale-[1.02] transition-transform shadow-lg shadow-white/10 flex items-center justify-center gap-2"},[a[9]||(a[9]=m(" Go to Analysis ",-1)),u(k,{class:"w-4 h-4"})])])])]))}}),GNt={class:"page-container custom-scrollbar"},WNt={class:"section-header flex-col md:flex-row gap-4"},qNt={class:"flex items-center gap-4"},YNt={class:"icon-box icon-green"},jNt={class:"tab-group"},XNt=["onClick"],$Nt={class:"flex-1 flex flex-col gap-6"},KNt=e({__name:"BondMarketPage",props:{activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[G("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),G("polyline",{points:"2 17 12 22 22 17"}),G("polyline",{points:"2 12 12 17 22 12"})])}),r=a,o=t(r.activeSection||"BBT");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"BBT",label:"ОФЗ"},{id:"ALLQ",label:"Все виды облигаций"},{id:"PICK",label:"Bond Picks"},{id:"WB",label:"Монитор"},{id:"NIM",label:"Новые выпуски"}],d=e({setup:()=>({bonds:[{id:"26238",mat:"15/05/2041",cpn:"7.10%",price:"68.450",yld:"12.45%",spread:"2bp",vol:"1.2B"},{id:"26243",mat:"19/05/2038",cpn:"9.80%",price:"82.150",yld:"12.20%",spread:"3bp",vol:"850M"},{id:"26244",mat:"15/03/2034",cpn:"11.25%",price:"94.200",yld:"11.95%",spread:"2bp",vol:"2.1B"},{id:"26242",mat:"29/08/2029",cpn:"9.00%",price:"88.500",yld:"11.50%",spread:"1bp",vol:"540M"},{id:"26241",mat:"17/11/2032",cpn:"9.50%",price:"85.600",yld:"11.85%",spread:"4bp",vol:"320M"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">RGBI Index</h3>\n          <div class="text-3xl font-bold text-rose-400">112.45</div>\n          <div class="text-xs text-rose-500 mt-1">-0.45% (Intraday)</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Avg Yield (10Y)</h3>\n          <div class="text-3xl font-bold text-white">12.15%</div>\n          <div class="text-xs text-emerald-400 mt-1">+5bps vs Prev Close</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Total Turnover</h3>\n          <div class="text-3xl font-bold text-white">14.2B</div>\n          <div class="text-xs text-gray-500 mt-1">RUB</div>\n        </div>\n      </div>\n\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse">\n          <thead>\n            <tr class="text-xs text-gray-400 uppercase bg-white/5 sticky top-0 backdrop-blur-md z-10">\n              <th class="p-4 font-bold">Issue / Ticker</th>\n              <th class="p-4 font-bold">Maturity</th>\n              <th class="p-4 font-bold text-right">Coupon</th>\n              <th class="p-4 font-bold text-right">Price</th>\n              <th class="p-4 font-bold text-right">Yield</th>\n              <th class="p-4 font-bold text-right">B/A Spread</th>\n              <th class="p-4 font-bold text-right">Volume</th>\n            </tr>\n          </thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr v-for="(bond, i) in bonds" :key="i" class="border-b border-white/5 hover:bg-white/5 transition-colors group cursor-pointer">\n              <td class="p-4 font-bold text-white group-hover:text-teal-400">{{ bond.id }}</td>\n              <td class="p-4">{{ bond.mat }}</td>\n              <td class="p-4 text-right text-gray-400">{{ bond.cpn }}</td>\n              <td class="p-4 text-right font-bold text-white">{{ bond.price }}</td>\n              <td class="p-4 text-right text-teal-400">{{ bond.yld }}</td>\n              <td class="p-4 text-right text-gray-500">{{ bond.spread }}</td>\n              <td class="p-4 text-right">{{ bond.vol }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),h=e({setup:()=>({quotes:[{ticker:"GAZP 34",dealer:"JPM",bidSize:"5M",bid:"92.45",ask:"92.65",askSize:"2M",time:"14:20:05"},{ticker:"LUK 30",dealer:"GSI",bidSize:"1M",bid:"88.10",ask:"88.40",askSize:"5M",time:"14:20:02"},{ticker:"SBER 28",dealer:"MS",bidSize:"10M",bid:"95.00",ask:"95.15",askSize:"10M",time:"14:19:55"},{ticker:"RUAL 27",dealer:"CITI",bidSize:"500k",bid:"84.20",ask:"84.80",askSize:"1M",time:"14:19:40"},{ticker:"NOV 29",dealer:"VTB",bidSize:"2M",bid:"90.50",ask:"90.75",askSize:"3M",time:"14:19:12"}]}),template:'\n    <div class="flex flex-col h-full">\n      <div class="flex justify-between items-center mb-6">\n        <div class="flex items-center gap-3">\n          <h3 class="text-lg font-bold text-white">Corporate Quotes Monitor</h3>\n          <span class="text-[10px] bg-green-500/20 text-green-400 px-2 py-0.5 rounded border border-green-500/20 flex items-center gap-1">\n            <span class="animate-pulse">●</span> Stream Active\n          </span>\n        </div>\n        <div class="flex gap-2">\n          <input type="text" placeholder="Filter by Ticker..." class="bg-black/30 border border-white/10 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:border-teal-500/50" />\n        </div>\n      </div>\n\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 overflow-hidden">\n        <table class="w-full text-left border-collapse">\n          <thead>\n            <tr class="text-xs text-gray-500 uppercase bg-white/5 border-b border-white/10">\n              <th class="p-4">Time</th>\n              <th class="p-4">Ticker</th>\n              <th class="p-4">Dealer</th>\n              <th class="p-4 text-right">Bid Size</th>\n              <th class="p-4 text-right text-emerald-400">Bid</th>\n              <th class="p-4 text-right text-rose-400">Ask</th>\n              <th class="p-4 text-right">Ask Size</th>\n              <th class="p-4 text-right">Spread</th>\n            </tr>\n          </thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr v-for="(q, i) in quotes" :key="i" class="border-b border-white/5 hover:bg-white/5 transition-colors">\n              <td class="p-4 text-gray-500 text-xs">{{ q.time }}</td>\n              <td class="p-4 font-bold text-white">{{ q.ticker }}</td>\n              <td class="p-4 text-teal-300">{{ q.dealer }}</td>\n              <td class="p-4 text-right">{{ q.bidSize }}</td>\n              <td class="p-4 text-right font-bold text-emerald-400 bg-emerald-500/5">{{ q.bid }}</td>\n              <td class="p-4 text-right font-bold text-rose-400 bg-rose-500/5">{{ q.ask }}</td>\n              <td class="p-4 text-right">{{ q.askSize }}</td>\n              <td class="p-4 text-right text-xs text-gray-500">{{ (parseFloat(q.ask) - parseFloat(q.bid)).toFixed(2) }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),g=e({setup:()=>({picks:[{issuer:"Apple Inc",tenor:"5Y",rating:"AA+",yield:"4.25%",spread:"+45bp",rationale:"Strong cash flow, defensive play in tech."},{issuer:"JPMorgan Chase",tenor:"10Y",rating:"A-",yield:"5.10%",spread:"+95bp",rationale:"Attractive spread vs historicals."},{issuer:"Verizon Comm",tenor:"30Y",rating:"BBB+",yield:"5.85%",spread:"+140bp",rationale:"Yield pickup for long duration exposure."},{issuer:"Ford Motor",tenor:"3Y",rating:"BB+",yield:"6.50%",spread:"+210bp",rationale:"Improving credit metrics, upgrade candidate."}]}),template:'\n    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">\n      <div v-for="(pick, i) in picks" :key="i" class="p-6 rounded-2xl bg-white/5 border border-white/5 hover:border-teal-500/30 transition-colors group cursor-pointer relative overflow-hidden">\n        <div class="flex justify-between items-start mb-4">\n          <div>\n            <h4 class="text-lg font-bold text-white">{{ pick.issuer }}</h4>\n            <div class="flex gap-2 mt-1">\n              <span class="text-xs bg-white/10 px-2 py-0.5 rounded text-gray-300">{{ pick.tenor }}</span>\n              <span :class="[\'text-xs px-2 py-0.5 rounded font-bold\', pick.rating.startsWith(\'A\') ? \'bg-emerald-500/20 text-emerald-400\' : \'bg-yellow-500/20 text-yellow-400\']">\n                {{ pick.rating }}\n              </span>\n            </div>\n          </div>\n          <div class="text-right">\n            <div class="text-2xl font-bold text-teal-400">{{ pick.yield }}</div>\n            <div class="text-xs text-gray-500 uppercase">Yield</div>\n          </div>\n        </div>\n        \n        <div class="mb-4">\n          <span class="text-xs text-gray-500 uppercase font-bold">OAS Spread</span>\n          <div class="text-sm font-mono text-white">{{ pick.spread }}</div>\n        </div>\n\n        <div class="pt-4 border-t border-white/10">\n          <p class="text-xs text-gray-400 italic">"{{ pick.rationale }}"</p>\n        </div>\n      </div>\n    </div>\n  '}),y=e({setup:()=>({data:[{country:"US",yield:4.25,spread:185},{country:"UK",yield:4.1,spread:170},{country:"France",yield:2.9,spread:50},{country:"Italy",yield:3.85,spread:145},{country:"Spain",yield:3.25,spread:85},{country:"Japan",yield:.85,spread:-155},{country:"Brazil",yield:10.5,spread:810}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">\n        <div class="bg-black/20 rounded-2xl border border-white/5 p-6 flex flex-col">\n          <h3 class="text-lg font-bold text-white mb-6">10Y Yield Comparison</h3>\n          <div class="flex-1 min-h-[250px] flex items-center justify-center text-gray-500">\n            [Chart: Yield Comparison]\n          </div>\n        </div>\n\n        <div class="bg-white/5 rounded-2xl border border-white/5 p-6">\n          <h3 class="text-lg font-bold text-white mb-6">Spread vs Bunds (DE)</h3>\n          <div class="overflow-auto custom-scrollbar max-h-[300px]">\n            <table class="w-full text-left">\n              <thead>\n                <tr class="text-xs text-gray-500 uppercase border-b border-white/10">\n                  <th class="pb-3">Country</th>\n                  <th class="pb-3 text-right">Yield</th>\n                  <th class="pb-3 text-right">Spread (bps)</th>\n                  <th class="pb-3 text-right">1D Chg</th>\n                </tr>\n              </thead>\n              <tbody class="text-sm font-mono">\n                <tr v-for="(row, i) in data" :key="i" class="border-b border-white/5 hover:bg-white/5">\n                  <td class="py-3 font-bold text-white">{{ row.country }}</td>\n                  <td class="py-3 text-right text-gray-300">{{ row.yield.toFixed(2) }}%</td>\n                  <td :class="[\'py-3 text-right font-bold\', row.spread > 100 ? \'text-rose-400\' : \'text-teal-400\']">\n                    {{ row.spread > 0 ? \'+\' : \'\' }}{{ row.spread }}\n                  </td>\n                  <td class="py-3 text-right text-gray-500">\n                    {{ (Math.random() * 5 - 2.5).toFixed(1) }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  '}),x=e({setup:()=>({deals:[{date:"26 Oct",issuer:"Coca-Cola Co",rating:"A+",tenor:"10Y",size:"$1.5B",ipt:"T+85bp",status:"Announced"},{date:"26 Oct",issuer:"Pfizer Inc",rating:"A",tenor:"30Y",size:"$2.0B",ipt:"T+110bp",status:"Book Building"},{date:"27 Oct",issuer:"Oracle Corp",rating:"BBB+",tenor:"5Y",size:"$1.0B",ipt:"T+95bp",status:"Rumored"},{date:"28 Oct",issuer:"Kingdom of Saudi Arabia",rating:"A",tenor:"12Y",size:"$5.0B",ipt:"T+145bp",status:"Roadshow"}]}),template:'\n    <div class="flex flex-col h-full">\n      <div class="flex gap-4 mb-6">\n        <div class="p-4 rounded-xl bg-indigo-500/10 border border-indigo-500/20 flex-1">\n          <div class="text-xs text-indigo-400 uppercase font-bold mb-1">Expected Weekly Volume</div>\n          <div class="text-2xl font-bold text-white">$24.5B</div>\n        </div>\n        <div class="p-4 rounded-xl bg-teal-500/10 border border-teal-500/20 flex-1">\n          <div class="text-xs text-teal-400 uppercase font-bold mb-1">Active Deals</div>\n          <div class="text-2xl font-bold text-white">12</div>\n        </div>\n        <div class="p-4 rounded-xl bg-orange-500/10 border border-orange-500/20 flex-1">\n          <div class="text-xs text-orange-400 uppercase font-bold mb-1">Avg Oversubscription</div>\n          <div class="text-2xl font-bold text-white">3.2x</div>\n        </div>\n      </div>\n\n      <div class="flex-1 bg-white/5 rounded-2xl border border-white/5 overflow-hidden">\n        <div class="p-4 border-b border-white/10 bg-black/20">\n          <h3 class="font-bold text-white">Deal Calendar</h3>\n        </div>\n        <div class="overflow-auto">\n          <table class="w-full text-left">\n            <thead>\n              <tr class="text-xs text-gray-500 uppercase bg-black/10">\n                <th class="p-4">Date</th>\n                <th class="p-4">Issuer</th>\n                <th class="p-4">Rating</th>\n                <th class="p-4">Tenor</th>\n                <th class="p-4">Size</th>\n                <th class="p-4">IPT (Price Talk)</th>\n                <th class="p-4 text-right">Status</th>\n              </tr>\n            </thead>\n            <tbody class="text-sm font-mono text-gray-300">\n              <tr v-for="(deal, i) in deals" :key="i" class="border-b border-white/5 hover:bg-white/5 transition-colors">\n                <td class="p-4 text-gray-500">{{ deal.date }}</td>\n                <td class="p-4 font-bold text-white">{{ deal.issuer }}</td>\n                <td class="p-4">\n                  <span :class="[\'px-2 py-0.5 rounded text-xs border\', deal.rating.startsWith(\'A\') ? \'bg-emerald-500/10 border-emerald-500/20 text-emerald-400\' : \'bg-yellow-500/10 border-yellow-500/20 text-yellow-400\']">\n                    {{ deal.rating }}\n                  </span>\n                </td>\n                <td class="p-4">{{ deal.tenor }}</td>\n                <td class="p-4">{{ deal.size }}</td>\n                <td class="p-4 text-teal-300">{{ deal.ipt }}</td>\n                <td class="p-4 text-right">\n                  <span class="text-xs font-bold text-gray-400 uppercase">{{ deal.status }}</span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  '});return(e,t)=>(w(),i("div",GNt,[s("div",WNt,[s("div",qNt,[s("div",YNt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ОБЛИГАЦИИ"),s("p",{class:"section-subtitle font-mono"},"ФЕДЕРАЛЬНЫЕ И КОРПОРАТИВНЫЕ ДОЛГОВЫЕ РЫНКИ")],-1))]),s("div",jNt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id||"PX1"===o.value&&"BBT"===e.id}])},[(w(),b(C(e.icon),{class:"w-3.5 h-3.5"})),m(" "+v(e.label),1)],10,XNt)),64))])]),s("div",$Nt,["BBT"===o.value||"PX1"===o.value?(w(),b(O(d),{key:0})):"ALLQ"===o.value?(w(),b(O(h),{key:1})):"PICK"===o.value?(w(),b(O(g),{key:2})):"WB"===o.value?(w(),b(O(y),{key:3})):"NIM"===o.value?(w(),b(O(x),{key:4})):(w(),b(O(d),{key:5}))])]))}}),ZNt={class:"page-container custom-scrollbar"},JNt={class:"section-header flex-col md:flex-row gap-4"},QNt={class:"flex items-center gap-4"},eOt={class:"icon-box"},tOt={class:"tab-group"},aOt=["onClick"],nOt={class:"flex-1 flex flex-col gap-6"},rOt=e({__name:"CentralBanksPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("rect",{x:"3",y:"4",width:"18",height:"16",rx:"2"}),G("path",{d:"M16 2v2"}),G("path",{d:"M8 2v2"}),G("path",{d:"M3 10h18"})])}),r=a,o=t(r.activeSection||"CBR");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"CBR",label:"Банк России"},{id:"FED",label:"ФРС"},{id:"CENB",label:"Международные ЦБ"},{id:"FOMC",label:"Расшифровки совещаний"}],d=e({template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Key Rate</h3>\n          <div class="text-3xl font-bold text-rose-400">21.00%</div>\n          <div class="text-xs text-rose-500 mt-1">Hawkish Stance</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Inflation (YoY)</h3>\n          <div class="text-3xl font-bold text-white">8.5%</div>\n          <div class="text-xs text-gray-500 mt-1">Target: 4.0%</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Next Decision</h3>\n          <div class="text-3xl font-bold text-white">Dec 20</div>\n          <div class="text-xs text-gray-500 mt-1">13:30 MSK</div>\n        </div>\n      </div>\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">\n        [Rate vs Inflation Chart]\n      </div>\n    </div>\n  '}),h=e({template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="flex justify-between items-center">\n        <div><h3 class="text-lg font-bold text-white">Federal Funds Rate</h3><div class="flex items-center gap-3"><span class="text-3xl font-bold text-emerald-400">4.75 - 5.00%</span><span class="text-xs font-bold text-gray-500 bg-white/10 px-2 py-1 rounded">Target Range</span></div></div>\n        <div class="flex gap-4"><div class="text-right"><div class="text-xs text-gray-500 uppercase font-bold">Balance Sheet</div><div class="text-lg font-bold text-white">$7.1 Trillion</div></div><div class="text-right"><div class="text-xs text-gray-500 uppercase font-bold">Next Meeting</div><div class="text-lg font-bold text-white">Nov 07</div></div></div>\n      </div>\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">[Dot Plot Chart]</div>\n    </div>\n  '}),m=e({setup:()=>({cbs:[{country:"USA",bank:"Fed",rate:"5.00%",change:"-25bp",sentiment:"Neutral",next:"Nov 07"},{country:"Eurozone",bank:"ECB",rate:"3.25%",change:"-25bp",sentiment:"Dovish",next:"Dec 12"},{country:"UK",bank:"BoE",rate:"5.00%",change:"0bp",sentiment:"Neutral",next:"Nov 07"},{country:"Japan",bank:"BoJ",rate:"0.25%",change:"+15bp",sentiment:"Hawkish",next:"Oct 31"},{country:"Russia",bank:"CBR",rate:"21.00%",change:"+100bp",sentiment:"Hawkish",next:"Dec 20"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <h3 class="text-lg font-bold text-white">Global Policy Rates</h3>\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse"><thead><tr class="text-xs text-gray-400 uppercase bg-white/5"><th class="p-4">Country</th><th class="p-4">Central Bank</th><th class="p-4 text-right">Current Rate</th><th class="p-4 text-right">Last Change</th><th class="p-4">Bias</th><th class="p-4 text-right">Next Meeting</th></tr></thead>\n        <tbody class="text-sm font-mono text-gray-300">\n          <tr v-for="cb in cbs" :key="cb.country" class="border-b border-white/5 hover:bg-white/5">\n            <td class="p-4 font-bold text-white">{{ cb.country }}</td>\n            <td class="p-4">{{ cb.bank }}</td>\n            <td class="p-4 text-right font-bold text-white">{{ cb.rate }}</td>\n            <td :class="[\'p-4 text-right\', cb.change.includes(\'-\') ? \'text-emerald-400\' : cb.change === \'0bp\' ? \'text-gray-500\' : \'text-rose-400\']">{{ cb.change }}</td>\n            <td class="p-4"><span :class="[\'px-2 py-1 rounded text-xs font-bold border\', cb.sentiment === \'Hawkish\' ? \'bg-rose-500/10 border-rose-500/20 text-rose-400\' : cb.sentiment === \'Dovish\' ? \'bg-emerald-500/10 border-emerald-500/20 text-emerald-400\' : \'bg-gray-700/30 border-gray-600/30 text-gray-400\']">{{ cb.sentiment }}</span></td>\n            <td class="p-4 text-right text-gray-400">{{ cb.next }}</td>\n          </tr>\n        </tbody></table>\n      </div>\n    </div>\n  '}),g=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[FOMC Meeting Analysis]</div>'});return(e,t)=>(w(),i("div",ZNt,[s("div",JNt,[s("div",QNt,[s("div",eOt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ЦЕНТРАЛЬНЫЕ БАНКИ"),s("p",{class:"section-subtitle font-mono"},"ДЕНЕЖНО-КРЕДИТНАЯ ПОЛИТИКА, СТАВКИ, ЛИКВИДНОСТЬ")],-1))]),s("div",tOt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,aOt)),64))])]),s("div",nOt,["CBR"===o.value?(w(),b(O(d),{key:0})):"FED"===o.value?(w(),b(O(h),{key:1})):"CENB"===o.value?(w(),b(O(m),{key:2})):"FOMC"===o.value?(w(),b(O(g),{key:3})):(w(),b(O(d),{key:4}))])]))}}),iOt={class:"page-container custom-scrollbar"},oOt={class:"section-header flex-col md:flex-row gap-4"},sOt={class:"flex items-center gap-4"},lOt={class:"icon-box icon-orange"},cOt={class:"tab-group"},uOt=["onClick"],dOt={class:"flex-1 flex flex-col gap-6"},hOt=e({__name:"CommoditiesPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"}),G("polyline",{points:"3.27 6.96 12 12.01 20.73 6.96"}),G("line",{x1:"12",y1:"22.08",x2:"12",y2:"12"})])}),r=a,o=t(r.activeSection||"GLCO");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"GLCO",label:"Международное сырьё"},{id:"NRG",label:"Рынок энергоресурсов"},{id:"NGAS",label:"Газ"},{id:"FDM",label:"Fundamentals"},{id:"CPF",label:"Прогнозы"}],d=e({setup:()=>({data:[{name:"Crude Oil (WTI)",price:74.25,change:-.45,unit:"USD/bbl"},{name:"Brent Crude",price:78.1,change:-.3,unit:"USD/bbl"},{name:"Gold",price:2685.5,change:1.25,unit:"USD/t.oz"},{name:"Silver",price:32.15,change:2.1,unit:"USD/t.oz"},{name:"Copper",price:4.35,change:.85,unit:"USD/lb"},{name:"Natural Gas",price:2.85,change:-1.2,unit:"USD/MMBtu"},{name:"Corn",price:425,change:.5,unit:"USD/bu"},{name:"Soybeans",price:1150.25,change:-.15,unit:"USD/bu"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="flex justify-between items-center">\n        <h3 class="text-lg font-bold text-white">Global Benchmark Prices</h3>\n        <div class="flex gap-2">\n          <span class="px-2 py-1 bg-emerald-500/10 text-emerald-400 text-xs rounded border border-emerald-500/20">Metals Bullish</span>\n          <span class="px-2 py-1 bg-rose-500/10 text-rose-400 text-xs rounded border border-rose-500/20">Energy Bearish</span>\n        </div>\n      </div>\n      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">\n        <div v-for="(item, i) in data" :key="i" class="p-4 rounded-xl bg-white/5 border border-white/5 hover:bg-white/10 transition-all cursor-pointer group">\n          <div class="flex justify-between items-start mb-2">\n            <h4 class="text-sm font-bold text-gray-300 group-hover:text-white">{{ item.name }}</h4>\n          </div>\n          <div class="flex items-baseline gap-2 mb-1">\n            <span class="text-2xl font-bold text-white">{{ item.price.toLocaleString() }}</span>\n            <span class="text-xs text-gray-500">{{ item.unit }}</span>\n          </div>\n          <div :class="[\'text-xs font-bold\', item.change >= 0 ? \'text-emerald-400\' : \'text-rose-400\']">\n            {{ item.change > 0 ? \'+\' : \'\' }}{{ item.change }}%\n          </div>\n        </div>\n      </div>\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">\n        [YTD Performance Chart]\n      </div>\n    </div>\n  '}),h=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Energy Markets Charts]</div>'}),m=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Natural Gas Storage Charts]</div>'}),g=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Oil Market Balance & Inventory]</div>'}),y=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Analyst Price Forecasts Table]</div>'});return(e,t)=>(w(),i("div",iOt,[s("div",oOt,[s("div",sOt,[s("div",lOt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"СЫРЬЁ"),s("p",{class:"section-subtitle font-mono"},"ЭНЕРГОРЕСУРСЫ, МЕТАЛЛЫ, АГРОКОМПЛЕКС И ПОГОДА")],-1))]),s("div",cOt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,uOt)),64))])]),s("div",dOt,["GLCO"===o.value?(w(),b(O(d),{key:0})):"NRG"===o.value?(w(),b(O(h),{key:1})):"NGAS"===o.value?(w(),b(O(m),{key:2})):"FDM"===o.value?(w(),b(O(g),{key:3})):"CPF"===o.value?(w(),b(O(y),{key:4})):(w(),b(O(d),{key:5}))])]))}}),pOt={class:"page-container custom-scrollbar"},fOt={class:"section-header flex-col md:flex-row gap-4"},mOt={class:"flex items-center gap-4"},vOt={class:"icon-box icon-red"},gOt={class:"tab-group"},yOt=["onClick"],bOt={class:"flex-1 flex flex-col gap-6"},xOt=e({__name:"CreditRiskPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),G("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),G("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})])}),r=a,o=t(r.activeSection||"RATC"),l=t(r.symbol||"AAPL");R(()=>r.activeSection,e=>{e&&(o.value=e)});const d=[{id:"RATC",label:"Кредитные рейтинги"},{id:"GCDS",label:"CDS спреды"},{id:"SRSK",label:"Вероятность дефолта"},{id:"DDIS",label:"Долговой отчет"}],h=e({props:["symbol"],template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">S&P Global</h3>\n          <div class="flex items-baseline gap-2"><div class="text-4xl font-bold text-white">AA+</div><span class="text-xs font-bold text-gray-500 bg-black/30 px-2 py-1 rounded">Stable</span></div>\n          <div class="mt-4 text-xs text-gray-400">Last Action: Affirmed (Oct 2024)</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Moody\'s</h3>\n          <div class="flex items-baseline gap-2"><div class="text-4xl font-bold text-white">Aa1</div><span class="text-xs font-bold text-emerald-400 bg-emerald-500/10 px-2 py-1 rounded border border-emerald-500/20">Positive</span></div>\n          <div class="mt-4 text-xs text-gray-400">Last Action: Outlook Rev (Sep 2024)</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Fitch</h3>\n          <div class="flex items-baseline gap-2"><div class="text-4xl font-bold text-white">AA</div><span class="text-xs font-bold text-gray-500 bg-black/30 px-2 py-1 rounded">Stable</span></div>\n          <div class="mt-4 text-xs text-gray-400">Last Action: Affirmed (Nov 2024)</div>\n        </div>\n      </div>\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">\n        [Rating History Timeline]\n      </div>\n    </div>\n  '}),m=e({props:["symbol"],template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="flex justify-between items-end">\n        <div><h3 class="text-lg font-bold text-white mb-1">5Y Senior CDS Spread</h3><div class="flex items-center gap-3"><span class="text-3xl font-bold text-emerald-400">42.5 bps</span><span class="text-xs font-bold text-emerald-500 bg-emerald-500/10 px-2 py-1 rounded">-2.1 bps (Today)</span></div></div>\n      </div>\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-4 flex items-center justify-center text-gray-500">[CDS Spread Chart]</div>\n      <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5"><div class="text-xs text-gray-500 uppercase font-bold mb-1">Implied Rating</div><div class="text-lg font-bold text-white">AA-</div></div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5"><div class="text-xs text-gray-500 uppercase font-bold mb-1">Recovery Rate</div><div class="text-lg font-bold text-white">40%</div></div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5"><div class="text-xs text-gray-500 uppercase font-bold mb-1">Z-Score (1Y)</div><div class="text-lg font-bold text-emerald-400">-1.2</div></div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5"><div class="text-xs text-gray-500 uppercase font-bold mb-1">Liquidity</div><div class="text-lg font-bold text-white">High</div></div>\n      </div>\n    </div>\n  '}),g=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[Probability of Default Analysis]</div>'}),y=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[Debt Distribution Charts]</div>'});return(e,t)=>(w(),i("div",pOt,[s("div",fOt,[s("div",mOt,[s("div",vOt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"АНАЛИЗ КРЕДИТНЫХ РИСКОВ"),s("p",{class:"section-subtitle font-mono"},"РЕЙТИНГИ, РИСК ДЕФОЛТА И ДОЛГОВАЯ СТРУКТУРА")],-1))]),s("div",gOt,[(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,yOt)),64))])]),s("div",bOt,["RATC"===o.value?(w(),b(O(h),{key:0,symbol:l.value},null,8,["symbol"])):"GCDS"===o.value?(w(),b(O(m),{key:1,symbol:l.value},null,8,["symbol"])):"SRSK"===o.value?(w(),b(O(g),{key:2,symbol:l.value},null,8,["symbol"])):"DDIS"===o.value?(w(),b(O(y),{key:3,symbol:l.value},null,8,["symbol"])):(w(),b(O(h),{key:4,symbol:l.value},null,8,["symbol"]))])]))}}),wOt={class:"page-container custom-scrollbar"},_Ot={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},SOt={class:"flex justify-between items-start mb-6"},MOt={class:"w-12 h-12 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 flex items-center justify-center font-bold text-white text-lg shadow-lg"},TOt={class:"px-3 py-1 rounded-full bg-emerald-500/20 text-emerald-300 text-[10px] font-bold uppercase tracking-wide border border-emerald-500/20"},kOt={class:"mb-6"},COt={class:"text-4xl font-bold text-white mb-2 group-hover:text-emerald-400 transition-colors tracking-tight"},AOt={class:"flex justify-between items-center text-xs text-gray-400 border-t border-white/5 pt-4"},EOt={class:"text-white font-medium"},IOt={class:"mt-8 p-6 rounded-2xl bg-gradient-to-r from-indigo-900/40 to-purple-900/40 border border-white/10 flex items-center justify-between"},ROt={class:"flex items-center gap-4"},DOt={class:"p-4 bg-white/10 rounded-xl backdrop-blur-md"},POt=e({__name:"EarnPage",setup(t){const a=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[G("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}),G("path",{d:"m9 12 2 2 4-4"})])}),n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[G("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),G("polyline",{points:"17 6 23 6 23 12"})])}),r=[{asset:"USDT",apy:"12.5%",duration:"Flexible",type:"Savings"},{asset:"BTC",apy:"4.2%",duration:"30 Days",type:"Staking"},{asset:"ETH",apy:"5.8%",duration:"Locked",type:"Staking"},{asset:"DOT",apy:"14.2%",duration:"90 Days",type:"Staking"},{asset:"SOL",apy:"7.5%",duration:"Flexible",type:"Staking"},{asset:"USDC",apy:"10.0%",duration:"Flexible",type:"Savings"}];return(e,t)=>(w(),i("div",wOt,[t[4]||(t[4]=s("div",{class:"section-header justify-center text-center"},[s("div",null,[s("h1",{class:"section-title font-anton"},"GROW YOUR ASSETS"),s("p",{class:"section-subtitle font-mono"},"SIMPLE. SECURE. HIGH YIELDS.")])],-1)),s("div",_Ot,[(w(),i(p,null,f(r,e=>s("div",{key:e.asset,class:"bg-white/5 border border-white/5 rounded-2xl p-6 hover:bg-white/10 transition-all hover:-translate-y-1 cursor-pointer group hover:border-white/20"},[s("div",SOt,[s("div",MOt,v(e.asset.substring(0,2)),1),s("span",TOt,v(e.type),1)]),s("div",kOt,[s("div",COt,v(e.apy),1),t[0]||(t[0]=s("div",{class:"text-xs text-gray-500 uppercase font-bold tracking-wider"},"APY",-1))]),s("div",AOt,[s("span",null,[t[1]||(t[1]=m("Duration: ",-1)),s("span",EOt,v(e.duration),1)]),u(O(a),{class:"w-4 h-4 text-indigo-400"})])])),64))]),s("div",IOt,[s("div",ROt,[s("div",DOt,[u(O(n),{class:"w-6 h-6 text-white"})]),t[2]||(t[2]=s("div",null,[s("h3",{class:"font-bold text-white text-lg"},"Auto-Invest"),s("p",{class:"text-sm text-gray-400"},"Accumulate crypto on autopilot with dollar-cost averaging.")],-1))]),t[3]||(t[3]=s("button",{class:"px-8 py-3 bg-white text-black font-bold rounded-xl hover:scale-105 transition-transform shadow-lg shadow-white/10"},"Start Now",-1))])]))}}),LOt={class:"page-container custom-scrollbar"},NOt={class:"section-header flex-col md:flex-row gap-4"},OOt={class:"flex items-center gap-4"},FOt={class:"icon-box icon-purple"},BOt={class:"tab-group"},UOt=["onClick"],zOt={class:"flex-1 flex flex-col gap-6"},VOt=e({__name:"EventDrivenPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("circle",{cx:"12",cy:"12",r:"2"}),G("path",{d:"M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"})])}),r=a,o=t(r.activeSection||"IPO"),l=t(r.symbol||"NVDA");R(()=>r.activeSection,e=>{e&&(o.value=e)});const d=[{id:"IPO",label:"Монитор IPO"},{id:"CACS",label:"Корпоративные события"},{id:"QUIC",label:"QuickTakes"},{id:"CM",label:"Ключевые события"}],h=e({setup:()=>({ipos:[{name:"Stripe Inc.",symbol:"STRIP",date:"Q4 2025",range:"$45 - $55",shares:"25M",exchange:"NYSE",status:"Filing"},{name:"Discord",symbol:"DSCD",date:"Q1 2026",range:"$30 - $35",shares:"18M",exchange:"NASDAQ",status:"Rumored"},{name:"SpaceX (Starlink)",symbol:"LINK",date:"TBD",range:"N/A",shares:"N/A",exchange:"NASDAQ",status:"Rumored"},{name:"Databricks",symbol:"DATA",date:"Oct 28",range:"$60 - $70",shares:"15M",exchange:"NYSE",status:"Pricing"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Upcoming Volume</h3><div class="text-3xl font-bold text-white">$12.5B</div><div class="text-xs text-emerald-400 mt-1">High Activity Expected Q4</div></div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Avg First Day Pop</h3><div class="text-3xl font-bold text-white">+18.2%</div><div class="text-xs text-gray-500 mt-1">Tech Sector (YTD)</div></div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Market Sentiment</h3><div class="text-3xl font-bold text-emerald-400">Warm</div></div>\n      </div>\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse"><thead><tr class="text-xs text-gray-400 uppercase bg-white/5 sticky top-0"><th class="p-4">Company</th><th class="p-4">Symbol</th><th class="p-4">Expected Date</th><th class="p-4">Price Range</th><th class="p-4">Shares</th><th class="p-4">Exchange</th><th class="p-4 text-right">Status</th></tr></thead>\n        <tbody class="text-sm font-mono text-gray-300">\n          <tr v-for="(ipo, i) in ipos" :key="i" class="border-b border-white/5 hover:bg-white/5 group">\n            <td class="p-4 font-bold text-white">{{ ipo.name }}</td>\n            <td class="p-4 text-purple-300">{{ ipo.symbol }}</td>\n            <td class="p-4">{{ ipo.date }}</td>\n            <td class="p-4">{{ ipo.range }}</td>\n            <td class="p-4 text-gray-500">{{ ipo.shares }}</td>\n            <td class="p-4">{{ ipo.exchange }}</td>\n            <td class="p-4 text-right"><span :class="[\'px-2 py-1 rounded text-xs font-bold border\', ipo.status === \'Pricing\' ? \'bg-emerald-500/10 border-emerald-500/20 text-emerald-400\' : ipo.status === \'Filing\' ? \'bg-blue-500/10 border-blue-500/20 text-blue-400\' : \'bg-gray-700/30 border-gray-600/30 text-gray-400\']">{{ ipo.status }}</span></td>\n          </tr>\n        </tbody></table>\n      </div>\n    </div>\n  '}),m=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[Corporate Events Timeline]</div>'}),g=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[QuickTakes Analysis Cards]</div>'}),y=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[Key Events Price Impact Chart]</div>'});return(e,t)=>(w(),i("div",LOt,[s("div",NOt,[s("div",OOt,[s("div",FOt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ИВЕНТ-АНАЛИЗ"),s("p",{class:"section-subtitle font-mono"},"CATALYSTS, CORPORATE ACTIONS & MARKET MOVING EVENTS")],-1))]),s("div",BOt,[(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,UOt)),64))])]),s("div",zOt,["IPO"===o.value?(w(),b(O(h),{key:0})):"CACS"===o.value?(w(),b(O(m),{key:1,symbol:l.value},null,8,["symbol"])):"QUIC"===o.value?(w(),b(O(g),{key:2,symbol:l.value},null,8,["symbol"])):"CM"===o.value?(w(),b(O(y),{key:3,symbol:l.value},null,8,["symbol"])):(w(),b(O(h),{key:4}))])]))}}),HOt={class:"flex-1 flex gap-6 min-h-0"},GOt={class:"flex-1 data-panel flex flex-col"},WOt={class:"flex items-center gap-8 mb-8 pb-8 border-b border-white/5"},qOt={class:"flex gap-3"},YOt={class:"flex items-center gap-2 px-8 py-4 rounded-2xl bg-white text-black font-bold hover:scale-105 transition-transform shadow-lg shadow-white/10"},jOt={class:"flex items-center gap-2 px-8 py-4 rounded-2xl bg-white/10 text-white font-bold hover:bg-white/20 transition-all border border-white/10"},XOt={class:"flex-1 flex gap-12 items-center"},$Ot={class:"w-1/2 space-y-4"},KOt=["onClick"],ZOt={class:"flex items-center gap-3"},JOt={class:"font-bold text-lg"},QOt={class:"text-right"},eFt={class:"text-white font-mono font-bold"},tFt={class:"text-xs text-gray-500"},aFt={class:"w-96 data-panel flex flex-col"},nFt={class:"space-y-4 overflow-auto custom-scrollbar flex-1 pr-2"},rFt={class:"flex items-center gap-4"},iFt={class:"text-sm font-bold text-white group-hover:text-indigo-300 transition-colors"},oFt={class:"text-right"},sFt=e({__name:"FinancePage",props:{onAssetClick:{type:Function}},emits:["asset-click"],setup(t,{emit:a}){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("line",{x1:"17",y1:"7",x2:"7",y2:"17"}),G("polyline",{points:"17 17 7 17 7 7"})])}),r=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("line",{x1:"7",y1:"17",x2:"17",y2:"7"}),G("polyline",{points:"7 7 17 7 17 17"})])}),o=a,l=[{name:"BTC",value:400,price:"64,230.50",change:"+2.45%"},{name:"ETH",value:300,price:"3,450.20",change:"-1.12%"},{name:"USDT",value:300,price:"1.00",change:"+0.01%"},{name:"SOL",value:100,price:"148.50",change:"+5.67%"}],d=["#F59E0B","#6366F1","#10B981","#EC4899"];return(e,t)=>(w(),i("div",HOt,[s("div",GOt,[t[4]||(t[4]=s("h2",{class:"section-title font-anton text-xl mb-8"},"PORTFOLIO OVERVIEW",-1)),s("div",WOt,[t[2]||(t[2]=s("div",{class:"flex-1"},[s("div",{class:"text-sm text-gray-400 mb-1 uppercase tracking-wider font-bold"},"Total Balance"),s("div",{class:"text-5xl font-bold text-white tracking-tight"},[m("$42,301.54 "),s("span",{class:"text-sm text-emerald-400 font-normal ml-2 bg-emerald-500/10 px-2 py-1 rounded"},"+12.4%")])],-1)),s("div",qOt,[s("button",YOt,[u(O(n),{class:"w-4 h-4"}),t[0]||(t[0]=m(" Deposit ",-1))]),s("button",jOt,[u(O(r),{class:"w-4 h-4"}),t[1]||(t[1]=m(" Withdraw ",-1))])])]),s("div",XOt,[t[3]||(t[3]=s("div",{class:"w-1/2 h-[300px] relative flex items-center justify-center text-gray-500"}," [Portfolio Pie Chart] ",-1)),s("div",$Ot,[(w(),i(p,null,f(l,(e,t)=>s("div",{key:e.name,onClick:t=>(e=>{const t={name:"BTC"===e.name?"Bitcoin":"ETH"===e.name?"Ethereum":"SOL"===e.name?"Solana":"Tether",symbol:e.name,price:e.price,change:e.change,category:"Crypto",cap:"N/A",vol:"N/A"};o("asset-click",t)})(e),class:"flex justify-between items-center p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer group"},[s("div",ZOt,[s("div",{class:"w-4 h-4 rounded-full",style:y({backgroundColor:d[t]})},null,4),s("span",JOt,v(e.name),1)]),s("div",QOt,[s("div",eFt,"$"+v(10*e.value),1),s("div",tFt,v((e.value/1100*100).toFixed(1))+"%",1)])],8,KOt)),64))])])]),s("div",aFt,[t[7]||(t[7]=s("h2",{class:"section-title font-anton text-lg mb-6"},"RECENT ACTIVITY",-1)),s("div",nFt,[(w(),i(p,null,f(6,e=>s("div",{key:e,class:"flex items-center justify-between p-3 rounded-xl hover:bg-white/5 transition-colors cursor-pointer group"},[s("div",rFt,[s("div",{class:c(["p-3 rounded-xl",e%2==0?"bg-emerald-500/10 text-emerald-400":"bg-rose-500/10 text-rose-400"])},[(w(),b(C(O(e%2==0?n:r)),{class:"w-4 h-4"}))],2),s("div",null,[s("div",iFt,v(e%2==0?"Deposit":"Withdrawal"),1),t[5]||(t[5]=s("div",{class:"text-xs text-gray-500"},"Oct 24, 2025",-1))])]),s("div",oFt,[s("div",{class:c(["text-sm font-mono font-bold",e%2==0?"text-emerald-400":"text-white"])},v(e%2==0?"+":"-")+"$"+v((1e3*Math.random()).toFixed(2)),3),t[6]||(t[6]=s("div",{class:"text-[10px] text-gray-500 bg-white/5 inline-block px-1.5 py-0.5 rounded mt-1"},"Success",-1))])])),64))]),t[8]||(t[8]=I('<div class="mt-4 pt-4 border-t border-white/5"><div class="p-6 rounded-3xl bg-gradient-to-br from-gray-800 to-black border border-white/10 relative overflow-hidden group cursor-pointer"><div class="relative z-10"><div class="text-xs text-gray-400 mb-2 uppercase tracking-widest font-bold">Nexus Card</div><div class="text-xl font-mono text-white tracking-widest mb-4">**** **** **** 4921</div><div class="flex justify-between items-end"><span class="text-xs text-gray-500">Exp 12/28</span><span class="font-bold italic text-white/50">VISA</span></div></div></div></div>',1))])]))}}),lFt={class:"page-container custom-scrollbar"},cFt={class:"section-header flex-col md:flex-row gap-4"},uFt={class:"flex items-center gap-4"},dFt={class:"icon-box icon-orange"},hFt={class:"tab-group"},pFt=["onClick"],fFt={class:"flex-1 flex flex-col gap-6"},mFt=e({__name:"FixedIncomePage",props:{activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})])}),r=a,o=t(r.activeSection||"YAS");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"YAS",label:"Доходности и спреды"},{id:"YCRV",label:"Кривая доходности"},{id:"YA",label:"Анализ доходности"},{id:"OAS1",label:"Калькулятор OAS"},{id:"BB",label:"Оценка облигаций"}],d=e({setup:()=>({price:t(98.5),yieldVal:t(4.25)}),template:'\n    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 h-full">\n      <div class="p-6 rounded-2xl bg-white/5 border border-white/5 flex flex-col gap-6">\n        <div class="flex justify-between items-center"><h3 class="text-lg font-bold text-white">YAS Calculator</h3><span class="text-xs text-amber-400 font-mono">US Govt 10Y</span></div>\n        <div class="grid grid-cols-2 gap-4">\n          <div class="space-y-2"><label class="text-xs text-gray-400 uppercase font-bold">Price ($)</label><input type="number" v-model="price" class="w-full bg-black/40 border border-white/10 rounded-xl py-3 px-4 text-white font-mono focus:border-amber-500/50 outline-none" /></div>\n          <div class="space-y-2"><label class="text-xs text-gray-400 uppercase font-bold">Yield (%)</label><input type="number" v-model="yieldVal" class="w-full bg-black/40 border border-white/10 rounded-xl py-3 px-4 text-white font-mono focus:border-amber-500/50 outline-none" /></div>\n        </div>\n        <div class="p-4 rounded-xl bg-black/20 border border-white/5 space-y-3">\n          <div class="flex justify-between text-sm"><span class="text-gray-400">G-Spread</span><span class="font-mono text-white">12.5 bps</span></div>\n          <div class="flex justify-between text-sm"><span class="text-gray-400">I-Spread</span><span class="font-mono text-white">15.2 bps</span></div>\n          <div class="flex justify-between text-sm"><span class="text-gray-400">Z-Spread</span><span class="font-mono text-white">14.8 bps</span></div>\n          <div class="flex justify-between text-sm border-t border-white/5 pt-2"><span class="text-gray-400">Asset Swap Spread</span><span class="font-mono text-amber-400">18.5 bps</span></div>\n        </div>\n      </div>\n      <div class="p-6 rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-gray-500">[Scenario Analysis Chart]</div>\n    </div>\n  '}),h=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Sovereign Yield Curves Chart]</div>'}),m=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Return Decomposition Chart]</div>'}),g=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[OAS Calculator]</div>'}),y=e({template:'\n    <div class="h-full flex flex-col">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5 space-y-4">\n          <h3 class="text-sm font-bold text-gray-400 uppercase border-b border-white/10 pb-2">Instrument Specs</h3>\n          <div class="space-y-3">\n            <div class="flex justify-between text-sm"><span class="text-gray-400">Coupon</span><span class="text-white font-mono">4.50%</span></div>\n            <div class="flex justify-between text-sm"><span class="text-gray-400">Frequency</span><span class="text-white font-mono">Semi-Annual</span></div>\n            <div class="flex justify-between text-sm"><span class="text-gray-400">Maturity</span><span class="text-white font-mono">15 Nov 2035</span></div>\n            <div class="flex justify-between text-sm"><span class="text-gray-400">Day Count</span><span class="text-white font-mono">30/360</span></div>\n          </div>\n        </div>\n        <div class="md:col-span-2 p-6 rounded-2xl bg-black/20 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase border-b border-white/10 pb-2 mb-4">Pricing Output</h3>\n          <div class="grid grid-cols-2 md:grid-cols-4 gap-6">\n            <div><span class="text-xs text-gray-500 block mb-1">Clean Price</span><span class="text-2xl font-bold text-white">98.45</span></div>\n            <div><span class="text-xs text-gray-500 block mb-1">Dirty Price</span><span class="text-2xl font-bold text-gray-300">99.12</span></div>\n            <div><span class="text-xs text-gray-500 block mb-1">YTM</span><span class="text-2xl font-bold text-amber-400">4.68%</span></div>\n            <div><span class="text-xs text-gray-500 block mb-1">Accrued</span><span class="text-2xl font-bold text-gray-300">0.67</span></div>\n          </div>\n        </div>\n      </div>\n      <div class="flex-1 bg-white/5 rounded-2xl border border-white/5 p-6">\n        <h3 class="text-sm font-bold text-gray-400 uppercase mb-6">Risk Metrics</h3>\n        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">\n          <div class="flex flex-col items-center justify-center p-4 bg-black/20 rounded-xl"><div class="text-3xl font-bold text-white mb-2">7.84</div><div class="text-xs text-blue-400 font-bold uppercase">Macaulay Duration</div></div>\n          <div class="flex flex-col items-center justify-center p-4 bg-black/20 rounded-xl border border-amber-500/20"><div class="text-3xl font-bold text-amber-400 mb-2">7.52</div><div class="text-xs text-amber-500 font-bold uppercase">Modified Duration</div></div>\n          <div class="flex flex-col items-center justify-center p-4 bg-black/20 rounded-xl"><div class="text-3xl font-bold text-white mb-2">0.68</div><div class="text-xs text-emerald-400 font-bold uppercase">Convexity</div></div>\n        </div>\n      </div>\n    </div>\n  '});return(e,t)=>(w(),i("div",lFt,[s("div",cFt,[s("div",uFt,[s("div",dFt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"АНАЛИЗ ОБЛИГАЦИЙ"),s("p",{class:"section-subtitle font-mono"},"ПРОДВИНУТАЯ ДОХОДНАЯ АНАЛИТИКА И МОДЕЛИ ЦЕНООБРАЗОВАНИЯ")],-1))]),s("div",hFt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,pFt)),64))])]),s("div",fFt,["YAS"===o.value?(w(),b(O(d),{key:0})):"YCRV"===o.value?(w(),b(O(h),{key:1})):"YA"===o.value?(w(),b(O(m),{key:2})):"OAS1"===o.value?(w(),b(O(g),{key:3})):"BB"===o.value?(w(),b(O(y),{key:4})):(w(),b(O(d),{key:5}))])]))}}),vFt={class:"page-container custom-scrollbar"},gFt={class:"section-header flex-col md:flex-row gap-4"},yFt={class:"flex items-center gap-4"},bFt={class:"icon-box icon-blue"},xFt={class:"tab-group"},wFt=["onClick"],_Ft={class:"flex-1 flex flex-col gap-6"},SFt=e({__name:"FuturesPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("circle",{cx:"12",cy:"12",r:"4"}),G("line",{x1:"1.05",y1:"12",x2:"7",y2:"12"}),G("line",{x1:"17.01",y1:"12",x2:"22.96",y2:"12"})])}),r=a,o=t(r.activeSection||"FUT"),l=t(r.symbol||"ES");R(()=>r.activeSection,e=>{e&&(o.value=e)});const d=[{id:"FUT",label:"Фьючерсы"},{id:"FWCV",label:"Форвардные кривые"}],h=e({props:["symbol"],setup:()=>({contracts:[{code:"ESZ5",name:"E-mini S&P 500 Dec 25",last:5845.5,change:"+1.25%",vol:"1.2M",oi:"2.4M",roll:"12 Days"},{code:"NQZ5",name:"E-mini Nasdaq Dec 25",last:20150.25,change:"+1.80%",vol:"850K",oi:"950K",roll:"12 Days"},{code:"CLX5",name:"Crude Oil Nov 25",last:74.25,change:"-0.45%",vol:"450K",oi:"620K",roll:"4 Days"},{code:"GCZ5",name:"Gold Dec 25",last:2685.1,change:"+0.15%",vol:"220K",oi:"410K",roll:"25 Days"},{code:"BTCX5",name:"Bitcoin Nov 25",last:64550,change:"+2.10%",vol:"15K",oi:"45K",roll:"18 Days"},{code:"ZB Z5",name:"US Treasury Bond Dec 25",last:118.15,change:"-0.10%",vol:"380K",oi:"750K",roll:"20 Days"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Total Open Interest</h3>\n          <div class="text-3xl font-bold text-cyan-400">$2.4T</div>\n          <div class="text-xs text-cyan-500 mt-1">+1.5% (DoD)</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Roll Activity</h3>\n          <div class="text-3xl font-bold text-white">High</div>\n          <div class="text-xs text-gray-500 mt-1">Approaching Expiry (Equity)</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Basis (Spot-Fut)</h3>\n          <div class="text-3xl font-bold text-white">+12.5</div>\n          <div class="text-xs text-gray-500 mt-1">Contango</div>\n        </div>\n      </div>\n\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse">\n          <thead>\n            <tr class="text-xs text-gray-400 uppercase bg-white/5 sticky top-0 backdrop-blur-md z-10">\n              <th class="p-4 font-bold">Code</th>\n              <th class="p-4 font-bold">Contract Name</th>\n              <th class="p-4 font-bold text-right">Last Price</th>\n              <th class="p-4 font-bold text-right">Change</th>\n              <th class="p-4 font-bold text-right">Volume</th>\n              <th class="p-4 font-bold text-right">Open Int.</th>\n              <th class="p-4 font-bold text-right">Days to Roll</th>\n            </tr>\n          </thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr v-for="(cont, i) in contracts" :key="i" class="border-b border-white/5 hover:bg-white/5 transition-colors group cursor-pointer">\n              <td class="p-4 font-bold text-white group-hover:text-cyan-400">{{ cont.code }}</td>\n              <td class="p-4 text-xs font-sans text-gray-400">{{ cont.name }}</td>\n              <td class="p-4 text-right font-bold text-white">{{ cont.last.toLocaleString() }}</td>\n              <td :class="[\'p-4 text-right font-bold\', cont.change.startsWith(\'+\') ? \'text-emerald-400\' : \'text-rose-400\']">\n                {{ cont.change }}\n              </td>\n              <td class="p-4 text-right">{{ cont.vol }}</td>\n              <td class="p-4 text-right">{{ cont.oi }}</td>\n              <td class="p-4 text-right">\n                <span :class="[\'px-2 py-1 rounded text-xs border\', parseInt(cont.roll) < 5 ? \'bg-rose-500/10 border-rose-500/20 text-rose-400\' : \'bg-gray-700/30 border-gray-600/30 text-gray-400\']">\n                  {{ cont.roll }}\n                </span>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),g=e({props:["symbol"],setup:()=>({asset:t("Crude Oil (WTI)"),assets:["Crude Oil (WTI)","Natural Gas","Corn","Gold","VIX"],data:[{term:"M1",current:74.25,prev:73.1},{term:"M2",current:73.8,prev:72.9},{term:"M3",current:73.45,prev:72.8},{term:"M6",current:72.5,prev:72.2},{term:"M12",current:70.1,prev:70.5},{term:"M18",current:68.5,prev:69.2},{term:"M24",current:66.8,prev:68.1}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="flex justify-between items-center">\n        <div class="flex items-center gap-4">\n          <h3 class="text-lg font-bold text-white">Term Structure</h3>\n          <div class="flex bg-black/30 rounded-lg p-1 border border-white/10">\n            <button \n              v-for="a in assets" \n              :key="a"\n              @click="asset = a"\n              :class="[\'px-3 py-1 rounded-md text-xs font-bold transition-all\', asset === a ? \'bg-cyan-600 text-white shadow-lg\' : \'text-gray-400 hover:text-white\']"\n            >\n              {{ a }}\n            </button>\n          </div>\n        </div>\n        <div class="flex gap-4 text-xs font-bold">\n          <span class="flex items-center gap-2"><div class="w-3 h-1 bg-cyan-400"></div> Current Curve</span>\n          <span class="flex items-center gap-2"><div class="w-3 h-1 bg-gray-500"></div> 1 Month Ago</span>\n        </div>\n      </div>\n\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex flex-col items-center justify-center text-gray-500">\n        [Forward Curve Chart]\n      </div>\n\n      <div class="grid grid-cols-3 gap-6">\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center">\n          <div class="text-xs text-gray-500 uppercase font-bold mb-1">Structure</div>\n          <div class="text-xl font-bold text-white">Backwardation</div>\n          <div class="text-[10px] text-gray-400">Bullish Indicator</div>\n        </div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center">\n          <div class="text-xs text-gray-500 uppercase font-bold mb-1">M1-M12 Spread</div>\n          <div class="text-xl font-bold text-cyan-400">+$4.15</div>\n          <div class="text-[10px] text-gray-400">Roll Yield Positive</div>\n        </div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center">\n          <div class="text-xs text-gray-500 uppercase font-bold mb-1">Inventory Levels</div>\n          <div class="text-xl font-bold text-white">-2.5M Bbls</div>\n          <div class="text-[10px] text-gray-400">Below Avg</div>\n        </div>\n      </div>\n    </div>\n  '});return(e,t)=>(w(),i("div",vFt,[s("div",gFt,[s("div",yFt,[s("div",bFt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ФЬЮЧЕРСЫ"),s("p",{class:"section-subtitle font-mono"},"КОНТРАКТЫ, СПРЕДЫ И ФОРВАРДНЫЕ КРИВЫЕ")],-1))]),s("div",xFt,[(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id||"CURV"===o.value&&"FWCV"===e.id}])},[(w(),b(C(e.icon),{class:"w-3.5 h-3.5"})),m(" "+v(e.label),1)],10,wFt)),64))])]),s("div",_Ft,["FUT"===o.value?(w(),b(O(h),{key:0,symbol:l.value},null,8,["symbol"])):"FWCV"===o.value||"CURV"===o.value?(w(),b(O(g),{key:1,symbol:l.value},null,8,["symbol"])):(w(),b(O(h),{key:2,symbol:l.value},null,8,["symbol"]))])]))}}),MFt={class:"page-container custom-scrollbar"},TFt={class:"section-header flex-col md:flex-row gap-4"},kFt={class:"flex items-center gap-4"},CFt={class:"icon-box icon-blue"},AFt={class:"tab-group"},EFt=["onClick"],IFt={class:"flex-1 flex flex-col gap-4"},RFt=e({__name:"IndicesPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("circle",{cx:"12",cy:"12",r:"10"}),G("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),G("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})])}),r=a,o=t(r.activeSection||"WINDEX");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"WINDEX",label:"Мировые индексы"},{id:"IMAP",label:"Карта рынка"},{id:"MEMB",label:"Состав"},{id:"IMON",label:"Аналитика"}],d=e({setup:()=>({indices:[{name:"S&P 500",symbol:"SPX",region:"Americas",last:"5,845.20",change:"+0.85%",ytd:"+22.4%"},{name:"Nasdaq 100",symbol:"NDX",region:"Americas",last:"20,150.10",change:"+1.20%",ytd:"+35.1%"},{name:"Dow Jones Industrial",symbol:"DJI",region:"Americas",last:"39,100.20",change:"+0.15%",ytd:"+18.5%"},{name:"Russell 2000",symbol:"RUT",region:"Americas",last:"2,050.40",change:"+1.10%",ytd:"+12.8%"},{name:"S&P 400 MidCap",symbol:"MID",region:"Americas",last:"2,985.60",change:"+0.75%",ytd:"+15.2%"},{name:"VIX Volatility",symbol:"VIX",region:"Americas",last:"13.50",change:"-4.20%",ytd:"-18.5%"},{name:"NYSE Composite",symbol:"NYA",region:"Americas",last:"17,250.40",change:"+0.55%",ytd:"+14.6%"},{name:"Wilshire 5000",symbol:"W5000",region:"Americas",last:"48,250.80",change:"+0.65%",ytd:"+19.8%"},{name:"S&P 500 Technology",symbol:"SPT",region:"Americas",last:"4,250.60",change:"+1.45%",ytd:"+38.2%"},{name:"S&P 500 Financials",symbol:"SPF",region:"Americas",last:"685.40",change:"+0.35%",ytd:"+12.4%"},{name:"S&P 500 Healthcare",symbol:"SPH",region:"Americas",last:"1,485.20",change:"+0.55%",ytd:"+8.6%"},{name:"S&P 500 Energy",symbol:"SPE",region:"Americas",last:"485.80",change:"+1.25%",ytd:"+6.2%"},{name:"S&P 500 Consumer",symbol:"SPC",region:"Americas",last:"1,125.40",change:"+0.45%",ytd:"+11.8%"},{name:"Nasdaq Composite",symbol:"IXIC",region:"Americas",last:"16,850.60",change:"+1.35%",ytd:"+32.5%"},{name:"Dow Jones Transportation",symbol:"DJT",region:"Americas",last:"15,250.40",change:"+0.85%",ytd:"+9.4%"},{name:"S&P 500 Utilities",symbol:"SPU",region:"Americas",last:"285.60",change:"+0.15%",ytd:"+4.2%"},{name:"S&P/TSX Composite",symbol:"TSX",region:"Americas",last:"22,485.60",change:"+0.65%",ytd:"+10.8%"},{name:"S&P/TSX 60",symbol:"TX60",region:"Americas",last:"1,285.40",change:"+0.55%",ytd:"+11.2%"},{name:"IPC Mexico",symbol:"MXX",region:"Americas",last:"58,250.40",change:"+0.45%",ytd:"+8.5%"},{name:"Bovespa",symbol:"BVSP",region:"Americas",last:"128,450.80",change:"+1.15%",ytd:"+15.6%"},{name:"IBOVESPA",symbol:"IBOV",region:"Americas",last:"125,850.60",change:"+1.05%",ytd:"+14.8%"},{name:"FTSE 100",symbol:"UKX",region:"EMEA",last:"8,320.40",change:"+0.25%",ytd:"+8.4%"},{name:"FTSE 250",symbol:"MCX",region:"EMEA",last:"20,485.60",change:"+0.35%",ytd:"+12.6%"},{name:"FTSE All-Share",symbol:"ASX",region:"EMEA",last:"4,585.20",change:"+0.30%",ytd:"+9.8%"},{name:"DAX",symbol:"DAX",region:"EMEA",last:"19,250.80",change:"+0.60%",ytd:"+15.5%"},{name:"MDAX",symbol:"MDAX",region:"EMEA",last:"28,450.60",change:"+0.55%",ytd:"+13.2%"},{name:"TecDAX",symbol:"TECDAX",region:"EMEA",last:"3,285.40",change:"+1.25%",ytd:"+18.6%"},{name:"CAC 40",symbol:"PX1",region:"EMEA",last:"8,100.30",change:"-0.20%",ytd:"+11.4%"},{name:"CAC Next 20",symbol:"CN20",region:"EMEA",last:"5,850.60",change:"+0.30%",ytd:"+9.8%"},{name:"FTSE MIB",symbol:"FTSEMIB",region:"EMEA",last:"33,850.40",change:"+0.45%",ytd:"+14.2%"},{name:"IBEX 35",symbol:"IBEX",region:"EMEA",last:"10,485.60",change:"+0.50%",ytd:"+12.8%"},{name:"AEX",symbol:"AEX",region:"EMEA",last:"825.40",change:"+0.40%",ytd:"+13.5%"},{name:"SMI",symbol:"SMI",region:"EMEA",last:"11,285.60",change:"+0.35%",ytd:"+10.6%"},{name:"OMX Stockholm 30",symbol:"OMXS30",region:"EMEA",last:"2,485.60",change:"+0.55%",ytd:"+16.8%"},{name:"OSEBX",symbol:"OSEBX",region:"EMEA",last:"1,285.40",change:"+0.65%",ytd:"+18.2%"},{name:"WIG 20",symbol:"WIG20",region:"EMEA",last:"2,485.60",change:"+0.45%",ytd:"+11.4%"},{name:"BIST 100",symbol:"XU100",region:"EMEA",last:"10,485.60",change:"+1.25%",ytd:"+45.2%"},{name:"JSE Top 40",symbol:"JSE40",region:"EMEA",last:"68,250.40",change:"+0.35%",ytd:"+8.6%"},{name:"Euro Stoxx 50",symbol:"STOXX50",region:"EMEA",last:"5,100.30",change:"+0.55%",ytd:"+12.4%"},{name:"Stoxx Europe 600",symbol:"SXXP",region:"EMEA",last:"515.40",change:"+0.40%",ytd:"+11.8%"},{name:"Nikkei 225",symbol:"NI225",region:"APAC",last:"40,100.00",change:"+1.50%",ytd:"+24.5%"},{name:"Topix",symbol:"TOPIX",region:"APAC",last:"2,850.60",change:"+1.25%",ytd:"+22.8%"},{name:"JPX-Nikkei 400",symbol:"JPXN400",region:"APAC",last:"15,485.60",change:"+1.35%",ytd:"+23.6%"},{name:"Shanghai Composite",symbol:"SSEC",region:"APAC",last:"3,050.20",change:"+0.10%",ytd:"+5.4%"},{name:"CSI 300",symbol:"CSI300",region:"APAC",last:"3,685.40",change:"+0.25%",ytd:"+6.8%"},{name:"Shenzhen Composite",symbol:"SZSE",region:"APAC",last:"1,985.60",change:"+0.15%",ytd:"+4.2%"},{name:"Hang Seng",symbol:"HSI",region:"APAC",last:"21,500.80",change:"-0.50%",ytd:"+18.2%"},{name:"Hang Seng Tech",symbol:"HSTECH",region:"APAC",last:"4,285.60",change:"-0.85%",ytd:"+22.4%"},{name:"KOSPI",symbol:"KS11",region:"APAC",last:"2,685.40",change:"+0.75%",ytd:"+16.8%"},{name:"KOSDAQ",symbol:"KQ11",region:"APAC",last:"885.60",change:"+1.15%",ytd:"+19.4%"},{name:"Taiwan Weighted",symbol:"TWII",region:"APAC",last:"21,485.60",change:"+1.25%",ytd:"+28.6%"},{name:"Nifty 50",symbol:"NSEI",region:"APAC",last:"24,285.60",change:"+0.85%",ytd:"+18.4%"},{name:"BSE Sensex",symbol:"BSESN",region:"APAC",last:"78,485.60",change:"+0.75%",ytd:"+17.8%"},{name:"ASX 200",symbol:"AXJO",region:"APAC",last:"7,885.60",change:"+0.55%",ytd:"+9.6%"},{name:"All Ordinaries",symbol:"AORD",region:"APAC",last:"8,125.40",change:"+0.50%",ytd:"+10.2%"},{name:"NZX 50",symbol:"NZ50",region:"APAC",last:"12,485.60",change:"+0.35%",ytd:"+7.8%"},{name:"Straits Times",symbol:"STI",region:"APAC",last:"3,285.60",change:"+0.25%",ytd:"+6.4%"},{name:"Jakarta Composite",symbol:"JKSE",region:"APAC",last:"7,285.60",change:"+0.65%",ytd:"+8.2%"},{name:"SET Index",symbol:"SET",region:"APAC",last:"1,685.60",change:"+0.45%",ytd:"+5.6%"},{name:"FTSE Bursa Malaysia",symbol:"KLSE",region:"APAC",last:"1,585.60",change:"+0.30%",ytd:"+4.8%"},{name:"PSEi",symbol:"PSEI",region:"APAC",last:"6,485.60",change:"+0.55%",ytd:"+7.2%"},{name:"VN-Index",symbol:"VNINDEX",region:"APAC",last:"1,285.60",change:"+0.40%",ytd:"+6.8%"},{name:"МосБиржа",symbol:"IMOEX",region:"EMEA",last:"3,285.40",change:"+1.25%",ytd:"+14.6%"},{name:"RTS",symbol:"RTSI",region:"EMEA",last:"1,185.60",change:"+0.95%",ytd:"+12.8%"},{name:"MOEX Russia",symbol:"MOEX",region:"EMEA",last:"3,185.40",change:"+1.15%",ytd:"+13.4%"}],regions:["Americas","EMEA","APAC"]}),template:'\n    <div class="space-y-8">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Глобальный настрой</h3><div class="text-3xl font-bold text-emerald-400">Риск-он</div></div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Лидер роста</h3><div class="text-3xl font-bold text-white">Nikkei 225</div><div class="text-xs text-emerald-400 mt-1">+1.50%</div></div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Аутсайдер</h3><div class="text-3xl font-bold text-white">Hang Seng</div><div class="text-xs text-rose-400 mt-1">-0.50%</div></div>\n      </div>\n      <div v-for="region in regions" :key="region" class="bg-black/20 rounded-2xl border border-white/5 overflow-hidden">\n        <div class="p-4 bg-white/5 border-b border-white/5"><h3 class="font-bold text-white">{{ region }}</h3></div>\n        <table class="w-full text-left"><thead><tr class="text-xs text-gray-500 uppercase"><th class="p-4">Индекс</th><th class="p-4">Тикер</th><th class="p-4 text-right">Последняя</th><th class="p-4 text-right">Изменение</th><th class="p-4 text-right">С начала года</th></tr></thead>\n        <tbody class="text-sm font-mono text-gray-300">\n          <tr v-for="idx in indices.filter(i => i.region === region)" :key="idx.name" class="border-t border-white/5 hover:bg-white/5 cursor-pointer">\n            <td class="p-4 font-bold text-white">{{ idx.name }}</td>\n            <td class="p-4 text-gray-400">{{ idx.symbol }}</td>\n            <td class="p-4 text-right">{{ idx.last }}</td>\n            <td :class="[\'p-4 text-right font-bold\', idx.change.startsWith(\'+\') ? \'text-emerald-400\' : \'text-rose-400\']">{{ idx.change }}</td>\n            <td :class="[\'p-4 text-right\', idx.ytd.startsWith(\'+\') ? \'text-emerald-400\' : \'text-rose-400\']">{{ idx.ytd }}</td>\n          </tr>\n        </tbody></table>\n      </div>\n    </div>\n  '}),h=e({template:'<div class="flex-1 flex items-center justify-center text-gray-500 h-full">[Карта рынка - Тепловая карта]</div>'}),m=e({template:'<div class="flex-1 flex items-center justify-center text-gray-500 h-full">[Состав индекса - Таблица]</div>'}),g=e({template:'<div class="flex-1 flex items-center justify-center text-gray-500 h-full">[Аналитика индексов - Графики]</div>'});return(e,t)=>(w(),i("div",MFt,[s("div",TFt,[s("div",kFt,[s("div",CFt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ИНДЕКСЫ"),s("p",{class:"section-subtitle font-mono"},"МИРОВЫЕ РЫНКИ, СЕКТОРА И СОСТАВ")],-1))]),s("div",AFt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,EFt)),64))])]),s("div",IFt,["WINDEX"===o.value?(w(),b(O(d),{key:0})):"IMAP"===o.value?(w(),b(O(h),{key:1})):"MEMB"===o.value?(w(),b(O(m),{key:2})):"IMON"===o.value?(w(),b(O(g),{key:3})):(w(),b(O(d),{key:4}))])]))}}),DFt={class:"page-container custom-scrollbar"},PFt={class:"section-header flex-col md:flex-row gap-4"},LFt={class:"flex items-center gap-4"},NFt={class:"icon-box"},OFt={class:"tab-group"},FFt=["onClick"],BFt={class:"flex-1 flex flex-col gap-6"},UFt=e({__name:"MacroeconomicsPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("circle",{cx:"12",cy:"12",r:"10"}),G("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),G("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})])}),r=a,o=t(r.activeSection||"ECO");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"ECO",label:"Экономический календарь"},{id:"ECST",label:"Макроэкономические данные"},{id:"ECFC",label:"Прогнозы"},{id:"ECWB",label:"Workbench"}],d=e({setup:()=>({events:[{time:"08:30",country:"US",impact:"High",event:"CPI YoY",period:"Sep",forecast:"3.6%",actual:"3.7%",prev:"3.7%"},{time:"08:30",country:"US",impact:"High",event:"Core CPI YoY",period:"Sep",forecast:"4.1%",actual:"4.1%",prev:"4.3%"},{time:"08:30",country:"US",impact:"Med",event:"Jobless Claims",period:"Wk",forecast:"210K",actual:"209K",prev:"207K"},{time:"14:00",country:"US",impact:"High",event:"FOMC Minutes",period:"-",forecast:"-",actual:"-",prev:"-"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="flex justify-between items-center">\n        <div class="flex gap-4">\n          <button class="px-3 py-1 rounded-lg bg-white/10 text-xs font-bold text-white">Today</button>\n          <button class="px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:text-white">Tomorrow</button>\n          <button class="px-3 py-1 rounded-lg text-xs font-bold text-gray-500 hover:text-white">This Week</button>\n        </div>\n      </div>\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse">\n          <thead><tr class="text-xs text-gray-400 uppercase bg-white/5 sticky top-0"><th class="p-4 w-20">Time</th><th class="p-4 w-16 text-center">Cty</th><th class="p-4">Event</th><th class="p-4">Period</th><th class="p-4 text-right">Actual</th><th class="p-4 text-right">Forecast</th><th class="p-4 text-right">Previous</th></tr></thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr v-for="(evt, i) in events" :key="i" class="border-b border-white/5 hover:bg-white/5">\n              <td class="p-4 text-xs text-gray-500">{{ evt.time }}</td>\n              <td class="p-4 text-center"><span class="text-xs font-bold bg-white/10 px-1.5 py-0.5 rounded text-white">{{ evt.country }}</span></td>\n              <td class="p-4"><div class="flex items-center gap-2"><div :class="[\'w-1.5 h-1.5 rounded-full\', evt.impact === \'High\' ? \'bg-rose-500\' : \'bg-orange-500\']"></div><span :class="evt.impact === \'High\' ? \'text-white font-bold\' : \'text-gray-300\'">{{ evt.event }}</span></div></td>\n              <td class="p-4 text-xs text-gray-500">{{ evt.period }}</td>\n              <td :class="[\'p-4 text-right font-bold\', evt.actual === \'-\' ? \'text-gray-600\' : \'text-white\']">{{ evt.actual }}</td>\n              <td class="p-4 text-right text-gray-400">{{ evt.forecast }}</td>\n              <td class="p-4 text-right text-gray-500">{{ evt.prev }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),h=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Economic Data Time Series]</div>'}),m=e({setup:()=>({forecasts:[{country:"United States",metric:"Real GDP",y25:"1.5%",y26:"1.8%"},{country:"United States",metric:"CPI Inflation",y25:"2.5%",y26:"2.1%"},{country:"Euro Area",metric:"Real GDP",y25:"0.8%",y26:"1.4%"},{country:"China",metric:"Real GDP",y25:"4.5%",y26:"4.2%"}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Global Growth (2025E)</h3><div class="text-3xl font-bold text-white">2.9%</div><div class="text-xs text-rose-400 mt-1">Revised Down</div></div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">US Recession Prob</h3><div class="text-3xl font-bold text-orange-400">45%</div><div class="text-xs text-gray-500 mt-1">Next 12 Months</div></div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5"><h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Peak Rates (Fed)</h3><div class="text-3xl font-bold text-emerald-400">5.50%</div></div>\n      </div>\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left"><thead><tr class="text-xs text-gray-400 uppercase bg-white/5"><th class="p-4">Country</th><th class="p-4">Metric</th><th class="p-4 text-right">FY 2025</th><th class="p-4 text-right">FY 2026</th></tr></thead>\n        <tbody class="text-sm font-mono text-gray-300">\n          <tr v-for="(row, i) in forecasts" :key="i" class="border-b border-white/5 hover:bg-white/5">\n            <td class="p-4 font-bold text-white">{{ row.country }}</td>\n            <td class="p-4 text-slate-400">{{ row.metric }}</td>\n            <td class="p-4 text-right font-bold text-white">{{ row.y25 }}</td>\n            <td class="p-4 text-right text-gray-500">{{ row.y26 }}</td>\n          </tr>\n        </tbody></table>\n      </div>\n    </div>\n  '}),g=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Economic Workbench Charts]</div>'});return(e,t)=>(w(),i("div",DFt,[s("div",PFt,[s("div",LFt,[s("div",NFt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"МАКРОЭКОНОМИКА"),s("p",{class:"section-subtitle font-mono"},"ИНДИКАТОРЫ, РЕЛИЗЫ И ЭКОНОМИЧЕСКАЯ ПОЛИТИКА")],-1))]),s("div",OFt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,FFt)),64))])]),s("div",BFt,["ECO"===o.value?(w(),b(O(d),{key:0})):"ECST"===o.value?(w(),b(O(h),{key:1})):"ECFC"===o.value?(w(),b(O(m),{key:2})):"ECWB"===o.value?(w(),b(O(g),{key:3})):(w(),b(O(d),{key:4}))])]))}}),zFt={class:"page-container custom-scrollbar"},VFt={class:"section-header flex-col md:flex-row gap-4"},HFt={class:"flex items-center gap-4"},GFt={class:"icon-box icon-purple"},WFt={class:"tab-group"},qFt=["onClick"],YFt={class:"flex-1 flex flex-col gap-6"},jFt=e({__name:"OptionsPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M18 7V4H6l6 8-6 8h12v-3"})])}),r=a,o=t(r.activeSection||"OVML"),l=t(r.symbol||"NVDA");R(()=>r.activeSection,e=>{e&&(o.value=e)});const d=[{id:"OVML",label:"Аналитика"},{id:"VOL",label:"Поверхность волатильности"},{id:"OCRN",label:"Скрининг опционов"},{id:"VARL",label:"Имплицитная vs реализованная "}],h=e({props:["symbol"],setup:()=>({strike:t(150),vol:t(35),days:t(30),greeks:[{name:"Delta",val:"0.45",desc:"Price Sensitivity",color:"text-blue-400"},{name:"Gamma",val:"0.04",desc:"Rate of Change",color:"text-purple-400"},{name:"Vega",val:"0.12",desc:"Vol Sensitivity",color:"text-orange-400"},{name:"Theta",val:"-0.08",desc:"Time Decay",color:"text-rose-400"},{name:"Rho",val:"0.02",desc:"Rate Sensitivity",color:"text-gray-300"}]}),template:'\n    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 h-full">\n      <div class="lg:col-span-1 space-y-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-lg font-bold text-white mb-6">Pricing Inputs</h3>\n          <div class="space-y-4">\n            <div>\n              <div class="flex justify-between mb-2">\n                <label class="text-xs text-gray-400 font-bold uppercase">Underlying Price</label>\n                <span class="text-xs font-mono text-white">$145.32</span>\n              </div>\n              <div class="h-10 bg-black/40 rounded-lg border border-white/10 flex items-center px-3 text-gray-500 text-sm cursor-not-allowed">\n                145.32\n              </div>\n            </div>\n            <div>\n              <div class="flex justify-between mb-2">\n                <label class="text-xs text-gray-400 font-bold uppercase">Strike Price</label>\n                <span class="text-xs font-mono text-fuchsia-400">${{ strike }}</span>\n              </div>\n              <input type="range" min="100" max="200" step="5" v-model="strike" class="w-full h-1.5 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-fuchsia-500" />\n            </div>\n            <div>\n              <div class="flex justify-between mb-2">\n                <label class="text-xs text-gray-400 font-bold uppercase">Implied Volatility</label>\n                <span class="text-xs font-mono text-fuchsia-400">{{ vol }}%</span>\n              </div>\n              <input type="range" min="10" max="150" step="1" v-model="vol" class="w-full h-1.5 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-fuchsia-500" />\n            </div>\n            <div>\n              <div class="flex justify-between mb-2">\n                <label class="text-xs text-gray-400 font-bold uppercase">Days to Expiry</label>\n                <span class="text-xs font-mono text-fuchsia-400">{{ days }} Days</span>\n              </div>\n              <input type="range" min="1" max="365" step="1" v-model="days" class="w-full h-1.5 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-fuchsia-500" />\n            </div>\n          </div>\n        </div>\n\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <div class="grid grid-cols-2 gap-4">\n            <div class="text-center p-3 rounded-xl bg-black/20">\n              <div class="text-xs text-gray-500 uppercase mb-1">Call Price</div>\n              <div class="text-xl font-bold text-emerald-400 font-mono">$4.25</div>\n            </div>\n            <div class="text-center p-3 rounded-xl bg-black/20">\n              <div class="text-xs text-gray-500 uppercase mb-1">Put Price</div>\n              <div class="text-xl font-bold text-rose-400 font-mono">$8.40</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="lg:col-span-2 flex flex-col gap-6">\n        <div class="grid grid-cols-2 md:grid-cols-5 gap-4">\n          <div v-for="greek in greeks" :key="greek.name" class="p-4 rounded-xl bg-white/5 border border-white/5 flex flex-col items-center justify-center text-center hover:bg-white/10 transition-colors">\n            <span class="text-xs text-gray-500 font-bold uppercase mb-2">{{ greek.name }}</span>\n            <span :class="[\'text-2xl font-mono font-bold mb-1\', greek.color]">{{ greek.val }}</span>\n            <span class="text-[10px] text-gray-600">{{ greek.desc }}</span>\n          </div>\n        </div>\n\n        <div class="flex-1 p-6 rounded-2xl bg-black/20 border border-white/5 flex items-center justify-center text-gray-500">\n          [P/L Chart]\n        </div>\n      </div>\n    </div>\n  '}),g=e({props:["symbol"],template:'\n    <div class="flex flex-col h-full">\n      <div class="flex justify-between items-center mb-6">\n        <h3 class="text-lg font-bold text-white">Volatility Skew (Smile)</h3>\n        <div class="flex gap-4 text-xs font-bold">\n          <span class="flex items-center gap-2"><div class="w-3 h-1 bg-fuchsia-500"></div> 30 Days</span>\n          <span class="flex items-center gap-2"><div class="w-3 h-1 bg-blue-500"></div> 90 Days</span>\n          <span class="flex items-center gap-2"><div class="w-3 h-1 bg-emerald-500"></div> 180 Days</span>\n        </div>\n      </div>\n\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">\n        [Volatility Surface Chart]\n      </div>\n\n      <div class="grid grid-cols-3 gap-6 mt-6">\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center">\n          <div class="text-xs text-gray-500 uppercase font-bold mb-1">Put-Call Skew</div>\n          <div class="text-xl font-bold text-rose-400">4.5%</div>\n          <div class="text-[10px] text-gray-400">Puts Expensive</div>\n        </div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center">\n          <div class="text-xs text-gray-500 uppercase font-bold mb-1">Term Structure</div>\n          <div class="text-xl font-bold text-white">Contango</div>\n          <div class="text-[10px] text-gray-400">Normal</div>\n        </div>\n        <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center">\n          <div class="text-xs text-gray-500 uppercase font-bold mb-1">ATM Vol</div>\n          <div class="text-xl font-bold text-fuchsia-400">32.5%</div>\n          <div class="text-[10px] text-gray-400">Elevated</div>\n        </div>\n      </div>\n    </div>\n  '}),y=e({props:["symbol"],setup:e=>({rows:[{s:e.symbol,exp:"24 Oct",str:150,t:"CALL",b:2.1,a:2.15,iv:"32%",d:.45,v:1.2},{s:e.symbol,exp:"24 Oct",str:140,t:"PUT",b:1.85,a:1.9,iv:"34%",d:-.3,v:.8},{s:e.symbol,exp:"21 Nov",str:160,t:"CALL",b:3.4,a:3.5,iv:"31%",d:.35,v:2.1},{s:e.symbol,exp:"21 Nov",str:130,t:"PUT",b:2.2,a:2.3,iv:"36%",d:-.25,v:.5},{s:e.symbol,exp:"19 Dec",str:150,t:"CALL",b:5.6,a:5.8,iv:"30%",d:.52,v:1.5}]}),template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="p-4 rounded-2xl bg-white/5 border border-white/5 flex flex-wrap gap-4 items-center">\n        <select class="bg-black/20 text-xs text-white border border-white/10 rounded-lg px-3 py-2 outline-none">\n          <option>High IV Percentile (>90)</option>\n          <option>Cheap Delta (<20)</option>\n          <option>Earnings Plays</option>\n        </select>\n        <select class="bg-black/20 text-xs text-white border border-white/10 rounded-lg px-3 py-2 outline-none">\n          <option>Exp: Next Week</option>\n          <option>Exp: Next Month</option>\n          <option>Exp: LEAPS</option>\n        </select>\n        <div class="ml-auto">\n          <button class="px-4 py-2 bg-fuchsia-600 hover:bg-fuchsia-500 text-white text-xs font-bold rounded-lg transition-colors shadow-lg shadow-fuchsia-500/20">\n            Scan Market\n          </button>\n        </div>\n      </div>\n\n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse">\n          <thead>\n            <tr class="text-xs text-gray-400 uppercase bg-white/5 sticky top-0 backdrop-blur-md z-10">\n              <th class="p-4 font-bold">Symbol</th>\n              <th class="p-4 font-bold">Expiry</th>\n              <th class="p-4 font-bold">Strike</th>\n              <th class="p-4 font-bold">Type</th>\n              <th class="p-4 font-bold text-right">Bid</th>\n              <th class="p-4 font-bold text-right">Ask</th>\n              <th class="p-4 font-bold text-right">IV</th>\n              <th class="p-4 font-bold text-right">Delta</th>\n              <th class="p-4 font-bold text-right">Vol/OI</th>\n            </tr>\n          </thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr v-for="(row, i) in rows" :key="i" class="border-b border-white/5 hover:bg-white/5 transition-colors group cursor-pointer">\n              <td class="p-4 font-bold text-white">{{ row.s }}</td>\n              <td class="p-4 text-gray-400">{{ row.exp }}</td>\n              <td class="p-4 text-white">{{ row.str }}</td>\n              <td :class="[\'p-4 font-bold\', row.t === \'CALL\' ? \'text-emerald-400\' : \'text-rose-400\']">{{ row.t }}</td>\n              <td class="p-4 text-right text-emerald-400/80">{{ row.b.toFixed(2) }}</td>\n              <td class="p-4 text-right text-rose-400/80">{{ row.a.toFixed(2) }}</td>\n              <td class="p-4 text-right text-fuchsia-400">{{ row.iv }}</td>\n              <td class="p-4 text-right">{{ row.d }}</td>\n              <td class="p-4 text-right">{{ row.v }}x</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),x=e({props:["symbol"],template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">IV Rank (1Y)</h3>\n          <div class="text-3xl font-bold text-fuchsia-400">72%</div>\n          <div class="text-xs text-gray-500 mt-1">High Volatility Regime</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Volatility Risk Premium</h3>\n          <div class="text-3xl font-bold text-emerald-400">+4.2%</div>\n          <div class="text-xs text-gray-500 mt-1">IV Overpricing RV</div>\n        </div>\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-2">Parkinson Volatility</h3>\n          <div class="text-3xl font-bold text-white">28.5%</div>\n          <div class="text-xs text-gray-500 mt-1">High-Low Range Based</div>\n        </div>\n      </div>\n\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">\n        [IV vs RV Chart]\n      </div>\n    </div>\n  '});return(e,t)=>(w(),i("div",zFt,[s("div",VFt,[s("div",HFt,[s("div",GFt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ОПЦИОНЫ"),s("p",{class:"section-subtitle font-mono"},"ЦЕНООБРАЗОВАНИЕ И АНАЛИЗ ВОЛАТИЛЬНОСТИ")],-1))]),s("div",WFt,[(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},[(w(),b(C(e.icon),{class:"w-3.5 h-3.5"})),m(" "+v(e.label),1)],10,qFt)),64))])]),s("div",YFt,["OVML"===o.value?(w(),b(O(h),{key:0,symbol:l.value},null,8,["symbol"])):"VOL"===o.value?(w(),b(O(g),{key:1,symbol:l.value},null,8,["symbol"])):"OCRN"===o.value?(w(),b(O(y),{key:2,symbol:l.value},null,8,["symbol"])):"VARL"===o.value?(w(),b(O(x),{key:3,symbol:l.value},null,8,["symbol"])):(w(),b(O(h),{key:4,symbol:l.value},null,8,["symbol"]))])]))}}),XFt={class:"page-container custom-scrollbar"},$Ft={class:"section-header flex-col md:flex-row gap-4"},KFt={class:"flex items-center gap-4"},ZFt={class:"icon-box icon-indigo"},JFt={class:"tab-group"},QFt=["onClick"],eBt={class:"flex-1 flex flex-col gap-6"},tBt=e({__name:"ResearchPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),G("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})])}),r=a,o=t(r.activeSection||"RES"),l=t(r.symbol||"NVDA");R(()=>r.activeSection,e=>{e&&(o.value=e)});const d=[{id:"RES",label:"Исследовательский хаб"},{id:"BICO",label:"Company Primer"},{id:"BIP",label:"Industry Primer"},{id:"ECT",label:"Transcripts"}],h=e({props:["symbol"],setup:e=>({reports:[{title:`${e.symbol}: The AI Supercycle Thesis`,firm:"Goldman Sachs",analyst:"T. Koslowski",date:"Oct 24, 2025",type:"Initiation",rating:"Buy"},{title:"Semiconductors: Supply Chain Resilience",firm:"Morgan Stanley",analyst:"J. Moore",date:"Oct 20, 2025",type:"Sector Update",rating:"Overweight"},{title:`${e.symbol} Q3 Preview: Expectations High`,firm:"JP Morgan",analyst:"H. Yang",date:"Oct 15, 2025",type:"Earnings Preview",rating:"Buy"}]}),template:'\n    <div class="flex flex-col h-full">\n      <div class="flex flex-wrap items-center justify-between gap-4 mb-6">\n        <div class="relative flex-1 max-w-lg">\n          <input type="text" :placeholder="\'Search research for \' + symbol + \'...\'" class="w-full bg-black/40 border border-white/10 rounded-xl py-2.5 pl-10 pr-4 text-sm text-white focus:border-indigo-500/50 outline-none" />\n        </div>\n        <button class="px-3 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-lg text-xs font-bold text-white shadow-lg">Latest</button>\n      </div>\n      <div class="grid grid-cols-1 gap-4">\n        <div v-for="(report, i) in reports" :key="i" class="flex flex-col md:flex-row md:items-center justify-between p-5 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 hover:border-indigo-500/30 transition-all cursor-pointer group">\n          <div class="flex items-start gap-4">\n            <div class="w-10 h-10 rounded-xl bg-indigo-500/20 text-indigo-400 flex items-center justify-center font-bold text-xs border border-indigo-500/20">{{ report.firm.substring(0, 2) }}</div>\n            <div>\n              <h4 class="text-base font-bold text-white group-hover:text-indigo-300 transition-colors mb-1">{{ report.title }}</h4>\n              <div class="flex flex-wrap items-center gap-3 text-xs text-gray-400">\n                <span class="font-bold text-gray-300">{{ report.firm }}</span><span>•</span><span>{{ report.analyst }}</span><span>•</span><span>{{ report.date }}</span>\n                <span class="bg-white/10 px-1.5 py-0.5 rounded text-[10px] uppercase">{{ report.type }}</span>\n              </div>\n            </div>\n          </div>\n          <div class="flex items-center gap-6 mt-4 md:mt-0 pl-14 md:pl-0">\n            <div class="text-center">\n              <div :class="[\'text-sm font-bold\', report.rating === \'Buy\' || report.rating === \'Overweight\' ? \'text-emerald-400\' : \'text-yellow-400\']">{{ report.rating }}</div>\n              <div class="text-[10px] text-gray-500 uppercase">Rating</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  '}),m=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[Company Primer Overview]</div>'}),g=e({template:'<div class="flex items-center justify-center h-full text-gray-500">[Industry Primer & TAM Analysis]</div>'}),y=e({props:["symbol"],template:'<div class="flex items-center justify-center h-full text-gray-500">[Earnings Call Transcripts]</div>'});return(e,t)=>(w(),i("div",XFt,[s("div",$Ft,[s("div",KFt,[s("div",ZFt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"ИССЛЕДОВАНИЯ"),s("p",{class:"section-subtitle font-mono"},"INSTITUTIONAL GRADE ANALYSIS & INSIGHTS")],-1))]),s("div",JFt,[(w(),i(p,null,f(d,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,QFt)),64))])]),s("div",eBt,["RES"===o.value?(w(),b(O(h),{key:0,symbol:l.value},null,8,["symbol"])):"BICO"===o.value?(w(),b(O(m),{key:1,symbol:l.value},null,8,["symbol"])):"BIP"===o.value?(w(),b(O(g),{key:2})):"ECT"===o.value?(w(),b(O(y),{key:3,symbol:l.value},null,8,["symbol"])):(w(),b(O(h),{key:4,symbol:l.value},null,8,["symbol"]))])]))}}),aBt={class:"page-container custom-scrollbar"},nBt={class:"section-header flex-col md:flex-row gap-4"},rBt={class:"flex items-center gap-4"},iBt={class:"icon-box"},oBt={class:"section-title font-anton"},sBt={class:"section-subtitle font-mono"},lBt={class:"tab-group"},cBt={class:"flex-1 flex flex-col gap-6"},uBt=e({__name:"ResourcesPage",props:{activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),G("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),G("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})])}),r=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("circle",{cx:"12",cy:"12",r:"10"}),G("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),G("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})])}),o=a,l=t(o.activeSection||"FLDS");R(()=>o.activeSection,e=>{e&&(l.value=e)});const u=e({setup(){const e=t(""),a=t("Все"),n=[{mnemonic:"LAST_PRICE",name:"Последняя цена",category:"Рыночные данные",desc:"Цена последней сделки по активу",unit:"₽"},{mnemonic:"PX_OPEN",name:"Цена открытия",category:"Рыночные данные",desc:"Цена на момент открытия торгов",unit:"₽"},{mnemonic:"PX_HIGH",name:"Максимальная цена",category:"Рыночные данные",desc:"Максимальная цена за торговую сессию",unit:"₽"},{mnemonic:"PX_LOW",name:"Минимальная цена",category:"Рыночные данные",desc:"Минимальная цена за торговую сессию",unit:"₽"},{mnemonic:"PX_CLOSE",name:"Цена закрытия",category:"Рыночные данные",desc:"Цена на момент закрытия торгов",unit:"₽"},{mnemonic:"VOLUME",name:"Объем торгов",category:"Рыночные данные",desc:"Общий объем торгов за период",unit:"шт"},{mnemonic:"TURNOVER",name:"Оборот",category:"Рыночные данные",desc:"Денежный оборот за период",unit:"₽"},{mnemonic:"BID",name:"Лучшая цена покупки",category:"Рыночные данные",desc:"Лучшая цена в стакане на покупку",unit:"₽"},{mnemonic:"ASK",name:"Лучшая цена продажи",category:"Рыночные данные",desc:"Лучшая цена в стакане на продажу",unit:"₽"},{mnemonic:"SPREAD",name:"Спред",category:"Рыночные данные",desc:"Разница между лучшей ценой покупки и продажи",unit:"₽"},{mnemonic:"PE_RATIO",name:"P/E (коэффициент)",category:"Фундаментальные",desc:"Отношение цены к прибыли на акцию (TTM)",unit:""},{mnemonic:"PB_RATIO",name:"P/B (коэффициент)",category:"Фундаментальные",desc:"Отношение цены к балансовой стоимости",unit:""},{mnemonic:"EPS_FWD",name:"Прогноз EPS",category:"Фундаментальные",desc:"Консенсус-прогноз прибыли на акцию на 12 месяцев",unit:"₽"},{mnemonic:"EPS_TTM",name:"EPS за 12 месяцев",category:"Фундаментальные",desc:"Прибыль на акцию за последние 12 месяцев",unit:"₽"},{mnemonic:"DIV_YIELD",name:"Дивидендная доходность",category:"Фундаментальные",desc:"Годовая дивидендная доходность",unit:"%"},{mnemonic:"MARKET_CAP",name:"Рыночная капитализация",category:"Фундаментальные",desc:"Общая стоимость компании на рынке",unit:"₽"},{mnemonic:"REVENUE",name:"Выручка",category:"Фундаментальные",desc:"Общая выручка компании за период",unit:"₽"},{mnemonic:"NET_INCOME",name:"Чистая прибыль",category:"Фундаментальные",desc:"Чистая прибыль компании за период",unit:"₽"},{mnemonic:"RSI_14D",name:"RSI (14 периодов)",category:"Технические",desc:"Индекс относительной силы (14 периодов)",unit:""},{mnemonic:"MACD",name:"MACD",category:"Технические",desc:"Схождение-расхождение скользящих средних",unit:""},{mnemonic:"MA_20",name:"Скользящая средняя (20)",category:"Технические",desc:"Простая скользящая средняя за 20 периодов",unit:"₽"},{mnemonic:"MA_50",name:"Скользящая средняя (50)",category:"Технические",desc:"Простая скользящая средняя за 50 периодов",unit:"₽"},{mnemonic:"MA_200",name:"Скользящая средняя (200)",category:"Технические",desc:"Простая скользящая средняя за 200 периодов",unit:"₽"},{mnemonic:"BB_UPPER",name:"Верхняя полоса Боллинджера",category:"Технические",desc:"Верхняя граница полос Боллинджера",unit:"₽"},{mnemonic:"BB_LOWER",name:"Нижняя полоса Боллинджера",category:"Технические",desc:"Нижняя граница полос Боллинджера",unit:"₽"},{mnemonic:"ATR_14",name:"ATR (14 периодов)",category:"Технические",desc:"Средний истинный диапазон за 14 периодов",unit:"₽"},{mnemonic:"STOCH_K",name:"Стохастик %K",category:"Технические",desc:"Стохастический осциллятор %K",unit:"%"},{mnemonic:"STOCH_D",name:"Стохастик %D",category:"Технические",desc:"Стохастический осциллятор %D",unit:"%"},{mnemonic:"BETA_RAW",name:"Бета (коэффициент)",category:"Риск",desc:"Наклон линии регрессии относительно бенчмарка",unit:""},{mnemonic:"VOLATILITY",name:"Волатильность",category:"Риск",desc:"Стандартное отклонение доходности (годовое)",unit:"%"},{mnemonic:"VAR_95",name:"VaR (95%)",category:"Риск",desc:"Value at Risk на уровне доверия 95%",unit:"%"},{mnemonic:"VAR_99",name:"VaR (99%)",category:"Риск",desc:"Value at Risk на уровне доверия 99%",unit:"%"},{mnemonic:"CVAR",name:"Expected Shortfall",category:"Риск",desc:"Условный Value at Risk (CVaR)",unit:"%"},{mnemonic:"SHARPE",name:"Коэффициент Шарпа",category:"Риск",desc:"Отношение избыточной доходности к волатильности",unit:""},{mnemonic:"SORTINO",name:"Коэффициент Сортино",category:"Риск",desc:"Отношение избыточной доходности к downside deviation",unit:""},{mnemonic:"MAX_DD",name:"Максимальная просадка",category:"Риск",desc:"Максимальная просадка от пика",unit:"%"},{mnemonic:"YTM",name:"Доходность к погашению",category:"Облигации",desc:"Yield to Maturity - доходность к погашению",unit:"%"},{mnemonic:"DURATION",name:"Дюрация",category:"Облигации",desc:"Модифицированная дюрация облигации",unit:"лет"},{mnemonic:"DV01",name:"DV01",category:"Облигации",desc:"Изменение цены при сдвиге кривой на 1 б.п.",unit:"₽"},{mnemonic:"CONVEXITY",name:"Выпуклость",category:"Облигации",desc:"Convexity облигации",unit:""},{mnemonic:"COUPON_RATE",name:"Купонная ставка",category:"Облигации",desc:"Годовая купонная ставка",unit:"%"},{mnemonic:"ACCRUED_INT",name:"Накопленный купон",category:"Облигации",desc:"Накопленный купонный доход",unit:"₽"},{mnemonic:"CLEAN_PRICE",name:"Чистая цена",category:"Облигации",desc:"Цена облигации без накопленного купона",unit:"₽"},{mnemonic:"DIRTY_PRICE",name:"Грязная цена",category:"Облигации",desc:"Полная цена облигации с накопленным купоном",unit:"₽"},{mnemonic:"IV",name:"Подразумеваемая волатильность",category:"Опционы",desc:"Implied Volatility опциона",unit:"%"},{mnemonic:"DELTA",name:"Дельта",category:"Опционы",desc:"Чувствительность цены опциона к изменению спота",unit:""},{mnemonic:"GAMMA",name:"Гамма",category:"Опционы",desc:"Чувствительность дельты к изменению спота",unit:""},{mnemonic:"VEGA",name:"Вега",category:"Опционы",desc:"Чувствительность цены опциона к изменению волатильности",unit:""},{mnemonic:"THETA",name:"Тета",category:"Опционы",desc:"Временной распад опциона",unit:"₽/день"},{mnemonic:"RHO",name:"Ро",category:"Опционы",desc:"Чувствительность цены опциона к изменению ставки",unit:""},{mnemonic:"INTRINSIC",name:"Внутренняя стоимость",category:"Опционы",desc:"Внутренняя стоимость опциона",unit:"₽"},{mnemonic:"TIME_VALUE",name:"Временная стоимость",category:"Опционы",desc:"Временная стоимость опциона",unit:"₽"}],r=S(()=>{let t=n;if("Все"!==a.value&&(t=t.filter(e=>e.category===a.value)),e.value){const a=e.value.toLowerCase();t=t.filter(e=>e.mnemonic.toLowerCase().includes(a)||e.name.toLowerCase().includes(a)||e.desc.toLowerCase().includes(a))}return t});return{fields:n,categories:["Все","Рыночные данные","Фундаментальные","Технические","Риск","Облигации","Опционы"],searchQuery:e,selectedCategory:a,filteredFields:r}},template:'\n    <div class="flex flex-col h-full gap-6">\n      <div class="flex flex-col md:flex-row gap-4">\n        <div class="relative flex-1">\n          <input \n            v-model="searchQuery" \n            type="text" \n            placeholder="Поиск по мнемонике или названию..." \n            class="w-full bg-white/5 border border-white/10 rounded-xl py-2.5 pl-10 pr-4 text-sm text-white placeholder-gray-500 focus:border-indigo-500/50 focus:bg-white/10 outline-none transition-all" \n          />\n          <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <circle cx="11" cy="11" r="8"/>\n            <path d="m21 21-4.35-4.35"/>\n          </svg>\n        </div>\n        <div class="flex gap-2 overflow-x-auto pb-2">\n          <button \n            v-for="cat in categories" \n            :key="cat" \n            @click="selectedCategory = cat"\n            :class="[\'px-3 py-2 rounded-lg text-xs font-bold border transition-all whitespace-nowrap\', selectedCategory === cat ? \'bg-indigo-500/20 text-indigo-300 border-indigo-500/30\' : \'bg-white/5 text-gray-400 hover:text-white hover:bg-white/10 border-white/5\']"\n          >\n            {{ cat }}\n          </button>\n        </div>\n      </div>\n      \n      <div class="flex items-center justify-between text-xs text-gray-400 mb-2">\n        <span>Найдено полей: <span class="text-white font-bold">{{ filteredFields.length }}</span></span>\n        <span>Всего полей: <span class="text-white font-bold">{{ fields.length }}</span></span>\n      </div>\n      \n      <div class="flex-1 overflow-auto rounded-2xl border border-white/5 bg-black/20">\n        <table class="w-full text-left border-collapse">\n          <thead>\n            <tr class="text-xs text-gray-400 uppercase bg-white/5 sticky top-0 z-10">\n              <th class="p-4 font-bold">Мнемоника</th>\n              <th class="p-4 font-bold">Название</th>\n              <th class="p-4 font-bold">Категория</th>\n              <th class="p-4 font-bold">Единица</th>\n              <th class="p-4 font-bold">Описание</th>\n            </tr>\n          </thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr \n              v-for="(f, i) in filteredFields" \n              :key="i" \n              class="border-b border-white/5 hover:bg-white/5 transition-colors"\n            >\n              <td class="p-4 font-bold text-indigo-300">{{ f.mnemonic }}</td>\n              <td class="p-4 text-white font-sans font-bold">{{ f.name }}</td>\n              <td class="p-4">\n                <span class="px-2 py-1 rounded bg-white/5 text-[10px] text-gray-400 uppercase border border-white/5">\n                  {{ f.category }}\n                </span>\n              </td>\n              <td class="p-4 text-gray-500 font-mono text-xs">{{ f.unit || \'-\' }}</td>\n              <td class="p-4 text-gray-400 font-sans text-xs">{{ f.desc }}</td>\n            </tr>\n            <tr v-if="filteredFields.length === 0" class="border-b border-white/5">\n              <td colspan="5" class="p-8 text-center text-gray-500 font-sans">\n                Ничего не найдено. Попробуйте изменить параметры поиска.\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),d=e({template:'\n    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 h-full">\n      <div class="p-6 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer group">\n        <div class="p-3 bg-blue-500/20 rounded-xl text-blue-400 w-fit mb-4">\n          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>\n            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>\n          </svg>\n        </div>\n        <h3 class="text-lg font-bold text-white mb-2">Документация</h3>\n        <p class="text-sm text-gray-400 mb-4">Подробные руководства по функциям терминала, синтаксису и API.</p>\n        <span class="text-xs text-blue-400 font-bold group-hover:underline">Читать документацию →</span>\n      </div>\n      <div class="p-6 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer group">\n        <div class="p-3 bg-emerald-500/20 rounded-xl text-emerald-400 w-fit mb-4">\n          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>\n          </svg>\n        </div>\n        <h3 class="text-lg font-bold text-white mb-2">Поддержка</h3>\n        <p class="text-sm text-gray-400 mb-4">Чат с нашей службой поддержки 24/7 для решения технических вопросов.</p>\n        <span class="text-xs text-emerald-400 font-bold group-hover:underline">Начать чат →</span>\n      </div>\n      <div class="p-6 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 transition-colors cursor-pointer group">\n        <div class="p-3 bg-purple-500/20 rounded-xl text-purple-400 w-fit mb-4">\n          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <polyline points="16 18 22 12 16 6"></polyline>\n            <polyline points="8 6 2 12 8 18"></polyline>\n          </svg>\n        </div>\n        <h3 class="text-lg font-bold text-white mb-2">API Справочник</h3>\n        <p class="text-sm text-gray-400 mb-4">Интегрируйте данные терминала в свои приложения.</p>\n        <span class="text-xs text-purple-400 font-bold group-hover:underline">Просмотреть спецификацию →</span>\n      </div>\n      <div class="col-span-1 md:col-span-2 lg:col-span-3 p-6 rounded-2xl bg-black/20 border border-white/5 mt-4">\n        <h3 class="text-lg font-bold text-white mb-4">Часто задаваемые вопросы</h3>\n        <div class="space-y-2">\n          <div \n            v-for="q in [\n              \'Как создать пользовательскую формулу?\', \n              \'Где найти исторические данные по спредам?\', \n              \'Как экспортировать данные в Excel?\', \n              \'Какая задержка у Live feed?\',\n              \'Как использовать справочные данные в формулах?\',\n              \'Где найти документацию по API?\'\n            ]" \n            :key="q" \n            class="p-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 flex justify-between items-center cursor-pointer transition-colors"\n          >\n            <span class="text-sm text-gray-300">{{ q }}</span>\n            <span class="text-gray-600">→</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  '});return(e,t)=>(w(),i("div",aBt,[s("div",nBt,[s("div",rBt,[s("div",iBt,[(w(),b(C("FLDS"===l.value?O(n):O(r)),{class:"w-6 h-6"}))]),s("div",null,[s("h2",oBt,v("FLDS"===l.value?"СПРАВОЧНЫЕ ДАННЫЕ":"ПОМОЩЬ И ПОДДЕРЖКА"),1),s("p",sBt,v("FLDS"===l.value?"КАТАЛОГ ПОЛЕЙ ДАННЫХ ТЕРМИНАЛА":"ДОКУМЕНТАЦИЯ, FAQ И ПОДДЕРЖКА"),1)])]),s("div",lBt,[s("button",{onClick:t[0]||(t[0]=e=>l.value="FLDS"),class:c(["tab-btn",{active:"FLDS"===l.value}])}," СПРАВОЧНЫЕ ДАННЫЕ ",2),s("button",{onClick:t[1]||(t[1]=e=>l.value="HL"),class:c(["tab-btn",{active:"HL"===l.value}])}," ПОМОЩЬ ",2)])]),s("div",cBt,["FLDS"===l.value?(w(),b(O(u),{key:0})):(w(),b(O(d),{key:1}))])]))}}),dBt={class:"page-container custom-scrollbar"},hBt={class:"section-header flex-col md:flex-row gap-4"},pBt={class:"flex items-center gap-4"},fBt={class:"icon-box icon-indigo"},mBt={class:"tab-group"},vBt=["onClick"],gBt={class:"flex-1 flex flex-col gap-6"},yBt=e({__name:"SwapsPage",props:{symbol:{},activeSection:{}},setup(a){const n=e({render:()=>G("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("polyline",{points:"18 8 22 12 18 16"}),G("polyline",{points:"6 8 2 12 6 16"}),G("line",{x1:"2",y1:"12",x2:"22",y2:"12"})])}),r=a,o=t(r.activeSection||"SWPM");R(()=>r.activeSection,e=>{e&&(o.value=e)});const l=[{id:"SWPM",label:"Модель ценообразования"},{id:"IRSB",label:"Rate Basics"},{id:"IRSM",label:"Монитор"},{id:"ASW",label:"Asset Swap"}],d=e({setup:()=>({notional:t(10),fixedRate:t(4.25),tenor:t(5)}),template:'\n    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 h-full">\n      <div class="space-y-6">\n        <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n          <h3 class="text-sm font-bold text-gray-400 uppercase mb-4">Deal Parameters</h3>\n          <div class="space-y-4">\n            <div><label class="text-xs text-gray-500 block mb-1">Notional ($M)</label><input type="number" v-model="notional" class="w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white font-mono text-sm" /></div>\n            <div><label class="text-xs text-gray-500 block mb-1">Fixed Rate (%)</label><input type="number" v-model="fixedRate" class="w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white font-mono text-sm" /></div>\n            <div><label class="text-xs text-gray-500 block mb-1">Tenor (Years)</label><input type="range" min="1" max="30" v-model="tenor" class="w-full" /><div class="text-right text-xs text-indigo-400">{{ tenor }} Years</div></div>\n          </div>\n          <button class="w-full mt-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold">Calculate NPV</button>\n        </div>\n        <div class="p-6 rounded-2xl bg-black/20 border border-white/5 text-center">\n          <h3 class="text-xs font-bold text-gray-500 uppercase mb-2">Net Present Value</h3>\n          <div class="text-3xl font-bold font-mono text-emerald-400">+$145,230</div>\n        </div>\n      </div>\n      <div class="lg:col-span-2 p-6 rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-gray-500">\n        [Cash Flow Chart]\n      </div>\n    </div>\n  '}),h=e({setup:()=>({rates:[{ccy:"USD",t2y:"4.15%",t5y:"3.95%",t10y:"3.85%",t30y:"4.05%",trend:"down"},{ccy:"EUR",t2y:"2.85%",t5y:"2.60%",t10y:"2.65%",t30y:"2.75%",trend:"flat"},{ccy:"GBP",t2y:"4.45%",t5y:"4.10%",t10y:"4.00%",t30y:"4.15%",trend:"down"},{ccy:"JPY",t2y:"0.45%",t5y:"0.65%",t10y:"0.95%",t30y:"1.85%",trend:"up"}]}),template:'\n    <div class="flex flex-col h-full">\n      <h3 class="text-lg font-bold text-white mb-6">Major Currency Swap Rates</h3>\n      <div class="flex-1 bg-black/20 rounded-2xl border border-white/5 overflow-hidden">\n        <table class="w-full text-left border-collapse">\n          <thead><tr class="text-xs text-gray-500 uppercase bg-white/5"><th class="p-4">Currency</th><th class="p-4 text-center">Trend</th><th class="p-4 text-right">2Y</th><th class="p-4 text-right">5Y</th><th class="p-4 text-right">10Y</th><th class="p-4 text-right">30Y</th></tr></thead>\n          <tbody class="text-sm font-mono text-gray-300">\n            <tr v-for="r in rates" :key="r.ccy" class="border-b border-white/5 hover:bg-white/5">\n              <td class="p-4 font-bold text-white">{{ r.ccy }}</td>\n              <td class="p-4 text-center">{{ r.trend === \'down\' ? \'▼\' : r.trend === \'up\' ? \'▲\' : \'−\' }}</td>\n              <td class="p-4 text-right">{{ r.t2y }}</td>\n              <td class="p-4 text-right">{{ r.t5y }}</td>\n              <td class="p-4 text-right font-bold text-white">{{ r.t10y }}</td>\n              <td class="p-4 text-right">{{ r.t30y }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  '}),m=e({template:'\n    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 h-full">\n      <div class="bg-black/20 rounded-2xl border border-white/5 p-6 flex items-center justify-center text-gray-500">\n        [USD Swap Curve Chart]\n      </div>\n      <div class="flex flex-col gap-6">\n        <div class="bg-white/5 rounded-2xl border border-white/5 p-6">\n          <h3 class="text-lg font-bold text-white mb-4">Key Forward Rates</h3>\n          <table class="w-full text-left"><tbody class="text-sm font-mono text-gray-300">\n            <tr class="border-b border-white/5"><td class="py-2 font-bold text-white">1Y1Y</td><td class="text-right">3.85%</td><td class="text-right text-emerald-400">-10bp</td></tr>\n            <tr class="border-b border-white/5"><td class="py-2 font-bold text-white">5Y5Y</td><td class="text-right">4.10%</td><td class="text-right text-rose-400">+5bp</td></tr>\n          </tbody></table>\n        </div>\n        <div class="grid grid-cols-2 gap-4">\n          <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center"><div class="text-xs text-gray-500 uppercase mb-1">Swap Spread (10Y)</div><div class="text-2xl font-bold text-white">-15.5</div></div>\n          <div class="p-4 rounded-xl bg-white/5 border border-white/5 text-center"><div class="text-xs text-gray-500 uppercase mb-1">Fly (2s5s10s)</div><div class="text-2xl font-bold text-indigo-400">-22.0</div></div>\n        </div>\n      </div>\n    </div>\n  '}),g=e({template:'\n    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 h-full items-center">\n      <div class="p-6 rounded-2xl bg-white/5 border border-white/5">\n        <h3 class="text-lg font-bold text-white mb-6">Asset Details</h3>\n        <div class="space-y-4">\n          <div><label class="text-xs text-gray-500 block mb-1">Bond Price</label><input type="text" value="98.50" class="w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white font-mono text-sm" /></div>\n          <div class="grid grid-cols-2 gap-4">\n            <div><label class="text-xs text-gray-500 block mb-1">Coupon</label><input type="text" value="4.00%" class="w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white font-mono text-sm" /></div>\n            <div><label class="text-xs text-gray-500 block mb-1">Maturity</label><input type="text" value="15 Nov 2030" class="w-full bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white font-mono text-sm" /></div>\n          </div>\n        </div>\n        <button class="w-full mt-6 py-3 bg-teal-600 hover:bg-teal-500 text-white rounded-xl font-bold">Calculate Spread</button>\n      </div>\n      <div class="p-8 rounded-2xl bg-gradient-to-br from-teal-900/20 to-black border border-teal-500/30 text-center">\n        <h3 class="text-sm font-bold text-teal-500 uppercase mb-2">Asset Swap Spread</h3>\n        <div class="text-6xl font-bold text-white mb-2">32.5 <span class="text-2xl text-gray-500">bps</span></div>\n        <p class="text-xs text-gray-400">Spread over SOFR flat</p>\n      </div>\n    </div>\n  '});return(e,t)=>(w(),i("div",dBt,[s("div",hBt,[s("div",pBt,[s("div",fBt,[u(O(n),{class:"w-6 h-6"})]),t[0]||(t[0]=s("div",null,[s("h2",{class:"section-title font-anton"},"СВОПЫ"),s("p",{class:"section-subtitle font-mono"},"ЦЕНООБРАЗОВАНИЕ, ОЦЕНКА И КРИВЫЕ")],-1))]),s("div",mBt,[(w(),i(p,null,f(l,e=>s("button",{key:e.id,onClick:t=>o.value=e.id,class:c(["tab-btn",{active:o.value===e.id}])},v(e.label),11,vBt)),64))])]),s("div",gBt,["SWPM"===o.value?(w(),b(O(d),{key:0})):"IRSB"===o.value?(w(),b(O(h),{key:1})):"IRSM"===o.value?(w(),b(O(m),{key:2})):"ASW"===o.value?(w(),b(O(g),{key:3})):(w(),b(O(d),{key:4}))])]))}}),bBt={class:"dashboard-container"},xBt={key:1,class:"dashboard-empty"},wBt={class:"empty-content"},_Bt={class:"empty-count font-mono"},SBt=e({__name:"DashboardPage",props:{orderBook:{default:()=>({bids:[],asks:[]})},currentPrice:{default:0},chartData:{default:()=>[]},symbol:{default:"BTC/USDT"}},setup(e){const{isMobile:a,isSmallMobile:r,isTablet:l}=Ho(),c={OrderBook:_Rt,Chart:ORt,News:GRt,AI:pDt,Footer:vDt,Markets:MDt,Analytics:TDt,VOL:LDt,VOLG:LDt,CZF:LDt,CVRC:LDt,PSR:LDt,LVM:LDt,MVS:LDt,LIQ:LDt,HMM:LDt,TSIG:LDt,CORR:LDt,HMMD:LDt,ZSCR:LDt,OBHM:LDt,ENSD:LDt,FEAT:LDt,DDSH:LDt,EXEC:LDt,EXPO:LDt,OB3D:LDt,TVCN:LDt,CTENSOR:LDt,HELIX:LDt,HYPERCUBE:LDt,VORTEX:LDt,PLASMA:LDt,LATTICE:LDt,TICKCORE:LDt,GREEKS3D:LDt,REGNET:LDt,TAILCUBE:LDt,WSIGMA:cLt},u=e,d=t(null),h=S(()=>r.value?1:a.value?2:l.value?6:12),m=()=>{const e=localStorage.getItem("terminal-widgets");if(e)try{return JSON.parse(e).filter(e=>c[e.type]).map(e=>{const t=c[e.type];return t===LDt?{...e,component:t,props:{type:e.type,title:e.title||e.type,description:e.description||"",icon:e.icon||"ActivityIcon",iconBg:e.iconBg||"bg-emerald-500/20",iconColor:e.iconColor||"text-emerald-400",code:e.code||e.type,selectedAsset:""}}:{...e,component:t,props:g(e.type)}})}catch(TQe){console.error("Failed to load widgets:",TQe)}return[{id:"orderbook-1",type:"OrderBook",component:_Rt,props:{bids:u.orderBook.bids,asks:u.orderBook.asks,currentPrice:u.currentPrice},width:2,height:4},{id:"chart-1",type:"Chart",component:ORt,props:{data:u.chartData,symbol:u.symbol},width:6,height:4},{id:"news-1",type:"News",component:GRt,props:{},width:4,height:2},{id:"ai-1",type:"AI",component:pDt,props:{data:u.chartData},width:4,height:2},{id:"footer-1",type:"Footer",component:vDt,props:{},width:6,height:1}]},g=e=>{switch(e){case"OrderBook":return{bids:u.orderBook.bids,asks:u.orderBook.asks,currentPrice:u.currentPrice};case"Chart":return{data:u.chartData,symbol:u.symbol};case"AI":return{data:u.chartData};default:return{}}},x=t([]);return n(()=>{x.value=m(),console.log("Loaded widgets:",x.value),console.log("Widget components:",c),window.addEventListener("widgets-updated",()=>{x.value=m(),console.log("Widgets updated:",x.value)})}),R(()=>u.orderBook,()=>{x.value.forEach(e=>{"OrderBook"===e.type&&(e.props={...e.props,bids:u.orderBook.bids,asks:u.orderBook.asks,currentPrice:u.currentPrice})})},{deep:!0}),R(()=>u.chartData,()=>{x.value.forEach(e=>{"Chart"===e.type?e.props={...e.props,data:u.chartData,symbol:u.symbol}:"AI"===e.type&&(e.props={...e.props,data:u.chartData})})},{deep:!0}),(e,t)=>(w(),i("div",bBt,[t[2]||(t[2]=s("div",{class:"dashboard-header"},[s("div",null,[s("h2",{class:"dashboard-title font-oswald"},"ГЛАВНАЯ ПАНЕЛЬ"),s("p",{class:"dashboard-subtitle font-mono"},"Настраиваемая рабочая область")])],-1)),s("div",{ref_key:"gridRef",ref:d,class:"dashboard-grid-wrapper custom-scrollbar"},[x.value.length>0?(w(),i("div",{key:0,class:"dashboard-grid",style:y({gridTemplateColumns:`repeat(${h.value}, 1fr)`})},[(w(!0),i(p,null,f(x.value,e=>(w(),i("div",{key:e.id,style:y({gridColumn:`span ${e.width}`,gridRow:`span ${e.height}`,minHeight:"100px"}),class:"widget-container"},[(w(),b(C(e.component),o({ref_for:!0},e.props,{width:e.width,height:e.height,resizable:!1,"show-controls":!1}),null,16,["width","height"]))],4))),128))],4)):(w(),i("div",xBt,[s("div",wBt,[t[0]||(t[0]=s("p",{class:"empty-title font-oswald"},"НЕТ ВИДЖЕТОВ",-1)),t[1]||(t[1]=s("p",{class:"empty-subtitle font-mono"},"Загрузка виджетов...",-1)),s("p",_Bt,"Количество виджетов: "+v(x.value.length),1)])]))],512)]))}}),MBt=xe(SBt,[["__scopeId","data-v-56b74a99"]]),TBt={class:"terminal-root"},kBt={class:"terminal-content"},CBt={class:"tabs-bar"},ABt=["onClick"],EBt={class:"tab-label font-mono"},IBt=["onClick"],RBt={class:"terminal-header"},DBt={class:"header-left"},PBt={class:"nav-dropdown-wrapper"},LBt={class:"font-mono"},NBt={key:1,class:"nav-dropdown"},OBt={class:"nav-dropdown-list custom-scrollbar"},FBt=["onClick"],BBt={class:"nav-item-label font-oswald"},UBt={class:"nav-item-code font-mono"},zBt={class:"header-right"},VBt={key:0,class:"ai-indicator"},HBt={class:"profile-wrapper"},GBt={key:0,class:"profile-dropdown"},WBt={class:"profile-menu"},qBt={class:"profile-footer"},YBt={class:"flex-1 overflow-y-auto min-h-0 custom-scrollbar"},jBt=e({__name:"Terminal",setup(e){const a=t([]),r=t(dze),o=t({bids:[],asks:[]}),d=t(!0),h=t([{id:"main-1",view:"Main",title:"Главная"}]),m=t("main-1"),g=t("Main"),y=t(["Main"]),x=t(!1),_=t(!1);t(!1);const M=t(!1),k=t("BTC/USDT"),A=t(null);t({showOrderBook:!0,showTradeForm:!0,showFooter:!0});const D=t("All"),L=t("TOP"),N=t("AI"),O=t("EQS"),F=t("EE"),B=t("HP"),U=t("FXC"),V=t("BLP"),H=t("GOVT"),G=t("FOMC"),W=t("CMDX"),q=t("SRSK"),Y=t("EARN"),j=t("IPO"),X=t("YAS"),$=t("CTRK"),K=t("WEI"),Z=t("ECOD"),J=t("OMON"),Q=t("RES"),ee=t("FLDS"),te=t("SWPM"),ae=[{id:"Main",label:"Главная",icon:"ActivityIcon",code:"HOME"},{id:"Markets",label:"Акции",icon:"GlobeIcon",code:"MKT"},{id:"Crypto",label:"Криптовалюты",icon:"ActivityIcon",code:"CRYPTO"},{id:"PriceAnalysis",label:"Анализ цен",icon:"TrendingUpIcon",code:"GP"},{id:"Screening",label:"Скрининг",icon:"FilterIcon",code:"EQS"},{id:"Analytics",label:"Аналитика",icon:"PieChartIcon",code:"QUA"},{id:"News",label:"Новости",icon:"WifiIcon",code:"TOP"},{id:"Fundamental",label:"Фундаментальный анализ",icon:"SearchIcon",code:"EE"},{id:"FX",label:"Валютный рынок",icon:"DollarSignIcon",code:"FX"},{id:"Bonds",label:"Облигации",icon:"ActivityIcon",code:"GOVT"},{id:"CentralBanks",label:"Центробанки",icon:"DatabaseIcon",code:"FOMC"},{id:"Commodities",label:"Сырьё",icon:"TrendingUpIcon",code:"CMDX"},{id:"CreditRisk",label:"Кредитный риск",icon:"FilterIcon",code:"SRSK"},{id:"Earn",label:"Доходность",icon:"PieChartIcon",code:"EARN"},{id:"EventDriven",label:"События",icon:"WifiIcon",code:"IPO"},{id:"Finance",label:"Финансы",icon:"DatabaseIcon",code:"PORT"},{id:"FixedIncome",label:"Фикс. доход",icon:"ActivityIcon",code:"YAS"},{id:"Futures",label:"Фьючерсы",icon:"TrendingUpIcon",code:"CTRK"},{id:"Indices",label:"Индексы",icon:"PieChartIcon",code:"WEI"},{id:"Macro",label:"Макроэкономика",icon:"DatabaseIcon",code:"ECOD"},{id:"Options",label:"Опционы",icon:"FilterIcon",code:"OMON"},{id:"Research",label:"Исследования",icon:"SearchIcon",code:"RES"},{id:"Resources",label:"Ресурсы",icon:"DatabaseIcon",code:"FLDS"},{id:"Swaps",label:"Свопы",icon:"ActivityIcon",code:"SWPM"}],ne=[{id:"HOME",label:"Главная",code:"HOME",type:"command",description:"Вернуться на главный экран"},{id:"MKT",label:"Акции",code:"MKT",type:"command",description:"Акции и индексы"},{id:"CRYPTO",label:"Криптовалюты",code:"CRYPTO",type:"command",description:"Криптовалютные активы"},{id:"TOP",label:"Новости",code:"TOP",type:"command",description:"Главные новости по важности"},{id:"GP",label:"График цен",code:"GP",type:"command",description:"Технический анализ с индикаторами"},{id:"EQS",label:"Скрининг акций",code:"EQS",type:"command",description:"Фильтрация компаний по параметрам"},{id:"QUA",label:"Квант-анализ",code:"QUA",type:"command",description:"Количественные метрики и риски"},{id:"EE",label:"Прогноз прибыли",code:"EE",type:"command",description:"Прогнозы на 1-2 года"},{id:"FX",label:"Валютный рынок",code:"FX",type:"command",description:"Валютные курсы и анализ"},{id:"GOVT",label:"Облигации",code:"GOVT",type:"command",description:"Гос. и корпоративные облигации"},{id:"FOMC",label:"Центробанки",code:"FOMC",type:"command",description:"Монетарная политика и ставки"},{id:"CMDX",label:"Сырьё",code:"CMDX",type:"command",description:"Энергия, металлы, агрокультуры"},{id:"SRSK",label:"Кредитный риск",code:"SRSK",type:"command",description:"Рейтинги и CDS анализ"},{id:"EARN",label:"Доходность",code:"EARN",type:"command",description:"Стейкинг и фарминг"},{id:"IPO",label:"События",code:"IPO",type:"command",description:"IPO и корпоративные действия"},{id:"PORT",label:"Финансы",code:"PORT",type:"command",description:"Обзор портфеля"},{id:"YAS",label:"Фикс. доход",code:"YAS",type:"command",description:"Анализ доходности и спредов"},{id:"CTRK",label:"Фьючерсы",code:"CTRK",type:"command",description:"Фьючерсные контракты и роллы"},{id:"WEI",label:"Индексы",code:"WEI",type:"command",description:"Мировые индексы"},{id:"ECOD",label:"Макроэкономика",code:"ECOD",type:"command",description:"Экономические данные и прогнозы"},{id:"OMON",label:"Опционы",code:"OMON",type:"command",description:"Опционные цепочки и греки"},{id:"RES",label:"Исследования",code:"RES",type:"command",description:"Инвестиционные исследования"},{id:"FLDS",label:"Ресурсы",code:"FLDS",type:"command",description:"Справочник данных и помощь"},{id:"SWPM",label:"Свопы",code:"SWPM",type:"command",description:"Ценообразование IRS и CDS"},{id:"SET",label:"Настройки",code:"SET",type:"command",description:"Настройка терминала"},{id:"VOL",label:"Поверхность волатильности",code:"VOL",type:"command",description:"3D визуализация волатильности по страйкам и экспирациям"},{id:"VOLG",label:"Поверхность волатильности (по грекам)",code:"VOLG",type:"command",description:"3D визуализация волатильности по страйкам и экспирациям на основе греков"},{id:"CZF",label:"Citadel Zeta Field",code:"CZF",type:"command",description:"Анализ поля дзета-параметров Citadel"},{id:"CVRC",label:"Convolutional Volatility Resolution Clustering",code:"CVRC",type:"command",description:"Кластеризация волатильности с использованием сверточных нейросетей"},{id:"PSR",label:"Phase Space Reconstruction",code:"PSR",type:"command",description:"Реконструкция фазового пространства для анализа динамики"},{id:"LVM",label:"Latent Volatility model",code:"LVM",type:"command",description:"Модель скрытой волатильности"},{id:"MVS",label:"Momentum-Volatility Surface",code:"MVS",type:"command",description:"Поверхность волатильности с учетом импульса"},{id:"LIQ",label:"Liquidity Model",code:"LIQ",type:"command",description:"Модель ликвидности рынка"},{id:"HMM",label:"HMM regime model visualization",code:"HMM",type:"command",description:"Визуализация режимов скрытой марковской модели"},{id:"TSIG",label:"Time series с сигналами",code:"TSIG",type:"command",description:"Линейный/бар чарт цены + наложение флагов buy/sell"},{id:"CORR",label:"Correlation heatmap",code:"CORR",type:"command",description:"Цветная матрица корреляций"},{id:"HMMD",label:"HMM state diagram",code:"HMMD",type:"command",description:"Граф состояний + timeline colors"},{id:"ZSCR",label:"Z‑score residuals",code:"ZSCR",type:"command",description:"Линейный график отклонений"},{id:"OBHM",label:"Order book heatmap",code:"OBHM",type:"command",description:"Цветная карта глубины стакана"},{id:"ENSD",label:"Ensemble signal distribution",code:"ENSD",type:"command",description:"Гистограмма/confidence bands"},{id:"FEAT",label:"Feature importance bar chart",code:"FEAT",type:"command",description:"Столбцы значимости факторов"},{id:"DDSH",label:"Drawdown/Sharpe timeline",code:"DDSH",type:"command",description:"Накопленный график + метрики"},{id:"EXEC",label:"Latency/slippage scatter",code:"EXEC",type:"command",description:"Точечный график execution metrics"},{id:"EXPO",label:"Turnover/exposure matrix",code:"EXPO",type:"command",description:"Heatmap позиций по активам"},{id:"OB3D",label:"Объёмная карта ордербука (3D Depth Map)",code:"OB3D",type:"command",description:"Трёхмерная визуализация глубины стакана"},{id:"TVCN",label:"Динамическая корреляционная сеть (Time‑Varying Correlation Network)",code:"TVCN",type:"command",description:"Сетевая визуализация корреляций во времени"},{id:"CTENSOR",label:"Ковариационный куб (Covariance Tensor Cube)",code:"CTENSOR",type:"command",description:"Трёхмерное представление ковариационной матрицы"},{id:"HELIX",label:"Объёмно‑временная спираль ликвидности (Liquidity Helix)",code:"HELIX",type:"command",description:"Спиральная визуализация ликвидности во времени"},{id:"HYPERCUBE",label:"Пространство корреляций во времени (Correlation Hypercube)",code:"HYPERCUBE",type:"command",description:"Гиперкубическое представление корреляций"},{id:"VORTEX",label:"Вихрь рыночных настроений (Sentiment Vortex)",code:"VORTEX",type:"command",description:"Вихревая визуализация рыночных настроений"},{id:"PLASMA",label:"«Плазма» потока опционных сделок",code:"PLASMA",type:"command",description:"Визуализация в реальном времени потока опционных сделок как заряженных частиц в магнитном поле"},{id:"LATTICE",label:"«Кристаллическая решетка аукциона» (Auction Lattice)",code:"LATTICE",type:"command",description:"3D-структура, показывающая историю и текущее состояние аукциона (открытия/закрытия на бирже, аукциона MOC)"},{id:"TICKCORE",label:"«Тактовый сердечник» процессора исполнения",code:"TICKCORE",type:"command",description:"Метафора процессора, где каждый такт — это пакет рыночных данных (тик). Визуализация нагрузки и задержек в обработке"},{id:"GREEKS3D",label:"3D Greeks Tensor (Delta-Gamma-Vega landscape)",code:"GREEKS3D",type:"command",description:"Для портфеля опционов/структурных продуктов показывай греки как трёхмерный тензор"},{id:"REGNET",label:"Regime Correlation Network (HMM‑driven)",code:"REGNET",type:"command",description:"3D‑граф корреляций, где высота узлов пропорциональна posterior probability текущего режима (из HMM)"},{id:"TAILCUBE",label:"Tail Risk Cube (EVT Stress Scenarios)",code:"TAILCUBE",type:"command",description:"Куб, где каждый слой — сценарий стресса (GPD fits для tails), вокселы — P&L портфеля при quantile α"}],re=S(()=>[...ne]),ie=e=>{y.value=[e,...y.value].slice(0,9);const t=h.value.find(e=>e.id===m.value);t&&(t.view=e,t.title=le(e)),g.value=e,x.value=!1},oe=e=>{m.value=e;const t=h.value.find(t=>t.id===e);t&&(g.value=t.view)},se=(e="Main")=>{const t={id:`window-${Date.now()}`,view:e,title:le(e)};h.value.push(t),oe(t.id)},le=e=>{const t=ae.find(t=>t.id===e);return t?.label||e},ce={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>'},ue={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>'},de={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>'},he={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>'},pe={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>'},fe={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>'},me={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.364 6.364l-4.243-4.243m-4.242 0L5.636 18.364m12.728 0l-4.243-4.243m-4.242 0L5.636 5.636"/></svg>'},ve={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>'},ge={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>'},ye={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>'},be={template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>'},xe={ActivityIcon:ce,GlobeIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>'},TrendingUpIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>'},FilterIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></svg>'},PieChartIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>'},WifiIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" y1="20" x2="12.01" y2="20"/></svg>'},SearchIcon:he,DollarSignIcon:{template:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>'},DatabaseIcon:ge},we=e=>{const t=ae.find(t=>t.id===e);return xe[t?.icon||"ActivityIcon"]||ce},_e=e=>{if("command"===e.type){const t=e.code||"";let a="Main";"HOME"===t?a="Main":"TOP"===t?a="News":"GP"===t?a="PriceAnalysis":"EQS"===t?a="Screening":"QUA"===t?a="Analytics":"EE"===t?a="Fundamental":"FX"===t?a="FX":"SET"===t?a="Settings":"MKT"===t?a="Markets":"CRYPTO"===t?a="Crypto":"GOVT"===t?a="Bonds":"FOMC"===t?a="CentralBanks":"CMDX"===t?a="Commodities":"SRSK"===t?a="CreditRisk":"EARN"===t?a="Earn":"IPO"===t?a="EventDriven":"PORT"===t?a="Finance":"YAS"===t?a="FixedIncome":"CTRK"===t?a="Futures":"WEI"===t?a="Indices":"ECOD"===t?a="Macro":"OMON"===t?a="Options":"RES"===t?a="Research":"FLDS"===t?a="Resources":"SWPM"===t?a="Swaps":["VOL","VOLG","CZF","CVRC","PSR","LVM","MVS","LIQ","HMM","TSIG","CORR","HMMD","ZSCR","OBHM","ENSD","FEAT","DDSH","EXEC","EXPO","OB3D","TVCN","CTENSOR","HELIX","HYPERCUBE","VORTEX","PLASMA","LATTICE","TICKCORE","GREEKS3D","REGNET","TAILCUBE"].includes(t)&&(a="Analytics",N.value="Quant"),se(a),_.value=!1}},Se=e=>{A.value=e},Me=e=>{(e=>{k.value=e,a.value=hze(100),o.value=pze(r.value)})(e),ie("Main")};return n(()=>{const e=e=>{(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),_.value=!_.value)};document.addEventListener("keydown",e),a.value=hze(100),o.value=pze(dze);let t=0;const n=setInterval(()=>{const e=30*(Math.random()-.5);if(r.value=r.value+e,o.value=pze(r.value),t++,t>=3){t=0;const e=a.value[a.value.length-1],n=new Date,i={time:`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`,open:e.close,high:r.value+20*Math.random(),low:r.value-20*Math.random(),close:r.value,volume:.5+2*Math.random()};a.value=[...a.value.slice(1),i]}else a.value=a.value.map((e,t,a)=>t===a.length-1?{...e,close:r.value,high:Math.max(e.high,r.value),low:Math.min(e.low,r.value),volume:e.volume+.1*Math.random()}:e)},1e3);z(()=>{document.removeEventListener("keydown",e),clearInterval(n)})}),R(()=>k.value,()=>{a.value=hze(100),o.value=pze(r.value)}),(e,t)=>(w(),i("div",TBt,[t[27]||(t[27]=s("div",{class:"bg-noise"},null,-1)),u(Aze,{isOpen:_.value,onClose:t[0]||(t[0]=e=>_.value=!1),onSelect:_e,items:re.value},null,8,["isOpen","items"]),s("div",kBt,[s("div",CBt,[(w(!0),i(p,null,f(h.value,e=>(w(),i("div",{key:e.id,onClick:t=>oe(e.id),class:c(["tab-item",{"tab-active":m.value===e.id}])},[(w(),b(C(we(e.view)),{class:"w-3.5 h-3.5"})),s("span",EBt,v(le(e.view)),1),h.value.length>1?(w(),i("button",{key:0,onClick:E(t=>(e=>{if(h.value.length<=1)return;const t=h.value.findIndex(t=>t.id===e);if(-1!==t&&(h.value.splice(t,1),m.value===e)){const e=t>0?t-1:0;oe(h.value[e].id)}})(e.id),["stop"]),class:"tab-close"},[u(fe,{class:"w-3 h-3"})],8,IBt)):l("",!0)],10,ABt))),128)),s("button",{onClick:t[1]||(t[1]=()=>se()),class:"tab-new",title:"Открыть новое окно"},[u(pe,{class:"w-3.5 h-3.5"}),t[14]||(t[14]=s("span",{class:"font-mono"},"Новое окно",-1))])]),s("header",RBt,[s("div",DBt,[s("div",{class:"logo-area",onClick:t[2]||(t[2]=e=>g.value="Main")},[...t[15]||(t[15]=[s("div",{class:"logo-icon"},[s("span",{class:"font-oswald"},"ζ")],-1),s("span",{class:"logo-text font-oswald hidden lg:block"},"ДЗЕТА-ТЕРМИНАЛ",-1)])]),s("div",PBt,[s("button",{onClick:t[3]||(t[3]=e=>x.value=!x.value),class:c(["nav-dropdown-trigger",{"is-open":x.value}])},[u(ue,{class:"w-3.5 h-3.5 text-[#DC2626]"}),s("span",LBt,v(ae.find(e=>e.id===g.value)?.label||g.value),1),u(de,{class:c(["w-3 h-3 transition-transform",{"rotate-180":x.value}])},null,8,["class"])],2),x.value?(w(),i("div",{key:0,class:"nav-overlay",onClick:t[4]||(t[4]=e=>x.value=!1)})):l("",!0),x.value?(w(),i("div",NBt,[t[16]||(t[16]=s("div",{class:"nav-dropdown-header font-mono"},[s("span",null,"НАВИГАЦИЯ"),s("span",null,"КОД")],-1)),s("div",OBt,[(w(),i(p,null,f(ae,e=>s("button",{key:e.id,onClick:t=>ie(e.id),class:c(["nav-item",{"nav-item-active":g.value===e.id}])},[(w(),b(C(xe[e.icon]||ce),{class:"w-4 h-4"})),s("span",BBt,v(e.label),1),s("span",UBt,v(e.code),1)],10,FBt)),64))])])):l("",!0)])]),s("div",zBt,[s("div",{onClick:t[5]||(t[5]=e=>_.value=!0),class:"search-trigger hidden xl:flex"},[u(he,{class:"w-3.5 h-3.5"}),t[17]||(t[17]=s("span",{class:"font-mono"},"Поиск",-1)),t[18]||(t[18]=s("div",{class:"search-hotkey font-mono"},"⌘K",-1))]),t[26]||(t[26]=s("div",{class:"header-divider hidden md:block"},null,-1)),s("button",{onClick:t[6]||(t[6]=e=>d.value=!d.value),class:c(["ai-btn hidden md:flex",{"ai-btn-active":d.value}])},[t[19]||(t[19]=s("span",{class:"font-oswald"},"SPARK AI",-1)),d.value?(w(),i("span",VBt)):l("",!0)],2),s("div",HBt,[s("button",{onClick:t[7]||(t[7]=e=>M.value=!M.value),class:"profile-avatar font-oswald"}," AT "),M.value?(w(),i("div",GBt,[t[25]||(t[25]=I('<div class="profile-header" data-v-d8511062><div class="profile-avatar-lg font-oswald" data-v-d8511062>AT</div><div class="profile-info" data-v-d8511062><div class="profile-name font-oswald" data-v-d8511062>АЛЕКСЕЙ ТРЕЙДЕР</div><div class="profile-badge font-mono" data-v-d8511062>PRO АККАУНТ</div></div></div>',1)),s("div",WBt,[s("button",{onClick:t[8]||(t[8]=t=>{e.$router.push("/profile"),M.value=!1}),class:"profile-menu-item"},[u(be,{class:"w-4 h-4"}),t[20]||(t[20]=s("span",{class:"font-oswald"},"Профиль",-1))]),s("button",{onClick:t[9]||(t[9]=e=>{ie("Settings"),M.value=!1}),class:"profile-menu-item"},[u(me,{class:"w-4 h-4"}),t[21]||(t[21]=s("span",{class:"font-oswald"},"Настройки",-1))]),s("button",{onClick:t[10]||(t[10]=e=>{ee.value="HL",ie("Resources"),M.value=!1}),class:"profile-menu-item"},[u(ve,{class:"w-4 h-4"}),t[22]||(t[22]=s("span",{class:"font-oswald"},"Помощь",-1))]),s("button",{onClick:t[11]||(t[11]=e=>{ee.value="FLDS",ie("Resources"),M.value=!1}),class:"profile-menu-item"},[u(ge,{class:"w-4 h-4"}),t[23]||(t[23]=s("span",{class:"font-oswald"},"Справочник данных",-1))])]),s("div",qBt,[s("button",{onClick:t[12]||(t[12]=t=>{e.$router.push("/"),M.value=!1}),class:"profile-logout"},[u(ye,{class:"w-4 h-4"}),t[24]||(t[24]=s("span",{class:"font-oswald"},"Выйти",-1))])])])):l("",!0)])])]),s("div",YBt,[(w(!0),i(p,null,f(h.value,e=>T((w(),i("div",{key:e.id,class:"w-full min-h-full"},["Main"===e.view?(w(),b(MBt,{key:0,orderBook:o.value,currentPrice:r.value,chartData:a.value,symbol:k.value},null,8,["orderBook","currentPrice","chartData","symbol"])):"Markets"===e.view?(w(),b(mVe,{key:1,category:D.value,onNavigate:t=>{const a=h.value.find(t=>t.id===e.id);a&&(a.view=t,a.title=le(t)),ie(t)},onAssetClick:Se},null,8,["category","onNavigate"])):"Crypto"===e.view?(w(),b(HVe,{key:2,onNavigate:t=>{const a=h.value.find(t=>t.id===e.id);a&&(a.view=t,a.title=le(t)),ie(t)},onAssetClick:Se},null,8,["onNavigate"])):"News"===e.view?(w(),b(RHe,{key:3,activeSection:L.value},null,8,["activeSection"])):"Analytics"===e.view?(w(),b(Pkt,{key:4,activeSection:N.value},null,8,["activeSection"])):"Screening"===e.view?(w(),b(NCt,{key:5,symbol:k.value,activeSection:O.value},null,8,["symbol","activeSection"])):"Fundamental"===e.view?(w(),b(BAt,{key:6,symbol:k.value,activeSection:F.value},null,8,["symbol","activeSection"])):"PriceAnalysis"===e.view?(w(),b(JEt,{key:7,symbol:k.value,activeSection:B.value},null,8,["symbol","activeSection"])):"FX"===e.view?(w(),b(eRt,{key:8,symbol:k.value,activeSection:U.value},null,8,["symbol","activeSection"])):"Settings"===e.view?(w(),b(uNt,{key:9,activeSection:V.value},null,8,["activeSection"])):"Bonds"===e.view?(w(),b(KNt,{key:10,activeSection:H.value},null,8,["activeSection"])):"CentralBanks"===e.view?(w(),b(rOt,{key:11,activeSection:G.value},null,8,["activeSection"])):"Commodities"===e.view?(w(),b(hOt,{key:12,symbol:k.value,activeSection:W.value},null,8,["symbol","activeSection"])):"CreditRisk"===e.view?(w(),b(xOt,{key:13,symbol:k.value,activeSection:q.value},null,8,["symbol","activeSection"])):"Earn"===e.view?(w(),b(POt,{key:14,activeSection:Y.value},null,8,["activeSection"])):"EventDriven"===e.view?(w(),b(VOt,{key:15,symbol:k.value,activeSection:j.value},null,8,["symbol","activeSection"])):"Finance"===e.view?(w(),b(sFt,{key:16,onAssetClick:Se})):"FixedIncome"===e.view?(w(),b(mFt,{key:17,activeSection:X.value},null,8,["activeSection"])):"Futures"===e.view?(w(),b(SFt,{key:18,symbol:k.value,activeSection:$.value},null,8,["symbol","activeSection"])):"Indices"===e.view?(w(),b(RFt,{key:19,activeSection:K.value},null,8,["activeSection"])):"Macro"===e.view?(w(),b(UFt,{key:20,activeSection:Z.value},null,8,["activeSection"])):"Options"===e.view?(w(),b(jFt,{key:21,symbol:k.value,activeSection:J.value},null,8,["symbol","activeSection"])):"Research"===e.view?(w(),b(tBt,{key:22,symbol:k.value,activeSection:Q.value},null,8,["symbol","activeSection"])):"Resources"===e.view?(w(),b(uBt,{key:23,activeSection:ee.value},null,8,["activeSection"])):"Swaps"===e.view?(w(),b(yBt,{key:24,symbol:k.value,activeSection:te.value},null,8,["symbol","activeSection"])):l("",!0)])),[[P,m.value===e.id]])),128))])]),A.value?(w(),b(HNt,{key:0,asset:A.value,onClose:t[13]||(t[13]=e=>A.value=null),onTrade:Me},null,8,["asset"])):l("",!0)]))}}),XBt=xe(jBt,[["__scopeId","data-v-d8511062"]]),$Bt={class:"relative h-screen w-screen overflow-hidden bg-[var(--bg-primary)] text-white font-sans"},KBt={class:"relative z-10 flex flex-col h-full p-4 gap-4"},ZBt={class:"h-12 bg-[var(--bg-secondary)] border border-[var(--border-dark)] flex items-center justify-between px-4 flex-shrink-0"},JBt={class:"flex items-center gap-4"},QBt={class:"flex-1 bg-[var(--bg-secondary)] border border-[var(--border-dark)] overflow-hidden flex flex-col overflow-y-auto custom-scrollbar"},eUt={class:"p-8 max-w-4xl mx-auto w-full space-y-8"},tUt={class:"flex flex-col md:flex-row items-center md:items-start gap-6 pb-8 border-b border-[var(--border-dark)]"},aUt={class:"relative group"},nUt={class:"w-32 h-32 bg-[var(--bg-tertiary)] border-2 border-[var(--border-dark)] flex items-center justify-center text-[var(--accent-red)] font-bold text-2xl font-anton relative overflow-hidden"},rUt={key:0},iUt=["src"],oUt={class:"flex-1 text-center md:text-left"},sUt={class:"text-2xl font-anton text-white mb-2 uppercase tracking-wider"},lUt={class:"flex flex-wrap items-center justify-center md:justify-start gap-2 mb-4"},cUt={class:"text-xs text-[var(--accent-red)] font-mono bg-[var(--accent-red)]/10 px-2 py-1 border border-[var(--accent-red)]/30"},uUt={class:"text-xs text-[var(--text-muted)] font-mono"},dUt={class:"text-sm text-[var(--text-secondary)]"},hUt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pUt={class:"space-y-4"},fUt={class:"space-y-4"},mUt={class:"pt-6 border-t border-[var(--border-dark)]"},vUt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},gUt={class:"space-y-2"},yUt={class:"flex items-center gap-3 text-sm text-[var(--text-secondary)] cursor-pointer group"},bUt={class:"flex items-center gap-3 text-sm text-[var(--text-secondary)] cursor-pointer group"},xUt={class:"flex items-center gap-3 text-sm text-[var(--text-secondary)] cursor-pointer group"},wUt={class:"flex justify-end gap-4 pt-6 border-t border-[var(--border-dark)]"},_Ut=e({__name:"Profile",setup(a){x();const n=t(null),r=t({name:"Алексей Трейдер",email:"alex.trader@example.com",phone:"+7 (999) 123-45-67",bio:"Профессиональный трейдер с опытом работы на финансовых рынках",avatar:null,accountType:"Pro Аккаунт",userId:"AT-2024-001",timezone:"UTC+03:00",language:"ru",currency:"RUB",notifications:{email:!0,push:!0,sms:!1}}),o=()=>{n.value?.click()},l=e=>{const t=e.target;if(t.files&&t.files[0]){const e=new FileReader;e.onload=e=>{r.value.avatar=e.target?.result},e.readAsDataURL(t.files[0])}},c=()=>{alert("Профиль успешно сохранён!")},p=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),G("circle",{cx:"12",cy:"13",r:"4"})])}),f=e({render:()=>G("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[G("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),G("polyline",{points:"17 21 17 13 7 13 7 21"}),G("polyline",{points:"7 3 7 8 15 8"})])});return(e,t)=>{const a=d("router-link");return w(),i("div",$Bt,[s("div",KBt,[s("header",ZBt,[s("div",JBt,[u(a,{to:"/terminal",class:"flex items-center gap-2 text-white cursor-pointer flex-shrink-0"},{default:h(()=>[...t[12]||(t[12]=[s("div",{class:"w-8 h-8 bg-[var(--accent-red)] flex items-center justify-center"},[s("span",{class:"text-white font-bold text-sm"},"ζ")],-1),s("span",{class:"font-anton tracking-tight text-sm hidden lg:block"},"ДЗЕТА-ТЕРМИНАЛ",-1)])]),_:1}),t[13]||(t[13]=s("div",{class:"h-4 w-[1px] bg-[var(--border-dark)]"},null,-1)),t[14]||(t[14]=s("h1",{class:"text-sm font-bold text-white font-oswald uppercase tracking-wider"},"Профиль",-1))]),s("button",{onClick:t[0]||(t[0]=t=>e.$router.back()),class:"px-4 py-2 text-xs text-[var(--text-muted)] hover:text-white transition-colors border border-[var(--border-dark)] hover:border-[var(--accent-red)] font-mono uppercase"}," Назад ")]),s("div",QBt,[s("div",eUt,[s("div",tUt,[s("div",aUt,[s("div",nUt,[r.value.avatar?(w(),i("img",{key:1,src:r.value.avatar,alt:"Avatar",class:"w-full h-full object-cover"},null,8,iUt)):(w(),i("span",rUt,v(r.value.name.substring(0,2).toUpperCase()),1))]),s("button",{onClick:o,class:"absolute bottom-0 right-0 w-10 h-10 bg-[var(--accent-red)] hover:bg-red-700 flex items-center justify-center transition-colors border border-[var(--border-dark)]"},[u(O(p),{class:"w-5 h-5 text-white"})]),s("input",{ref_key:"avatarInput",ref:n,type:"file",accept:"image/*",onChange:l,class:"hidden"},null,544)]),s("div",oUt,[s("h2",sUt,v(r.value.name),1),s("div",lUt,[s("span",cUt,v(r.value.accountType),1),t[15]||(t[15]=s("span",{class:"text-xs text-[var(--text-muted)]"},"•",-1)),s("span",uUt,"ID: "+v(r.value.userId),1)]),s("p",dUt,v(r.value.bio||"Добавьте описание профиля"),1)])]),s("div",hUt,[s("div",pUt,[t[19]||(t[19]=s("h3",{class:"text-lg font-oswald text-white mb-4 uppercase tracking-wider border-l-2 border-[var(--accent-red)] pl-3"},"Основная информация",-1)),s("div",null,[t[16]||(t[16]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Имя",-1)),T(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value.name=e),type:"text",class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors font-mono",placeholder:"Введите имя"},null,512),[[k,r.value.name]])]),s("div",null,[t[17]||(t[17]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Email",-1)),T(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.value.email=e),type:"email",class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors font-mono",placeholder:"email@example.com"},null,512),[[k,r.value.email]])]),s("div",null,[t[18]||(t[18]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Телефон",-1)),T(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.value.phone=e),type:"tel",class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors font-mono",placeholder:"+7 (999) 123-45-67"},null,512),[[k,r.value.phone]])])]),s("div",fUt,[t[25]||(t[25]=s("h3",{class:"text-lg font-oswald text-white mb-4 uppercase tracking-wider border-l-2 border-[var(--accent-red)] pl-3"},"Дополнительно",-1)),s("div",null,[t[20]||(t[20]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Описание",-1)),T(s("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.value.bio=e),rows:"3",class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors resize-none font-mono",placeholder:"Краткое описание о себе..."},null,512),[[k,r.value.bio]])]),s("div",null,[t[22]||(t[22]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Часовой пояс",-1)),T(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.value.timezone=e),class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors font-mono"},[...t[21]||(t[21]=[s("option",{value:"UTC+03:00"},"UTC+03:00 (Москва)",-1),s("option",{value:"UTC+00:00"},"UTC+00:00 (Лондон)",-1),s("option",{value:"UTC-05:00"},"UTC-05:00 (Восточное время)",-1),s("option",{value:"UTC+08:00"},"UTC+08:00 (Пекин)",-1)])],512),[[D,r.value.timezone]])]),s("div",null,[t[24]||(t[24]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Язык интерфейса",-1)),T(s("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>r.value.language=e),class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors font-mono"},[...t[23]||(t[23]=[s("option",{value:"ru"},"Русский",-1),s("option",{value:"en"},"English",-1)])],512),[[D,r.value.language]])])])]),s("div",mUt,[t[32]||(t[32]=s("h3",{class:"text-lg font-oswald text-white mb-4 uppercase tracking-wider border-l-2 border-[var(--accent-red)] pl-3"},"Предпочтения",-1)),s("div",vUt,[s("div",null,[t[27]||(t[27]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Валюта по умолчанию",-1)),T(s("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>r.value.currency=e),class:"w-full bg-[var(--bg-tertiary)] border border-[var(--border-dark)] py-2.5 px-4 text-sm text-white focus:border-[var(--accent-red)] outline-none transition-colors font-mono"},[...t[26]||(t[26]=[s("option",{value:"RUB"},"RUB - Российский рубль",-1),s("option",{value:"USD"},"USD - Доллар США",-1),s("option",{value:"EUR"},"EUR - Евро",-1)])],512),[[D,r.value.currency]])]),s("div",null,[t[31]||(t[31]=s("label",{class:"block text-xs font-bold text-[var(--text-muted)] uppercase mb-2 font-mono"},"Уведомления",-1)),s("div",gUt,[s("label",yUt,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>r.value.notifications.email=e),class:"w-4 h-4 border border-[var(--border-dark)] bg-[var(--bg-tertiary)] accent-[var(--accent-red)]"},null,512),[[L,r.value.notifications.email]]),t[28]||(t[28]=s("span",{class:"group-hover:text-white transition-colors"},"Email уведомления",-1))]),s("label",bUt,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>r.value.notifications.push=e),class:"w-4 h-4 border border-[var(--border-dark)] bg-[var(--bg-tertiary)] accent-[var(--accent-red)]"},null,512),[[L,r.value.notifications.push]]),t[29]||(t[29]=s("span",{class:"group-hover:text-white transition-colors"},"Push уведомления",-1))]),s("label",xUt,[T(s("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=e=>r.value.notifications.sms=e),class:"w-4 h-4 border border-[var(--border-dark)] bg-[var(--bg-tertiary)] accent-[var(--accent-red)]"},null,512),[[L,r.value.notifications.sms]]),t[30]||(t[30]=s("span",{class:"group-hover:text-white transition-colors"},"SMS уведомления",-1))])])])])]),s("div",wUt,[s("button",{onClick:t[11]||(t[11]=t=>e.$router.back()),class:"px-6 py-2.5 bg-[var(--bg-tertiary)] hover:bg-[var(--border-dark)] text-[var(--text-secondary)] hover:text-white text-sm font-bold transition-colors border border-[var(--border-dark)] font-oswald uppercase tracking-wider"}," Отмена "),s("button",{onClick:c,class:"px-6 py-2.5 bg-[var(--accent-red)] hover:bg-red-700 text-white text-sm font-bold transition-colors border border-[var(--accent-red)] flex items-center gap-2 font-oswald uppercase tracking-wider"},[u(O(f),{class:"w-4 h-4"}),t[33]||(t[33]=m(" Сохранить ",-1))])])])])])])}}}),SUt=[{path:"/",name:"Home",component:Vo,meta:{title:"Главная",icon:"🏠",bare:!0}},{path:"/docs",name:"Documentation",component:uze,meta:{title:"База знаний",bare:!0}},{path:"/docs-legacy",name:"DocumentationLegacy",component:sUe,meta:{title:"Документация (старая)"}},{path:"/terminal",name:"Terminal",component:XBt,meta:{title:"Терминал",icon:"💻"}},{path:"/profile",name:"Profile",component:xe(_Ut,[["__scopeId","data-v-1013ed61"]]),meta:{title:"Профиль",icon:"👤",bare:!0}},{path:"/",component:Xe,children:[{path:"portfolio",component:lu,name:"Portfolio",meta:{title:"Портфель",icon:"💼"}},{path:"monte-carlo",component:Cd,name:"MonteCarlo",meta:{title:"Monte Carlo",icon:"🎲"}},{path:"greeks",component:Vh,name:"GreekParameters",meta:{title:"Греческие параметры",icon:"🎯",badge:"3"}},{path:"stress",component:_f,name:"StressTesting",meta:{title:"Стресс-тестирование",icon:"⚡"},alias:"stress-testing"},{path:"backtest",component:_m,name:"Backtesting",meta:{title:"Бэктестинг",icon:"📉"}},{path:"reports",component:Lv,name:"Reports",meta:{title:"Отчёты",icon:"📋"}},{path:"settings",component:ny,name:"Settings",meta:{title:"Настройки",icon:"⚙️"},alias:"parameters"},{path:"regimes",component:FR,name:"RegimeAnalysis",meta:{title:"Рыночные режимы",icon:"🌊"}},{path:"fixed-income",component:nN,name:"YieldAnalysis",meta:{title:"Доходность облигаций",icon:"📈"}},{path:"regime-details",component:fD,name:"RegimeDetails",meta:{title:"HMM Аналитика",icon:"🔬"}},{path:"spectral-regimes",component:TL,name:"SpectralRegimeAnalysis",meta:{title:"Комплексный анализ режимов",icon:"🌀"}},{path:"bond-valuation",component:TK,name:"BondValuation",meta:{title:"Справедливая стоимость облигаций",icon:"💰"}},{path:"zcyc-viewer",component:PZ,name:"ZCYCViewer",meta:{title:"Кривая бескупонных доходностей",icon:"📈"}},{path:"bond-report",component:gQ,name:"BondReport",meta:{title:"Отчет об оценке облигаций",icon:"📄"}},{path:"vanila-bond-report/:isin?",component:Q2,name:"VanilaBondReport",meta:{title:"Vanila Bond Report",icon:"📊"}},{path:"floater-bond-report/:isin?",component:x6,name:"FloaterBondReport",meta:{title:"Floater Bond Report",icon:"📋"}},{path:"pricing/options",component:q7,name:"OptionPricing",meta:{title:"Справедливая стоимость опционов",icon:"ƒ"}},{path:"pricing/options/models",component:cee,name:"OptionModelsComparison",meta:{title:"Сравнение моделей ценообразования",icon:"ƒ"}},{path:"pricing/options/greeks",component:cte,name:"OptionGreeksAnalyzer",meta:{title:"Анализ чувствительности (Greeks)",icon:"ƒ"}},{path:"pricing/options/portfolio",component:wae,name:"OptionPortfolio",meta:{title:"Портфель опционов",icon:"ƒ"}},{path:"stress/swaps",component:Nne,name:"stress-swaps",meta:{title:"Стресс-тестирование Свопов",icon:"ƒ"}},{path:"swap-greeks",component:aie,name:"SwapGreeksDashboard",meta:{title:"Греки СВОПов",icon:"⚡"}},{path:"valuation/swaps",component:sse,name:"SwapValuation",meta:{title:"Оценка справедливой стоимости СВОПов",icon:"💰"}},{path:"analytics/pnl",component:Cle,name:"PnLAttribution",meta:{title:"Факторная декомпозиция P&L",icon:"📊"}},{path:"hedging",component:Due,name:"HedgingAssistant",meta:{title:"Регрессионное хеджирование",icon:"🎯"}},{path:"valuation/forwards",component:ume,name:"ForwardValuation",meta:{title:"Forward Valuation",icon:"📊"}},{path:"forwards/curve",component:jve,name:"ForwardCurveBuilder",meta:{title:"Forward Curve Builder",icon:"📈"}},{path:"forwards/greeks",component:Fye,name:"ForwardsGreeksDashboard",meta:{title:"Greeks Dashboard",icon:"🎯"}},{path:"forwards/basis",component:owe,name:"BasisAnalysis",meta:{title:"Basis Analysis",icon:"📈"}},{path:"analytics/volatility",component:z_e,name:"VolatilitySurface",meta:{title:"Volatility Surface",icon:"📊"}},{path:"CCMVoptimization",name:"CCMVOptimization",component:$Ce,meta:{title:"CCMV Оптимизация"}},{path:"macro",name:"MacroDashboard",component:dEe,meta:{title:"Макроэкономика"}},{path:"crypto",name:"CryptoMarkets",component:KEe,meta:{title:"Крипто рынки"}},{path:"news",name:"NewsHub",component:UIe,meta:{title:"Новостной хаб"}},{path:"security",name:"SecurityCenter",component:GPe,meta:{title:"Центр безопасности"}}]},{path:"/:pathMatch(.*)*",name:"NotFound",component:A6,meta:{title:"404"}}],MUt=J({history:Q("/stochastic-dashbord-v1/"),routes:SUt});MUt.beforeEach((e,t,a)=>{const n=e.meta?.title||"QuantPro";document.title=`${n} | Risk Management`,a()});const TUt=_("theme",()=>{const e=t("dark"),a=e=>{const t=document.documentElement;t.style.colorScheme=e,"light"===e?(t.classList.add("light-theme"),t.classList.remove("dark-theme")):(t.classList.add("dark-theme"),t.classList.remove("light-theme"))};return{theme:e,initTheme:()=>{const t=localStorage.getItem("theme")||"dark";e.value=t,a(t)},toggleTheme:()=>{e.value="dark"===e.value?"light":"dark",localStorage.setItem("theme",e.value),console.log("🎨 Theme changed to:",e.value),a(e.value)}}}),kUt={class:"palette-header"},CUt=["onKeydown"],AUt={key:0,class:"no-results"},EUt={class:"group-title"},IUt=["onClick","onMouseenter"],RUt={class:"cmd-left"},DUt={class:"cmd-icon"},PUt={class:"cmd-label"},LUt={key:0,class:"cmd-desc"},NUt={key:0,class:"cmd-shortcut"},OUt=e({__name:"CommandPalette",setup(e,{expose:a}){const o=x(),d=t(!1),g=t(""),y=t(null),_=t(null),C=t(null),I=[{id:"nav-home",label:"Главная страница",group:"Навигация",icon:"🏠",action:()=>o.push("/")},{id:"nav-docs",label:"Документация",group:"Навигация",icon:"📚",desc:"Справочная информация",action:()=>o.push("/docs")},{id:"nav-port",label:"Портфель",group:"Портфель и аналитика",icon:"💼",desc:"Управление портфелем",action:()=>o.push("/portfolio")},{id:"nav-mc",label:"Monte Carlo",group:"Портфель и аналитика",icon:"🎲",desc:"Стохастическое моделирование",action:()=>o.push("/monte-carlo")},{id:"nav-greeks",label:"Греческие параметры",group:"Портфель и аналитика",icon:"∑",desc:"Риск-метрики (Greeks)",action:()=>o.push("/greeks")},{id:"nav-reports",label:"Отчёты портфеля",group:"Портфель и аналитика",icon:"📋",action:()=>o.push("/reports")},{id:"nav-pnl",label:"PnL Attribution",group:"Портфель и аналитика",icon:"📈",desc:"Декомпозиция прибылей/убытков",action:()=>o.push("/analytics/pnl")},{id:"nav-ccmv",label:"CCMV Оптимизация",group:"Портфель и аналитика",icon:"⚖️",desc:"Константная корреляция",action:()=>o.push("/CCMVoptimization")},{id:"nav-backtest",label:"Бэктестинг",group:"Управление рисками",icon:"📈",desc:"Проверка торговых стратегий",action:()=>o.push("/backtest")},{id:"nav-stress",label:"Стресс-тестирование",group:"Управление рисками",icon:"⚡",desc:"Анализ стресс-сценариев",action:()=>o.push("/stress")},{id:"nav-hedging",label:"Помощник по хеджированию",group:"Управление рисками",icon:"🛡️",desc:"Стратегии хеджирования",action:()=>o.push("/hedging")},{id:"nav-regimes",label:"Рыночные режимы",group:"Анализ режимов",icon:"🌊",desc:"HMM анализ режимов рынка",action:()=>o.push("/regimes")},{id:"nav-regime-detail",label:"Детали режима",group:"Анализ режимов",icon:"🔬",desc:"Детальный HMM анализ",action:()=>o.push("/regime-details")},{id:"nav-spectral-regimes",label:"Комплексный анализ режимов",group:"Анализ режимов",icon:"🌀",desc:"Спектральная декомпозиция скрытых режимов",action:()=>o.push("/spectral-regimes")},{id:"nav-yield",label:"Доходность облигаций",group:"Облигации",icon:"📈",desc:"Анализ доходности",action:()=>o.push("/fixed-income")},{id:"nav-bond-val",label:"Оценка облигаций (DCF)",group:"Облигации",icon:"💵",desc:"Справедливая стоимость",action:()=>o.push("/bond-valuation")},{id:"nav-zcyc",label:"Кривая КБД",group:"Облигации",icon:"📉",desc:"Zero-Coupon Yield Curve",action:()=>o.push("/zcyc-viewer")},{id:"nav-bond-report",label:"Отчёт об оценке",group:"Облигации",icon:"📄",desc:"Генератор отчётов",action:()=>o.push("/bond-report")},{id:"nav-vanila-bond",label:"Отчёт Vanila Bond",group:"Облигации",icon:"📊",desc:"Обыкновенные облигации",action:()=>o.push("/vanila-bond-report")},{id:"nav-floater-bond",label:"Отчёт Floater Bond",group:"Облигации",icon:"📋",desc:"Облигации с плавающей ставкой",action:()=>o.push("/floater-bond-report")},{id:"nav-opt",label:"Оценка опционов",group:"Производные инструменты",icon:"ƒ",desc:"Ценообразование опционов",action:()=>o.push("/pricing/options")},{id:"nav-opt-models",label:"Сравнение моделей опционов",group:"Производные инструменты",icon:"📊",desc:"Black-Scholes vs другие",action:()=>o.push("/pricing/options/models")},{id:"nav-opt-greeks",label:"Greeks опционов",group:"Производные инструменты",icon:"🎯",desc:"Анализ греческих параметров",action:()=>o.push("/pricing/options/greeks")},{id:"nav-opt-portfolio",label:"Портфель опционов",group:"Производные инструменты",icon:"💼",desc:"Управление позициями",action:()=>o.push("/pricing/options/portfolio")},{id:"nav-vol-surf",label:"Поверхность волатильности",group:"Производные инструменты",icon:"〰️",desc:"SABR/SVI моделирование",action:()=>o.push("/analytics/volatility")},{id:"nav-swaps",label:"Оценка свопов",group:"Свопы",icon:"🔄",desc:"IRS & Currency Swaps",action:()=>o.push("/valuation/swaps")},{id:"nav-swap-greeks",label:"Greeks свопов",group:"Свопы",icon:"🎯",desc:"Риск-метрики свопов",action:()=>o.push("/swap-greeks")},{id:"nav-swap-stress",label:"Стресс-тест свопов",group:"Свопы",icon:"⚡",desc:"Анализ стресс-сценариев",action:()=>o.push("/stress/swaps")},{id:"nav-forwards",label:"Оценка форвардов",group:"Форварды",icon:"➡️",desc:"Ценообразование форвардов",action:()=>o.push("/valuation/forwards")},{id:"nav-forward-curve",label:"Построение кривой форвардов",group:"Форварды",icon:"📈",desc:"Forward Curve Builder",action:()=>o.push("/forwards/curve")},{id:"nav-forward-greeks",label:"Greeks форвардов",group:"Форварды",icon:"🎯",desc:"Риск-метрики",action:()=>o.push("/forwards/greeks")},{id:"nav-forward-basis",label:"Анализ базиса",group:"Форварды",icon:"📈",desc:"Basis Analysis",action:()=>o.push("/forwards/basis")},{id:"nav-forward-margin",label:"Маржа и финансирование",group:"Форварды",icon:"💰",desc:"Margin & Financing",action:()=>o.push("/forwards/margin")},{id:"nav-forward-arbitrage",label:"Сканер арбитража",group:"Форварды",icon:"🔍",desc:"Поиск арбитражных возможностей",action:()=>o.push("/forwards/arbitrage")},{id:"act-reload",label:"Перезагрузить данные",group:"Действия",icon:"🔄",shortcut:"⌘R",desc:"Обновить страницу",action:()=>window.location.reload()},{id:"act-export-pdf",label:"Экспорт в PDF",group:"Действия",icon:"📥",desc:"Сохранить как PDF",action:()=>window.print()},{id:"act-copy",label:"Копировать ссылку",group:"Действия",icon:"📋",desc:"Скопировать URL в буфер",action:()=>{navigator.clipboard.writeText(window.location.href)}},{id:"act-clear-cache",label:"Очистить кэш",group:"Действия",icon:"🗑️",desc:"Очистить локальное хранилище",action:()=>{confirm("Очистить весь кэш? Это удалит сохранённые настройки.")&&(localStorage.clear(),window.location.reload())}},{id:"sys-theme",label:"Переключить тему",group:"Система",icon:"🌙",shortcut:"⌘T",desc:"Тёмная/Светлая тема",action:()=>{const e=document.documentElement;e.classList.toggle("dark"),localStorage.setItem("theme",e.classList.contains("dark")?"dark":"light")}},{id:"sys-fullscreen",label:"Полноэкранный режим",group:"Система",icon:"⛶",desc:"Включить/выключить",action:()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(e=>console.log(e))}},{id:"sys-settings",label:"Настройки",group:"Система",icon:"⚙️",desc:"Параметры приложения",action:()=>o.push("/settings")},{id:"sys-help",label:"Помощь и горячие клавиши",group:"Система",icon:"❓",desc:"Справка по использованию",action:()=>{alert("Горячие клавиши:\n\n⌘K / Ctrl+K - Открыть палитру команд\n⌘R / Ctrl+R - Перезагрузить\n⌘T / Ctrl+T - Переключить тему\nESC - Закрыть палитру\n↑↓ - Навигация\nEnter - Выполнить команду")}}],D=S(()=>{if(!g.value.trim())return I;const e=g.value.toLowerCase().trim();return I.filter(t=>t.label.toLowerCase().includes(e)||t.group.toLowerCase().includes(e)||t.desc?.toLowerCase().includes(e)||t.id.toLowerCase().includes(e))}),P=S(()=>{const e={};D.value.forEach(t=>{e[t.group]||(e[t.group]=[]),e[t.group].push(t)});const t={};return["Навигация","Портфель и аналитика","Управление рисками","Анализ режимов","Облигации","Производные инструменты","Свопы","Форварды","Действия","Система"].forEach(a=>{e[a]&&(t[a]=e[a])}),Object.keys(e).forEach(a=>{t[a]||(t[a]=e[a])}),t}),L=S(()=>Object.values(P.value).flat());R(D,e=>{e.length>0?C.value=e[0].id:C.value=null}),R(g,()=>{L.value.length>0&&(C.value=L.value[0].id)});const N=()=>{d.value=!0,g.value="",C.value=L.value[0]?.id||null,A(()=>{y.value?.focus(),_.value&&(_.value.scrollTop=0)})},O=()=>{d.value=!1,g.value=""},F=e=>{try{e.action(),O()}catch(QXe){console.error("Ошибка выполнения команды:",QXe)}},B=()=>{const e=L.value.find(e=>e.id===C.value);e&&F(e)},z=e=>{const t=L.value;if(0===t.length)return;const a=t.findIndex(e=>e.id===C.value);-1!==a?(C.value="down"===e?t[a+1]?.id||t[0].id:t[a-1]?.id||t[t.length-1].id,A(()=>{const e=document.querySelector(".command-item.selected");if(e&&_.value){const t=_.value,a=e.getBoundingClientRect(),n=t.getBoundingClientRect(),r=a.top-n.top+t.scrollTop,i=r+a.height,o=t.scrollTop+t.clientHeight;r<t.scrollTop?t.scrollTop=r-8:i>o&&(t.scrollTop=i-t.clientHeight+8)}})):C.value=t[0].id},V=e=>{if((e.metaKey||e.ctrlKey)&&"k"===e.key)return e.preventDefault(),void(d.value?O():N());if(!d.value&&(!e.metaKey&&!e.ctrlKey||"r"!==e.key||e.shiftKey||(e.preventDefault(),window.location.reload()),(e.metaKey||e.ctrlKey)&&"t"===e.key)){e.preventDefault();const t=document.documentElement;t.classList.toggle("dark"),localStorage.setItem("theme",t.classList.contains("dark")?"dark":"light")}};return n(()=>{window.addEventListener("keydown",V)}),r(()=>{window.removeEventListener("keydown",V)}),a({open:N,close:O}),(e,t)=>(w(),b(H,{to:"body"},[u(M,{name:"fade"},{default:h(()=>[d.value?(w(),i("div",{key:0,class:"palette-backdrop",onClick:O},[s("div",{class:"palette-modal",onClick:t[3]||(t[3]=E(()=>{},["stop"]))},[s("div",kUt,[t[4]||(t[4]=s("span",{class:"search-icon"},[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("circle",{cx:"11",cy:"11",r:"8"}),s("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})])],-1)),T(s("input",{ref_key:"searchInput",ref:y,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),type:"text",placeholder:"Введите команду или поиск...",class:"palette-input",onKeydown:[t[1]||(t[1]=U(E(e=>z("down"),["prevent"]),["down"])),t[2]||(t[2]=U(E(e=>z("up"),["prevent"]),["up"])),U(E(B,["prevent"]),["enter"]),U(O,["esc"])]},null,40,CUt),[[k,g.value]]),t[5]||(t[5]=s("span",{class:"esc-badge"},"ESC",-1))]),s("div",{ref_key:"paletteBody",ref:_,class:"palette-body custom-scroll"},[0===D.value.length?(w(),i("div",AUt," Команды не найдены. ")):(w(!0),i(p,{key:1},f(P.value,(e,t)=>(w(),i("div",{key:t,class:"command-group"},[s("div",EUt,v(t),1),(w(!0),i(p,null,f(e,e=>(w(),i("button",{key:e.id,class:c(["command-item",{selected:C.value===e.id}]),onClick:t=>F(e),onMouseenter:t=>C.value=e.id},[s("div",RUt,[s("span",DUt,v(e.icon),1),s("span",PUt,[m(v(e.label)+" ",1),e.desc?(w(),i("span",LUt,"— "+v(e.desc),1)):l("",!0)])]),e.shortcut?(w(),i("div",NUt,v(e.shortcut),1)):l("",!0)],42,IUt))),128))]))),128))],512),t[6]||(t[6]=s("div",{class:"palette-footer"},[s("div",{class:"footer-item"},[s("span",null,"↵"),m(" выбрать")]),s("div",{class:"footer-item"},[s("span",null,"↑↓"),m(" навигация")]),s("div",{class:"footer-item"},[s("span",null,"⌘K"),m(" открыть/закрыть")])],-1))])])):l("",!0)]),_:1})]))}}),FUt=xe(OUt,[["__scopeId","data-v-c5be9b1b"]]),BUt=e({__name:"App",setup(e){const t=g(),a=TUt(),r=S(()=>"/terminal"===t.path);return n(()=>{a.initTheme()}),(e,t)=>{const a=d("router-view");return w(),i(p,null,[r.value?l("",!0):(w(),b(FUt,{key:0})),u(a)],64)}}}),UUt=_("theme",()=>{const e=t("dark"),a={"--color-bg-primary":"#050505","--color-bg-secondary":"#0a0a0a","--color-bg-tertiary":"#141414","--color-bg-glass":"rgba(20, 20, 20, 0.65)","--color-bg-glass-light":"rgba(255, 255, 255, 0.05)","--color-accent-primary":"#ffffff","--color-accent-secondary":"#737373","--color-accent-success":"#22c55e","--color-accent-warning":"#f59e0b","--color-accent-danger":"#ef4444","--color-text-primary":"#fafafa","--color-text-secondary":"#a3a3a3","--color-text-tertiary":"#525252","--color-border":"rgba(255, 255, 255, 0.08)","--color-border-hover":"rgba(255, 255, 255, 0.15)","--shadow-sm":"0 0 0 1px rgba(255,255,255,0.05)","--shadow-md":"0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255,255,255,0.05)","--shadow-lg":"0 20px 25px -5px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255,255,255,0.05)"},n=()=>{e.value="dark",(()=>{const e=document.documentElement;Object.entries(a).forEach(([t,a])=>{e.style.setProperty(t,a)}),e.classList.add("dark"),e.style.colorScheme="dark"})()};return{theme:e,initTheme:n,toggleTheme:()=>{n()}}}),zUt=ee(BUt),VUt=te();zUt.use(VUt),zUt.use(MUt);if(UUt().initTheme(),"scrollBehavior"in document.documentElement.style)document.documentElement.style.scrollBehavior="smooth";else{const e=()=>{document.querySelectorAll("[data-smooth-scroll]").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.getAttribute("href");if(t&&t.startsWith("#")){e.preventDefault();const a=document.querySelector(t);a&&a.scrollIntoView({behavior:"smooth",block:"start"})}})})};e()}zUt.mount("#app");
