import{d as a,r as e,v as s,G as l,c as t,e as i,g as r,x as c,y as n,t as o,F as p,i as d,n as v,w as u,T as m,q as y,f as b,k as g,j as h}from"./vendor-DLyKmMu8.js";import{u as k}from"./swapRegistry-D1SC4d6r.js";import{_ as Y}from"./index-Ba4DjugF.js";const S={class:"stress-swap-page"},R={class:"page-header"},I={class:"header-right"},C={class:"control-group"},D={class:"multiplier-control"},w={class:"multiplier-display"},x=["disabled"],T={key:0},f={key:1},V={class:"filters-bar"},F=["onClick"],K={class:"filter-icon"},A={class:"filter-text"},B={class:"scenarios-container"},M={class:"scenarios-grid"},O=["onClick"],P={class:"tile-header"},_={class:"tile-title"},j={class:"severity-indicator"},L={class:"tile-description"},U={class:"tile-metrics"},H={class:"metric-probability"},$={key:0,class:"details-container"},G={class:"details-left"},q={class:"card"},E={class:"card-header"},N={class:"metrics-grid"},W={class:"metric-box"},z={class:"metric-box"},J={class:"metric-num accent"},Q={class:"metric-box"},X={class:"metric-num blue"},Z={class:"metric-box"},aa={class:"metric-num"},ea={class:"card"},sa={class:"greeks-grid"},la={class:"greek-item"},ta={class:"greek-val accent"},ia={class:"greek-item"},ra={class:"greek-val blue"},ca={class:"greek-item"},na={class:"greek-val green"},oa={class:"greek-item"},pa={class:"greek-val purple"},da={class:"card"},va={class:"krd-bars"},ua={class:"krd-label"},ma={class:"krd-track"},ya={class:"details-right"},ba={class:"card"},ga={class:"shocks-list"},ha={class:"shock-label"},ka={class:"card"},Ya={class:"positions-list"},Sa={class:"pos-name"},Ra={class:"card info-card"},Ia={class:"info-item"},Ca={class:"table-container"},Da={class:"data-table"},wa=["onClick"],xa={class:"col-name"},Ta={class:"col-type"},fa={class:"col-value accent"},Va={class:"col-value blue"},Fa={class:"col-value accent"},Ka=Y(a({__name:"StressTestingSwap",setup(a){const Y=k(),Ka=e(!1),Aa=e(1),Ba=e("curve"),Ma=e([{id:"curve",name:"Сдвиг кривой",icon:""},{id:"spread",name:"Спред",icon:""},{id:"vol",name:"Волатильность",icon:""},{id:"twist",name:"Кривизна",icon:""}]),Oa=e([{id:1,name:"Параллельный сдвиг +200 bp",description:"Все ставки растут на 200 базисных пункта",shockType:"Curve",pnlImpact:-285e3,dv01Change:-28.5,spreadDv01:0,delta:5.2,gamma:.018,vega:-12.5,theta:1.2,duration:"1–2 дня",probability:.08,severity:"high",marketShocks:{"Key Rate (2Y)":"+200 bp","Key Rate (5Y)":"+200 bp","Key Rate (10Y)":"+200 bp",Volatility:"-5%"},keyRateDurations:{"2Y":-3.5,"5Y":-8.2,"10Y":-5.1,"30Y":-2.8},positionImpact:{"IRS Payer 5Y":-145e3,"IRS Receiver 2Y":25e3,"Bond Hold":-165e3}},{id:2,name:"Параллельный сдвиг −200 bp",description:"Все ставки падают на 200 базисных пункта",shockType:"Curve",pnlImpact:285e3,dv01Change:28.5,spreadDv01:0,delta:-5.2,gamma:.018,vega:12.5,theta:-1.2,duration:"1–2 дня",probability:.08,severity:"high",marketShocks:{"Key Rate (2Y)":"-200 bp","Key Rate (5Y)":"-200 bp","Key Rate (10Y)":"-200 bp",Volatility:"+5%"},keyRateDurations:{"2Y":3.5,"5Y":8.2,"10Y":5.1,"30Y":2.8},positionImpact:{"IRS Payer 5Y":145e3,"IRS Receiver 2Y":-25e3,"Bond Hold":165e3}},{id:3,name:"Крутизна кривой (Twist)",description:"Короткие ставки +150 bp, длинные −50 bp",shockType:"Curve",pnlImpact:-45200,dv01Change:-8.5,spreadDv01:.5,delta:2.1,gamma:.025,vega:-8.3,theta:.6,duration:"2–5 дней",probability:.18,severity:"medium",marketShocks:{"Key Rate (2Y)":"+150 bp","Key Rate (5Y)":"+50 bp","Key Rate (10Y)":"-50 bp",Slope:"−200 bp"},keyRateDurations:{"2Y":-2.8,"5Y":1.2,"10Y":3.5,"30Y":1.1},positionImpact:{"IRS Payer 5Y":-32e3,"IRS Receiver 10Y":18e3,"Curve Trade":-31200}},{id:4,name:"Бабочка (Butterfly)",description:"Середина кривой сдвигается относительно краёв",shockType:"Curve",pnlImpact:18500,dv01Change:3.2,spreadDv01:-.8,delta:1.5,gamma:.035,vega:-3.1,theta:.4,duration:"3–10 дней",probability:.25,severity:"low",marketShocks:{"Key Rate (2Y)":"+50 bp","Key Rate (5Y)":"-100 bp","Key Rate (10Y)":"+50 bp"},keyRateDurations:{"2Y":1.2,"5Y":-3.5,"10Y":1.8,"30Y":-.5},positionImpact:{"IRS Payer 5Y":28500,"Butterfly Trade":12e3,"Long Bond":-22e3}},{id:5,name:"Кредитный спред +100 bp",description:"Широкое расширение spreads (OAS +100 bp)",shockType:"Spread",pnlImpact:-125400,dv01Change:0,spreadDv01:5.2,delta:.8,gamma:.008,vega:-15.2,theta:.2,duration:"1–5 дней",probability:.12,severity:"high",marketShocks:{OAS:"+100 bp","Credit Curve":"−25 bp","Term Spread":"+75 bp",Vol:"+8%"},keyRateDurations:{"2Y":-.5,"5Y":-2.1,"10Y":-1.8,"30Y":-.9},positionImpact:{"Corporate Bonds":-85e3,"Credit Default Swaps":-40400,IRS:0}},{id:6,name:"Кредитный спред −50 bp",description:"Сжатие spreads (OAS −50 bp)",shockType:"Spread",pnlImpact:62700,dv01Change:0,spreadDv01:-2.6,delta:-.4,gamma:.008,vega:7.6,theta:-.1,duration:"2–10 дней",probability:.2,severity:"medium",marketShocks:{OAS:"−50 bp","Credit Curve":"+15 bp","Term Spread":"−35 bp",Vol:"−4%"},keyRateDurations:{"2Y":.3,"5Y":1.1,"10Y":.9,"30Y":.5},positionImpact:{"Corporate Bonds":45e3,CDS:18e3,IRS:-300}},{id:7,name:"Скачок vol ставок (Swaption)",description:"Волатильность swap rates +300 bp (ATM vol +5%)",shockType:"Vol",pnlImpact:-95300,dv01Change:2.5,spreadDv01:0,delta:1.2,gamma:.012,vega:18.5,theta:-.8,duration:"1–3 дня",probability:.06,severity:"high",marketShocks:{"Volatility (ATM)":"+5%","Implied Vol":"+500 bp",Skew:"+50 bp","Term Vol":"+3%"},keyRateDurations:{"2Y":.8,"5Y":2.3,"10Y":1.5,"30Y":.6},positionImpact:{"Swaptions (Long)":85e3,IRS:-15e3,"Vol Hedges":-165300}},{id:8,name:"Падение vol ставок",description:"Волатильность swap rates −200 bp",shockType:"Vol",pnlImpact:63500,dv01Change:-1.8,spreadDv01:0,delta:-.8,gamma:-.012,vega:-12.3,theta:.5,duration:"5–15 дней",probability:.15,severity:"medium",marketShocks:{"Volatility (ATM)":"−3.5%","Implied Vol":"−350 bp",Skew:"−30 bp","Term Vol":"−2%"},keyRateDurations:{"2Y":-.6,"5Y":-1.8,"10Y":-1.1,"30Y":-.5},positionImpact:{"Swaptions (Short)":78500,"Vol Trades":-15e3}},{id:9,name:"Шоковый сценарий",description:"Комбинация: ставки +150 bp, спред +75 bp, vol +4%",shockType:"Curve",pnlImpact:-425600,dv01Change:-32.1,spreadDv01:3.8,delta:7.5,gamma:.042,vega:-28.4,theta:.8,duration:"1–2 дня",probability:.02,severity:"critical",marketShocks:{Curve:"+150 bp",OAS:"+75 bp",Volatility:"+4%",Correlation:"+0.35"},keyRateDurations:{"2Y":-5.2,"5Y":-12.5,"10Y":-9.3,"30Y":-5.1},positionImpact:{"IRS Payer 5Y":-245e3,"Corp Bonds":-125e3,Swaptions:-55600}}]),Pa=e(Oa.value[0]),_a=s(()=>{if(0===Y.totalSwaps)return Oa.value;const a=Y.totalDv01,e=Y.totalSpreadDv01;return Y.totalSwapValue,Oa.value.map(s=>{const l=0!==a?a/125e3:1,t=s.pnlImpact*l,i=s.dv01Change*l,r={};return Y.registrySwaps.forEach((a,e)=>{const l=Y.getResultByIndex(e);if(l){const e=`${a.swapType.toUpperCase()} ${a.tenor}Y`;r[e]=l.dv01*s.dv01Change/10}}),{...s,pnlImpact:t,dv01Change:i,spreadDv01:e*(s.spreadDv01/85e3),positionImpact:Object.keys(r).length>0?r:s.positionImpact}})}),ja=s(()=>{const a={curve:"Curve",spread:"Spread",vol:"Vol",twist:"Curve"};return _a.value.filter(e=>e.shockType===a[Ba.value])});l(()=>Y.totalSwaps,()=>{_a.value.length>0&&(Pa.value=_a.value[0])});const La=a=>{Pa.value=a},Ua=a=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),Ha=a=>Math.abs(a)>=1e6?(a/1e6).toFixed(1)+"М":"$"+(a/1e3).toFixed(0)+"K",$a=a=>({"Volatility (ATM)":"Vol (ATM)","Key Rate (2Y)":"Rate 2Y","Key Rate (5Y)":"Rate 5Y","Key Rate (10Y)":"Rate 10Y",OAS:"OAS Spread"}[a]||a),Ga=async()=>{if(!Ka.value){Ka.value=!0;try{for(let a=0;a<=100;a+=20)await new Promise(a=>setTimeout(a,250))}catch(a){console.error(a)}finally{Ka.value=!1}}};return(a,e)=>(y(),t("div",S,[i("div",R,[e[2]||(e[2]=i("div",{class:"header-left"},[i("h1",{class:"page-title"},"Стресс-тест СВОП портфеля"),i("p",{class:"page-subtitle"},"Анализ чувствительности к сдвигам кривой, спредам и волатильности")],-1)),i("div",I,[i("div",C,[e[1]||(e[1]=i("label",{class:"control-label"},"Множитель:",-1)),i("div",D,[c(i("input",{type:"range","onUpdate:modelValue":e[0]||(e[0]=a=>Aa.value=a),step:.1,min:.5,max:3,class:"range-input"},null,512),[[n,Aa.value,void 0,{number:!0}]]),i("span",w,o(Aa.value.toFixed(1))+"x",1)])]),i("button",{onClick:Ga,class:"btn-primary",disabled:Ka.value},[Ka.value?(y(),t("span",f,"Считаю...")):(y(),t("span",T,"Запустить"))],8,x)])]),i("div",V,[(y(!0),t(p,null,d(Ma.value,a=>(y(),t("button",{key:a.id,onClick:e=>Ba.value=a.id,class:v(["filter-btn",{active:Ba.value===a.id}])},[i("span",K,o(a.icon),1),i("span",A,o(a.name),1)],10,F))),128))]),i("div",B,[e[3]||(e[3]=i("div",{class:"grid-header"},"Сценарии стресс-тестирования",-1)),i("div",M,[(y(!0),t(p,null,d(ja.value,a=>{return y(),t("div",{key:a.id,onClick:e=>La(a),class:v(["scenario-tile",{active:Pa.value?.id===a.id}])},[i("div",P,[i("h3",_,o(a.name),1),i("span",j,o((e=a.severity,{critical:"",high:"",medium:"",low:""}[e]||"")),1)]),i("p",L,o(a.description),1),i("div",U,[i("span",{class:v(["metric-value",a.pnlImpact<0?"loss":"gain"])},o(Ha(a.pnlImpact*Aa.value)),3),i("span",H,"Вер.: "+o((100*a.probability).toFixed(0))+"%",1)])],10,O);var e}),128))])]),r(m,{name:"expand"},{default:u(()=>[Pa.value?(y(),t("div",$,[i("div",G,[i("div",q,[i("div",E,[i("h3",null,o(Pa.value.name),1)]),i("div",N,[i("div",W,[e[4]||(e[4]=i("span",{class:"metric-label"},"Влияние на P&L",-1)),i("span",{class:v(["metric-num",Pa.value.pnlImpact<0?"loss":"gain"])},o(Ua(Pa.value.pnlImpact*Aa.value)),3)]),i("div",z,[e[5]||(e[5]=i("span",{class:"metric-label"},"DV01 Δ",-1)),i("span",J,o((Pa.value.dv01Change*Aa.value).toFixed(1))+"М ",1)]),i("div",Q,[e[6]||(e[6]=i("span",{class:"metric-label"},"Spread DV01",-1)),i("span",X,o((Pa.value.spreadDv01*Aa.value).toFixed(2))+"М ",1)]),i("div",Z,[e[7]||(e[7]=i("span",{class:"metric-label"},"Длительность",-1)),i("span",aa,o(Pa.value.duration),1)])])]),i("div",ea,[e[20]||(e[20]=i("div",{class:"card-header"},[i("h3",null,"Греки")],-1)),i("div",sa,[i("div",la,[e[8]||(e[8]=i("span",{class:"greek-symbol"},"Δ",-1)),e[9]||(e[9]=i("span",{class:"greek-name"},"Delta",-1)),i("span",ta,o(Pa.value.delta.toFixed(3)),1),e[10]||(e[10]=i("span",{class:"greek-unit"},"М/100bp",-1))]),i("div",ia,[e[11]||(e[11]=i("span",{class:"greek-symbol"},"Γ",-1)),e[12]||(e[12]=i("span",{class:"greek-name"},"Gamma",-1)),i("span",ra,o(Pa.value.gamma.toFixed(4)),1),e[13]||(e[13]=i("span",{class:"greek-unit"},"bp²",-1))]),i("div",ca,[e[14]||(e[14]=i("span",{class:"greek-symbol"},"V",-1)),e[15]||(e[15]=i("span",{class:"greek-name"},"Vega",-1)),i("span",na,o(Pa.value.vega.toFixed(2)),1),e[16]||(e[16]=i("span",{class:"greek-unit"},"М/% vol",-1))]),i("div",oa,[e[17]||(e[17]=i("span",{class:"greek-symbol"},"Θ",-1)),e[18]||(e[18]=i("span",{class:"greek-name"},"Theta",-1)),i("span",pa,o(Pa.value.theta.toFixed(2)),1),e[19]||(e[19]=i("span",{class:"greek-unit"},"М/день",-1))])])]),i("div",da,[e[21]||(e[21]=i("div",{class:"card-header"},[i("h3",null,"Срочный риск (Key Rate Durations)")],-1)),i("div",va,[(y(!0),t(p,null,d(Pa.value.keyRateDurations,(a,e)=>(y(),t("div",{key:e,class:"krd-row"},[i("span",ua,o(e),1),i("div",ma,[i("div",{class:v(["krd-bar",a<0?"negative":"positive"]),style:g({width:Math.min(100,Math.abs(a*Aa.value*8))+"%"})},null,6)]),i("span",{class:v(["krd-value",a<0?"loss":"gain"])},o(a>0?"+":"")+o((a*Aa.value).toFixed(2)),3)]))),128))])])]),i("div",ya,[i("div",ba,[e[22]||(e[22]=i("div",{class:"card-header"},[i("h3",null,"Параметры шока")],-1)),i("div",ga,[(y(!0),t(p,null,d(Pa.value.marketShocks,(a,e)=>(y(),t("div",{key:e,class:"shock-row"},[i("span",ha,o($a(e)),1),i("span",{class:v(["shock-val",a.includes("-")?"loss":"gain"])},o(a),3)]))),128))])]),i("div",ka,[e[23]||(e[23]=i("div",{class:"card-header"},[i("h3",null,"Позиции под риском")],-1)),i("div",Ya,[(y(!0),t(p,null,d(Pa.value.positionImpact,(a,e)=>(y(),t("div",{key:e,class:"position-row"},[i("span",Sa,o(e),1),i("span",{class:v(["pos-val",a<0?"loss":"gain"])},o(a>0?"+":"")+o(Ha(a*Aa.value)),3)]))),128))])]),i("div",Ra,[i("div",Ia,[e[24]||(e[24]=i("strong",null,"Множитель:",-1)),h(" "+o(Aa.value.toFixed(1))+"x ",1)]),e[25]||(e[25]=i("div",{class:"info-item"},[i("strong",null,"Расчёт:"),h(" В реальном времени ")],-1)),e[26]||(e[26]=i("div",{class:"info-item"},[i("strong",null,"Модель:"),h(" Vasicek ")],-1))])])])):b("",!0)]),_:1}),i("div",Ca,[e[28]||(e[28]=i("div",{class:"table-header"},"Матрица стресс-тестов",-1)),i("table",Da,[e[27]||(e[27]=i("thead",null,[i("tr",null,[i("th",{class:"col-name"},"Сценарий"),i("th",{class:"col-type"},"Тип"),i("th",{class:"col-value"},"P&L"),i("th",{class:"col-value"},"ΔDV01"),i("th",{class:"col-value"},"Spread DV01"),i("th",{class:"col-value"},"Вероят.")])],-1)),i("tbody",null,[(y(!0),t(p,null,d(_a.value,a=>(y(),t("tr",{key:a.id,class:v(["table-row",{active:Pa.value?.id===a.id}]),onClick:e=>La(a)},[i("td",xa,o(a.name),1),i("td",Ta,o(a.shockType),1),i("td",{class:v(["col-value",a.pnlImpact<0?"loss":"gain"])},o(Ua(a.pnlImpact*Aa.value)),3),i("td",fa,o((a.dv01Change*Aa.value).toFixed(1)),1),i("td",Va,o((a.spreadDv01*Aa.value).toFixed(2)),1),i("td",Fa,o((100*a.probability).toFixed(0))+"%",1)],10,wa))),128))])])]),e[29]||(e[29]=i("div",{class:"page-footer"},[i("span",null,"• Историческое моделирование Vasicek"),i("span",null,"• Пересмотр каждые 2 недели"),i("span",null,"• Коррелированные шоки между параметрами")],-1))]))}}),[["__scopeId","data-v-3d4dcc79"]]);export{Ka as default};
