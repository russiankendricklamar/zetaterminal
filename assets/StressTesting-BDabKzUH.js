import{d as e,v as a,r as l,c as t,e as s,g as i,t as n,x as r,y as o,j as u,F as c,i as p,n as v,B as d,f as m,w as h,T as y,q as b,k,L as g}from"./vendor-DLyKmMu8.js";import{g as _}from"./apiHeaders-DCeXWvJ_.js";import{usePortfolioStore as f}from"./portfolio-t34lcnLk.js";import{_ as x}from"./index-AoYxWDki.js";const C={class:"page-container custom-scroll"},w={class:"section-header"},I={class:"header-right"},V={class:"glass-pill control-pill"},j={class:"text-white font-bold"},U={class:"glass-pill control-pill"},M={class:"scrub-wrapper"},O={class:"scrub-val text-accent"},F=["disabled"],S={key:0,class:"flex items-center gap-2"},B={key:1,class:"flex items-center gap-2"},L={class:"scenarios-grid"},H=["onClick"],R={class:"sc-header"},$={class:"sc-name"},T={class:"sc-header-actions"},A=["onClick"],P=["onClick"],q={class:"sc-desc"},z={class:"sc-footer"},N={class:"sc-prob"},X={key:0,class:"dashboard-grid"},D={class:"col-left"},E={class:"glass-card panel"},J={class:"panel-header"},K={class:"text-white"},Y={class:"impact-metrics-grid"},G={class:"metric-box"},Q={class:"val text-red"},W={class:"metric-box"},Z={class:"metric-box"},ee={class:"val text-white"},ae={class:"metric-box"},le={class:"val text-orange"},te={class:"impact-bars-list"},se={class:"bar-label"},ie={class:"bar-track"},ne={class:"stats-grid-row"},re={class:"stat-box"},oe={class:"val-sm text-red"},ue={class:"stat-box"},ce={class:"val-sm text-red"},pe={class:"stat-box"},ve={class:"val-sm text-orange"},de={class:"col-right"},me={class:"glass-card panel sticky-panel"},he={class:"market-changes-list"},ye={class:"m-key"},be={class:"info-block"},ke={class:"text-xs text-muted"},ge={class:"text-white"},_e={class:"glass-card panel"},fe={class:"table-wrapper"},xe={class:"glass-table"},Ce=["onClick"],we={class:"col-left pl-4"},Ie={class:"sc-name-sm"},Ve={class:"text-muted"},je={class:"text-orange"},Ue={class:"modal-header"},Me={class:"modal-body"},Oe={class:"form-section"},Fe={class:"form-grid"},Se={class:"form-group"},Be={class:"form-group"},Le={class:"form-group"},He={class:"form-group"},Re={class:"form-group"},$e={class:"form-section"},Te={class:"form-group"},Ae={key:0,class:"form-grid"},Pe={class:"form-group"},qe={key:1,class:"form-grid"},ze={class:"form-group"},Ne={key:2,class:"form-grid"},Xe={class:"form-group"},De={class:"form-section"},Ee={class:"market-changes-editor"},Je=["onUpdate:modelValue","onInput"],Ke=["onUpdate:modelValue","onInput"],Ye=["onClick"],Ge={class:"form-section"},Qe={class:"asset-impact-editor"},We=["onUpdate:modelValue","onInput"],Ze=["onUpdate:modelValue","onInput"],ea=["onClick"],aa=x(e({__name:"StressTesting",setup(e){const x=f(),aa=a(()=>x.selectedBank),la=l(!1),ta=l(1),sa=l(null),ia=(e,a="success")=>{console.log(`[${a.toUpperCase()}] ${e}`)},na=l([{id:1,name:"«Чёрный лебедь»",description:"Глобальный рыночный крах (как COVID-19)",pnlImpact:-185e3,varChange:-45.5,duration:"1–3 дня",probability:.01,severity:"critical",marketChanges:{"Волатильность":"+25%","Bonds Yield":"+150 bps",Correlation:"+0.50",Spreads:"+100 bps"},assetImpact:{"Акции":-35,"Облигации":-12,"Товары":-25,"Валюта":-8},key:"black_swan",type:"return_shock",return_multiplier:.5,custom:!1},{id:2,name:"Скачок волатильности",description:"Резкий рост индекса VIX > 40",pnlImpact:-67500,varChange:-18.2,duration:"1–5 дней",probability:.05,severity:"high",marketChanges:{VIX:"+20 pts",Range:"+15%",Liquidity:"-10%"},assetImpact:{"Акции":-18,"Облигации":-5,"Опционы":-40,"Валюта":-3},key:"volatility_spike",type:"volatility_shock",volatility_multiplier:1.5,custom:!1},{id:3,name:"Рост ставок ЦБ",description:"Неожиданное повышение ставки на 100 б.п.",pnlImpact:-45200,varChange:-12.5,duration:"1–10 дней",probability:.15,severity:"high",marketChanges:{"Key Rate":"+100 bps",Spreads:"+50 bps","FX Rate":"-5%"},assetImpact:{"Акции":-12,"Облигации":-22,"Недвижимость":-15,"Валюта":-6},key:"rate_hike",type:"return_shock",return_multiplier:.7,custom:!1},{id:4,name:"Техническая коррекция",description:"Умеренное снижение S&P 500 на 10%",pnlImpact:-12400,varChange:-5.2,duration:"5–20 дней",probability:.35,severity:"medium",marketChanges:{Index:"-8%",Volatility:"+10%",Spreads:"+20 bps"},assetImpact:{"Акции":-8,"Облигации":2,"Товары":-5,"Валюта":-2},key:"correction",type:"correlation_shock",correlation_multiplier:1.3,custom:!1}]),ra=l(!1),oa=l(null),ua=l(5),ca=l({name:"",description:"",duration:"",probability:1,severity:"medium",type:"return_shock",return_multiplier:.5,volatility_multiplier:1.5,correlation_multiplier:1.3,marketChanges:{},assetImpact:{}}),pa=l([]),va=l([]),da=l([]),ma=l([]),ha=()=>{try{const e=na.value.filter(e=>e.custom);localStorage.setItem("custom_stress_scenarios",JSON.stringify(e))}catch(e){console.error("Failed to save custom scenarios:",e)}},ya=e=>{e?(oa.value=e,ca.value={name:e.name,description:e.description||"",duration:e.duration||"",probability:100*(e.probability||.01),severity:e.severity||"medium",type:e.type||"return_shock",return_multiplier:e.return_multiplier||.5,volatility_multiplier:e.volatility_multiplier||1.5,correlation_multiplier:e.correlation_multiplier||1.3,marketChanges:e.marketChanges?{...e.marketChanges}:{},assetImpact:e.assetImpact?{...e.assetImpact}:{}}):(oa.value=null,ca.value={name:"",description:"",duration:"",probability:1,severity:"medium",type:"return_shock",return_multiplier:.5,volatility_multiplier:1.5,correlation_multiplier:1.3,marketChanges:{},assetImpact:{}}),pa.value=Object.keys(ca.value.marketChanges),va.value=Object.values(ca.value.marketChanges),da.value=Object.keys(ca.value.assetImpact),ma.value=Object.values(ca.value.assetImpact),ra.value=!0},ba=()=>{ra.value=!1,oa.value=null},ka=()=>{"return_shock"===ca.value.type?(ca.value.volatility_multiplier=void 0,ca.value.correlation_multiplier=void 0):"volatility_shock"===ca.value.type?(ca.value.return_multiplier=void 0,ca.value.correlation_multiplier=void 0):"correlation_shock"===ca.value.type&&(ca.value.return_multiplier=void 0,ca.value.volatility_multiplier=void 0)},ga=(e,a,l)=>{const t=pa.value.indexOf(e);t>-1&&(e!==a&&delete ca.value.marketChanges[e],a&&(ca.value.marketChanges[a]=l,pa.value[t]=a,va.value[t]=l))},_a=()=>{const e=`Параметр${Object.keys(ca.value.marketChanges).length+1}`;ca.value.marketChanges[e]="",pa.value.push(e),va.value.push("")},fa=(e,a,l)=>{const t=da.value.indexOf(e);t>-1&&(e!==a&&delete ca.value.assetImpact[e],a&&(ca.value.assetImpact[a]=l,da.value[t]=a,ma.value[t]=l))},xa=()=>{const e=`Актив${Object.keys(ca.value.assetImpact).length+1}`;ca.value.assetImpact[e]=0,da.value.push(e),ma.value.push(0)},Ca=()=>{const e=ca.value.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),a={id:oa?.value?.id||ua.value++,name:ca.value.name,description:ca.value.description,duration:ca.value.duration,probability:ca.value.probability/100,severity:ca.value.severity,key:oa?.value?.key||`custom_${e}`,type:ca.value.type,marketChanges:{...ca.value.marketChanges},assetImpact:{...ca.value.assetImpact},custom:!0};if("return_shock"===ca.value.type&&ca.value.return_multiplier?a.return_multiplier=ca.value.return_multiplier:"volatility_shock"===ca.value.type&&ca.value.volatility_multiplier?a.volatility_multiplier=ca.value.volatility_multiplier:"correlation_shock"===ca.value.type&&ca.value.correlation_multiplier&&(a.correlation_multiplier=ca.value.correlation_multiplier),a.pnlImpact=0,a.varChange=0,oa.value){const e=na.value.findIndex(e=>e.id===oa.value.id);e>-1&&(na.value[e]={...na.value[e],...a})}else na.value.push(a);ha(),ba(),ia(oa.value?"Сценарий обновлен":"Сценарий создан","success")};(()=>{try{const e=localStorage.getItem("custom_stress_scenarios");if(e){const a=JSON.parse(e);na.value=[...na.value.filter(e=>!e.custom),...a];const l=Math.max(...na.value.map(e=>e.id));ua.value=l+1}}catch(e){console.error("Failed to load custom scenarios:",e)}})();const wa=l(na.value[0]),Ia=e=>wa.value=e,Va=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",maximumFractionDigits:0}).format(e),ja=e=>"₽"+(e/1e3).toFixed(0)+"k",Ua=e=>e.charAt(0).toUpperCase()+e.slice(1),Ma=e=>sa.value&&sa.value.results[e]?sa.value.results[e].metrics:null,Oa=e=>{const a=Ma(e.key);if(a){return-((sa.value?.baseline.initial_capital||1e6)-a.mean_final)*ta.value}return e.pnlImpact*ta.value},Fa=e=>{const a=Ma(e.key);if(a){const e=sa.value?.baseline.initial_capital||1e6;return(e-a.var_95)/e*100*ta.value}return e.varChange*ta.value},Sa=a(()=>{if(sa.value){const e=Object.values(sa.value.results).map(e=>-(sa.value.baseline.initial_capital-e.metrics.mean_final));return e.reduce((e,a)=>e+a,0)/e.length*ta.value}return na.value.reduce((e,a)=>e+a.pnlImpact,0)/na.value.length*ta.value}),Ba=a(()=>{if(sa.value){const e=Object.values(sa.value.results).map(e=>-(sa.value.baseline.initial_capital-e.metrics.mean_final));return Math.min(...e)*ta.value}return Math.min(...na.value.map(e=>e.pnlImpact))*ta.value}),La=a(()=>sa.value?Object.values(sa.value.results).reduce((e,a,l)=>{const t=na.value[l];return e+-(sa.value.baseline.initial_capital-a.metrics.mean_final)*(t?.probability||0)},0)*ta.value:na.value.reduce((e,a)=>e+a.pnlImpact*a.probability,0)*ta.value),Ha=async()=>{if(!la.value){la.value=!0;try{const e=x.positions.length||23,a=x.positions.map(e=>e.symbol),l=Array.from({length:e},()=>.05+.1*Math.random()),t=x.correlationMatrix,s=Array.from({length:e},()=>.15+.15*Math.random()),i=[];for(let o=0;o<e;o++){const a=[];for(let l=0;l<e;l++){let e=.3;t.length>o&&void 0!==t[o]?.values?.[l]?e=t[o].values[l]:o===l&&(e=1),a.push(e*s[o]*s[l])}i.push(a)}const n=na.value.map(e=>({name:e.name,key:e.key,type:e.type,return_multiplier:e.return_multiplier,volatility_multiplier:e.volatility_multiplier,correlation_multiplier:e.correlation_multiplier,seed:42})),r=await(async e=>{try{const a=await fetch("   https://stochastic-dashbord-v1-production.up.railway.app/api/stress/test",{method:"POST",headers:_(),body:JSON.stringify(e)});if(!a.ok){const e=await a.json().catch(()=>({detail:"Unknown error"}));throw new Error(e.detail||`HTTP error! status: ${a.status}`)}return await a.json()}catch(a){throw console.error("Stress Test Failed:",a),a}})({mu:l,cov_matrix:i,initial_capital:1e6,risk_free_rate:.1394,gamma:3,scenarios:n,asset_names:a,n_paths:1e3,seed:42});sa.value=r,na.value.forEach(e=>{const a=r.results[e.key];if(a){const l=r.baseline.initial_capital;e.pnlImpact=-(l-a.metrics.mean_final),e.varChange=(l-a.metrics.var_95)/l*100}}),ia("Стресс-тестирование завершено","success")}catch(e){console.error("Ошибка стресс-тестирования:",e),ia("Ошибка при выполнении стресс-тестирования","error")}finally{la.value=!1}}};return(e,a)=>(b(),t("div",C,[s("div",w,[a[17]||(a[17]=s("div",{class:"header-left"},[s("h1",{class:"section-title"},"Стресс-тестирование"),s("p",{class:"section-subtitle"},"Симуляция экстремальных рыночных шоков")],-1)),s("div",I,[s("div",V,[a[13]||(a[13]=s("span",{class:"lbl-mini"},"Банк:",-1)),s("span",j,n(aa.value.name),1)]),s("div",U,[a[14]||(a[14]=s("span",{class:"lbl-mini"},"Множитель шока:",-1)),s("div",M,[r(s("input",{type:"range","onUpdate:modelValue":a[0]||(a[0]=e=>ta.value=e),step:.1,min:.5,max:3,class:"range-slider"},null,512),[[o,ta.value,void 0,{number:!0}]]),s("span",O,n(ta.value.toFixed(1))+"x",1)])]),s("button",{onClick:Ha,class:"btn-glass primary",disabled:la.value},[la.value?(b(),t("span",B,[...a[16]||(a[16]=[s("span",{class:"spinner-mini"},null,-1),u(" Тестирую... ",-1)])])):(b(),t("span",S,[...a[15]||(a[15]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),s("span",null,"Запустить все",-1)])]))],8,F)])]),s("div",L,[(b(!0),t(c,null,p(na.value,e=>(b(),t("div",{key:e.id,onClick:a=>Ia(e),class:v(["glass-card scenario-card",{active:wa.value?.id===e.id}])},[s("div",R,[s("span",$,n(e.name),1),s("div",T,[s("span",{class:v(["badge",e.severity])},n(e.severity),3),s("div",{class:"sc-actions",onClick:a[1]||(a[1]=d(()=>{},["stop"]))},[s("button",{onClick:a=>(e=>{ya(e)})(e),class:"btn-icon-sm",title:"Редактировать"},[...a[18]||(a[18]=[s("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,A),e.custom?(b(),t("button",{key:0,onClick:a=>{return l=e.id,void(confirm("Удалить этот сценарий?")&&(na.value=na.value.filter(e=>e.id!==l),ha(),wa.value?.id===l&&(wa.value=na.value[0]||null),ia("Сценарий удален","success")));var l},class:"btn-icon-sm",title:"Удалить"},[...a[19]||(a[19]=[s("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,P)):m("",!0)])])]),s("p",q,n(e.description),1),s("div",z,[s("span",{class:v(["sc-impact",Oa(e)<0?"text-red":"text-green"])},n(ja(Oa(e))),3),s("span",N,"Вероятность: "+n((100*e.probability).toFixed(0))+"%",1)])],10,H))),128)),s("div",{onClick:a[2]||(a[2]=e=>ya()),class:"glass-card scenario-card add-scenario-card"},[...a[20]||(a[20]=[s("div",{class:"add-scenario-content"},[s("svg",{width:"32",height:"32",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),s("span",{class:"add-scenario-text"},"Создать сценарий")],-1)])])]),i(y,{name:"fade",mode:"out-in"},{default:h(()=>[wa.value?(b(),t("div",X,[s("div",D,[s("div",E,[s("div",J,[s("h3",null,[a[21]||(a[21]=u("Влияние сценария: ",-1)),s("span",K,n(wa.value.name),1)])]),s("div",Y,[s("div",G,[a[22]||(a[22]=s("span",{class:"lbl"},"Влияние на P&L",-1)),s("span",Q,n(Va(Oa(wa.value))),1)]),s("div",W,[a[23]||(a[23]=s("span",{class:"lbl"},"Изменение VaR",-1)),s("span",{class:v(["val",Fa(wa.value)<0?"text-red":"text-green"])},n(Fa(wa.value).toFixed(1))+"% ",3)]),s("div",Z,[a[24]||(a[24]=s("span",{class:"lbl"},"Длительность",-1)),s("span",ee,n(wa.value.duration),1)]),s("div",ae,[a[25]||(a[25]=s("span",{class:"lbl"},"Вероятность",-1)),s("span",le,n((100*wa.value.probability).toFixed(1))+"%",1)])]),a[29]||(a[29]=s("div",{class:"divider"},null,-1)),a[30]||(a[30]=s("div",{class:"panel-header"},[s("h3",null,"Влияние на классы активов")],-1)),s("div",te,[(b(!0),t(c,null,p(wa.value.assetImpact,(e,a)=>(b(),t("div",{key:a,class:"bar-row"},[s("span",se,n(a),1),s("div",ie,[s("div",{class:v(["bar-fill",e<0?"bg-red":"bg-green"]),style:k({width:Math.min(100,Math.abs(e*ta.value*1.5))+"%"})},null,6)]),s("span",{class:v(["bar-val",e<0?"text-red":"text-green"])},n(e>0?"+":"")+n((e*ta.value).toFixed(1))+"% ",3)]))),128))]),a[31]||(a[31]=s("div",{class:"divider"},null,-1)),a[32]||(a[32]=s("div",{class:"panel-header"},[s("h3",null,"Статистика риска")],-1)),s("div",ne,[s("div",re,[a[26]||(a[26]=s("span",{class:"lbl-sm"},"Средний убыток",-1)),s("span",oe,n(ja(Sa.value*ta.value)),1)]),s("div",ue,[a[27]||(a[27]=s("span",{class:"lbl-sm"},"Max Drawdown",-1)),s("span",ce,n(ja(Ba.value*ta.value)),1)]),s("div",pe,[a[28]||(a[28]=s("span",{class:"lbl-sm"},"Expected Shortfall",-1)),s("span",ve,n(ja(La.value*ta.value)),1)])])])]),s("aside",de,[s("div",me,[a[35]||(a[35]=s("div",{class:"panel-header"},[s("h3",null,"Рыночные условия")],-1)),s("div",he,[(b(!0),t(c,null,p(wa.value.marketChanges,(e,a)=>(b(),t("div",{key:a,class:"market-row"},[s("span",ye,n(Ua(a)),1),s("span",{class:v(["m-val",e.includes("-")?"text-red":"text-green"])},n(e),3)]))),128))]),a[36]||(a[36]=s("div",{class:"divider"},null,-1)),s("div",be,[s("p",ke,[a[33]||(a[33]=u(" Метрики пересчитаны с учетом коэффициента шока: ",-1)),s("b",ge,n(ta.value.toFixed(1))+"x",1),a[34]||(a[34]=u(". ",-1))])])])])])):m("",!0)]),_:1}),s("div",_e,[a[38]||(a[38]=s("div",{class:"panel-header"},[s("h3",null,"Сравнение сценариев")],-1)),s("div",fe,[s("table",xe,[a[37]||(a[37]=s("thead",null,[s("tr",null,[s("th",{class:"col-left pl-4"},"Сценарий"),s("th",null,"Влияние на P&L"),s("th",null,"Изменение VaR"),s("th",null,"Длительность"),s("th",null,"Вер.")])],-1)),s("tbody",null,[(b(!0),t(c,null,p(na.value,e=>(b(),t("tr",{key:e.id,class:v(["hover-row",{"row-active":wa.value?.id===e.id}]),onClick:a=>Ia(e)},[s("td",we,[s("span",Ie,n(e.name),1)]),s("td",{class:v(Oa(e)<0?"text-red":"text-green")},n(Va(Oa(e))),3),s("td",{class:v(Fa(e)<0?"text-red":"text-green")},n(Fa(e).toFixed(1))+"% ",3),s("td",Ve,n(e.duration),1),s("td",je,n((100*e.probability).toFixed(1))+"%",1)],10,Ce))),128))])])])]),a[63]||(a[63]=s("div",{class:"footer-notes"},[s("span",{class:"note-item"},"Данные основаны на исторических корреляциях"),s("span",{class:"note-item"},"•"),s("span",{class:"note-item"},"Рекомендуется ежеквартальный пересмотр")],-1)),i(y,{name:"modal-fade"},{default:h(()=>[ra.value?(b(),t("div",{key:0,class:"modal-overlay",onClick:ba},[s("div",{class:"modal-container scenario-editor-modal",onClick:a[12]||(a[12]=d(()=>{},["stop"]))},[s("div",Ue,[s("h2",null,n(oa.value?"Редактировать сценарий":"Создать сценарий"),1),s("button",{class:"modal-close",onClick:ba},[...a[39]||(a[39]=[s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",Me,[s("form",{onSubmit:d(Ca,["prevent"]),class:"scenario-form"},[s("div",Oe,[a[46]||(a[46]=s("h3",{class:"section-title"},"Основная информация",-1)),s("div",Fe,[s("div",Se,[a[40]||(a[40]=s("label",null,"Название сценария",-1)),r(s("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>ca.value.name=e),class:"glass-input",placeholder:"Например: Кризис ликвидности",required:""},null,512),[[o,ca.value.name]])]),s("div",Be,[a[41]||(a[41]=s("label",null,"Описание",-1)),r(s("textarea",{"onUpdate:modelValue":a[4]||(a[4]=e=>ca.value.description=e),class:"glass-input",rows:"2",placeholder:"Краткое описание сценария"},null,512),[[o,ca.value.description]])]),s("div",Le,[a[42]||(a[42]=s("label",null,"Длительность",-1)),r(s("input",{type:"text","onUpdate:modelValue":a[5]||(a[5]=e=>ca.value.duration=e),class:"glass-input",placeholder:"Например: 1–3 дня"},null,512),[[o,ca.value.duration]])]),s("div",He,[a[43]||(a[43]=s("label",null,"Вероятность (%)",-1)),r(s("input",{type:"number","onUpdate:modelValue":a[6]||(a[6]=e=>ca.value.probability=e),class:"glass-input",min:"0",max:"100",step:"0.1",required:""},null,512),[[o,ca.value.probability,void 0,{number:!0}]])]),s("div",Re,[a[45]||(a[45]=s("label",null,"Уровень серьезности",-1)),r(s("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>ca.value.severity=e),class:"glass-input"},[...a[44]||(a[44]=[s("option",{value:"critical"},"Критический",-1),s("option",{value:"high"},"Высокий",-1),s("option",{value:"medium"},"Средний",-1),s("option",{value:"low"},"Низкий",-1)])],512),[[g,ca.value.severity]])])])]),s("div",$e,[a[55]||(a[55]=s("h3",{class:"section-title"},"Тип шока",-1)),s("div",Te,[a[48]||(a[48]=s("label",null,"Тип стресс-теста",-1)),r(s("select",{"onUpdate:modelValue":a[8]||(a[8]=e=>ca.value.type=e),class:"glass-input",onChange:ka},[...a[47]||(a[47]=[s("option",{value:"return_shock"},"Шок доходности",-1),s("option",{value:"volatility_shock"},"Шок волатильности",-1),s("option",{value:"correlation_shock"},"Шок корреляции",-1)])],544),[[g,ca.value.type]])]),"return_shock"===ca.value.type?(b(),t("div",Ae,[s("div",Pe,[a[49]||(a[49]=s("label",null,"Множитель доходности",-1)),r(s("input",{type:"number","onUpdate:modelValue":a[9]||(a[9]=e=>ca.value.return_multiplier=e),class:"glass-input",min:"0",max:"2",step:"0.1",placeholder:"0.5"},null,512),[[o,ca.value.return_multiplier,void 0,{number:!0}]]),a[50]||(a[50]=s("span",{class:"form-hint"},"Множитель для ожидаемой доходности (0.5 = снижение на 50%)",-1))])])):m("",!0),"volatility_shock"===ca.value.type?(b(),t("div",qe,[s("div",ze,[a[51]||(a[51]=s("label",null,"Множитель волатильности",-1)),r(s("input",{type:"number","onUpdate:modelValue":a[10]||(a[10]=e=>ca.value.volatility_multiplier=e),class:"glass-input",min:"0.5",max:"5",step:"0.1",placeholder:"1.5"},null,512),[[o,ca.value.volatility_multiplier,void 0,{number:!0}]]),a[52]||(a[52]=s("span",{class:"form-hint"},"Множитель для волатильности (1.5 = увеличение на 50%)",-1))])])):m("",!0),"correlation_shock"===ca.value.type?(b(),t("div",Ne,[s("div",Xe,[a[53]||(a[53]=s("label",null,"Множитель корреляции",-1)),r(s("input",{type:"number","onUpdate:modelValue":a[11]||(a[11]=e=>ca.value.correlation_multiplier=e),class:"glass-input",min:"0.5",max:"2",step:"0.1",placeholder:"1.3"},null,512),[[o,ca.value.correlation_multiplier,void 0,{number:!0}]]),a[54]||(a[54]=s("span",{class:"form-hint"},"Множитель для корреляций (1.3 = увеличение на 30%)",-1))])])):m("",!0)]),s("div",De,[a[58]||(a[58]=s("h3",{class:"section-title"},"Рыночные изменения",-1)),s("div",Ee,[(b(!0),t(c,null,p(ca.value.marketChanges,(e,l,i)=>(b(),t("div",{key:i,class:"market-change-row"},[r(s("input",{type:"text","onUpdate:modelValue":e=>pa.value[i]=e,class:"glass-input",placeholder:"Параметр (например: VIX)",onInput:a=>ga(l,pa.value[i],e)},null,40,Je),[[o,pa.value[i]]]),r(s("input",{type:"text","onUpdate:modelValue":e=>va.value[i]=e,class:"glass-input",placeholder:"Изменение (например: +20 pts)",onInput:e=>ga(l,pa.value[i],va.value[i])},null,40,Ke),[[o,va.value[i]]]),s("button",{type:"button",onClick:e=>(e=>{delete ca.value.marketChanges[e];const a=pa.value.indexOf(e);a>-1&&(pa.value.splice(a,1),va.value.splice(a,1))})(l),class:"btn-icon-sm btn-danger"},[...a[56]||(a[56]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ye)]))),128)),s("button",{type:"button",onClick:_a,class:"btn-glass outline btn-add"},[...a[57]||(a[57]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Добавить параметр ",-1)])])])]),s("div",Ge,[a[61]||(a[61]=s("h3",{class:"section-title"},"Влияние на классы активов (%)",-1)),s("div",Qe,[(b(!0),t(c,null,p(ca.value.assetImpact,(e,l,i)=>(b(),t("div",{key:i,class:"asset-impact-row"},[r(s("input",{type:"text","onUpdate:modelValue":e=>da.value[i]=e,class:"glass-input",placeholder:"Класс актива (например: Акции)",onInput:a=>fa(l,da.value[i],e)},null,40,We),[[o,da.value[i]]]),r(s("input",{type:"number","onUpdate:modelValue":e=>ma.value[i]=e,class:"glass-input",placeholder:"Влияние (%)",step:"0.1",onInput:e=>fa(l,da.value[i],ma.value[i])},null,40,Ze),[[o,ma.value[i],void 0,{number:!0}]]),s("button",{type:"button",onClick:e=>(e=>{delete ca.value.assetImpact[e];const a=da.value.indexOf(e);a>-1&&(da.value.splice(a,1),ma.value.splice(a,1))})(l),class:"btn-icon-sm btn-danger"},[...a[59]||(a[59]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ea)]))),128)),s("button",{type:"button",onClick:xa,class:"btn-glass outline btn-add"},[...a[60]||(a[60]=[s("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Добавить класс актива ",-1)])])])]),s("div",{class:"form-actions"},[s("button",{type:"button",onClick:ba,class:"btn-glass outline"},"Отмена"),a[62]||(a[62]=s("button",{type:"submit",class:"btn-glass primary"},"Сохранить сценарий",-1))])],32)])])])):m("",!0)]),_:1})]))}}),[["__scopeId","data-v-39cd3d9b"]]);export{aa as default};
