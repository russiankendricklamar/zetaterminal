import{d as a,r as e,v as l,o as s,R as t,c as o,e as i,f as n,x as r,y as c,L as d,t as u,F as p,i as v,n as h,B as g,q as y}from"./vendor-DLyKmMu8.js";import{C as w}from"./auto-DlDBEVoY.js";import{r as m,u as b,w as x}from"./xlsx-Dmkey_AY.js";import{g as f}from"./apiHeaders-DCeXWvJ_.js";import{u as R}from"./swapRegistry-D1SC4d6r.js";import{_ as F}from"./index-BaahR4yN.js";const k="   https://stochastic-dashbord-v1-production.up.railway.app",V=async a=>{try{const e=await fetch(`${k}/api/swap/valuate`,{method:"POST",headers:f(),body:JSON.stringify(a)});if(!e.ok){const a=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(a.detail||`HTTP error! status: ${e.status}`)}return await e.json()}catch(e){throw console.error("Swap Valuation Failed:",e),e}},S={class:"swap-valuation-page"},C={class:"page-header"},P={class:"header-right"},D={class:"control-group"},T={class:"control-group"},_={class:"control-group"},L=["disabled"],Y={key:0},U={key:1},$={key:0,class:"error-message"},j={key:1,class:"card full-width",style:{"margin-bottom":"24px"}},B={class:"card-header",style:{display:"flex","justify-content":"space-between","align-items":"center"}},I={class:"card-subtitle"},E={style:{display:"flex",gap:"8px"}},q=["disabled"],N=["disabled"],A={key:0},O={key:1},z=["disabled"],M={key:0},H={key:1},W={class:"scenario-table-container"},J={class:"scenario-table"},G={key:0},K={key:1},X=["onClick"],Z={class:"mono"},Q={class:"mono"},aa={class:"mono"},ea={class:"mono"},la={key:1,class:"mono accent"},sa=["onClick"],ta={class:"grid-2"},oa={class:"card"},ia={class:"parameter-group"},na={class:"param-row"},ra={class:"param-row"},ca={class:"param-row"},da={class:"param-row"},ua={class:"card"},pa={class:"parameter-group"},va={class:"param-row"},ha={class:"param-row"},ga={class:"param-row"},ya={class:"param-row"},wa={class:"grid-3"},ma={class:"metric-card"},ba={class:"metric-value accent"},xa={class:"metric-detail"},fa={class:"detail-value"},Ra={class:"metric-card"},Fa={class:"metric-value blue"},ka={class:"metric-detail"},Va={class:"detail-value"},Sa={class:"metric-card"},Ca={class:"metric-detail"},Pa={class:"detail-value"},Da={class:"grid-3"},Ta={class:"card"},_a={class:"metrics-list"},La={class:"metric-item"},Ya={class:"value"},Ua={class:"metric-item"},$a={class:"metric-item"},ja={class:"value mono"},Ba={class:"card"},Ia={class:"metrics-list"},Ea={class:"metric-item"},qa={class:"value"},Na={class:"metric-item"},Aa={class:"value"},Oa={class:"card"},za={class:"metrics-list"},Ma={class:"metric-item"},Ha={class:"value mono"},Wa={class:"metric-item"},Ja={class:"value"},Ga={class:"metric-item"},Ka={class:"value"},Xa={class:"card full-width"},Za={class:"cashflow-table-container"},Qa={class:"cashflow-table"},ae={class:"col-period"},ee={class:"col-date mono"},le={class:"col-amount accent"},se={class:"col-amount blue"},te={class:"col-pv mono"},oe={class:"grid-2"},ie={class:"card"},ne={class:"chart-container"},re={class:"card"},ce={class:"chart-container"},de={class:"card full-width"},ue={class:"scenario-container"},pe={class:"scenario-table"},ve={class:"scenario-name"},he={class:"mono"},ge={class:"mono"},ye={class:"accent"},we={class:"blue"},me={class:"grid-3"},be={class:"risk-card risk-high"},xe={class:"risk-value"},fe={class:"risk-detail"},Re={class:"risk-card risk-medium"},Fe={class:"risk-value"},ke={class:"risk-detail"},Ve={class:"risk-card risk-low"},Se={class:"risk-value"},Ce=F(a({__name:"SwapValuation",setup(a){const F=R(),Ce=e("irs"),Pe=e(!1),De=e(""),Te=e(null),_e=e(null),Le=e(!1),Ye=e(!1),Ue=l(()=>F.registrySwaps),$e=l(()=>F.swapResults),je=l({get:()=>F.valuationDate,set:a=>F.setValuationDate(a)}),Be=e({notional:100,tenor:5,fixedRate:4.25,floatingRate:4.15,spread:15,couponsPerYear:2,discountRate:4.2,volatility:12}),Ie=e({pvFixedLeg:0,pvFloatingLeg:0,swapValue:0,duration:0,dv01:0,spreadDv01:0,convexity:0,cashflows:[],scenarios:[]}),Ee=l(()=>Ie.value.scenarios||[]),qe=e(null),Ne=e(null);let Ae=null,Oe=null;const ze=a=>Math.abs(a)>=1?(a>=0?"+":"")+a.toFixed(2):(a>=0?"+":"")+(1e6*a).toFixed(0),Me=a=>Math.abs(a)>=1e6?(a/1e6).toFixed(1)+"–ú":"$"+(a/1e3).toFixed(0)+"K",He=a=>{try{return new Date(a).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return a}},We=()=>{Ge()},Je=async()=>{Pe.value=!0,De.value="";try{const a=await V({notional:Be.value.notional,tenor:Be.value.tenor,fixedRate:Be.value.fixedRate,floatingRate:Be.value.floatingRate,spread:Be.value.spread,couponsPerYear:Be.value.couponsPerYear,discountRate:Be.value.discountRate,volatility:Be.value.volatility,swapType:Ce.value});Ie.value=a,We()}catch(a){De.value=a.message||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —Å–≤–æ–ø–∞",console.error("Swap valuation error:",a)}finally{Pe.value=!1}},Ge=()=>{Ae&&Ae.destroy(),Oe&&Oe.destroy(),qe.value?.getContext("2d")&&(Ae=new w(qe.value.getContext("2d"),{type:"line",data:{labels:["3.25%","3.75%","4.25%","4.75%","5.25%"],datasets:[{label:"Swap Value",data:[5.8,4.2,2.45,.95,-.5],borderColor:"#38bdf8",backgroundColor:"rgba(56, 189, 248, 0.08)",fill:!0,tension:.4,pointRadius:4,borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}})),Ne.value?.getContext("2d")&&(Oe=new w(Ne.value.getContext("2d"),{type:"bar",data:{labels:["2Y","3Y","5Y","7Y","10Y"],datasets:[{label:"DV01 (RUB)",data:[28e3,35e3,42500,48e3,52e3],backgroundColor:"rgba(96, 165, 250, 0.6)",borderColor:"#60a5fa",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.3)"}},y:{grid:{color:"rgba(255,255,255,0.05)"},ticks:{color:"rgba(255,255,255,0.3)"}}}}}))},Ke=async a=>{const e=a.target,l=e.files?.[0];if(l)try{const a=await l.arrayBuffer(),e=m(a,{type:"array"}),s=e.SheetNames[0],t=e.Sheets[s],o=b.sheet_to_json(t,{raw:!1}),i=[];for(const l of o){const a={notional:parseFloat(l.Notional||l.notional||l["–ù–æ–º–∏–Ω–∞–ª"]||l["–ù–æ–º–∏–Ω–∞–ª (–º–ª–Ω)"]||"100"),tenor:parseFloat(l.Tenor||l.tenor||l["–°—Ä–æ–∫"]||l["–°—Ä–æ–∫ (–ª–µ—Ç)"]||l["–°—Ä–æ–∫ (–≥–æ–¥—ã)"]||"5"),fixedRate:parseFloat(l["Fixed Rate"]||l.fixedRate||l["–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞"]||l["–§–∏–∫—Å. —Å—Ç–∞–≤–∫–∞"]||l.Fixed||"4.25"),floatingRate:parseFloat(l["Floating Rate"]||l.floatingRate||l["–ü–ª–∞–≤–∞—é—â–∞—è —Å—Ç–∞–≤–∫–∞"]||l.Floating||l.Index||"4.15"),spread:parseFloat(l.Spread||l.spread||l["–°–ø—Ä–µ–¥"]||l["–°–ø—Ä–µ–¥ (bp)"]||"15"),couponsPerYear:parseFloat(l["Coupons Per Year"]||l.couponsPerYear||l["–ö—É–ø–æ–Ω–æ–≤ –≤ –≥–æ–¥"]||l.Frequency||"2"),discountRate:parseFloat(l["Discount Rate"]||l.discountRate||l["–î–∏—Å–∫–æ–Ω—Ç –∫—Ä–∏–≤–∞—è"]||l["–ë–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞"]||"4.2"),volatility:parseFloat(l.Volatility||l.volatility||l["–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å"]||l.Vol||"12"),swapType:(l.Type||l["Swap Type"]||l.type||l["–¢–∏–ø"]||l["–¢–∏–ø —Å–≤–æ–ø–∞"]||"irs").toLowerCase()};if(a.swapType&&!["irs","cds","basis","xccy"].includes(a.swapType)){const e={"interest rate swap":"irs","credit default swap":"cds","basis swap":"basis","cross currency":"xccy","cross-currency":"xccy","–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π":"irs","–∫—Ä–µ–¥–∏—Ç–Ω—ã–π":"cds","–±–∞–∑–∏—Å–Ω—ã–π":"basis","–≤–∞–ª—é—Ç–Ω—ã–π":"xccy"};a.swapType=e[a.swapType.toLowerCase()]||"irs"}a.notional>0&&a.tenor>0&&i.push(a)}F.loadRegistry(i),_e.value=null}catch(s){console.error("Excel parsing error:",s),De.value=`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞: ${s.message}`}},Xe=async()=>{Le.value=!0,De.value="";try{const e=[];for(let l=0;l<F.registrySwaps.length;l++){const s=F.registrySwaps[l];try{const a=await V({notional:s.notional,tenor:s.tenor,fixedRate:s.fixedRate,floatingRate:s.floatingRate,spread:s.spread,couponsPerYear:s.couponsPerYear,discountRate:s.discountRate,volatility:s.volatility,swapType:s.swapType||"irs"});e.push(a),F.setSwapResult(l,a)}catch(a){e.push(null),F.setSwapResult(l,null),console.error(`Error calculating swap ${l+1}:`,a)}}F.setAllResults(e)}catch(a){console.error("Error calculating swaps:",a),De.value=`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —Å–≤–æ–ø–æ–≤: ${a.message}`}finally{Le.value=!1}},Ze=()=>{if(0===F.registrySwaps.length)return void alert("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–µ–µ—Å—Ç—Ä —Å–≤–æ–ø–æ–≤.");const a=F.swapResults.length>0&&F.swapResults.some(a=>a&&null!==a.swapValue&&void 0!==a.swapValue);if(!a){if(!confirm("–°–≤–æ–ø—ã –µ—â–µ –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?"))return}const e=F.registrySwaps.map((a,e)=>{const l=F.getResultByIndex(e),s=l?.cashflows?.length||0,t=l?.cashflows?.reduce((a,e)=>a+e.pv,0)||0;return{"‚Ññ":e+1,"–¢–∏–ø":a.swapType?.toUpperCase()||"IRS","–ù–æ–º–∏–Ω–∞–ª (–º–ª–Ω)":a.notional||0,"–°—Ä–æ–∫ (–ª–µ—Ç)":a.tenor||0,"–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (%)":a.fixedRate||0,"–ü–ª–∞–≤–∞—é—â–∞—è —Å—Ç–∞–≤–∫–∞ (%)":a.floatingRate||0,"–°–ø—Ä–µ–¥ (bp)":a.spread||0,"–ö—É–ø–æ–Ω–æ–≤ –≤ –≥–æ–¥":a.couponsPerYear||2,"–î–∏—Å–∫–æ–Ω—Ç –∫—Ä–∏–≤–∞—è (%)":a.discountRate||0,"–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (%)":a.volatility||0,"PV —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–æ–≥–∏ (–º–ª–Ω)":null!=l?.pvFixedLeg?l.pvFixedLeg.toFixed(6):"","PV –ø–ª–∞–≤–∞—é—â–µ–π –Ω–æ–≥–∏ (–º–ª–Ω)":null!=l?.pvFloatingLeg?l.pvFloatingLeg.toFixed(6):"","Swap Value (–º–ª–Ω)":null!=l?.swapValue?l.swapValue.toFixed(6):"","Swap Value (% –Ω–æ–º–∏–Ω–∞–ª–∞)":null!=l?.swapValue&&a.notional>0?(l.swapValue/a.notional*100).toFixed(4)+"%":"","Duration (–ª–µ—Ç)":null!=l?.duration?l.duration.toFixed(4):"","DV01 (–º–ª–Ω/bp)":null!=l?.dv01?(l.dv01/1e6).toFixed(6):"","Spread DV01 (–º–ª–Ω/bp)":null!=l?.spreadDv01?(l.spreadDv01/1e6).toFixed(6):"",Convexity:null!=l?.convexity?l.convexity.toFixed(4):"","–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤":s,"–°—É–º–º–∞—Ä–Ω—ã–π PV –ø–æ—Ç–æ–∫–æ–≤ (–º–ª–Ω)":0!==t?(t/1e6).toFixed(6):"","–°—Ç–∞—Ç—É—Å —Ä–∞—Å—á–µ—Ç–∞":l?"–†–∞—Å—Å—á–∏—Ç–∞–Ω":"–ù–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω"}}),l=b.book_new(),s=b.json_to_sheet(e);if(s["!cols"]=[{wch:5},{wch:8},{wch:15},{wch:12},{wch:20},{wch:20},{wch:12},{wch:12},{wch:18},{wch:15},{wch:22},{wch:22},{wch:18},{wch:20},{wch:15},{wch:15},{wch:18},{wch:12},{wch:22},{wch:22},{wch:15}],b.book_append_sheet(l,s,"–†–µ–µ—Å—Ç—Ä —Å–≤–æ–ø–æ–≤"),a){const a=[];if(F.registrySwaps.forEach((e,l)=>{const s=F.getResultByIndex(l);s&&s.cashflows&&s.cashflows.length>0&&s.cashflows.forEach((s,t)=>{a.push({"‚Ññ —Å–≤–æ–ø–∞":l+1,"–¢–∏–ø":e.swapType?.toUpperCase()||"IRS","–ü–µ—Ä–∏–æ–¥":t+1,"–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞":He(s.date),"Fixed Leg (–º–ª–Ω)":(s.fixedLeg/1e6).toFixed(6),"Floating Leg (–º–ª–Ω)":(s.floatingLeg/1e6).toFixed(6),"Net (–º–ª–Ω)":(s.net/1e6).toFixed(6),"PV (–º–ª–Ω)":(s.pv/1e6).toFixed(6)})})}),a.length>0){const e=b.json_to_sheet(a),s=[{wch:8},{wch:8},{wch:8},{wch:12},{wch:18},{wch:18},{wch:15},{wch:15}];e["!cols"]=s,b.book_append_sheet(l,e,"–î–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏")}}const t=new Date,o=`—Ä–µ–µ—Å—Ç—Ä_—Å–≤–æ–ø–æ–≤_${t.toISOString().split("T")[0]}_${t.toTimeString().split(" ")[0].replace(/:/g,"-")}.xlsx`;try{x(l,o),alert(`–†–µ–µ—Å—Ç—Ä —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω: ${o}\n${a?"–í–∫–ª—é—á–∞—è –≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –∏ –¥–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏.":"–¢–æ–ª—å–∫–æ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å–≤–æ–ø—ã –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã)."}`)}catch(i){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ:",i),alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞: ${i.message}`)}},Qe=async()=>{if(0!==F.registrySwaps.length){Ye.value=!0,De.value="";try{const a=await(async a=>{try{const e=await fetch(`${k}/api/database/export/registry/parquet`,{method:"POST",headers:f(),body:JSON.stringify({registry_type:"swap",data:a})});if(!e.ok){const a=await e.json().catch(()=>({detail:"Unknown error"}));throw new Error(a.detail||`HTTP error! status: ${e.status}`)}return await e.json()}catch(De){throw console.error("Save Registry to Parquet Failed:",De),De}})(F.registrySwaps);a.success&&(De.value=`–†–µ–µ—Å—Ç—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: ${a.data.file_name}`,setTimeout(()=>{De.value=""},5e3))}catch(a){console.error("Error saving registry to parquet:",a),De.value=`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–µ—Å—Ç—Ä–∞: ${a.message}`}finally{Ye.value=!1}}},al=()=>{F.clearRegistry(),_e.value=null,Te.value&&(Te.value.value="")},el=()=>{const a={notional:Be.value.notional,tenor:Be.value.tenor,fixedRate:Be.value.fixedRate,floatingRate:Be.value.floatingRate,spread:Be.value.spread,couponsPerYear:Be.value.couponsPerYear,discountRate:Be.value.discountRate,volatility:Be.value.volatility,swapType:Ce.value};F.addSwap(a)};return s(()=>{Je()}),t(()=>{Ae&&Ae.destroy(),Oe&&Oe.destroy()}),(a,e)=>(y(),o("div",S,[i("div",C,[e[15]||(e[15]=i("div",{class:"header-left"},[i("h1",{class:"page-title"},"–û—Ü–µ–Ω–∫–∞ —Å–≤–æ–ø–æ–≤"),i("p",{class:"page-subtitle"},"–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –∞–Ω–∞–ª–∏–∑ IRS, CDS, Basis Swaps")],-1)),i("div",P,[i("div",D,[e[11]||(e[11]=i("label",{class:"control-label"},"–î–∞—Ç–∞ –æ—Ü–µ–Ω–∫–∏:",-1)),r(i("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>je.value=a),type:"date",class:"date-input",onChange:We},null,544),[[c,je.value]])]),i("div",T,[e[12]||(e[12]=i("label",{class:"control-label"},"–†–µ–µ—Å—Ç—Ä:",-1)),i("input",{type:"file",ref_key:"fileInputRef",ref:Te,onChange:Ke,accept:".xlsx,.xls",style:{display:"none"},id:"excel-upload"},null,544),i("button",{onClick:e[1]||(e[1]=()=>{Te.value&&Te.value.click()}),class:"btn-secondary",title:"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–µ—Å—Ç—Ä —Å–≤–æ–ø–æ–≤ –∏–∑ Excel"}," –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel ")]),i("div",_,[e[14]||(e[14]=i("label",{class:"control-label"},"–¢–∏–ø —Å–≤–æ–ø–∞:",-1)),r(i("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>Ce.value=a),class:"swap-type-select",onChange:We},[...e[13]||(e[13]=[i("option",{value:"irs"},"Interest Rate Swap (IRS)",-1),i("option",{value:"cds"},"Credit Default Swap (CDS)",-1),i("option",{value:"basis"},"Basis Swap",-1),i("option",{value:"xccy"},"Cross-Currency Swap",-1)])],544),[[d,Ce.value]])]),i("button",{onClick:el,class:"btn-secondary",title:"–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–≤–æ–ø –≤ —Ä–µ–µ—Å—Ç—Ä"}," ‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–µ–µ—Å—Ç—Ä "),i("button",{onClick:Je,class:"btn-primary",disabled:Pe.value},[Pe.value?(y(),o("span",U,"‚Ü∫ –°—á–∏—Ç–∞—é...")):(y(),o("span",Y,"–ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å"))],8,L)])]),De.value?(y(),o("div",$," ‚ö†Ô∏è "+u(De.value),1)):n("",!0),Ue.value.length>0?(y(),o("div",j,[i("div",B,[i("div",null,[e[16]||(e[16]=i("h3",null,"–†–µ–µ—Å—Ç—Ä —Å–≤–æ–ø–æ–≤",-1)),i("span",I,"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–≤–æ–ø–æ–≤: "+u(Ue.value.length),1)]),i("div",E,[i("button",{onClick:Ze,class:"btn-secondary",disabled:0===Ue.value.length,style:{"font-size":"11px",padding:"6px 12px"},title:"–í—ã–≥—Ä—É–∑–∏—Ç—å —Ä–µ–µ—Å—Ç—Ä –≤ Excel"}," üì• –í—ã–≥—Ä—É–∑–∏—Ç—å Excel ",8,q),i("button",{onClick:Qe,class:"btn-secondary",disabled:0===Ue.value.length||Ye.value,style:{"font-size":"11px",padding:"6px 12px"},title:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–µ—Å—Ç—Ä –≤ Supabase (parquet)"},[Ye.value?(y(),o("span",O,"‚Ü∫ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...")):(y(),o("span",A,"üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î"))],8,N),i("button",{onClick:Xe,class:"btn-secondary",disabled:Le.value,style:{"font-size":"11px",padding:"6px 12px"}},[Le.value?(y(),o("span",H,"‚Ü∫ –°—á–∏—Ç–∞—é...")):(y(),o("span",M,"–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ"))],8,z),i("button",{onClick:al,class:"btn-secondary",style:{"font-size":"11px",padding:"6px 12px",background:"rgba(239, 68, 68, 0.2)","border-color":"rgba(239, 68, 68, 0.3)"}}," ‚úï –û—á–∏—Å—Ç–∏—Ç—å ")])]),i("div",W,[i("table",J,[i("thead",null,[i("tr",null,[e[17]||(e[17]=i("th",null,"‚Ññ",-1)),e[18]||(e[18]=i("th",null,"–¢–∏–ø",-1)),e[19]||(e[19]=i("th",null,"–ù–æ–º–∏–Ω–∞–ª (–º–ª–Ω)",-1)),e[20]||(e[20]=i("th",null,"–°—Ä–æ–∫ (–ª–µ—Ç)",-1)),e[21]||(e[21]=i("th",null,"–§–∏–∫—Å. —Å—Ç–∞–≤–∫–∞ (%)",-1)),e[22]||(e[22]=i("th",null,"–ü–ª–∞–≤–∞—é—â–∞—è (%)",-1)),$e.value.length>0?(y(),o("th",G,"Swap Value")):n("",!0),$e.value.length>0?(y(),o("th",K,"DV01")):n("",!0),e[23]||(e[23]=i("th",null,"–î–µ–π—Å—Ç–≤–∏–µ",-1))])]),i("tbody",null,[(y(!0),o(p,null,v(Ue.value,(a,e)=>(y(),o("tr",{key:e,class:h({selected:_e.value===e}),onClick:a=>{return l=e,void(_e.value=l);var l}},[i("td",null,u(e+1),1),i("td",null,u(a.swapType?.toUpperCase()||"IRS"),1),i("td",Z,u(a.notional?a.notional.toFixed(2):"-"),1),i("td",Q,u(a.tenor?a.tenor.toFixed(2):"-"),1),i("td",aa,u(a.fixedRate?a.fixedRate.toFixed(2)+"%":"-"),1),i("td",ea,u(a.floatingRate?a.floatingRate.toFixed(2)+"%":"-"),1),$e.value.length>0&&$e.value[e]?(y(),o("td",{key:0,class:h(["mono",$e.value[e]?.swapValue>=0?"positive":"negative"])},u($e.value[e]?.swapValue?ze($e.value[e].swapValue):"-"),3)):n("",!0),$e.value.length>0&&$e.value[e]?(y(),o("td",la,u($e.value[e]?.dv01?Me($e.value[e].dv01):"-"),1)):n("",!0),i("td",null,[i("button",{onClick:g(a=>(a=>{const e=F.getSwapByIndex(a);e&&(Be.value.notional=e.notional||Be.value.notional,Be.value.tenor=e.tenor||Be.value.tenor,Be.value.fixedRate=e.fixedRate||Be.value.fixedRate,Be.value.floatingRate=e.floatingRate||Be.value.floatingRate,Be.value.spread=e.spread||Be.value.spread,Be.value.couponsPerYear=e.couponsPerYear||Be.value.couponsPerYear,Be.value.discountRate=e.discountRate||Be.value.discountRate,Be.value.volatility=e.volatility||Be.value.volatility,Ce.value=e.swapType||Ce.value,setTimeout(()=>{Je()},100))})(e),["stop"]),class:"btn-small",title:"–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ —Ñ–æ—Ä–º—É"}," –ó–∞–≥—Ä—É–∑–∏—Ç—å ",8,sa)])],10,X))),128))])])])])):n("",!0),i("div",ta,[i("div",oa,[e[29]||(e[29]=i("div",{class:"card-header"},[i("h3",null,"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–≤–æ–ø–∞")],-1)),i("div",ia,[i("div",na,[e[24]||(e[24]=i("label",null,"–ù–æ–º–∏–Ω–∞–ª (–º–ª–Ω)",-1)),r(i("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>Be.value.notional=a),type:"number",class:"param-input",onChange:We},null,544),[[c,Be.value.notional,void 0,{number:!0}]])]),i("div",ra,[e[25]||(e[25]=i("label",null,"–°—Ä–æ–∫ (–≥–æ–¥—ã)",-1)),r(i("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>Be.value.tenor=a),type:"number",class:"param-input",step:"0.5",onChange:We},null,544),[[c,Be.value.tenor,void 0,{number:!0}]])]),i("div",ca,[e[26]||(e[26]=i("label",null,"–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (%)",-1)),r(i("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>Be.value.fixedRate=a),type:"number",class:"param-input",step:"0.01",onChange:We},null,544),[[c,Be.value.fixedRate,void 0,{number:!0}]])]),i("div",da,[e[28]||(e[28]=i("label",null,"–ö—É–ø–æ–Ω–æ–≤ –≤ –≥–æ–¥",-1)),r(i("select",{"onUpdate:modelValue":e[6]||(e[6]=a=>Be.value.couponsPerYear=a),class:"param-input",onChange:We},[...e[27]||(e[27]=[i("option",{value:"1"},"1",-1),i("option",{value:"2"},"2 (–†–∞–∑ –≤ –ø–æ–ª–≥–æ–¥–∞)",-1),i("option",{value:"4"},"4 (–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ)",-1)])],544),[[d,Be.value.couponsPerYear,void 0,{number:!0}]])])])]),i("div",ua,[e[34]||(e[34]=i("div",{class:"card-header"},[i("h3",null,"–†—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è")],-1)),i("div",pa,[i("div",va,[e[30]||(e[30]=i("label",null,"–ò–Ω–¥–µ–∫—Å –ø–ª–∞–≤–∞—é—â–µ–π —Å—Ç–∞–≤–∫–∏ (%)",-1)),r(i("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>Be.value.floatingRate=a),type:"number",class:"param-input",step:"0.01",onChange:We},null,544),[[c,Be.value.floatingRate,void 0,{number:!0}]])]),i("div",ha,[e[31]||(e[31]=i("label",null,"–°–ø—Ä–µ–¥ (bp)",-1)),r(i("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>Be.value.spread=a),type:"number",class:"param-input",step:"1",onChange:We},null,544),[[c,Be.value.spread,void 0,{number:!0}]])]),i("div",ga,[e[32]||(e[32]=i("label",null,"–î–∏—Å–∫–æ–Ω—Ç –∫—Ä–∏–≤–∞—è (–±–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞, %)",-1)),r(i("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>Be.value.discountRate=a),type:"number",class:"param-input",step:"0.01",onChange:We},null,544),[[c,Be.value.discountRate,void 0,{number:!0}]])]),i("div",ya,[e[33]||(e[33]=i("label",null,"–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (%)",-1)),r(i("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>Be.value.volatility=a),type:"number",class:"param-input",step:"0.1",onChange:We},null,544),[[c,Be.value.volatility,void 0,{number:!0}]])])])])]),i("div",wa,[i("div",ma,[e[36]||(e[36]=i("div",{class:"metric-header"},[i("h3",null,"PV —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–æ–≥–∏"),i("span",{class:"metric-unit"},"–º–ª–Ω RUB")],-1)),i("div",ba,u(ze(Ie.value.pvFixedLeg)),1),i("div",xa,[e[35]||(e[35]=i("span",{class:"detail-label"},"–ö—É–ø–æ–Ω—ã:",-1)),i("span",fa,u(Be.value.couponsPerYear*Be.value.tenor)+" —à—Ç.",1)])]),i("div",Ra,[e[38]||(e[38]=i("div",{class:"metric-header"},[i("h3",null,"PV –ø–ª–∞–≤–∞—é—â–µ–π –Ω–æ–≥–∏"),i("span",{class:"metric-unit"},"–º–ª–Ω RUB")],-1)),i("div",Fa,u(ze(Ie.value.pvFloatingLeg)),1),i("div",ka,[e[37]||(e[37]=i("span",{class:"detail-label"},"Forward Rate:",-1)),i("span",Va,u((Be.value.floatingRate+Be.value.spread/100).toFixed(2))+"%",1)])]),i("div",Sa,[e[40]||(e[40]=i("div",{class:"metric-header"},[i("h3",null,"–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–≤–æ–ø–∞ (Payer)"),i("span",{class:"metric-unit"},"–º–ª–Ω RUB")],-1)),i("div",{class:h(["metric-value",Ie.value.swapValue>=0?"positive":"negative"])},u(ze(Ie.value.swapValue)),3),i("div",Ca,[e[39]||(e[39]=i("span",{class:"detail-label"},"–í % –Ω–æ–º–∏–Ω–∞–ª–∞:",-1)),i("span",Pa,u((Ie.value.swapValue/Be.value.notional*100).toFixed(2))+"%",1)])])]),i("div",Da,[i("div",Ta,[e[44]||(e[44]=i("div",{class:"card-header"},[i("h3",null,"–ê–Ω–∞–ª–∏–∑ Duration")],-1)),i("div",_a,[i("div",La,[e[41]||(e[41]=i("span",{class:"label"},"Modified Duration",-1)),i("span",Ya,u(Ie.value.duration.toFixed(2)),1)]),i("div",Ua,[e[42]||(e[42]=i("span",{class:"label"},"DV01 (–ú/bp)",-1)),i("span",{class:h(["value",Ie.value.dv01>=0?"positive":"negative"])},u(Me(Ie.value.dv01)),3)]),i("div",$a,[e[43]||(e[43]=i("span",{class:"label"},"BPV (–ú)",-1)),i("span",ja,u((Ie.value.dv01/1e4).toFixed(4)),1)])])]),i("div",Ba,[e[48]||(e[48]=i("div",{class:"card-header"},[i("h3",null,"–í—ã–ø—É–∫–ª–æ—Å—Ç—å")],-1)),i("div",Ia,[i("div",Ea,[e[45]||(e[45]=i("span",{class:"label"},"Convexity",-1)),i("span",qa,u(Ie.value.convexity.toFixed(2)),1)]),i("div",Na,[e[46]||(e[46]=i("span",{class:"label"},"Gamma (–ú/bp¬≤)",-1)),i("span",Aa,u((Ie.value.convexity/100).toFixed(4)),1)]),e[47]||(e[47]=i("div",{class:"metric-item"},[i("span",{class:"label"},"–£—Ä–æ–≤–µ–Ω—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω"),i("span",{class:"value"},"–ù–∏–∑–∫–∏–π")],-1))])]),i("div",Oa,[e[52]||(e[52]=i("div",{class:"card-header"},[i("h3",null,"–°–ø—Ä–µ–¥-–º–µ—Ç—Ä–∏–∫–∏")],-1)),i("div",za,[i("div",Ma,[e[49]||(e[49]=i("span",{class:"label"},"Spread DV01 (–ú/bp)",-1)),i("span",Ha,u(Me(Ie.value.spreadDv01)),1)]),i("div",Wa,[e[50]||(e[50]=i("span",{class:"label"},"ASW (All-in Swap)",-1)),i("span",Ja,u(Be.value.spread)+" bp",1)]),i("div",Ga,[e[51]||(e[51]=i("span",{class:"label"},"Z-spread",-1)),i("span",Ka,u((1.05*Be.value.spread).toFixed(0))+" bp",1)])])])]),i("div",Xa,[e[54]||(e[54]=i("div",{class:"card-header"},[i("h3",null,"–ì—Ä–∞—Ñ–∏–∫ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤"),i("span",{class:"card-subtitle"},"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏ –ø–ª–∞–≤–∞—é—â–µ–π –Ω–æ–≥")],-1)),i("div",Za,[i("table",Qa,[e[53]||(e[53]=i("thead",null,[i("tr",null,[i("th",{class:"col-period"},"–ü–µ—Ä–∏–æ–¥"),i("th",{class:"col-date"},"–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞"),i("th",{class:"col-amount"},"Fixed Leg (–ú)"),i("th",{class:"col-amount"},"Floating Leg (–ú)"),i("th",{class:"col-amount"},"Net (–ú)"),i("th",{class:"col-pv"},"PV (–ú)")])],-1)),i("tbody",null,[(y(!0),o(p,null,v(Ie.value.cashflows,(a,e)=>(y(),o("tr",{key:e},[i("td",ae,u(e+1),1),i("td",ee,u(He(a.date)),1),i("td",le,u(ze(a.fixedLeg)),1),i("td",se,u(ze(a.floatingLeg)),1),i("td",{class:h(["col-amount",a.net>=0?"positive":"negative"])},u(a.net>=0?"+":"")+u(ze(a.net)),3),i("td",te,u(ze(a.pv)),1)]))),128))])])])]),i("div",oe,[i("div",ie,[e[55]||(e[55]=i("div",{class:"chart-header"},[i("h3",null,"–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–≤–æ–ø–∞ vs –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞"),i("span",{class:"chart-subtitle"},"–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞–≤–∫–∏")],-1)),i("div",ne,[i("canvas",{ref_key:"pvProfileRef",ref:qe},null,512)])]),i("div",re,[e[56]||(e[56]=i("div",{class:"chart-header"},[i("h3",null,"DV01 vs –°—Ä–æ–∫"),i("span",{class:"chart-subtitle"},"–†–∏—Å–∫ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Å—Ä–æ–∫–∞–º")],-1)),i("div",ce,[i("canvas",{ref_key:"dv01ProfileRef",ref:Ne},null,512)])])]),i("div",de,[e[58]||(e[58]=i("div",{class:"card-header"},[i("h3",null,"–ê–Ω–∞–ª–∏–∑ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤"),i("span",{class:"card-subtitle"},"Swap Value –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö —Å—Ç–∞–≤–æ–∫")],-1)),i("div",ue,[i("table",pe,[e[57]||(e[57]=i("thead",null,[i("tr",null,[i("th",null,"–°—Ü–µ–Ω–∞—Ä–∏–π"),i("th",null,"Fixed Rate"),i("th",null,"Floating Rate"),i("th",null,"PV Fixed Leg"),i("th",null,"PV Floating Leg"),i("th",null,"Swap Value (–ú)"),i("th",null,"PnL (–ú)")])],-1)),i("tbody",null,[(y(!0),o(p,null,v(Ee.value,a=>(y(),o("tr",{key:a.name,class:h(a.isBase?"base":"")},[i("td",ve,u(a.name),1),i("td",he,u(a.fixedRate.toFixed(2))+"%",1),i("td",ge,u(a.floatingRate.toFixed(2))+"%",1),i("td",ye,u(ze(a.pvFixed)),1),i("td",we,u(ze(a.pvFloating)),1),i("td",{class:h(["mono",a.swapValue>=0?"positive":"negative"])},u(a.swapValue>=0?"+":"")+u(ze(a.swapValue)),3),i("td",{class:h(["mono",a.pnl>=0?"positive":"negative"])},u(a.pnl>=0?"+":"")+u(ze(a.pnl)),3)],2))),128))])])])]),i("div",me,[i("div",be,[e[59]||(e[59]=i("div",{class:"risk-header"},[i("span",{class:"risk-icon"}),i("h3",null,"–†–∏—Å–∫ Duration")],-1)),i("div",xe,u(Ie.value.duration.toFixed(2))+" y",1),i("div",fe,"ŒîPV / 100bp: "+u(Me(Ie.value.dv01)),1)]),i("div",Re,[e[60]||(e[60]=i("div",{class:"risk-header"},[i("span",{class:"risk-icon"}),i("h3",null,"–†–∏—Å–∫ —Å–ø—Ä–µ–¥–∞")],-1)),i("div",Fe,u(Be.value.spread)+" bp",1),i("div",ke,"Spread DV01: "+u(Me(Ie.value.spreadDv01)),1)]),i("div",Ve,[e[61]||(e[61]=i("div",{class:"risk-header"},[i("span",{class:"risk-icon"}),i("h3",null,"–†–∏—Å–∫ Convexity")],-1)),i("div",Se,u(Ie.value.convexity.toFixed(2)),1),e[62]||(e[62]=i("div",{class:"risk-detail"},"–ù–∏–∑–∫–∏–π —Ä–∏—Å–∫ –¥–ª—è vanilla",-1))])]),e[63]||(e[63]=i("div",{class:"page-footer"},[i("span",null,"‚Ä¢ –ú–æ–¥–µ–ª—å: Discounted Cash Flow (DCF)"),i("span",null,"‚Ä¢ –ú–µ—Ç–æ–¥: Bootstrap yield curve"),i("span",null,"‚Ä¢ –†–∞—Å—á—ë—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏")],-1))]))}}),[["__scopeId","data-v-978ace7b"]]);export{Ce as default};
