import{d as a,a as l,r as s,v as e,c as t,e as n,n as p,j as d,t as i,g as u,x as o,y as c,S as r,w as v,T as m,F as h,i as g,q as b,f as y}from"./vendor-DLyKmMu8.js";import{_ as x}from"./index-AoYxWDki.js";const M={class:"page-container custom-scroll"},S={class:"section-header"},k={class:"header-actions"},w={class:"glass-pill status-pill"},f={class:"status-label"},F={class:"text-white"},q={class:"dashboard-grid"},T={class:"left-panel"},U={class:"glass-card panel"},V={class:"controls-form"},C={class:"input-group"},_={class:"input-group"},K={class:"input-group"},P={class:"input-group"},j={class:"input-group"},G={class:"input-group"},I={class:"radio-group"},L={class:"radio-label"},z={class:"radio-label"},A={key:0,class:"glass-card panel"},O={class:"stats-list"},R={class:"stat-item"},B={class:"val mono"},D={class:"stat-item"},E={class:"val mono"},H={class:"stat-item"},J={class:"val mono"},N={class:"stat-item"},Q={class:"stat-item"},W={class:"val mono"},X={class:"main-panel"},Y={class:"glass-card chart-card"},Z={class:"scenario-controls"},$={class:"scenario-input"},aa={class:"scenario-input"},la={class:"scenario-input"},sa={key:0,class:"pl-results"},ea={class:"pl-row"},ta={class:"pl-value mono"},na={class:"pl-row"},pa={class:"pl-value mono"},da={class:"pl-row"},ia={class:"pl-value mono"},ua={class:"pl-row"},oa={class:"pl-value mono"},ca={class:"pl-row total"},ra={key:1,class:"pl-results empty-state"},va={class:"glass-card chart-card mt-4"},ma={key:0,class:"sensitivity-table"},ha={class:"data-table"},ga={class:"row-header"},ba={key:1,class:"pl-results empty-state"},ya=x(a({__name:"OptionGreeksAnalyzer",setup(a){const x=l({S:100,K:100,r:5,sigma:20,T:.25,type:"call"}),ya=l({deltaS:5,deltaSigma:1,deltaT:7}),xa=l({delta:null,gamma:null,vega:null,theta:null,rho:null}),Ma=s([]),Sa=a=>{const l=a<0?-1:1,s=Math.abs(a)/Math.sqrt(2),e=1/(1+.3275911*s);return.5*(1+l*(1-(1.061405429*Math.pow(e,5)+-1.453152027*Math.pow(e,4)+1.421413741*Math.pow(e,3)+-.284496736*Math.pow(e,2)+.254829592*e)*Math.exp(-s*s)))},ka=(a,l,s,e,t,n)=>{if(e<=0||t<=0)return 0;const p=(Math.log(a/l)+(s+.5*e*e)*t)/(e*Math.sqrt(t)),d=p-e*Math.sqrt(t);return"call"===n?a*Sa(p)-l*Math.exp(-s*t)*Sa(d):l*Math.exp(-s*t)*Sa(-d)-a*Sa(-p)},wa=()=>{const a=x.S,l=x.K,s=x.r/100,e=x.sigma/100,t=x.T;if(e<=0||t<=0)return xa.delta=null,xa.gamma=null,xa.vega=null,xa.theta=null,xa.rho=null,void(Ma.value=[]);const n=(Math.log(a/l)+(s+.5*e*e)*t)/(e*Math.sqrt(t)),p=n-e*Math.sqrt(t),d=Sa(n),i=Sa(-n),u=(o=n,Math.exp(-.5*o*o)/Math.sqrt(2*Math.PI));var o;const c=Sa(p),r=Sa(-p);"call"===x.type?xa.delta=d:xa.delta=i-1,xa.gamma=u/(a*e*Math.sqrt(t)),xa.vega=a*u*Math.sqrt(t)/100,"call"===x.type?xa.theta=(-a*u*e/(2*Math.sqrt(t))-s*l*Math.exp(-s*t)*c)/365:xa.theta=(-a*u*e/(2*Math.sqrt(t))+s*l*Math.exp(-s*t)*r)/365,xa.rho=("call"===x.type?l*t*Math.exp(-s*t)*c:-l*t*Math.exp(-s*t)*r)/100;const v=[-2,-1,0,1,2],m=ka(a,l,s,e,t,x.type);Ma.value=[-10,-5,0,5,10].map(n=>v.map(p=>ka(a+n,l,s,e+p/100,t,x.type)-m))},fa=e(()=>(xa.delta||0)*ya.deltaS),Fa=e(()=>.5*(xa.gamma||0)*Math.pow(ya.deltaS,2)),qa=e(()=>(xa.vega||0)*ya.deltaSigma),Ta=e(()=>(xa.theta||0)*ya.deltaT),Ua=e(()=>fa.value+Fa.value+qa.value+Ta.value),Va=e(()=>"call"===x.type?"bg-green":"bg-red");return wa(),(a,l)=>(b(),t("div",M,[n("div",S,[l[11]||(l[11]=n("div",{class:"header-left"},[n("h1",{class:"section-title"},"Анализ чувствительности (Greeks)"),n("p",{class:"section-subtitle"},"Дельта, гамма, вега, тета, ро — риск-ориентированный анализ")],-1)),n("div",k,[n("div",w,[n("span",{class:p(["dot",Va.value])},null,2),n("span",f,[l[10]||(l[10]=d("Тип: ",-1)),n("b",F,i(x.type.toUpperCase()),1)])])])]),n("div",q,[n("aside",T,[n("div",U,[l[20]||(l[20]=n("div",{class:"panel-header"},[n("h3",null,"Параметры опциона")],-1)),n("div",V,[n("div",C,[l[12]||(l[12]=n("label",{class:"lbl"},"S (Spot)",-1)),o(n("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>x.S=a),type:"number",step:"0.01",class:"glass-input",onChange:wa},null,544),[[c,x.S,void 0,{number:!0}]])]),n("div",_,[l[13]||(l[13]=n("label",{class:"lbl"},"K (Strike)",-1)),o(n("input",{"onUpdate:modelValue":l[1]||(l[1]=a=>x.K=a),type:"number",step:"0.01",class:"glass-input",onChange:wa},null,544),[[c,x.K,void 0,{number:!0}]])]),n("div",K,[l[14]||(l[14]=n("label",{class:"lbl"},"r (Rate), %",-1)),o(n("input",{"onUpdate:modelValue":l[2]||(l[2]=a=>x.r=a),type:"number",step:"0.01",class:"glass-input",onChange:wa},null,544),[[c,x.r,void 0,{number:!0}]])]),n("div",P,[l[15]||(l[15]=n("label",{class:"lbl"},"σ (Vol), %",-1)),o(n("input",{"onUpdate:modelValue":l[3]||(l[3]=a=>x.sigma=a),type:"number",step:"0.01",class:"glass-input",onChange:wa},null,544),[[c,x.sigma,void 0,{number:!0}]])]),n("div",j,[l[16]||(l[16]=n("label",{class:"lbl"},"T (Time), лет",-1)),o(n("input",{"onUpdate:modelValue":l[4]||(l[4]=a=>x.T=a),type:"number",step:"0.01",min:"0.001",class:"glass-input",onChange:wa},null,544),[[c,x.T,void 0,{number:!0}]])]),n("div",G,[l[19]||(l[19]=n("label",{class:"lbl"},"Тип опциона",-1)),n("div",I,[n("label",L,[o(n("input",{"onUpdate:modelValue":l[5]||(l[5]=a=>x.type=a),type:"radio",value:"call",onChange:wa},null,544),[[r,x.type]]),l[17]||(l[17]=n("span",null,"Call",-1))]),n("label",z,[o(n("input",{"onUpdate:modelValue":l[6]||(l[6]=a=>x.type=a),type:"radio",value:"put",onChange:wa},null,544),[[r,x.type]]),l[18]||(l[18]=n("span",null,"Put",-1))])])])])]),u(m,{name:"fade"},{default:v(()=>[null!==xa.delta?(b(),t("div",A,[l[26]||(l[26]=n("div",{class:"panel-header"},[n("h3",null,"Риск-метрики")],-1)),n("div",O,[n("div",R,[l[21]||(l[21]=n("div",{class:"stat-head"},[n("span",{class:"greek-symbol"},"Δ"),n("span",{class:"s-name"},"Дельта")],-1)),n("span",B,i(xa.delta.toFixed(4)),1)]),n("div",D,[l[22]||(l[22]=n("div",{class:"stat-head"},[n("span",{class:"greek-symbol"},"Γ"),n("span",{class:"s-name"},"Гамма")],-1)),n("span",E,i(xa.gamma.toFixed(6)),1)]),n("div",H,[l[23]||(l[23]=n("div",{class:"stat-head"},[n("span",{class:"greek-symbol"},"ν"),n("span",{class:"s-name"},"Вега")],-1)),n("span",J,i(xa.vega.toFixed(4)),1)]),n("div",N,[l[24]||(l[24]=n("div",{class:"stat-head"},[n("span",{class:"greek-symbol"},"Θ"),n("span",{class:"s-name"},"Тета")],-1)),n("span",{class:p(["val mono",xa.theta<0?"text-red":"text-green"])},i(xa.theta.toFixed(4)),3)]),n("div",Q,[l[25]||(l[25]=n("div",{class:"stat-head"},[n("span",{class:"greek-symbol"},"ρ"),n("span",{class:"s-name"},"Ро")],-1)),n("span",W,i(xa.rho.toFixed(4)),1)])])])):y("",!0)]),_:1})]),n("main",X,[n("div",Y,[l[37]||(l[37]=n("div",{class:"chart-header"},[n("h3",null,"Сценарный анализ P&L")],-1)),n("div",Z,[n("div",$,[l[27]||(l[27]=n("label",null,"ΔS (руб.)",-1)),o(n("input",{"onUpdate:modelValue":l[7]||(l[7]=a=>ya.deltaS=a),type:"number",step:"0.1",class:"glass-input-sm"},null,512),[[c,ya.deltaS,void 0,{number:!0}]])]),n("div",aa,[l[28]||(l[28]=n("label",null,"Δσ (%)",-1)),o(n("input",{"onUpdate:modelValue":l[8]||(l[8]=a=>ya.deltaSigma=a),type:"number",step:"0.1",class:"glass-input-sm"},null,512),[[c,ya.deltaSigma,void 0,{number:!0}]])]),n("div",la,[l[29]||(l[29]=n("label",null,"Δt (дн.)",-1)),o(n("input",{"onUpdate:modelValue":l[9]||(l[9]=a=>ya.deltaT=a),type:"number",step:"1",class:"glass-input-sm"},null,512),[[c,ya.deltaT,void 0,{number:!0}]])])]),null!==xa.delta?(b(),t("div",sa,[n("div",ea,[l[30]||(l[30]=n("span",{class:"pl-label"},"Δ компонент",-1)),n("span",ta,i(fa.value.toFixed(2)),1)]),n("div",na,[l[31]||(l[31]=n("span",{class:"pl-label"},"Γ компонент",-1)),n("span",pa,i(Fa.value.toFixed(2)),1)]),n("div",da,[l[32]||(l[32]=n("span",{class:"pl-label"},"ν компонент",-1)),n("span",ia,i(qa.value.toFixed(2)),1)]),n("div",ua,[l[33]||(l[33]=n("span",{class:"pl-label"},"Θ компонент",-1)),n("span",oa,i(Ta.value.toFixed(2)),1)]),l[35]||(l[35]=n("div",{class:"pl-row divider"},null,-1)),n("div",ca,[l[34]||(l[34]=n("span",{class:"pl-label"},"Всего (приблиз.)",-1)),n("span",{class:p(["pl-value mono",Ua.value>=0?"text-green":"text-red"])},i(Ua.value.toFixed(2)),3)])])):(b(),t("div",ra,[...l[36]||(l[36]=[n("span",null,"Рассчитайте греки для анализа",-1)])]))]),n("div",va,[l[40]||(l[40]=n("div",{class:"chart-header"},[n("h3",null,"Матрица чувствительности P&L (ΔS × Δσ)")],-1)),Ma.value.length?(b(),t("div",ma,[n("table",ha,[l[38]||(l[38]=n("thead",null,[n("tr",null,[n("th",null,"ΔS (руб.)"),n("th",null,"σ - 2%"),n("th",null,"σ - 1%"),n("th",null,"σ базовое"),n("th",null,"σ + 1%"),n("th",null,"σ + 2%")])],-1)),n("tbody",null,[(b(!0),t(h,null,g(Ma.value,(a,l)=>(b(),t("tr",{key:l},[n("td",ga,i([-10,-5,0,5,10][l]),1),(b(!0),t(h,null,g(a,(a,l)=>(b(),t("td",{key:l,class:p({positive:a>0,negative:a<0})},i(a.toFixed(2)),3))),128))]))),128))])])])):(b(),t("div",ba,[...l[39]||(l[39]=[n("span",null,"Матрица будет заполнена после расчёта",-1)])]))])])])]))}}),[["__scopeId","data-v-56e8f3f1"]]);export{ya as default};
