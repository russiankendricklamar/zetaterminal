const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/zcycService-BjIxtT5Z.js","assets/apiHeaders-DCeXWvJ_.js"])))=>i.map(i=>d[i]);
import{a,_ as l}from"./index-BaahR4yN.js";import{d as s,r as e,v as t,o as i,c as r,e as n,x as d,y as v,P as c,t as o,f as u,I as p,F as m,i as b,j as g,n as h,C as f,q as k}from"./vendor-DLyKmMu8.js";import{C as x}from"./auto-DlDBEVoY.js";const y={class:"page-container"},w={class:"section-header"},C={class:"header-actions"},_={class:"glass-pill control-pill"},I=["max","disabled"],S=["disabled"],F={key:0,width:"14",height:"14",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},M={key:1,class:"spinner-mini"},z={class:"kpi-cards-grid"},R={class:"glass-card kpi-card"},A={class:"kpi-value"},D={class:"glass-card kpi-card"},$={class:"kpi-value text-gradient-blue"},j={class:"glass-card kpi-card"},E={class:"kpi-value"},N={class:"glass-card kpi-card"},O={class:"kpi-value text-gradient-green"},U={class:"dashboard-grid"},B={class:"col-left"},P={class:"glass-card panel"},T={class:"search-container"},W={class:"search-input-wrapper"},Z={key:0,class:"period-suggestions"},H=["onClick"],L={class:"suggestion-term"},V={class:"suggestion-rate"},Y={class:"form-hint"},X={key:0,class:"glass-card panel highlight-panel"},q={class:"panel-header"},K={class:"badge-glass"},G={class:"result-metrics"},J={class:"metric-item"},Q={class:"metric-value"},aa={class:"metric-item"},la={class:"metric-value text-gradient-blue"},sa={class:"metric-item"},ea={class:"metric-value"},ta={class:"glass-card panel"},ia={class:"chart-container"},ra={class:"glass-card panel"},na={class:"panel-header"},da={class:"badge-glass"},va={class:"table-wrapper"},ca={class:"glass-table"},oa={class:"col-index"},ua={class:"col-term mono"},pa={class:"col-rate mono text-gradient-blue"},ma={class:"col-class"},ba={class:"badge-type"},ga={key:0},ha={class:"col-right"},fa={class:"glass-card panel"},ka={class:"metrics-kv-list"},xa={class:"kv-row"},ya={class:"v mono"},wa={class:"kv-row"},Ca={class:"v mono"},_a={class:"kv-row"},Ia={class:"v mono"},Sa={class:"kv-row"},Fa=l(s({__name:"ZCYCViewer",setup(l){const s=e({date:(new Date).toISOString().split("T")[0]}),Fa=e({status:"ok",date:"2026-01-03",count:12,min_term:.083,max_term:10,min_rate:13.45,max_rate:14.82,mean_rate:14.12,data:[{term:.083,value:13.45},{term:.25,value:13.52},{term:.5,value:13.68},{term:1,value:13.95},{term:2,value:14.28},{term:3,value:14.42},{term:5,value:14.65},{term:7,value:14.75},{term:10,value:14.82},{term:15,value:14.8},{term:20,value:14.75},{term:30,value:14.7}]}),Ma=e(!1),za=e(null),Ra=e(null),Aa=e(""),Da=e(null),$a=e(!1),ja=(new Date).toISOString().split("T")[0],Ea=t(()=>{if(!Aa.value||!Fa.value)return[];const a=parseFloat(Aa.value);return isNaN(a)?[]:Fa.value.data.map(l=>({...l,diff:Math.abs(l.term-a)})).sort((a,l)=>a.diff-l.diff).slice(0,10).map(({diff:a,...l})=>l)}),Na=async()=>{if(s.value.date){Ma.value=!0;try{const{getZCYC:l}=await a(async()=>{const{getZCYC:a}=await import("./zcycService-BjIxtT5Z.js");return{getZCYC:a}},__vite__mapDeps([0,1])),e=await l(s.value.date);"ok"===e.status?(Fa.value=e,Pa(Fa.value)):(console.error("Ошибка загрузки КБД:",e.error),alert(`Ошибка загрузки кривой: ${e.error||"Неизвестная ошибка"}`))}catch(l){console.error("Ошибка загрузки кривой бескупонных доходностей:",l);const a=l.message||"Неизвестная ошибка";console.error("Детали ошибки:",{message:a,date:s.value.date}),alert(`Ошибка загрузки кривой: ${a}\n\nПроверьте:\n1. Запущен ли бэкенд сервер\n2. Правильность URL API в настройках`)}finally{Ma.value=!1}}else console.warn("Дата не выбрана")},Oa=()=>{s.value.date&&Na()},Ua=()=>{$a.value=Aa.value.length>0},Ba=()=>{if(!Aa.value||!Fa.value)return void(Da.value=null);const a=parseFloat(Aa.value);if(isNaN(a))return void(Da.value=null);if(a<Fa.value.min_term||a>Fa.value.max_term)return void(Da.value=null);const l=(a=>{if(!Fa.value||Fa.value.data.length<2)return null;const l=Fa.value.data,s=l.find(l=>Math.abs(l.term-a)<1e-4);if(s)return s.value;let e=null,t=null;for(let r=0;r<l.length;r++)l[r].term<=a&&(!e||l[r].term>e.term)&&(e=l[r]),l[r].term>=a&&(!t||l[r].term<t.term)&&(t=l[r]);if(!e)return l[0].value;if(!t)return l[l.length-1].value;if(!e||!t||e===t)return e?.value||null;const i=(a-e.term)/(t.term-e.term);return e.value+i*(t.value-e.value)})(a);Da.value=null!==l?{term:a,value:l}:null},Pa=a=>{if(!za.value)return;Ra.value&&Ra.value.destroy();const l=za.value.getContext("2d");l&&(Ra.value=new x(l,{type:"line",data:{labels:a.data.map(a=>`${a.term.toFixed(2)}y`),datasets:[{label:"Ставка КБД (%)",data:a.data.map(a=>a.value),borderColor:"#60a5fa",backgroundColor:"rgba(96, 165, 250, 0.1)",borderWidth:2.5,fill:!0,tension:.35,pointRadius:4,pointBackgroundColor:"#60a5fa",pointBorderColor:"#ffffff",pointBorderWidth:1.5,pointHoverRadius:6,pointHoverBackgroundColor:"#3b82f6"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{boxWidth:12,padding:15,font:{size:14,weight:"bold"},color:"rgba(255,255,255,0.6)"}},tooltip:{enabled:!0,backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:13,weight:"bold"},bodyFont:{size:12},borderColor:"#60a5fa",borderWidth:1,titleColor:"#60a5fa",bodyColor:"#e5e7eb",displayColors:!1,callbacks:{label:a=>`Ставка: ${Number(a.parsed.y).toFixed(3)}%`}}},scales:{y:{beginAtZero:!1,grid:{color:"rgba(255, 255, 255, 0.08)",lineWidth:1},ticks:{color:"rgba(255,255,255,0.6)",font:{size:12},callback:a=>`${Number(a).toFixed(1)}%`,padding:10},title:{display:!0,text:"Ставка, % годовых",font:{weight:"bold",size:13},color:"rgba(255,255,255,0.6)",padding:12}},x:{grid:{display:!1},ticks:{color:"rgba(255,255,255,0.6)",font:{size:12},padding:10,maxRotation:0},title:{display:!0,text:"Срок до погашения",font:{weight:"bold",size:13},color:"rgba(255,255,255,0.6)",padding:12}}}}}))},Ta=a=>a<=.5?"Ночной":a<=1?"Краткосрочный":a<=3?"Среднесрочный":a<=5?"Долгосрочный":"Очень долгосрочный",Wa=()=>{if(!Fa.value||0===Fa.value.data.length)return 0;const a=Fa.value.data;let l=a[a.length-1].value,s=a[0].value;for(const e of a)Math.abs(e.term-5)<Math.abs(l-5)&&(l=e.value),Math.abs(e.term-.5)<Math.abs(s-.5)&&(s=e.value);return l-s},Za=(a,l=2)=>a.toLocaleString("ru-RU",{minimumFractionDigits:l,maximumFractionDigits:l}),Ha=a=>new Date(a+"T00:00:00").toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"});return i(()=>{Na()}),(a,l)=>(k(),r("div",y,[n("div",w,[l[4]||(l[4]=n("div",{class:"header-left"},[n("h1",{class:"section-title"},"КБД"),n("p",{class:"section-subtitle"},"Кривая бескупонных доходностей от MOEX ISS API")],-1)),n("div",C,[n("div",_,[l[2]||(l[2]=n("span",{class:"lbl-mini"},"Дата:",-1)),d(n("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>s.value.date=a),type:"date",class:"date-input",max:c(ja),min:"2014-01-06",onChange:Oa,disabled:Ma.value},null,40,I),[[v,s.value.date]])]),n("button",{class:"btn-glass primary",onClick:Na,disabled:Ma.value},[Ma.value?(k(),r("span",M)):(k(),r("svg",F,[...l[3]||(l[3]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),n("span",null,o(Ma.value?"Загрузка...":"Загрузить"),1)],8,S)])]),n("div",z,[n("div",R,[l[5]||(l[5]=n("div",{class:"kpi-label"},"Дата КБД",-1)),n("div",A,o(Ha(Fa.value.date)),1),l[6]||(l[6]=n("div",{class:"kpi-sub"},[n("span",{class:"text-muted"},"Последнее обновление")],-1))]),n("div",D,[l[7]||(l[7]=n("div",{class:"kpi-label"},"Точек на кривой",-1)),n("div",$,o(Fa.value.count),1),l[8]||(l[8]=n("div",{class:"kpi-sub"},[n("span",{class:"text-muted"},"Точек данных")],-1))]),n("div",j,[l[9]||(l[9]=n("div",{class:"kpi-label"},"Минимальная ставка",-1)),n("div",E,o(Za(Fa.value.min_rate,3))+"%",1),l[10]||(l[10]=n("div",{class:"kpi-sub"},[n("span",{class:"text-muted"},"Мин. ставка")],-1))]),n("div",N,[l[11]||(l[11]=n("div",{class:"kpi-label"},"Максимальная ставка",-1)),n("div",O,o(Za(Fa.value.max_rate,3))+"%",1),l[12]||(l[12]=n("div",{class:"kpi-sub"},[n("span",{class:"text-muted"},"Макс. ставка")],-1))])]),n("div",U,[n("div",B,[n("div",P,[l[14]||(l[14]=n("div",{class:"panel-header"},[n("h3",null,"Поиск периода (интерполяция)")],-1)),n("div",T,[n("div",W,[d(n("input",{"onUpdate:modelValue":l[1]||(l[1]=a=>Aa.value=a),type:"number",step:"0.01",class:"search-input",placeholder:"Введите срок (например 2.23)",onInput:Ua,onChange:Ba,onKeydown:p(Ba,["enter"])},null,544),[[v,Aa.value]]),l[13]||(l[13]=n("span",{class:"search-unit"},"лет",-1))]),$a.value&&Ea.value.length>0?(k(),r("div",Z,[(k(!0),r(m,null,b(Ea.value.slice(0,5),(a,l)=>(k(),r("div",{key:l,class:"suggestion-item",onClick:l=>(a=>{a&&(Da.value=a,Aa.value=Za(a.term,4),$a.value=!1)})(a)},[n("span",L,o(Za(a.term,4)),1),n("span",V,o(Za(a.value,3))+"%",1)],8,H))),128))])):u("",!0)]),n("small",Y,o(Da.value?`Найдено: ${Za(Da.value.term,4)} лет → ${Za(Da.value.value,4)}%`:"Введите срок и нажмите Enter"),1)]),Da.value?(k(),r("div",X,[n("div",q,[l[15]||(l[15]=n("h3",null,"Результат интерполяции",-1)),n("div",K,o(Ta(Da.value.term)),1)]),n("div",G,[n("div",J,[l[16]||(l[16]=n("span",{class:"metric-label"},"Период",-1)),n("span",Q,o(Za(Da.value.term,4))+" лет",1)]),n("div",aa,[l[17]||(l[17]=n("span",{class:"metric-label"},"Доходность",-1)),n("span",la,o(Za(Da.value.value,4))+"%",1)]),n("div",sa,[l[18]||(l[18]=n("span",{class:"metric-label"},"На дату",-1)),n("span",ea,o(Ha(Fa.value.date)),1)])])])):u("",!0),n("div",ta,[l[19]||(l[19]=n("div",{class:"panel-header"},[n("h3",null,"Кривая доходности"),n("div",{class:"legend"},[n("span",{class:"dot-legend bg-blue"}),g(" Ставка КБД ")])],-1)),n("div",ia,[n("canvas",{ref_key:"chartCanvas",ref:za,class:"chart-canvas"},null,512)])]),n("div",ra,[n("div",na,[l[20]||(l[20]=n("h3",null,"Таблица данных",-1)),n("div",da,o(Fa.value.data.length)+" точек",1)]),n("div",va,[n("table",ca,[l[22]||(l[22]=n("thead",null,[n("tr",null,[n("th",{class:"col-index"},"#"),n("th",{class:"col-term"},"Срок (годы)"),n("th",{class:"col-rate"},"Ставка (%)"),n("th",{class:"col-class"},"Класс")])],-1)),n("tbody",null,[(k(!0),r(m,null,b(Fa.value.data,(a,l)=>{return k(),r("tr",{key:l,class:h((s=a.term,{"short-term":s<=1,"medium-term":s>1&&s<=3,"long-term":s>3}))},[n("td",oa,o(l+1),1),n("td",ua,o(Za(a.term,4)),1),n("td",pa,o(Za(a.value,4)),1),n("td",ma,[n("span",ba,o(Ta(a.term)),1)])],2);var s}),128)),0===Fa.value.data.length?(k(),r("tr",ga,[...l[21]||(l[21]=[n("td",{colspan:"4",class:"empty-state"},"Нет данных для отображения",-1)])])):u("",!0)])])])])]),n("div",ha,[n("div",fa,[l[27]||(l[27]=n("div",{class:"panel-header"},[n("h3",null,"Статистика кривой")],-1)),n("div",ka,[n("div",xa,[l[23]||(l[23]=n("span",{class:"k"},"Диапазон сроков",-1)),n("span",ya,o(Za(Fa.value.min_term,4))+" – "+o(Za(Fa.value.max_term,2)),1)]),n("div",wa,[l[24]||(l[24]=n("span",{class:"k"},"Средняя ставка",-1)),n("span",Ca,o(Za(Fa.value.mean_rate,3))+"%",1)]),n("div",_a,[l[25]||(l[25]=n("span",{class:"k"},"Разброс (max-min)",-1)),n("span",Ia,o(Za(Fa.value.max_rate-Fa.value.min_rate,3))+"%",1)]),n("div",Sa,[l[26]||(l[26]=n("span",{class:"k"},"Наклон (5л - 0.5л)",-1)),n("span",{class:h(["v mono",Wa()>0?"text-green":"text-red"])},o(Za(Wa(),3))+"%",3)])])]),l[28]||(l[28]=f('<div class="glass-card panel" data-v-b1a86551><div class="panel-header" data-v-b1a86551><h3 data-v-b1a86551>Классификация сроков</h3></div><div class="factor-list" data-v-b1a86551><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Ночной</span><span class="sub-lbl" data-v-b1a86551>≤ 0.5 лет</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Краткосрочный</span><span class="sub-lbl" data-v-b1a86551>0.5 – 1 год</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Среднесрочный</span><span class="sub-lbl" data-v-b1a86551>1 – 3 года</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Долгосрочный</span><span class="sub-lbl" data-v-b1a86551>3 – 5 лет</span></div></div><div class="list-row" data-v-b1a86551><div class="lbl-group" data-v-b1a86551><span class="lbl" data-v-b1a86551>Очень долгосрочный</span><span class="sub-lbl" data-v-b1a86551>&gt; 5 лет</span></div></div></div></div><div class="glass-card panel" data-v-b1a86551><div class="panel-header" data-v-b1a86551><h3 data-v-b1a86551>О КБД</h3></div><div class="info-text" data-v-b1a86551><p data-v-b1a86551><strong data-v-b1a86551>КБД</strong> — кривая бескупонных доходностей показывает зависимость доходности до погашения бескупонных облигаций от сроков до погашения. </p><p data-v-b1a86551><strong data-v-b1a86551>Источник:</strong> MOEX ISS API </p><p data-v-b1a86551><strong data-v-b1a86551>Интерполяция:</strong> MOEX использует метод Нельсона-Сигеля для интерполяции кривой. Если срок не совпадает ни с одной точкой кривой, система вычисляет доходность методом линейной интерполяции между двумя ближайшими точками. </p><p data-v-b1a86551><strong data-v-b1a86551>Выбор даты:</strong> Выберите дату для получения кривой бескупонных доходностей. Доступны данные с 2014 года по текущую дату. </p></div></div>',2))])])]))}}),[["__scopeId","data-v-b1a86551"]]);export{Fa as default};
